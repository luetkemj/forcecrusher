var Ww=Object.defineProperty;var Xw=(r,t,e)=>t in r?Ww(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var Zt=(r,t,e)=>(Xw(r,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();var kr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xu(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function zw(r){if(r.__esModule)return r;var t=r.default;if(typeof t=="function"){var e=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),e}var Jo={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Jo.exports;(function(r,t){(function(){var e,n="4.17.21",i=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",h="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",f=500,d="__lodash_placeholder__",m=1,g=2,y=4,v=1,T=2,E=1,I=2,P=4,w=8,R=16,O=32,W=64,k=128,U=256,Y=512,J=30,z="...",q=800,G=16,F=1,at=2,ft=3,V=1/0,_t=9007199254740991,Ot=17976931348623157e292,$=NaN,rt=4294967295,xt=rt-1,It=rt>>>1,Pt=[["ary",k],["bind",E],["bindKey",I],["curry",w],["curryRight",R],["flip",Y],["partial",O],["partialRight",W],["rearg",U]],Nt="[object Arguments]",Ut="[object Array]",re="[object AsyncFunction]",Yt="[object Boolean]",ne="[object Date]",se="[object DOMException]",Mt="[object Error]",kt="[object Function]",jt="[object GeneratorFunction]",qt="[object Map]",_e="[object Number]",fn="[object Null]",fr="[object Object]",Xu="[object Promise]",a_="[object Proxy]",Ni="[object RegExp]",qe="[object Set]",Ui="[object String]",Rs="[object Symbol]",l_="[object Undefined]",ki="[object WeakMap]",h_="[object WeakSet]",Gi="[object ArrayBuffer]",Xn="[object DataView]",Sa="[object Float32Array]",Ca="[object Float64Array]",Ia="[object Int8Array]",Ra="[object Int16Array]",Pa="[object Int32Array]",Ma="[object Uint8Array]",Da="[object Uint8ClampedArray]",Ba="[object Uint16Array]",Oa="[object Uint32Array]",u_=/\b__p \+= '';/g,c_=/\b(__p \+=) '' \+/g,f_=/(__e\(.*?\)|\b__t\)) \+\n'';/g,zu=/&(?:amp|lt|gt|quot|#39);/g,Vu=/[&<>"']/g,d_=RegExp(zu.source),p_=RegExp(Vu.source),g_=/<%-([\s\S]+?)%>/g,m_=/<%([\s\S]+?)%>/g,Yu=/<%=([\s\S]+?)%>/g,__=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,y_=/^\w*$/,v_=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Fa=/[\\^$.*+?()[\]{}|]/g,x_=RegExp(Fa.source),La=/^\s+/,b_=/\s/,w_=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,E_=/\{\n\/\* \[wrapped with (.+)\] \*/,T_=/,? & /,A_=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,S_=/[()=,{}\[\]\/\s]/,C_=/\\(\\)?/g,I_=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ju=/\w*$/,R_=/^[-+]0x[0-9a-f]+$/i,P_=/^0b[01]+$/i,M_=/^\[object .+?Constructor\]$/,D_=/^0o[0-7]+$/i,B_=/^(?:0|[1-9]\d*)$/,O_=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ps=/($^)/,F_=/['\n\r\u2028\u2029\\]/g,Ms="\\ud800-\\udfff",L_="\\u0300-\\u036f",N_="\\ufe20-\\ufe2f",U_="\\u20d0-\\u20ff",qu=L_+N_+U_,Ku="\\u2700-\\u27bf",Zu="a-z\\xdf-\\xf6\\xf8-\\xff",k_="\\xac\\xb1\\xd7\\xf7",G_="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",H_="\\u2000-\\u206f",$_=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ju="A-Z\\xc0-\\xd6\\xd8-\\xde",Qu="\\ufe0e\\ufe0f",tc=k_+G_+H_+$_,Na="['’]",W_="["+Ms+"]",ec="["+tc+"]",Ds="["+qu+"]",rc="\\d+",X_="["+Ku+"]",nc="["+Zu+"]",ic="[^"+Ms+tc+rc+Ku+Zu+Ju+"]",Ua="\\ud83c[\\udffb-\\udfff]",z_="(?:"+Ds+"|"+Ua+")",sc="[^"+Ms+"]",ka="(?:\\ud83c[\\udde6-\\uddff]){2}",Ga="[\\ud800-\\udbff][\\udc00-\\udfff]",zn="["+Ju+"]",oc="\\u200d",ac="(?:"+nc+"|"+ic+")",V_="(?:"+zn+"|"+ic+")",lc="(?:"+Na+"(?:d|ll|m|re|s|t|ve))?",hc="(?:"+Na+"(?:D|LL|M|RE|S|T|VE))?",uc=z_+"?",cc="["+Qu+"]?",Y_="(?:"+oc+"(?:"+[sc,ka,Ga].join("|")+")"+cc+uc+")*",j_="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",q_="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",fc=cc+uc+Y_,K_="(?:"+[X_,ka,Ga].join("|")+")"+fc,Z_="(?:"+[sc+Ds+"?",Ds,ka,Ga,W_].join("|")+")",J_=RegExp(Na,"g"),Q_=RegExp(Ds,"g"),Ha=RegExp(Ua+"(?="+Ua+")|"+Z_+fc,"g"),ty=RegExp([zn+"?"+nc+"+"+lc+"(?="+[ec,zn,"$"].join("|")+")",V_+"+"+hc+"(?="+[ec,zn+ac,"$"].join("|")+")",zn+"?"+ac+"+"+lc,zn+"+"+hc,q_,j_,rc,K_].join("|"),"g"),ey=RegExp("["+oc+Ms+qu+Qu+"]"),ry=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ny=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],iy=-1,Gt={};Gt[Sa]=Gt[Ca]=Gt[Ia]=Gt[Ra]=Gt[Pa]=Gt[Ma]=Gt[Da]=Gt[Ba]=Gt[Oa]=!0,Gt[Nt]=Gt[Ut]=Gt[Gi]=Gt[Yt]=Gt[Xn]=Gt[ne]=Gt[Mt]=Gt[kt]=Gt[qt]=Gt[_e]=Gt[fr]=Gt[Ni]=Gt[qe]=Gt[Ui]=Gt[ki]=!1;var Lt={};Lt[Nt]=Lt[Ut]=Lt[Gi]=Lt[Xn]=Lt[Yt]=Lt[ne]=Lt[Sa]=Lt[Ca]=Lt[Ia]=Lt[Ra]=Lt[Pa]=Lt[qt]=Lt[_e]=Lt[fr]=Lt[Ni]=Lt[qe]=Lt[Ui]=Lt[Rs]=Lt[Ma]=Lt[Da]=Lt[Ba]=Lt[Oa]=!0,Lt[Mt]=Lt[kt]=Lt[ki]=!1;var sy={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},oy={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ay={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ly={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},hy=parseFloat,uy=parseInt,dc=typeof kr=="object"&&kr&&kr.Object===Object&&kr,cy=typeof self=="object"&&self&&self.Object===Object&&self,fe=dc||cy||Function("return this")(),$a=t&&!t.nodeType&&t,dn=$a&&!0&&r&&!r.nodeType&&r,pc=dn&&dn.exports===$a,Wa=pc&&dc.process,Ge=function(){try{var C=dn&&dn.require&&dn.require("util").types;return C||Wa&&Wa.binding&&Wa.binding("util")}catch{}}(),gc=Ge&&Ge.isArrayBuffer,mc=Ge&&Ge.isDate,_c=Ge&&Ge.isMap,yc=Ge&&Ge.isRegExp,vc=Ge&&Ge.isSet,xc=Ge&&Ge.isTypedArray;function Me(C,B,D){switch(D.length){case 0:return C.call(B);case 1:return C.call(B,D[0]);case 2:return C.call(B,D[0],D[1]);case 3:return C.call(B,D[0],D[1],D[2])}return C.apply(B,D)}function fy(C,B,D,Q){for(var ct=-1,Ct=C==null?0:C.length;++ct<Ct;){var oe=C[ct];B(Q,oe,D(oe),C)}return Q}function He(C,B){for(var D=-1,Q=C==null?0:C.length;++D<Q&&B(C[D],D,C)!==!1;);return C}function dy(C,B){for(var D=C==null?0:C.length;D--&&B(C[D],D,C)!==!1;);return C}function bc(C,B){for(var D=-1,Q=C==null?0:C.length;++D<Q;)if(!B(C[D],D,C))return!1;return!0}function Xr(C,B){for(var D=-1,Q=C==null?0:C.length,ct=0,Ct=[];++D<Q;){var oe=C[D];B(oe,D,C)&&(Ct[ct++]=oe)}return Ct}function Bs(C,B){var D=C==null?0:C.length;return!!D&&Vn(C,B,0)>-1}function Xa(C,B,D){for(var Q=-1,ct=C==null?0:C.length;++Q<ct;)if(D(B,C[Q]))return!0;return!1}function Ht(C,B){for(var D=-1,Q=C==null?0:C.length,ct=Array(Q);++D<Q;)ct[D]=B(C[D],D,C);return ct}function zr(C,B){for(var D=-1,Q=B.length,ct=C.length;++D<Q;)C[ct+D]=B[D];return C}function za(C,B,D,Q){var ct=-1,Ct=C==null?0:C.length;for(Q&&Ct&&(D=C[++ct]);++ct<Ct;)D=B(D,C[ct],ct,C);return D}function py(C,B,D,Q){var ct=C==null?0:C.length;for(Q&&ct&&(D=C[--ct]);ct--;)D=B(D,C[ct],ct,C);return D}function Va(C,B){for(var D=-1,Q=C==null?0:C.length;++D<Q;)if(B(C[D],D,C))return!0;return!1}var gy=Ya("length");function my(C){return C.split("")}function _y(C){return C.match(A_)||[]}function wc(C,B,D){var Q;return D(C,function(ct,Ct,oe){if(B(ct,Ct,oe))return Q=Ct,!1}),Q}function Os(C,B,D,Q){for(var ct=C.length,Ct=D+(Q?1:-1);Q?Ct--:++Ct<ct;)if(B(C[Ct],Ct,C))return Ct;return-1}function Vn(C,B,D){return B===B?Ry(C,B,D):Os(C,Ec,D)}function yy(C,B,D,Q){for(var ct=D-1,Ct=C.length;++ct<Ct;)if(Q(C[ct],B))return ct;return-1}function Ec(C){return C!==C}function Tc(C,B){var D=C==null?0:C.length;return D?qa(C,B)/D:$}function Ya(C){return function(B){return B==null?e:B[C]}}function ja(C){return function(B){return C==null?e:C[B]}}function Ac(C,B,D,Q,ct){return ct(C,function(Ct,oe,Ft){D=Q?(Q=!1,Ct):B(D,Ct,oe,Ft)}),D}function vy(C,B){var D=C.length;for(C.sort(B);D--;)C[D]=C[D].value;return C}function qa(C,B){for(var D,Q=-1,ct=C.length;++Q<ct;){var Ct=B(C[Q]);Ct!==e&&(D=D===e?Ct:D+Ct)}return D}function Ka(C,B){for(var D=-1,Q=Array(C);++D<C;)Q[D]=B(D);return Q}function xy(C,B){return Ht(B,function(D){return[D,C[D]]})}function Sc(C){return C&&C.slice(0,Pc(C)+1).replace(La,"")}function De(C){return function(B){return C(B)}}function Za(C,B){return Ht(B,function(D){return C[D]})}function Hi(C,B){return C.has(B)}function Cc(C,B){for(var D=-1,Q=C.length;++D<Q&&Vn(B,C[D],0)>-1;);return D}function Ic(C,B){for(var D=C.length;D--&&Vn(B,C[D],0)>-1;);return D}function by(C,B){for(var D=C.length,Q=0;D--;)C[D]===B&&++Q;return Q}var wy=ja(sy),Ey=ja(oy);function Ty(C){return"\\"+ly[C]}function Ay(C,B){return C==null?e:C[B]}function Yn(C){return ey.test(C)}function Sy(C){return ry.test(C)}function Cy(C){for(var B,D=[];!(B=C.next()).done;)D.push(B.value);return D}function Ja(C){var B=-1,D=Array(C.size);return C.forEach(function(Q,ct){D[++B]=[ct,Q]}),D}function Rc(C,B){return function(D){return C(B(D))}}function Vr(C,B){for(var D=-1,Q=C.length,ct=0,Ct=[];++D<Q;){var oe=C[D];(oe===B||oe===d)&&(C[D]=d,Ct[ct++]=D)}return Ct}function Fs(C){var B=-1,D=Array(C.size);return C.forEach(function(Q){D[++B]=Q}),D}function Iy(C){var B=-1,D=Array(C.size);return C.forEach(function(Q){D[++B]=[Q,Q]}),D}function Ry(C,B,D){for(var Q=D-1,ct=C.length;++Q<ct;)if(C[Q]===B)return Q;return-1}function Py(C,B,D){for(var Q=D+1;Q--;)if(C[Q]===B)return Q;return Q}function jn(C){return Yn(C)?Dy(C):gy(C)}function Ke(C){return Yn(C)?By(C):my(C)}function Pc(C){for(var B=C.length;B--&&b_.test(C.charAt(B)););return B}var My=ja(ay);function Dy(C){for(var B=Ha.lastIndex=0;Ha.test(C);)++B;return B}function By(C){return C.match(Ha)||[]}function Oy(C){return C.match(ty)||[]}var Fy=function C(B){B=B==null?fe:qn.defaults(fe.Object(),B,qn.pick(fe,ny));var D=B.Array,Q=B.Date,ct=B.Error,Ct=B.Function,oe=B.Math,Ft=B.Object,Qa=B.RegExp,Ly=B.String,$e=B.TypeError,Ls=D.prototype,Ny=Ct.prototype,Kn=Ft.prototype,Ns=B["__core-js_shared__"],Us=Ny.toString,Dt=Kn.hasOwnProperty,Uy=0,Mc=function(){var s=/[^.]+$/.exec(Ns&&Ns.keys&&Ns.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),ks=Kn.toString,ky=Us.call(Ft),Gy=fe._,Hy=Qa("^"+Us.call(Dt).replace(Fa,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Gs=pc?B.Buffer:e,Yr=B.Symbol,Hs=B.Uint8Array,Dc=Gs?Gs.allocUnsafe:e,$s=Rc(Ft.getPrototypeOf,Ft),Bc=Ft.create,Oc=Kn.propertyIsEnumerable,Ws=Ls.splice,Fc=Yr?Yr.isConcatSpreadable:e,$i=Yr?Yr.iterator:e,pn=Yr?Yr.toStringTag:e,Xs=function(){try{var s=vn(Ft,"defineProperty");return s({},"",{}),s}catch{}}(),$y=B.clearTimeout!==fe.clearTimeout&&B.clearTimeout,Wy=Q&&Q.now!==fe.Date.now&&Q.now,Xy=B.setTimeout!==fe.setTimeout&&B.setTimeout,zs=oe.ceil,Vs=oe.floor,tl=Ft.getOwnPropertySymbols,zy=Gs?Gs.isBuffer:e,Lc=B.isFinite,Vy=Ls.join,Yy=Rc(Ft.keys,Ft),ae=oe.max,ye=oe.min,jy=Q.now,qy=B.parseInt,Nc=oe.random,Ky=Ls.reverse,el=vn(B,"DataView"),Wi=vn(B,"Map"),rl=vn(B,"Promise"),Zn=vn(B,"Set"),Xi=vn(B,"WeakMap"),zi=vn(Ft,"create"),Ys=Xi&&new Xi,Jn={},Zy=xn(el),Jy=xn(Wi),Qy=xn(rl),tv=xn(Zn),ev=xn(Xi),js=Yr?Yr.prototype:e,Vi=js?js.valueOf:e,Uc=js?js.toString:e;function x(s){if(Kt(s)&&!dt(s)&&!(s instanceof bt)){if(s instanceof We)return s;if(Dt.call(s,"__wrapped__"))return Gf(s)}return new We(s)}var Qn=function(){function s(){}return function(a){if(!Wt(a))return{};if(Bc)return Bc(a);s.prototype=a;var u=new s;return s.prototype=e,u}}();function qs(){}function We(s,a){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!a,this.__index__=0,this.__values__=e}x.templateSettings={escape:g_,evaluate:m_,interpolate:Yu,variable:"",imports:{_:x}},x.prototype=qs.prototype,x.prototype.constructor=x,We.prototype=Qn(qs.prototype),We.prototype.constructor=We;function bt(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=rt,this.__views__=[]}function rv(){var s=new bt(this.__wrapped__);return s.__actions__=Ae(this.__actions__),s.__dir__=this.__dir__,s.__filtered__=this.__filtered__,s.__iteratees__=Ae(this.__iteratees__),s.__takeCount__=this.__takeCount__,s.__views__=Ae(this.__views__),s}function nv(){if(this.__filtered__){var s=new bt(this);s.__dir__=-1,s.__filtered__=!0}else s=this.clone(),s.__dir__*=-1;return s}function iv(){var s=this.__wrapped__.value(),a=this.__dir__,u=dt(s),p=a<0,_=u?s.length:0,b=m0(0,_,this.__views__),A=b.start,S=b.end,M=S-A,L=p?S:A-1,N=this.__iteratees__,H=N.length,j=0,tt=ye(M,this.__takeCount__);if(!u||!p&&_==M&&tt==M)return hf(s,this.__actions__);var lt=[];t:for(;M--&&j<tt;){L+=a;for(var mt=-1,ht=s[L];++mt<H;){var vt=N[mt],Tt=vt.iteratee,Fe=vt.type,Ee=Tt(ht);if(Fe==at)ht=Ee;else if(!Ee){if(Fe==F)continue t;break t}}lt[j++]=ht}return lt}bt.prototype=Qn(qs.prototype),bt.prototype.constructor=bt;function gn(s){var a=-1,u=s==null?0:s.length;for(this.clear();++a<u;){var p=s[a];this.set(p[0],p[1])}}function sv(){this.__data__=zi?zi(null):{},this.size=0}function ov(s){var a=this.has(s)&&delete this.__data__[s];return this.size-=a?1:0,a}function av(s){var a=this.__data__;if(zi){var u=a[s];return u===c?e:u}return Dt.call(a,s)?a[s]:e}function lv(s){var a=this.__data__;return zi?a[s]!==e:Dt.call(a,s)}function hv(s,a){var u=this.__data__;return this.size+=this.has(s)?0:1,u[s]=zi&&a===e?c:a,this}gn.prototype.clear=sv,gn.prototype.delete=ov,gn.prototype.get=av,gn.prototype.has=lv,gn.prototype.set=hv;function Ir(s){var a=-1,u=s==null?0:s.length;for(this.clear();++a<u;){var p=s[a];this.set(p[0],p[1])}}function uv(){this.__data__=[],this.size=0}function cv(s){var a=this.__data__,u=Ks(a,s);if(u<0)return!1;var p=a.length-1;return u==p?a.pop():Ws.call(a,u,1),--this.size,!0}function fv(s){var a=this.__data__,u=Ks(a,s);return u<0?e:a[u][1]}function dv(s){return Ks(this.__data__,s)>-1}function pv(s,a){var u=this.__data__,p=Ks(u,s);return p<0?(++this.size,u.push([s,a])):u[p][1]=a,this}Ir.prototype.clear=uv,Ir.prototype.delete=cv,Ir.prototype.get=fv,Ir.prototype.has=dv,Ir.prototype.set=pv;function Rr(s){var a=-1,u=s==null?0:s.length;for(this.clear();++a<u;){var p=s[a];this.set(p[0],p[1])}}function gv(){this.size=0,this.__data__={hash:new gn,map:new(Wi||Ir),string:new gn}}function mv(s){var a=lo(this,s).delete(s);return this.size-=a?1:0,a}function _v(s){return lo(this,s).get(s)}function yv(s){return lo(this,s).has(s)}function vv(s,a){var u=lo(this,s),p=u.size;return u.set(s,a),this.size+=u.size==p?0:1,this}Rr.prototype.clear=gv,Rr.prototype.delete=mv,Rr.prototype.get=_v,Rr.prototype.has=yv,Rr.prototype.set=vv;function mn(s){var a=-1,u=s==null?0:s.length;for(this.__data__=new Rr;++a<u;)this.add(s[a])}function xv(s){return this.__data__.set(s,c),this}function bv(s){return this.__data__.has(s)}mn.prototype.add=mn.prototype.push=xv,mn.prototype.has=bv;function Ze(s){var a=this.__data__=new Ir(s);this.size=a.size}function wv(){this.__data__=new Ir,this.size=0}function Ev(s){var a=this.__data__,u=a.delete(s);return this.size=a.size,u}function Tv(s){return this.__data__.get(s)}function Av(s){return this.__data__.has(s)}function Sv(s,a){var u=this.__data__;if(u instanceof Ir){var p=u.__data__;if(!Wi||p.length<i-1)return p.push([s,a]),this.size=++u.size,this;u=this.__data__=new Rr(p)}return u.set(s,a),this.size=u.size,this}Ze.prototype.clear=wv,Ze.prototype.delete=Ev,Ze.prototype.get=Tv,Ze.prototype.has=Av,Ze.prototype.set=Sv;function kc(s,a){var u=dt(s),p=!u&&bn(s),_=!u&&!p&&Jr(s),b=!u&&!p&&!_&&ni(s),A=u||p||_||b,S=A?Ka(s.length,Ly):[],M=S.length;for(var L in s)(a||Dt.call(s,L))&&!(A&&(L=="length"||_&&(L=="offset"||L=="parent")||b&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||Br(L,M)))&&S.push(L);return S}function Gc(s){var a=s.length;return a?s[dl(0,a-1)]:e}function Cv(s,a){return ho(Ae(s),_n(a,0,s.length))}function Iv(s){return ho(Ae(s))}function nl(s,a,u){(u!==e&&!Je(s[a],u)||u===e&&!(a in s))&&Pr(s,a,u)}function Yi(s,a,u){var p=s[a];(!(Dt.call(s,a)&&Je(p,u))||u===e&&!(a in s))&&Pr(s,a,u)}function Ks(s,a){for(var u=s.length;u--;)if(Je(s[u][0],a))return u;return-1}function Rv(s,a,u,p){return jr(s,function(_,b,A){a(p,_,u(_),A)}),p}function Hc(s,a){return s&&pr(a,ue(a),s)}function Pv(s,a){return s&&pr(a,Ce(a),s)}function Pr(s,a,u){a=="__proto__"&&Xs?Xs(s,a,{configurable:!0,enumerable:!0,value:u,writable:!0}):s[a]=u}function il(s,a){for(var u=-1,p=a.length,_=D(p),b=s==null;++u<p;)_[u]=b?e:Ul(s,a[u]);return _}function _n(s,a,u){return s===s&&(u!==e&&(s=s<=u?s:u),a!==e&&(s=s>=a?s:a)),s}function Xe(s,a,u,p,_,b){var A,S=a&m,M=a&g,L=a&y;if(u&&(A=_?u(s,p,_,b):u(s)),A!==e)return A;if(!Wt(s))return s;var N=dt(s);if(N){if(A=y0(s),!S)return Ae(s,A)}else{var H=ve(s),j=H==kt||H==jt;if(Jr(s))return ff(s,S);if(H==fr||H==Nt||j&&!_){if(A=M||j?{}:Mf(s),!S)return M?a0(s,Pv(A,s)):o0(s,Hc(A,s))}else{if(!Lt[H])return _?s:{};A=v0(s,H,S)}}b=new Ze;var tt=b.get(s);if(tt)return tt;b.set(s,A),od(s)?s.forEach(function(ht){A.add(Xe(ht,a,u,ht,s,b))}):id(s)&&s.forEach(function(ht,vt){A.set(vt,Xe(ht,a,u,vt,s,b))});var lt=L?M?Tl:El:M?Ce:ue,mt=N?e:lt(s);return He(mt||s,function(ht,vt){mt&&(vt=ht,ht=s[vt]),Yi(A,vt,Xe(ht,a,u,vt,s,b))}),A}function Mv(s){var a=ue(s);return function(u){return $c(u,s,a)}}function $c(s,a,u){var p=u.length;if(s==null)return!p;for(s=Ft(s);p--;){var _=u[p],b=a[_],A=s[_];if(A===e&&!(_ in s)||!b(A))return!1}return!0}function Wc(s,a,u){if(typeof s!="function")throw new $e(l);return ts(function(){s.apply(e,u)},a)}function ji(s,a,u,p){var _=-1,b=Bs,A=!0,S=s.length,M=[],L=a.length;if(!S)return M;u&&(a=Ht(a,De(u))),p?(b=Xa,A=!1):a.length>=i&&(b=Hi,A=!1,a=new mn(a));t:for(;++_<S;){var N=s[_],H=u==null?N:u(N);if(N=p||N!==0?N:0,A&&H===H){for(var j=L;j--;)if(a[j]===H)continue t;M.push(N)}else b(a,H,p)||M.push(N)}return M}var jr=_f(dr),Xc=_f(ol,!0);function Dv(s,a){var u=!0;return jr(s,function(p,_,b){return u=!!a(p,_,b),u}),u}function Zs(s,a,u){for(var p=-1,_=s.length;++p<_;){var b=s[p],A=a(b);if(A!=null&&(S===e?A===A&&!Oe(A):u(A,S)))var S=A,M=b}return M}function Bv(s,a,u,p){var _=s.length;for(u=gt(u),u<0&&(u=-u>_?0:_+u),p=p===e||p>_?_:gt(p),p<0&&(p+=_),p=u>p?0:ld(p);u<p;)s[u++]=a;return s}function zc(s,a){var u=[];return jr(s,function(p,_,b){a(p,_,b)&&u.push(p)}),u}function de(s,a,u,p,_){var b=-1,A=s.length;for(u||(u=b0),_=[];++b<A;){var S=s[b];a>0&&u(S)?a>1?de(S,a-1,u,p,_):zr(_,S):p||(_[_.length]=S)}return _}var sl=yf(),Vc=yf(!0);function dr(s,a){return s&&sl(s,a,ue)}function ol(s,a){return s&&Vc(s,a,ue)}function Js(s,a){return Xr(a,function(u){return Or(s[u])})}function yn(s,a){a=Kr(a,s);for(var u=0,p=a.length;s!=null&&u<p;)s=s[gr(a[u++])];return u&&u==p?s:e}function Yc(s,a,u){var p=a(s);return dt(s)?p:zr(p,u(s))}function be(s){return s==null?s===e?l_:fn:pn&&pn in Ft(s)?g0(s):I0(s)}function al(s,a){return s>a}function Ov(s,a){return s!=null&&Dt.call(s,a)}function Fv(s,a){return s!=null&&a in Ft(s)}function Lv(s,a,u){return s>=ye(a,u)&&s<ae(a,u)}function ll(s,a,u){for(var p=u?Xa:Bs,_=s[0].length,b=s.length,A=b,S=D(b),M=1/0,L=[];A--;){var N=s[A];A&&a&&(N=Ht(N,De(a))),M=ye(N.length,M),S[A]=!u&&(a||_>=120&&N.length>=120)?new mn(A&&N):e}N=s[0];var H=-1,j=S[0];t:for(;++H<_&&L.length<M;){var tt=N[H],lt=a?a(tt):tt;if(tt=u||tt!==0?tt:0,!(j?Hi(j,lt):p(L,lt,u))){for(A=b;--A;){var mt=S[A];if(!(mt?Hi(mt,lt):p(s[A],lt,u)))continue t}j&&j.push(lt),L.push(tt)}}return L}function Nv(s,a,u,p){return dr(s,function(_,b,A){a(p,u(_),b,A)}),p}function qi(s,a,u){a=Kr(a,s),s=Ff(s,a);var p=s==null?s:s[gr(Ve(a))];return p==null?e:Me(p,s,u)}function jc(s){return Kt(s)&&be(s)==Nt}function Uv(s){return Kt(s)&&be(s)==Gi}function kv(s){return Kt(s)&&be(s)==ne}function Ki(s,a,u,p,_){return s===a?!0:s==null||a==null||!Kt(s)&&!Kt(a)?s!==s&&a!==a:Gv(s,a,u,p,Ki,_)}function Gv(s,a,u,p,_,b){var A=dt(s),S=dt(a),M=A?Ut:ve(s),L=S?Ut:ve(a);M=M==Nt?fr:M,L=L==Nt?fr:L;var N=M==fr,H=L==fr,j=M==L;if(j&&Jr(s)){if(!Jr(a))return!1;A=!0,N=!1}if(j&&!N)return b||(b=new Ze),A||ni(s)?If(s,a,u,p,_,b):d0(s,a,M,u,p,_,b);if(!(u&v)){var tt=N&&Dt.call(s,"__wrapped__"),lt=H&&Dt.call(a,"__wrapped__");if(tt||lt){var mt=tt?s.value():s,ht=lt?a.value():a;return b||(b=new Ze),_(mt,ht,u,p,b)}}return j?(b||(b=new Ze),p0(s,a,u,p,_,b)):!1}function Hv(s){return Kt(s)&&ve(s)==qt}function hl(s,a,u,p){var _=u.length,b=_,A=!p;if(s==null)return!b;for(s=Ft(s);_--;){var S=u[_];if(A&&S[2]?S[1]!==s[S[0]]:!(S[0]in s))return!1}for(;++_<b;){S=u[_];var M=S[0],L=s[M],N=S[1];if(A&&S[2]){if(L===e&&!(M in s))return!1}else{var H=new Ze;if(p)var j=p(L,N,M,s,a,H);if(!(j===e?Ki(N,L,v|T,p,H):j))return!1}}return!0}function qc(s){if(!Wt(s)||E0(s))return!1;var a=Or(s)?Hy:M_;return a.test(xn(s))}function $v(s){return Kt(s)&&be(s)==Ni}function Wv(s){return Kt(s)&&ve(s)==qe}function Xv(s){return Kt(s)&&mo(s.length)&&!!Gt[be(s)]}function Kc(s){return typeof s=="function"?s:s==null?Ie:typeof s=="object"?dt(s)?Qc(s[0],s[1]):Jc(s):vd(s)}function ul(s){if(!Qi(s))return Yy(s);var a=[];for(var u in Ft(s))Dt.call(s,u)&&u!="constructor"&&a.push(u);return a}function zv(s){if(!Wt(s))return C0(s);var a=Qi(s),u=[];for(var p in s)p=="constructor"&&(a||!Dt.call(s,p))||u.push(p);return u}function cl(s,a){return s<a}function Zc(s,a){var u=-1,p=Se(s)?D(s.length):[];return jr(s,function(_,b,A){p[++u]=a(_,b,A)}),p}function Jc(s){var a=Sl(s);return a.length==1&&a[0][2]?Bf(a[0][0],a[0][1]):function(u){return u===s||hl(u,s,a)}}function Qc(s,a){return Il(s)&&Df(a)?Bf(gr(s),a):function(u){var p=Ul(u,s);return p===e&&p===a?kl(u,s):Ki(a,p,v|T)}}function Qs(s,a,u,p,_){s!==a&&sl(a,function(b,A){if(_||(_=new Ze),Wt(b))Vv(s,a,A,u,Qs,p,_);else{var S=p?p(Pl(s,A),b,A+"",s,a,_):e;S===e&&(S=b),nl(s,A,S)}},Ce)}function Vv(s,a,u,p,_,b,A){var S=Pl(s,u),M=Pl(a,u),L=A.get(M);if(L){nl(s,u,L);return}var N=b?b(S,M,u+"",s,a,A):e,H=N===e;if(H){var j=dt(M),tt=!j&&Jr(M),lt=!j&&!tt&&ni(M);N=M,j||tt||lt?dt(S)?N=S:Jt(S)?N=Ae(S):tt?(H=!1,N=ff(M,!0)):lt?(H=!1,N=df(M,!0)):N=[]:es(M)||bn(M)?(N=S,bn(S)?N=hd(S):(!Wt(S)||Or(S))&&(N=Mf(M))):H=!1}H&&(A.set(M,N),_(N,M,p,b,A),A.delete(M)),nl(s,u,N)}function tf(s,a){var u=s.length;if(u)return a+=a<0?u:0,Br(a,u)?s[a]:e}function ef(s,a,u){a.length?a=Ht(a,function(b){return dt(b)?function(A){return yn(A,b.length===1?b[0]:b)}:b}):a=[Ie];var p=-1;a=Ht(a,De(ot()));var _=Zc(s,function(b,A,S){var M=Ht(a,function(L){return L(b)});return{criteria:M,index:++p,value:b}});return vy(_,function(b,A){return s0(b,A,u)})}function Yv(s,a){return rf(s,a,function(u,p){return kl(s,p)})}function rf(s,a,u){for(var p=-1,_=a.length,b={};++p<_;){var A=a[p],S=yn(s,A);u(S,A)&&Zi(b,Kr(A,s),S)}return b}function jv(s){return function(a){return yn(a,s)}}function fl(s,a,u,p){var _=p?yy:Vn,b=-1,A=a.length,S=s;for(s===a&&(a=Ae(a)),u&&(S=Ht(s,De(u)));++b<A;)for(var M=0,L=a[b],N=u?u(L):L;(M=_(S,N,M,p))>-1;)S!==s&&Ws.call(S,M,1),Ws.call(s,M,1);return s}function nf(s,a){for(var u=s?a.length:0,p=u-1;u--;){var _=a[u];if(u==p||_!==b){var b=_;Br(_)?Ws.call(s,_,1):ml(s,_)}}return s}function dl(s,a){return s+Vs(Nc()*(a-s+1))}function qv(s,a,u,p){for(var _=-1,b=ae(zs((a-s)/(u||1)),0),A=D(b);b--;)A[p?b:++_]=s,s+=u;return A}function pl(s,a){var u="";if(!s||a<1||a>_t)return u;do a%2&&(u+=s),a=Vs(a/2),a&&(s+=s);while(a);return u}function yt(s,a){return Ml(Of(s,a,Ie),s+"")}function Kv(s){return Gc(ii(s))}function Zv(s,a){var u=ii(s);return ho(u,_n(a,0,u.length))}function Zi(s,a,u,p){if(!Wt(s))return s;a=Kr(a,s);for(var _=-1,b=a.length,A=b-1,S=s;S!=null&&++_<b;){var M=gr(a[_]),L=u;if(M==="__proto__"||M==="constructor"||M==="prototype")return s;if(_!=A){var N=S[M];L=p?p(N,M,S):e,L===e&&(L=Wt(N)?N:Br(a[_+1])?[]:{})}Yi(S,M,L),S=S[M]}return s}var sf=Ys?function(s,a){return Ys.set(s,a),s}:Ie,Jv=Xs?function(s,a){return Xs(s,"toString",{configurable:!0,enumerable:!1,value:Hl(a),writable:!0})}:Ie;function Qv(s){return ho(ii(s))}function ze(s,a,u){var p=-1,_=s.length;a<0&&(a=-a>_?0:_+a),u=u>_?_:u,u<0&&(u+=_),_=a>u?0:u-a>>>0,a>>>=0;for(var b=D(_);++p<_;)b[p]=s[p+a];return b}function t0(s,a){var u;return jr(s,function(p,_,b){return u=a(p,_,b),!u}),!!u}function to(s,a,u){var p=0,_=s==null?p:s.length;if(typeof a=="number"&&a===a&&_<=It){for(;p<_;){var b=p+_>>>1,A=s[b];A!==null&&!Oe(A)&&(u?A<=a:A<a)?p=b+1:_=b}return _}return gl(s,a,Ie,u)}function gl(s,a,u,p){var _=0,b=s==null?0:s.length;if(b===0)return 0;a=u(a);for(var A=a!==a,S=a===null,M=Oe(a),L=a===e;_<b;){var N=Vs((_+b)/2),H=u(s[N]),j=H!==e,tt=H===null,lt=H===H,mt=Oe(H);if(A)var ht=p||lt;else L?ht=lt&&(p||j):S?ht=lt&&j&&(p||!tt):M?ht=lt&&j&&!tt&&(p||!mt):tt||mt?ht=!1:ht=p?H<=a:H<a;ht?_=N+1:b=N}return ye(b,xt)}function of(s,a){for(var u=-1,p=s.length,_=0,b=[];++u<p;){var A=s[u],S=a?a(A):A;if(!u||!Je(S,M)){var M=S;b[_++]=A===0?0:A}}return b}function af(s){return typeof s=="number"?s:Oe(s)?$:+s}function Be(s){if(typeof s=="string")return s;if(dt(s))return Ht(s,Be)+"";if(Oe(s))return Uc?Uc.call(s):"";var a=s+"";return a=="0"&&1/s==-V?"-0":a}function qr(s,a,u){var p=-1,_=Bs,b=s.length,A=!0,S=[],M=S;if(u)A=!1,_=Xa;else if(b>=i){var L=a?null:c0(s);if(L)return Fs(L);A=!1,_=Hi,M=new mn}else M=a?[]:S;t:for(;++p<b;){var N=s[p],H=a?a(N):N;if(N=u||N!==0?N:0,A&&H===H){for(var j=M.length;j--;)if(M[j]===H)continue t;a&&M.push(H),S.push(N)}else _(M,H,u)||(M!==S&&M.push(H),S.push(N))}return S}function ml(s,a){return a=Kr(a,s),s=Ff(s,a),s==null||delete s[gr(Ve(a))]}function lf(s,a,u,p){return Zi(s,a,u(yn(s,a)),p)}function eo(s,a,u,p){for(var _=s.length,b=p?_:-1;(p?b--:++b<_)&&a(s[b],b,s););return u?ze(s,p?0:b,p?b+1:_):ze(s,p?b+1:0,p?_:b)}function hf(s,a){var u=s;return u instanceof bt&&(u=u.value()),za(a,function(p,_){return _.func.apply(_.thisArg,zr([p],_.args))},u)}function _l(s,a,u){var p=s.length;if(p<2)return p?qr(s[0]):[];for(var _=-1,b=D(p);++_<p;)for(var A=s[_],S=-1;++S<p;)S!=_&&(b[_]=ji(b[_]||A,s[S],a,u));return qr(de(b,1),a,u)}function uf(s,a,u){for(var p=-1,_=s.length,b=a.length,A={};++p<_;){var S=p<b?a[p]:e;u(A,s[p],S)}return A}function yl(s){return Jt(s)?s:[]}function vl(s){return typeof s=="function"?s:Ie}function Kr(s,a){return dt(s)?s:Il(s,a)?[s]:kf(Rt(s))}var e0=yt;function Zr(s,a,u){var p=s.length;return u=u===e?p:u,!a&&u>=p?s:ze(s,a,u)}var cf=$y||function(s){return fe.clearTimeout(s)};function ff(s,a){if(a)return s.slice();var u=s.length,p=Dc?Dc(u):new s.constructor(u);return s.copy(p),p}function xl(s){var a=new s.constructor(s.byteLength);return new Hs(a).set(new Hs(s)),a}function r0(s,a){var u=a?xl(s.buffer):s.buffer;return new s.constructor(u,s.byteOffset,s.byteLength)}function n0(s){var a=new s.constructor(s.source,ju.exec(s));return a.lastIndex=s.lastIndex,a}function i0(s){return Vi?Ft(Vi.call(s)):{}}function df(s,a){var u=a?xl(s.buffer):s.buffer;return new s.constructor(u,s.byteOffset,s.length)}function pf(s,a){if(s!==a){var u=s!==e,p=s===null,_=s===s,b=Oe(s),A=a!==e,S=a===null,M=a===a,L=Oe(a);if(!S&&!L&&!b&&s>a||b&&A&&M&&!S&&!L||p&&A&&M||!u&&M||!_)return 1;if(!p&&!b&&!L&&s<a||L&&u&&_&&!p&&!b||S&&u&&_||!A&&_||!M)return-1}return 0}function s0(s,a,u){for(var p=-1,_=s.criteria,b=a.criteria,A=_.length,S=u.length;++p<A;){var M=pf(_[p],b[p]);if(M){if(p>=S)return M;var L=u[p];return M*(L=="desc"?-1:1)}}return s.index-a.index}function gf(s,a,u,p){for(var _=-1,b=s.length,A=u.length,S=-1,M=a.length,L=ae(b-A,0),N=D(M+L),H=!p;++S<M;)N[S]=a[S];for(;++_<A;)(H||_<b)&&(N[u[_]]=s[_]);for(;L--;)N[S++]=s[_++];return N}function mf(s,a,u,p){for(var _=-1,b=s.length,A=-1,S=u.length,M=-1,L=a.length,N=ae(b-S,0),H=D(N+L),j=!p;++_<N;)H[_]=s[_];for(var tt=_;++M<L;)H[tt+M]=a[M];for(;++A<S;)(j||_<b)&&(H[tt+u[A]]=s[_++]);return H}function Ae(s,a){var u=-1,p=s.length;for(a||(a=D(p));++u<p;)a[u]=s[u];return a}function pr(s,a,u,p){var _=!u;u||(u={});for(var b=-1,A=a.length;++b<A;){var S=a[b],M=p?p(u[S],s[S],S,u,s):e;M===e&&(M=s[S]),_?Pr(u,S,M):Yi(u,S,M)}return u}function o0(s,a){return pr(s,Cl(s),a)}function a0(s,a){return pr(s,Rf(s),a)}function ro(s,a){return function(u,p){var _=dt(u)?fy:Rv,b=a?a():{};return _(u,s,ot(p,2),b)}}function ti(s){return yt(function(a,u){var p=-1,_=u.length,b=_>1?u[_-1]:e,A=_>2?u[2]:e;for(b=s.length>3&&typeof b=="function"?(_--,b):e,A&&we(u[0],u[1],A)&&(b=_<3?e:b,_=1),a=Ft(a);++p<_;){var S=u[p];S&&s(a,S,p,b)}return a})}function _f(s,a){return function(u,p){if(u==null)return u;if(!Se(u))return s(u,p);for(var _=u.length,b=a?_:-1,A=Ft(u);(a?b--:++b<_)&&p(A[b],b,A)!==!1;);return u}}function yf(s){return function(a,u,p){for(var _=-1,b=Ft(a),A=p(a),S=A.length;S--;){var M=A[s?S:++_];if(u(b[M],M,b)===!1)break}return a}}function l0(s,a,u){var p=a&E,_=Ji(s);function b(){var A=this&&this!==fe&&this instanceof b?_:s;return A.apply(p?u:this,arguments)}return b}function vf(s){return function(a){a=Rt(a);var u=Yn(a)?Ke(a):e,p=u?u[0]:a.charAt(0),_=u?Zr(u,1).join(""):a.slice(1);return p[s]()+_}}function ei(s){return function(a){return za(_d(md(a).replace(J_,"")),s,"")}}function Ji(s){return function(){var a=arguments;switch(a.length){case 0:return new s;case 1:return new s(a[0]);case 2:return new s(a[0],a[1]);case 3:return new s(a[0],a[1],a[2]);case 4:return new s(a[0],a[1],a[2],a[3]);case 5:return new s(a[0],a[1],a[2],a[3],a[4]);case 6:return new s(a[0],a[1],a[2],a[3],a[4],a[5]);case 7:return new s(a[0],a[1],a[2],a[3],a[4],a[5],a[6])}var u=Qn(s.prototype),p=s.apply(u,a);return Wt(p)?p:u}}function h0(s,a,u){var p=Ji(s);function _(){for(var b=arguments.length,A=D(b),S=b,M=ri(_);S--;)A[S]=arguments[S];var L=b<3&&A[0]!==M&&A[b-1]!==M?[]:Vr(A,M);if(b-=L.length,b<u)return Tf(s,a,no,_.placeholder,e,A,L,e,e,u-b);var N=this&&this!==fe&&this instanceof _?p:s;return Me(N,this,A)}return _}function xf(s){return function(a,u,p){var _=Ft(a);if(!Se(a)){var b=ot(u,3);a=ue(a),u=function(S){return b(_[S],S,_)}}var A=s(a,u,p);return A>-1?_[b?a[A]:A]:e}}function bf(s){return Dr(function(a){var u=a.length,p=u,_=We.prototype.thru;for(s&&a.reverse();p--;){var b=a[p];if(typeof b!="function")throw new $e(l);if(_&&!A&&ao(b)=="wrapper")var A=new We([],!0)}for(p=A?p:u;++p<u;){b=a[p];var S=ao(b),M=S=="wrapper"?Al(b):e;M&&Rl(M[0])&&M[1]==(k|w|O|U)&&!M[4].length&&M[9]==1?A=A[ao(M[0])].apply(A,M[3]):A=b.length==1&&Rl(b)?A[S]():A.thru(b)}return function(){var L=arguments,N=L[0];if(A&&L.length==1&&dt(N))return A.plant(N).value();for(var H=0,j=u?a[H].apply(this,L):N;++H<u;)j=a[H].call(this,j);return j}})}function no(s,a,u,p,_,b,A,S,M,L){var N=a&k,H=a&E,j=a&I,tt=a&(w|R),lt=a&Y,mt=j?e:Ji(s);function ht(){for(var vt=arguments.length,Tt=D(vt),Fe=vt;Fe--;)Tt[Fe]=arguments[Fe];if(tt)var Ee=ri(ht),Le=by(Tt,Ee);if(p&&(Tt=gf(Tt,p,_,tt)),b&&(Tt=mf(Tt,b,A,tt)),vt-=Le,tt&&vt<L){var Qt=Vr(Tt,Ee);return Tf(s,a,no,ht.placeholder,u,Tt,Qt,S,M,L-vt)}var Qe=H?u:this,Lr=j?Qe[s]:s;return vt=Tt.length,S?Tt=R0(Tt,S):lt&&vt>1&&Tt.reverse(),N&&M<vt&&(Tt.length=M),this&&this!==fe&&this instanceof ht&&(Lr=mt||Ji(Lr)),Lr.apply(Qe,Tt)}return ht}function wf(s,a){return function(u,p){return Nv(u,s,a(p),{})}}function io(s,a){return function(u,p){var _;if(u===e&&p===e)return a;if(u!==e&&(_=u),p!==e){if(_===e)return p;typeof u=="string"||typeof p=="string"?(u=Be(u),p=Be(p)):(u=af(u),p=af(p)),_=s(u,p)}return _}}function bl(s){return Dr(function(a){return a=Ht(a,De(ot())),yt(function(u){var p=this;return s(a,function(_){return Me(_,p,u)})})})}function so(s,a){a=a===e?" ":Be(a);var u=a.length;if(u<2)return u?pl(a,s):a;var p=pl(a,zs(s/jn(a)));return Yn(a)?Zr(Ke(p),0,s).join(""):p.slice(0,s)}function u0(s,a,u,p){var _=a&E,b=Ji(s);function A(){for(var S=-1,M=arguments.length,L=-1,N=p.length,H=D(N+M),j=this&&this!==fe&&this instanceof A?b:s;++L<N;)H[L]=p[L];for(;M--;)H[L++]=arguments[++S];return Me(j,_?u:this,H)}return A}function Ef(s){return function(a,u,p){return p&&typeof p!="number"&&we(a,u,p)&&(u=p=e),a=Fr(a),u===e?(u=a,a=0):u=Fr(u),p=p===e?a<u?1:-1:Fr(p),qv(a,u,p,s)}}function oo(s){return function(a,u){return typeof a=="string"&&typeof u=="string"||(a=Ye(a),u=Ye(u)),s(a,u)}}function Tf(s,a,u,p,_,b,A,S,M,L){var N=a&w,H=N?A:e,j=N?e:A,tt=N?b:e,lt=N?e:b;a|=N?O:W,a&=~(N?W:O),a&P||(a&=~(E|I));var mt=[s,a,_,tt,H,lt,j,S,M,L],ht=u.apply(e,mt);return Rl(s)&&Lf(ht,mt),ht.placeholder=p,Nf(ht,s,a)}function wl(s){var a=oe[s];return function(u,p){if(u=Ye(u),p=p==null?0:ye(gt(p),292),p&&Lc(u)){var _=(Rt(u)+"e").split("e"),b=a(_[0]+"e"+(+_[1]+p));return _=(Rt(b)+"e").split("e"),+(_[0]+"e"+(+_[1]-p))}return a(u)}}var c0=Zn&&1/Fs(new Zn([,-0]))[1]==V?function(s){return new Zn(s)}:Xl;function Af(s){return function(a){var u=ve(a);return u==qt?Ja(a):u==qe?Iy(a):xy(a,s(a))}}function Mr(s,a,u,p,_,b,A,S){var M=a&I;if(!M&&typeof s!="function")throw new $e(l);var L=p?p.length:0;if(L||(a&=~(O|W),p=_=e),A=A===e?A:ae(gt(A),0),S=S===e?S:gt(S),L-=_?_.length:0,a&W){var N=p,H=_;p=_=e}var j=M?e:Al(s),tt=[s,a,u,p,_,N,H,b,A,S];if(j&&S0(tt,j),s=tt[0],a=tt[1],u=tt[2],p=tt[3],_=tt[4],S=tt[9]=tt[9]===e?M?0:s.length:ae(tt[9]-L,0),!S&&a&(w|R)&&(a&=~(w|R)),!a||a==E)var lt=l0(s,a,u);else a==w||a==R?lt=h0(s,a,S):(a==O||a==(E|O))&&!_.length?lt=u0(s,a,u,p):lt=no.apply(e,tt);var mt=j?sf:Lf;return Nf(mt(lt,tt),s,a)}function Sf(s,a,u,p){return s===e||Je(s,Kn[u])&&!Dt.call(p,u)?a:s}function Cf(s,a,u,p,_,b){return Wt(s)&&Wt(a)&&(b.set(a,s),Qs(s,a,e,Cf,b),b.delete(a)),s}function f0(s){return es(s)?e:s}function If(s,a,u,p,_,b){var A=u&v,S=s.length,M=a.length;if(S!=M&&!(A&&M>S))return!1;var L=b.get(s),N=b.get(a);if(L&&N)return L==a&&N==s;var H=-1,j=!0,tt=u&T?new mn:e;for(b.set(s,a),b.set(a,s);++H<S;){var lt=s[H],mt=a[H];if(p)var ht=A?p(mt,lt,H,a,s,b):p(lt,mt,H,s,a,b);if(ht!==e){if(ht)continue;j=!1;break}if(tt){if(!Va(a,function(vt,Tt){if(!Hi(tt,Tt)&&(lt===vt||_(lt,vt,u,p,b)))return tt.push(Tt)})){j=!1;break}}else if(!(lt===mt||_(lt,mt,u,p,b))){j=!1;break}}return b.delete(s),b.delete(a),j}function d0(s,a,u,p,_,b,A){switch(u){case Xn:if(s.byteLength!=a.byteLength||s.byteOffset!=a.byteOffset)return!1;s=s.buffer,a=a.buffer;case Gi:return!(s.byteLength!=a.byteLength||!b(new Hs(s),new Hs(a)));case Yt:case ne:case _e:return Je(+s,+a);case Mt:return s.name==a.name&&s.message==a.message;case Ni:case Ui:return s==a+"";case qt:var S=Ja;case qe:var M=p&v;if(S||(S=Fs),s.size!=a.size&&!M)return!1;var L=A.get(s);if(L)return L==a;p|=T,A.set(s,a);var N=If(S(s),S(a),p,_,b,A);return A.delete(s),N;case Rs:if(Vi)return Vi.call(s)==Vi.call(a)}return!1}function p0(s,a,u,p,_,b){var A=u&v,S=El(s),M=S.length,L=El(a),N=L.length;if(M!=N&&!A)return!1;for(var H=M;H--;){var j=S[H];if(!(A?j in a:Dt.call(a,j)))return!1}var tt=b.get(s),lt=b.get(a);if(tt&&lt)return tt==a&&lt==s;var mt=!0;b.set(s,a),b.set(a,s);for(var ht=A;++H<M;){j=S[H];var vt=s[j],Tt=a[j];if(p)var Fe=A?p(Tt,vt,j,a,s,b):p(vt,Tt,j,s,a,b);if(!(Fe===e?vt===Tt||_(vt,Tt,u,p,b):Fe)){mt=!1;break}ht||(ht=j=="constructor")}if(mt&&!ht){var Ee=s.constructor,Le=a.constructor;Ee!=Le&&"constructor"in s&&"constructor"in a&&!(typeof Ee=="function"&&Ee instanceof Ee&&typeof Le=="function"&&Le instanceof Le)&&(mt=!1)}return b.delete(s),b.delete(a),mt}function Dr(s){return Ml(Of(s,e,Wf),s+"")}function El(s){return Yc(s,ue,Cl)}function Tl(s){return Yc(s,Ce,Rf)}var Al=Ys?function(s){return Ys.get(s)}:Xl;function ao(s){for(var a=s.name+"",u=Jn[a],p=Dt.call(Jn,a)?u.length:0;p--;){var _=u[p],b=_.func;if(b==null||b==s)return _.name}return a}function ri(s){var a=Dt.call(x,"placeholder")?x:s;return a.placeholder}function ot(){var s=x.iteratee||$l;return s=s===$l?Kc:s,arguments.length?s(arguments[0],arguments[1]):s}function lo(s,a){var u=s.__data__;return w0(a)?u[typeof a=="string"?"string":"hash"]:u.map}function Sl(s){for(var a=ue(s),u=a.length;u--;){var p=a[u],_=s[p];a[u]=[p,_,Df(_)]}return a}function vn(s,a){var u=Ay(s,a);return qc(u)?u:e}function g0(s){var a=Dt.call(s,pn),u=s[pn];try{s[pn]=e;var p=!0}catch{}var _=ks.call(s);return p&&(a?s[pn]=u:delete s[pn]),_}var Cl=tl?function(s){return s==null?[]:(s=Ft(s),Xr(tl(s),function(a){return Oc.call(s,a)}))}:zl,Rf=tl?function(s){for(var a=[];s;)zr(a,Cl(s)),s=$s(s);return a}:zl,ve=be;(el&&ve(new el(new ArrayBuffer(1)))!=Xn||Wi&&ve(new Wi)!=qt||rl&&ve(rl.resolve())!=Xu||Zn&&ve(new Zn)!=qe||Xi&&ve(new Xi)!=ki)&&(ve=function(s){var a=be(s),u=a==fr?s.constructor:e,p=u?xn(u):"";if(p)switch(p){case Zy:return Xn;case Jy:return qt;case Qy:return Xu;case tv:return qe;case ev:return ki}return a});function m0(s,a,u){for(var p=-1,_=u.length;++p<_;){var b=u[p],A=b.size;switch(b.type){case"drop":s+=A;break;case"dropRight":a-=A;break;case"take":a=ye(a,s+A);break;case"takeRight":s=ae(s,a-A);break}}return{start:s,end:a}}function _0(s){var a=s.match(E_);return a?a[1].split(T_):[]}function Pf(s,a,u){a=Kr(a,s);for(var p=-1,_=a.length,b=!1;++p<_;){var A=gr(a[p]);if(!(b=s!=null&&u(s,A)))break;s=s[A]}return b||++p!=_?b:(_=s==null?0:s.length,!!_&&mo(_)&&Br(A,_)&&(dt(s)||bn(s)))}function y0(s){var a=s.length,u=new s.constructor(a);return a&&typeof s[0]=="string"&&Dt.call(s,"index")&&(u.index=s.index,u.input=s.input),u}function Mf(s){return typeof s.constructor=="function"&&!Qi(s)?Qn($s(s)):{}}function v0(s,a,u){var p=s.constructor;switch(a){case Gi:return xl(s);case Yt:case ne:return new p(+s);case Xn:return r0(s,u);case Sa:case Ca:case Ia:case Ra:case Pa:case Ma:case Da:case Ba:case Oa:return df(s,u);case qt:return new p;case _e:case Ui:return new p(s);case Ni:return n0(s);case qe:return new p;case Rs:return i0(s)}}function x0(s,a){var u=a.length;if(!u)return s;var p=u-1;return a[p]=(u>1?"& ":"")+a[p],a=a.join(u>2?", ":" "),s.replace(w_,`{
/* [wrapped with `+a+`] */
`)}function b0(s){return dt(s)||bn(s)||!!(Fc&&s&&s[Fc])}function Br(s,a){var u=typeof s;return a=a??_t,!!a&&(u=="number"||u!="symbol"&&B_.test(s))&&s>-1&&s%1==0&&s<a}function we(s,a,u){if(!Wt(u))return!1;var p=typeof a;return(p=="number"?Se(u)&&Br(a,u.length):p=="string"&&a in u)?Je(u[a],s):!1}function Il(s,a){if(dt(s))return!1;var u=typeof s;return u=="number"||u=="symbol"||u=="boolean"||s==null||Oe(s)?!0:y_.test(s)||!__.test(s)||a!=null&&s in Ft(a)}function w0(s){var a=typeof s;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?s!=="__proto__":s===null}function Rl(s){var a=ao(s),u=x[a];if(typeof u!="function"||!(a in bt.prototype))return!1;if(s===u)return!0;var p=Al(u);return!!p&&s===p[0]}function E0(s){return!!Mc&&Mc in s}var T0=Ns?Or:Vl;function Qi(s){var a=s&&s.constructor,u=typeof a=="function"&&a.prototype||Kn;return s===u}function Df(s){return s===s&&!Wt(s)}function Bf(s,a){return function(u){return u==null?!1:u[s]===a&&(a!==e||s in Ft(u))}}function A0(s){var a=po(s,function(p){return u.size===f&&u.clear(),p}),u=a.cache;return a}function S0(s,a){var u=s[1],p=a[1],_=u|p,b=_<(E|I|k),A=p==k&&u==w||p==k&&u==U&&s[7].length<=a[8]||p==(k|U)&&a[7].length<=a[8]&&u==w;if(!(b||A))return s;p&E&&(s[2]=a[2],_|=u&E?0:P);var S=a[3];if(S){var M=s[3];s[3]=M?gf(M,S,a[4]):S,s[4]=M?Vr(s[3],d):a[4]}return S=a[5],S&&(M=s[5],s[5]=M?mf(M,S,a[6]):S,s[6]=M?Vr(s[5],d):a[6]),S=a[7],S&&(s[7]=S),p&k&&(s[8]=s[8]==null?a[8]:ye(s[8],a[8])),s[9]==null&&(s[9]=a[9]),s[0]=a[0],s[1]=_,s}function C0(s){var a=[];if(s!=null)for(var u in Ft(s))a.push(u);return a}function I0(s){return ks.call(s)}function Of(s,a,u){return a=ae(a===e?s.length-1:a,0),function(){for(var p=arguments,_=-1,b=ae(p.length-a,0),A=D(b);++_<b;)A[_]=p[a+_];_=-1;for(var S=D(a+1);++_<a;)S[_]=p[_];return S[a]=u(A),Me(s,this,S)}}function Ff(s,a){return a.length<2?s:yn(s,ze(a,0,-1))}function R0(s,a){for(var u=s.length,p=ye(a.length,u),_=Ae(s);p--;){var b=a[p];s[p]=Br(b,u)?_[b]:e}return s}function Pl(s,a){if(!(a==="constructor"&&typeof s[a]=="function")&&a!="__proto__")return s[a]}var Lf=Uf(sf),ts=Xy||function(s,a){return fe.setTimeout(s,a)},Ml=Uf(Jv);function Nf(s,a,u){var p=a+"";return Ml(s,x0(p,P0(_0(p),u)))}function Uf(s){var a=0,u=0;return function(){var p=jy(),_=G-(p-u);if(u=p,_>0){if(++a>=q)return arguments[0]}else a=0;return s.apply(e,arguments)}}function ho(s,a){var u=-1,p=s.length,_=p-1;for(a=a===e?p:a;++u<a;){var b=dl(u,_),A=s[b];s[b]=s[u],s[u]=A}return s.length=a,s}var kf=A0(function(s){var a=[];return s.charCodeAt(0)===46&&a.push(""),s.replace(v_,function(u,p,_,b){a.push(_?b.replace(C_,"$1"):p||u)}),a});function gr(s){if(typeof s=="string"||Oe(s))return s;var a=s+"";return a=="0"&&1/s==-V?"-0":a}function xn(s){if(s!=null){try{return Us.call(s)}catch{}try{return s+""}catch{}}return""}function P0(s,a){return He(Pt,function(u){var p="_."+u[0];a&u[1]&&!Bs(s,p)&&s.push(p)}),s.sort()}function Gf(s){if(s instanceof bt)return s.clone();var a=new We(s.__wrapped__,s.__chain__);return a.__actions__=Ae(s.__actions__),a.__index__=s.__index__,a.__values__=s.__values__,a}function M0(s,a,u){(u?we(s,a,u):a===e)?a=1:a=ae(gt(a),0);var p=s==null?0:s.length;if(!p||a<1)return[];for(var _=0,b=0,A=D(zs(p/a));_<p;)A[b++]=ze(s,_,_+=a);return A}function D0(s){for(var a=-1,u=s==null?0:s.length,p=0,_=[];++a<u;){var b=s[a];b&&(_[p++]=b)}return _}function B0(){var s=arguments.length;if(!s)return[];for(var a=D(s-1),u=arguments[0],p=s;p--;)a[p-1]=arguments[p];return zr(dt(u)?Ae(u):[u],de(a,1))}var O0=yt(function(s,a){return Jt(s)?ji(s,de(a,1,Jt,!0)):[]}),F0=yt(function(s,a){var u=Ve(a);return Jt(u)&&(u=e),Jt(s)?ji(s,de(a,1,Jt,!0),ot(u,2)):[]}),L0=yt(function(s,a){var u=Ve(a);return Jt(u)&&(u=e),Jt(s)?ji(s,de(a,1,Jt,!0),e,u):[]});function N0(s,a,u){var p=s==null?0:s.length;return p?(a=u||a===e?1:gt(a),ze(s,a<0?0:a,p)):[]}function U0(s,a,u){var p=s==null?0:s.length;return p?(a=u||a===e?1:gt(a),a=p-a,ze(s,0,a<0?0:a)):[]}function k0(s,a){return s&&s.length?eo(s,ot(a,3),!0,!0):[]}function G0(s,a){return s&&s.length?eo(s,ot(a,3),!0):[]}function H0(s,a,u,p){var _=s==null?0:s.length;return _?(u&&typeof u!="number"&&we(s,a,u)&&(u=0,p=_),Bv(s,a,u,p)):[]}function Hf(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var _=u==null?0:gt(u);return _<0&&(_=ae(p+_,0)),Os(s,ot(a,3),_)}function $f(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var _=p-1;return u!==e&&(_=gt(u),_=u<0?ae(p+_,0):ye(_,p-1)),Os(s,ot(a,3),_,!0)}function Wf(s){var a=s==null?0:s.length;return a?de(s,1):[]}function $0(s){var a=s==null?0:s.length;return a?de(s,V):[]}function W0(s,a){var u=s==null?0:s.length;return u?(a=a===e?1:gt(a),de(s,a)):[]}function X0(s){for(var a=-1,u=s==null?0:s.length,p={};++a<u;){var _=s[a];p[_[0]]=_[1]}return p}function Xf(s){return s&&s.length?s[0]:e}function z0(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var _=u==null?0:gt(u);return _<0&&(_=ae(p+_,0)),Vn(s,a,_)}function V0(s){var a=s==null?0:s.length;return a?ze(s,0,-1):[]}var Y0=yt(function(s){var a=Ht(s,yl);return a.length&&a[0]===s[0]?ll(a):[]}),j0=yt(function(s){var a=Ve(s),u=Ht(s,yl);return a===Ve(u)?a=e:u.pop(),u.length&&u[0]===s[0]?ll(u,ot(a,2)):[]}),q0=yt(function(s){var a=Ve(s),u=Ht(s,yl);return a=typeof a=="function"?a:e,a&&u.pop(),u.length&&u[0]===s[0]?ll(u,e,a):[]});function K0(s,a){return s==null?"":Vy.call(s,a)}function Ve(s){var a=s==null?0:s.length;return a?s[a-1]:e}function Z0(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var _=p;return u!==e&&(_=gt(u),_=_<0?ae(p+_,0):ye(_,p-1)),a===a?Py(s,a,_):Os(s,Ec,_,!0)}function J0(s,a){return s&&s.length?tf(s,gt(a)):e}var Q0=yt(zf);function zf(s,a){return s&&s.length&&a&&a.length?fl(s,a):s}function tx(s,a,u){return s&&s.length&&a&&a.length?fl(s,a,ot(u,2)):s}function ex(s,a,u){return s&&s.length&&a&&a.length?fl(s,a,e,u):s}var rx=Dr(function(s,a){var u=s==null?0:s.length,p=il(s,a);return nf(s,Ht(a,function(_){return Br(_,u)?+_:_}).sort(pf)),p});function nx(s,a){var u=[];if(!(s&&s.length))return u;var p=-1,_=[],b=s.length;for(a=ot(a,3);++p<b;){var A=s[p];a(A,p,s)&&(u.push(A),_.push(p))}return nf(s,_),u}function Dl(s){return s==null?s:Ky.call(s)}function ix(s,a,u){var p=s==null?0:s.length;return p?(u&&typeof u!="number"&&we(s,a,u)?(a=0,u=p):(a=a==null?0:gt(a),u=u===e?p:gt(u)),ze(s,a,u)):[]}function sx(s,a){return to(s,a)}function ox(s,a,u){return gl(s,a,ot(u,2))}function ax(s,a){var u=s==null?0:s.length;if(u){var p=to(s,a);if(p<u&&Je(s[p],a))return p}return-1}function lx(s,a){return to(s,a,!0)}function hx(s,a,u){return gl(s,a,ot(u,2),!0)}function ux(s,a){var u=s==null?0:s.length;if(u){var p=to(s,a,!0)-1;if(Je(s[p],a))return p}return-1}function cx(s){return s&&s.length?of(s):[]}function fx(s,a){return s&&s.length?of(s,ot(a,2)):[]}function dx(s){var a=s==null?0:s.length;return a?ze(s,1,a):[]}function px(s,a,u){return s&&s.length?(a=u||a===e?1:gt(a),ze(s,0,a<0?0:a)):[]}function gx(s,a,u){var p=s==null?0:s.length;return p?(a=u||a===e?1:gt(a),a=p-a,ze(s,a<0?0:a,p)):[]}function mx(s,a){return s&&s.length?eo(s,ot(a,3),!1,!0):[]}function _x(s,a){return s&&s.length?eo(s,ot(a,3)):[]}var yx=yt(function(s){return qr(de(s,1,Jt,!0))}),vx=yt(function(s){var a=Ve(s);return Jt(a)&&(a=e),qr(de(s,1,Jt,!0),ot(a,2))}),xx=yt(function(s){var a=Ve(s);return a=typeof a=="function"?a:e,qr(de(s,1,Jt,!0),e,a)});function bx(s){return s&&s.length?qr(s):[]}function wx(s,a){return s&&s.length?qr(s,ot(a,2)):[]}function Ex(s,a){return a=typeof a=="function"?a:e,s&&s.length?qr(s,e,a):[]}function Bl(s){if(!(s&&s.length))return[];var a=0;return s=Xr(s,function(u){if(Jt(u))return a=ae(u.length,a),!0}),Ka(a,function(u){return Ht(s,Ya(u))})}function Vf(s,a){if(!(s&&s.length))return[];var u=Bl(s);return a==null?u:Ht(u,function(p){return Me(a,e,p)})}var Tx=yt(function(s,a){return Jt(s)?ji(s,a):[]}),Ax=yt(function(s){return _l(Xr(s,Jt))}),Sx=yt(function(s){var a=Ve(s);return Jt(a)&&(a=e),_l(Xr(s,Jt),ot(a,2))}),Cx=yt(function(s){var a=Ve(s);return a=typeof a=="function"?a:e,_l(Xr(s,Jt),e,a)}),Ix=yt(Bl);function Rx(s,a){return uf(s||[],a||[],Yi)}function Px(s,a){return uf(s||[],a||[],Zi)}var Mx=yt(function(s){var a=s.length,u=a>1?s[a-1]:e;return u=typeof u=="function"?(s.pop(),u):e,Vf(s,u)});function Yf(s){var a=x(s);return a.__chain__=!0,a}function Dx(s,a){return a(s),s}function uo(s,a){return a(s)}var Bx=Dr(function(s){var a=s.length,u=a?s[0]:0,p=this.__wrapped__,_=function(b){return il(b,s)};return a>1||this.__actions__.length||!(p instanceof bt)||!Br(u)?this.thru(_):(p=p.slice(u,+u+(a?1:0)),p.__actions__.push({func:uo,args:[_],thisArg:e}),new We(p,this.__chain__).thru(function(b){return a&&!b.length&&b.push(e),b}))});function Ox(){return Yf(this)}function Fx(){return new We(this.value(),this.__chain__)}function Lx(){this.__values__===e&&(this.__values__=ad(this.value()));var s=this.__index__>=this.__values__.length,a=s?e:this.__values__[this.__index__++];return{done:s,value:a}}function Nx(){return this}function Ux(s){for(var a,u=this;u instanceof qs;){var p=Gf(u);p.__index__=0,p.__values__=e,a?_.__wrapped__=p:a=p;var _=p;u=u.__wrapped__}return _.__wrapped__=s,a}function kx(){var s=this.__wrapped__;if(s instanceof bt){var a=s;return this.__actions__.length&&(a=new bt(this)),a=a.reverse(),a.__actions__.push({func:uo,args:[Dl],thisArg:e}),new We(a,this.__chain__)}return this.thru(Dl)}function Gx(){return hf(this.__wrapped__,this.__actions__)}var Hx=ro(function(s,a,u){Dt.call(s,u)?++s[u]:Pr(s,u,1)});function $x(s,a,u){var p=dt(s)?bc:Dv;return u&&we(s,a,u)&&(a=e),p(s,ot(a,3))}function Wx(s,a){var u=dt(s)?Xr:zc;return u(s,ot(a,3))}var Xx=xf(Hf),zx=xf($f);function Vx(s,a){return de(co(s,a),1)}function Yx(s,a){return de(co(s,a),V)}function jx(s,a,u){return u=u===e?1:gt(u),de(co(s,a),u)}function jf(s,a){var u=dt(s)?He:jr;return u(s,ot(a,3))}function qf(s,a){var u=dt(s)?dy:Xc;return u(s,ot(a,3))}var qx=ro(function(s,a,u){Dt.call(s,u)?s[u].push(a):Pr(s,u,[a])});function Kx(s,a,u,p){s=Se(s)?s:ii(s),u=u&&!p?gt(u):0;var _=s.length;return u<0&&(u=ae(_+u,0)),_o(s)?u<=_&&s.indexOf(a,u)>-1:!!_&&Vn(s,a,u)>-1}var Zx=yt(function(s,a,u){var p=-1,_=typeof a=="function",b=Se(s)?D(s.length):[];return jr(s,function(A){b[++p]=_?Me(a,A,u):qi(A,a,u)}),b}),Jx=ro(function(s,a,u){Pr(s,u,a)});function co(s,a){var u=dt(s)?Ht:Zc;return u(s,ot(a,3))}function Qx(s,a,u,p){return s==null?[]:(dt(a)||(a=a==null?[]:[a]),u=p?e:u,dt(u)||(u=u==null?[]:[u]),ef(s,a,u))}var tb=ro(function(s,a,u){s[u?0:1].push(a)},function(){return[[],[]]});function eb(s,a,u){var p=dt(s)?za:Ac,_=arguments.length<3;return p(s,ot(a,4),u,_,jr)}function rb(s,a,u){var p=dt(s)?py:Ac,_=arguments.length<3;return p(s,ot(a,4),u,_,Xc)}function nb(s,a){var u=dt(s)?Xr:zc;return u(s,go(ot(a,3)))}function ib(s){var a=dt(s)?Gc:Kv;return a(s)}function sb(s,a,u){(u?we(s,a,u):a===e)?a=1:a=gt(a);var p=dt(s)?Cv:Zv;return p(s,a)}function ob(s){var a=dt(s)?Iv:Qv;return a(s)}function ab(s){if(s==null)return 0;if(Se(s))return _o(s)?jn(s):s.length;var a=ve(s);return a==qt||a==qe?s.size:ul(s).length}function lb(s,a,u){var p=dt(s)?Va:t0;return u&&we(s,a,u)&&(a=e),p(s,ot(a,3))}var hb=yt(function(s,a){if(s==null)return[];var u=a.length;return u>1&&we(s,a[0],a[1])?a=[]:u>2&&we(a[0],a[1],a[2])&&(a=[a[0]]),ef(s,de(a,1),[])}),fo=Wy||function(){return fe.Date.now()};function ub(s,a){if(typeof a!="function")throw new $e(l);return s=gt(s),function(){if(--s<1)return a.apply(this,arguments)}}function Kf(s,a,u){return a=u?e:a,a=s&&a==null?s.length:a,Mr(s,k,e,e,e,e,a)}function Zf(s,a){var u;if(typeof a!="function")throw new $e(l);return s=gt(s),function(){return--s>0&&(u=a.apply(this,arguments)),s<=1&&(a=e),u}}var Ol=yt(function(s,a,u){var p=E;if(u.length){var _=Vr(u,ri(Ol));p|=O}return Mr(s,p,a,u,_)}),Jf=yt(function(s,a,u){var p=E|I;if(u.length){var _=Vr(u,ri(Jf));p|=O}return Mr(a,p,s,u,_)});function Qf(s,a,u){a=u?e:a;var p=Mr(s,w,e,e,e,e,e,a);return p.placeholder=Qf.placeholder,p}function td(s,a,u){a=u?e:a;var p=Mr(s,R,e,e,e,e,e,a);return p.placeholder=td.placeholder,p}function ed(s,a,u){var p,_,b,A,S,M,L=0,N=!1,H=!1,j=!0;if(typeof s!="function")throw new $e(l);a=Ye(a)||0,Wt(u)&&(N=!!u.leading,H="maxWait"in u,b=H?ae(Ye(u.maxWait)||0,a):b,j="trailing"in u?!!u.trailing:j);function tt(Qt){var Qe=p,Lr=_;return p=_=e,L=Qt,A=s.apply(Lr,Qe),A}function lt(Qt){return L=Qt,S=ts(vt,a),N?tt(Qt):A}function mt(Qt){var Qe=Qt-M,Lr=Qt-L,xd=a-Qe;return H?ye(xd,b-Lr):xd}function ht(Qt){var Qe=Qt-M,Lr=Qt-L;return M===e||Qe>=a||Qe<0||H&&Lr>=b}function vt(){var Qt=fo();if(ht(Qt))return Tt(Qt);S=ts(vt,mt(Qt))}function Tt(Qt){return S=e,j&&p?tt(Qt):(p=_=e,A)}function Fe(){S!==e&&cf(S),L=0,p=M=_=S=e}function Ee(){return S===e?A:Tt(fo())}function Le(){var Qt=fo(),Qe=ht(Qt);if(p=arguments,_=this,M=Qt,Qe){if(S===e)return lt(M);if(H)return cf(S),S=ts(vt,a),tt(M)}return S===e&&(S=ts(vt,a)),A}return Le.cancel=Fe,Le.flush=Ee,Le}var cb=yt(function(s,a){return Wc(s,1,a)}),fb=yt(function(s,a,u){return Wc(s,Ye(a)||0,u)});function db(s){return Mr(s,Y)}function po(s,a){if(typeof s!="function"||a!=null&&typeof a!="function")throw new $e(l);var u=function(){var p=arguments,_=a?a.apply(this,p):p[0],b=u.cache;if(b.has(_))return b.get(_);var A=s.apply(this,p);return u.cache=b.set(_,A)||b,A};return u.cache=new(po.Cache||Rr),u}po.Cache=Rr;function go(s){if(typeof s!="function")throw new $e(l);return function(){var a=arguments;switch(a.length){case 0:return!s.call(this);case 1:return!s.call(this,a[0]);case 2:return!s.call(this,a[0],a[1]);case 3:return!s.call(this,a[0],a[1],a[2])}return!s.apply(this,a)}}function pb(s){return Zf(2,s)}var gb=e0(function(s,a){a=a.length==1&&dt(a[0])?Ht(a[0],De(ot())):Ht(de(a,1),De(ot()));var u=a.length;return yt(function(p){for(var _=-1,b=ye(p.length,u);++_<b;)p[_]=a[_].call(this,p[_]);return Me(s,this,p)})}),Fl=yt(function(s,a){var u=Vr(a,ri(Fl));return Mr(s,O,e,a,u)}),rd=yt(function(s,a){var u=Vr(a,ri(rd));return Mr(s,W,e,a,u)}),mb=Dr(function(s,a){return Mr(s,U,e,e,e,a)});function _b(s,a){if(typeof s!="function")throw new $e(l);return a=a===e?a:gt(a),yt(s,a)}function yb(s,a){if(typeof s!="function")throw new $e(l);return a=a==null?0:ae(gt(a),0),yt(function(u){var p=u[a],_=Zr(u,0,a);return p&&zr(_,p),Me(s,this,_)})}function vb(s,a,u){var p=!0,_=!0;if(typeof s!="function")throw new $e(l);return Wt(u)&&(p="leading"in u?!!u.leading:p,_="trailing"in u?!!u.trailing:_),ed(s,a,{leading:p,maxWait:a,trailing:_})}function xb(s){return Kf(s,1)}function bb(s,a){return Fl(vl(a),s)}function wb(){if(!arguments.length)return[];var s=arguments[0];return dt(s)?s:[s]}function Eb(s){return Xe(s,y)}function Tb(s,a){return a=typeof a=="function"?a:e,Xe(s,y,a)}function Ab(s){return Xe(s,m|y)}function Sb(s,a){return a=typeof a=="function"?a:e,Xe(s,m|y,a)}function Cb(s,a){return a==null||$c(s,a,ue(a))}function Je(s,a){return s===a||s!==s&&a!==a}var Ib=oo(al),Rb=oo(function(s,a){return s>=a}),bn=jc(function(){return arguments}())?jc:function(s){return Kt(s)&&Dt.call(s,"callee")&&!Oc.call(s,"callee")},dt=D.isArray,Pb=gc?De(gc):Uv;function Se(s){return s!=null&&mo(s.length)&&!Or(s)}function Jt(s){return Kt(s)&&Se(s)}function Mb(s){return s===!0||s===!1||Kt(s)&&be(s)==Yt}var Jr=zy||Vl,Db=mc?De(mc):kv;function Bb(s){return Kt(s)&&s.nodeType===1&&!es(s)}function Ob(s){if(s==null)return!0;if(Se(s)&&(dt(s)||typeof s=="string"||typeof s.splice=="function"||Jr(s)||ni(s)||bn(s)))return!s.length;var a=ve(s);if(a==qt||a==qe)return!s.size;if(Qi(s))return!ul(s).length;for(var u in s)if(Dt.call(s,u))return!1;return!0}function Fb(s,a){return Ki(s,a)}function Lb(s,a,u){u=typeof u=="function"?u:e;var p=u?u(s,a):e;return p===e?Ki(s,a,e,u):!!p}function Ll(s){if(!Kt(s))return!1;var a=be(s);return a==Mt||a==se||typeof s.message=="string"&&typeof s.name=="string"&&!es(s)}function Nb(s){return typeof s=="number"&&Lc(s)}function Or(s){if(!Wt(s))return!1;var a=be(s);return a==kt||a==jt||a==re||a==a_}function nd(s){return typeof s=="number"&&s==gt(s)}function mo(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=_t}function Wt(s){var a=typeof s;return s!=null&&(a=="object"||a=="function")}function Kt(s){return s!=null&&typeof s=="object"}var id=_c?De(_c):Hv;function Ub(s,a){return s===a||hl(s,a,Sl(a))}function kb(s,a,u){return u=typeof u=="function"?u:e,hl(s,a,Sl(a),u)}function Gb(s){return sd(s)&&s!=+s}function Hb(s){if(T0(s))throw new ct(o);return qc(s)}function $b(s){return s===null}function Wb(s){return s==null}function sd(s){return typeof s=="number"||Kt(s)&&be(s)==_e}function es(s){if(!Kt(s)||be(s)!=fr)return!1;var a=$s(s);if(a===null)return!0;var u=Dt.call(a,"constructor")&&a.constructor;return typeof u=="function"&&u instanceof u&&Us.call(u)==ky}var Nl=yc?De(yc):$v;function Xb(s){return nd(s)&&s>=-_t&&s<=_t}var od=vc?De(vc):Wv;function _o(s){return typeof s=="string"||!dt(s)&&Kt(s)&&be(s)==Ui}function Oe(s){return typeof s=="symbol"||Kt(s)&&be(s)==Rs}var ni=xc?De(xc):Xv;function zb(s){return s===e}function Vb(s){return Kt(s)&&ve(s)==ki}function Yb(s){return Kt(s)&&be(s)==h_}var jb=oo(cl),qb=oo(function(s,a){return s<=a});function ad(s){if(!s)return[];if(Se(s))return _o(s)?Ke(s):Ae(s);if($i&&s[$i])return Cy(s[$i]());var a=ve(s),u=a==qt?Ja:a==qe?Fs:ii;return u(s)}function Fr(s){if(!s)return s===0?s:0;if(s=Ye(s),s===V||s===-V){var a=s<0?-1:1;return a*Ot}return s===s?s:0}function gt(s){var a=Fr(s),u=a%1;return a===a?u?a-u:a:0}function ld(s){return s?_n(gt(s),0,rt):0}function Ye(s){if(typeof s=="number")return s;if(Oe(s))return $;if(Wt(s)){var a=typeof s.valueOf=="function"?s.valueOf():s;s=Wt(a)?a+"":a}if(typeof s!="string")return s===0?s:+s;s=Sc(s);var u=P_.test(s);return u||D_.test(s)?uy(s.slice(2),u?2:8):R_.test(s)?$:+s}function hd(s){return pr(s,Ce(s))}function Kb(s){return s?_n(gt(s),-_t,_t):s===0?s:0}function Rt(s){return s==null?"":Be(s)}var Zb=ti(function(s,a){if(Qi(a)||Se(a)){pr(a,ue(a),s);return}for(var u in a)Dt.call(a,u)&&Yi(s,u,a[u])}),ud=ti(function(s,a){pr(a,Ce(a),s)}),yo=ti(function(s,a,u,p){pr(a,Ce(a),s,p)}),Jb=ti(function(s,a,u,p){pr(a,ue(a),s,p)}),Qb=Dr(il);function t1(s,a){var u=Qn(s);return a==null?u:Hc(u,a)}var e1=yt(function(s,a){s=Ft(s);var u=-1,p=a.length,_=p>2?a[2]:e;for(_&&we(a[0],a[1],_)&&(p=1);++u<p;)for(var b=a[u],A=Ce(b),S=-1,M=A.length;++S<M;){var L=A[S],N=s[L];(N===e||Je(N,Kn[L])&&!Dt.call(s,L))&&(s[L]=b[L])}return s}),r1=yt(function(s){return s.push(e,Cf),Me(cd,e,s)});function n1(s,a){return wc(s,ot(a,3),dr)}function i1(s,a){return wc(s,ot(a,3),ol)}function s1(s,a){return s==null?s:sl(s,ot(a,3),Ce)}function o1(s,a){return s==null?s:Vc(s,ot(a,3),Ce)}function a1(s,a){return s&&dr(s,ot(a,3))}function l1(s,a){return s&&ol(s,ot(a,3))}function h1(s){return s==null?[]:Js(s,ue(s))}function u1(s){return s==null?[]:Js(s,Ce(s))}function Ul(s,a,u){var p=s==null?e:yn(s,a);return p===e?u:p}function c1(s,a){return s!=null&&Pf(s,a,Ov)}function kl(s,a){return s!=null&&Pf(s,a,Fv)}var f1=wf(function(s,a,u){a!=null&&typeof a.toString!="function"&&(a=ks.call(a)),s[a]=u},Hl(Ie)),d1=wf(function(s,a,u){a!=null&&typeof a.toString!="function"&&(a=ks.call(a)),Dt.call(s,a)?s[a].push(u):s[a]=[u]},ot),p1=yt(qi);function ue(s){return Se(s)?kc(s):ul(s)}function Ce(s){return Se(s)?kc(s,!0):zv(s)}function g1(s,a){var u={};return a=ot(a,3),dr(s,function(p,_,b){Pr(u,a(p,_,b),p)}),u}function m1(s,a){var u={};return a=ot(a,3),dr(s,function(p,_,b){Pr(u,_,a(p,_,b))}),u}var _1=ti(function(s,a,u){Qs(s,a,u)}),cd=ti(function(s,a,u,p){Qs(s,a,u,p)}),y1=Dr(function(s,a){var u={};if(s==null)return u;var p=!1;a=Ht(a,function(b){return b=Kr(b,s),p||(p=b.length>1),b}),pr(s,Tl(s),u),p&&(u=Xe(u,m|g|y,f0));for(var _=a.length;_--;)ml(u,a[_]);return u});function v1(s,a){return fd(s,go(ot(a)))}var x1=Dr(function(s,a){return s==null?{}:Yv(s,a)});function fd(s,a){if(s==null)return{};var u=Ht(Tl(s),function(p){return[p]});return a=ot(a),rf(s,u,function(p,_){return a(p,_[0])})}function b1(s,a,u){a=Kr(a,s);var p=-1,_=a.length;for(_||(_=1,s=e);++p<_;){var b=s==null?e:s[gr(a[p])];b===e&&(p=_,b=u),s=Or(b)?b.call(s):b}return s}function w1(s,a,u){return s==null?s:Zi(s,a,u)}function E1(s,a,u,p){return p=typeof p=="function"?p:e,s==null?s:Zi(s,a,u,p)}var dd=Af(ue),pd=Af(Ce);function T1(s,a,u){var p=dt(s),_=p||Jr(s)||ni(s);if(a=ot(a,4),u==null){var b=s&&s.constructor;_?u=p?new b:[]:Wt(s)?u=Or(b)?Qn($s(s)):{}:u={}}return(_?He:dr)(s,function(A,S,M){return a(u,A,S,M)}),u}function A1(s,a){return s==null?!0:ml(s,a)}function S1(s,a,u){return s==null?s:lf(s,a,vl(u))}function C1(s,a,u,p){return p=typeof p=="function"?p:e,s==null?s:lf(s,a,vl(u),p)}function ii(s){return s==null?[]:Za(s,ue(s))}function I1(s){return s==null?[]:Za(s,Ce(s))}function R1(s,a,u){return u===e&&(u=a,a=e),u!==e&&(u=Ye(u),u=u===u?u:0),a!==e&&(a=Ye(a),a=a===a?a:0),_n(Ye(s),a,u)}function P1(s,a,u){return a=Fr(a),u===e?(u=a,a=0):u=Fr(u),s=Ye(s),Lv(s,a,u)}function M1(s,a,u){if(u&&typeof u!="boolean"&&we(s,a,u)&&(a=u=e),u===e&&(typeof a=="boolean"?(u=a,a=e):typeof s=="boolean"&&(u=s,s=e)),s===e&&a===e?(s=0,a=1):(s=Fr(s),a===e?(a=s,s=0):a=Fr(a)),s>a){var p=s;s=a,a=p}if(u||s%1||a%1){var _=Nc();return ye(s+_*(a-s+hy("1e-"+((_+"").length-1))),a)}return dl(s,a)}var D1=ei(function(s,a,u){return a=a.toLowerCase(),s+(u?gd(a):a)});function gd(s){return Gl(Rt(s).toLowerCase())}function md(s){return s=Rt(s),s&&s.replace(O_,wy).replace(Q_,"")}function B1(s,a,u){s=Rt(s),a=Be(a);var p=s.length;u=u===e?p:_n(gt(u),0,p);var _=u;return u-=a.length,u>=0&&s.slice(u,_)==a}function O1(s){return s=Rt(s),s&&p_.test(s)?s.replace(Vu,Ey):s}function F1(s){return s=Rt(s),s&&x_.test(s)?s.replace(Fa,"\\$&"):s}var L1=ei(function(s,a,u){return s+(u?"-":"")+a.toLowerCase()}),N1=ei(function(s,a,u){return s+(u?" ":"")+a.toLowerCase()}),U1=vf("toLowerCase");function k1(s,a,u){s=Rt(s),a=gt(a);var p=a?jn(s):0;if(!a||p>=a)return s;var _=(a-p)/2;return so(Vs(_),u)+s+so(zs(_),u)}function G1(s,a,u){s=Rt(s),a=gt(a);var p=a?jn(s):0;return a&&p<a?s+so(a-p,u):s}function H1(s,a,u){s=Rt(s),a=gt(a);var p=a?jn(s):0;return a&&p<a?so(a-p,u)+s:s}function $1(s,a,u){return u||a==null?a=0:a&&(a=+a),qy(Rt(s).replace(La,""),a||0)}function W1(s,a,u){return(u?we(s,a,u):a===e)?a=1:a=gt(a),pl(Rt(s),a)}function X1(){var s=arguments,a=Rt(s[0]);return s.length<3?a:a.replace(s[1],s[2])}var z1=ei(function(s,a,u){return s+(u?"_":"")+a.toLowerCase()});function V1(s,a,u){return u&&typeof u!="number"&&we(s,a,u)&&(a=u=e),u=u===e?rt:u>>>0,u?(s=Rt(s),s&&(typeof a=="string"||a!=null&&!Nl(a))&&(a=Be(a),!a&&Yn(s))?Zr(Ke(s),0,u):s.split(a,u)):[]}var Y1=ei(function(s,a,u){return s+(u?" ":"")+Gl(a)});function j1(s,a,u){return s=Rt(s),u=u==null?0:_n(gt(u),0,s.length),a=Be(a),s.slice(u,u+a.length)==a}function q1(s,a,u){var p=x.templateSettings;u&&we(s,a,u)&&(a=e),s=Rt(s),a=yo({},a,p,Sf);var _=yo({},a.imports,p.imports,Sf),b=ue(_),A=Za(_,b),S,M,L=0,N=a.interpolate||Ps,H="__p += '",j=Qa((a.escape||Ps).source+"|"+N.source+"|"+(N===Yu?I_:Ps).source+"|"+(a.evaluate||Ps).source+"|$","g"),tt="//# sourceURL="+(Dt.call(a,"sourceURL")?(a.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++iy+"]")+`
`;s.replace(j,function(ht,vt,Tt,Fe,Ee,Le){return Tt||(Tt=Fe),H+=s.slice(L,Le).replace(F_,Ty),vt&&(S=!0,H+=`' +
__e(`+vt+`) +
'`),Ee&&(M=!0,H+=`';
`+Ee+`;
__p += '`),Tt&&(H+=`' +
((__t = (`+Tt+`)) == null ? '' : __t) +
'`),L=Le+ht.length,ht}),H+=`';
`;var lt=Dt.call(a,"variable")&&a.variable;if(!lt)H=`with (obj) {
`+H+`
}
`;else if(S_.test(lt))throw new ct(h);H=(M?H.replace(u_,""):H).replace(c_,"$1").replace(f_,"$1;"),H="function("+(lt||"obj")+`) {
`+(lt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(S?", __e = _.escape":"")+(M?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+H+`return __p
}`;var mt=yd(function(){return Ct(b,tt+"return "+H).apply(e,A)});if(mt.source=H,Ll(mt))throw mt;return mt}function K1(s){return Rt(s).toLowerCase()}function Z1(s){return Rt(s).toUpperCase()}function J1(s,a,u){if(s=Rt(s),s&&(u||a===e))return Sc(s);if(!s||!(a=Be(a)))return s;var p=Ke(s),_=Ke(a),b=Cc(p,_),A=Ic(p,_)+1;return Zr(p,b,A).join("")}function Q1(s,a,u){if(s=Rt(s),s&&(u||a===e))return s.slice(0,Pc(s)+1);if(!s||!(a=Be(a)))return s;var p=Ke(s),_=Ic(p,Ke(a))+1;return Zr(p,0,_).join("")}function tw(s,a,u){if(s=Rt(s),s&&(u||a===e))return s.replace(La,"");if(!s||!(a=Be(a)))return s;var p=Ke(s),_=Cc(p,Ke(a));return Zr(p,_).join("")}function ew(s,a){var u=J,p=z;if(Wt(a)){var _="separator"in a?a.separator:_;u="length"in a?gt(a.length):u,p="omission"in a?Be(a.omission):p}s=Rt(s);var b=s.length;if(Yn(s)){var A=Ke(s);b=A.length}if(u>=b)return s;var S=u-jn(p);if(S<1)return p;var M=A?Zr(A,0,S).join(""):s.slice(0,S);if(_===e)return M+p;if(A&&(S+=M.length-S),Nl(_)){if(s.slice(S).search(_)){var L,N=M;for(_.global||(_=Qa(_.source,Rt(ju.exec(_))+"g")),_.lastIndex=0;L=_.exec(N);)var H=L.index;M=M.slice(0,H===e?S:H)}}else if(s.indexOf(Be(_),S)!=S){var j=M.lastIndexOf(_);j>-1&&(M=M.slice(0,j))}return M+p}function rw(s){return s=Rt(s),s&&d_.test(s)?s.replace(zu,My):s}var nw=ei(function(s,a,u){return s+(u?" ":"")+a.toUpperCase()}),Gl=vf("toUpperCase");function _d(s,a,u){return s=Rt(s),a=u?e:a,a===e?Sy(s)?Oy(s):_y(s):s.match(a)||[]}var yd=yt(function(s,a){try{return Me(s,e,a)}catch(u){return Ll(u)?u:new ct(u)}}),iw=Dr(function(s,a){return He(a,function(u){u=gr(u),Pr(s,u,Ol(s[u],s))}),s});function sw(s){var a=s==null?0:s.length,u=ot();return s=a?Ht(s,function(p){if(typeof p[1]!="function")throw new $e(l);return[u(p[0]),p[1]]}):[],yt(function(p){for(var _=-1;++_<a;){var b=s[_];if(Me(b[0],this,p))return Me(b[1],this,p)}})}function ow(s){return Mv(Xe(s,m))}function Hl(s){return function(){return s}}function aw(s,a){return s==null||s!==s?a:s}var lw=bf(),hw=bf(!0);function Ie(s){return s}function $l(s){return Kc(typeof s=="function"?s:Xe(s,m))}function uw(s){return Jc(Xe(s,m))}function cw(s,a){return Qc(s,Xe(a,m))}var fw=yt(function(s,a){return function(u){return qi(u,s,a)}}),dw=yt(function(s,a){return function(u){return qi(s,u,a)}});function Wl(s,a,u){var p=ue(a),_=Js(a,p);u==null&&!(Wt(a)&&(_.length||!p.length))&&(u=a,a=s,s=this,_=Js(a,ue(a)));var b=!(Wt(u)&&"chain"in u)||!!u.chain,A=Or(s);return He(_,function(S){var M=a[S];s[S]=M,A&&(s.prototype[S]=function(){var L=this.__chain__;if(b||L){var N=s(this.__wrapped__),H=N.__actions__=Ae(this.__actions__);return H.push({func:M,args:arguments,thisArg:s}),N.__chain__=L,N}return M.apply(s,zr([this.value()],arguments))})}),s}function pw(){return fe._===this&&(fe._=Gy),this}function Xl(){}function gw(s){return s=gt(s),yt(function(a){return tf(a,s)})}var mw=bl(Ht),_w=bl(bc),yw=bl(Va);function vd(s){return Il(s)?Ya(gr(s)):jv(s)}function vw(s){return function(a){return s==null?e:yn(s,a)}}var xw=Ef(),bw=Ef(!0);function zl(){return[]}function Vl(){return!1}function ww(){return{}}function Ew(){return""}function Tw(){return!0}function Aw(s,a){if(s=gt(s),s<1||s>_t)return[];var u=rt,p=ye(s,rt);a=ot(a),s-=rt;for(var _=Ka(p,a);++u<s;)a(u);return _}function Sw(s){return dt(s)?Ht(s,gr):Oe(s)?[s]:Ae(kf(Rt(s)))}function Cw(s){var a=++Uy;return Rt(s)+a}var Iw=io(function(s,a){return s+a},0),Rw=wl("ceil"),Pw=io(function(s,a){return s/a},1),Mw=wl("floor");function Dw(s){return s&&s.length?Zs(s,Ie,al):e}function Bw(s,a){return s&&s.length?Zs(s,ot(a,2),al):e}function Ow(s){return Tc(s,Ie)}function Fw(s,a){return Tc(s,ot(a,2))}function Lw(s){return s&&s.length?Zs(s,Ie,cl):e}function Nw(s,a){return s&&s.length?Zs(s,ot(a,2),cl):e}var Uw=io(function(s,a){return s*a},1),kw=wl("round"),Gw=io(function(s,a){return s-a},0);function Hw(s){return s&&s.length?qa(s,Ie):0}function $w(s,a){return s&&s.length?qa(s,ot(a,2)):0}return x.after=ub,x.ary=Kf,x.assign=Zb,x.assignIn=ud,x.assignInWith=yo,x.assignWith=Jb,x.at=Qb,x.before=Zf,x.bind=Ol,x.bindAll=iw,x.bindKey=Jf,x.castArray=wb,x.chain=Yf,x.chunk=M0,x.compact=D0,x.concat=B0,x.cond=sw,x.conforms=ow,x.constant=Hl,x.countBy=Hx,x.create=t1,x.curry=Qf,x.curryRight=td,x.debounce=ed,x.defaults=e1,x.defaultsDeep=r1,x.defer=cb,x.delay=fb,x.difference=O0,x.differenceBy=F0,x.differenceWith=L0,x.drop=N0,x.dropRight=U0,x.dropRightWhile=k0,x.dropWhile=G0,x.fill=H0,x.filter=Wx,x.flatMap=Vx,x.flatMapDeep=Yx,x.flatMapDepth=jx,x.flatten=Wf,x.flattenDeep=$0,x.flattenDepth=W0,x.flip=db,x.flow=lw,x.flowRight=hw,x.fromPairs=X0,x.functions=h1,x.functionsIn=u1,x.groupBy=qx,x.initial=V0,x.intersection=Y0,x.intersectionBy=j0,x.intersectionWith=q0,x.invert=f1,x.invertBy=d1,x.invokeMap=Zx,x.iteratee=$l,x.keyBy=Jx,x.keys=ue,x.keysIn=Ce,x.map=co,x.mapKeys=g1,x.mapValues=m1,x.matches=uw,x.matchesProperty=cw,x.memoize=po,x.merge=_1,x.mergeWith=cd,x.method=fw,x.methodOf=dw,x.mixin=Wl,x.negate=go,x.nthArg=gw,x.omit=y1,x.omitBy=v1,x.once=pb,x.orderBy=Qx,x.over=mw,x.overArgs=gb,x.overEvery=_w,x.overSome=yw,x.partial=Fl,x.partialRight=rd,x.partition=tb,x.pick=x1,x.pickBy=fd,x.property=vd,x.propertyOf=vw,x.pull=Q0,x.pullAll=zf,x.pullAllBy=tx,x.pullAllWith=ex,x.pullAt=rx,x.range=xw,x.rangeRight=bw,x.rearg=mb,x.reject=nb,x.remove=nx,x.rest=_b,x.reverse=Dl,x.sampleSize=sb,x.set=w1,x.setWith=E1,x.shuffle=ob,x.slice=ix,x.sortBy=hb,x.sortedUniq=cx,x.sortedUniqBy=fx,x.split=V1,x.spread=yb,x.tail=dx,x.take=px,x.takeRight=gx,x.takeRightWhile=mx,x.takeWhile=_x,x.tap=Dx,x.throttle=vb,x.thru=uo,x.toArray=ad,x.toPairs=dd,x.toPairsIn=pd,x.toPath=Sw,x.toPlainObject=hd,x.transform=T1,x.unary=xb,x.union=yx,x.unionBy=vx,x.unionWith=xx,x.uniq=bx,x.uniqBy=wx,x.uniqWith=Ex,x.unset=A1,x.unzip=Bl,x.unzipWith=Vf,x.update=S1,x.updateWith=C1,x.values=ii,x.valuesIn=I1,x.without=Tx,x.words=_d,x.wrap=bb,x.xor=Ax,x.xorBy=Sx,x.xorWith=Cx,x.zip=Ix,x.zipObject=Rx,x.zipObjectDeep=Px,x.zipWith=Mx,x.entries=dd,x.entriesIn=pd,x.extend=ud,x.extendWith=yo,Wl(x,x),x.add=Iw,x.attempt=yd,x.camelCase=D1,x.capitalize=gd,x.ceil=Rw,x.clamp=R1,x.clone=Eb,x.cloneDeep=Ab,x.cloneDeepWith=Sb,x.cloneWith=Tb,x.conformsTo=Cb,x.deburr=md,x.defaultTo=aw,x.divide=Pw,x.endsWith=B1,x.eq=Je,x.escape=O1,x.escapeRegExp=F1,x.every=$x,x.find=Xx,x.findIndex=Hf,x.findKey=n1,x.findLast=zx,x.findLastIndex=$f,x.findLastKey=i1,x.floor=Mw,x.forEach=jf,x.forEachRight=qf,x.forIn=s1,x.forInRight=o1,x.forOwn=a1,x.forOwnRight=l1,x.get=Ul,x.gt=Ib,x.gte=Rb,x.has=c1,x.hasIn=kl,x.head=Xf,x.identity=Ie,x.includes=Kx,x.indexOf=z0,x.inRange=P1,x.invoke=p1,x.isArguments=bn,x.isArray=dt,x.isArrayBuffer=Pb,x.isArrayLike=Se,x.isArrayLikeObject=Jt,x.isBoolean=Mb,x.isBuffer=Jr,x.isDate=Db,x.isElement=Bb,x.isEmpty=Ob,x.isEqual=Fb,x.isEqualWith=Lb,x.isError=Ll,x.isFinite=Nb,x.isFunction=Or,x.isInteger=nd,x.isLength=mo,x.isMap=id,x.isMatch=Ub,x.isMatchWith=kb,x.isNaN=Gb,x.isNative=Hb,x.isNil=Wb,x.isNull=$b,x.isNumber=sd,x.isObject=Wt,x.isObjectLike=Kt,x.isPlainObject=es,x.isRegExp=Nl,x.isSafeInteger=Xb,x.isSet=od,x.isString=_o,x.isSymbol=Oe,x.isTypedArray=ni,x.isUndefined=zb,x.isWeakMap=Vb,x.isWeakSet=Yb,x.join=K0,x.kebabCase=L1,x.last=Ve,x.lastIndexOf=Z0,x.lowerCase=N1,x.lowerFirst=U1,x.lt=jb,x.lte=qb,x.max=Dw,x.maxBy=Bw,x.mean=Ow,x.meanBy=Fw,x.min=Lw,x.minBy=Nw,x.stubArray=zl,x.stubFalse=Vl,x.stubObject=ww,x.stubString=Ew,x.stubTrue=Tw,x.multiply=Uw,x.nth=J0,x.noConflict=pw,x.noop=Xl,x.now=fo,x.pad=k1,x.padEnd=G1,x.padStart=H1,x.parseInt=$1,x.random=M1,x.reduce=eb,x.reduceRight=rb,x.repeat=W1,x.replace=X1,x.result=b1,x.round=kw,x.runInContext=C,x.sample=ib,x.size=ab,x.snakeCase=z1,x.some=lb,x.sortedIndex=sx,x.sortedIndexBy=ox,x.sortedIndexOf=ax,x.sortedLastIndex=lx,x.sortedLastIndexBy=hx,x.sortedLastIndexOf=ux,x.startCase=Y1,x.startsWith=j1,x.subtract=Gw,x.sum=Hw,x.sumBy=$w,x.template=q1,x.times=Aw,x.toFinite=Fr,x.toInteger=gt,x.toLength=ld,x.toLower=K1,x.toNumber=Ye,x.toSafeInteger=Kb,x.toString=Rt,x.toUpper=Z1,x.trim=J1,x.trimEnd=Q1,x.trimStart=tw,x.truncate=ew,x.unescape=rw,x.uniqueId=Cw,x.upperCase=nw,x.upperFirst=Gl,x.each=jf,x.eachRight=qf,x.first=Xf,Wl(x,function(){var s={};return dr(x,function(a,u){Dt.call(x.prototype,u)||(s[u]=a)}),s}(),{chain:!1}),x.VERSION=n,He(["bind","bindKey","curry","curryRight","partial","partialRight"],function(s){x[s].placeholder=x}),He(["drop","take"],function(s,a){bt.prototype[s]=function(u){u=u===e?1:ae(gt(u),0);var p=this.__filtered__&&!a?new bt(this):this.clone();return p.__filtered__?p.__takeCount__=ye(u,p.__takeCount__):p.__views__.push({size:ye(u,rt),type:s+(p.__dir__<0?"Right":"")}),p},bt.prototype[s+"Right"]=function(u){return this.reverse()[s](u).reverse()}}),He(["filter","map","takeWhile"],function(s,a){var u=a+1,p=u==F||u==ft;bt.prototype[s]=function(_){var b=this.clone();return b.__iteratees__.push({iteratee:ot(_,3),type:u}),b.__filtered__=b.__filtered__||p,b}}),He(["head","last"],function(s,a){var u="take"+(a?"Right":"");bt.prototype[s]=function(){return this[u](1).value()[0]}}),He(["initial","tail"],function(s,a){var u="drop"+(a?"":"Right");bt.prototype[s]=function(){return this.__filtered__?new bt(this):this[u](1)}}),bt.prototype.compact=function(){return this.filter(Ie)},bt.prototype.find=function(s){return this.filter(s).head()},bt.prototype.findLast=function(s){return this.reverse().find(s)},bt.prototype.invokeMap=yt(function(s,a){return typeof s=="function"?new bt(this):this.map(function(u){return qi(u,s,a)})}),bt.prototype.reject=function(s){return this.filter(go(ot(s)))},bt.prototype.slice=function(s,a){s=gt(s);var u=this;return u.__filtered__&&(s>0||a<0)?new bt(u):(s<0?u=u.takeRight(-s):s&&(u=u.drop(s)),a!==e&&(a=gt(a),u=a<0?u.dropRight(-a):u.take(a-s)),u)},bt.prototype.takeRightWhile=function(s){return this.reverse().takeWhile(s).reverse()},bt.prototype.toArray=function(){return this.take(rt)},dr(bt.prototype,function(s,a){var u=/^(?:filter|find|map|reject)|While$/.test(a),p=/^(?:head|last)$/.test(a),_=x[p?"take"+(a=="last"?"Right":""):a],b=p||/^find/.test(a);_&&(x.prototype[a]=function(){var A=this.__wrapped__,S=p?[1]:arguments,M=A instanceof bt,L=S[0],N=M||dt(A),H=function(vt){var Tt=_.apply(x,zr([vt],S));return p&&j?Tt[0]:Tt};N&&u&&typeof L=="function"&&L.length!=1&&(M=N=!1);var j=this.__chain__,tt=!!this.__actions__.length,lt=b&&!j,mt=M&&!tt;if(!b&&N){A=mt?A:new bt(this);var ht=s.apply(A,S);return ht.__actions__.push({func:uo,args:[H],thisArg:e}),new We(ht,j)}return lt&&mt?s.apply(this,S):(ht=this.thru(H),lt?p?ht.value()[0]:ht.value():ht)})}),He(["pop","push","shift","sort","splice","unshift"],function(s){var a=Ls[s],u=/^(?:push|sort|unshift)$/.test(s)?"tap":"thru",p=/^(?:pop|shift)$/.test(s);x.prototype[s]=function(){var _=arguments;if(p&&!this.__chain__){var b=this.value();return a.apply(dt(b)?b:[],_)}return this[u](function(A){return a.apply(dt(A)?A:[],_)})}}),dr(bt.prototype,function(s,a){var u=x[a];if(u){var p=u.name+"";Dt.call(Jn,p)||(Jn[p]=[]),Jn[p].push({name:a,func:u})}}),Jn[no(e,I).name]=[{name:"wrapper",func:e}],bt.prototype.clone=rv,bt.prototype.reverse=nv,bt.prototype.value=iv,x.prototype.at=Bx,x.prototype.chain=Ox,x.prototype.commit=Fx,x.prototype.next=Lx,x.prototype.plant=Ux,x.prototype.reverse=kx,x.prototype.toJSON=x.prototype.valueOf=x.prototype.value=Gx,x.prototype.first=x.prototype.head,$i&&(x.prototype[$i]=Nx),x},qn=Fy();dn?((dn.exports=qn)._=qn,$a._=qn):fe._=qn}).call(kr)})(Jo,Jo.exports);var Pn=Jo.exports;const wn=xu(Pn);var Wn=(r=>(r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2",r))(Wn||{}),Ph=(r=>(r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL",r))(Ph||{}),ut=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR",r))(ut||{}),Er=(r=>(r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",r))(Er||{}),X=(r=>(r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r))(X||{}),xi=(r=>(r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r))(xi||{}),st=(r=>(r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT",r))(st||{}),Mh=(r=>(r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT",r))(Mh||{}),Gr=(r=>(r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR",r))(Gr||{}),on=(r=>(r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",r))(on||{}),Sr=(r=>(r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL",r))(Sr||{}),cr=(r=>(r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",r))(cr||{}),br=(r=>(r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT",r))(br||{}),bu=(r=>(r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL",r))(bu||{}),je=(r=>(r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp",r))(je||{}),he=(r=>(r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE",r[r.COLOR=4]="COLOR",r))(he||{}),ie=(r=>(r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH",r))(ie||{}),Tr=(r=>(r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",r))(Tr||{});const Vw={createCanvas:(r,t)=>{const e=document.createElement("canvas");return e.width=r,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,t)=>fetch(r,t),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")},Z={ADAPTER:Vw,RESOLUTION:1,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,premultipliedAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1,hello:!1},CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Yl=/iPhone/i,bd=/iPod/i,wd=/iPad/i,Ed=/\biOS-universal(?:.+)Mac\b/i,jl=/\bAndroid(?:.+)Mobile\b/i,Td=/Android/i,si=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,vo=/Silk/i,Nr=/Windows Phone/i,Ad=/\bWindows(?:.+)ARM\b/i,Sd=/BlackBerry/i,Cd=/BB10/i,Id=/Opera Mini/i,Rd=/\b(CriOS|Chrome)(?:.+)Mobile/i,Pd=/Mobile(?:.+)Firefox\b/i,Md=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function Yw(r){return function(t){return t.test(r)}}function jw(r){var t={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?t.userAgent=r:r&&r.userAgent&&(t={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var e=t.userAgent,n=e.split("[FBAN");typeof n[1]<"u"&&(e=n[0]),n=e.split("Twitter"),typeof n[1]<"u"&&(e=n[0]);var i=Yw(e),o={apple:{phone:i(Yl)&&!i(Nr),ipod:i(bd),tablet:!i(Yl)&&(i(wd)||Md(t))&&!i(Nr),universal:i(Ed),device:(i(Yl)||i(bd)||i(wd)||i(Ed)||Md(t))&&!i(Nr)},amazon:{phone:i(si),tablet:!i(si)&&i(vo),device:i(si)||i(vo)},android:{phone:!i(Nr)&&i(si)||!i(Nr)&&i(jl),tablet:!i(Nr)&&!i(si)&&!i(jl)&&(i(vo)||i(Td)),device:!i(Nr)&&(i(si)||i(vo)||i(jl)||i(Td))||i(/\bokhttp\b/i)},windows:{phone:i(Nr),tablet:i(Ad),device:i(Nr)||i(Ad)},other:{blackberry:i(Sd),blackberry10:i(Cd),opera:i(Id),firefox:i(Pd),chrome:i(Rd),device:i(Sd)||i(Cd)||i(Id)||i(Pd)||i(Rd)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}const Hr=jw(globalThis.navigator);Z.RETINA_PREFIX=/@([0-9\.]+)x/;Z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var ng={exports:{}};(function(r){var t=Object.prototype.hasOwnProperty,e="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(e=!1));function i(c,f,d){this.fn=c,this.context=f,this.once=d||!1}function o(c,f,d,m,g){if(typeof d!="function")throw new TypeError("The listener must be a function");var y=new i(d,m||c,g),v=e?e+f:f;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],y]:c._events[v].push(y):(c._events[v]=y,c._eventsCount++),c}function l(c,f){--c._eventsCount===0?c._events=new n:delete c._events[f]}function h(){this._events=new n,this._eventsCount=0}h.prototype.eventNames=function(){var f=[],d,m;if(this._eventsCount===0)return f;for(m in d=this._events)t.call(d,m)&&f.push(e?m.slice(1):m);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(d)):f},h.prototype.listeners=function(f){var d=e?e+f:f,m=this._events[d];if(!m)return[];if(m.fn)return[m.fn];for(var g=0,y=m.length,v=new Array(y);g<y;g++)v[g]=m[g].fn;return v},h.prototype.listenerCount=function(f){var d=e?e+f:f,m=this._events[d];return m?m.fn?1:m.length:0},h.prototype.emit=function(f,d,m,g,y,v){var T=e?e+f:f;if(!this._events[T])return!1;var E=this._events[T],I=arguments.length,P,w;if(E.fn){switch(E.once&&this.removeListener(f,E.fn,void 0,!0),I){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,d),!0;case 3:return E.fn.call(E.context,d,m),!0;case 4:return E.fn.call(E.context,d,m,g),!0;case 5:return E.fn.call(E.context,d,m,g,y),!0;case 6:return E.fn.call(E.context,d,m,g,y,v),!0}for(w=1,P=new Array(I-1);w<I;w++)P[w-1]=arguments[w];E.fn.apply(E.context,P)}else{var R=E.length,O;for(w=0;w<R;w++)switch(E[w].once&&this.removeListener(f,E[w].fn,void 0,!0),I){case 1:E[w].fn.call(E[w].context);break;case 2:E[w].fn.call(E[w].context,d);break;case 3:E[w].fn.call(E[w].context,d,m);break;case 4:E[w].fn.call(E[w].context,d,m,g);break;default:if(!P)for(O=1,P=new Array(I-1);O<I;O++)P[O-1]=arguments[O];E[w].fn.apply(E[w].context,P)}}return!0},h.prototype.on=function(f,d,m){return o(this,f,d,m,!1)},h.prototype.once=function(f,d,m){return o(this,f,d,m,!0)},h.prototype.removeListener=function(f,d,m,g){var y=e?e+f:f;if(!this._events[y])return this;if(!d)return l(this,y),this;var v=this._events[y];if(v.fn)v.fn===d&&(!g||v.once)&&(!m||v.context===m)&&l(this,y);else{for(var T=0,E=[],I=v.length;T<I;T++)(v[T].fn!==d||g&&!v[T].once||m&&v[T].context!==m)&&E.push(v[T]);E.length?this._events[y]=E.length===1?E[0]:E:l(this,y)}return this},h.prototype.removeAllListeners=function(f){var d;return f?(d=e?e+f:f,this._events[d]&&l(this,d)):(this._events=new n,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=e,h.EventEmitter=h,r.exports=h})(ng);var qw=ng.exports;const Ts=xu(qw);var wu={exports:{}};wu.exports=ga;wu.exports.default=ga;function ga(r,t,e){e=e||2;var n=t&&t.length,i=n?t[0]*e:r.length,o=ig(r,0,i,e,!0),l=[];if(!o||o.next===o.prev)return l;var h,c,f,d,m,g,y;if(n&&(o=tE(r,t,o,e)),r.length>80*e){h=f=r[0],c=d=r[1];for(var v=e;v<i;v+=e)m=r[v],g=r[v+1],m<h&&(h=m),g<c&&(c=g),m>f&&(f=m),g>d&&(d=g);y=Math.max(f-h,d-c),y=y!==0?32767/y:0}return _s(o,l,e,h,c,y,0),l}function ig(r,t,e,n,i){var o,l;if(i===Oh(r,t,e,n)>0)for(o=t;o<e;o+=n)l=Dd(o,r[o],r[o+1],l);else for(o=e-n;o>=t;o-=n)l=Dd(o,r[o],r[o+1],l);return l&&ma(l,l.next)&&(vs(l),l=l.next),l}function kn(r,t){if(!r)return r;t||(t=r);var e=r,n;do if(n=!1,!e.steiner&&(ma(e,e.next)||zt(e.prev,e,e.next)===0)){if(vs(e),e=t=e.prev,e===e.next)break;n=!0}else e=e.next;while(n||e!==t);return t}function _s(r,t,e,n,i,o,l){if(r){!l&&o&&sE(r,n,i,o);for(var h=r,c,f;r.prev!==r.next;){if(c=r.prev,f=r.next,o?Zw(r,n,i,o):Kw(r)){t.push(c.i/e|0),t.push(r.i/e|0),t.push(f.i/e|0),vs(r),r=f.next,h=f.next;continue}if(r=f,r===h){l?l===1?(r=Jw(kn(r),t,e),_s(r,t,e,n,i,o,2)):l===2&&Qw(r,t,e,n,i,o):_s(kn(r),t,e,n,i,o,1);break}}}}function Kw(r){var t=r.prev,e=r,n=r.next;if(zt(t,e,n)>=0)return!1;for(var i=t.x,o=e.x,l=n.x,h=t.y,c=e.y,f=n.y,d=i<o?i<l?i:l:o<l?o:l,m=h<c?h<f?h:f:c<f?c:f,g=i>o?i>l?i:l:o>l?o:l,y=h>c?h>f?h:f:c>f?c:f,v=n.next;v!==t;){if(v.x>=d&&v.x<=g&&v.y>=m&&v.y<=y&&gi(i,h,o,c,l,f,v.x,v.y)&&zt(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function Zw(r,t,e,n){var i=r.prev,o=r,l=r.next;if(zt(i,o,l)>=0)return!1;for(var h=i.x,c=o.x,f=l.x,d=i.y,m=o.y,g=l.y,y=h<c?h<f?h:f:c<f?c:f,v=d<m?d<g?d:g:m<g?m:g,T=h>c?h>f?h:f:c>f?c:f,E=d>m?d>g?d:g:m>g?m:g,I=Dh(y,v,t,e,n),P=Dh(T,E,t,e,n),w=r.prevZ,R=r.nextZ;w&&w.z>=I&&R&&R.z<=P;){if(w.x>=y&&w.x<=T&&w.y>=v&&w.y<=E&&w!==i&&w!==l&&gi(h,d,c,m,f,g,w.x,w.y)&&zt(w.prev,w,w.next)>=0||(w=w.prevZ,R.x>=y&&R.x<=T&&R.y>=v&&R.y<=E&&R!==i&&R!==l&&gi(h,d,c,m,f,g,R.x,R.y)&&zt(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;w&&w.z>=I;){if(w.x>=y&&w.x<=T&&w.y>=v&&w.y<=E&&w!==i&&w!==l&&gi(h,d,c,m,f,g,w.x,w.y)&&zt(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;R&&R.z<=P;){if(R.x>=y&&R.x<=T&&R.y>=v&&R.y<=E&&R!==i&&R!==l&&gi(h,d,c,m,f,g,R.x,R.y)&&zt(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function Jw(r,t,e){var n=r;do{var i=n.prev,o=n.next.next;!ma(i,o)&&sg(i,n,n.next,o)&&ys(i,o)&&ys(o,i)&&(t.push(i.i/e|0),t.push(n.i/e|0),t.push(o.i/e|0),vs(n),vs(n.next),n=r=o),n=n.next}while(n!==r);return kn(n)}function Qw(r,t,e,n,i,o){var l=r;do{for(var h=l.next.next;h!==l.prev;){if(l.i!==h.i&&lE(l,h)){var c=og(l,h);l=kn(l,l.next),c=kn(c,c.next),_s(l,t,e,n,i,o,0),_s(c,t,e,n,i,o,0);return}h=h.next}l=l.next}while(l!==r)}function tE(r,t,e,n){var i=[],o,l,h,c,f;for(o=0,l=t.length;o<l;o++)h=t[o]*n,c=o<l-1?t[o+1]*n:r.length,f=ig(r,h,c,n,!1),f===f.next&&(f.steiner=!0),i.push(aE(f));for(i.sort(eE),o=0;o<i.length;o++)e=rE(i[o],e);return e}function eE(r,t){return r.x-t.x}function rE(r,t){var e=nE(r,t);if(!e)return t;var n=og(e,r);return kn(n,n.next),kn(e,e.next)}function nE(r,t){var e=t,n=r.x,i=r.y,o=-1/0,l;do{if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){var h=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(h<=n&&h>o&&(o=h,l=e.x<e.next.x?e:e.next,h===n))return l}e=e.next}while(e!==t);if(!l)return null;var c=l,f=l.x,d=l.y,m=1/0,g;e=l;do n>=e.x&&e.x>=f&&n!==e.x&&gi(i<d?n:o,i,f,d,i<d?o:n,i,e.x,e.y)&&(g=Math.abs(i-e.y)/(n-e.x),ys(e,r)&&(g<m||g===m&&(e.x>l.x||e.x===l.x&&iE(l,e)))&&(l=e,m=g)),e=e.next;while(e!==c);return l}function iE(r,t){return zt(r.prev,r,t.prev)<0&&zt(t.next,r,r.next)<0}function sE(r,t,e,n){var i=r;do i.z===0&&(i.z=Dh(i.x,i.y,t,e,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=null,i.prevZ=null,oE(i)}function oE(r){var t,e,n,i,o,l,h,c,f=1;do{for(e=r,r=null,o=null,l=0;e;){for(l++,n=e,h=0,t=0;t<f&&(h++,n=n.nextZ,!!n);t++);for(c=f;h>0||c>0&&n;)h!==0&&(c===0||!n||e.z<=n.z)?(i=e,e=e.nextZ,h--):(i=n,n=n.nextZ,c--),o?o.nextZ=i:r=i,i.prevZ=o,o=i;e=n}o.nextZ=null,f*=2}while(l>1);return r}function Dh(r,t,e,n,i){return r=(r-e)*i|0,t=(t-n)*i|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1}function aE(r){var t=r,e=r;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==r);return e}function gi(r,t,e,n,i,o,l,h){return(i-l)*(t-h)>=(r-l)*(o-h)&&(r-l)*(n-h)>=(e-l)*(t-h)&&(e-l)*(o-h)>=(i-l)*(n-h)}function lE(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!hE(r,t)&&(ys(r,t)&&ys(t,r)&&uE(r,t)&&(zt(r.prev,r,t.prev)||zt(r,t.prev,t))||ma(r,t)&&zt(r.prev,r,r.next)>0&&zt(t.prev,t,t.next)>0)}function zt(r,t,e){return(t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y)}function ma(r,t){return r.x===t.x&&r.y===t.y}function sg(r,t,e,n){var i=bo(zt(r,t,e)),o=bo(zt(r,t,n)),l=bo(zt(e,n,r)),h=bo(zt(e,n,t));return!!(i!==o&&l!==h||i===0&&xo(r,e,t)||o===0&&xo(r,n,t)||l===0&&xo(e,r,n)||h===0&&xo(e,t,n))}function xo(r,t,e){return t.x<=Math.max(r.x,e.x)&&t.x>=Math.min(r.x,e.x)&&t.y<=Math.max(r.y,e.y)&&t.y>=Math.min(r.y,e.y)}function bo(r){return r>0?1:r<0?-1:0}function hE(r,t){var e=r;do{if(e.i!==r.i&&e.next.i!==r.i&&e.i!==t.i&&e.next.i!==t.i&&sg(e,e.next,r,t))return!0;e=e.next}while(e!==r);return!1}function ys(r,t){return zt(r.prev,r,r.next)<0?zt(r,t,r.next)>=0&&zt(r,r.prev,t)>=0:zt(r,t,r.prev)<0||zt(r,r.next,t)<0}function uE(r,t){var e=r,n=!1,i=(r.x+t.x)/2,o=(r.y+t.y)/2;do e.y>o!=e.next.y>o&&e.next.y!==e.y&&i<(e.next.x-e.x)*(o-e.y)/(e.next.y-e.y)+e.x&&(n=!n),e=e.next;while(e!==r);return n}function og(r,t){var e=new Bh(r.i,r.x,r.y),n=new Bh(t.i,t.x,t.y),i=r.next,o=t.prev;return r.next=t,t.prev=r,e.next=i,i.prev=e,n.next=e,e.prev=n,o.next=n,n.prev=o,n}function Dd(r,t,e,n){var i=new Bh(r,t,e);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function vs(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Bh(r,t,e){this.i=r,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}ga.deviation=function(r,t,e,n){var i=t&&t.length,o=i?t[0]*e:r.length,l=Math.abs(Oh(r,0,o,e));if(i)for(var h=0,c=t.length;h<c;h++){var f=t[h]*e,d=h<c-1?t[h+1]*e:r.length;l-=Math.abs(Oh(r,f,d,e))}var m=0;for(h=0;h<n.length;h+=3){var g=n[h]*e,y=n[h+1]*e,v=n[h+2]*e;m+=Math.abs((r[g]-r[v])*(r[y+1]-r[g+1])-(r[g]-r[y])*(r[v+1]-r[g+1]))}return l===0&&m===0?0:Math.abs((m-l)/l)};function Oh(r,t,e,n){for(var i=0,o=t,l=e-n;o<e;o+=n)i+=(r[l]-r[o])*(r[o+1]+r[l+1]),l=o;return i}ga.flatten=function(r){for(var t=r[0][0].length,e={vertices:[],holes:[],dimensions:t},n=0,i=0;i<r.length;i++){for(var o=0;o<r[i].length;o++)for(var l=0;l<t;l++)e.vertices.push(r[i][o][l]);i>0&&(n+=r[i-1].length,e.holes.push(n))}return e};var cE=wu.exports;const fE=xu(cE);var Qo={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Qo.exports;(function(r,t){(function(e){var n=t&&!t.nodeType&&t,i=r&&!r.nodeType&&r,o=typeof kr=="object"&&kr;(o.global===o||o.window===o||o.self===o)&&(e=o);var l,h=2147483647,c=36,f=1,d=26,m=38,g=700,y=72,v=128,T="-",E=/^xn--/,I=/[^\x20-\x7E]/,P=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},R=c-f,O=Math.floor,W=String.fromCharCode,k;function U($){throw new RangeError(w[$])}function Y($,rt){for(var xt=$.length,It=[];xt--;)It[xt]=rt($[xt]);return It}function J($,rt){var xt=$.split("@"),It="";xt.length>1&&(It=xt[0]+"@",$=xt[1]),$=$.replace(P,".");var Pt=$.split("."),Nt=Y(Pt,rt).join(".");return It+Nt}function z($){for(var rt=[],xt=0,It=$.length,Pt,Nt;xt<It;)Pt=$.charCodeAt(xt++),Pt>=55296&&Pt<=56319&&xt<It?(Nt=$.charCodeAt(xt++),(Nt&64512)==56320?rt.push(((Pt&1023)<<10)+(Nt&1023)+65536):(rt.push(Pt),xt--)):rt.push(Pt);return rt}function q($){return Y($,function(rt){var xt="";return rt>65535&&(rt-=65536,xt+=W(rt>>>10&1023|55296),rt=56320|rt&1023),xt+=W(rt),xt}).join("")}function G($){return $-48<10?$-22:$-65<26?$-65:$-97<26?$-97:c}function F($,rt){return $+22+75*($<26)-((rt!=0)<<5)}function at($,rt,xt){var It=0;for($=xt?O($/g):$>>1,$+=O($/rt);$>R*d>>1;It+=c)$=O($/R);return O(It+(R+1)*$/($+m))}function ft($){var rt=[],xt=$.length,It,Pt=0,Nt=v,Ut=y,re,Yt,ne,se,Mt,kt,jt,qt,_e;for(re=$.lastIndexOf(T),re<0&&(re=0),Yt=0;Yt<re;++Yt)$.charCodeAt(Yt)>=128&&U("not-basic"),rt.push($.charCodeAt(Yt));for(ne=re>0?re+1:0;ne<xt;){for(se=Pt,Mt=1,kt=c;ne>=xt&&U("invalid-input"),jt=G($.charCodeAt(ne++)),(jt>=c||jt>O((h-Pt)/Mt))&&U("overflow"),Pt+=jt*Mt,qt=kt<=Ut?f:kt>=Ut+d?d:kt-Ut,!(jt<qt);kt+=c)_e=c-qt,Mt>O(h/_e)&&U("overflow"),Mt*=_e;It=rt.length+1,Ut=at(Pt-se,It,se==0),O(Pt/It)>h-Nt&&U("overflow"),Nt+=O(Pt/It),Pt%=It,rt.splice(Pt++,0,Nt)}return q(rt)}function V($){var rt,xt,It,Pt,Nt,Ut,re,Yt,ne,se,Mt,kt=[],jt,qt,_e,fn;for($=z($),jt=$.length,rt=v,xt=0,Nt=y,Ut=0;Ut<jt;++Ut)Mt=$[Ut],Mt<128&&kt.push(W(Mt));for(It=Pt=kt.length,Pt&&kt.push(T);It<jt;){for(re=h,Ut=0;Ut<jt;++Ut)Mt=$[Ut],Mt>=rt&&Mt<re&&(re=Mt);for(qt=It+1,re-rt>O((h-xt)/qt)&&U("overflow"),xt+=(re-rt)*qt,rt=re,Ut=0;Ut<jt;++Ut)if(Mt=$[Ut],Mt<rt&&++xt>h&&U("overflow"),Mt==rt){for(Yt=xt,ne=c;se=ne<=Nt?f:ne>=Nt+d?d:ne-Nt,!(Yt<se);ne+=c)fn=Yt-se,_e=c-se,kt.push(W(F(se+fn%_e,0))),Yt=O(fn/_e);kt.push(W(F(Yt,0))),Nt=at(xt,qt,It==Pt),xt=0,++It}++xt,++rt}return kt.join("")}function _t($){return J($,function(rt){return E.test(rt)?ft(rt.slice(4).toLowerCase()):rt})}function Ot($){return J($,function(rt){return I.test(rt)?"xn--"+V(rt):rt})}if(l={version:"1.4.1",ucs2:{decode:z,encode:q},decode:ft,encode:V,toASCII:Ot,toUnicode:_t},n&&i)if(r.exports==n)i.exports=l;else for(k in l)l.hasOwnProperty(k)&&(n[k]=l[k]);else e.punycode=l})(kr)})(Qo,Qo.exports);var dE=Qo.exports,pE=Error,gE=EvalError,mE=RangeError,_E=ReferenceError,ag=SyntaxError,As=TypeError,yE=URIError,vE=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),n=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;t[e]=i;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var o=Object.getOwnPropertySymbols(t);if(o.length!==1||o[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var l=Object.getOwnPropertyDescriptor(t,e);if(l.value!==i||l.enumerable!==!0)return!1}return!0},Bd=typeof Symbol<"u"&&Symbol,xE=vE,bE=function(){return typeof Bd!="function"||typeof Symbol!="function"||typeof Bd("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:xE()},ql={__proto__:null,foo:{}},wE=Object,EE=function(){return{__proto__:ql}.foo===ql.foo&&!(ql instanceof wE)},TE="Function.prototype.bind called on incompatible ",AE=Object.prototype.toString,SE=Math.max,CE="[object Function]",Od=function(t,e){for(var n=[],i=0;i<t.length;i+=1)n[i]=t[i];for(var o=0;o<e.length;o+=1)n[o+t.length]=e[o];return n},IE=function(t,e){for(var n=[],i=e,o=0;i<t.length;i+=1,o+=1)n[o]=t[i];return n},RE=function(r,t){for(var e="",n=0;n<r.length;n+=1)e+=r[n],n+1<r.length&&(e+=t);return e},PE=function(t){var e=this;if(typeof e!="function"||AE.apply(e)!==CE)throw new TypeError(TE+e);for(var n=IE(arguments,1),i,o=function(){if(this instanceof i){var d=e.apply(this,Od(n,arguments));return Object(d)===d?d:this}return e.apply(t,Od(n,arguments))},l=SE(0,e.length-n.length),h=[],c=0;c<l;c++)h[c]="$"+c;if(i=Function("binder","return function ("+RE(h,",")+"){ return binder.apply(this,arguments); }")(o),e.prototype){var f=function(){};f.prototype=e.prototype,i.prototype=new f,f.prototype=null}return i},ME=PE,Eu=Function.prototype.bind||ME,DE=Function.prototype.call,BE=Object.prototype.hasOwnProperty,OE=Eu,FE=OE.call(DE,BE),wt,LE=pE,NE=gE,UE=mE,kE=_E,Si=ag,bi=As,GE=yE,lg=Function,Kl=function(r){try{return lg('"use strict"; return ('+r+").constructor;")()}catch{}},Fn=Object.getOwnPropertyDescriptor;if(Fn)try{Fn({},"")}catch{Fn=null}var Zl=function(){throw new bi},HE=Fn?function(){try{return arguments.callee,Zl}catch{try{return Fn(arguments,"callee").get}catch{return Zl}}}():Zl,oi=bE(),$E=EE(),ce=Object.getPrototypeOf||($E?function(r){return r.__proto__}:null),ui={},WE=typeof Uint8Array>"u"||!ce?wt:ce(Uint8Array),Ln={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?wt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?wt:ArrayBuffer,"%ArrayIteratorPrototype%":oi&&ce?ce([][Symbol.iterator]()):wt,"%AsyncFromSyncIteratorPrototype%":wt,"%AsyncFunction%":ui,"%AsyncGenerator%":ui,"%AsyncGeneratorFunction%":ui,"%AsyncIteratorPrototype%":ui,"%Atomics%":typeof Atomics>"u"?wt:Atomics,"%BigInt%":typeof BigInt>"u"?wt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?wt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?wt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?wt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":LE,"%eval%":eval,"%EvalError%":NE,"%Float32Array%":typeof Float32Array>"u"?wt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?wt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?wt:FinalizationRegistry,"%Function%":lg,"%GeneratorFunction%":ui,"%Int8Array%":typeof Int8Array>"u"?wt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?wt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?wt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":oi&&ce?ce(ce([][Symbol.iterator]())):wt,"%JSON%":typeof JSON=="object"?JSON:wt,"%Map%":typeof Map>"u"?wt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!oi||!ce?wt:ce(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?wt:Promise,"%Proxy%":typeof Proxy>"u"?wt:Proxy,"%RangeError%":UE,"%ReferenceError%":kE,"%Reflect%":typeof Reflect>"u"?wt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?wt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!oi||!ce?wt:ce(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?wt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":oi&&ce?ce(""[Symbol.iterator]()):wt,"%Symbol%":oi?Symbol:wt,"%SyntaxError%":Si,"%ThrowTypeError%":HE,"%TypedArray%":WE,"%TypeError%":bi,"%Uint8Array%":typeof Uint8Array>"u"?wt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?wt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?wt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?wt:Uint32Array,"%URIError%":GE,"%WeakMap%":typeof WeakMap>"u"?wt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?wt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?wt:WeakSet};if(ce)try{null.error}catch(r){var XE=ce(ce(r));Ln["%Error.prototype%"]=XE}var zE=function r(t){var e;if(t==="%AsyncFunction%")e=Kl("async function () {}");else if(t==="%GeneratorFunction%")e=Kl("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=Kl("async function* () {}");else if(t==="%AsyncGenerator%"){var n=r("%AsyncGeneratorFunction%");n&&(e=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var i=r("%AsyncGenerator%");i&&ce&&(e=ce(i.prototype))}return Ln[t]=e,e},Fd={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ss=Eu,ta=FE,VE=Ss.call(Function.call,Array.prototype.concat),YE=Ss.call(Function.apply,Array.prototype.splice),Ld=Ss.call(Function.call,String.prototype.replace),ea=Ss.call(Function.call,String.prototype.slice),jE=Ss.call(Function.call,RegExp.prototype.exec),qE=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,KE=/\\(\\)?/g,ZE=function(t){var e=ea(t,0,1),n=ea(t,-1);if(e==="%"&&n!=="%")throw new Si("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&e!=="%")throw new Si("invalid intrinsic syntax, expected opening `%`");var i=[];return Ld(t,qE,function(o,l,h,c){i[i.length]=h?Ld(c,KE,"$1"):l||o}),i},JE=function(t,e){var n=t,i;if(ta(Fd,n)&&(i=Fd[n],n="%"+i[0]+"%"),ta(Ln,n)){var o=Ln[n];if(o===ui&&(o=zE(n)),typeof o>"u"&&!e)throw new bi("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:o}}throw new Si("intrinsic "+t+" does not exist!")},Mi=function(t,e){if(typeof t!="string"||t.length===0)throw new bi("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new bi('"allowMissing" argument must be a boolean');if(jE(/^%?[^%]*%?$/,t)===null)throw new Si("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=ZE(t),i=n.length>0?n[0]:"",o=JE("%"+i+"%",e),l=o.name,h=o.value,c=!1,f=o.alias;f&&(i=f[0],YE(n,VE([0,1],f)));for(var d=1,m=!0;d<n.length;d+=1){var g=n[d],y=ea(g,0,1),v=ea(g,-1);if((y==='"'||y==="'"||y==="`"||v==='"'||v==="'"||v==="`")&&y!==v)throw new Si("property names with quotes must have matching quotes");if((g==="constructor"||!m)&&(c=!0),i+="."+g,l="%"+i+"%",ta(Ln,l))h=Ln[l];else if(h!=null){if(!(g in h)){if(!e)throw new bi("base intrinsic for "+t+" exists, but the property is not available.");return}if(Fn&&d+1>=n.length){var T=Fn(h,g);m=!!T,m&&"get"in T&&!("originalValue"in T.get)?h=T.get:h=h[g]}else m=ta(h,g),h=h[g];m&&!c&&(Ln[l]=h)}}return h},hg={exports:{}},Jl,Nd;function Tu(){if(Nd)return Jl;Nd=1;var r=Mi,t=r("%Object.defineProperty%",!0)||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return Jl=t,Jl}var QE=Mi,Xo=QE("%Object.getOwnPropertyDescriptor%",!0);if(Xo)try{Xo([],"length")}catch{Xo=null}var ug=Xo,Ud=Tu(),tT=ag,ai=As,kd=ug,eT=function(t,e,n){if(!t||typeof t!="object"&&typeof t!="function")throw new ai("`obj` must be an object or a function`");if(typeof e!="string"&&typeof e!="symbol")throw new ai("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new ai("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new ai("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new ai("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new ai("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,o=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,h=arguments.length>6?arguments[6]:!1,c=!!kd&&kd(t,e);if(Ud)Ud(t,e,{configurable:l===null&&c?c.configurable:!l,enumerable:i===null&&c?c.enumerable:!i,value:n,writable:o===null&&c?c.writable:!o});else if(h||!i&&!o&&!l)t[e]=n;else throw new tT("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Fh=Tu(),cg=function(){return!!Fh};cg.hasArrayLengthDefineBug=function(){if(!Fh)return null;try{return Fh([],"length",{value:1}).length!==1}catch{return!0}};var rT=cg,nT=Mi,Gd=eT,iT=rT(),Hd=ug,$d=As,sT=nT("%Math.floor%"),oT=function(t,e){if(typeof t!="function")throw new $d("`fn` is not a function");if(typeof e!="number"||e<0||e>4294967295||sT(e)!==e)throw new $d("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],i=!0,o=!0;if("length"in t&&Hd){var l=Hd(t,"length");l&&!l.configurable&&(i=!1),l&&!l.writable&&(o=!1)}return(i||o||!n)&&(iT?Gd(t,"length",e,!0,!0):Gd(t,"length",e)),t};(function(r){var t=Eu,e=Mi,n=oT,i=As,o=e("%Function.prototype.apply%"),l=e("%Function.prototype.call%"),h=e("%Reflect.apply%",!0)||t.call(l,o),c=Tu(),f=e("%Math.max%");r.exports=function(g){if(typeof g!="function")throw new i("a function is required");var y=h(t,l,arguments);return n(y,1+f(0,g.length-(arguments.length-1)),!0)};var d=function(){return h(t,o,arguments)};c?c(r.exports,"apply",{value:d}):r.exports.apply=d})(hg);var aT=hg.exports,fg=Mi,dg=aT,lT=dg(fg("String.prototype.indexOf")),hT=function(t,e){var n=fg(t,!!e);return typeof n=="function"&&lT(t,".prototype.")>-1?dg(n):n};const uT={},cT=Object.freeze(Object.defineProperty({__proto__:null,default:uT},Symbol.toStringTag,{value:"Module"})),fT=zw(cT);var Au=typeof Map=="function"&&Map.prototype,Ql=Object.getOwnPropertyDescriptor&&Au?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,ra=Au&&Ql&&typeof Ql.get=="function"?Ql.get:null,Wd=Au&&Map.prototype.forEach,Su=typeof Set=="function"&&Set.prototype,th=Object.getOwnPropertyDescriptor&&Su?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,na=Su&&th&&typeof th.get=="function"?th.get:null,Xd=Su&&Set.prototype.forEach,dT=typeof WeakMap=="function"&&WeakMap.prototype,fs=dT?WeakMap.prototype.has:null,pT=typeof WeakSet=="function"&&WeakSet.prototype,ds=pT?WeakSet.prototype.has:null,gT=typeof WeakRef=="function"&&WeakRef.prototype,zd=gT?WeakRef.prototype.deref:null,mT=Boolean.prototype.valueOf,_T=Object.prototype.toString,yT=Function.prototype.toString,vT=String.prototype.match,Cu=String.prototype.slice,nn=String.prototype.replace,xT=String.prototype.toUpperCase,Vd=String.prototype.toLowerCase,pg=RegExp.prototype.test,Yd=Array.prototype.concat,wr=Array.prototype.join,bT=Array.prototype.slice,jd=Math.floor,Lh=typeof BigInt=="function"?BigInt.prototype.valueOf:null,eh=Object.getOwnPropertySymbols,Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ci=typeof Symbol=="function"&&typeof Symbol.iterator=="object",xe=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ci||!0)?Symbol.toStringTag:null,gg=Object.prototype.propertyIsEnumerable,qd=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function Kd(r,t){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||pg.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var n=r<0?-jd(-r):jd(r);if(n!==r){var i=String(n),o=Cu.call(t,i.length+1);return nn.call(i,e,"$&_")+"."+nn.call(nn.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return nn.call(t,e,"$&_")}var Uh=fT,Zd=Uh.custom,Jd=_g(Zd)?Zd:null,wT=function r(t,e,n,i){var o=e||{};if(en(o,"quoteStyle")&&o.quoteStyle!=="single"&&o.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(en(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var l=en(o,"customInspect")?o.customInspect:!0;if(typeof l!="boolean"&&l!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(en(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(en(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var h=o.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return vg(t,o);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var c=String(t);return h?Kd(t,c):c}if(typeof t=="bigint"){var f=String(t)+"n";return h?Kd(t,f):f}var d=typeof o.depth>"u"?5:o.depth;if(typeof n>"u"&&(n=0),n>=d&&d>0&&typeof t=="object")return kh(t)?"[Array]":"[Object]";var m=GT(o,n);if(typeof i>"u")i=[];else if(yg(i,t)>=0)return"[Circular]";function g(G,F,at){if(F&&(i=bT.call(i),i.push(F)),at){var ft={depth:o.depth};return en(o,"quoteStyle")&&(ft.quoteStyle=o.quoteStyle),r(G,ft,n+1,i)}return r(G,o,n+1,i)}if(typeof t=="function"&&!Qd(t)){var y=MT(t),v=wo(t,g);return"[Function"+(y?": "+y:" (anonymous)")+"]"+(v.length>0?" { "+wr.call(v,", ")+" }":"")}if(_g(t)){var T=Ci?nn.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):Nh.call(t);return typeof t=="object"&&!Ci?rs(T):T}if(NT(t)){for(var E="<"+Vd.call(String(t.nodeName)),I=t.attributes||[],P=0;P<I.length;P++)E+=" "+I[P].name+"="+mg(ET(I[P].value),"double",o);return E+=">",t.childNodes&&t.childNodes.length&&(E+="..."),E+="</"+Vd.call(String(t.nodeName))+">",E}if(kh(t)){if(t.length===0)return"[]";var w=wo(t,g);return m&&!kT(w)?"["+Gh(w,m)+"]":"[ "+wr.call(w,", ")+" ]"}if(AT(t)){var R=wo(t,g);return!("cause"in Error.prototype)&&"cause"in t&&!gg.call(t,"cause")?"{ ["+String(t)+"] "+wr.call(Yd.call("[cause]: "+g(t.cause),R),", ")+" }":R.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+wr.call(R,", ")+" }"}if(typeof t=="object"&&l){if(Jd&&typeof t[Jd]=="function"&&Uh)return Uh(t,{depth:d-n});if(l!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(DT(t)){var O=[];return Wd&&Wd.call(t,function(G,F){O.push(g(F,t,!0)+" => "+g(G,t))}),tp("Map",ra.call(t),O,m)}if(FT(t)){var W=[];return Xd&&Xd.call(t,function(G){W.push(g(G,t))}),tp("Set",na.call(t),W,m)}if(BT(t))return rh("WeakMap");if(LT(t))return rh("WeakSet");if(OT(t))return rh("WeakRef");if(CT(t))return rs(g(Number(t)));if(RT(t))return rs(g(Lh.call(t)));if(IT(t))return rs(mT.call(t));if(ST(t))return rs(g(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(t===kr)return"{ [object globalThis] }";if(!TT(t)&&!Qd(t)){var k=wo(t,g),U=qd?qd(t)===Object.prototype:t instanceof Object||t.constructor===Object,Y=t instanceof Object?"":"null prototype",J=!U&&xe&&Object(t)===t&&xe in t?Cu.call(cn(t),8,-1):Y?"Object":"",z=U||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",q=z+(J||Y?"["+wr.call(Yd.call([],J||[],Y||[]),": ")+"] ":"");return k.length===0?q+"{}":m?q+"{"+Gh(k,m)+"}":q+"{ "+wr.call(k,", ")+" }"}return String(t)};function mg(r,t,e){var n=(e.quoteStyle||t)==="double"?'"':"'";return n+r+n}function ET(r){return nn.call(String(r),/"/g,"&quot;")}function kh(r){return cn(r)==="[object Array]"&&(!xe||!(typeof r=="object"&&xe in r))}function TT(r){return cn(r)==="[object Date]"&&(!xe||!(typeof r=="object"&&xe in r))}function Qd(r){return cn(r)==="[object RegExp]"&&(!xe||!(typeof r=="object"&&xe in r))}function AT(r){return cn(r)==="[object Error]"&&(!xe||!(typeof r=="object"&&xe in r))}function ST(r){return cn(r)==="[object String]"&&(!xe||!(typeof r=="object"&&xe in r))}function CT(r){return cn(r)==="[object Number]"&&(!xe||!(typeof r=="object"&&xe in r))}function IT(r){return cn(r)==="[object Boolean]"&&(!xe||!(typeof r=="object"&&xe in r))}function _g(r){if(Ci)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return!0;if(!r||typeof r!="object"||!Nh)return!1;try{return Nh.call(r),!0}catch{}return!1}function RT(r){if(!r||typeof r!="object"||!Lh)return!1;try{return Lh.call(r),!0}catch{}return!1}var PT=Object.prototype.hasOwnProperty||function(r){return r in this};function en(r,t){return PT.call(r,t)}function cn(r){return _T.call(r)}function MT(r){if(r.name)return r.name;var t=vT.call(yT.call(r),/^function\s*([\w$]+)/);return t?t[1]:null}function yg(r,t){if(r.indexOf)return r.indexOf(t);for(var e=0,n=r.length;e<n;e++)if(r[e]===t)return e;return-1}function DT(r){if(!ra||!r||typeof r!="object")return!1;try{ra.call(r);try{na.call(r)}catch{return!0}return r instanceof Map}catch{}return!1}function BT(r){if(!fs||!r||typeof r!="object")return!1;try{fs.call(r,fs);try{ds.call(r,ds)}catch{return!0}return r instanceof WeakMap}catch{}return!1}function OT(r){if(!zd||!r||typeof r!="object")return!1;try{return zd.call(r),!0}catch{}return!1}function FT(r){if(!na||!r||typeof r!="object")return!1;try{na.call(r);try{ra.call(r)}catch{return!0}return r instanceof Set}catch{}return!1}function LT(r){if(!ds||!r||typeof r!="object")return!1;try{ds.call(r,ds);try{fs.call(r,fs)}catch{return!0}return r instanceof WeakSet}catch{}return!1}function NT(r){return!r||typeof r!="object"?!1:typeof HTMLElement<"u"&&r instanceof HTMLElement?!0:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function vg(r,t){if(r.length>t.maxStringLength){var e=r.length-t.maxStringLength,n="... "+e+" more character"+(e>1?"s":"");return vg(Cu.call(r,0,t.maxStringLength),t)+n}var i=nn.call(nn.call(r,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,UT);return mg(i,"single",t)}function UT(r){var t=r.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+xT.call(t.toString(16))}function rs(r){return"Object("+r+")"}function rh(r){return r+" { ? }"}function tp(r,t,e,n){var i=n?Gh(e,n):wr.call(e,", ");return r+" ("+t+") {"+i+"}"}function kT(r){for(var t=0;t<r.length;t++)if(yg(r[t],`
`)>=0)return!1;return!0}function GT(r,t){var e;if(r.indent==="	")e="	";else if(typeof r.indent=="number"&&r.indent>0)e=wr.call(Array(r.indent+1)," ");else return null;return{base:e,prev:wr.call(Array(t+1),e)}}function Gh(r,t){if(r.length===0)return"";var e=`
`+t.prev+t.base;return e+wr.call(r,","+e)+`
`+t.prev}function wo(r,t){var e=kh(r),n=[];if(e){n.length=r.length;for(var i=0;i<r.length;i++)n[i]=en(r,i)?t(r[i],r):""}var o=typeof eh=="function"?eh(r):[],l;if(Ci){l={};for(var h=0;h<o.length;h++)l["$"+o[h]]=o[h]}for(var c in r)en(r,c)&&(e&&String(Number(c))===c&&c<r.length||Ci&&l["$"+c]instanceof Symbol||(pg.call(/[^\w$]/,c)?n.push(t(c,r)+": "+t(r[c],r)):n.push(c+": "+t(r[c],r))));if(typeof eh=="function")for(var f=0;f<o.length;f++)gg.call(r,o[f])&&n.push("["+t(o[f])+"]: "+t(r[o[f]],r));return n}var xg=Mi,Di=hT,HT=wT,$T=As,Eo=xg("%WeakMap%",!0),To=xg("%Map%",!0),WT=Di("WeakMap.prototype.get",!0),XT=Di("WeakMap.prototype.set",!0),zT=Di("WeakMap.prototype.has",!0),VT=Di("Map.prototype.get",!0),YT=Di("Map.prototype.set",!0),jT=Di("Map.prototype.has",!0),Iu=function(r,t){for(var e=r,n;(n=e.next)!==null;e=n)if(n.key===t)return e.next=n.next,n.next=r.next,r.next=n,n},qT=function(r,t){var e=Iu(r,t);return e&&e.value},KT=function(r,t,e){var n=Iu(r,t);n?n.value=e:r.next={key:t,next:r.next,value:e}},ZT=function(r,t){return!!Iu(r,t)},JT=function(){var t,e,n,i={assert:function(o){if(!i.has(o))throw new $T("Side channel does not contain "+HT(o))},get:function(o){if(Eo&&o&&(typeof o=="object"||typeof o=="function")){if(t)return WT(t,o)}else if(To){if(e)return VT(e,o)}else if(n)return qT(n,o)},has:function(o){if(Eo&&o&&(typeof o=="object"||typeof o=="function")){if(t)return zT(t,o)}else if(To){if(e)return jT(e,o)}else if(n)return ZT(n,o);return!1},set:function(o,l){Eo&&o&&(typeof o=="object"||typeof o=="function")?(t||(t=new Eo),XT(t,o,l)):To?(e||(e=new To),YT(e,o,l)):(n||(n={key:{},next:null}),KT(n,o,l))}};return i},QT=String.prototype.replace,tA=/%20/g,nh={RFC1738:"RFC1738",RFC3986:"RFC3986"},Ru={default:nh.RFC3986,formatters:{RFC1738:function(r){return QT.call(r,tA,"+")},RFC3986:function(r){return String(r)}},RFC1738:nh.RFC1738,RFC3986:nh.RFC3986},eA=Ru,ih=Object.prototype.hasOwnProperty,Mn=Array.isArray,mr=function(){for(var r=[],t=0;t<256;++t)r.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return r}(),rA=function(t){for(;t.length>1;){var e=t.pop(),n=e.obj[e.prop];if(Mn(n)){for(var i=[],o=0;o<n.length;++o)typeof n[o]<"u"&&i.push(n[o]);e.obj[e.prop]=i}}},bg=function(t,e){for(var n=e&&e.plainObjects?Object.create(null):{},i=0;i<t.length;++i)typeof t[i]<"u"&&(n[i]=t[i]);return n},nA=function r(t,e,n){if(!e)return t;if(typeof e!="object"){if(Mn(t))t.push(e);else if(t&&typeof t=="object")(n&&(n.plainObjects||n.allowPrototypes)||!ih.call(Object.prototype,e))&&(t[e]=!0);else return[t,e];return t}if(!t||typeof t!="object")return[t].concat(e);var i=t;return Mn(t)&&!Mn(e)&&(i=bg(t,n)),Mn(t)&&Mn(e)?(e.forEach(function(o,l){if(ih.call(t,l)){var h=t[l];h&&typeof h=="object"&&o&&typeof o=="object"?t[l]=r(h,o,n):t.push(o)}else t[l]=o}),t):Object.keys(e).reduce(function(o,l){var h=e[l];return ih.call(o,l)?o[l]=r(o[l],h,n):o[l]=h,o},i)},iA=function(t,e){return Object.keys(e).reduce(function(n,i){return n[i]=e[i],n},t)},sA=function(r,t,e){var n=r.replace(/\+/g," ");if(e==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},sh=1024,oA=function(t,e,n,i,o){if(t.length===0)return t;var l=t;if(typeof t=="symbol"?l=Symbol.prototype.toString.call(t):typeof t!="string"&&(l=String(t)),n==="iso-8859-1")return escape(l).replace(/%u[0-9a-f]{4}/gi,function(y){return"%26%23"+parseInt(y.slice(2),16)+"%3B"});for(var h="",c=0;c<l.length;c+=sh){for(var f=l.length>=sh?l.slice(c,c+sh):l,d=[],m=0;m<f.length;++m){var g=f.charCodeAt(m);if(g===45||g===46||g===95||g===126||g>=48&&g<=57||g>=65&&g<=90||g>=97&&g<=122||o===eA.RFC1738&&(g===40||g===41)){d[d.length]=f.charAt(m);continue}if(g<128){d[d.length]=mr[g];continue}if(g<2048){d[d.length]=mr[192|g>>6]+mr[128|g&63];continue}if(g<55296||g>=57344){d[d.length]=mr[224|g>>12]+mr[128|g>>6&63]+mr[128|g&63];continue}m+=1,g=65536+((g&1023)<<10|f.charCodeAt(m)&1023),d[d.length]=mr[240|g>>18]+mr[128|g>>12&63]+mr[128|g>>6&63]+mr[128|g&63]}h+=d.join("")}return h},aA=function(t){for(var e=[{obj:{o:t},prop:"o"}],n=[],i=0;i<e.length;++i)for(var o=e[i],l=o.obj[o.prop],h=Object.keys(l),c=0;c<h.length;++c){var f=h[c],d=l[f];typeof d=="object"&&d!==null&&n.indexOf(d)===-1&&(e.push({obj:l,prop:f}),n.push(d))}return rA(e),t},lA=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},hA=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},uA=function(t,e){return[].concat(t,e)},cA=function(t,e){if(Mn(t)){for(var n=[],i=0;i<t.length;i+=1)n.push(e(t[i]));return n}return e(t)},wg={arrayToObject:bg,assign:iA,combine:uA,compact:aA,decode:sA,encode:oA,isBuffer:hA,isRegExp:lA,maybeMap:cA,merge:nA},Eg=JT,zo=wg,ps=Ru,fA=Object.prototype.hasOwnProperty,Tg={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},xr=Array.isArray,dA=Array.prototype.push,Ag=function(r,t){dA.apply(r,xr(t)?t:[t])},pA=Date.prototype.toISOString,ep=ps.default,le={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:zo.encode,encodeValuesOnly:!1,format:ep,formatter:ps.formatters[ep],indices:!1,serializeDate:function(t){return pA.call(t)},skipNulls:!1,strictNullHandling:!1},gA=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},oh={},mA=function r(t,e,n,i,o,l,h,c,f,d,m,g,y,v,T,E,I,P){for(var w=t,R=P,O=0,W=!1;(R=R.get(oh))!==void 0&&!W;){var k=R.get(t);if(O+=1,typeof k<"u"){if(k===O)throw new RangeError("Cyclic object value");W=!0}typeof R.get(oh)>"u"&&(O=0)}if(typeof d=="function"?w=d(e,w):w instanceof Date?w=y(w):n==="comma"&&xr(w)&&(w=zo.maybeMap(w,function($){return $ instanceof Date?y($):$})),w===null){if(l)return f&&!E?f(e,le.encoder,I,"key",v):e;w=""}if(gA(w)||zo.isBuffer(w)){if(f){var U=E?e:f(e,le.encoder,I,"key",v);return[T(U)+"="+T(f(w,le.encoder,I,"value",v))]}return[T(e)+"="+T(String(w))]}var Y=[];if(typeof w>"u")return Y;var J;if(n==="comma"&&xr(w))E&&f&&(w=zo.maybeMap(w,f)),J=[{value:w.length>0?w.join(",")||null:void 0}];else if(xr(d))J=d;else{var z=Object.keys(w);J=m?z.sort(m):z}var q=c?e.replace(/\./g,"%2E"):e,G=i&&xr(w)&&w.length===1?q+"[]":q;if(o&&xr(w)&&w.length===0)return G+"[]";for(var F=0;F<J.length;++F){var at=J[F],ft=typeof at=="object"&&typeof at.value<"u"?at.value:w[at];if(!(h&&ft===null)){var V=g&&c?at.replace(/\./g,"%2E"):at,_t=xr(w)?typeof n=="function"?n(G,V):G:G+(g?"."+V:"["+V+"]");P.set(t,O);var Ot=Eg();Ot.set(oh,P),Ag(Y,r(ft,_t,n,i,o,l,h,c,n==="comma"&&E&&xr(w)?null:f,d,m,g,y,v,T,E,I,Ot))}}return Y},_A=function(t){if(!t)return le;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var e=t.charset||le.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=ps.default;if(typeof t.format<"u"){if(!fA.call(ps.formatters,t.format))throw new TypeError("Unknown format option provided.");n=t.format}var i=ps.formatters[n],o=le.filter;(typeof t.filter=="function"||xr(t.filter))&&(o=t.filter);var l;if(t.arrayFormat in Tg?l=t.arrayFormat:"indices"in t?l=t.indices?"indices":"repeat":l=le.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var h=typeof t.allowDots>"u"?t.encodeDotInKeys===!0?!0:le.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:le.addQueryPrefix,allowDots:h,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:le.allowEmptyArrays,arrayFormat:l,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:le.charsetSentinel,commaRoundTrip:t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?le.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:le.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:le.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:le.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:le.encodeValuesOnly,filter:o,format:n,formatter:i,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:le.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:le.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:le.strictNullHandling}},yA=function(r,t){var e=r,n=_A(t),i,o;typeof n.filter=="function"?(o=n.filter,e=o("",e)):xr(n.filter)&&(o=n.filter,i=o);var l=[];if(typeof e!="object"||e===null)return"";var h=Tg[n.arrayFormat],c=h==="comma"&&n.commaRoundTrip;i||(i=Object.keys(e)),n.sort&&i.sort(n.sort);for(var f=Eg(),d=0;d<i.length;++d){var m=i[d];n.skipNulls&&e[m]===null||Ag(l,mA(e[m],m,h,c,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,f))}var g=l.join(n.delimiter),y=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?y+="utf8=%26%2310003%3B&":y+="utf8=%E2%9C%93&"),g.length>0?y+g:""},Ii=wg,Hh=Object.prototype.hasOwnProperty,vA=Array.isArray,te={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Ii.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},xA=function(r){return r.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},Sg=function(r,t){return r&&typeof r=="string"&&t.comma&&r.indexOf(",")>-1?r.split(","):r},bA="utf8=%26%2310003%3B",wA="utf8=%E2%9C%93",EA=function(t,e){var n={__proto__:null},i=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,o=e.parameterLimit===1/0?void 0:e.parameterLimit,l=i.split(e.delimiter,o),h=-1,c,f=e.charset;if(e.charsetSentinel)for(c=0;c<l.length;++c)l[c].indexOf("utf8=")===0&&(l[c]===wA?f="utf-8":l[c]===bA&&(f="iso-8859-1"),h=c,c=l.length);for(c=0;c<l.length;++c)if(c!==h){var d=l[c],m=d.indexOf("]="),g=m===-1?d.indexOf("="):m+1,y,v;g===-1?(y=e.decoder(d,te.decoder,f,"key"),v=e.strictNullHandling?null:""):(y=e.decoder(d.slice(0,g),te.decoder,f,"key"),v=Ii.maybeMap(Sg(d.slice(g+1),e),function(E){return e.decoder(E,te.decoder,f,"value")})),v&&e.interpretNumericEntities&&f==="iso-8859-1"&&(v=xA(v)),d.indexOf("[]=")>-1&&(v=vA(v)?[v]:v);var T=Hh.call(n,y);T&&e.duplicates==="combine"?n[y]=Ii.combine(n[y],v):(!T||e.duplicates==="last")&&(n[y]=v)}return n},TA=function(r,t,e,n){for(var i=n?t:Sg(t,e),o=r.length-1;o>=0;--o){var l,h=r[o];if(h==="[]"&&e.parseArrays)l=e.allowEmptyArrays&&i===""?[]:[].concat(i);else{l=e.plainObjects?Object.create(null):{};var c=h.charAt(0)==="["&&h.charAt(h.length-1)==="]"?h.slice(1,-1):h,f=e.decodeDotInKeys?c.replace(/%2E/g,"."):c,d=parseInt(f,10);!e.parseArrays&&f===""?l={0:i}:!isNaN(d)&&h!==f&&String(d)===f&&d>=0&&e.parseArrays&&d<=e.arrayLimit?(l=[],l[d]=i):f!=="__proto__"&&(l[f]=i)}i=l}return i},AA=function(t,e,n,i){if(t){var o=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,l=/(\[[^[\]]*])/,h=/(\[[^[\]]*])/g,c=n.depth>0&&l.exec(o),f=c?o.slice(0,c.index):o,d=[];if(f){if(!n.plainObjects&&Hh.call(Object.prototype,f)&&!n.allowPrototypes)return;d.push(f)}for(var m=0;n.depth>0&&(c=h.exec(o))!==null&&m<n.depth;){if(m+=1,!n.plainObjects&&Hh.call(Object.prototype,c[1].slice(1,-1))&&!n.allowPrototypes)return;d.push(c[1])}return c&&d.push("["+o.slice(c.index)+"]"),TA(d,e,n,i)}},SA=function(t){if(!t)return te;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.decodeDotInKeys<"u"&&typeof t.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(t.decoder!==null&&typeof t.decoder<"u"&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=typeof t.charset>"u"?te.charset:t.charset,n=typeof t.duplicates>"u"?te.duplicates:t.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof t.allowDots>"u"?t.decodeDotInKeys===!0?!0:te.allowDots:!!t.allowDots;return{allowDots:i,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:te.allowEmptyArrays,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:te.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:te.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:te.arrayLimit,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:te.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:te.comma,decodeDotInKeys:typeof t.decodeDotInKeys=="boolean"?t.decodeDotInKeys:te.decodeDotInKeys,decoder:typeof t.decoder=="function"?t.decoder:te.decoder,delimiter:typeof t.delimiter=="string"||Ii.isRegExp(t.delimiter)?t.delimiter:te.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:te.depth,duplicates:n,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:te.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:te.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:te.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:te.strictNullHandling}},CA=function(r,t){var e=SA(t);if(r===""||r===null||typeof r>"u")return e.plainObjects?Object.create(null):{};for(var n=typeof r=="string"?EA(r,e):r,i=e.plainObjects?Object.create(null):{},o=Object.keys(n),l=0;l<o.length;++l){var h=o[l],c=AA(h,n[h],e,typeof r=="string");i=Ii.merge(i,c,e)}return e.allowSparse===!0?i:Ii.compact(i)},IA=yA,RA=CA,PA=Ru,MA={formats:PA,parse:RA,stringify:IA},DA=dE;function lr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var BA=/^([a-z0-9.+-]+:)/i,OA=/:[0-9]*$/,FA=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,LA=["<",">",'"',"`"," ","\r",`
`,"	"],NA=["{","}","|","\\","^","`"].concat(LA),$h=["'"].concat(NA),rp=["%","/","?",";","#"].concat($h),np=["/","?","#"],UA=255,ip=/^[+a-z0-9A-Z_-]{0,63}$/,kA=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,GA={javascript:!0,"javascript:":!0},Wh={javascript:!0,"javascript:":!0},wi={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Xh=MA;function _a(r,t,e){if(r&&typeof r=="object"&&r instanceof lr)return r;var n=new lr;return n.parse(r,t,e),n}lr.prototype.parse=function(r,t,e){if(typeof r!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof r);var n=r.indexOf("?"),i=n!==-1&&n<r.indexOf("#")?"?":"#",o=r.split(i),l=/\\/g;o[0]=o[0].replace(l,"/"),r=o.join(i);var h=r;if(h=h.trim(),!e&&r.split("#").length===1){var c=FA.exec(h);if(c)return this.path=h,this.href=h,this.pathname=c[1],c[2]?(this.search=c[2],t?this.query=Xh.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var f=BA.exec(h);if(f){f=f[0];var d=f.toLowerCase();this.protocol=d,h=h.substr(f.length)}if(e||f||h.match(/^\/\/[^@/]+@[^@/]+/)){var m=h.substr(0,2)==="//";m&&!(f&&Wh[f])&&(h=h.substr(2),this.slashes=!0)}if(!Wh[f]&&(m||f&&!wi[f])){for(var g=-1,y=0;y<np.length;y++){var v=h.indexOf(np[y]);v!==-1&&(g===-1||v<g)&&(g=v)}var T,E;g===-1?E=h.lastIndexOf("@"):E=h.lastIndexOf("@",g),E!==-1&&(T=h.slice(0,E),h=h.slice(E+1),this.auth=decodeURIComponent(T)),g=-1;for(var y=0;y<rp.length;y++){var v=h.indexOf(rp[y]);v!==-1&&(g===-1||v<g)&&(g=v)}g===-1&&(g=h.length),this.host=h.slice(0,g),h=h.slice(g),this.parseHost(),this.hostname=this.hostname||"";var I=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!I)for(var P=this.hostname.split(/\./),y=0,w=P.length;y<w;y++){var R=P[y];if(R&&!R.match(ip)){for(var O="",W=0,k=R.length;W<k;W++)R.charCodeAt(W)>127?O+="x":O+=R[W];if(!O.match(ip)){var U=P.slice(0,y),Y=P.slice(y+1),J=R.match(kA);J&&(U.push(J[1]),Y.unshift(J[2])),Y.length&&(h="/"+Y.join(".")+h),this.hostname=U.join(".");break}}}this.hostname.length>UA?this.hostname="":this.hostname=this.hostname.toLowerCase(),I||(this.hostname=DA.toASCII(this.hostname));var z=this.port?":"+this.port:"",q=this.hostname||"";this.host=q+z,this.href+=this.host,I&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),h[0]!=="/"&&(h="/"+h))}if(!GA[d])for(var y=0,w=$h.length;y<w;y++){var G=$h[y];if(h.indexOf(G)!==-1){var F=encodeURIComponent(G);F===G&&(F=escape(G)),h=h.split(G).join(F)}}var at=h.indexOf("#");at!==-1&&(this.hash=h.substr(at),h=h.slice(0,at));var ft=h.indexOf("?");if(ft!==-1?(this.search=h.substr(ft),this.query=h.substr(ft+1),t&&(this.query=Xh.parse(this.query)),h=h.slice(0,ft)):t&&(this.search="",this.query={}),h&&(this.pathname=h),wi[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var z=this.pathname||"",V=this.search||"";this.path=z+V}return this.href=this.format(),this};function HA(r){return typeof r=="string"&&(r=_a(r)),r instanceof lr?r.format():lr.prototype.format.call(r)}lr.prototype.format=function(){var r=this.auth||"";r&&(r=encodeURIComponent(r),r=r.replace(/%3A/i,":"),r+="@");var t=this.protocol||"",e=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=r+this.host:this.hostname&&(i=r+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(o=Xh.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var l=this.search||o&&"?"+o||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||wi[t])&&i!==!1?(i="//"+(i||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):i||(i=""),n&&n.charAt(0)!=="#"&&(n="#"+n),l&&l.charAt(0)!=="?"&&(l="?"+l),e=e.replace(/[?#]/g,function(h){return encodeURIComponent(h)}),l=l.replace("#","%23"),t+i+e+l+n};function $A(r,t){return _a(r,!1,!0).resolve(t)}lr.prototype.resolve=function(r){return this.resolveObject(_a(r,!1,!0)).format()};lr.prototype.resolveObject=function(r){if(typeof r=="string"){var t=new lr;t.parse(r,!1,!0),r=t}for(var e=new lr,n=Object.keys(this),i=0;i<n.length;i++){var o=n[i];e[o]=this[o]}if(e.hash=r.hash,r.href==="")return e.href=e.format(),e;if(r.slashes&&!r.protocol){for(var l=Object.keys(r),h=0;h<l.length;h++){var c=l[h];c!=="protocol"&&(e[c]=r[c])}return wi[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname),e.href=e.format(),e}if(r.protocol&&r.protocol!==e.protocol){if(!wi[r.protocol]){for(var f=Object.keys(r),d=0;d<f.length;d++){var m=f[d];e[m]=r[m]}return e.href=e.format(),e}if(e.protocol=r.protocol,!r.host&&!Wh[r.protocol]){for(var w=(r.pathname||"").split("/");w.length&&!(r.host=w.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),w[0]!==""&&w.unshift(""),w.length<2&&w.unshift(""),e.pathname=w.join("/")}else e.pathname=r.pathname;if(e.search=r.search,e.query=r.query,e.host=r.host||"",e.auth=r.auth,e.hostname=r.hostname||r.host,e.port=r.port,e.pathname||e.search){var g=e.pathname||"",y=e.search||"";e.path=g+y}return e.slashes=e.slashes||r.slashes,e.href=e.format(),e}var v=e.pathname&&e.pathname.charAt(0)==="/",T=r.host||r.pathname&&r.pathname.charAt(0)==="/",E=T||v||e.host&&r.pathname,I=E,P=e.pathname&&e.pathname.split("/")||[],w=r.pathname&&r.pathname.split("/")||[],R=e.protocol&&!wi[e.protocol];if(R&&(e.hostname="",e.port=null,e.host&&(P[0]===""?P[0]=e.host:P.unshift(e.host)),e.host="",r.protocol&&(r.hostname=null,r.port=null,r.host&&(w[0]===""?w[0]=r.host:w.unshift(r.host)),r.host=null),E=E&&(w[0]===""||P[0]==="")),T)e.host=r.host||r.host===""?r.host:e.host,e.hostname=r.hostname||r.hostname===""?r.hostname:e.hostname,e.search=r.search,e.query=r.query,P=w;else if(w.length)P||(P=[]),P.pop(),P=P.concat(w),e.search=r.search,e.query=r.query;else if(r.search!=null){if(R){e.host=P.shift(),e.hostname=e.host;var O=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;O&&(e.auth=O.shift(),e.hostname=O.shift(),e.host=e.hostname)}return e.search=r.search,e.query=r.query,(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!P.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var W=P.slice(-1)[0],k=(e.host||r.host||P.length>1)&&(W==="."||W==="..")||W==="",U=0,Y=P.length;Y>=0;Y--)W=P[Y],W==="."?P.splice(Y,1):W===".."?(P.splice(Y,1),U++):U&&(P.splice(Y,1),U--);if(!E&&!I)for(;U--;U)P.unshift("..");E&&P[0]!==""&&(!P[0]||P[0].charAt(0)!=="/")&&P.unshift(""),k&&P.join("/").substr(-1)!=="/"&&P.push("");var J=P[0]===""||P[0]&&P[0].charAt(0)==="/";if(R){e.hostname=J?"":P.length?P.shift():"",e.host=e.hostname;var O=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;O&&(e.auth=O.shift(),e.hostname=O.shift(),e.host=e.hostname)}return E=E||e.host&&P.length,E&&!J&&P.unshift(""),P.length>0?e.pathname=P.join("/"):(e.pathname=null,e.path=null),(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=r.auth||e.auth,e.slashes=e.slashes||r.slashes,e.href=e.format(),e};lr.prototype.parseHost=function(){var r=this.host,t=OA.exec(r);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),r=r.substr(0,r.length-t.length)),r&&(this.hostname=r)};var WA=_a,XA=$A,zA=HA;const VA={parse:WA,format:zA,resolve:XA};function tr(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function ns(r){return r.split("?")[0].split("#")[0]}function YA(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function jA(r,t,e){return r.replace(new RegExp(YA(t),"g"),e)}function qA(r,t){let e="",n=0,i=-1,o=0,l=-1;for(let h=0;h<=r.length;++h){if(h<r.length)l=r.charCodeAt(h);else{if(l===47)break;l=47}if(l===47){if(!(i===h-1||o===1))if(i!==h-1&&o===2){if(e.length<2||n!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const c=e.lastIndexOf("/");if(c!==e.length-1){c===-1?(e="",n=0):(e=e.slice(0,c),n=e.length-1-e.lastIndexOf("/")),i=h,o=0;continue}}else if(e.length===2||e.length===1){e="",n=0,i=h,o=0;continue}}}else e.length>0?e+=`/${r.slice(i+1,h)}`:e=r.slice(i+1,h),n=h-i-1;i=h,o=0}else l===46&&o!==-1?++o:o=-1}return e}const me={toPosix(r){return jA(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},hasProtocol(r){return/^[^/:]+:\//.test(this.toPosix(r))},getProtocol(r){tr(r),r=this.toPosix(r);let t="";const e=/^file:\/\/\//.exec(r),n=/^[^/:]+:\/\//.exec(r),i=/^[^/:]+:\//.exec(r);if(e||n||i){const o=(e==null?void 0:e[0])||(n==null?void 0:n[0])||(i==null?void 0:i[0]);t=o,r=r.slice(o.length)}return t},toAbsolute(r,t,e){if(this.isDataUrl(r))return r;const n=ns(this.toPosix(t??Z.ADAPTER.getBaseUrl())),i=ns(this.toPosix(e??this.rootname(n)));return tr(r),r=this.toPosix(r),r.startsWith("/")?me.join(i,r.slice(1)):this.isAbsolute(r)?r:this.join(n,r)},normalize(r){if(r=this.toPosix(r),tr(r),r.length===0)return".";let t="";const e=r.startsWith("/");this.hasProtocol(r)&&(t=this.rootname(r),r=r.slice(t.length));const n=r.endsWith("/");return r=qA(r),r.length>0&&n&&(r+="/"),e?`/${r}`:t+r},isAbsolute(r){return tr(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let t;for(let e=0;e<r.length;++e){const n=r[e];if(tr(n),n.length>0)if(t===void 0)t=n;else{const i=r[e-1]??"";this.extname(i)?t+=`/../${n}`:t+=`/${n}`}}return t===void 0?".":this.normalize(t)},dirname(r){if(tr(r),r.length===0)return".";r=this.toPosix(r);let t=r.charCodeAt(0);const e=t===47;let n=-1,i=!0;const o=this.getProtocol(r),l=r;r=r.slice(o.length);for(let h=r.length-1;h>=1;--h)if(t=r.charCodeAt(h),t===47){if(!i){n=h;break}}else i=!1;return n===-1?e?"/":this.isUrl(l)?o+r:o:e&&n===1?"//":o+r.slice(0,n)},rootname(r){tr(r),r=this.toPosix(r);let t="";if(r.startsWith("/")?t="/":t=this.getProtocol(r),this.isUrl(r)){const e=r.indexOf("/",t.length);e!==-1?t=r.slice(0,e):t=r,t.endsWith("/")||(t+="/")}return t},basename(r,t){tr(r),t&&tr(t),r=ns(this.toPosix(r));let e=0,n=-1,i=!0,o;if(t!==void 0&&t.length>0&&t.length<=r.length){if(t.length===r.length&&t===r)return"";let l=t.length-1,h=-1;for(o=r.length-1;o>=0;--o){const c=r.charCodeAt(o);if(c===47){if(!i){e=o+1;break}}else h===-1&&(i=!1,h=o+1),l>=0&&(c===t.charCodeAt(l)?--l===-1&&(n=o):(l=-1,n=h))}return e===n?n=h:n===-1&&(n=r.length),r.slice(e,n)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===47){if(!i){e=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(e,n)},extname(r){tr(r),r=ns(this.toPosix(r));let t=-1,e=0,n=-1,i=!0,o=0;for(let l=r.length-1;l>=0;--l){const h=r.charCodeAt(l);if(h===47){if(!i){e=l+1;break}continue}n===-1&&(i=!1,n=l+1),h===46?t===-1?t=l:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||n===-1||o===0||o===1&&t===n-1&&t===e+1?"":r.slice(t,n)},parse(r){tr(r);const t={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return t;r=ns(this.toPosix(r));let e=r.charCodeAt(0);const n=this.isAbsolute(r);let i;t.root=this.rootname(r),n||this.hasProtocol(r)?i=1:i=0;let o=-1,l=0,h=-1,c=!0,f=r.length-1,d=0;for(;f>=i;--f){if(e=r.charCodeAt(f),e===47){if(!c){l=f+1;break}continue}h===-1&&(c=!1,h=f+1),e===46?o===-1?o=f:d!==1&&(d=1):o!==-1&&(d=-1)}return o===-1||h===-1||d===0||d===1&&o===h-1&&o===l+1?h!==-1&&(l===0&&n?t.base=t.name=r.slice(1,h):t.base=t.name=r.slice(l,h)):(l===0&&n?(t.name=r.slice(1,o),t.base=r.slice(1,h)):(t.name=r.slice(l,o),t.base=r.slice(l,h)),t.ext=r.slice(o,h)),t.dir=this.dirname(r),t},sep:"/",delimiter:":"},sp={};function St(r,t,e=3){if(sp[t])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`):(n=n.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${r}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`),console.warn(n))),sp[t]=!0}let ah;function KA(){return typeof ah>"u"&&(ah=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:Z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!Z.ADAPTER.getWebGLRenderingContext())return!1;const n=Z.ADAPTER.createCanvas();let i=n.getContext("webgl",t)||n.getContext("experimental-webgl",t);const o=!!((e=i==null?void 0:i.getContextAttributes())!=null&&e.stencil);if(i){const l=i.getExtension("WEBGL_lose_context");l&&l.loseContext()}return i=null,o}catch{return!1}}()),ah}var ZA="#f0f8ff",JA="#faebd7",QA="#00ffff",tS="#7fffd4",eS="#f0ffff",rS="#f5f5dc",nS="#ffe4c4",iS="#000000",sS="#ffebcd",oS="#0000ff",aS="#8a2be2",lS="#a52a2a",hS="#deb887",uS="#5f9ea0",cS="#7fff00",fS="#d2691e",dS="#ff7f50",pS="#6495ed",gS="#fff8dc",mS="#dc143c",_S="#00ffff",yS="#00008b",vS="#008b8b",xS="#b8860b",bS="#a9a9a9",wS="#006400",ES="#a9a9a9",TS="#bdb76b",AS="#8b008b",SS="#556b2f",CS="#ff8c00",IS="#9932cc",RS="#8b0000",PS="#e9967a",MS="#8fbc8f",DS="#483d8b",BS="#2f4f4f",OS="#2f4f4f",FS="#00ced1",LS="#9400d3",NS="#ff1493",US="#00bfff",kS="#696969",GS="#696969",HS="#1e90ff",$S="#b22222",WS="#fffaf0",XS="#228b22",zS="#ff00ff",VS="#dcdcdc",YS="#f8f8ff",jS="#daa520",qS="#ffd700",KS="#808080",ZS="#008000",JS="#adff2f",QS="#808080",tC="#f0fff0",eC="#ff69b4",rC="#cd5c5c",nC="#4b0082",iC="#fffff0",sC="#f0e68c",oC="#fff0f5",aC="#e6e6fa",lC="#7cfc00",hC="#fffacd",uC="#add8e6",cC="#f08080",fC="#e0ffff",dC="#fafad2",pC="#d3d3d3",gC="#90ee90",mC="#d3d3d3",_C="#ffb6c1",yC="#ffa07a",vC="#20b2aa",xC="#87cefa",bC="#778899",wC="#778899",EC="#b0c4de",TC="#ffffe0",AC="#00ff00",SC="#32cd32",CC="#faf0e6",IC="#ff00ff",RC="#800000",PC="#66cdaa",MC="#0000cd",DC="#ba55d3",BC="#9370db",OC="#3cb371",FC="#7b68ee",LC="#00fa9a",NC="#48d1cc",UC="#c71585",kC="#191970",GC="#f5fffa",HC="#ffe4e1",$C="#ffe4b5",WC="#ffdead",XC="#000080",zC="#fdf5e6",VC="#808000",YC="#6b8e23",jC="#ffa500",qC="#ff4500",KC="#da70d6",ZC="#eee8aa",JC="#98fb98",QC="#afeeee",tI="#db7093",eI="#ffefd5",rI="#ffdab9",nI="#cd853f",iI="#ffc0cb",sI="#dda0dd",oI="#b0e0e6",aI="#800080",lI="#663399",hI="#ff0000",uI="#bc8f8f",cI="#4169e1",fI="#8b4513",dI="#fa8072",pI="#f4a460",gI="#2e8b57",mI="#fff5ee",_I="#a0522d",yI="#c0c0c0",vI="#87ceeb",xI="#6a5acd",bI="#708090",wI="#708090",EI="#fffafa",TI="#00ff7f",AI="#4682b4",SI="#d2b48c",CI="#008080",II="#d8bfd8",RI="#ff6347",PI="#40e0d0",MI="#ee82ee",DI="#f5deb3",BI="#ffffff",OI="#f5f5f5",FI="#ffff00",LI="#9acd32",NI={aliceblue:ZA,antiquewhite:JA,aqua:QA,aquamarine:tS,azure:eS,beige:rS,bisque:nS,black:iS,blanchedalmond:sS,blue:oS,blueviolet:aS,brown:lS,burlywood:hS,cadetblue:uS,chartreuse:cS,chocolate:fS,coral:dS,cornflowerblue:pS,cornsilk:gS,crimson:mS,cyan:_S,darkblue:yS,darkcyan:vS,darkgoldenrod:xS,darkgray:bS,darkgreen:wS,darkgrey:ES,darkkhaki:TS,darkmagenta:AS,darkolivegreen:SS,darkorange:CS,darkorchid:IS,darkred:RS,darksalmon:PS,darkseagreen:MS,darkslateblue:DS,darkslategray:BS,darkslategrey:OS,darkturquoise:FS,darkviolet:LS,deeppink:NS,deepskyblue:US,dimgray:kS,dimgrey:GS,dodgerblue:HS,firebrick:$S,floralwhite:WS,forestgreen:XS,fuchsia:zS,gainsboro:VS,ghostwhite:YS,goldenrod:jS,gold:qS,gray:KS,green:ZS,greenyellow:JS,grey:QS,honeydew:tC,hotpink:eC,indianred:rC,indigo:nC,ivory:iC,khaki:sC,lavenderblush:oC,lavender:aC,lawngreen:lC,lemonchiffon:hC,lightblue:uC,lightcoral:cC,lightcyan:fC,lightgoldenrodyellow:dC,lightgray:pC,lightgreen:gC,lightgrey:mC,lightpink:_C,lightsalmon:yC,lightseagreen:vC,lightskyblue:xC,lightslategray:bC,lightslategrey:wC,lightsteelblue:EC,lightyellow:TC,lime:AC,limegreen:SC,linen:CC,magenta:IC,maroon:RC,mediumaquamarine:PC,mediumblue:MC,mediumorchid:DC,mediumpurple:BC,mediumseagreen:OC,mediumslateblue:FC,mediumspringgreen:LC,mediumturquoise:NC,mediumvioletred:UC,midnightblue:kC,mintcream:GC,mistyrose:HC,moccasin:$C,navajowhite:WC,navy:XC,oldlace:zC,olive:VC,olivedrab:YC,orange:jC,orangered:qC,orchid:KC,palegoldenrod:ZC,palegreen:JC,paleturquoise:QC,palevioletred:tI,papayawhip:eI,peachpuff:rI,peru:nI,pink:iI,plum:sI,powderblue:oI,purple:aI,rebeccapurple:lI,red:hI,rosybrown:uI,royalblue:cI,saddlebrown:fI,salmon:dI,sandybrown:pI,seagreen:gI,seashell:mI,sienna:_I,silver:yI,skyblue:vI,slateblue:xI,slategray:bI,slategrey:wI,snow:EI,springgreen:TI,steelblue:AI,tan:SI,teal:CI,thistle:II,tomato:RI,turquoise:PI,violet:MI,wheat:DI,white:BI,whitesmoke:OI,yellow:FI,yellowgreen:LI};function xs(r,t=[]){return t[0]=(r>>16&255)/255,t[1]=(r>>8&255)/255,t[2]=(r&255)/255,t}function Cg(r){let t=r.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}function Pu(r){if(typeof r=="string"&&(r=NI[r.toLowerCase()]||r,r[0]==="#"&&(r=r.slice(1)),r.length===3)){const[t,e,n]=r;r=t+t+e+e+n+n}return parseInt(r,16)}function UI(){const r=[],t=[];for(let n=0;n<32;n++)r[n]=n,t[n]=n;r[ut.NORMAL_NPM]=ut.NORMAL,r[ut.ADD_NPM]=ut.ADD,r[ut.SCREEN_NPM]=ut.SCREEN,t[ut.NORMAL]=ut.NORMAL_NPM,t[ut.ADD]=ut.ADD_NPM,t[ut.SCREEN]=ut.SCREEN_NPM;const e=[];return e.push(t),e.push(r),e}const Ig=UI();function Rg(r,t){return Ig[t?1:0][r]}function kI(r,t,e,n){return e=e||new Float32Array(4),n||n===void 0?(e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t):(e[0]=r[0],e[1]=r[1],e[2]=r[2]),e[3]=t,e}function Mu(r,t){if(t===1)return(t*255<<24)+r;if(t===0)return 0;let e=r>>16&255,n=r>>8&255,i=r&255;return e=e*t+.5|0,n=n*t+.5|0,i=i*t+.5|0,(t*255<<24)+(e<<16)+(n<<8)+i}function Pg(r,t,e,n){return e=e||new Float32Array(4),e[0]=(r>>16&255)/255,e[1]=(r>>8&255)/255,e[2]=(r&255)/255,(n||n===void 0)&&(e[0]*=t,e[1]*=t,e[2]*=t),e[3]=t,e}function GI(r,t=null){const e=r*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let n=0,i=0;n<e;n+=6,i+=4)t[n+0]=i+0,t[n+1]=i+1,t[n+2]=i+2,t[n+3]=i+0,t[n+4]=i+2,t[n+5]=i+3;return t}function Mg(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}function ia(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function op(r){return!(r&r-1)&&!!r}function ap(r){let t=(r>65535?1:0)<<4;r>>>=t;let e=(r>255?1:0)<<3;return r>>>=e,t|=e,e=(r>15?1:0)<<2,r>>>=e,t|=e,e=(r>3?1:0)<<1,r>>>=e,t|=e,t|r>>1}function Ei(r,t,e){const n=r.length;let i;if(t>=n||e===0)return;e=t+e>n?n-t:e;const o=n-e;for(i=t;i<o;++i)r[i]=r[i+e];r.length=o}function mi(r){return r===0?0:r<0?-1:1}let HI=0;function Gn(){return++HI}const Dg=class{constructor(r,t,e,n){this.left=r,this.top=t,this.right=e,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let zh=Dg;zh.EMPTY=new Dg(0,0,0,0);const lp={},yr=Object.create(null),Qr=Object.create(null);class hp{constructor(t,e,n){this._canvas=Z.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||Z.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function up(r,t,e){for(let n=0,i=4*e*t;n<t;++n,i+=4)if(r[i+3]!==0)return!1;return!0}function cp(r,t,e,n,i){const o=4*t;for(let l=n,h=n*o+4*e;l<=i;++l,h+=o)if(r[h+3]!==0)return!1;return!0}function $I(r){const{width:t,height:e}=r,n=r.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const o=n.getImageData(0,0,t,e).data;let l=0,h=0,c=t-1,f=e-1;for(;h<e&&up(o,t,h);)++h;if(h===e)return zh.EMPTY;for(;up(o,t,f);)--f;for(;cp(o,t,l,h,f);)++l;for(;cp(o,t,c,h,f);)--c;return++c,++f,new zh(l,h,c,f)}function WI(r){const t=$I(r),{width:e,height:n}=t;let i=null;if(!t.isEmpty()){const o=r.getContext("2d");if(o===null)throw new TypeError("Failed to get canvas 2D context");i=o.getImageData(t.left,t.top,e,n)}return{width:e,height:n,data:i}}let Ao;function XI(r,t=globalThis.location){if(r.startsWith("data:"))return"";t=t||globalThis.location,Ao||(Ao=document.createElement("a")),Ao.href=r;const e=VA.parse(Ao.href),n=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!n||e.protocol!==t.protocol?"anonymous":""}function an(r,t=1){var n;const e=(n=Z.RETINA_PREFIX)==null?void 0:n.exec(r);return e?parseFloat(e[1]):t}var K=(r=>(r.Renderer="renderer",r.Application="application",r.RendererSystem="renderer-webgl-system",r.RendererPlugin="renderer-webgl-plugin",r.CanvasRendererSystem="renderer-canvas-system",r.CanvasRendererPlugin="renderer-canvas-plugin",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r))(K||{});const Vh=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},fp=(r,t)=>Vh(r).priority??t,it={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(Vh).forEach(t=>{t.type.forEach(e=>{var n,i;return(i=(n=this._removeHandlers)[e])==null?void 0:i.call(n,t)})}),this},add(...r){return r.map(Vh).forEach(t=>{t.type.forEach(e=>{const n=this._addHandlers,i=this._queue;n[e]?n[e](t):(i[e]=i[e]||[],i[e].push(t))})}),this},handle(r,t,e){const n=this._addHandlers,i=this._removeHandlers;if(n[r]||i[r])throw new Error(`Extension type ${r} already has a handler`);n[r]=t,i[r]=e;const o=this._queue;return o[r]&&(o[r].forEach(l=>t(l)),delete o[r]),this},handleByMap(r,t){return this.handle(r,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(r,t,e=-1){return this.handle(r,n=>{t.includes(n.ref)||(t.push(n.ref),t.sort((i,o)=>fp(o,e)-fp(i,e)))},n=>{const i=t.indexOf(n.ref);i!==-1&&t.splice(i,1)})}};class Yh{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const zI=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function VI(r){let t="";for(let e=0;e<r;++e)e>0&&(t+=`
else `),e<r-1&&(t+=`if(test == ${e}.0){}`);return t}function YI(r,t){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const n=zI.replace(/%forloop%/gi,VI(r));if(t.shaderSource(e,n),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))r=r/2|0;else break}return r}const lh=0,hh=1,uh=2,ch=3,fh=4,dh=5;class Wr{constructor(){this.data=0,this.blendMode=ut.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<lh)}set blend(t){!!(this.data&1<<lh)!==t&&(this.data^=1<<lh)}get offsets(){return!!(this.data&1<<hh)}set offsets(t){!!(this.data&1<<hh)!==t&&(this.data^=1<<hh)}get culling(){return!!(this.data&1<<uh)}set culling(t){!!(this.data&1<<uh)!==t&&(this.data^=1<<uh)}get depthTest(){return!!(this.data&1<<ch)}set depthTest(t){!!(this.data&1<<ch)!==t&&(this.data^=1<<ch)}get depthMask(){return!!(this.data&1<<dh)}set depthMask(t){!!(this.data&1<<dh)!==t&&(this.data^=1<<dh)}get clockwiseFrontFace(){return!!(this.data&1<<fh)}set clockwiseFrontFace(t){!!(this.data&1<<fh)!==t&&(this.data^=1<<fh)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==ut.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Wr;return t.depthTest=!1,t.blend=!0,t}}const jh=[];function Bg(r,t){if(!r)return null;let e="";if(typeof r=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);n&&(e=n[1].toLowerCase())}for(let n=jh.length-1;n>=0;--n){const i=jh[n];if(i.test&&i.test(r,e))return new i(r,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class hr{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,n,i,o,l,h,c){if(arguments.length>8)throw new Error("max arguments reached");const{name:f,items:d}=this;this._aliasCount++;for(let m=0,g=d.length;m<g;m++)d[m][f](t,e,n,i,o,l,h,c);return d===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(hr.prototype,{dispatch:{value:hr.prototype.emit},run:{value:hr.prototype.emit}});class bs{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new hr("setRealSize"),this.onUpdate=new hr("update"),this.onError=new hr("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class Cs extends bs{constructor(t,e){const{width:n,height:i}=e||{};if(!n||!i)throw new Error("BufferResource width or height invalid");super(n,i),this.data=t}upload(t,e,n){const i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===cr.UNPACK);const o=e.realWidth,l=e.realHeight;return n.width===o&&n.height===l?i.texSubImage2D(e.target,0,0,0,o,l,e.format,n.type,this.data):(n.width=o,n.height=l,i.texImage2D(e.target,0,n.internalFormat,o,l,0,e.format,n.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const jI={scaleMode:Gr.NEAREST,format:X.RGBA,alphaMode:cr.NPM},ci=class extends Ts{constructor(r=null,t=null){super(),t=Object.assign({},ci.defaultOptions,t);const{alphaMode:e,mipmap:n,anisotropicLevel:i,scaleMode:o,width:l,height:h,wrapMode:c,format:f,type:d,target:m,resolution:g,resourceOptions:y}=t;r&&!(r instanceof bs)&&(r=Bg(r,y),r.internal=!0),this.resolution=g||Z.RESOLUTION,this.width=Math.round((l||0)*this.resolution)/this.resolution,this.height=Math.round((h||0)*this.resolution)/this.resolution,this._mipmap=n,this.anisotropicLevel=i,this._wrapMode=c,this._scaleMode=o,this.format=f,this.type=d,this.target=m,this.alphaMode=e,this.uid=Gn(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=l>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(r)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(r){this._mipmap!==r&&(this._mipmap=r,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(r){this._scaleMode!==r&&(this._scaleMode=r,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(r){this._wrapMode!==r&&(this._wrapMode=r,this.dirtyStyleId++)}setStyle(r,t){let e;return r!==void 0&&r!==this.scaleMode&&(this.scaleMode=r,e=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,e=!0),e&&this.dirtyStyleId++,this}setSize(r,t,e){return e=e||this.resolution,this.setRealSize(r*e,t*e,e)}setRealSize(r,t,e){return this.resolution=e||this.resolution,this.width=Math.round(r)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=op(this.realWidth)&&op(this.realHeight)}setResolution(r){const t=this.resolution;return t===r?this:(this.resolution=r,this.valid&&(this.width=Math.round(this.width*t)/r,this.height=Math.round(this.height*t)/r,this.emit("update",this)),this._refreshPOT(),this)}setResource(r){if(this.resource===r)return this;if(this.resource)throw new Error("Resource can be set only once");return r.bind(this),this.resource=r,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(r){this.emit("error",this,r)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Qr[this.cacheId],delete yr[this.cacheId],this.cacheId=null),this.dispose(),ci.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(r,t,e=Z.STRICT_TEXTURE_CACHE){const n=typeof r=="string";let i=null;if(n)i=r;else{if(!r._pixiId){const l=(t==null?void 0:t.pixiIdPrefix)||"pixiid";r._pixiId=`${l}_${Gn()}`}i=r._pixiId}let o=Qr[i];if(n&&e&&!o)throw new Error(`The cacheId "${i}" does not exist in BaseTextureCache.`);return o||(o=new ci(r,t),o.cacheId=i,ci.addToCache(o,i)),o}static fromBuffer(r,t,e,n){r=r||new Float32Array(t*e*4);const i=new Cs(r,{width:t,height:e}),o=r instanceof Float32Array?st.FLOAT:st.UNSIGNED_BYTE;return new ci(i,Object.assign({},jI,n||{width:t,height:e,type:o}))}static addToCache(r,t){t&&(r.textureCacheIds.includes(t)||r.textureCacheIds.push(t),Qr[t]&&Qr[t]!==r&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),Qr[t]=r)}static removeFromCache(r){if(typeof r=="string"){const t=Qr[r];if(t){const e=t.textureCacheIds.indexOf(r);return e>-1&&t.textureCacheIds.splice(e,1),delete Qr[r],t}}else if(r!=null&&r.textureCacheIds){for(let t=0;t<r.textureCacheIds.length;++t)delete Qr[r.textureCacheIds[t]];return r.textureCacheIds.length=0,r}return null}};let pt=ci;pt.defaultOptions={mipmap:Sr.POW2,anisotropicLevel:0,scaleMode:Gr.LINEAR,wrapMode:on.CLAMP,alphaMode:cr.UNPACK,target:xi.TEXTURE_2D,format:X.RGBA,type:st.UNSIGNED_BYTE};pt._globalBatch=0;class qh{constructor(){this.texArray=null,this.blend=0,this.type=Er.TRIANGLES,this.start=0,this.size=0,this.data=null}}let qI=0;class ee{constructor(t,e=!0,n=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=qI++,this.disposeRunner=new hr("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Tr.ELEMENT_ARRAY_BUFFER:Tr.ARRAY_BUFFER}get index(){return this.type===Tr.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new ee(t)}}class sa{constructor(t,e=0,n=!1,i=st.FLOAT,o,l,h,c=1){this.buffer=t,this.size=e,this.normalized=n,this.type=i,this.stride=o,this.start=l,this.instance=h,this.divisor=c}destroy(){this.buffer=null}static from(t,e,n,i,o){return new sa(t,e,n,i,o)}}const KI={Float32Array,Uint32Array,Int32Array,Uint8Array};function ZI(r,t){let e=0,n=0;const i={};for(let c=0;c<r.length;c++)n+=t[c],e+=r[c].length;const o=new ArrayBuffer(e*4);let l=null,h=0;for(let c=0;c<r.length;c++){const f=t[c],d=r[c],m=Mg(d);i[m]||(i[m]=new KI[m](o)),l=i[m];for(let g=0;g<d.length;g++){const y=(g/f|0)*n+h,v=g%f;l[y+v]=d[g]}h+=f}return new Float32Array(o)}const dp={5126:4,5123:2,5121:1};let JI=0;const QI={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class ln{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=JI++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new hr("disposeGeometry"),this.refCount=0}addAttribute(t,e,n=0,i=!1,o,l,h,c=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof ee||(e instanceof Array&&(e=new Float32Array(e)),e=new ee(e));const f=t.split("|");if(f.length>1){for(let m=0;m<f.length;m++)this.addAttribute(f[m],e,n,i,o);return this}let d=this.buffers.indexOf(e);return d===-1&&(this.buffers.push(e),d=this.buffers.length-1),this.attributes[t]=new sa(d,n,i,o,l,h,c),this.instanced=this.instanced||c,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof ee||(t instanceof Array&&(t=new Uint16Array(t)),t=new ee(t)),t.type=Tr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],n=new ee;let i;for(i in this.attributes){const o=this.attributes[i],l=this.buffers[o.buffer];t.push(l.data),e.push(o.size*dp[o.type]/4),o.buffer=0}for(n.data=ZI(t,e),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new ln;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new ee(this.buffers[e].data.slice(0));for(const e in this.attributes){const n=this.attributes[e];t.attributes[e]=new sa(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Tr.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new ln,n=[],i=[],o=[];let l;for(let h=0;h<t.length;h++){l=t[h];for(let c=0;c<l.buffers.length;c++)i[c]=i[c]||0,i[c]+=l.buffers[c].data.length,o[c]=0}for(let h=0;h<l.buffers.length;h++)n[h]=new QI[Mg(l.buffers[h].data)](i[h]),e.buffers[h]=new ee(n[h]);for(let h=0;h<t.length;h++){l=t[h];for(let c=0;c<l.buffers.length;c++)n[c].set(l.buffers[c].data,o[c]),o[c]+=l.buffers[c].data.length}if(e.attributes=l.attributes,l.indexBuffer){e.indexBuffer=e.buffers[l.buffers.indexOf(l.indexBuffer)],e.indexBuffer.type=Tr.ELEMENT_ARRAY_BUFFER;let h=0,c=0,f=0,d=0;for(let m=0;m<l.buffers.length;m++)if(l.buffers[m]!==l.indexBuffer){d=m;break}for(const m in l.attributes){const g=l.attributes[m];(g.buffer|0)===d&&(c+=g.size*dp[g.type]/4)}for(let m=0;m<t.length;m++){const g=t[m].indexBuffer.data;for(let y=0;y<g.length;y++)e.indexBuffer.data[y+f]+=h;h+=t[m].buffers[d].data.length/c,f+=g.length}}return e}}class Og extends ln{constructor(t=!1){super(),this._buffer=new ee(null,t,!1),this._indexBuffer=new ee(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,st.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,st.FLOAT).addAttribute("aColor",this._buffer,4,!0,st.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,st.FLOAT).addIndex(this._indexBuffer)}}const oa=Math.PI*2,tR=180/Math.PI,eR=Math.PI/180;var ge=(r=>(r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC",r))(ge||{});class At{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new At(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const So=[new At,new At,new At,new At];class Et{constructor(t=0,e=0,n=0,i=0){this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(i),this.type=ge.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Et(0,0,0,0)}clone(){return new Et(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const U=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=U)return!1;const J=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>J}const n=this.left,i=this.right,o=this.top,l=this.bottom;if(i<=n||l<=o)return!1;const h=So[0].set(t.left,t.top),c=So[1].set(t.left,t.bottom),f=So[2].set(t.right,t.top),d=So[3].set(t.right,t.bottom);if(f.x<=h.x||c.y<=h.y)return!1;const m=Math.sign(e.a*e.d-e.b*e.c);if(m===0||(e.apply(h,h),e.apply(c,c),e.apply(f,f),e.apply(d,d),Math.max(h.x,c.x,f.x,d.x)<=n||Math.min(h.x,c.x,f.x,d.x)>=i||Math.max(h.y,c.y,f.y,d.y)<=o||Math.min(h.y,c.y,f.y,d.y)>=l))return!1;const g=m*(c.y-h.y),y=m*(h.x-c.x),v=g*n+y*o,T=g*i+y*o,E=g*n+y*l,I=g*i+y*l;if(Math.max(v,T,E,I)<=g*h.x+y*h.y||Math.min(v,T,E,I)>=g*d.x+y*d.y)return!1;const P=m*(h.y-f.y),w=m*(f.x-h.x),R=P*n+w*o,O=P*i+w*o,W=P*n+w*l,k=P*i+w*l;return!(Math.max(R,O,W,k)<=P*h.x+w*h.y||Math.min(R,O,W,k)>=P*d.x+w*d.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),o=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=i,this.height=Math.max(o-i,0),this}ceil(t=1,e=.001){const n=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=i-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),o=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=i,this.height=o-i,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Du{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.radius=n,this.type=ge.CIRC}clone(){return new Du(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-t,o=this.y-e;return i*=i,o*=o,i+o<=n}getBounds(){return new Et(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Bu{constructor(t=0,e=0,n=0,i=0){this.x=t,this.y=e,this.width=n,this.height=i,this.type=ge.ELIP}clone(){return new Bu(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let n=(t-this.x)/this.width,i=(e-this.y)/this.height;return n*=n,i*=i,n+i<=1}getBounds(){return new Et(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Ti{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const n=[];for(let i=0,o=e.length;i<o;i++)n.push(e[i].x,e[i].y);e=n}this.points=e,this.type=ge.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new Ti(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let n=!1;const i=this.points.length/2;for(let o=0,l=i-1;o<i;l=o++){const h=this.points[o*2],c=this.points[o*2+1],f=this.points[l*2],d=this.points[l*2+1];c>e!=d>e&&t<(f-h)*((e-c)/(d-c))+h&&(n=!n)}return n}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}}class Ou{constructor(t=0,e=0,n=0,i=0,o=20){this.x=t,this.y=e,this.width=n,this.height=i,this.radius=o,this.type=ge.RREC}clone(){return new Ou(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;let i=t-(this.x+n),o=e-(this.y+n);const l=n*n;if(i*i+o*o<=l||(i=t-(this.x+this.width-n),i*i+o*o<=l)||(o=e-(this.y+this.height-n),i*i+o*o<=l)||(i=t-(this.x+n),i*i+o*o<=l))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class $t{constructor(t=1,e=0,n=0,i=1,o=0,l=0){this.array=null,this.a=t,this.b=e,this.c=n,this.d=i,this.tx=o,this.ty=l}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,n,i,o,l){return this.a=t,this.b=e,this.c=n,this.d=i,this.tx=o,this.ty=l,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(t,e){e=e||new At;const n=t.x,i=t.y;return e.x=this.a*n+this.c*i+this.tx,e.y=this.b*n+this.d*i+this.ty,e}applyInverse(t,e){e=e||new At;const n=1/(this.a*this.d+this.c*-this.b),i=t.x,o=t.y;return e.x=this.d*n*i+-this.c*n*o+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*o+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=this.a,o=this.c,l=this.tx;return this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=o*e-this.d*n,this.d=o*n+this.d*e,this.tx=l*e-this.ty*n,this.ty=l*n+this.ty*e,this}append(t){const e=this.a,n=this.b,i=this.c,o=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*n+t.b*o,this.c=t.c*e+t.d*i,this.d=t.c*n+t.d*o,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*n+t.ty*o+this.ty,this}setTransform(t,e,n,i,o,l,h,c,f){return this.a=Math.cos(h+f)*o,this.b=Math.sin(h+f)*o,this.c=-Math.sin(h-c)*l,this.d=Math.cos(h-c)*l,this.tx=t-(n*this.a+i*this.c),this.ty=e-(n*this.b+i*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const n=this.a,i=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,n=this.b,i=this.c,o=this.d,l=t.pivot,h=-Math.atan2(-i,o),c=Math.atan2(n,e),f=Math.abs(h+c);return f<1e-5||Math.abs(oa-f)<1e-5?(t.rotation=c,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=h,t.skew.y=c),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(i*i+o*o),t.position.x=this.tx+(l.x*e+l.y*i),t.position.y=this.ty+(l.x*n+l.y*o),t}invert(){const t=this.a,e=this.b,n=this.c,i=this.d,o=this.tx,l=t*i-e*n;return this.a=i/l,this.b=-e/l,this.c=-n/l,this.d=t/l,this.tx=(n*this.ty-i*o)/l,this.ty=-(t*this.ty-e*o)/l,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new $t;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new $t}static get TEMP_MATRIX(){return new $t}}const An=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Sn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Cn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],In=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Kh=[],Fg=[],Co=Math.sign;function rR(){for(let r=0;r<16;r++){const t=[];Kh.push(t);for(let e=0;e<16;e++){const n=Co(An[r]*An[e]+Cn[r]*Sn[e]),i=Co(Sn[r]*An[e]+In[r]*Sn[e]),o=Co(An[r]*Cn[e]+Cn[r]*In[e]),l=Co(Sn[r]*Cn[e]+In[r]*In[e]);for(let h=0;h<16;h++)if(An[h]===n&&Sn[h]===i&&Cn[h]===o&&In[h]===l){t.push(h);break}}}for(let r=0;r<16;r++){const t=new $t;t.set(An[r],Sn[r],Cn[r],In[r],0,0),Fg.push(t)}}rR();const Xt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>An[r],uY:r=>Sn[r],vX:r=>Cn[r],vY:r=>In[r],inv:r=>r&8?r&15:-r&7,add:(r,t)=>Kh[r][t],sub:(r,t)=>Kh[r][Xt.inv(t)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,t)=>Math.abs(r)*2<=Math.abs(t)?t>=0?Xt.S:Xt.N:Math.abs(t)*2<=Math.abs(r)?r>0?Xt.E:Xt.W:t>0?r>0?Xt.SE:Xt.SW:r>0?Xt.NE:Xt.NW,matrixAppendRotationInv:(r,t,e=0,n=0)=>{const i=Fg[Xt.inv(t)];i.tx=e,i.ty=n,r.append(i)}};class sn{constructor(t,e,n=0,i=0){this._x=n,this._y=i,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new sn(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const Lg=class{constructor(){this.worldTransform=new $t,this.localTransform=new $t,this.position=new sn(this.onChange,this,0,0),this.scale=new sn(this.onChange,this,1,1),this.pivot=new sn(this.onChange,this,0,0),this.skew=new sn(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const r=this.localTransform;this._localID!==this._currentLocalID&&(r.a=this._cx*this.scale.x,r.b=this._sx*this.scale.x,r.c=this._cy*this.scale.y,r.d=this._sy*this.scale.y,r.tx=this.position.x-(this.pivot.x*r.a+this.pivot.y*r.c),r.ty=this.position.y-(this.pivot.x*r.b+this.pivot.y*r.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(r){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==r._worldID){const e=r.worldTransform,n=this.worldTransform;n.a=t.a*e.a+t.b*e.c,n.b=t.a*e.b+t.b*e.d,n.c=t.c*e.a+t.d*e.c,n.d=t.c*e.b+t.d*e.d,n.tx=t.tx*e.a+t.ty*e.c+e.tx,n.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=r._worldID,this._worldID++}}setFromMatrix(r){r.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(r){this._rotation!==r&&(this._rotation=r,this.updateSkew())}};let Fu=Lg;Fu.IDENTITY=new Lg;var nR=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,iR=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function pp(r,t,e){const n=r.createShader(t);return r.shaderSource(n,e),r.compileShader(n),n}function ph(r){const t=new Array(r);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Ng(r,t){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return ph(2*t);case"bvec3":return ph(3*t);case"bvec4":return ph(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Ai=[{test:r=>r.type==="float"&&r.size===1&&!r.isArray,code:r=>`
            if(uv["${r}"] !== ud["${r}"].value)
            {
                ud["${r}"].value = uv["${r}"]
                gl.uniform1f(ud["${r}"].location, uv["${r}"])
            }
            `},{test:(r,t)=>(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray&&(t==null||t.castToBaseTexture!==void 0),code:r=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${r}"], t);

            if(ud["${r}"].value !== t)
            {
                ud["${r}"].value = t;
                gl.uniform1i(ud["${r}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(r,t)=>r.type==="mat3"&&r.size===1&&!r.isArray&&t.a!==void 0,code:r=>`
            gl.uniformMatrix3fv(ud["${r}"].location, false, uv["${r}"].toArray(true));
            `,codeUbo:r=>`
                var ${r}_matrix = uv.${r}.toArray(true);

                data[offset] = ${r}_matrix[0];
                data[offset+1] = ${r}_matrix[1];
                data[offset+2] = ${r}_matrix[2];
        
                data[offset + 4] = ${r}_matrix[3];
                data[offset + 5] = ${r}_matrix[4];
                data[offset + 6] = ${r}_matrix[5];
        
                data[offset + 8] = ${r}_matrix[6];
                data[offset + 9] = ${r}_matrix[7];
                data[offset + 10] = ${r}_matrix[8];
            `},{test:(r,t)=>r.type==="vec2"&&r.size===1&&!r.isArray&&t.x!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${r}"].location, v.x, v.y);
                }`,codeUbo:r=>`
                v = uv.${r};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:r=>r.type==="vec2"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${r}"].location, v[0], v[1]);
                }
            `},{test:(r,t)=>r.type==="vec4"&&r.size===1&&!r.isArray&&t.width!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${r}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:r=>r.type==="vec4"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${r}"].location, v[0], v[1], v[2], v[3])
                }`}],sR={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},oR={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function aR(r,t){var n;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in r.uniforms){const o=t[i];if(!o){(n=r.uniforms[i])!=null&&n.group&&(r.uniforms[i].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const l=r.uniforms[i];let h=!1;for(let c=0;c<Ai.length;c++)if(Ai[c].test(o,l)){e.push(Ai[c].code(i,l)),h=!0;break}if(!h){const f=(o.size===1&&!o.isArray?sR:oR)[o.type].replace("location",`ud["${i}"].location`);e.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${f};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const Ug={};let li=Ug;function lR(){if(li===Ug||li!=null&&li.isContextLost()){const r=Z.ADAPTER.createCanvas();let t;Z.PREFER_ENV>=Wn.WEBGL2&&(t=r.getContext("webgl2",{})),t||(t=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),li=t}return li}let Io;function hR(){if(!Io){Io=je.MEDIUM;const r=lR();r&&r.getShaderPrecisionFormat&&(Io=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision?je.HIGH:je.MEDIUM)}return Io}function gp(r,t){const e=r.getShaderSource(t).split(`
`).map((f,d)=>`${d}: ${f}`),n=r.getShaderInfoLog(t),i=n.split(`
`),o={},l=i.map(f=>parseFloat(f.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(f=>f&&!o[f]?(o[f]=!0,!0):!1),h=[""];l.forEach(f=>{e[f-1]=`%c${e[f-1]}%c`,h.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const c=e.join(`
`);h[0]=c,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...h),console.groupEnd()}function uR(r,t,e,n){r.getProgramParameter(t,r.LINK_STATUS)||(r.getShaderParameter(e,r.COMPILE_STATUS)||gp(r,e),r.getShaderParameter(n,r.COMPILE_STATUS)||gp(r,n),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(t)))}const cR={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function kg(r){return cR[r]}let Ro=null;const mp={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Gg(r,t){if(!Ro){const e=Object.keys(mp);Ro={};for(let n=0;n<e.length;++n){const i=e[n];Ro[r[i]]=mp[i]}}return Ro[t]}function _p(r,t,e){if(r.substring(0,9)!=="precision"){let n=t;return t===je.HIGH&&e!==je.HIGH&&(n=je.MEDIUM),`precision ${n} float;
${r}`}else if(e!==je.HIGH&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}let is;function fR(){if(typeof is=="boolean")return is;try{is=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{is=!1}return is}let dR=0;const Po={},fi=class{constructor(r,t,e="pixi-shader",n={}){this.extra={},this.id=dR++,this.vertexSrc=r||fi.defaultVertexSrc,this.fragmentSrc=t||fi.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=n,this.vertexSrc.substring(0,8)!=="#version"&&(e=e.replace(/\s+/g,"-"),Po[e]?(Po[e]++,e+=`-${Po[e]}`):Po[e]=1,this.vertexSrc=`#define SHADER_NAME ${e}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${e}
${this.fragmentSrc}`,this.vertexSrc=_p(this.vertexSrc,fi.defaultVertexPrecision,je.HIGH),this.fragmentSrc=_p(this.fragmentSrc,fi.defaultFragmentPrecision,hR())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return iR}static get defaultFragmentSrc(){return nR}static from(r,t,e){const n=r+t;let i=lp[n];return i||(lp[n]=i=new fi(r,t,e)),i}};let ar=fi;ar.defaultVertexPrecision=je.HIGH;ar.defaultFragmentPrecision=Hr.apple.device?je.HIGH:je.MEDIUM;let pR=0;class ur{constructor(t,e,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=pR++,this.static=!!e,this.ubo=!!n,t instanceof ee?(this.buffer=t,this.buffer.type=Tr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new ee(new Float32Array(1)),this.buffer.type=Tr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,n){if(!this.ubo)this.uniforms[t]=new ur(e,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,n){return new ur(t,e,n)}static uboFrom(t,e){return new ur(t,e??!0,!0)}}class Ar{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof ur?this.uniformGroup=e:this.uniformGroup=new ur(e):this.uniformGroup=new ur({}),this.disposeRunner=new hr("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const n in e.uniforms){const i=e.uniforms[n];if(i.group&&this.checkUniformExists(t,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,n){const i=ar.from(t,e);return new Ar(i,n)}}class gR{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const n=new Int32Array(t);for(let o=0;o<t;o++)n[o]=o;this.defaultGroupCache[t]=ur.from({uSamplers:n},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${t}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new ar(this.vertexSrc,i)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new $t,default:this.defaultGroupCache[t]};return new Ar(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let n=0;n<t;n++)n>0&&(e+=`
else `),n<t-1&&(e+=`if(vTextureId < ${n}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Zh{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function mR(){return!Hr.apple.device}function _R(r){let t=!0;const e=Z.ADAPTER.getNavigator();if(Hr.tablet||Hr.phone){if(Hr.apple.device){const n=e.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(t=!1)}if(Hr.android.device){const n=e.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(t=!1)}}return t?r:4}class ya{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var yR=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,vR=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const rr=class extends ya{constructor(r){super(r),this.setShaderGenerator(),this.geometryClass=Og,this.vertexSize=6,this.state=Wr.for2d(),this.size=rr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),r.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??_R(32),this._defaultMaxTextures}static set defaultMaxTextures(r){this._defaultMaxTextures=r}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??mR(),this._canUploadSameBuffer}static set canUploadSameBuffer(r){this._canUploadSameBuffer=r}get MAX_TEXTURES(){return St("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return vR}static get defaultFragmentTemplate(){return yR}setShaderGenerator({vertex:r=rr.defaultVertexSrc,fragment:t=rr.defaultFragmentTemplate}={}){this.shaderGenerator=new gR(r,t)}contextChange(){const r=this.renderer.gl;Z.PREFER_ENV===Wn.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),rr.defaultMaxTextures),this.maxTextures=YI(this.maxTextures,r)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:r,_textureArrayPool:t}=rr,e=this.size/4,n=Math.floor(e/this.maxTextures)+1;for(;r.length<e;)r.push(new qh);for(;t.length<n;)t.push(new Zh);for(let i=0;i<this.maxTextures;i++)this._tempBoundTextures[i]=null}onPrerender(){this._flushId=0}render(r){r._texture.valid&&(this._vertexCount+r.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=r.vertexData.length/2,this._indexCount+=r.indices.length,this._bufferedTextures[this._bufferSize]=r._texture.baseTexture,this._bufferedElements[this._bufferSize++]=r)}buildTexturesAndDrawCalls(){const{_bufferedTextures:r,maxTextures:t}=this,e=rr._textureArrayPool,n=this.renderer.batch,i=this._tempBoundTextures,o=this.renderer.textureGC.count;let l=++pt._globalBatch,h=0,c=e[0],f=0;n.copyBoundTextures(i,t);for(let d=0;d<this._bufferSize;++d){const m=r[d];r[d]=null,m._batchEnabled!==l&&(c.count>=t&&(n.boundArray(c,i,l,t),this.buildDrawCalls(c,f,d),f=d,c=e[++h],++l),m._batchEnabled=l,m.touched=o,c.elements[c.count++]=m)}c.count>0&&(n.boundArray(c,i,l,t),this.buildDrawCalls(c,f,this._bufferSize),++h,++l);for(let d=0;d<i.length;d++)i[d]=null;pt._globalBatch=l}buildDrawCalls(r,t,e){const{_bufferedElements:n,_attributeBuffer:i,_indexBuffer:o,vertexSize:l}=this,h=rr._drawCallPool;let c=this._dcIndex,f=this._aIndex,d=this._iIndex,m=h[c];m.start=this._iIndex,m.texArray=r;for(let g=t;g<e;++g){const y=n[g],v=y._texture.baseTexture,T=Ig[v.alphaMode?1:0][y.blendMode];n[g]=null,t<g&&m.blend!==T&&(m.size=d-m.start,t=g,m=h[++c],m.texArray=r,m.start=d),this.packInterleavedGeometry(y,i,o,f,d),f+=y.vertexData.length/2*l,d+=y.indices.length,m.blend=T}t<e&&(m.size=d-m.start,++c),this._dcIndex=c,this._aIndex=f,this._iIndex=d}bindAndClearTexArray(r){const t=this.renderer.texture;for(let e=0;e<r.count;e++)t.bind(r.elements[e],r.ids[e]),r.elements[e]=null;r.count=0}updateGeometry(){const{_packedGeometries:r,_attributeBuffer:t,_indexBuffer:e}=this;rr.canUploadSameBuffer?(r[this._flushId]._buffer.update(t.rawBinaryData),r[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,r[this._flushId]=new this.geometryClass),r[this._flushId]._buffer.update(t.rawBinaryData),r[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(r[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const r=this._dcIndex,{gl:t,state:e}=this.renderer,n=rr._drawCallPool;let i=null;for(let o=0;o<r;o++){const{texArray:l,type:h,size:c,start:f,blend:d}=n[o];i!==l&&(i=l,this.bindAndClearTexArray(l)),this.state.blendMode=d,e.set(this.state),t.drawElements(h,c,t.UNSIGNED_SHORT,f*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),rr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]&&this._packedGeometries[r].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(r){const t=ia(Math.ceil(r/8)),e=ap(t),n=t*8;this._aBuffers.length<=e&&(this._iBuffers.length=e+1);let i=this._aBuffers[n];return i||(this._aBuffers[n]=i=new Yh(n*this.vertexSize*4)),i}getIndexBuffer(r){const t=ia(Math.ceil(r/12)),e=ap(t),n=t*12;this._iBuffers.length<=e&&(this._iBuffers.length=e+1);let i=this._iBuffers[e];return i||(this._iBuffers[e]=i=new Uint16Array(n)),i}packInterleavedGeometry(r,t,e,n,i){const{uint32View:o,float32View:l}=t,h=n/this.vertexSize,c=r.uvs,f=r.indices,d=r.vertexData,m=r._texture.baseTexture._batchLocation,g=Math.min(r.worldAlpha,1),y=g<1&&r._texture.baseTexture.alphaMode?Mu(r._tintRGB,g):r._tintRGB+(g*255<<24);for(let v=0;v<d.length;v+=2)l[n++]=d[v],l[n++]=d[v+1],l[n++]=c[v],l[n++]=c[v+1],o[n++]=y,l[n++]=m;for(let v=0;v<f.length;v++)e[i++]=h+f[v]}};let sr=rr;sr.defaultBatchSize=4096;sr.extension={name:"batch",type:K.RendererPlugin};sr._drawCallPool=[];sr._textureArrayPool=[];it.add(sr);var xR=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,bR=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const ls=class extends Ar{constructor(r,t,e){const n=ar.from(r||ls.defaultVertexSrc,t||ls.defaultFragmentSrc);super(n,e),this.padding=0,this.resolution=ls.defaultResolution,this.multisample=ls.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Wr}apply(r,t,e,n,i){r.applyFilter(this,t,e,n)}get blendMode(){return this.state.blendMode}set blendMode(r){this.state.blendMode=r}get resolution(){return this._resolution}set resolution(r){this._resolution=r}static get defaultVertexSrc(){return bR}static get defaultFragmentSrc(){return xR}};let Te=ls;Te.defaultResolution=1;Te.defaultMultisample=ie.NONE;class Hg{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender,t.color&&(this.color=typeof t.color=="string"?Pu(t.color):t.color),this.alpha=t.alpha}get color(){return this._backgroundColor}set color(t){this._backgroundColor=t,this._backgroundColorString=Cg(t),xs(t,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(t){this._backgroundColorRgba[3]=t}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}}Hg.extension={type:[K.RendererSystem,K.CanvasRendererSystem],name:"background"};it.add(Hg);class $g{constructor(t){this.renderer=t,this.emptyRenderer=new ya(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:n}=this.renderer.texture;for(let i=e-1;i>=0;--i)t[i]=n[i]||null,t[i]&&(t[i]._batchLocation=i)}boundArray(t,e,n,i){const{elements:o,ids:l,count:h}=t;let c=0;for(let f=0;f<h;f++){const d=o[f],m=d._batchLocation;if(m>=0&&m<i&&e[m]===d){l[f]=m;continue}for(;c<i;){const g=e[c];if(g&&g._batchEnabled===n&&g._batchLocation===c){c++;continue}l[f]=c,d._batchLocation=c,e[c]=d;break}}}destroy(){this.renderer=null}}$g.extension={type:K.RendererSystem,name:"batch"};it.add($g);let yp=0;class Wg{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=yp++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,n=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:n,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=yp++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let n;if(Z.PREFER_ENV>=Wn.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Wg.extension={type:K.RendererSystem,name:"context"};it.add(Wg);class wR extends Cs{upload(t,e,n){const i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===cr.UNPACK);const o=e.realWidth,l=e.realHeight;return n.width===o&&n.height===l?i.texSubImage2D(e.target,0,0,0,o,l,e.format,n.type,this.data):(n.width=o,n.height=l,i.texImage2D(e.target,0,n.internalFormat,o,l,0,e.format,n.type,this.data)),!0}}class Jh{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new hr("disposeFramebuffer"),this.multisample=ie.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new pt(null,{scaleMode:Gr.NEAREST,resolution:1,mipmap:Sr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new pt(new wR(null,{width:this.width,height:this.height}),{scaleMode:Gr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Sr.OFF,format:X.DEPTH_COMPONENT,type:st.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const i=this.colorTextures[n],o=i.resolution;i.setSize(t/o,e/o)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(t/n,e/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Xg extends pt{constructor(t={}){if(typeof t=="number"){const e=arguments[0],n=arguments[1],i=arguments[2],o=arguments[3];t={width:e,height:n,scaleMode:i,resolution:o}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=ie.NONE),super(null,t),this.mipmap=Sr.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new Jh(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class hn extends bs{constructor(t){const e=t,n=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;super(n,i),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,n){n===void 0&&!e.startsWith("data:")?t.crossOrigin=XI(e):n!==!1&&(t.crossOrigin=typeof n=="string"?n:"anonymous")}upload(t,e,n,i){const o=t.gl,l=e.realWidth,h=e.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1&&i.buffered.length===0)return!1;return o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===cr.UNPACK),!this.noSubImage&&e.target===o.TEXTURE_2D&&n.width===l&&n.height===h?o.texSubImage2D(o.TEXTURE_2D,0,0,0,e.format,n.type,i):(n.width=l,n.height=h,o.texImage2D(e.target,0,n.internalFormat,e.format,n.type,i)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,n=t.naturalHeight||t.videoHeight||t.height;this.resize(e,n),super.update()}dispose(){this.source=null}}class zg extends hn{constructor(t,e){if(e=e||{},typeof t=="string"){const n=new Image;hn.crossOrigin(n,t,e.crossorigin),n.src=t,t=n}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??Z.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,n)=>{const i=this.source;this.url=i.src;const o=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.resize(i.width,i.height),this._load=null,this.createBitmap?e(this.process()):e(this))};i.complete&&i.src?o():(i.onload=o,i.onerror=l=>{n(l),this.onError.emit(l)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,n=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:n?"cors":"no-cors"}).then(i=>i.blob()).then(i=>e(i,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===cr.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,n){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,n,this.bitmap),!this.preserveBitmap){let i=!0;const o=e._glTextures;for(const l in o){const h=o[l];if(h!==n&&h.dirtyId!==e.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class Vg{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,n){const i=e.width,o=e.height;if(n){const l=t.width/2/i,h=t.height/2/o,c=t.x/i+l,f=t.y/o+h;n=Xt.add(n,Xt.NW),this.x0=c+l*Xt.uX(n),this.y0=f+h*Xt.uY(n),n=Xt.add(n,2),this.x1=c+l*Xt.uX(n),this.y1=f+h*Xt.uY(n),n=Xt.add(n,2),this.x2=c+l*Xt.uX(n),this.y2=f+h*Xt.uY(n),n=Xt.add(n,2),this.x3=c+l*Xt.uX(n),this.y3=f+h*Xt.uY(n)}else this.x0=t.x/i,this.y0=t.y/o,this.x1=(t.x+t.width)/i,this.y1=t.y/o,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/o,this.x3=t.x/i,this.y3=(t.y+t.height)/o;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const vp=new Vg;function Mo(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}class nt extends Ts{constructor(t,e,n,i,o,l){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new Et(0,0,1,1)),t instanceof nt&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=i,this.valid=!1,this._uvs=vp,this.uvMatrix=null,this.orig=n||e,this._rotate=Number(o||0),o===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=l?new At(l.x,l.y):new At(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&yr[e.url]&&nt.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,nt.removeFromCache(this),this.textureCacheIds=null}clone(){var i;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),n=new nt(this.baseTexture,!this.noFrame&&t,e,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(n._frame=t),n}updateUvs(){this._uvs===vp&&(this._uvs=new Vg),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},n=Z.STRICT_TEXTURE_CACHE){const i=typeof t=="string";let o=null;if(i)o=t;else if(t instanceof pt){if(!t.cacheId){const h=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${h}-${Gn()}`,pt.addToCache(t,t.cacheId)}o=t.cacheId}else{if(!t._pixiId){const h=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${h}_${Gn()}`}o=t._pixiId}let l=yr[o];if(i&&n&&!l)throw new Error(`The cacheId "${o}" does not exist in TextureCache.`);return!l&&!(t instanceof pt)?(e.resolution||(e.resolution=an(t)),l=new nt(new pt(t,e)),l.baseTexture.cacheId=o,pt.addToCache(l.baseTexture,o),nt.addToCache(l,o)):!l&&t instanceof pt&&(l=new nt(t),nt.addToCache(l,o)),l}static fromURL(t,e){const n=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),i=nt.from(t,Object.assign({resourceOptions:n},e),!1),o=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):o.load().then(()=>Promise.resolve(i))}static fromBuffer(t,e,n,i){return new nt(pt.fromBuffer(t,e,n,i))}static fromLoader(t,e,n,i){const o=new pt(t,Object.assign({scaleMode:Z.SCALE_MODE,resolution:an(e)},i)),{resource:l}=o;l instanceof zg&&(l.url=e);const h=new nt(o);return n||(n=e),pt.addToCache(h.baseTexture,n),nt.addToCache(h,n),n!==e&&(pt.addToCache(h.baseTexture,e),nt.addToCache(h,e)),h.baseTexture.valid?Promise.resolve(h):new Promise(c=>{h.baseTexture.once("loaded",()=>c(h))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),yr[e]&&yr[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),yr[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=yr[t];if(e){const n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete yr[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)yr[t.textureCacheIds[e]]===t&&delete yr[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:n,width:i,height:o}=t,l=e+i>this.baseTexture.width,h=n+o>this.baseTexture.height;if(l||h){const c=l&&h?"and":"or",f=`X: ${e} + ${i} = ${e+i} > ${this.baseTexture.width}`,d=`Y: ${n} + ${o} = ${n+o} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${f} ${c} ${d}`)}this.valid=i&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return nt._EMPTY||(nt._EMPTY=new nt(new pt),Mo(nt._EMPTY),Mo(nt._EMPTY.baseTexture)),nt._EMPTY}static get WHITE(){if(!nt._WHITE){const t=Z.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),nt._WHITE=new nt(pt.from(t)),Mo(nt._WHITE),Mo(nt._WHITE.baseTexture)}return nt._WHITE}}class un extends nt{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,n=!0){const i=this.baseTexture.resolution,o=Math.round(t*i)/i,l=Math.round(e*i)/i;this.valid=o>0&&l>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=l,n&&this.baseTexture.resize(o,l),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new un(new Xg(t))}}class Yg{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,n=ie.NONE){const i=new Xg(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new un(i)}getOptimalTexture(t,e,n=1,i=ie.NONE){let o;t=Math.ceil(t*n-1e-6),e=Math.ceil(e*n-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=ia(t),e=ia(e),o=((t&65535)<<16|e&65535)>>>0,i>1&&(o+=i*4294967296)):o=i>1?-i:-1,this.texturePool[o]||(this.texturePool[o]=[]);let l=this.texturePool[o].pop();return l||(l=this.createTexture(t,e,i)),l.filterPoolKey=o,l.setResolution(n),l}getFilterTexture(t,e,n){const i=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||ie.NONE);return i.filterFrame=t.filterFrame,i}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const n=this.texturePool[e];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const n=this.texturePool[e];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Yg.SCREEN_KEY=-1;class ER extends ln{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class jg extends ln{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new ee(this.vertices),this.uvBuffer=new ee(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+e.width/t.width,this.uvs[3]=i,this.uvs[4]=n+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=n,this.uvs[7]=i+e.height/t.height,n=e.x,i=e.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+e.width,this.vertices[3]=i,this.vertices[4]=n+e.width,this.vertices[5]=i+e.height,this.vertices[6]=n,this.vertices[7]=i+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class TR{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=ie.NONE,this.sourceFrame=new Et,this.destinationFrame=new Et,this.bindingSourceFrame=new Et,this.bindingDestinationFrame=new Et,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Do=[new At,new At,new At,new At],gh=new $t;class qg{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Yg,this.statePool=[],this.quad=new ER,this.quadUv=new jg,this.tempRect=new Et,this.activeState={},this.globalUniforms=new ur({outputFrame:new Et,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const n=this.renderer,i=this.defaultFilterStack,o=this.statePool.pop()||new TR,l=this.renderer.renderTexture;let h=e[0].resolution,c=e[0].multisample,f=e[0].padding,d=e[0].autoFit,m=e[0].legacy??!0;for(let v=1;v<e.length;v++){const T=e[v];h=Math.min(h,T.resolution),c=Math.min(c,T.multisample),f=this.useMaxPadding?Math.max(f,T.padding):f+T.padding,d=d&&T.autoFit,m=m||(T.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=l.current),i.push(o),o.resolution=h,o.multisample=c,o.legacy=m,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(f);const g=this.tempRect.copyFrom(l.sourceFrame);n.projection.transform&&this.transformAABB(gh.copyFrom(n.projection.transform).invert(),g),d?(o.sourceFrame.fit(g),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(g)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,l.current?l.current.resolution:n.resolution,l.sourceFrame,l.destinationFrame,n.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,h,c),o.filters=e,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;const y=this.tempRect;y.x=0,y.y=0,y.width=o.sourceFrame.width,y.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(l.sourceFrame),o.bindingDestinationFrame.copyFrom(l.destinationFrame),o.transform=n.projection.transform,n.projection.transform=null,l.bind(o.renderTexture,o.sourceFrame,y),n.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;const i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;const o=i.inputSize,l=i.inputPixel,h=i.inputClamp;if(o[0]=e.destinationFrame.width,o[1]=e.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],l[0]=Math.round(o[0]*e.resolution),l[1]=Math.round(o[1]*e.resolution),l[2]=1/l[0],l[3]=1/l[1],h[0]=.5*l[2],h[1]=.5*l[3],h[2]=e.sourceFrame.width*o[2]-.5*l[2],h[3]=e.sourceFrame.height*o[3]-.5*l[3],e.legacy){const f=i.filterArea;f[0]=e.destinationFrame.width,f[1]=e.destinationFrame.height,f[2]=e.sourceFrame.x,f[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const c=t[t.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,e.renderTexture,c.renderTexture,br.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let f=e.renderTexture,d=this.getOptimalFilterTexture(f.width,f.height,e.resolution);d.filterFrame=f.filterFrame;let m=0;for(m=0;m<n.length-1;++m){m===1&&e.multisample>1&&(d=this.getOptimalFilterTexture(f.width,f.height,e.resolution),d.filterFrame=f.filterFrame),n[m].apply(this,f,d,br.CLEAR,e);const g=f;f=d,d=g}n[m].apply(this,f,c.renderTexture,br.BLEND,e),m>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(f),this.returnFilterTexture(d)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=br.CLEAR){const{renderTexture:n,state:i}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const l=this.tempRect;l.x=0,l.y=0,l.width=t.filterFrame.width,l.height=t.filterFrame.height,n.bind(t,t.filterFrame,l)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const o=i.stateId&1||this.forceClear;(e===br.CLEAR||e===br.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,n,i){const o=this.renderer;o.state.set(t.state),this.bindAndClear(n,i),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,o.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(Er.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(Er.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:n,destinationFrame:i}=this.activeState,{orig:o}=e._texture,l=t.set(i.width,0,0,i.height,n.x,n.y),h=e.worldTransform.copyTo($t.TEMP_MATRIX);return h.invert(),l.prepend(h),l.scale(1/o.width,1/o.height),l.translate(e.anchor.x,e.anchor.y),l}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,n=1,i=ie.NONE){return this.texturePool.getOptimalTexture(t,e,n,i)}getFilterTexture(t,e,n){if(typeof t=="number"){const o=t;t=e,e=o}t=t||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||ie.NONE);return i.filterFrame=t.filterFrame,i}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const n=Do[0],i=Do[1],o=Do[2],l=Do[3];n.set(e.left,e.top),i.set(e.left,e.bottom),o.set(e.right,e.top),l.set(e.right,e.bottom),t.apply(n,n),t.apply(i,i),t.apply(o,o),t.apply(l,l);const h=Math.min(n.x,i.x,o.x,l.x),c=Math.min(n.y,i.y,o.y,l.y),f=Math.max(n.x,i.x,o.x,l.x),d=Math.max(n.y,i.y,o.y,l.y);e.x=h,e.y=c,e.width=f-h,e.height=d-c}roundFrame(t,e,n,i,o){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(o){const{a:l,b:h,c,d:f}=o;if((Math.abs(h)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(l)>1e-4||Math.abs(f)>1e-4))return}o=o?gh.copyFrom(o):gh.identity(),o.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(o,t),t.ceil(e),this.transformAABB(o.invert(),t)}}}qg.extension={type:K.RendererSystem,name:"filter"};it.add(qg);class AR{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=ie.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const SR=new Et;class Kg{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Jh(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Et,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;Z.PREFER_ENV===Wn.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=i=>e.drawBuffersWEBGL(i):(this.hasMRT=!1,t.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,n=0){const{gl:i}=this;if(t){const o=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,o.framebuffer)),o.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,o.mipLevel=n),o.dirtyId!==t.dirtyId&&(o.dirtyId=t.dirtyId,o.dirtyFormat!==t.dirtyFormat?(o.dirtyFormat=t.dirtyFormat,o.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):o.dirtySize!==t.dirtySize&&(o.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let l=0;l<t.colorTextures.length;l++){const h=t.colorTextures[l];this.renderer.texture.unbind(h.parentTextureArray||h)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const l=e.width>>n,h=e.height>>n,c=l/e.width;this.setViewport(e.x*c,e.y*c,l,h)}else{const l=t.width>>n,h=t.height>>n;this.setViewport(0,0,l,h)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,n,i){const o=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),i=Math.round(i),(o.width!==n||o.height!==i||o.x!==t||o.y!==e)&&(o.x=t,o.y=e,o.width=n,o.height=i,this.gl.viewport(t,e,n,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,n,i,o=Ph.COLOR|Ph.DEPTH){const{gl:l}=this;l.clearColor(t,e,n,i),l.clear(o)}initFramebuffer(t){const{gl:e}=this,n=new AR(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n}resizeFramebuffer(t){const{gl:e}=this,n=t.glFramebuffers[this.CONTEXT_UID];n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const i=t.colorTextures;let o=i.length;e.drawBuffers||(o=Math.min(o,1));for(let l=0;l<o;l++){const h=i[l],c=h.parentTextureArray||h;this.renderer.texture.bind(c,0),l===0&&n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:n}=this,i=t.glFramebuffers[this.CONTEXT_UID],o=t.colorTextures;let l=o.length;n.drawBuffers||(l=Math.min(l,1)),i.multisample>1&&this.canMultisampleFramebuffer(t)?i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer():i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const h=[];for(let c=0;c<l;c++){const f=o[c],d=f.parentTextureArray||f;this.renderer.texture.bind(d,0),c===0&&i.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,d._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+c,f.target,d._glTextures[this.CONTEXT_UID].texture,e),h.push(n.COLOR_ATTACHMENT0+c))}if(h.length>1&&n.drawBuffers(h),t.depthTexture&&this.writeDepthTexture){const f=t.depthTexture;this.renderer.texture.bind(f,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,f._glTextures[this.CONTEXT_UID].texture,e)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(i.stencil=i.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.DEPTH24_STENCIL8,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,i.stencil)):i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let n=ie.NONE;if(t<=1||e===null)return n;for(let i=0;i<e.length;i++)if(e[i]<=t){n=e[i];break}return n===1&&(n=ie.NONE),n}blit(t,e,n){const{current:i,renderer:o,gl:l,CONTEXT_UID:h}=this;if(o.context.webGLVersion!==2||!i)return;const c=i.glFramebuffers[h];if(!c)return;if(!t){if(!c.msaaBuffer)return;const d=i.colorTextures[0];if(!d)return;c.blitFramebuffer||(c.blitFramebuffer=new Jh(i.width,i.height),c.blitFramebuffer.addColorTexture(0,d)),t=c.blitFramebuffer,t.colorTextures[0]!==d&&(t.colorTextures[0]=d,t.dirtyId++,t.dirtyFormat++),(t.width!==i.width||t.height!==i.height)&&(t.width=i.width,t.height=i.height,t.dirtyId++,t.dirtySize++)}e||(e=SR,e.width=i.width,e.height=i.height),n||(n=e);const f=e.width===n.width&&e.height===n.height;this.bind(t),l.bindFramebuffer(l.READ_FRAMEBUFFER,c.framebuffer),l.blitFramebuffer(e.left,e.top,e.right,e.bottom,n.left,n.top,n.right,n.bottom,l.COLOR_BUFFER_BIT,f?l.NEAREST:l.LINEAR)}disposeFramebuffer(t,e){const n=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!n)return;delete t.glFramebuffers[this.CONTEXT_UID];const o=this.managedFramebuffers.indexOf(t);o>=0&&this.managedFramebuffers.splice(o,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&n.blitFramebuffer.dispose()}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const n=t.width,i=t.height,o=this.gl,l=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,l),e.msaaBuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,e.multisample,o.DEPTH24_STENCIL8,n,i):o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,n,i),e.stencil=l,o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,l)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Et}destroy(){this.renderer=null}}Kg.extension={type:K.RendererSystem,name:"framebuffer"};it.add(Kg);const mh={5126:4,5123:2,5121:1};class Zg{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;Z.PREFER_ENV===Wn.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=()=>n.createVertexArrayOES(),t.bindVertexArray=i=>n.bindVertexArrayOES(i),t.deleteVertexArray=i=>n.deleteVertexArrayOES(i)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const n=t.getExtension("ANGLE_instanced_arrays");n?(t.vertexAttribDivisor=(i,o)=>n.vertexAttribDivisorANGLE(i,o),t.drawElementsInstanced=(i,o,l,h,c)=>n.drawElementsInstancedANGLE(i,o,l,h,c),t.drawArraysInstanced=(i,o,l,h)=>n.drawArraysInstancedANGLE(i,o,l,h)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:n}=this;let i=t.glVertexArrayObjects[this.CONTEXT_UID],o=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},o=!0);const l=i[e.program.id]||this.initGeometryVao(t,e,o);this._activeGeometry=t,this._activeVao!==l&&(this._activeVao=l,this.hasVao?n.bindVertexArray(l):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let n=0;n<t.buffers.length;n++){const i=t.buffers[n];e.update(i)}}checkCompatibility(t,e){const n=t.attributes,i=e.attributeData;for(const o in i)if(!n[o])throw new Error(`shader and geometry incompatible, geometry missing the "${o}" attribute`)}getSignature(t,e){const n=t.attributes,i=e.attributeData,o=["g",t.id];for(const l in n)i[l]&&o.push(l,i[l].location);return o.join("-")}initGeometryVao(t,e,n=!0){const i=this.gl,o=this.CONTEXT_UID,l=this.renderer.buffer,h=e.program;h.glPrograms[o]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,h);const c=this.getSignature(t,h),f=t.glVertexArrayObjects[this.CONTEXT_UID];let d=f[c];if(d)return f[h.id]=d,d;const m=t.buffers,g=t.attributes,y={},v={};for(const T in m)y[T]=0,v[T]=0;for(const T in g)!g[T].size&&h.attributeData[T]?g[T].size=h.attributeData[T].size:g[T].size||console.warn(`PIXI Geometry attribute '${T}' size cannot be determined (likely the bound shader does not have the attribute)`),y[g[T].buffer]+=g[T].size*mh[g[T].type];for(const T in g){const E=g[T],I=E.size;E.stride===void 0&&(y[E.buffer]===I*mh[E.type]?E.stride=0:E.stride=y[E.buffer]),E.start===void 0&&(E.start=v[E.buffer],v[E.buffer]+=I*mh[E.type])}d=i.createVertexArray(),i.bindVertexArray(d);for(let T=0;T<m.length;T++){const E=m[T];l.bind(E),n&&E._glBuffers[o].refCount++}return this.activateVao(t,h),f[h.id]=d,f[c]=d,i.bindVertexArray(null),l.unbind(Tr.ARRAY_BUFFER),d}disposeGeometry(t,e){var h;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const n=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,o=t.buffers,l=(h=this.renderer)==null?void 0:h.buffer;if(t.disposeRunner.remove(this),!!n){if(l)for(let c=0;c<o.length;c++){const f=o[c]._glBuffers[this.CONTEXT_UID];f&&(f.refCount--,f.refCount===0&&!e&&l.dispose(o[c],e))}if(!e){for(const c in n)if(c[0]==="g"){const f=n[c];this._activeVao===f&&this.unbind(),i.deleteVertexArray(f)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)}activateVao(t,e){const n=this.gl,i=this.CONTEXT_UID,o=this.renderer.buffer,l=t.buffers,h=t.attributes;t.indexBuffer&&o.bind(t.indexBuffer);let c=null;for(const f in h){const d=h[f],m=l[d.buffer],g=m._glBuffers[i];if(e.attributeData[f]){c!==g&&(o.bind(m),c=g);const y=e.attributeData[f].location;if(n.enableVertexAttribArray(y),n.vertexAttribPointer(y,d.size,d.type||n.FLOAT,d.normalized,d.stride,d.start),d.instance)if(this.hasInstance)n.vertexAttribDivisor(y,d.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,n,i){const{gl:o}=this,l=this._activeGeometry;if(l.indexBuffer){const h=l.indexBuffer.data.BYTES_PER_ELEMENT,c=h===2?o.UNSIGNED_SHORT:o.UNSIGNED_INT;h===2||h===4&&this.canUseUInt32ElementIndex?l.instanced?o.drawElementsInstanced(t,e||l.indexBuffer.data.length,c,(n||0)*h,i||1):o.drawElements(t,e||l.indexBuffer.data.length,c,(n||0)*h):console.warn("unsupported index buffer type: uint32")}else l.instanced?o.drawArraysInstanced(t,n,e||l.getSize(),i||1):o.drawArrays(t,n,e||l.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Zg.extension={type:K.RendererSystem,name:"geometry"};it.add(Zg);const xp=new $t;class Jg{constructor(t,e){this._texture=t,this.mapCoord=new $t,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const n=this.mapCoord;for(let i=0;i<t.length;i+=2){const o=t[i],l=t[i+1];e[i]=o*n.a+l*n.c+n.tx,e[i+1]=o*n.b+l*n.d+n.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const i=e.orig,o=e.trim;o&&(xp.set(i.width/o.width,0,0,i.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(xp));const l=e.baseTexture,h=this.uClampFrame,c=this.clampMargin/l.resolution,f=this.clampOffset;return h[0]=(e._frame.x+c+f)/l.width,h[1]=(e._frame.y+c+f)/l.height,h[2]=(e._frame.x+e._frame.width-c+f)/l.width,h[3]=(e._frame.y+e._frame.height-c+f)/l.height,this.uClampOffset[0]=f/l.realWidth,this.uClampOffset[1]=f/l.realHeight,this.isSimple=e._frame.width===l.width&&e._frame.height===l.height&&e.rotate===0,!0}}var CR=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,IR=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class RR extends Te{constructor(t,e,n){let i=null;typeof t!="string"&&e===void 0&&n===void 0&&(i=t,t=void 0,e=void 0,n=void 0),super(t||IR,e||CR,n),this.maskSprite=i,this.maskMatrix=new $t}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,n,i){const o=this._maskSprite,l=o._texture;l.valid&&(l.uvMatrix||(l.uvMatrix=new Jg(l,0)),l.uvMatrix.update(),this.uniforms.npmAlpha=l.baseTexture.alphaMode?0:1,this.uniforms.mask=l,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,o).prepend(l.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=l.uvMatrix.uClampFrame,t.applyFilter(this,e,n,i))}}class PR{constructor(t=null){this.type=he.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Z.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=he.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Qg{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let n=e;if(!n.isMaskData){const o=this.maskDataPool.pop()||new PR;o.pooled=!0,o.maskObject=e,n=o}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(i),n._colorMask=i?i._colorMask:15,n.autoDetect&&this.detect(n),n._target=t,n.type!==he.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case he.SCISSOR:this.renderer.scissor.push(n);break;case he.STENCIL:this.renderer.stencil.push(n);break;case he.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case he.COLOR:this.pushColorMask(n);break}n.type===he.SPRITE&&this.maskStack.push(n)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case he.SCISSOR:this.renderer.scissor.pop(e);break;case he.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case he.SPRITE:this.popSpriteMask(e);break;case he.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===he.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=he.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=he.SCISSOR:t.type=he.STENCIL:t.type=he.COLOR}pushSpriteMask(t){const{maskObject:e}=t,n=t._target;let i=t._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new RR]));const o=this.renderer,l=o.renderTexture;let h,c;if(l.current){const d=l.current;h=t.resolution||d.resolution,c=t.multisample??d.multisample}else h=t.resolution||o.resolution,c=t.multisample??o.multisample;i[0].resolution=h,i[0].multisample=c,i[0].maskSprite=e;const f=n.filterArea;n.filterArea=e.getBounds(!0),o.filter.push(n,i),n.filterArea=f,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,n=t._colorMask=e&t.colorMask;n!==e&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(t){const e=t._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==e&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}Qg.extension={type:K.RendererSystem,name:"mask"};it.add(Qg);class tm{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,n=this.getStackLength();this.maskStack=t;const i=this.getStackLength();i!==n&&(i===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const bp=new $t,wp=[],Vo=class extends tm{constructor(r){super(r),this.glConst=Z.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const r=this.maskStack[this.maskStack.length-1];return r?r._scissorCounter:0}calcScissorRect(r){if(r._scissorRectLocal)return;const t=r._scissorRect,{maskObject:e}=r,{renderer:n}=this,i=n.renderTexture,o=e.getBounds(!0,wp.pop()??new Et);this.roundFrameToPixels(o,i.current?i.current.resolution:n.resolution,i.sourceFrame,i.destinationFrame,n.projection.transform),t&&o.fit(t),r._scissorRectLocal=o}static isMatrixRotated(r){if(!r)return!1;const{a:t,b:e,c:n,d:i}=r;return(Math.abs(e)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(i)>1e-4)}testScissor(r){const{maskObject:t}=r;if(!t.isFastRect||!t.isFastRect()||Vo.isMatrixRotated(t.worldTransform)||Vo.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(r);const e=r._scissorRectLocal;return e.width>0&&e.height>0}roundFrameToPixels(r,t,e,n,i){Vo.isMatrixRotated(i)||(i=i?bp.copyFrom(i):bp.identity(),i.translate(-e.x,-e.y).scale(n.width/e.width,n.height/e.height).translate(n.x,n.y),this.renderer.filter.transformAABB(i,r),r.fit(n),r.x=Math.round(r.x*t),r.y=Math.round(r.y*t),r.width=Math.round(r.width*t),r.height=Math.round(r.height*t))}push(r){r._scissorRectLocal||this.calcScissorRect(r);const{gl:t}=this.renderer;r._scissorRect||t.enable(t.SCISSOR_TEST),r._scissorCounter++,r._scissorRect=r._scissorRectLocal,this._useCurrent()}pop(r){const{gl:t}=this.renderer;r&&wp.push(r._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const r=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=r.y:t=this.renderer.height-r.height-r.y,this.renderer.gl.scissor(r.x,t,r.width,r.height)}};let em=Vo;em.extension={type:K.RendererSystem,name:"scissor"};it.add(em);class rm extends tm{constructor(t){super(t),this.glConst=Z.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:n}=this.renderer,i=t._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++;const o=t._colorMask;o!==0&&(t._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,o!==0&&(t._colorMask=o,n.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=n?n._colorMask:15;i!==0&&(n._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,i!==0&&(n._colorMask=i,e.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}rm.extension={type:K.RendererSystem,name:"stencil"};it.add(rm);class nm{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return St("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return St("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return St("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(t){for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}nm.extension={type:[K.RendererSystem,K.CanvasRendererSystem],name:"_plugin"};it.add(nm);class im{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new $t,this.transform=null}update(t,e,n,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);const o=this.renderer;o.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,o.globalUniforms.update(),o.shader.shader&&o.shader.syncUniformGroup(o.shader.shader.uniforms.globals)}calculateProjection(t,e,n,i){const o=this.projectionMatrix,l=i?-1:1;o.identity(),o.a=1/e.width*2,o.d=l*(1/e.height*2),o.tx=-1-e.x*o.a,o.ty=-l-e.y*o.d}setTransform(t){}destroy(){this.renderer=null}}im.extension={type:K.RendererSystem,name:"projection"};it.add(im);const MR=new Fu;class sm{constructor(t){this.renderer=t,this._tempMatrix=new $t}generateTexture(t,e){const{region:n,...i}=e||{},o=n||t.getLocalBounds(null,!0);o.width===0&&(o.width=1),o.height===0&&(o.height=1);const l=un.create({width:o.width,height:o.height,...i});this._tempMatrix.tx=-o.x,this._tempMatrix.ty=-o.y;const h=t.transform;return t.transform=MR,this.renderer.render(t,{renderTexture:l,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=h,l}destroy(){}}sm.extension={type:[K.RendererSystem,K.CanvasRendererSystem],name:"textureGenerator"};it.add(sm);const En=new Et,ss=new Et;class om{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Et,this.destinationFrame=new Et,this.viewportFrame=new Et}bind(t=null,e,n){const i=this.renderer;this.current=t;let o,l,h;t?(o=t.baseTexture,h=o.resolution,e||(En.width=t.frame.width,En.height=t.frame.height,e=En),n||(ss.x=t.frame.x,ss.y=t.frame.y,ss.width=e.width,ss.height=e.height,n=ss),l=o.framebuffer):(h=i.resolution,e||(En.width=i._view.screen.width,En.height=i._view.screen.height,e=En),n||(n=En,n.width=e.width,n.height=e.height));const c=this.viewportFrame;c.x=n.x*h,c.y=n.y*h,c.width=n.width*h,c.height=n.height*h,t||(c.y=i.view.height-(c.y+c.height)),c.ceil(),this.renderer.framebuffer.bind(l,c),this.renderer.projection.update(n,e,h,!l),t?this.renderer.mask.setMaskStack(o.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)}clear(t,e){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.renderer.background.colorRgba;const n=this.destinationFrame,i=this.current?this.current.baseTexture:this.renderer._view.screen,o=n.width!==i.width||n.height!==i.height;if(o){let{x:l,y:h,width:c,height:f}=this.viewportFrame;l=Math.round(l),h=Math.round(h),c=Math.round(c),f=Math.round(f),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,h,c,f)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),o&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}om.extension={type:K.RendererSystem,name:"renderTexture"};it.add(om);class DR{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function BR(r,t){const e={},n=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const o=t.getActiveAttrib(r,i);if(o.name.startsWith("gl_"))continue;const l=Gg(t,o.type),h={type:l,name:o.name,size:kg(l),location:t.getAttribLocation(r,o.name)};e[o.name]=h}return e}function OR(r,t){const e={},n=t.getProgramParameter(r,t.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const o=t.getActiveUniform(r,i),l=o.name.replace(/\[.*?\]$/,""),h=!!o.name.match(/\[.*?\]$/),c=Gg(t,o.type);e[l]={name:l,index:i,type:c,size:o.size,isArray:h,value:Ng(c,o.size)}}return e}function FR(r,t){var c;const e=pp(r,r.VERTEX_SHADER,t.vertexSrc),n=pp(r,r.FRAGMENT_SHADER,t.fragmentSrc),i=r.createProgram();r.attachShader(i,e),r.attachShader(i,n);const o=(c=t.extra)==null?void 0:c.transformFeedbackVaryings;if(o&&(typeof r.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):r.transformFeedbackVaryings(i,o.names,o.bufferMode==="separate"?r.SEPARATE_ATTRIBS:r.INTERLEAVED_ATTRIBS)),r.linkProgram(i),r.getProgramParameter(i,r.LINK_STATUS)||uR(r,i,e,n),t.attributeData=BR(i,r),t.uniformData=OR(i,r),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const f=Object.keys(t.attributeData);f.sort((d,m)=>d>m?1:-1);for(let d=0;d<f.length;d++)t.attributeData[f[d]].location=d,r.bindAttribLocation(i,d,f[d]);r.linkProgram(i)}r.deleteShader(e),r.deleteShader(n);const l={};for(const f in t.uniformData){const d=t.uniformData[f];l[f]={location:r.getUniformLocation(i,f),value:Ng(d.type,d.size)}}return new DR(i,l)}function LR(r,t,e,n,i){e.buffer.update(i)}const NR={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},am={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function UR(r){const t=r.map(o=>({data:o,offset:0,dataLen:0,dirty:0}));let e=0,n=0,i=0;for(let o=0;o<t.length;o++){const l=t[o];if(e=am[l.data.type],l.data.size>1&&(e=Math.max(e,16)*l.data.size),l.dataLen=e,n%e!==0&&n<16){const h=n%e%16;n+=h,i+=h}n+e>16?(i=Math.ceil(i/16)*16,l.offset=i,i+=e,n=e):(l.offset=i,n+=e,i+=e)}return i=Math.ceil(i/16)*16,{uboElements:t,size:i}}function kR(r,t){const e=[];for(const n in r)t[n]&&e.push(t[n]);return e.sort((n,i)=>n.index-i.index),e}function GR(r,t){if(!r.autoManage)return{size:0,syncFunc:LR};const e=kR(r.uniforms,t),{uboElements:n,size:i}=UR(e),o=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let l=0;l<n.length;l++){const h=n[l],c=r.uniforms[h.data.name],f=h.data.name;let d=!1;for(let m=0;m<Ai.length;m++){const g=Ai[m];if(g.codeUbo&&g.test(h.data,c)){o.push(`offset = ${h.offset/4};`,Ai[m].codeUbo(h.data.name,c)),d=!0;break}}if(!d)if(h.data.size>1){const m=kg(h.data.type),g=Math.max(am[h.data.type]/16,1),y=m/g,v=(4-y%4)%4;o.push(`
                cv = ud.${f}.value;
                v = uv.${f};
                offset = ${h.offset/4};

                t = 0;

                for(var i=0; i < ${h.data.size*g}; i++)
                {
                    for(var j = 0; j < ${y}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${v};
                }

                `)}else{const m=NR[h.data.type];o.push(`
                cv = ud.${f}.value;
                v = uv.${f};
                offset = ${h.offset/4};
                ${m};
                `)}}return o.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join(`
`))}}let HR=0;const Bo={textureCount:0,uboCount:0};class lm{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=HR++}systemCheck(){if(!fR())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const n=t.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),e||(Bo.textureCount=0,Bo.uboCount=0,this.syncUniformGroup(t.uniformGroup,Bo)),i}setUniforms(t){const e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)}syncUniformGroup(t,e){const n=this.getGlProgram();(!t.static||t.dirtyId!==n.uniformDirtyGroups[t.id])&&(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))}syncUniforms(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=aR(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const n=this.getGlProgram();if(!t.static||t.dirtyId!==0||!n.uniformGroups[t.id]){t.dirtyId=0;const i=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),i(n.uniformData,t.uniforms,this.renderer,Bo,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e])}createSyncBufferGroup(t,e,n){const{gl:i}=this.renderer;this.renderer.buffer.bind(t.buffer);const o=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(e.program,o,this.shader.uniformBindCount),this.shader.uniformBindCount++;const l=this.getSignature(t,this.shader.program.uniformData,"ubo");let h=this._uboCache[l];if(h||(h=this._uboCache[l]=GR(t,this.shader.program.uniformData)),t.autoManage){const c=new Float32Array(h.size/4);t.buffer.update(c)}return e.uniformGroups[t.id]=h.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,n){const i=t.uniforms,o=[`${n}-`];for(const l in i)o.push(l),e[l]&&o.push(e[l].type);return o.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,n=t.program,i=FR(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}lm.extension={type:K.RendererSystem,name:"shader"};it.add(lm);class hm{constructor(t){this.renderer=t}run(t){const e=this.renderer;e.emitWithCustomOptions(e.runners.init,t),t.hello&&console.log(`PixiJS 7.1.0 - ${e.rendererLogId} - https://pixijs.com`),e.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}}hm.extension={type:[K.RendererSystem,K.CanvasRendererSystem],name:"startup"};it.add(hm);function $R(r,t=[]){return t[ut.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.ADD]=[r.ONE,r.ONE],t[ut.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.NONE]=[0,0],t[ut.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],t[ut.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ut.SRC_IN]=[r.DST_ALPHA,r.ZERO],t[ut.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],t[ut.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[ut.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],t[ut.DST_IN]=[r.ZERO,r.SRC_ALPHA],t[ut.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],t[ut.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],t[ut.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[ut.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],t}const WR=0,XR=1,zR=2,VR=3,YR=4,jR=5,Qh=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ut.NONE,this._blendEq=!1,this.map=[],this.map[WR]=this.setBlend,this.map[XR]=this.setOffset,this.map[zR]=this.setCullFace,this.map[VR]=this.setDepthTest,this.map[YR]=this.setFrontFace,this.map[jR]=this.setDepthMask,this.checks=[],this.defaultState=new Wr,this.defaultState.blend=!0}contextChange(r){this.gl=r,this.blendModes=$R(r),this.set(this.defaultState),this.reset()}set(r){if(r=r||this.defaultState,this.stateId!==r.data){let t=this.stateId^r.data,e=0;for(;t;)t&1&&this.map[e].call(this,!!(r.data&1<<e)),t=t>>1,e++;this.stateId=r.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,r)}forceState(r){r=r||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(r.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,r);this.stateId=r.data}setBlend(r){this.updateCheck(Qh.checkBlendMode,r),this.gl[r?"enable":"disable"](this.gl.BLEND)}setOffset(r){this.updateCheck(Qh.checkPolygonOffset,r),this.gl[r?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(r){this.gl[r?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(r){this.gl.depthMask(r)}setCullFace(r){this.gl[r?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(r){this.gl.frontFace(this.gl[r?"CW":"CCW"])}setBlendMode(r){if(r===this.blendMode)return;this.blendMode=r;const t=this.blendModes[r],e=this.gl;t.length===2?e.blendFunc(t[0],t[1]):e.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,e.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD))}setPolygonOffset(r,t){this.gl.polygonOffset(r,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(r,t){const e=this.checks.indexOf(r);t&&e===-1?this.checks.push(r):!t&&e!==-1&&this.checks.splice(e,1)}static checkBlendMode(r,t){r.setBlendMode(t.blendMode)}static checkPolygonOffset(r,t){r.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let um=Qh;um.extension={type:K.RendererSystem,name:"state"};it.add(um);class qR extends Ts{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(i=>t.systems[i]),n=[...e,...Object.keys(t.systems).filter(i=>!e.includes(i))];for(const i of n)this.addSystem(t.systems[i],i)}addRunners(...t){t.forEach(e=>{this.runners[e]=new hr(e)})}addSystem(t,e){const n=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=n,this._systemsHash[e]=n;for(const i in this.runners)this.runners[i].add(n);return this}emitWithCustomOptions(t,e){const n=Object.keys(this._systemsHash);t.items.forEach(i=>{const o=n.find(l=>this._systemsHash[l]===i);i[t.name](e[o])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const Yo=class{constructor(r){this.renderer=r,this.count=0,this.checkCount=0,this.maxIdle=Yo.defaultMaxIdle,this.checkCountMax=Yo.defaultCheckCountMax,this.mode=Yo.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==bu.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const r=this.renderer.texture,t=r.managedTextures;let e=!1;for(let n=0;n<t.length;n++){const i=t[n];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(r.destroyTexture(i,!0),t[n]=null,e=!0)}if(e){let n=0;for(let i=0;i<t.length;i++)t[i]!==null&&(t[n++]=t[i]);t.length=n}}unload(r){const t=this.renderer.texture,e=r._texture;e&&!e.framebuffer&&t.destroyTexture(e);for(let n=r.children.length-1;n>=0;n--)this.unload(r.children[n])}destroy(){this.renderer=null}};let or=Yo;or.defaultMode=bu.AUTO;or.defaultMaxIdle=60*60;or.defaultCheckCountMax=60*10;or.extension={type:K.RendererSystem,name:"textureGC"};it.add(or);class _h{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=st.UNSIGNED_BYTE,this.internalFormat=X.RGBA,this.samplerType=0}}function KR(r){let t;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?t={[st.UNSIGNED_BYTE]:{[X.RGBA]:r.RGBA8,[X.RGB]:r.RGB8,[X.RG]:r.RG8,[X.RED]:r.R8,[X.RGBA_INTEGER]:r.RGBA8UI,[X.RGB_INTEGER]:r.RGB8UI,[X.RG_INTEGER]:r.RG8UI,[X.RED_INTEGER]:r.R8UI,[X.ALPHA]:r.ALPHA,[X.LUMINANCE]:r.LUMINANCE,[X.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[st.BYTE]:{[X.RGBA]:r.RGBA8_SNORM,[X.RGB]:r.RGB8_SNORM,[X.RG]:r.RG8_SNORM,[X.RED]:r.R8_SNORM,[X.RGBA_INTEGER]:r.RGBA8I,[X.RGB_INTEGER]:r.RGB8I,[X.RG_INTEGER]:r.RG8I,[X.RED_INTEGER]:r.R8I},[st.UNSIGNED_SHORT]:{[X.RGBA_INTEGER]:r.RGBA16UI,[X.RGB_INTEGER]:r.RGB16UI,[X.RG_INTEGER]:r.RG16UI,[X.RED_INTEGER]:r.R16UI,[X.DEPTH_COMPONENT]:r.DEPTH_COMPONENT16},[st.SHORT]:{[X.RGBA_INTEGER]:r.RGBA16I,[X.RGB_INTEGER]:r.RGB16I,[X.RG_INTEGER]:r.RG16I,[X.RED_INTEGER]:r.R16I},[st.UNSIGNED_INT]:{[X.RGBA_INTEGER]:r.RGBA32UI,[X.RGB_INTEGER]:r.RGB32UI,[X.RG_INTEGER]:r.RG32UI,[X.RED_INTEGER]:r.R32UI,[X.DEPTH_COMPONENT]:r.DEPTH_COMPONENT24},[st.INT]:{[X.RGBA_INTEGER]:r.RGBA32I,[X.RGB_INTEGER]:r.RGB32I,[X.RG_INTEGER]:r.RG32I,[X.RED_INTEGER]:r.R32I},[st.FLOAT]:{[X.RGBA]:r.RGBA32F,[X.RGB]:r.RGB32F,[X.RG]:r.RG32F,[X.RED]:r.R32F,[X.DEPTH_COMPONENT]:r.DEPTH_COMPONENT32F},[st.HALF_FLOAT]:{[X.RGBA]:r.RGBA16F,[X.RGB]:r.RGB16F,[X.RG]:r.RG16F,[X.RED]:r.R16F},[st.UNSIGNED_SHORT_5_6_5]:{[X.RGB]:r.RGB565},[st.UNSIGNED_SHORT_4_4_4_4]:{[X.RGBA]:r.RGBA4},[st.UNSIGNED_SHORT_5_5_5_1]:{[X.RGBA]:r.RGB5_A1},[st.UNSIGNED_INT_2_10_10_10_REV]:{[X.RGBA]:r.RGB10_A2,[X.RGBA_INTEGER]:r.RGB10_A2UI},[st.UNSIGNED_INT_10F_11F_11F_REV]:{[X.RGB]:r.R11F_G11F_B10F},[st.UNSIGNED_INT_5_9_9_9_REV]:{[X.RGB]:r.RGB9_E5},[st.UNSIGNED_INT_24_8]:{[X.DEPTH_STENCIL]:r.DEPTH24_STENCIL8},[st.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[X.DEPTH_STENCIL]:r.DEPTH32F_STENCIL8}}:t={[st.UNSIGNED_BYTE]:{[X.RGBA]:r.RGBA,[X.RGB]:r.RGB,[X.ALPHA]:r.ALPHA,[X.LUMINANCE]:r.LUMINANCE,[X.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[st.UNSIGNED_SHORT_5_6_5]:{[X.RGB]:r.RGB},[st.UNSIGNED_SHORT_4_4_4_4]:{[X.RGBA]:r.RGBA},[st.UNSIGNED_SHORT_5_5_5_1]:{[X.RGBA]:r.RGBA}},t}class cm{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new pt,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=KR(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};const n=new _h(t.createTexture());t.bindTexture(t.TEXTURE_2D,n.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=n,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new _h(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(t,e=0){const{gl:n}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)):i.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<n.length;i++)n[i]===t&&(this.currentLocation!==i&&(e.activeTexture(e.TEXTURE0+i),this.currentLocation=i),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[i]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:n,CONTEXT_UID:i}=this;if(n)for(let o=t-1;o>=0;--o){const l=e[o];l&&l._glTextures[i].samplerType!==Mh.FLOAT&&this.renderer.texture.unbind(l)}}initTexture(t){const e=new _h(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var n;e.internalFormat=((n=this.internalFormats[t.type])==null?void 0:n[t.format])??t.format,this.webGLVersion===2&&t.type===st.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var i;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const n=this.renderer;if(this.initTextureType(t,e),(i=t.resource)!=null&&i.upload(n,t,e))e.samplerType!==Mh.FLOAT&&(this.hasIntegerTextures=!0);else{const o=t.realWidth,l=t.realHeight,h=n.gl;(e.width!==o||e.height!==l||e.dirtyId<0)&&(e.width=o,e.height=l,h.texImage2D(t.target,0,e.internalFormat,o,l,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:n}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const i=this.managedTextures.indexOf(t);i!==-1&&Ei(this.managedTextures,i,1)}}updateTextureStyle(t){var n;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===Sr.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=on.CLAMP:e.wrapMode=t.wrapMode,(n=t.resource)!=null&&n.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const n=this.gl;if(e.mipmap&&t.mipmap!==Sr.ON_MANUAL&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Gr.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===Gr.LINEAR){const o=Math.min(t.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Gr.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===Gr.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}cm.extension={type:K.RendererSystem,name:"texture"};it.add(cm);class fm{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,i=t._glTransformFeedbacks[n]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:n,renderer:i}=this;e&&i.shader.bind(e),n.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:n,CONTEXT_UID:i}=this,o=e.createTransformFeedback();t._glTransformFeedbacks[i]=o,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,o);for(let l=0;l<t.buffers.length;l++){const h=t.buffers[l];h&&(n.buffer.update(h),h._glBuffers[i].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,l,h._glBuffers[i].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),o}disposeTransformFeedback(t,e){const n=t._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this);const o=this.renderer.buffer;if(o)for(let l=0;l<t.buffers.length;l++){const h=t.buffers[l];if(!h)continue;const c=h._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!e&&o.dispose(h,e))}n&&(e||i.deleteTransformFeedback(n),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}fm.extension={type:K.RendererSystem,name:"transformFeedback"};it.add(fm);class dm{constructor(t){this.renderer=t}init(t){this.screen=new Et(0,0,t.width,t.height),this.element=t.view||Z.ADAPTER.createCanvas(),this.resolution=t.resolution||Z.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const n=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",n,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}dm.extension={type:[K.RendererSystem,K.CanvasRendererSystem],name:"_view"};it.add(dm);Z.PREFER_ENV=Wn.WEBGL2;Z.STRICT_TEXTURE_CACHE=!1;Object.defineProperties(Z,{WRAP_MODE:{get(){return pt.defaultOptions.wrapMode},set(r){St("7.1.0","settings.WRAP_MODE is deprecated, use BaseTeture.defaultOptions.wrapMode"),pt.defaultOptions.wrapMode=r}},SCALE_MODE:{get(){return pt.defaultOptions.scaleMode},set(r){St("7.1.0","settings.SCALE_MODE is deprecated, use BaseTeture.defaultOptions.scaleMode"),pt.defaultOptions.scaleMode=r}},MIPMAP_TEXTURES:{get(){return pt.defaultOptions.mipmap},set(r){St("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTeture.defaultOptions.mipmap"),pt.defaultOptions.mipmap=r}},ANISOTROPIC_LEVEL:{get(){return pt.defaultOptions.anisotropicLevel},set(r){St("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTeture.defaultOptions.anisotropicLevel"),pt.defaultOptions.anisotropicLevel=r}},FILTER_RESOLUTION:{get(){return St("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Te.defaultResolution},set(r){Te.defaultResolution=r}},FILTER_MULTISAMPLE:{get(){return St("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Te.defaultMultisample},set(r){Te.defaultMultisample=r}},SPRITE_MAX_TEXTURES:{get(){return sr.defaultMaxTextures},set(r){St("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),sr.defaultMaxTextures=r}},SPRITE_BATCH_SIZE:{get(){return sr.defaultBatchSize},set(r){St("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),sr.defaultBatchSize=r}},CAN_UPLOAD_SAME_BUFFER:{get(){return sr.canUploadSameBuffer},set(r){St("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),sr.canUploadSameBuffer=r}},GC_MODE:{get(){return or.defaultMode},set(r){St("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),or.defaultMode=r}},GC_MAX_IDLE:{get(){return or.defaultMaxIdle},set(r){St("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),or.defaultMaxIdle=r}},GC_MAX_CHECK_COUNT:{get(){return or.defaultCheckCountMax},set(r){St("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),or.defaultCheckCountMax=r}},PRECISION_VERTEX:{get(){return ar.defaultVertexPrecision},set(r){St("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),ar.defaultVertexPrecision=r}},PRECISION_FRAGMENT:{get(){return ar.defaultFragmentPrecision},set(r){St("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),ar.defaultFragmentPrecision=r}}});var Ri=(r=>(r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(Ri||{});class yh{constructor(t,e=null,n=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=i}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Ne=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new yh(null,null,1/0),this.deltaMS=1/Ne.targetFPMS,this.elapsedMS=1/Ne.targetFPMS,this._tick=r=>{this._requestId=null,this.started&&(this.update(r),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(r,t,e=Ri.NORMAL){return this._addListener(new yh(r,t,e))}addOnce(r,t,e=Ri.NORMAL){return this._addListener(new yh(r,t,e,!0))}_addListener(r){let t=this._head.next,e=this._head;if(!t)r.connect(e);else{for(;t;){if(r.priority>t.priority){r.connect(e);break}e=t,t=t.next}r.previous||r.connect(e)}return this._startIfPossible(),this}remove(r,t){let e=this._head.next;for(;e;)e.match(r,t)?e=e.destroy():e=e.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let r=0,t=this._head;for(;t=t.next;)r++;return r}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let r=this._head.next;for(;r;)r=r.destroy(!0);this._head.destroy(),this._head=null}}update(r=performance.now()){let t;if(r>this.lastTime){if(t=this.elapsedMS=r-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const i=r-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=r-i%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Ne.targetFPMS;const e=this._head;let n=e.next;for(;n;)n=n.emit(this.deltaTime);e.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=r}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(r){const t=Math.min(this.maxFPS,r),e=Math.min(Math.max(0,t)/1e3,Ne.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(r){if(r===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,r);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!Ne._shared){const r=Ne._shared=new Ne;r.autoStart=!0,r._protected=!0}return Ne._shared}static get system(){if(!Ne._system){const r=Ne._system=new Ne;r.autoStart=!0,r._protected=!0}return Ne._system}};let Pe=Ne;Pe.targetFPMS=.06;Object.defineProperties(Z,{TARGET_FPMS:{get(){return Pe.targetFPMS},set(r){St("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Pe.targetFPMS=r}}});class pm{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Ri.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Pe.shared:new Pe,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}pm.extension=K.Application;it.add(pm);const gm=[];it.handleByList(K.Renderer,gm);function ZR(r){for(const t of gm)if(t.test(r))return new t(r);throw new Error("Unable to auto-detect a suitable renderer.")}var JR=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,QR=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const tP=JR,mm=QR;class _m{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const n=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,n)}else{const n=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,n)}e>=ie.HIGH?this.multisample=ie.HIGH:e>=ie.MEDIUM?this.multisample=ie.MEDIUM:e>=ie.LOW?this.multisample=ie.LOW:this.multisample=ie.NONE}destroy(){}}_m.extension={type:K.RendererSystem,name:"_multisample"};it.add(_m);class eP{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class ym{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,i=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,i.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:n,CONTEXT_UID:i}=this;if(this.boundBufferBases[e]!==t){const o=t._glBuffers[i]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,o.buffer)}}bindBufferRange(t,e,n){const{gl:i,CONTEXT_UID:o}=this;n=n||0;const l=t._glBuffers[o]||this.createGLBuffer(t);i.bindBufferRange(i.UNIFORM_BUFFER,e||0,l.buffer,n*256,256)}update(t){const{gl:e,CONTEXT_UID:n}=this,i=t._glBuffers[n]||this.createGLBuffer(t);if(t._updateID!==i.updateID)if(i.updateID=t._updateID,e.bindBuffer(t.type,i.buffer),i.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const o=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;i.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,o)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const n=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),n&&(e||i.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:n}=this;return t._glBuffers[e]=new eP(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}ym.extension={type:K.RendererSystem,name:"buffer"};it.add(ym);class vm{constructor(t){this.renderer=t}render(t,e){const n=this.renderer;let i,o,l,h;if(e&&(i=e.renderTexture,o=e.clear,l=e.transform,h=e.skipUpdateTransform),this.renderingToScreen=!i,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=l,!n.context.isLost){if(i||(this.lastObjectRendered=t),!h){const c=t.enableTempParent();t.updateTransform(),t.disableTempParent(c)}n.renderTexture.bind(i),n.batch.currentRenderer.start(),(o??n.background.clearBeforeRender)&&n.renderTexture.clear(),t.render(n),n.batch.currentRenderer.flush(),i&&(e.blit&&n.framebuffer.blit(),i.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}vm.extension={type:K.RendererSystem,name:"objectRenderer"};it.add(vm);const tu=class extends qR{constructor(r){super(),r=Object.assign({},Z.RENDER_OPTIONS,r),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ur({projectionMatrix:new $t},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:tu.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in r&&(St("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),r.premultipliedAlpha=r.useContextAlpha&&r.useContextAlpha!=="notMultiplied",r.backgroundAlpha=r.useContextAlpha===!1?1:r.backgroundAlpha);const e={hello:r.hello,_plugin:tu.__plugins,background:{alpha:r.backgroundAlpha,color:r.background??r.backgroundColor,clearBeforeRender:r.clearBeforeRender},_view:{height:r.height,width:r.width,autoDensity:r.autoDensity,resolution:r.resolution,view:r.view},context:{antialias:r.antialias,context:r.context,powerPreference:r.powerPreference,premultipliedAlpha:r.premultipliedAlpha,preserveDrawingBuffer:r.preserveDrawingBuffer}};this.startup.run(e),this.options=r}static test(r){return r!=null&&r.forceCanvas?!1:KA()}render(r,t){this.objectRenderer.render(r,t)}resize(r,t){this._view.resizeView(r,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(r=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:r}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(r){this._view.resolution=r,this.runners.resolutionChange.emit(r)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return St("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return St("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return St("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return St("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(r){St("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=r}get backgroundAlpha(){return St("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.color}set backgroundAlpha(r){St("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=r}get powerPreference(){return St("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(r,t){return this.textureGenerator.generateTexture(r,t)}};let Bi=tu;Bi.extension={type:K.Renderer,priority:1};Bi.__plugins={};Bi.__systems={};it.handleByMap(K.RendererPlugin,Bi.__plugins);it.handleByMap(K.RendererSystem,Bi.__systems);it.add(Bi);class xm extends bs{constructor(t,e){const{width:n,height:i}=e||{};super(n,i),this.items=[],this.itemDirtyIds=[];for(let o=0;o<t;o++){const l=new pt;this.items.push(l),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof bs?this.addResourceAt(t[n],n):this.addResourceAt(Bg(t[n],e),n))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const e=this.items.map(n=>n.resource).filter(n=>n).map(n=>n.load());return this._load=Promise.all(e).then(()=>{const{realWidth:n,realHeight:i}=this.items[0];return this.resize(n,i),Promise.resolve(this)}),this._load}}class rP extends xm{constructor(t,e){const{width:n,height:i}=e||{};let o,l;Array.isArray(t)?(o=t,l=t.length):l=t,super(l,{width:n,height:i}),o&&this.initFromArray(o,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=xi.TEXTURE_2D_ARRAY}upload(t,e,n){const{length:i,itemDirtyIds:o,items:l}=this,{gl:h}=t;n.dirtyId<0&&h.texImage3D(h.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,i,0,e.format,n.type,null);for(let c=0;c<i;c++){const f=l[c];o[c]<f.dirtyId&&(o[c]=f.dirtyId,f.valid&&h.texSubImage3D(h.TEXTURE_2D_ARRAY,0,0,0,c,f.resource.width,f.resource.height,1,e.format,n.type,f.resource.source))}return!0}}class nP extends hn{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const hs=class extends xm{constructor(r,t){const{width:e,height:n,autoLoad:i,linkBaseTexture:o}=t||{};if(r&&r.length!==hs.SIDES)throw new Error(`Invalid length. Got ${r.length}, expected 6`);super(6,{width:e,height:n});for(let l=0;l<hs.SIDES;l++)this.items[l].target=xi.TEXTURE_CUBE_MAP_POSITIVE_X+l;this.linkBaseTexture=o!==!1,r&&this.initFromArray(r,t),i!==!1&&this.load()}bind(r){super.bind(r),r.target=xi.TEXTURE_CUBE_MAP}addBaseTextureAt(r,t,e){if(e===void 0&&(e=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||r.parentTextureArray||Object.keys(r._glTextures).length>0)if(r.resource)this.addResourceAt(r.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else r.target=xi.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.parentTextureArray=this.baseTexture,this.items[t]=r;return r.valid&&!this.valid&&this.resize(r.realWidth,r.realHeight),this.items[t]=r,this}upload(r,t,e){const n=this.itemDirtyIds;for(let i=0;i<hs.SIDES;i++){const o=this.items[i];(n[i]<o.dirtyId||e.dirtyId<t.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(r,o,e),n[i]=o.dirtyId):n[i]<-1&&(r.gl.texImage2D(o.target,0,e.internalFormat,t.realWidth,t.realHeight,0,t.format,e.type,null),n[i]=-1))}return!0}static test(r){return Array.isArray(r)&&r.length===hs.SIDES}};let bm=hs;bm.SIDES=6;class _i extends hn{constructor(t,e){var n=(...i)=>{super(...i)};e=e||{},typeof t=="string"?(n(_i.EMPTY),this.url=t):(n(t),this.url=null),this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const n=await Z.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await n.blob();if(this.destroyed)return;const o=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===cr.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=o,this.update(),t(this)}catch(n){if(this.destroyed)return;e(n),this.onError.emit(n)}}),this._load)}upload(t,e,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,n)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return _i._EMPTY=_i._EMPTY??Z.ADAPTER.createCanvas(0,0),_i._EMPTY}}const jo=class extends hn{constructor(r,t){t=t||{},super(Z.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=r,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(r=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),r(this)},jo.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const r=new Image;hn.crossOrigin(r,this.svg,this._crossorigin),r.src=this.svg,r.onerror=t=>{this._resolve&&(r.onerror=null,this.onError.emit(t))},r.onload=()=>{if(!this._resolve)return;const t=r.width,e=r.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let n=t*this.scale,i=e*this.scale;(this._overrideWidth||this._overrideHeight)&&(n=this._overrideWidth||this._overrideHeight/e*t,i=this._overrideHeight||this._overrideWidth/t*e),n=Math.round(n),i=Math.round(i);const o=this.source;o.width=n,o.height=i,o._pixiId=`canvas_${Gn()}`,o.getContext("2d").drawImage(r,0,0,t,e,0,0,n,i),this._resolve(),this._resolve=null}}static getSize(r){const t=jo.SVG_SIZE.exec(r),e={};return t&&(e[t[1]]=Math.round(parseFloat(t[3])),e[t[5]]=Math.round(parseFloat(t[7]))),e}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(r,t){return t==="svg"||typeof r=="string"&&r.startsWith("data:image/svg+xml")||typeof r=="string"&&jo.SVG_XML.test(r)}};let ws=jo;ws.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;ws.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const eu=class extends hn{constructor(r,t){if(t=t||{},!(r instanceof HTMLVideoElement)){const e=document.createElement("video");e.setAttribute("preload","auto"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),typeof r=="string"&&(r=[r]);const n=r[0].src||r[0];hn.crossOrigin(e,n,t.crossorigin);for(let i=0;i<r.length;++i){const o=document.createElement("source");let{src:l,mime:h}=r[i];l=l||r[i];const c=l.split("?").shift().toLowerCase(),f=c.slice(c.lastIndexOf(".")+1);h=h||eu.MIME_TYPES[f]||`video/${f}`,o.src=l,o.type=h,e.appendChild(o)}r=e}super(r),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(r=0){if(!this.destroyed){const t=Pe.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const r=this.source;return(r.readyState===r.HAVE_ENOUGH_DATA||r.readyState===r.HAVE_FUTURE_DATA)&&r.width&&r.height&&(r.complete=!0),r.addEventListener("play",this._onPlayStart.bind(this)),r.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(r.addEventListener("canplay",this._onCanPlay),r.addEventListener("canplaythrough",this._onCanPlay),r.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,r.load())}),this._load}_onError(r){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(r)}_isSourcePlaying(){const r=this.source;return!r.paused&&!r.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Pe.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Pe.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const r=this.source;r.removeEventListener("canplay",this._onCanPlay),r.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(r.videoWidth,r.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&r.play()}dispose(){this._isConnectedToTicker&&(Pe.shared.remove(this.update,this),this._isConnectedToTicker=!1);const r=this.source;r&&(r.removeEventListener("error",this._onError,!0),r.pause(),r.src="",r.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(r){r!==this._autoUpdate&&(this._autoUpdate=r,!this._autoUpdate&&this._isConnectedToTicker?(Pe.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Pe.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(r){r!==this._updateFPS&&(this._updateFPS=r)}static test(r,t){return globalThis.HTMLVideoElement&&r instanceof HTMLVideoElement||eu.TYPES.includes(t)}};let Lu=eu;Lu.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];Lu.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};jh.push(_i,zg,nP,Lu,ws,Cs,bm,rP);class aa{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?Et.EMPTY:(t=t||new Et(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:n,b:i,c:o,d:l,tx:h,ty:c}=t,f=n*e.x+o*e.y+h,d=i*e.x+l*e.y+c;this.minX=Math.min(this.minX,f),this.maxX=Math.max(this.maxX,f),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)}addQuad(t){let e=this.minX,n=this.minY,i=this.maxX,o=this.maxY,l=t[0],h=t[1];e=l<e?l:e,n=h<n?h:n,i=l>i?l:i,o=h>o?h:o,l=t[2],h=t[3],e=l<e?l:e,n=h<n?h:n,i=l>i?l:i,o=h>o?h:o,l=t[4],h=t[5],e=l<e?l:e,n=h<n?h:n,i=l>i?l:i,o=h>o?h:o,l=t[6],h=t[7],e=l<e?l:e,n=h<n?h:n,i=l>i?l:i,o=h>o?h:o,this.minX=e,this.minY=n,this.maxX=i,this.maxY=o}addFrame(t,e,n,i,o){this.addFrameMatrix(t.worldTransform,e,n,i,o)}addFrameMatrix(t,e,n,i,o){const l=t.a,h=t.b,c=t.c,f=t.d,d=t.tx,m=t.ty;let g=this.minX,y=this.minY,v=this.maxX,T=this.maxY,E=l*e+c*n+d,I=h*e+f*n+m;g=E<g?E:g,y=I<y?I:y,v=E>v?E:v,T=I>T?I:T,E=l*i+c*n+d,I=h*i+f*n+m,g=E<g?E:g,y=I<y?I:y,v=E>v?E:v,T=I>T?I:T,E=l*e+c*o+d,I=h*e+f*o+m,g=E<g?E:g,y=I<y?I:y,v=E>v?E:v,T=I>T?I:T,E=l*i+c*o+d,I=h*i+f*o+m,g=E<g?E:g,y=I<y?I:y,v=E>v?E:v,T=I>T?I:T,this.minX=g,this.minY=y,this.maxX=v,this.maxY=T}addVertexData(t,e,n){let i=this.minX,o=this.minY,l=this.maxX,h=this.maxY;for(let c=e;c<n;c+=2){const f=t[c],d=t[c+1];i=f<i?f:i,o=d<o?d:o,l=f>l?f:l,h=d>h?d:h}this.minX=i,this.minY=o,this.maxX=l,this.maxY=h}addVertices(t,e,n,i){this.addVerticesMatrix(t.worldTransform,e,n,i)}addVerticesMatrix(t,e,n,i,o=0,l=o){const h=t.a,c=t.b,f=t.c,d=t.d,m=t.tx,g=t.ty;let y=this.minX,v=this.minY,T=this.maxX,E=this.maxY;for(let I=n;I<i;I+=2){const P=e[I],w=e[I+1],R=h*P+f*w+m,O=d*w+c*P+g;y=Math.min(y,R-o),T=Math.max(T,R+o),v=Math.min(v,O-l),E=Math.max(E,O+l)}this.minX=y,this.minY=v,this.maxX=T,this.maxY=E}addBounds(t){const e=this.minX,n=this.minY,i=this.maxX,o=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>o?t.maxY:o}addBoundsMask(t,e){const n=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,o=t.maxX<e.maxX?t.maxX:e.maxX,l=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=o&&i<=l){const h=this.minX,c=this.minY,f=this.maxX,d=this.maxY;this.minX=n<h?n:h,this.minY=i<c?i:c,this.maxX=o>f?o:f,this.maxY=l>d?l:d}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const n=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,o=t.maxX<e.x+e.width?t.maxX:e.x+e.width,l=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=o&&i<=l){const h=this.minX,c=this.minY,f=this.maxX,d=this.maxY;this.minX=n<h?n:h,this.minY=i<c?i:c,this.maxX=o>f?o:f,this.maxY=l>d?l:d}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,n,i,o,l){t-=o,e-=l,n+=o,i+=l,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i}}class Vt extends Ts{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Fu,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new aa,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let n=0;n<e.length;++n){const i=e[n];Object.defineProperty(Vt.prototype,i,Object.getOwnPropertyDescriptor(t,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Et),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new Et),t=this._localBoundsRect),this._localBounds||(this._localBounds=new aa);const e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,o=this._boundsID;this._bounds=this._localBounds;const l=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=i,this._bounds.updateID+=this._boundsID-o,l}toGlobal(t,e,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,n,i){return e&&(t=e.toGlobal(t,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,n=1,i=1,o=0,l=0,h=0,c=0,f=0){return this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=i||1,this.rotation=o,this.skew.x=l,this.skew.y=h,this.pivot.x=c,this.pivot.y=f,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new iP),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*tR}set angle(t){this.transform.rotation=t*eR}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class iP extends Vt{constructor(){super(...arguments),this.sortDirty=null}}Vt.prototype.displayObjectUpdateTransform=Vt.prototype.updateTransform;const sP=new $t;function oP(r,t){return r.zIndex===t.zIndex?r._lastSortedIndex-t._lastSortedIndex:r.zIndex-t.zIndex}const ru=class extends Vt{constructor(){super(),this.children=[],this.sortableChildren=ru.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(r){}addChild(...r){if(r.length>1)for(let t=0;t<r.length;t++)this.addChild(r[t]);else{const t=r[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return r[0]}addChildAt(r,t){if(t<0||t>this.children.length)throw new Error(`${r}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.splice(t,0,r),this._boundsID++,this.onChildrenChange(t),r.emit("added",this),this.emit("childAdded",r,this,t),r}swapChildren(r,t){if(r===t)return;const e=this.getChildIndex(r),n=this.getChildIndex(t);this.children[e]=t,this.children[n]=r,this.onChildrenChange(e<n?e:n)}getChildIndex(r){const t=this.children.indexOf(r);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(r,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const e=this.getChildIndex(r);Ei(this.children,e,1),this.children.splice(t,0,r),this.onChildrenChange(t)}getChildAt(r){if(r<0||r>=this.children.length)throw new Error(`getChildAt: Index (${r}) does not exist.`);return this.children[r]}removeChild(...r){if(r.length>1)for(let t=0;t<r.length;t++)this.removeChild(r[t]);else{const t=r[0],e=this.children.indexOf(t);if(e===-1)return null;t.parent=null,t.transform._parentID=-1,Ei(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e)}return r[0]}removeChildAt(r){const t=this.getChildAt(r);return t.parent=null,t.transform._parentID=-1,Ei(this.children,r,1),this._boundsID++,this.onChildrenChange(r),t.emit("removed",this),this.emit("childRemoved",t,this,r),t}removeChildren(r=0,t=this.children.length){const e=r,n=t,i=n-e;let o;if(i>0&&i<=n){o=this.children.splice(e,i);for(let l=0;l<o.length;++l)o[l].parent=null,o[l].transform&&(o[l].transform._parentID=-1);this._boundsID++,this.onChildrenChange(r);for(let l=0;l<o.length;++l)o[l].emit("removed",this),this.emit("childRemoved",o[l],this,l);return o}else if(i===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let r=!1;for(let t=0,e=this.children.length;t<e;++t){const n=this.children[t];n._lastSortedIndex=t,!r&&n.zIndex!==0&&(r=!0)}r&&this.children.length>1&&this.children.sort(oP),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let r=0,t=this.children.length;r<t;++r){const e=this.children[r];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let r=0;r<this.children.length;r++){const t=this.children[r];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(r,t=!1){const e=super.getLocalBounds(r);if(!t)for(let n=0,i=this.children.length;n<i;++n){const o=this.children[n];o.visible&&o.updateTransform()}return e}_calculateBounds(){}_renderWithCulling(r){const t=r.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let e,n;this.cullArea?(e=this.cullArea,n=this.worldTransform):this._render!==ru.prototype._render&&(e=this.getBounds(!0));const i=r.projection.transform;if(i&&(n?(n=sP.copyFrom(n),n.prepend(i)):n=i),e&&t.intersects(e,n))this._render(r);else if(this.cullArea)return;for(let o=0,l=this.children.length;o<l;++o){const h=this.children[o],c=h.cullable;h.cullable=c||!this.cullArea,h.render(r),h.cullable=c}}render(r){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(r);else if(this.cullable)this._renderWithCulling(r);else{this._render(r);for(let e=0,n=this.children.length;e<n;++e)this.children[e].render(r)}}renderAdvanced(r){var i,o,l;const t=this.filters,e=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let h=0;h<t.length;h++)t[h].enabled&&this._enabledFilters.push(t[h])}const n=t&&((i=this._enabledFilters)==null?void 0:i.length)||e&&(!e.isMaskData||e.enabled&&(e.autoDetect||e.type!==he.NONE));if(n&&r.batch.flush(),t&&((o=this._enabledFilters)!=null&&o.length)&&r.filter.push(this,this._enabledFilters),e&&r.mask.push(this,this._mask),this.cullable)this._renderWithCulling(r);else{this._render(r);for(let h=0,c=this.children.length;h<c;++h)this.children[h].render(r)}n&&r.batch.flush(),e&&r.mask.pop(this),t&&((l=this._enabledFilters)!=null&&l.length)&&r.filter.pop()}_render(r){}destroy(r){super.destroy(),this.sortDirty=!1;const t=typeof r=="boolean"?r:r==null?void 0:r.children,e=this.removeChildren(0,this.children.length);if(t)for(let n=0;n<e.length;++n)e[n].destroy(r)}get width(){return this.scale.x*this.getLocalBounds().width}set width(r){const t=this.getLocalBounds().width;t!==0?this.scale.x=r/t:this.scale.x=1,this._width=r}get height(){return this.scale.y*this.getLocalBounds().height}set height(r){const t=this.getLocalBounds().height;t!==0?this.scale.y=r/t:this.scale.y=1,this._height=r}};let ke=ru;ke.defaultSortableChildren=!1;ke.prototype.containerUpdateTransform=ke.prototype.updateTransform;Object.defineProperties(Z,{SORTABLE_CHILDREN:{get(){return ke.defaultSortableChildren},set(r){St("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),ke.defaultSortableChildren=r}}});const os=new At,aP=new Uint16Array([0,1,2,0,2,3]);class Oi extends ke{constructor(t){super(),this._anchor=new sn(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=ut.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||nt.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=aP,this.pluginName="batch",this.isSprite=!0,this._roundPixels=Z.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=mi(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=mi(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,n=e.a,i=e.b,o=e.c,l=e.d,h=e.tx,c=e.ty,f=this.vertexData,d=t.trim,m=t.orig,g=this._anchor;let y=0,v=0,T=0,E=0;if(d?(v=d.x-g._x*m.width,y=v+d.width,E=d.y-g._y*m.height,T=E+d.height):(v=-g._x*m.width,y=v+m.width,E=-g._y*m.height,T=E+m.height),f[0]=n*v+o*E+h,f[1]=l*E+i*v+c,f[2]=n*y+o*E+h,f[3]=l*E+i*y+c,f[4]=n*y+o*T+h,f[5]=l*T+i*y+c,f[6]=n*v+o*T+h,f[7]=l*T+i*v+c,this._roundPixels){const I=Z.RESOLUTION;for(let P=0;P<f.length;++P)f[P]=Math.round(f[P]*I)/I}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,n=t.orig,i=this._anchor,o=this.transform.worldTransform,l=o.a,h=o.b,c=o.c,f=o.d,d=o.tx,m=o.ty,g=-i._x*n.width,y=g+n.width,v=-i._y*n.height,T=v+n.height;e[0]=l*g+c*v+d,e[1]=f*v+h*g+m,e[2]=l*y+c*v+d,e[3]=f*v+h*y+m,e[4]=l*y+c*T+d,e[5]=f*T+h*y+m,e[6]=l*g+c*T+d,e[7]=f*T+h*g+m}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new aa),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Et),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,os);const e=this._texture.orig.width,n=this._texture.orig.height,i=-e*this.anchor.x;let o=0;return os.x>=i&&os.x<i+e&&(o=-n*this.anchor.y,os.y>=o&&os.y<o+n)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const n=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!n)}this._texture=null}static from(t,e){const n=t instanceof nt?t:nt.from(t,e);return new Oi(n)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=mi(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=mi(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tint}set tint(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||nt.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const wm=new $t;Vt.prototype._cacheAsBitmap=!1;Vt.prototype._cacheData=null;Vt.prototype._cacheAsBitmapResolution=null;Vt.prototype._cacheAsBitmapMultisample=null;class lP{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Vt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(r){r!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(r){r!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(r){if(this._cacheAsBitmap===r)return;this._cacheAsBitmap=r;let t;r?(this._cacheData||(this._cacheData=new lP),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});Vt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Vt.prototype._initCachedDisplayObject=function(t){var g,y;if((g=this._cacheData)!=null&&g.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const n=this.getLocalBounds(null,!0).clone();if((y=this.filters)!=null&&y.length){const v=this.filters[0].padding;n.pad(v)}n.ceil(Z.RESOLUTION);const i=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),l=t.renderTexture.destinationFrame.clone(),h=t.projection.transform,c=un.create({width:n.width,height:n.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),f=`cacheAsBitmap_${Gn()}`;this._cacheData.textureCacheId=f,pt.addToCache(c.baseTexture,f),nt.addToCache(c,f);const d=this.transform.localTransform.copyTo(wm).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:c,clear:!0,transform:d,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=h,t.renderTexture.bind(i,o,l),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const m=new Oi(c);m.transform.worldTransform=this.transform.worldTransform,m.anchor.x=-(n.x/n.width),m.anchor.y=-(n.y/n.height),m.alpha=e,m._bounds=this._bounds,this._cacheData.sprite=m,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=m.containsPoint.bind(m)};Vt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Vt.prototype._initCachedDisplayObjectCanvas=function(t){var d;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.getLocalBounds(null,!0),n=this.alpha;this.alpha=1;const i=t.canvasContext.activeContext,o=t._projTransform;e.ceil(Z.RESOLUTION);const l=un.create({width:e.width,height:e.height}),h=`cacheAsBitmap_${Gn()}`;this._cacheData.textureCacheId=h,pt.addToCache(l.baseTexture,h),nt.addToCache(l,h);const c=wm;this.transform.localTransform.copyTo(c),c.invert(),c.tx-=e.x,c.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:l,clear:!0,transform:c,skipUpdateTransform:!1}),t.canvasContext.activeContext=i,t._projTransform=o,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;const f=new Oi(l);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-(e.x/e.width),f.anchor.y=-(e.y/e.height),f.alpha=n,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=f.containsPoint.bind(f)};Vt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Vt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Vt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,pt.removeFromCache(this._cacheData.textureCacheId),nt.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Vt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Vt.prototype.name=null;ke.prototype.getChildByName=function(t,e){for(let n=0,i=this.children.length;n<i;n++)if(this.children[n].name===t)return this.children[n];if(e)for(let n=0,i=this.children.length;n<i;n++){const o=this.children[n];if(!o.getChildByName)continue;const l=o.getChildByName(t,!0);if(l)return l}return null};Vt.prototype.getGlobalPosition=function(t=new At,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var hP=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class uP extends Te{constructor(t=1){super(tP,hP,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const cP={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},fP=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function dP(r){const t=cP[r],e=t.length;let n=fP,i="";const o="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let l;for(let h=0;h<r;h++){let c=o.replace("%index%",h.toString());l=h,h>=e&&(l=r-h-1),c=c.replace("%value%",t[l].toString()),i+=c,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",r.toString()),n}const pP=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function gP(r,t){const e=Math.ceil(r/2);let n=pP,i="",o;t?o="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":o="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let l=0;l<r;l++){let h=o.replace("%index%",l.toString());h=h.replace("%sampleIndex%",`${l-(e-1)}.0`),i+=h,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",r.toString()),n}class nu extends Te{constructor(t,e=8,n=4,i=Z.FILTER_RESOLUTION,o=5){const l=gP(o,t),h=dP(o);super(l,h),this.horizontal=t,this.resolution=i,this._quality=0,this.quality=n,this.blur=e}apply(t,e,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,n,i);else{const o=t.getFilterTexture(),l=t.renderer;let h=e,c=o;this.state.blend=!1,t.applyFilter(this,h,c,br.CLEAR);for(let f=1;f<this.passes-1;f++){t.bindAndClear(h,br.BLIT),this.uniforms.uSampler=c;const d=c;c=h,h=d,l.shader.bind(this),l.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,c,n,i),t.returnFilterTexture(o)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class mP extends Te{constructor(t=8,e=4,n=Te.defaultResolution,i=5){super(),this.blurXFilter=new nu(!0,t,e,n,i),this.blurYFilter=new nu(!1,t,e,n,i),this.resolution=n,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,n,i){const o=Math.abs(this.blurXFilter.strength),l=Math.abs(this.blurYFilter.strength);if(o&&l){const h=t.getFilterTexture();this.blurXFilter.apply(t,e,h,br.CLEAR),this.blurYFilter.apply(t,h,n,i),t.returnFilterTexture(h)}else l?this.blurYFilter.apply(t,e,n,i):this.blurXFilter.apply(t,e,n,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var _P=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class iu extends Te{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(mm,_P,t),this.alpha=1}_loadMatrix(t,e=!1){let n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}tint(t,e){const n=t>>16&255,i=t>>8&255,o=t&255,l=[n/255,0,0,0,0,0,i/255,0,0,0,0,0,o/255,0,0,0,0,0,1,0];this._loadMatrix(l,e)}greyscale(t,e){const n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const n=Math.cos(t),i=Math.sin(t),o=Math.sqrt,l=1/3,h=o(l),c=n+(1-n)*l,f=l*(1-n)-h*i,d=l*(1-n)+h*i,m=l*(1-n)+h*i,g=n+l*(1-n),y=l*(1-n)-h*i,v=l*(1-n)-h*i,T=l*(1-n)+h*i,E=n+l*(1-n),I=[c,f,d,0,0,m,g,y,0,0,v,T,E,0,0,0,0,0,1,0];this._loadMatrix(I,e)}contrast(t,e){const n=(t||0)+1,i=-.5*(n-1),o=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(o,e)}saturate(t=0,e){const n=t*2/3+1,i=(n-1)*-.5,o=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(o,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,n,i,o){t=t||.2,e=e||.15,n=n||16770432,i=i||3375104;const l=(n>>16&255)/255,h=(n>>8&255)/255,c=(n&255)/255,f=(i>>16&255)/255,d=(i>>8&255)/255,m=(i&255)/255,g=[.3,.59,.11,0,0,l,h,c,t,0,f,d,m,e,0,l-f,h-d,c-m,0,0];this._loadMatrix(g,o)}night(t,e){t=t||.1;const n=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(n,e)}predator(t,e){const n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}iu.prototype.grayscale=iu.prototype.greyscale;var yP=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,vP=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class xP extends Te{constructor(t,e){const n=new $t;t.renderable=!1,super(vP,yP,{mapSampler:t._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=n,e==null&&(e=20),this.scale=new At(e,e)}apply(t,e,n,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const o=this.maskSprite.worldTransform,l=Math.sqrt(o.a*o.a+o.b*o.b),h=Math.sqrt(o.c*o.c+o.d*o.d);l!==0&&h!==0&&(this.uniforms.rotation[0]=o.a/l,this.uniforms.rotation[1]=o.b/l,this.uniforms.rotation[2]=o.c/h,this.uniforms.rotation[3]=o.d/h),t.applyFilter(this,e,n,i)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var bP=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,wP=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class EP extends Te{constructor(){super(wP,bP)}}var TP=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class AP extends Te{constructor(t=.5,e=Math.random()){super(mm,TP,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const Ep={AlphaFilter:uP,BlurFilter:mP,BlurFilterPass:nu,ColorMatrixFilter:iu,DisplacementFilter:xP,FXAAFilter:EP,NoiseFilter:AP};Object.entries(Ep).forEach(([r,t])=>{Object.defineProperty(Ep,r,{get(){return St("7.1.0",`filters.${r} has moved to ${r}`),t}})});class Is{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Is.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new At,this.page=new At,this.AT_TARGET=1,this.BUBBLING_PHASE=2,this.CAPTURING_PHASE=3,this.NONE=0,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,n,i,o){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class la extends Is{constructor(){super(...arguments),this.client=new At,this.movement=new At,this.offset=new At,this.global=new At,this.screen=new At}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,n,i,o,l,h,c,f,d,m,g,y,v,T){throw new Error("Method not implemented.")}}class nr extends la{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class su extends la{constructor(){super(...arguments),this.DOM_DELTA_LINE=0,this.DOM_DELTA_PAGE=1,this.DOM_DELTA_PIXEL=2}}const SP=2048,CP=new At,vh=new At;class IP{constructor(t){this.dispatch=new Ts,this.moveOnAll=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((n,i)=>n.priority-i.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let n=0,i=e.length;n<i;n++)e[n].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){const n=this.hitTestRecursive(this.rootTarget,this.rootTarget.interactive,CP.set(t,e),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(t,e){if(!t.target)return;const n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let i=0,o=n.length-1;i<o;i++)if(t.currentTarget=n[i],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let i=n.length-2;i>=0;i--)if(t.currentTarget=n[i],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,n=this.rootTarget){t.eventPhase=t.BUBBLING_PHASE;const i=n.children;if(i)for(let o=0;o<i.length;o++)this.all(t,e,i[o]);t.currentTarget=n,this.notifyTarget(t,e)}propagationPath(t){const e=[t];for(let n=0;n<SP&&t!==this.rootTarget;n++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestRecursive(t,e,n,i,o){if(!t||!t.visible||o(t,n))return null;if(t.interactiveChildren&&t.children){const l=t.children;for(let h=l.length-1;h>=0;h--){const c=l[h],f=this.hitTestRecursive(c,e||c.interactive,n,i,o);if(f){if(f.length>0&&!f[f.length-1].parent)continue;return(f.length>0||t.interactive)&&f.push(t),f}}}return e&&i(t,n)?t.interactive?[t]:[]:null}hitPruneFn(t,e){var n;if(t.hitArea&&(t.worldTransform.applyInverse(e,vh),!t.hitArea.contains(vh.x,vh.y)))return!0;if(t._mask){const i=t._mask.isMaskData?t._mask.maskObject:t._mask;if(i&&!((n=i.containsPoint)!=null&&n.call(i,e)))return!0}return!1}hitTestFn(t,e){return t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var o,l;e=e??t.type;const n=`on${e}`;(l=(o=t.currentTarget)[n])==null||l.call(o,t);const i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof nr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const i=e.button===2;this.dispatchEvent(e,i?"rightdown":"mousedown")}const n=this.trackingData(t.pointerId);n.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var h;if(!(t instanceof nr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t),n=e.pointerType==="mouse"||e.pointerType==="pen",i=this.trackingData(t.pointerId),o=this.findMountedTarget(i.overTargets);if(i.overTargets&&o!==e.target){const c=t.type==="mousemove"?"mouseout":"pointerout",f=this.createPointerEvent(t,c,o);if(this.dispatchEvent(f,"pointerout"),n&&this.dispatchEvent(f,"mouseout"),!e.composedPath().includes(o)){const d=this.createPointerEvent(t,"pointerleave",o);for(d.eventPhase=d.AT_TARGET;d.target&&!e.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),n&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(f)}if(o!==e.target){const c=t.type==="mousemove"?"mouseover":"pointerover",f=this.clonePointerEvent(e,c);this.dispatchEvent(f,"pointerover"),n&&this.dispatchEvent(f,"mouseover");let d=o==null?void 0:o.parent;for(;d&&d!==this.rootTarget.parent&&d!==e.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const g=this.clonePointerEvent(e,"pointerenter");for(g.eventPhase=g.AT_TARGET;g.target&&g.target!==o&&g.target!==this.rootTarget.parent;)g.currentTarget=g.target,this.notifyTarget(g),n&&this.notifyTarget(g,"mouseenter"),g.target=g.target.parent;this.freeEvent(g)}this.freeEvent(f)}const l=this.moveOnAll?"all":"dispatchEvent";this[l](e,"pointermove"),e.pointerType==="touch"&&this[l](e,"touchmove"),n&&(this[l](e,"mousemove"),this.cursor=(h=e.target)==null?void 0:h.cursor),i.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var l;if(!(t instanceof nr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),n=this.createPointerEvent(t),i=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(l=n.target)==null?void 0:l.cursor);const o=this.clonePointerEvent(n,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;e.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(o)}mapPointerOut(t){if(!(t instanceof nr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const n=t.pointerType==="mouse"||t.pointerType==="pen",i=this.findMountedTarget(e.overTargets),o=this.createPointerEvent(t,"pointerout",i);this.dispatchEvent(o),n&&this.dispatchEvent(o,"mouseout");const l=this.createPointerEvent(t,"pointerleave",i);for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==this.rootTarget.parent;)l.currentTarget=l.target,this.notifyTarget(l),n&&this.notifyTarget(l,"mouseleave"),l.target=l.target.parent;e.overTargets=null,this.freeEvent(o),this.freeEvent(l)}this.cursor=null}mapPointerUp(t){if(!(t instanceof nr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),n=this.createPointerEvent(t);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const h=n.button===2;this.dispatchEvent(n,h?"rightup":"mouseup")}const i=this.trackingData(t.pointerId),o=this.findMountedTarget(i.pressTargetsByButton[t.button]);let l=o;if(o&&!n.composedPath().includes(o)){let h=o;for(;h&&!n.composedPath().includes(h);){if(n.currentTarget=h,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const c=n.button===2;this.notifyTarget(n,c?"rightupoutside":"mouseupoutside")}h=h.parent}delete i.pressTargetsByButton[t.button],l=h}if(l){const h=this.clonePointerEvent(n,"click");h.target=l,h.path=null,i.clicksByButton[t.button]||(i.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});const c=i.clicksByButton[t.button];c.target===h.target&&e-c.timeStamp<200?++c.clickCount:c.clickCount=1,c.target=h.target,c.timeStamp=e,h.detail=c.clickCount,h.pointerType==="mouse"?this.dispatchEvent(h,"click"):h.pointerType==="touch"&&this.dispatchEvent(h,"tap"),this.dispatchEvent(h,"pointertap"),this.freeEvent(h)}this.freeEvent(n)}mapPointerUpOutside(t){if(!(t instanceof nr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),n=this.findMountedTarget(e.pressTargetsByButton[t.button]),i=this.createPointerEvent(t);if(n){let o=n;for(;o;)i.currentTarget=o,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),o=o.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(i)}mapWheel(t){if(!(t instanceof su)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let n=1;n<t.length&&t[n].parent===e;n++)e=t[n];return e}createPointerEvent(t,e,n){const i=this.allocateEvent(nr);return this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t,i.target=n??this.hitTest(i.global.x,i.global.y),typeof e=="string"&&(i.type=e),i}createWheelEvent(t){const e=this.allocateEvent(su);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const n=this.allocateEvent(nr);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=e??n.type,n}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof nr&&e instanceof nr&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof la&&e instanceof la&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const n=t.currentTarget._events[e];if(n)if("fn"in n)n.fn.call(n.context,t);else for(let i=0,o=n.length;i<o&&!t.propagationImmediatelyStopped;i++)n[i].fn.call(n[i].context,t)}}const RP=1,PP={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class Em{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new IP(null),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new nr(null),this.rootWheelEvent=new su(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}init(){const{view:t,resolution:e}=this.renderer;this.setTargetElement(t),this.resolution=e}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.domElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.domElement.style,n);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}onPointerDown(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let n=0,i=e.length;n<i;n++){const o=e[n],l=this.bootstrapEvent(this.rootPointerEvent,o);this.rootBoundary.mapEvent(l)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);for(let n=0,i=e.length;n<i;n++){const o=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const n=e!==this.domElement?"outside":"",i=this.normalizeToPointerData(t);for(let o=0,l=i.length;o<l;o++){const h=this.bootstrapEvent(this.rootPointerEvent,i[o]);h.type+=n,this.rootBoundary.mapEvent(h)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);for(let n=0,i=e.length;n<i;n++){const o=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,n){let i;this.domElement.parentElement?i=this.domElement.getBoundingClientRect():i={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const o=1/this.resolution;t.x=(e-i.left)*(this.domElement.width/i.width)*o,t.y=(n-i.top)*(this.domElement.height/i.height)*o}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let n=0,i=t.changedTouches.length;n<i;n++){const o=t.changedTouches[n];typeof o.button>"u"&&(o.button=0),typeof o.buttons>"u"&&(o.buttons=1),typeof o.isPrimary>"u"&&(o.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof o.width>"u"&&(o.width=o.radiusX||1),typeof o.height>"u"&&(o.height=o.radiusY||1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="touch"),typeof o.pointerId>"u"&&(o.pointerId=o.identifier||0),typeof o.pressure>"u"&&(o.pressure=o.force||.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),typeof o.layerX>"u"&&(o.layerX=o.offsetX=o.clientX),typeof o.layerY>"u"&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,o.type=t.type,e.push(o)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const n=t;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=RP),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,e.push(n)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=PP[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}}Em.extension={name:"events",type:[K.RendererSystem,K.CanvasRendererSystem]};it.add(Em);const MP={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,ontouchstart:null,onwheel:null,interactive:!1,interactiveChildren:!0,hitArea:null,addEventListener(r,t,e){const n=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,i=typeof t=="function"?void 0:t;r=n?`${r}capture`:r,t=typeof t=="function"?t:t.handleEvent,this.on(r,t,i)},removeEventListener(r,t,e){const n=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,i=typeof t=="function"?void 0:t;r=n?`${r}capture`:r,t=typeof t=="function"?t:t.handleEvent,this.off(r,t,i)},dispatchEvent(r){if(!(r instanceof Is))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return r.defaultPrevented=!1,r.path=null,r.target=this,r.manager.dispatchEvent(r),!r.defaultPrevented}};Vt.mixin(MP);const DP={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Vt.mixin(DP);const BP=9,Oo=100,OP=0,FP=0,Tp=2,Ap=1,LP=-1e3,NP=-1e3,UP=2;class Tm{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Hr.tablet||Hr.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${Oo}px`,e.style.height=`${Oo}px`,e.style.position="absolute",e.style.top=`${OP}px`,e.style.left=`${FP}px`,e.style.zIndex=Tp.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${Ap}px`,t.style.height=`${Ap}px`,t.style.position="absolute",t.style.top=`${LP}px`,t.style.left=`${NP}px`,t.style.zIndex=UP.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}update(){const t=performance.now();if(Hr.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:n,width:i,height:o}=this.renderer.view.getBoundingClientRect(),{width:l,height:h,resolution:c}=this.renderer,f=i/l*c,d=o/h*c;let m=this.div;m.style.left=`${e}px`,m.style.top=`${n}px`,m.style.width=`${l}px`,m.style.height=`${h}px`;for(let g=0;g<this.children.length;g++){const y=this.children[g];if(y.renderId!==this.renderId)y._accessibleActive=!1,Ei(this.children,g,1),this.div.removeChild(y._accessibleDiv),this.pool.push(y._accessibleDiv),y._accessibleDiv=null,g--;else{m=y._accessibleDiv;let v=y.hitArea;const T=y.worldTransform;y.hitArea?(m.style.left=`${(T.tx+v.x*T.a)*f}px`,m.style.top=`${(T.ty+v.y*T.d)*d}px`,m.style.width=`${v.width*T.a*f}px`,m.style.height=`${v.height*T.d*d}px`):(v=y.getBounds(),this.capHitArea(v),m.style.left=`${v.x*f}px`,m.style.top=`${v.y*d}px`,m.style.width=`${v.width*f}px`,m.style.height=`${v.height*d}px`,m.title!==y.accessibleTitle&&y.accessibleTitle!==null&&(m.title=y.accessibleTitle),m.getAttribute("aria-label")!==y.accessibleHint&&y.accessibleHint!==null&&m.setAttribute("aria-label",y.accessibleHint)),(y.accessibleTitle!==m.title||y.tabIndex!==m.tabIndex)&&(m.title=y.accessibleTitle,m.tabIndex=y.tabIndex,this.debug&&this.updateDebugHTML(m))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:n}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>n&&(t.height=n-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${Oo}px`,e.style.height=`${Oo}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=Tp.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:n}=t.target,i=this.renderer.events.rootBoundary,o=Object.assign(new Is(i),{target:n});i.rootTarget=this.renderer.lastObjectRendered,e.forEach(l=>i.dispatchEvent(o,l))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===BP&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Tm.extension={name:"accessibility",type:[K.RendererPlugin,K.CanvasRendererPlugin]};it.add(Tm);const ou=class{constructor(r){this.stage=new ke,r=Object.assign({forceCanvas:!1},r),this.renderer=ZR(r),ou._plugins.forEach(t=>{t.init.call(this,r)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(r,t){const e=ou._plugins.slice(0);e.reverse(),e.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(r),this.renderer=null}};let Nu=ou;Nu._plugins=[];it.handleByList(K.Application,Nu._plugins);class Am{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,n;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:o}=this._resizeTo;e=i,n=o}this.renderer.resize(e,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Am.extension=K.Application;it.add(Am);const Sp={loader:K.LoadParser,resolver:K.ResolveParser,cache:K.CacheParser,detection:K.DetectionParser};it.handle(K.Asset,r=>{const t=r.ref;Object.entries(Sp).filter(([e])=>!!t[e]).forEach(([e,n])=>it.add(Object.assign(t[e],{extension:t[e].extension??n})))},r=>{const t=r.ref;Object.keys(Sp).filter(e=>!!t[e]).forEach(e=>it.remove(t[e]))});class kP{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<e;n++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function Sm(r,t){if(Array.isArray(t)){for(const e of t)if(r.startsWith(`data:${e}`))return!0;return!1}return r.startsWith(`data:${t}`)}function va(r,t){const e=r.split("?")[0],n=me.extname(e).toLowerCase();return Array.isArray(t)?t.includes(n):n===t}const $r=(r,t)=>(Array.isArray(r)||(r=[r]),t?r.map(e=>typeof e=="string"?t(e):e):r);function Cm(r,t,e,n,i){const o=t[e];for(let l=0;l<o.length;l++){const h=o[l];e<t.length-1?Cm(r.replace(n[e],h),t,e+1,n,i):i.push(r.replace(n[e],h))}}function GP(r){const t=/\{(.*?)\}/g,e=r.match(t),n=[];if(e){const i=[];e.forEach(o=>{const l=o.substring(1,o.length-1).split(",");i.push(l)}),Cm(r,i,0,e,n)}else n.push(r);return n}const ha=r=>!Array.isArray(r);class HP{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const n=$r(t);let i;for(let h=0;h<this.parsers.length;h++){const c=this.parsers[h];if(c.test(e)){i=c.getCacheableAssets(n,e);break}}i||(i={},n.forEach(h=>{i[h]=e}));const o=Object.keys(i),l={cacheKeys:o,keys:n};if(n.forEach(h=>{this._cacheMap.set(h,l)}),o.forEach(h=>{this._cache.has(h)&&this._cache.get(h)!==e&&console.warn("[Cache] already has key:",h),this._cache.set(h,i[h])}),e instanceof nt){const h=e;n.forEach(c=>{h.baseTexture!==nt.EMPTY.baseTexture&&pt.addToCache(h.baseTexture,c),nt.addToCache(h,c)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(i=>{this._cache.delete(i)}),e.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const as=new HP;class $P{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(t,e){const n={promise:null,parser:null};return n.promise=(async()=>{var o,l;let i=null;for(let h=0;h<this.parsers.length;h++){const c=this.parsers[h];if(c.load&&((o=c.test)!=null&&o.call(c,t,e,this))){i=await c.load(t,e,this),n.parser=c;break}}if(!n.parser)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has being added`),null;for(let h=0;h<this.parsers.length;h++){const c=this.parsers[h];c.parse&&c.parse&&await((l=c.testParse)==null?void 0:l.call(c,i,e,this))&&(i=await c.parse(i,e,this)||i,n.parser=c)}return i})(),n}async load(t,e){let n=0;const i={},o=ha(t),l=$r(t,f=>({src:f})),h=l.length,c=l.map(async f=>{const d=me.toAbsolute(f.src);if(!i[f.src])try{this.promiseCache[d]||(this.promiseCache[d]=this._getLoadPromiseAndParser(d,f)),i[f.src]=await this.promiseCache[d].promise,e&&e(++n/h)}catch(m){throw delete this.promiseCache[d],delete i[f.src],new Error(`[Loader.load] Failed to load ${d}.
${m}`)}});return await Promise.all(c),o?i[l[0].src]:i}async unload(t){const n=$r(t,i=>({src:i})).map(async i=>{var h,c;const o=me.toAbsolute(i.src),l=this.promiseCache[o];if(l){const f=await l.promise;(c=(h=l.parser)==null?void 0:h.unload)==null||c.call(h,f,i,this),delete this.promiseCache[o]}});await Promise.all(n)}get parsers(){return this._parsers}}var Cr=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(Cr||{});const WP={extension:{type:K.LoadParser,priority:Cr.Low},test(r){return me.extname(r).toLowerCase()===".json"},async load(r){return await(await Z.ADAPTER.fetch(r)).json()}};it.add(WP);const XP={extension:{type:K.LoadParser,priority:Cr.Low},test(r){return me.extname(r).toLowerCase()===".txt"},async load(r){return await(await Z.ADAPTER.fetch(r)).text()}};it.add(XP);const zP=["normal","bold","100","200","300","400","500","600","700","800","900"],VP=[".ttf",".otf",".woff",".woff2"],YP=["font/ttf","font/otf","font/woff","font/woff2"];function jP(r){const t=me.extname(r);return me.basename(r,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ")}const qP={extension:{type:K.LoadParser,priority:Cr.Low},test(r){return Sm(r,YP)||va(r,VP)},async load(r,t){var n,i,o;if(!globalThis.navigator.onLine)throw new Error("[loadWebFont] Cannot load font - navigator is offline");const e=Z.ADAPTER.getFontFaceSet();if(e){const l=[],h=((n=t.data)==null?void 0:n.family)??jP(r),c=((o=(i=t.data)==null?void 0:i.weights)==null?void 0:o.filter(d=>zP.includes(d)))??["normal"],f=t.data??{};for(let d=0;d<c.length;d++){const m=c[d],g=new FontFace(h,`url(${encodeURI(r)})`,{...f,weight:m});await g.load(),e.add(g),l.push(g)}return l.length===1?l[0]:l}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(r){(Array.isArray(r)?r:[r]).forEach(t=>Z.ADAPTER.getFontFaceSet().delete(t))}};it.add(qP);let Cp=0,xh;const KP="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",ZP={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${KP}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},JP={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let bh;class QP{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([ZP.code],{type:"application/javascript"})),n=new Worker(e);n.addEventListener("message",i=>{n.terminate(),URL.revokeObjectURL(e),t(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){xh===void 0&&(xh=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<xh&&(bh||(bh=URL.createObjectURL(new Blob([JP.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(bh),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const n=new Promise((i,o)=>{this.queue.push({id:t,arguments:e,resolve:i,reject:o})});return this.next(),n}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),n=e.id;this.resolveHash[Cp]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Cp++,id:n})}}const Ip=new QP;function xa(r,t,e){const n=new nt(r);return n.baseTexture.on("dispose",()=>{delete t.promiseCache[e]}),n}const tM=[".jpeg",".jpg",".png",".webp",".avif"],eM=["image/jpeg","image/png","image/webp","image/avif"];async function rM(r){const t=await Z.ADAPTER.fetch(r);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${r}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const Es={extension:{type:K.LoadParser,priority:Cr.High},config:{preferWorkers:!0},test(r){return Sm(r,eM)||va(r,tM)},async load(r,t,e){let n=null;globalThis.createImageBitmap?this.config.preferWorkers&&await Ip.isImageBitmapSupported()?n=await Ip.loadImageBitmap(r):n=await rM(r):n=await new Promise(o=>{n=new Image,n.crossOrigin="anonymous",n.src=r,n.complete?o(n):n.onload=()=>{o(n)}});const i=new pt(n,{resolution:an(r),...t.data});return i.resource.src=r,xa(i,e,r)},unload(r){r.destroy(!0)}};it.add(Es);const nM={extension:{type:K.LoadParser,priority:Cr.High},test(r){return me.extname(r).toLowerCase()===".svg"},async testParse(r){return ws.test(r)},async parse(r,t,e){var l,h,c;const n=new ws(r,(l=t==null?void 0:t.data)==null?void 0:l.resourceOptions),i=new pt(n,{resolution:an(r),...t==null?void 0:t.data});i.resource.src=r;const o=xa(i,e,r);return(c=(h=t==null?void 0:t.data)==null?void 0:h.resourceOptions)!=null&&c.autoLoad||await n.load(),o},async load(r,t){return(await Z.ADAPTER.fetch(r)).text()},unload:Es.unload};it.add(nM);class iM{constructor(){this._bundleIdConnector="-",this._createBundleAssetId=(t,e)=>`${t}${this._bundleIdConnector}${e}`,this._extractAssetIdFromBundle=(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,""),this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this._preferredOrder=[],this._resolverHash={},this._assetMap={},this._rootPath=null,this._basePath=null,this._manifest=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const n=[];Array.isArray(e)?e.forEach(i=>{if(typeof i.name=="string"){const o=this._createBundleAssetId(t,i.name);n.push(o),this.add([i.name,o],i.srcs)}else{const o=i.name.map(l=>this._createBundleAssetId(t,l));o.forEach(l=>{n.push(l)}),this.add([...i.name,...o],i.srcs)}}):Object.keys(e).forEach(i=>{n.push(this._createBundleAssetId(t,i)),this.add([i,this._createBundleAssetId(t,i)],e[i])}),this._bundles[t]=n}add(t,e,n){const i=$r(t);i.forEach(l=>{this._assetMap[l]&&console.warn(`[Resolver] already has key: ${l} overwriting`)}),Array.isArray(e)||(typeof e=="string"?e=GP(e):e=[e]);const o=e.map(l=>{let h=l;if(typeof l=="string"){let c=!1;for(let f=0;f<this._parsers.length;f++){const d=this._parsers[f];if(d.test(l)){h=d.parse(l),c=!0;break}}c||(h={src:l})}return h.format||(h.format=h.src.split(".").pop()),h.alias||(h.alias=i),(this._basePath||this._rootPath)&&(h.src=me.toAbsolute(h.src,this._basePath,this._rootPath)),h.src=this._appendDefaultSearchParams(h.src),h.data=h.data??n,h});i.forEach(l=>{this._assetMap[l]=o})}resolveBundle(t){const e=ha(t);t=$r(t);const n={};return t.forEach(i=>{const o=this._bundles[i];if(o){const l=this.resolve(o),h={};for(const c in l){const f=l[c];h[this._extractAssetIdFromBundle(i,c)]=f}n[i]=h}}),e?n[t[0]]:n}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const n={};for(const i in e)n[i]=e[i].src;return n}return e.src}resolve(t){const e=ha(t);t=$r(t);const n={};return t.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let o=this._assetMap[i];const l=this._getPreferredOrder(o),h=o[0];l==null||l.priority.forEach(c=>{l.params[c].forEach(f=>{const d=o.filter(m=>m[c]?m[c]===f:!1);d.length&&(o=d)})}),this._resolverHash[i]=o[0]??h}else{let o=i;(this._basePath||this._rootPath)&&(o=me.toAbsolute(o,this._basePath,this._rootPath)),o=this._appendDefaultSearchParams(o),this._resolverHash[i]={src:o}}n[i]=this._resolverHash[i]}),e?n[t[0]]:n}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const n=t[0],i=this._preferredOrder.find(o=>o.params.format.includes(n.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}}class sM{constructor(){this._detections=[],this._initialized=!1,this.resolver=new iM,this.loader=new $P,this.cache=as,this._backgroundLoader=new kP(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var o,l,h;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let c=t.manifest;typeof c=="string"&&(c=await this.load(c)),this.resolver.addManifest(c)}const e=((o=t.texturePreference)==null?void 0:o.resolution)??1,n=typeof e=="number"?[e]:e;let i=[];if((l=t.texturePreference)!=null&&l.format){const c=(h=t.texturePreference)==null?void 0:h.format;i=typeof c=="string"?[c]:c;for(const f of this._detections)await f.test()||(i=await f.remove(i))}else for(const c of this._detections)await c.test()&&(i=await c.add(i));this.resolver.prefer({params:{format:i,resolution:n}})}add(t,e,n){this.resolver.add(t,e,n)}async load(t,e){this._initialized||await this.init();const n=ha(t),i=$r(t).map(h=>typeof h!="string"?(this.resolver.add(h.src,h),h.src):h),o=this.resolver.resolve(i),l=await this._mapLoadToResolve(o,e);return n?l[i[0]]:l}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let n=!1;typeof t=="string"&&(n=!0,t=[t]);const i=this.resolver.resolveBundle(t),o={},l=Object.keys(i);let h=0,c=0;const f=()=>{e==null||e(++h/c)},d=l.map(m=>{const g=i[m];return c+=Object.keys(g).length,this._mapLoadToResolve(g,f).then(y=>{o[m]=y})});return await Promise.all(d),n?o[t[0]]:o}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return as.get(t);const e={};for(let n=0;n<t.length;n++)e[n]=as.get(t[n]);return e}async _mapLoadToResolve(t,e){const n=Object.values(t),i=Object.keys(t);this._backgroundLoader.active=!1;const o=await this.loader.load(n,e);this._backgroundLoader.active=!0;const l={};return n.forEach((h,c)=>{const f=o[h.src],d=[h.src];h.alias&&d.push(...h.alias),l[i[c]]=f,as.set(d,f)}),l}async unload(t){this._initialized||await this.init();const e=$r(t).map(i=>typeof i!="string"?i.src:i),n=this.resolver.resolve(e);await this._unloadFromResolved(n)}async unloadBundle(t){this._initialized||await this.init(),t=$r(t);const e=this.resolver.resolveBundle(t),n=Object.keys(e).map(i=>this._unloadFromResolved(e[i]));await Promise.all(n)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(n=>{as.remove(n.src)}),await this.loader.unload(e)}get detections(){return this._detections}get preferWorkers(){return Es.config.preferWorkers}set preferWorkers(t){Es.config.preferWorkers=t}}const Dn=new sM;it.handleByList(K.LoadParser,Dn.loader.parsers).handleByList(K.ResolveParser,Dn.resolver.parsers).handleByList(K.CacheParser,Dn.cache.parsers).handleByList(K.DetectionParser,Dn.detections);const oM={extension:K.CacheParser,test:r=>Array.isArray(r)&&r.every(t=>t instanceof nt),getCacheableAssets:(r,t)=>{const e={};return r.forEach(n=>{t.forEach((i,o)=>{e[n+(o===0?"":o+1)]=i})}),e}};it.add(oM);const aM={extension:{type:K.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const t=await Z.ADAPTER.fetch("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=").then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async r=>[...r,"avif"],remove:async r=>r.filter(t=>t!=="avif")};it.add(aM);const lM={extension:{type:K.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const t=await Z.ADAPTER.fetch("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=").then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async r=>[...r,"webp"],remove:async r=>r.filter(t=>t!=="webp")};it.add(lM);const Rp=["png","jpg","jpeg"],hM={extension:{type:K.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async r=>[...r,...Rp],remove:async r=>r.filter(t=>!Rp.includes(t))};it.add(hM);const uM={extension:K.ResolveParser,test:Es.test,parse:r=>{var t;return{resolution:parseFloat(((t=Z.RETINA_PREFIX.exec(r))==null?void 0:t[1])??"1"),format:r.split(".").pop(),src:r}}};it.add(uM);var Ue=(r=>(r[r.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",r[r.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",r[r.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",r[r.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",r[r.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",r[r.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",r[r.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",r[r.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",r[r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",r[r.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",r[r.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",r[r.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",r))(Ue||{});const ua={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let Ur,di;function Pp(){di={s3tc:Ur.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Ur.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Ur.getExtension("WEBGL_compressed_texture_etc"),etc1:Ur.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Ur.getExtension("WEBGL_compressed_texture_pvrtc")||Ur.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Ur.getExtension("WEBGL_compressed_texture_atc"),astc:Ur.getExtension("WEBGL_compressed_texture_astc")}}const cM={extension:{type:K.DetectionParser,priority:2},test:async()=>{const t=Z.ADAPTER.createCanvas().getContext("webgl");return t?(Ur=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async r=>{di||Pp();const t=[];for(const e in di)di[e]&&t.push(e);return[...t,...r]},remove:async r=>(di||Pp(),r.filter(t=>!(t in di)))};it.add(cM);class fM extends Cs{constructor(t,e={width:1,height:1,autoLoad:!0}){let n,i;typeof t=="string"?(n=t,i=new Uint8Array):(n=null,i=t),super(i,e),this.origin=n,this.buffer=i?new Yh(i):null,this.origin&&e.autoLoad!==!1&&this.load(),i!=null&&i.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}async load(){const n=await(await(await fetch(this.origin)).blob()).arrayBuffer();return this.data=new Uint32Array(n),this.buffer=new Yh(n),this.loaded=!0,this.onBlobLoaded(n),this.update(),this}}class Nn extends fM{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=Nn._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||Nn._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,n){const i=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let l=0,h=this.levels;l<h;l++){const{levelID:c,levelWidth:f,levelHeight:d,levelBuffer:m}=this._levelBuffers[l];i.compressedTexImage2D(i.TEXTURE_2D,c,this.format,f,d,0,m)}return!0}onBlobLoaded(){this._levelBuffers=Nn._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,n,i,o,l,h){const c=new Array(n);let f=t.byteOffset,d=l,m=h,g=d+i-1&~(i-1),y=m+o-1&~(o-1),v=g*y*ua[e];for(let T=0;T<n;T++)c[T]={levelID:T,levelWidth:n>1?d:g,levelHeight:n>1?m:y,levelBuffer:new Uint8Array(t.buffer,f,v)},f+=v,d=d>>1||1,m=m>>1||1,g=d+i-1&~(i-1),y=m+o-1&~(o-1),v=g*y*ua[e];return c}}const wh=4,Fo=124,dM=32,Mp=20,pM=542327876,Lo={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},gM={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},No={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},mM=1,_M=2,yM=4,vM=64,xM=512,bM=131072,wM=827611204,EM=861165636,TM=894720068,AM=808540228,SM=4,CM={[wM]:Ue.COMPRESSED_RGBA_S3TC_DXT1_EXT,[EM]:Ue.COMPRESSED_RGBA_S3TC_DXT3_EXT,[TM]:Ue.COMPRESSED_RGBA_S3TC_DXT5_EXT},IM={70:Ue.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Ue.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Ue.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Ue.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Ue.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Ue.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Ue.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Ue.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Ue.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function RM(r){const t=new Uint32Array(r);if(t[0]!==pM)throw new Error("Invalid DDS file magic word");const n=new Uint32Array(r,0,Fo/Uint32Array.BYTES_PER_ELEMENT),i=n[Lo.HEIGHT],o=n[Lo.WIDTH],l=n[Lo.MIPMAP_COUNT],h=new Uint32Array(r,Lo.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,dM/Uint32Array.BYTES_PER_ELEMENT),c=h[mM];if(c&yM){const f=h[gM.FOURCC];if(f!==AM){const w=CM[f],R=wh+Fo,O=new Uint8Array(r,R);return[new Nn(O,{format:w,width:o,height:i,levels:l})]}const d=wh+Fo,m=new Uint32Array(t.buffer,d,Mp/Uint32Array.BYTES_PER_ELEMENT),g=m[No.DXGI_FORMAT],y=m[No.RESOURCE_DIMENSION],v=m[No.MISC_FLAG],T=m[No.ARRAY_SIZE],E=IM[g];if(E===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${g}`);if(v===SM)throw new Error("DDSParser does not support cubemap textures");if(y===6)throw new Error("DDSParser does not supported 3D texture data");const I=new Array,P=wh+Fo+Mp;if(T===1)I.push(new Uint8Array(r,P));else{const w=ua[E];let R=0,O=o,W=i;for(let U=0;U<l;U++){const Y=Math.max(1,O+3&-4),J=Math.max(1,W+3&-4),z=Y*J*w;R+=z,O=O>>>1,W=W>>>1}let k=P;for(let U=0;U<T;U++)I.push(new Uint8Array(r,k,R)),k+=R}return I.map(w=>new Nn(w,{format:E,width:o,height:i,levels:l}))}throw c&vM?new Error("DDSParser does not support uncompressed texture data."):c&xM?new Error("DDSParser does not supported YUV uncompressed texture data."):c&bM?new Error("DDSParser does not support single-channel (lumninance) texture data!"):c&_M?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Dp=[171,75,84,88,32,49,49,187,13,10,26,10],PM=67305985,er={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},au=64,Bp={[st.UNSIGNED_BYTE]:1,[st.UNSIGNED_SHORT]:2,[st.INT]:4,[st.UNSIGNED_INT]:4,[st.FLOAT]:4,[st.HALF_FLOAT]:8},MM={[X.RGBA]:4,[X.RGB]:3,[X.RG]:2,[X.RED]:1,[X.LUMINANCE]:1,[X.LUMINANCE_ALPHA]:2,[X.ALPHA]:1},DM={[st.UNSIGNED_SHORT_4_4_4_4]:2,[st.UNSIGNED_SHORT_5_5_5_1]:2,[st.UNSIGNED_SHORT_5_6_5]:2};function BM(r,t,e=!1){const n=new DataView(t);if(!OM(r,n))return null;const i=n.getUint32(er.ENDIANNESS,!0)===PM,o=n.getUint32(er.GL_TYPE,i),l=n.getUint32(er.GL_FORMAT,i),h=n.getUint32(er.GL_INTERNAL_FORMAT,i),c=n.getUint32(er.PIXEL_WIDTH,i),f=n.getUint32(er.PIXEL_HEIGHT,i)||1,d=n.getUint32(er.PIXEL_DEPTH,i)||1,m=n.getUint32(er.NUMBER_OF_ARRAY_ELEMENTS,i)||1,g=n.getUint32(er.NUMBER_OF_FACES,i),y=n.getUint32(er.NUMBER_OF_MIPMAP_LEVELS,i),v=n.getUint32(er.BYTES_OF_KEY_VALUE_DATA,i);if(f===0||d!==1)throw new Error("Only 2D textures are supported");if(g!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(m!==1)throw new Error("WebGL does not support array textures");const T=4,E=4,I=c+3&-4,P=f+3&-4,w=new Array(m);let R=c*f;o===0&&(R=I*P);let O;if(o!==0?Bp[o]?O=Bp[o]*MM[l]:O=DM[o]:O=ua[h],O===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const W=e?LM(n,v,i):null;let U=R*O,Y=c,J=f,z=I,q=P,G=au+v;for(let F=0;F<y;F++){const at=n.getUint32(G,i);let ft=G+4;for(let V=0;V<m;V++){let _t=w[V];_t||(_t=w[V]=new Array(y)),_t[F]={levelID:F,levelWidth:y>1||o!==0?Y:z,levelHeight:y>1||o!==0?J:q,levelBuffer:new Uint8Array(t,ft,U)},ft+=U}G+=at+4,G=G%4!==0?G+4-G%4:G,Y=Y>>1||1,J=J>>1||1,z=Y+T-1&~(T-1),q=J+E-1&~(E-1),U=z*q*O}return o!==0?{uncompressed:w.map(F=>{let at=F[0].levelBuffer,ft=!1;return o===st.FLOAT?at=new Float32Array(F[0].levelBuffer.buffer,F[0].levelBuffer.byteOffset,F[0].levelBuffer.byteLength/4):o===st.UNSIGNED_INT?(ft=!0,at=new Uint32Array(F[0].levelBuffer.buffer,F[0].levelBuffer.byteOffset,F[0].levelBuffer.byteLength/4)):o===st.INT&&(ft=!0,at=new Int32Array(F[0].levelBuffer.buffer,F[0].levelBuffer.byteOffset,F[0].levelBuffer.byteLength/4)),{resource:new Cs(at,{width:F[0].levelWidth,height:F[0].levelHeight}),type:o,format:ft?FM(l):l}}),kvData:W}:{compressed:w.map(F=>new Nn(null,{format:h,width:c,height:f,levels:y,levelBuffers:F})),kvData:W}}function OM(r,t){for(let e=0;e<Dp.length;e++)if(t.getUint8(e)!==Dp[e])return console.error(`${r} is not a valid *.ktx file!`),!1;return!0}function FM(r){switch(r){case X.RGBA:return X.RGBA_INTEGER;case X.RGB:return X.RGB_INTEGER;case X.RG:return X.RG_INTEGER;case X.RED:return X.RED_INTEGER;default:return r}}function LM(r,t,e){const n=new Map;let i=0;for(;i<t;){const o=r.getUint32(au+i,e),l=au+i+4,h=3-(o+3)%4;if(o===0||o>t-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let c=0;for(;c<o&&r.getUint8(l+c)!==0;c++);if(c===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const f=new TextDecoder().decode(new Uint8Array(r.buffer,l,c)),d=new DataView(r.buffer,l+c+1,o-c-1);n.set(f,d),i+=4+o+h}return n}const NM={extension:{type:K.LoadParser,priority:Cr.High},test(r){return va(r,".dds")},async load(r,t,e){const i=await(await Z.ADAPTER.fetch(r)).arrayBuffer(),l=RM(i).map(h=>{const c=new pt(h,{mipmap:Sr.OFF,alphaMode:cr.NO_PREMULTIPLIED_ALPHA,resolution:an(r),...t.data});return xa(c,e,r)});return l.length===1?l[0]:l},unload(r){Array.isArray(r)?r.forEach(t=>t.destroy(!0)):r.destroy(!0)}};it.add(NM);const UM={extension:{type:K.LoadParser,priority:Cr.High},test(r){return va(r,".ktx")},async load(r,t,e){const i=await(await Z.ADAPTER.fetch(r)).arrayBuffer(),{compressed:o,uncompressed:l,kvData:h}=BM(r,i),c=o??l,f={mipmap:Sr.OFF,alphaMode:cr.NO_PREMULTIPLIED_ALPHA,resolution:an(r),...t.data},d=c.map(m=>{c===l&&Object.assign(f,{type:m.type,format:m.format});const g=new pt(m,f);return g.ktxKeyValueData=h,xa(g,e,r)});return d.length===1?d[0]:d},unload(r){Array.isArray(r)?r.forEach(t=>t.destroy(!0)):r.destroy(!0)}};it.add(UM);const kM={extension:K.ResolveParser,test:r=>{const e=r.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(e)},parse:r=>{var n,i;if(r.split("?")[0].split(".").pop()==="ktx"){const o=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(o.some(l=>r.endsWith(l)))return{resolution:parseFloat(((n=Z.RETINA_PREFIX.exec(r))==null?void 0:n[1])??"1"),format:o.find(l=>r.endsWith(l)),src:r}}return{resolution:parseFloat(((i=Z.RETINA_PREFIX.exec(r))==null?void 0:i[1])??"1"),format:r.split(".").pop(),src:r}}};it.add(kM);const Op=new Et,Fp=4,lu=class{constructor(r){this.renderer=r}async image(r,t,e){const n=new Image;return n.src=await this.base64(r,t,e),n}async base64(r,t,e){const n=this.canvas(r);if(n.toDataURL!==void 0)return n.toDataURL(t,e);if(n.convertToBlob!==void 0){const i=await n.convertToBlob({type:t,quality:e});return await new Promise(o=>{const l=new FileReader;l.onload=()=>o(l.result),l.readAsDataURL(i)})}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(r,t){const e=this.renderer;let n,i=!1,o,l=!1;r&&(r instanceof un?o=r:(o=this.renderer.generateTexture(r),l=!0)),o?(n=o.baseTexture.resolution,t=t??o.frame,i=!1,e.renderTexture.bind(o)):(n=e.resolution,t||(t=Op,t.width=e.width,t.height=e.height),i=!0,e.renderTexture.bind(null));const h=Math.round(t.width*n),c=Math.round(t.height*n);let f=new hp(h,c,1);const d=new Uint8Array(Fp*h*c),m=e.gl;m.readPixels(Math.round(t.x*n),Math.round(t.y*n),h,c,m.RGBA,m.UNSIGNED_BYTE,d);const g=f.context.getImageData(0,0,h,c);if(lu.arrayPostDivide(d,g.data),f.context.putImageData(g,0,0),i){const y=new hp(f.width,f.height,1);y.context.scale(1,-1),y.context.drawImage(f.canvas,0,-c),f.destroy(),f=y}return l&&o.destroy(!0),f.canvas}pixels(r,t){const e=this.renderer;let n,i,o=!1;r&&(r instanceof un?i=r:(i=this.renderer.generateTexture(r),o=!0)),i?(n=i.baseTexture.resolution,t=t??i.frame,e.renderTexture.bind(i)):(n=e.resolution,t||(t=Op,t.width=e.width,t.height=e.height),e.renderTexture.bind(null));const l=Math.round(t.width*n),h=Math.round(t.height*n),c=new Uint8Array(Fp*l*h),f=e.gl;return f.readPixels(Math.round(t.x*n),Math.round(t.y*n),l,h,f.RGBA,f.UNSIGNED_BYTE,c),o&&i.destroy(!0),lu.arrayPostDivide(c,c),c}destroy(){this.renderer=null}static arrayPostDivide(r,t){for(let e=0;e<r.length;e+=4){const n=t[e+3]=r[e+3];n!==0?(t[e]=Math.round(Math.min(r[e]*255/n,255)),t[e+1]=Math.round(Math.min(r[e+1]*255/n,255)),t[e+2]=Math.round(Math.min(r[e+2]*255/n,255))):(t[e]=r[e],t[e+1]=r[e+1],t[e+2]=r[e+2])}}};let Im=lu;Im.extension={name:"extract",type:K.RendererSystem};it.add(Im);const ca={build(r){const t=r.points;let e,n,i,o,l,h;if(r.type===ge.CIRC){const v=r.shape;e=v.x,n=v.y,l=h=v.radius,i=o=0}else if(r.type===ge.ELIP){const v=r.shape;e=v.x,n=v.y,l=v.width,h=v.height,i=o=0}else{const v=r.shape,T=v.width/2,E=v.height/2;e=v.x+T,n=v.y+E,l=h=Math.max(0,Math.min(v.radius,Math.min(T,E))),i=T-l,o=E-h}if(!(l>=0&&h>=0&&i>=0&&o>=0)){t.length=0;return}const c=Math.ceil(2.3*Math.sqrt(l+h)),f=c*8+(i?4:0)+(o?4:0);if(t.length=f,f===0)return;if(c===0){t.length=8,t[0]=t[6]=e+i,t[1]=t[3]=n+o,t[2]=t[4]=e-i,t[5]=t[7]=n-o;return}let d=0,m=c*4+(i?2:0)+2,g=m,y=f;{const v=i+l,T=o,E=e+v,I=e-v,P=n+T;if(t[d++]=E,t[d++]=P,t[--m]=P,t[--m]=I,o){const w=n-T;t[g++]=I,t[g++]=w,t[--y]=w,t[--y]=E}}for(let v=1;v<c;v++){const T=Math.PI/2*(v/c),E=i+Math.cos(T)*l,I=o+Math.sin(T)*h,P=e+E,w=e-E,R=n+I,O=n-I;t[d++]=P,t[d++]=R,t[--m]=R,t[--m]=w,t[g++]=w,t[g++]=O,t[--y]=O,t[--y]=P}{const v=i,T=o+h,E=e+v,I=e-v,P=n+T,w=n-T;t[d++]=E,t[d++]=P,t[--y]=w,t[--y]=E,i&&(t[d++]=I,t[d++]=P,t[--y]=w,t[--y]=I)}},triangulate(r,t){const e=r.points,n=t.points,i=t.indices;if(e.length===0)return;let o=n.length/2;const l=o;let h,c;if(r.type!==ge.RREC){const d=r.shape;h=d.x,c=d.y}else{const d=r.shape;h=d.x+d.width/2,c=d.y+d.height/2}const f=r.matrix;n.push(r.matrix?f.a*h+f.c*c+f.tx:h,r.matrix?f.b*h+f.d*c+f.ty:c),o++,n.push(e[0],e[1]);for(let d=2;d<e.length;d+=2)n.push(e[d],e[d+1]),i.push(o++,l,o);i.push(l+1,l,o)}};function Lp(r,t=!1){const e=r.length;if(e<6)return;let n=0;for(let i=0,o=r[e-2],l=r[e-1];i<e;i+=2){const h=r[i],c=r[i+1];n+=(h-o)*(c+l),o=h,l=c}if(!t&&n>0||t&&n<=0){const i=e/2;for(let o=i+i%2;o<e;o+=2){const l=e-o-2,h=e-o-1,c=o,f=o+1;[r[l],r[c]]=[r[c],r[l]],[r[h],r[f]]=[r[f],r[h]]}}}const Rm={build(r){r.points=r.shape.points.slice()},triangulate(r,t){let e=r.points;const n=r.holes,i=t.points,o=t.indices;if(e.length>=6){Lp(e,!1);const l=[];for(let f=0;f<n.length;f++){const d=n[f];Lp(d.points,!0),l.push(e.length/2),e=e.concat(d.points)}const h=fE(e,l,2);if(!h)return;const c=i.length/2;for(let f=0;f<h.length;f+=3)o.push(h[f]+c),o.push(h[f+1]+c),o.push(h[f+2]+c);for(let f=0;f<e.length;f++)i.push(e[f])}}},GM={build(r){const t=r.shape,e=t.x,n=t.y,i=t.width,o=t.height,l=r.points;l.length=0,i>=0&&o>=0&&l.push(e,n,e+i,n,e+i,n+o,e,n+o)},triangulate(r,t){const e=r.points,n=t.points;if(e.length===0)return;const i=n.length/2;n.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},HM={build(r){ca.build(r)},triangulate(r,t){ca.triangulate(r,t)}};var rn=(r=>(r.MITER="miter",r.BEVEL="bevel",r.ROUND="round",r))(rn||{}),Bn=(r=>(r.BUTT="butt",r.ROUND="round",r.SQUARE="square",r))(Bn||{});const Pi={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(r,t=20){if(!this.adaptive||!r||isNaN(r))return t;let e=Math.ceil(r/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class Np{static curveTo(t,e,n,i,o,l){const h=l[l.length-2],f=l[l.length-1]-e,d=h-t,m=i-e,g=n-t,y=Math.abs(f*g-d*m);if(y<1e-8||o===0)return(l[l.length-2]!==t||l[l.length-1]!==e)&&l.push(t,e),null;const v=f*f+d*d,T=m*m+g*g,E=f*m+d*g,I=o*Math.sqrt(v)/y,P=o*Math.sqrt(T)/y,w=I*E/v,R=P*E/T,O=I*g+P*d,W=I*m+P*f,k=d*(P+w),U=f*(P+w),Y=g*(I+R),J=m*(I+R),z=Math.atan2(U-W,k-O),q=Math.atan2(J-W,Y-O);return{cx:O+t,cy:W+e,radius:o,startAngle:z,endAngle:q,anticlockwise:d*m>g*f}}static arc(t,e,n,i,o,l,h,c,f){const d=h-l,m=Pi._segmentsCount(Math.abs(d)*o,Math.ceil(Math.abs(d)/oa)*40),g=d/(m*2),y=g*2,v=Math.cos(g),T=Math.sin(g),E=m-1,I=E%1/E;for(let P=0;P<=E;++P){const w=P+I*P,R=g+l+y*w,O=Math.cos(R),W=-Math.sin(R);f.push((v*O+T*W)*o+n,(v*-W+T*O)*o+i)}}}class $M{constructor(){this.reset()}begin(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Uu{static curveLength(t,e,n,i,o,l,h,c){let d=0,m=0,g=0,y=0,v=0,T=0,E=0,I=0,P=0,w=0,R=0,O=t,W=e;for(let k=1;k<=10;++k)m=k/10,g=m*m,y=g*m,v=1-m,T=v*v,E=T*v,I=E*t+3*T*m*n+3*v*g*o+y*h,P=E*e+3*T*m*i+3*v*g*l+y*c,w=O-I,R=W-P,O=I,W=P,d+=Math.sqrt(w*w+R*R);return d}static curveTo(t,e,n,i,o,l,h){const c=h[h.length-2],f=h[h.length-1];h.length-=2;const d=Pi._segmentsCount(Uu.curveLength(c,f,t,e,n,i,o,l));let m=0,g=0,y=0,v=0,T=0;h.push(c,f);for(let E=1,I=0;E<=d;++E)I=E/d,m=1-I,g=m*m,y=g*m,v=I*I,T=v*I,h.push(y*c+3*g*I*t+3*m*v*n+T*o,y*f+3*g*I*e+3*m*v*i+T*l)}}function Up(r,t,e,n,i,o,l,h){const c=r-e*i,f=t-n*i,d=r+e*o,m=t+n*o;let g,y;l?(g=n,y=-e):(g=-n,y=e);const v=c+g,T=f+y,E=d+g,I=m+y;return h.push(v,T),h.push(E,I),2}function Tn(r,t,e,n,i,o,l,h){const c=e-r,f=n-t;let d=Math.atan2(c,f),m=Math.atan2(i-r,o-t);h&&d<m?d+=Math.PI*2:!h&&d>m&&(m+=Math.PI*2);let g=d;const y=m-d,v=Math.abs(y),T=Math.sqrt(c*c+f*f),E=(15*v*Math.sqrt(T)/Math.PI>>0)+1,I=y/E;if(g+=I,h){l.push(r,t),l.push(e,n);for(let P=1,w=g;P<E;P++,w+=I)l.push(r,t),l.push(r+Math.sin(w)*T,t+Math.cos(w)*T);l.push(r,t),l.push(i,o)}else{l.push(e,n),l.push(r,t);for(let P=1,w=g;P<E;P++,w+=I)l.push(r+Math.sin(w)*T,t+Math.cos(w)*T),l.push(r,t);l.push(i,o),l.push(r,t)}return E*2}function WM(r,t){const e=r.shape;let n=r.points||e.points.slice();const i=t.closePointEps;if(n.length===0)return;const o=r.lineStyle,l=new At(n[0],n[1]),h=new At(n[n.length-2],n[n.length-1]),c=e.type!==ge.POLY||e.closeStroke,f=Math.abs(l.x-h.x)<i&&Math.abs(l.y-h.y)<i;if(c){n=n.slice(),f&&(n.pop(),n.pop(),h.set(n[n.length-2],n[n.length-1]));const V=(l.x+h.x)*.5,_t=(h.y+l.y)*.5;n.unshift(V,_t),n.push(V,_t)}const d=t.points,m=n.length/2;let g=n.length;const y=d.length/2,v=o.width/2,T=v*v,E=o.miterLimit*o.miterLimit;let I=n[0],P=n[1],w=n[2],R=n[3],O=0,W=0,k=-(P-R),U=I-w,Y=0,J=0,z=Math.sqrt(k*k+U*U);k/=z,U/=z,k*=v,U*=v;const q=o.alignment,G=(1-q)*2,F=q*2;c||(o.cap===Bn.ROUND?g+=Tn(I-k*(G-F)*.5,P-U*(G-F)*.5,I-k*G,P-U*G,I+k*F,P+U*F,d,!0)+2:o.cap===Bn.SQUARE&&(g+=Up(I,P,k,U,G,F,!0,d))),d.push(I-k*G,P-U*G),d.push(I+k*F,P+U*F);for(let V=1;V<m-1;++V){I=n[(V-1)*2],P=n[(V-1)*2+1],w=n[V*2],R=n[V*2+1],O=n[(V+1)*2],W=n[(V+1)*2+1],k=-(P-R),U=I-w,z=Math.sqrt(k*k+U*U),k/=z,U/=z,k*=v,U*=v,Y=-(R-W),J=w-O,z=Math.sqrt(Y*Y+J*J),Y/=z,J/=z,Y*=v,J*=v;const _t=w-I,Ot=P-R,$=w-O,rt=W-R,xt=_t*$+Ot*rt,It=Ot*$-rt*_t,Pt=It<0;if(Math.abs(It)<.001*Math.abs(xt)){d.push(w-k*G,R-U*G),d.push(w+k*F,R+U*F),xt>=0&&(o.join===rn.ROUND?g+=Tn(w,R,w-k*G,R-U*G,w-Y*G,R-J*G,d,!1)+4:g+=2,d.push(w-Y*F,R-J*F),d.push(w+Y*G,R+J*G));continue}const Nt=(-k+I)*(-U+R)-(-k+w)*(-U+P),Ut=(-Y+O)*(-J+R)-(-Y+w)*(-J+W),re=(_t*Ut-$*Nt)/It,Yt=(rt*Nt-Ot*Ut)/It,ne=(re-w)*(re-w)+(Yt-R)*(Yt-R),se=w+(re-w)*G,Mt=R+(Yt-R)*G,kt=w-(re-w)*F,jt=R-(Yt-R)*F,qt=Math.min(_t*_t+Ot*Ot,$*$+rt*rt),_e=Pt?G:F,fn=qt+_e*_e*T;ne<=fn?o.join===rn.BEVEL||ne/T>E?(Pt?(d.push(se,Mt),d.push(w+k*F,R+U*F),d.push(se,Mt),d.push(w+Y*F,R+J*F)):(d.push(w-k*G,R-U*G),d.push(kt,jt),d.push(w-Y*G,R-J*G),d.push(kt,jt)),g+=2):o.join===rn.ROUND?Pt?(d.push(se,Mt),d.push(w+k*F,R+U*F),g+=Tn(w,R,w+k*F,R+U*F,w+Y*F,R+J*F,d,!0)+4,d.push(se,Mt),d.push(w+Y*F,R+J*F)):(d.push(w-k*G,R-U*G),d.push(kt,jt),g+=Tn(w,R,w-k*G,R-U*G,w-Y*G,R-J*G,d,!1)+4,d.push(w-Y*G,R-J*G),d.push(kt,jt)):(d.push(se,Mt),d.push(kt,jt)):(d.push(w-k*G,R-U*G),d.push(w+k*F,R+U*F),o.join===rn.ROUND?Pt?g+=Tn(w,R,w+k*F,R+U*F,w+Y*F,R+J*F,d,!0)+2:g+=Tn(w,R,w-k*G,R-U*G,w-Y*G,R-J*G,d,!1)+2:o.join===rn.MITER&&ne/T<=E&&(Pt?(d.push(kt,jt),d.push(kt,jt)):(d.push(se,Mt),d.push(se,Mt)),g+=2),d.push(w-Y*G,R-J*G),d.push(w+Y*F,R+J*F),g+=2)}I=n[(m-2)*2],P=n[(m-2)*2+1],w=n[(m-1)*2],R=n[(m-1)*2+1],k=-(P-R),U=I-w,z=Math.sqrt(k*k+U*U),k/=z,U/=z,k*=v,U*=v,d.push(w-k*G,R-U*G),d.push(w+k*F,R+U*F),c||(o.cap===Bn.ROUND?g+=Tn(w-k*(G-F)*.5,R-U*(G-F)*.5,w-k*G,R-U*G,w+k*F,R+U*F,d,!1)+2:o.cap===Bn.SQUARE&&(g+=Up(w,R,k,U,G,F,!1,d)));const at=t.indices,ft=Pi.epsilon*Pi.epsilon;for(let V=y;V<g+y-2;++V)I=d[V*2],P=d[V*2+1],w=d[(V+1)*2],R=d[(V+1)*2+1],O=d[(V+2)*2],W=d[(V+2)*2+1],!(Math.abs(I*(R-W)+w*(W-P)+O*(P-R))<ft)&&at.push(V,V+1,V+2)}function XM(r,t){let e=0;const n=r.shape,i=r.points||n.points,o=n.type!==ge.POLY||n.closeStroke;if(i.length===0)return;const l=t.points,h=t.indices,c=i.length/2,f=l.length/2;let d=f;for(l.push(i[0],i[1]),e=1;e<c;e++)l.push(i[e*2],i[e*2+1]),h.push(d,d+1),d++;o&&h.push(d,f)}function kp(r,t){r.lineStyle.native?XM(r,t):WM(r,t)}class ku{static curveLength(t,e,n,i,o,l){const h=t-2*n+o,c=e-2*i+l,f=2*n-2*t,d=2*i-2*e,m=4*(h*h+c*c),g=4*(h*f+c*d),y=f*f+d*d,v=2*Math.sqrt(m+g+y),T=Math.sqrt(m),E=2*m*T,I=2*Math.sqrt(y),P=g/T;return(E*v+T*g*(v-I)+(4*y*m-g*g)*Math.log((2*T+P+v)/(P+I)))/(4*E)}static curveTo(t,e,n,i,o){const l=o[o.length-2],h=o[o.length-1],c=Pi._segmentsCount(ku.curveLength(l,h,t,e,n,i));let f=0,d=0;for(let m=1;m<=c;++m){const g=m/c;f=l+(t-l)*g,d=h+(e-h)*g,o.push(f+(t+(n-t)*g-f)*g,d+(e+(i-e)*g-d)*g)}}}const Eh={[ge.POLY]:Rm,[ge.CIRC]:ca,[ge.ELIP]:ca,[ge.RECT]:GM,[ge.RREC]:HM},Gp=[],Uo=[];class fa{constructor(t,e=null,n=null,i=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=i,this.type=t.type}clone(){return new fa(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const hi=new At,Pm=class extends Og{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new aa,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let r=0;r<this.drawCalls.length;r++)this.drawCalls[r].texArray.clear(),Uo.push(this.drawCalls[r]);this.drawCalls.length=0;for(let r=0;r<this.batches.length;r++){const t=this.batches[r];t.reset(),Gp.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(r,t=null,e=null,n=null){const i=new fa(r,t,e,n);return this.graphicsData.push(i),this.dirty++,this}drawHole(r,t=null){if(!this.graphicsData.length)return null;const e=new fa(r,null,null,t),n=this.graphicsData[this.graphicsData.length-1];return e.lineStyle=n.lineStyle,n.holes.push(e),this.dirty++,this}destroy(){super.destroy();for(let r=0;r<this.graphicsData.length;++r)this.graphicsData[r].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(r){const t=this.graphicsData;for(let e=0;e<t.length;++e){const n=t[e];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(r,hi):hi.copyFrom(r),n.shape.contains(hi.x,hi.y))){let i=!1;if(n.holes){for(let o=0;o<n.holes.length;o++)if(n.holes[o].shape.contains(hi.x,hi.y)){i=!0;break}}if(!i)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const r=this.uvs,t=this.graphicsData;let e=null,n=null;this.batches.length>0&&(e=this.batches[this.batches.length-1],n=e.style);for(let h=this.shapeIndex;h<t.length;h++){this.shapeIndex++;const c=t[h],f=c.fillStyle,d=c.lineStyle;Eh[c.type].build(c),c.matrix&&this.transformPoints(c.points,c.matrix),(f.visible||d.visible)&&this.processHoles(c.holes);for(let g=0;g<2;g++){const y=g===0?f:d;if(!y.visible)continue;const v=y.texture.baseTexture,T=this.indices.length,E=this.points.length/2;v.wrapMode=on.REPEAT,g===0?this.processFill(c):this.processLine(c);const I=this.points.length/2-E;I!==0&&(e&&!this._compareStyles(n,y)&&(e.end(T,E),e=null),e||(e=Gp.pop()||new $M,e.begin(y,T,E),this.batches.push(e),n=y),this.addUvs(this.points,r,y.texture,E,I,y.matrix))}}const i=this.indices.length,o=this.points.length/2;if(e&&e.end(i,o),this.batches.length===0){this.batchable=!0;return}const l=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&l===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=l?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(r,t){return!(!r||!t||r.texture.baseTexture!==t.texture.baseTexture||r.color+r.alpha!==t.color+t.alpha||!!r.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let r=0,t=this.graphicsData.length;r<t;r++){const e=this.graphicsData[r],n=e.fillStyle,i=e.lineStyle;if(n&&!n.texture.baseTexture.valid||i&&!i.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const r=this.batches;for(let t=0,e=r.length;t<e;t++){const n=r[t];for(let i=0;i<n.size;i++){const o=n.start+i;this.indicesUint16[o]=this.indicesUint16[o]-n.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const r=this.batches;for(let t=0;t<r.length;t++)if(r[t].style.native)return!1;return this.points.length<Pm.BATCHABLE_SIZE*2}buildDrawCalls(){let r=++pt._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),Uo.push(this.drawCalls[d]);this.drawCalls.length=0;const t=this.colors,e=this.textureIds;let n=Uo.pop();n||(n=new qh,n.texArray=new Zh),n.texArray.count=0,n.start=0,n.size=0,n.type=Er.TRIANGLES;let i=0,o=null,l=0,h=!1,c=Er.TRIANGLES,f=0;this.drawCalls.push(n);for(let d=0;d<this.batches.length;d++){const m=this.batches[d],g=8,y=m.style,v=y.texture.baseTexture;h!==!!y.native&&(h=!!y.native,c=h?Er.LINES:Er.TRIANGLES,o=null,i=g,r++),o!==v&&(o=v,v._batchEnabled!==r&&(i===g&&(r++,i=0,n.size>0&&(n=Uo.pop(),n||(n=new qh,n.texArray=new Zh),this.drawCalls.push(n)),n.start=f,n.size=0,n.texArray.count=0,n.type=c),v.touched=1,v._batchEnabled=r,v._batchLocation=i,v.wrapMode=on.REPEAT,n.texArray.elements[n.texArray.count++]=v,i++)),n.size+=m.size,f+=m.size,l=v._batchLocation,this.addColors(t,y.color,y.alpha,m.attribSize,m.attribStart),this.addTextureIds(e,l,m.attribSize,m.attribStart)}pt._globalBatch=r,this.packAttributes()}packAttributes(){const r=this.points,t=this.uvs,e=this.colors,n=this.textureIds,i=new ArrayBuffer(r.length*3*4),o=new Float32Array(i),l=new Uint32Array(i);let h=0;for(let c=0;c<r.length/2;c++)o[h++]=r[c*2],o[h++]=r[c*2+1],o[h++]=t[c*2],o[h++]=t[c*2+1],l[h++]=e[c],o[h++]=n[c];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(r){r.holes.length?Rm.triangulate(r,this):Eh[r.type].triangulate(r,this)}processLine(r){kp(r,this);for(let t=0;t<r.holes.length;t++)kp(r.holes[t],this)}processHoles(r){for(let t=0;t<r.length;t++){const e=r[t];Eh[e.type].build(e),e.matrix&&this.transformPoints(e.points,e.matrix)}}calculateBounds(){const r=this._bounds;r.clear(),r.addVertexData(this.points,0,this.points.length),r.pad(this.boundsPadding,this.boundsPadding)}transformPoints(r,t){for(let e=0;e<r.length/2;e++){const n=r[e*2],i=r[e*2+1];r[e*2]=t.a*n+t.c*i+t.tx,r[e*2+1]=t.b*n+t.d*i+t.ty}}addColors(r,t,e,n,i=0){const o=(t>>16)+(t&65280)+((t&255)<<16),l=Mu(o,e);r.length=Math.max(r.length,i+n);for(let h=0;h<n;h++)r[i+h]=l}addTextureIds(r,t,e,n=0){r.length=Math.max(r.length,n+e);for(let i=0;i<e;i++)r[n+i]=t}addUvs(r,t,e,n,i,o=null){let l=0;const h=t.length,c=e.frame;for(;l<i;){let d=r[(n+l)*2],m=r[(n+l)*2+1];if(o){const g=o.a*d+o.c*m+o.tx;m=o.b*d+o.d*m+o.ty,d=g}l++,t.push(d/c.width,m/c.height)}const f=e.baseTexture;(c.width<f.width||c.height<f.height)&&this.adjustUvs(t,e,h,i)}adjustUvs(r,t,e,n){const i=t.baseTexture,o=1e-6,l=e+n*2,h=t.frame,c=h.width/i.width,f=h.height/i.height;let d=h.x/h.width,m=h.y/h.height,g=Math.floor(r[e]+o),y=Math.floor(r[e+1]+o);for(let v=e+2;v<l;v+=2)g=Math.min(g,Math.floor(r[v]+o)),y=Math.min(y,Math.floor(r[v+1]+o));d-=g,m-=y;for(let v=e;v<l;v+=2)r[v]=(r[v]+d)*c,r[v+1]=(r[v+1]+m)*f}};let Mm=Pm;Mm.BATCHABLE_SIZE=100;class ba{constructor(){this.color=16777215,this.alpha=1,this.texture=nt.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new ba;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=nt.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Gu extends ba{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Bn.BUTT,this.join=rn.MITER,this.miterLimit=10}clone(){const t=new Gu;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const zM=new Float32Array(3),Th={},qo=class extends ke{constructor(r=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new ba,this._lineStyle=new Gu,this._matrix=null,this._holeMode=!1,this.state=Wr.for2d(),this._geometry=r||new Mm,this._geometry.refCount++,this._transformID=-1,this.tint=16777215,this.blendMode=ut.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new qo(this._geometry)}set blendMode(r){this.state.blendMode=r}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(r){this._tint=r}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(r=null,t=0,e=1,n=.5,i=!1){return typeof r=="number"&&(r={width:r,color:t,alpha:e,alignment:n,native:i}),this.lineTextureStyle(r)}lineTextureStyle(r){r=Object.assign({width:0,texture:nt.WHITE,color:r!=null&&r.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Bn.BUTT,join:rn.MITER,miterLimit:10},r),this.currentPath&&this.startPoly();const t=r.width>0&&r.alpha>0;return t?(r.matrix&&(r.matrix=r.matrix.clone(),r.matrix.invert()),Object.assign(this._lineStyle,{visible:t},r)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const r=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Ti,this.currentPath.closeStroke=!1,this.currentPath.points.push(r[t-2],r[t-1]))}else this.currentPath=new Ti,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(r,t){return this.startPoly(),this.currentPath.points[0]=r,this.currentPath.points[1]=t,this}lineTo(r,t){this.currentPath||this.moveTo(0,0);const e=this.currentPath.points,n=e[e.length-2],i=e[e.length-1];return(n!==r||i!==t)&&e.push(r,t),this}_initCurve(r=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[r,t]):this.moveTo(r,t)}quadraticCurveTo(r,t,e,n){this._initCurve();const i=this.currentPath.points;return i.length===0&&this.moveTo(0,0),ku.curveTo(r,t,e,n,i),this}bezierCurveTo(r,t,e,n,i,o){return this._initCurve(),Uu.curveTo(r,t,e,n,i,o,this.currentPath.points),this}arcTo(r,t,e,n,i){this._initCurve(r,t);const o=this.currentPath.points,l=Np.curveTo(r,t,e,n,i,o);if(l){const{cx:h,cy:c,radius:f,startAngle:d,endAngle:m,anticlockwise:g}=l;this.arc(h,c,f,d,m,g)}return this}arc(r,t,e,n,i,o=!1){if(n===i)return this;if(!o&&i<=n?i+=oa:o&&n<=i&&(n+=oa),i-n===0)return this;const h=r+Math.cos(n)*e,c=t+Math.sin(n)*e,f=this._geometry.closePointEps;let d=this.currentPath?this.currentPath.points:null;if(d){const m=Math.abs(d[d.length-2]-h),g=Math.abs(d[d.length-1]-c);m<f&&g<f||d.push(h,c)}else this.moveTo(h,c),d=this.currentPath.points;return Np.arc(h,c,r,t,e,n,i,o,d),this}beginFill(r=0,t=1){return this.beginTextureFill({texture:nt.WHITE,color:r,alpha:t})}beginTextureFill(r){r=Object.assign({texture:nt.WHITE,color:16777215,alpha:1,matrix:null},r),this.currentPath&&this.startPoly();const t=r.alpha>0;return t?(r.matrix&&(r.matrix=r.matrix.clone(),r.matrix.invert()),Object.assign(this._fillStyle,{visible:t},r)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(r,t,e,n){return this.drawShape(new Et(r,t,e,n))}drawRoundedRect(r,t,e,n,i){return this.drawShape(new Ou(r,t,e,n,i))}drawCircle(r,t,e){return this.drawShape(new Du(r,t,e))}drawEllipse(r,t,e,n){return this.drawShape(new Bu(r,t,e,n))}drawPolygon(...r){let t,e=!0;const n=r[0];n.points?(e=n.closeStroke,t=n.points):Array.isArray(r[0])?t=r[0]:t=r;const i=new Ti(t);return i.closeStroke=e,this.drawShape(i),this}drawShape(r){return this._holeMode?this._geometry.drawHole(r,this._matrix):this._geometry.drawShape(r,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const r=this._geometry.graphicsData;return r.length===1&&r[0].shape.type===ge.RECT&&!r[0].matrix&&!r[0].holes.length&&!(r[0].lineStyle.visible&&r[0].lineStyle.width)}_render(r){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(r)):(r.batch.flush(),this._renderDirect(r))}_populateBatches(){const r=this._geometry,t=this.blendMode,e=r.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=r.batchDirty,this.batches.length=e,this.vertexData=new Float32Array(r.points);for(let n=0;n<e;n++){const i=r.batches[n],o=i.style.color,l=new Float32Array(this.vertexData.buffer,i.attribStart*4*2,i.attribSize*2),h=new Float32Array(r.uvsFloat32.buffer,i.attribStart*4*2,i.attribSize*2),c=new Uint16Array(r.indicesUint16.buffer,i.start*2,i.size),f={vertexData:l,blendMode:t,indices:c,uvs:h,_batchRGB:xs(o),_tintRGB:o,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[n]=f}}_renderBatched(r){if(this.batches.length){r.batch.setObjectRenderer(r.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,e=this.batches.length;t<e;t++){const n=this.batches[t];n.worldAlpha=this.worldAlpha*n.alpha,r.plugins[this.pluginName].render(n)}}}_renderDirect(r){const t=this._resolveDirectShader(r),e=this._geometry,n=this.tint,i=this.worldAlpha,o=t.uniforms,l=e.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(n>>16&255)/255*i,o.tint[1]=(n>>8&255)/255*i,o.tint[2]=(n&255)/255*i,o.tint[3]=i,r.shader.bind(t),r.geometry.bind(e,t),r.state.set(this.state);for(let h=0,c=l.length;h<c;h++)this._renderDrawCallDirect(r,e.drawCalls[h])}_renderDrawCallDirect(r,t){const{texArray:e,type:n,size:i,start:o}=t,l=e.count;for(let h=0;h<l;h++)r.texture.bind(e.elements[h],h);r.geometry.draw(n,i,o)}_resolveDirectShader(r){let t=this.shader;const e=this.pluginName;if(!t){if(!Th[e]){const{maxTextures:n}=r.plugins[e],i=new Int32Array(n);for(let h=0;h<n;h++)i[h]=h;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new $t,default:ur.from({uSamplers:i},!0)},l=r.plugins[e]._shader.program;Th[e]=new Ar(l,o)}t=Th[e]}return t}_calculateBounds(){this.finishPoly();const r=this._geometry;if(!r.graphicsData.length)return;const{minX:t,minY:e,maxX:n,maxY:i}=r.bounds;this._bounds.addFrame(this.transform,t,e,n,i)}containsPoint(r){return this.worldTransform.applyInverse(r,qo._TEMP_POINT),this._geometry.containsPoint(qo._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const r=xs(this.tint,zM);for(let t=0;t<this.batches.length;t++){const e=this.batches[t],n=e._batchRGB,i=r[0]*n[0]*255,o=r[1]*n[1]*255,l=r[2]*n[2]*255,h=(i<<16)+(o<<8)+(l|0);e._tintRGB=(h>>16)+(h&65280)+((h&255)<<16)}}}calculateVertices(){const r=this.transform._worldID;if(this._transformID===r)return;this._transformID=r;const t=this.transform.worldTransform,e=t.a,n=t.b,i=t.c,o=t.d,l=t.tx,h=t.ty,c=this._geometry.points,f=this.vertexData;let d=0;for(let m=0;m<c.length;m+=2){const g=c[m],y=c[m+1];f[d++]=e*g+i*y+l,f[d++]=o*y+n*g+h}}closePath(){const r=this.currentPath;return r&&(r.closeStroke=!0,this.finishPoly()),this}setMatrix(r){return this._matrix=r,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(r){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(r)}};let wa=qo;wa.curves=Pi;wa._TEMP_POINT=new At;class VM{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const Ah=new At,Hp=new Ti,Dm=class extends ke{constructor(r,t,e,n=Er.TRIANGLES){super(),this.geometry=r,this.shader=t,this.state=e||Wr.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=Z.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(r){this._geometry!==r&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=r,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(r){this.shader=r}get material(){return this.shader}set blendMode(r){this.state.blendMode=r}get blendMode(){return this.state.blendMode}set roundPixels(r){this._roundPixels!==r&&(this._transformID=-1),this._roundPixels=r}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(r){this.shader.tint=r}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(r){this.shader.texture=r}_render(r){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Er.TRIANGLES&&t.length<Dm.BATCHABLE_SIZE*2?this._renderToBatch(r):this._renderDefault(r)}_renderDefault(r){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),r.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),r.shader.bind(t),r.state.set(this.state),r.geometry.bind(this.geometry,t),r.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(r){const t=this.geometry,e=this.shader;e.uvMatrix&&(e.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=e._tintRGB,this._texture=e.texture;const n=this.material.pluginName;r.batch.setObjectRenderer(r.plugins[n]),r.plugins[n].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const i=this.transform.worldTransform,o=i.a,l=i.b,h=i.c,c=i.d,f=i.tx,d=i.ty,m=this.vertexData;for(let g=0;g<m.length/2;g++){const y=e[g*2],v=e[g*2+1];m[g*2]=o*y+h*v+f,m[g*2+1]=l*y+c*v+d}if(this._roundPixels){const g=Z.RESOLUTION;for(let y=0;y<m.length;++y)m[y]=Math.round(m[y]*g)/g}this.vertexDirty=n}calculateUvs(){const r=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=r.data:(this.batchUvs||(this.batchUvs=new VM(r,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(r){if(!this.getBounds().contains(r.x,r.y))return!1;this.worldTransform.applyInverse(r,Ah);const t=this.geometry.getBuffer("aVertexPosition").data,e=Hp.points,n=this.geometry.getIndex().data,i=n.length,o=this.drawMode===4?3:1;for(let l=0;l+2<i;l+=o){const h=n[l]*2,c=n[l+1]*2,f=n[l+2]*2;if(e[0]=t[h],e[1]=t[h+1],e[2]=t[c],e[3]=t[c+1],e[4]=t[f],e[5]=t[f+1],Hp.contains(Ah.x,Ah.y))return!0}return!1}destroy(r){super.destroy(r),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let hu=Dm;hu.BATCHABLE_SIZE=100;class YM extends ln{constructor(t,e,n){super();const i=new ee(t),o=new ee(e,!0),l=new ee(n,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,st.FLOAT).addAttribute("aTextureCoord",o,2,!1,st.FLOAT).addIndex(l),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var jM=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,qM=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class $p extends Ar{constructor(t,e){const n={uSampler:t,alpha:1,uTextureMatrix:$t.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(n,e.uniforms),super(e.program||ar.from(qM,jM),n),this._colorDirty=!1,this.uvMatrix=new Jg(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this.tint=e.tint,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16),this._colorDirty=!0)}get tint(){return this._tint}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture;Pg(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class Wp{constructor(t,e,n){this.geometry=new ln,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<t.length;++i){let o=t[i];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||st.FLOAT,offset:o.offset},e[i]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new ee(GI(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let l=0;l<this.dynamicProperties.length;++l){const h=this.dynamicProperties[l];h.offset=e,e+=h.size,this.dynamicStride+=h.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new ee(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let l=0;l<this.staticProperties.length;++l){const h=this.staticProperties[l];h.offset=i,i+=h.size,this.staticStride+=h.size}const o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new ee(this.staticData,!0,!1);for(let l=0;l<this.dynamicProperties.length;++l){const h=this.dynamicProperties[l];t.addAttribute(h.attributeName,this.dynamicBuffer,0,h.type===st.UNSIGNED_BYTE,h.type,this.dynamicStride*4,h.offset*4)}for(let l=0;l<this.staticProperties.length;++l){const h=this.staticProperties[l];t.addAttribute(h.attributeName,this.staticBuffer,0,h.type===st.UNSIGNED_BYTE,h.type,this.staticStride*4,h.offset*4)}}uploadDynamic(t,e,n){for(let i=0;i<this.dynamicProperties.length;i++){const o=this.dynamicProperties[i];o.uploadFunction(t,e,n,o.type===st.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,n){for(let i=0;i<this.staticProperties.length;i++){const o=this.staticProperties[i];o.uploadFunction(t,e,n,o.type===st.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var KM=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,ZM=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class Bm extends ya{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new $t,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:st.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Ar.from(ZM,KM,{}),this.state=Wr.for2d()}render(t){const e=t.children,n=t._maxSize,i=t._batchSize,o=this.renderer;let l=e.length;if(l===0)return;l>n&&!t.autoResize&&(l=n);let h=t._buffers;h||(h=t._buffers=this.generateBuffers(t));const c=e[0]._texture.baseTexture,f=c.alphaMode>0;this.state.blendMode=Rg(t.blendMode,f),o.state.set(this.state);const d=o.gl,m=t.worldTransform.copyTo(this.tempMatrix);m.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=m.toArray(!0),this.shader.uniforms.uColor=kI(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,f),this.shader.uniforms.uSampler=c,this.renderer.shader.bind(this.shader);let g=!1;for(let y=0,v=0;y<l;y+=i,v+=1){let T=l-y;T>i&&(T=i),v>=h.length&&h.push(this._generateOneMoreBuffer(t));const E=h[v];E.uploadDynamic(e,y,T);const I=t._bufferUpdateIDs[v]||0;g=g||E._updateID<I,g&&(E._updateID=t._updateID,E.uploadStatic(e,y,T)),o.geometry.bind(E.geometry),d.drawElements(d.TRIANGLES,T*6,d.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],n=t._maxSize,i=t._batchSize,o=t._properties;for(let l=0;l<n;l+=i)e.push(new Wp(this.properties,o,i));return e}_generateOneMoreBuffer(t){const e=t._batchSize,n=t._properties;return new Wp(this.properties,n,e)}uploadVertices(t,e,n,i,o,l){let h=0,c=0,f=0,d=0;for(let m=0;m<n;++m){const g=t[e+m],y=g._texture,v=g.scale.x,T=g.scale.y,E=y.trim,I=y.orig;E?(c=E.x-g.anchor.x*I.width,h=c+E.width,d=E.y-g.anchor.y*I.height,f=d+E.height):(h=I.width*(1-g.anchor.x),c=I.width*-g.anchor.x,f=I.height*(1-g.anchor.y),d=I.height*-g.anchor.y),i[l]=c*v,i[l+1]=d*T,i[l+o]=h*v,i[l+o+1]=d*T,i[l+o*2]=h*v,i[l+o*2+1]=f*T,i[l+o*3]=c*v,i[l+o*3+1]=f*T,l+=o*4}}uploadPosition(t,e,n,i,o,l){for(let h=0;h<n;h++){const c=t[e+h].position;i[l]=c.x,i[l+1]=c.y,i[l+o]=c.x,i[l+o+1]=c.y,i[l+o*2]=c.x,i[l+o*2+1]=c.y,i[l+o*3]=c.x,i[l+o*3+1]=c.y,l+=o*4}}uploadRotation(t,e,n,i,o,l){for(let h=0;h<n;h++){const c=t[e+h].rotation;i[l]=c,i[l+o]=c,i[l+o*2]=c,i[l+o*3]=c,l+=o*4}}uploadUvs(t,e,n,i,o,l){for(let h=0;h<n;++h){const c=t[e+h]._texture._uvs;c?(i[l]=c.x0,i[l+1]=c.y0,i[l+o]=c.x1,i[l+o+1]=c.y1,i[l+o*2]=c.x2,i[l+o*2+1]=c.y2,i[l+o*3]=c.x3,i[l+o*3+1]=c.y3,l+=o*4):(i[l]=0,i[l+1]=0,i[l+o]=0,i[l+o+1]=0,i[l+o*2]=0,i[l+o*2+1]=0,i[l+o*3]=0,i[l+o*3+1]=0,l+=o*4)}}uploadTint(t,e,n,i,o,l){for(let h=0;h<n;++h){const c=t[e+h],f=c._texture.baseTexture.alphaMode>0,d=c.alpha,m=d<1&&f?Mu(c._tintRGB,d):c._tintRGB+(d*255<<24);i[l]=m,i[l+o]=m,i[l+o*2]=m,i[l+o*3]=m,l+=o*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Bm.extension={name:"particle",type:K.RendererPlugin};it.add(Bm);var Ea=(r=>(r[r.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",r[r.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",r))(Ea||{});const ko={willReadFrequently:!0},et=class{static get experimentalLetterSpacingSupported(){let r=et._experimentalLetterSpacingSupported;if(r!==void 0){const t=Z.ADAPTER.getCanvasRenderingContext2D().prototype;r=et._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return r}constructor(r,t,e,n,i,o,l,h,c){this.text=r,this.style=t,this.width=e,this.height=n,this.lines=i,this.lineWidths=o,this.lineHeight=l,this.maxLineWidth=h,this.fontProperties=c}static measureText(r,t,e,n=et._canvas){e=e??t.wordWrap;const i=t.toFontString(),o=et.measureFont(i);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);const l=n.getContext("2d",ko);l.font=i;const c=(e?et.wordWrap(r,t,n):r).split(/(?:\r\n|\r|\n)/),f=new Array(c.length);let d=0;for(let v=0;v<c.length;v++){const T=et._measureText(c[v],t.letterSpacing,l);f[v]=T,d=Math.max(d,T)}let m=d+t.strokeThickness;t.dropShadow&&(m+=t.dropShadowDistance);const g=t.lineHeight||o.fontSize+t.strokeThickness;let y=Math.max(g,o.fontSize+t.strokeThickness*2)+(c.length-1)*(g+t.leading);return t.dropShadow&&(y+=t.dropShadowDistance),new et(r,t,m,y,c,f,g+t.leading,d,o)}static _measureText(r,t,e){let n=!1;et.experimentalLetterSpacingSupported&&(et.experimentalLetterSpacing?(e.letterSpacing=`${t}px`,e.textLetterSpacing=`${t}px`,n=!0):(e.letterSpacing="0px",e.textLetterSpacing="0px"));let i=e.measureText(r).width;return i>0&&(n?i-=t:i+=(et.graphemeSegmenter(r).length-1)*t),i}static wordWrap(r,t,e=et._canvas){const n=e.getContext("2d",ko);let i=0,o="",l="";const h=Object.create(null),{letterSpacing:c,whiteSpace:f}=t,d=et.collapseSpaces(f),m=et.collapseNewlines(f);let g=!d;const y=t.wordWrapWidth+c,v=et.tokenize(r);for(let T=0;T<v.length;T++){let E=v[T];if(et.isNewline(E)){if(!m){l+=et.addLine(o),g=!d,o="",i=0;continue}E=" "}if(d){const P=et.isBreakingSpace(E),w=et.isBreakingSpace(o[o.length-1]);if(P&&w)continue}const I=et.getFromCache(E,c,h,n);if(I>y)if(o!==""&&(l+=et.addLine(o),o="",i=0),et.canBreakWords(E,t.breakWords)){const P=et.wordWrapSplit(E);for(let w=0;w<P.length;w++){let R=P[w],O=R,W=1;for(;P[w+W];){const U=P[w+W];if(!et.canBreakChars(O,U,E,w,t.breakWords))R+=U;else break;O=U,W++}w+=W-1;const k=et.getFromCache(R,c,h,n);k+i>y&&(l+=et.addLine(o),g=!1,o="",i=0),o+=R,i+=k}}else{o.length>0&&(l+=et.addLine(o),o="",i=0);const P=T===v.length-1;l+=et.addLine(E,!P),g=!1,o="",i=0}else I+i>y&&(g=!1,l+=et.addLine(o),o="",i=0),(o.length>0||!et.isBreakingSpace(E)||g)&&(o+=E,i+=I)}return l+=et.addLine(o,!1),l}static addLine(r,t=!0){return r=et.trimRight(r),r=t?`${r}
`:r,r}static getFromCache(r,t,e,n){let i=e[r];return typeof i!="number"&&(i=et._measureText(r,t,n)+t,e[r]=i),i}static collapseSpaces(r){return r==="normal"||r==="pre-line"}static collapseNewlines(r){return r==="normal"}static trimRight(r){if(typeof r!="string")return"";for(let t=r.length-1;t>=0;t--){const e=r[t];if(!et.isBreakingSpace(e))break;r=r.slice(0,-1)}return r}static isNewline(r){return typeof r!="string"?!1:et._newlines.includes(r.charCodeAt(0))}static isBreakingSpace(r,t){return typeof r!="string"?!1:et._breakingSpaces.includes(r.charCodeAt(0))}static tokenize(r){const t=[];let e="";if(typeof r!="string")return t;for(let n=0;n<r.length;n++){const i=r[n],o=r[n+1];if(et.isBreakingSpace(i,o)||et.isNewline(i)){e!==""&&(t.push(e),e=""),t.push(i);continue}e+=i}return e!==""&&t.push(e),t}static canBreakWords(r,t){return t}static canBreakChars(r,t,e,n,i){return!0}static wordWrapSplit(r){return et.graphemeSegmenter(r)}static measureFont(r){if(et._fonts[r])return et._fonts[r];const t={ascent:0,descent:0,fontSize:0},e=et._canvas,n=et._context;n.font=r;const i=et.METRICS_STRING+et.BASELINE_SYMBOL,o=Math.ceil(n.measureText(i).width);let l=Math.ceil(n.measureText(et.BASELINE_SYMBOL).width);const h=Math.ceil(et.HEIGHT_MULTIPLIER*l);if(l=l*et.BASELINE_MULTIPLIER|0,o===0||h===0)return et._fonts[r]=t,t;e.width=o,e.height=h,n.fillStyle="#f00",n.fillRect(0,0,o,h),n.font=r,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(i,0,l);const c=n.getImageData(0,0,o,h).data,f=c.length,d=o*4;let m=0,g=0,y=!1;for(m=0;m<l;++m){for(let v=0;v<d;v+=4)if(c[g+v]!==255){y=!0;break}if(!y)g+=d;else break}for(t.ascent=l-m,g=f-d,y=!1,m=h;m>l;--m){for(let v=0;v<d;v+=4)if(c[g+v]!==255){y=!0;break}if(!y)g-=d;else break}return t.descent=m-l,t.fontSize=t.ascent+t.descent,et._fonts[r]=t,t}static clearMetrics(r=""){r?delete et._fonts[r]:et._fonts={}}static get _canvas(){if(!et.__canvas){let r;try{const t=new OffscreenCanvas(0,0),e=t.getContext("2d",ko);if(e!=null&&e.measureText)return et.__canvas=t,t;r=Z.ADAPTER.createCanvas()}catch{r=Z.ADAPTER.createCanvas()}r.width=r.height=10,et.__canvas=r}return et.__canvas}static get _context(){return et.__context||(et.__context=et._canvas.getContext("2d",ko)),et.__context}};let pe=et;pe.METRICS_STRING="|ÉqÅ";pe.BASELINE_SYMBOL="M";pe.BASELINE_MULTIPLIER=1.4;pe.HEIGHT_MULTIPLIER=2;pe.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const r=new Intl.Segmenter;return t=>[...r.segment(t)].map(e=>e.segment)}return r=>[...r]})();pe.experimentalLetterSpacing=!1;pe._fonts={};pe._newlines=[10,13];pe._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const JM=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],us=class{constructor(r){this.styleID=0,this.reset(),Ch(this,r,r)}clone(){const r={};return Ch(r,this,us.defaultStyle),new us(r)}reset(){Ch(this,us.defaultStyle,us.defaultStyle)}get align(){return this._align}set align(r){this._align!==r&&(this._align=r,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(r){this._breakWords!==r&&(this._breakWords=r,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(r){this._dropShadow!==r&&(this._dropShadow=r,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(r){this._dropShadowAlpha!==r&&(this._dropShadowAlpha=r,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(r){this._dropShadowAngle!==r&&(this._dropShadowAngle=r,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(r){this._dropShadowBlur!==r&&(this._dropShadowBlur=r,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(r){const t=Sh(r);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(r){this._dropShadowDistance!==r&&(this._dropShadowDistance=r,this.styleID++)}get fill(){return this._fill}set fill(r){const t=Sh(r);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(r){this._fillGradientType!==r&&(this._fillGradientType=r,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(r){QM(this._fillGradientStops,r)||(this._fillGradientStops=r,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(r){this.fontFamily!==r&&(this._fontFamily=r,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(r){this._fontSize!==r&&(this._fontSize=r,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(r){this._fontStyle!==r&&(this._fontStyle=r,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(r){this._fontVariant!==r&&(this._fontVariant=r,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(r){this._fontWeight!==r&&(this._fontWeight=r,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(r){this._letterSpacing!==r&&(this._letterSpacing=r,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(r){this._lineHeight!==r&&(this._lineHeight=r,this.styleID++)}get leading(){return this._leading}set leading(r){this._leading!==r&&(this._leading=r,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(r){this._lineJoin!==r&&(this._lineJoin=r,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(r){this._miterLimit!==r&&(this._miterLimit=r,this.styleID++)}get padding(){return this._padding}set padding(r){this._padding!==r&&(this._padding=r,this.styleID++)}get stroke(){return this._stroke}set stroke(r){const t=Sh(r);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(r){this._strokeThickness!==r&&(this._strokeThickness=r,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(r){this._textBaseline!==r&&(this._textBaseline=r,this.styleID++)}get trim(){return this._trim}set trim(r){this._trim!==r&&(this._trim=r,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(r){this._whiteSpace!==r&&(this._whiteSpace=r,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(r){this._wordWrap!==r&&(this._wordWrap=r,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(r){this._wordWrapWidth!==r&&(this._wordWrapWidth=r,this.styleID++)}toFontString(){const r=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let n=t[e].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!JM.includes(n)&&(n=`"${n}"`),t[e]=n}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${r} ${t.join(",")}`}};let Hn=us;Hn.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Ea.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function Xp(r){return typeof r=="number"?Cg(r):(typeof r=="string"&&r.startsWith("0x")&&(r=r.replace("0x","#")),r)}function Sh(r){if(Array.isArray(r)){for(let t=0;t<r.length;++t)r[t]=Xp(r[t]);return r}else return Xp(r)}function QM(r,t){if(!Array.isArray(r)||!Array.isArray(t)||r.length!==t.length)return!1;for(let e=0;e<r.length;++e)if(r[e]!==t[e])return!1;return!0}function Ch(r,t,e){for(const n in e)Array.isArray(t[n])?r[n]=t[n].slice():r[n]=t[n]}const tD={texture:!0,children:!1,baseTexture:!0},uu=class extends Oi{constructor(r,t,e){let n=!1;e||(e=Z.ADAPTER.createCanvas(),n=!0),e.width=3,e.height=3;const i=nt.from(e);i.orig=new Et,i.trim=new Et,super(i),this._ownCanvas=n,this.canvas=e,this.context=e.getContext("2d",{willReadFrequently:!0}),this._resolution=uu.defaultResolution??Z.RESOLUTION,this._autoResolution=uu.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=r,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return pe.experimentalLetterSpacing}static set experimentalLetterSpacing(r){St("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),pe.experimentalLetterSpacing=r}updateText(r){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&r)return;this._font=this._style.toFontString();const e=this.context,n=pe.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),i=n.width,o=n.height,l=n.lines,h=n.lineHeight,c=n.lineWidths,f=n.maxLineWidth,d=n.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,i)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+t.padding*2)*this._resolution),e.scale(this._resolution,this._resolution),e.clearRect(0,0,this.canvas.width,this.canvas.height),e.font=this._font,e.lineWidth=t.strokeThickness,e.textBaseline=t.textBaseline,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit;let m,g;const y=t.dropShadow?2:1;for(let v=0;v<y;++v){const T=t.dropShadow&&v===0,E=T?Math.ceil(Math.max(1,o)+t.padding*2):0,I=E*this._resolution;if(T){e.fillStyle="black",e.strokeStyle="black";const w=t.dropShadowColor,R=xs(typeof w=="number"?w:Pu(w)),O=t.dropShadowBlur*this._resolution,W=t.dropShadowDistance*this._resolution;e.shadowColor=`rgba(${R[0]*255},${R[1]*255},${R[2]*255},${t.dropShadowAlpha})`,e.shadowBlur=O,e.shadowOffsetX=Math.cos(t.dropShadowAngle)*W,e.shadowOffsetY=Math.sin(t.dropShadowAngle)*W+I}else e.fillStyle=this._generateFillStyle(t,l,n),e.strokeStyle=t.stroke,e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;let P=(h-d.fontSize)/2;h-d.fontSize<0&&(P=0);for(let w=0;w<l.length;w++)m=t.strokeThickness/2,g=t.strokeThickness/2+w*h+d.ascent+P,t.align==="right"?m+=f-c[w]:t.align==="center"&&(m+=(f-c[w])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(l[w],m+t.padding,g+t.padding-E,!0),t.fill&&this.drawLetterSpacing(l[w],m+t.padding,g+t.padding-E)}this.updateTexture()}drawLetterSpacing(r,t,e,n=!1){const o=this._style.letterSpacing;let l=!1;if(pe.experimentalLetterSpacingSupported&&(pe.experimentalLetterSpacing?(this.context.letterSpacing=`${o}px`,this.context.textLetterSpacing=`${o}px`,l=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),o===0||l){n?this.context.strokeText(r,t,e):this.context.fillText(r,t,e);return}let h=t;const c=pe.graphemeSegmenter(r);let f=this.context.measureText(r).width,d=0;for(let m=0;m<c.length;++m){const g=c[m];n?this.context.strokeText(g,h,e):this.context.fillText(g,h,e);let y="";for(let v=m+1;v<c.length;++v)y+=c[v];d=this.context.measureText(y).width,h+=f-d+o,f=d}}updateTexture(){const r=this.canvas;if(this._style.trim){const o=WI(r);o.data&&(r.width=o.width,r.height=o.height,this.context.putImageData(o.data,0,0))}const t=this._texture,e=this._style,n=e.trim?0:e.padding,i=t.baseTexture;t.trim.width=t._frame.width=r.width/this._resolution,t.trim.height=t._frame.height=r.height/this._resolution,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-n*2,t.orig.height=t._frame.height-n*2,this._onTextureUpdate(),i.setRealSize(r.width,r.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(r){this._autoResolution&&this._resolution!==r.resolution&&(this._resolution=r.resolution,this.dirty=!0),this.updateText(!0),super._render(r)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(r,t){return this.updateText(!0),this._textureID===-1&&(r=!1),super.getBounds(r,t)}getLocalBounds(r){return this.updateText(!0),super.getLocalBounds.call(this,r)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(r,t,e){const n=r.fill;if(Array.isArray(n)){if(n.length===1)return n[0]}else return n;let i;const o=r.dropShadow?r.dropShadowDistance:0,l=r.padding||0,h=this.canvas.width/this._resolution-o-l*2,c=this.canvas.height/this._resolution-o-l*2,f=n.slice(),d=r.fillGradientStops.slice();if(!d.length){const m=f.length+1;for(let g=1;g<m;++g)d.push(g/m)}if(f.unshift(n[0]),d.unshift(0),f.push(n[n.length-1]),d.push(1),r.fillGradientType===Ea.LINEAR_VERTICAL){i=this.context.createLinearGradient(h/2,l,h/2,c+l);const m=e.fontProperties.fontSize+r.strokeThickness;for(let g=0;g<t.length;g++){const y=e.lineHeight*(g-1)+m,v=e.lineHeight*g;let T=v;g>0&&y>v&&(T=(v+y)/2);const E=v+m,I=e.lineHeight*(g+1);let P=E;g+1<t.length&&I<E&&(P=(E+I)/2);const w=(P-T)/c;for(let R=0;R<f.length;R++){let O=0;typeof d[R]=="number"?O=d[R]:O=R/f.length;let W=Math.min(1,Math.max(0,T/c+O*w));W=Number(W.toFixed(5)),i.addColorStop(W,f[R])}}}else{i=this.context.createLinearGradient(l,c/2,h+l,c/2);const m=f.length+1;let g=1;for(let y=0;y<f.length;y++){let v;typeof d[y]=="number"?v=d[y]:v=g/m,i.addColorStop(v,f[y]),g++}}return i}destroy(r){typeof r=="boolean"&&(r={children:r}),r=Object.assign({},tD,r),super.destroy(r),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(r){this.updateText(!0);const t=mi(this.scale.x)||1;this.scale.x=t*r/this._texture.orig.width,this._width=r}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(r){this.updateText(!0);const t=mi(this.scale.y)||1;this.scale.y=t*r/this._texture.orig.height,this._height=r}get style(){return this._style}set style(r){r=r||{},r instanceof Hn?this._style=r:this._style=new Hn(r),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(r){r=String(r??""),this._text!==r&&(this._text=r,this.dirty=!0)}get resolution(){return this._resolution}set resolution(r){this._autoResolution=!1,this._resolution!==r&&(this._resolution=r,this.dirty=!0)}};let Hu=uu;Hu.defaultAutoResolution=!0;class eD{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function rD(r,t){var n;let e=!1;if((n=r==null?void 0:r._textures)!=null&&n.length){for(let i=0;i<r._textures.length;i++)if(r._textures[i]instanceof nt){const o=r._textures[i].baseTexture;t.includes(o)||(t.push(o),e=!0)}}return e}function nD(r,t){if(r.baseTexture instanceof pt){const e=r.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function iD(r,t){if(r._texture&&r._texture instanceof nt){const e=r._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function sD(r,t){return t instanceof Hu?(t.updateText(!0),!0):!1}function oD(r,t){if(t instanceof Hn){const e=t.toFontString();return pe.measureFont(e),!0}return!1}function aD(r,t){if(r instanceof Hu){t.includes(r.style)||t.push(r.style),t.includes(r)||t.push(r);const e=r._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function lD(r,t){return r instanceof Hn?(t.includes(r)||t.push(r),!0):!1}const Om=class{constructor(r){this.limiter=new eD(Om.uploadsPerFrame),this.renderer=r,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(aD),this.registerFindHook(lD),this.registerFindHook(rD),this.registerFindHook(nD),this.registerFindHook(iD),this.registerUploadHook(sD),this.registerUploadHook(oD)}upload(r){return new Promise(t=>{r&&this.add(r),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,Pe.system.addOnce(this.tick,this,Ri.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const r=this.queue[0];let t=!1;if(r&&!r._destroyed){for(let e=0,n=this.uploadHooks.length;e<n;e++)if(this.uploadHooks[e](this.uploadHookHelper,r)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Pe.system.addOnce(this.tick,this,Ri.UTILITY);else{this.ticking=!1;const r=this.completes.slice(0);this.completes.length=0;for(let t=0,e=r.length;t<e;t++)r[t]()}}registerFindHook(r){return r&&this.addHooks.push(r),this}registerUploadHook(r){return r&&this.uploadHooks.push(r),this}add(r){for(let t=0,e=this.addHooks.length;t<e&&!this.addHooks[t](r,this.queue);t++);if(r instanceof ke)for(let t=r.children.length-1;t>=0;t--)this.add(r.children[t]);return this}destroy(){this.ticking&&Pe.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let da=Om;da.uploadsPerFrame=4;Object.defineProperties(Z,{UPLOADS_PER_FRAME:{get(){return da.uploadsPerFrame},set(r){St("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),da.uploadsPerFrame=r}}});function Fm(r,t){return t instanceof pt?(t._glTextures[r.CONTEXT_UID]||r.texture.bind(t),!0):!1}function hD(r,t){if(!(t instanceof wa))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:n}=e;for(let i=0;i<n.length;i++){const{texture:o}=n[i].style;o&&Fm(r,o.baseTexture)}return e.batchable||r.geometry.bind(e,t._resolveDirectShader(r)),!0}function uD(r,t){return r instanceof wa?(t.push(r),!0):!1}class Lm extends da{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(uD),this.registerUploadHook(Fm),this.registerUploadHook(hD)}}Lm.extension={name:"prepare",type:K.RendererSystem};it.add(Lm);var cD=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,fD=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,dD=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,zp=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,pD=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Go=new $t;class Nm extends ya{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new jg,this.state=Wr.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Ar.from(zp,pD,e),this.shader=t.context.webGLVersion>1?Ar.from(fD,cD,e):Ar.from(zp,dD,e)}render(t){const e=this.renderer,n=this.quad;let i=n.vertices;i[0]=i[6]=t._width*-t.anchor.x,i[1]=i[3]=t._height*-t.anchor.y,i[2]=i[4]=t._width*(1-t.anchor.x),i[5]=i[7]=t._height*(1-t.anchor.y);const o=t.uvRespectAnchor?t.anchor.x:0,l=t.uvRespectAnchor?t.anchor.y:0;i=n.uvs,i[0]=i[6]=-o,i[1]=i[3]=-l,i[2]=i[4]=1-o,i[5]=i[7]=1-l,n.invalidate();const h=t._texture,c=h.baseTexture,f=c.alphaMode>0,d=t.tileTransform.localTransform,m=t.uvMatrix;let g=c.isPowerOfTwo&&h.frame.width===c.width&&h.frame.height===c.height;g&&(c._glTextures[e.CONTEXT_UID]?g=c.wrapMode!==on.CLAMP:c.wrapMode===on.CLAMP&&(c.wrapMode=on.REPEAT));const y=g?this.simpleShader:this.shader,v=h.width,T=h.height,E=t._width,I=t._height;Go.set(d.a*v/E,d.b*v/I,d.c*T/E,d.d*T/I,d.tx/E,d.ty/I),Go.invert(),g?Go.prepend(m.mapCoord):(y.uniforms.uMapCoord=m.mapCoord.toArray(!0),y.uniforms.uClampFrame=m.uClampFrame,y.uniforms.uClampOffset=m.uClampOffset),y.uniforms.uTransform=Go.toArray(!0),y.uniforms.uColor=Pg(t.tint,t.worldAlpha,y.uniforms.uColor,f),y.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),y.uniforms.uSampler=h,e.shader.bind(y),e.geometry.bind(n),this.state.blendMode=Rg(t.blendMode,f),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}Nm.extension={name:"tilingSprite",type:K.RendererPlugin};it.add(Nm);const cs=class{constructor(r,t,e=null){this.linkedSheets=[],this._texture=r instanceof nt?r:null,this.baseTexture=r instanceof pt?r:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const n=this.baseTexture.resource;this.resolution=this._updateResolution(e||(n?n.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(r=null){const{scale:t}=this.data.meta;let e=an(r,null);return e===null&&(e=parseFloat(t??"1")),e!==1&&this.baseTexture.setResolution(e),e}parse(){return new Promise(r=>{this._callback=r,this._batchIndex=0,this._frameKeys.length<=cs.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(r){let t=r;const e=cs.BATCH_SIZE;for(;t-r<e&&t<this._frameKeys.length;){const n=this._frameKeys[t],i=this._frames[n],o=i.frame;if(o){let l=null,h=null;const c=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,f=new Et(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);i.rotated?l=new Et(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):l=new Et(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(h=new Et(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new nt(this.baseTexture,l,f,h,i.rotated?2:0,i.anchor),nt.addToCache(this.textures[n],n)}t++}}_processAnimations(){const r=this.data.animations||{};for(const t in r){this.animations[t]=[];for(let e=0;e<r[t].length;e++){const n=r[t][e];this.animations[t].push(this.textures[n])}}}_parseComplete(){const r=this._callback;this._callback=null,this._batchIndex=0,r.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*cs.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*cs.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(r=!1){var t;for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,r&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let cu=cs;cu.BATCH_SIZE=1e3;const gD=["jpg","png","jpeg","avif","webp"];function Um(r,t,e){const n={};if(r.forEach(i=>{n[i]=t}),Object.keys(t.textures).forEach(i=>{n[i]=t.textures[i]}),!e){const i=me.dirname(r[0]);t.linkedSheets.forEach((o,l)=>{const h=Um([`${i}/${t.data.meta.related_multi_packs[l]}`],o,!0);Object.assign(n,h)})}return n}const mD={extension:K.Asset,cache:{test:r=>r instanceof cu,getCacheableAssets:(r,t)=>Um(r,t,!1)},resolver:{test:r=>{const e=r.split("?")[0].split("."),n=e.pop(),i=e.pop();return n==="json"&&gD.includes(i)},parse:r=>{var e;const t=r.split(".");return{resolution:parseFloat(((e=Z.RETINA_PREFIX.exec(r))==null?void 0:e[1])??"1"),format:t[t.length-2],src:r}}},loader:{extension:{type:K.LoadParser,priority:Cr.Normal},async testParse(r,t){return me.extname(t.src).toLowerCase()===".json"&&!!r.frames},async parse(r,t,e){var f,d;let n=me.dirname(t.src);n&&n.lastIndexOf("/")!==n.length-1&&(n+="/");const i=n+r.meta.image,l=(await e.load([i]))[i],h=new cu(l.baseTexture,r,t.src);await h.parse();const c=(f=r==null?void 0:r.meta)==null?void 0:f.related_multi_packs;if(Array.isArray(c)){const m=[];for(const y of c){if(typeof y!="string")continue;const v=n+y;(d=t.data)!=null&&d.ignoreMultiPack||m.push(e.load({src:v,data:{ignoreMultiPack:!0}}))}const g=await Promise.all(m);h.linkedSheets=g,g.forEach(y=>{y.linkedSheets=[h].concat(h.linkedSheets.filter(v=>v!==y))})}return h},unload(r){r.destroy(!0)}}};it.add(mD);class pa{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Ko{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const o in e){const l=e[o].match(/^[a-z]+/gm)[0],h=e[o].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),c={};for(const f in h){const d=h[f].split("="),m=d[0],g=d[1].replace(/"/gm,""),y=parseFloat(g),v=isNaN(y)?g:y;c[m]=v}n[l].push(c)}const i=new pa;return n.info.forEach(o=>i.info.push({face:o.face,size:parseInt(o.size,10)})),n.common.forEach(o=>i.common.push({lineHeight:parseInt(o.lineHeight,10)})),n.page.forEach(o=>i.page.push({id:parseInt(o.id,10),file:o.file})),n.char.forEach(o=>i.char.push({id:parseInt(o.id,10),page:parseInt(o.page,10),x:parseInt(o.x,10),y:parseInt(o.y,10),width:parseInt(o.width,10),height:parseInt(o.height,10),xoffset:parseInt(o.xoffset,10),yoffset:parseInt(o.yoffset,10),xadvance:parseInt(o.xadvance,10)})),n.kerning.forEach(o=>i.kerning.push({first:parseInt(o.first,10),second:parseInt(o.second,10),amount:parseInt(o.amount,10)})),n.distanceField.forEach(o=>i.distanceField.push({distanceRange:parseInt(o.distanceRange,10),fieldType:o.fieldType})),i}}class fu{static test(t){const e=t;return"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new pa,n=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),o=t.getElementsByTagName("page"),l=t.getElementsByTagName("char"),h=t.getElementsByTagName("kerning"),c=t.getElementsByTagName("distanceField");for(let f=0;f<n.length;f++)e.info.push({face:n[f].getAttribute("face"),size:parseInt(n[f].getAttribute("size"),10)});for(let f=0;f<i.length;f++)e.common.push({lineHeight:parseInt(i[f].getAttribute("lineHeight"),10)});for(let f=0;f<o.length;f++)e.page.push({id:parseInt(o[f].getAttribute("id"),10)||0,file:o[f].getAttribute("file")});for(let f=0;f<l.length;f++){const d=l[f];e.char.push({id:parseInt(d.getAttribute("id"),10),page:parseInt(d.getAttribute("page"),10)||0,x:parseInt(d.getAttribute("x"),10),y:parseInt(d.getAttribute("y"),10),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10),xoffset:parseInt(d.getAttribute("xoffset"),10),yoffset:parseInt(d.getAttribute("yoffset"),10),xadvance:parseInt(d.getAttribute("xadvance"),10)})}for(let f=0;f<h.length;f++)e.kerning.push({first:parseInt(h[f].getAttribute("first"),10),second:parseInt(h[f].getAttribute("second"),10),amount:parseInt(h[f].getAttribute("amount"),10)});for(let f=0;f<c.length;f++)e.distanceField.push({fieldType:c[f].getAttribute("fieldType"),distanceRange:parseInt(c[f].getAttribute("distanceRange"),10)});return e}}class du{static test(t){return typeof t=="string"&&t.includes("<font>")?fu.test(Z.ADAPTER.parseXML(t)):!1}static parse(t){return fu.parse(Z.ADAPTER.parseXML(t))}}const Ih=[Ko,fu,du];function _D(r){for(let t=0;t<Ih.length;t++)if(Ih[t].test(r))return Ih[t];return null}function yD(r,t,e,n,i,o){const l=e.fill;if(Array.isArray(l)){if(l.length===1)return l[0]}else return l;let h;const c=e.dropShadow?e.dropShadowDistance:0,f=e.padding||0,d=r.width/n-c-f*2,m=r.height/n-c-f*2,g=l.slice(),y=e.fillGradientStops.slice();if(!y.length){const v=g.length+1;for(let T=1;T<v;++T)y.push(T/v)}if(g.unshift(l[0]),y.unshift(0),g.push(l[l.length-1]),y.push(1),e.fillGradientType===Ea.LINEAR_VERTICAL){h=t.createLinearGradient(d/2,f,d/2,m+f);let v=0;const E=(o.fontProperties.fontSize+e.strokeThickness)/m;for(let I=0;I<i.length;I++){const P=o.lineHeight*I;for(let w=0;w<g.length;w++){let R=0;typeof y[w]=="number"?R=y[w]:R=w/g.length;const O=P/m+R*E;let W=Math.max(v,O);W=Math.min(W,1),h.addColorStop(W,g[w]),v=W}}}else{h=t.createLinearGradient(f,m/2,d+f,m/2);const v=g.length+1;let T=1;for(let E=0;E<g.length;E++){let I;typeof y[E]=="number"?I=y[E]:I=T/v,h.addColorStop(I,g[E]),T++}}return h}function vD(r,t,e,n,i,o,l){const h=e.text,c=e.fontProperties;t.translate(n,i),t.scale(o,o);const f=l.strokeThickness/2,d=-(l.strokeThickness/2);if(t.font=l.toFontString(),t.lineWidth=l.strokeThickness,t.textBaseline=l.textBaseline,t.lineJoin=l.lineJoin,t.miterLimit=l.miterLimit,t.fillStyle=yD(r,t,l,o,[h],e),t.strokeStyle=l.stroke,l.dropShadow){const m=l.dropShadowColor,g=xs(typeof m=="number"?m:Pu(m)),y=l.dropShadowBlur*o,v=l.dropShadowDistance*o;t.shadowColor=`rgba(${g[0]*255},${g[1]*255},${g[2]*255},${l.dropShadowAlpha})`,t.shadowBlur=y,t.shadowOffsetX=Math.cos(l.dropShadowAngle)*v,t.shadowOffsetY=Math.sin(l.dropShadowAngle)*v}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;l.stroke&&l.strokeThickness&&t.strokeText(h,f,d+e.lineHeight-c.descent),l.fill&&t.fillText(h,f,d+e.lineHeight-c.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function Zo(r){return r.codePointAt?r.codePointAt(0):r.charCodeAt(0)}function km(r){return Array.from?Array.from(r):r.split("")}function xD(r){typeof r=="string"&&(r=[r]);const t=[];for(let e=0,n=r.length;e<n;e++){const i=r[e];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const o=i[0].charCodeAt(0),l=i[1].charCodeAt(0);if(l<o)throw new Error("[BitmapFont]: Invalid character range.");for(let h=o,c=l;h<=c;h++)t.push(String.fromCharCode(h))}else t.push(...km(i))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const ir=class{constructor(r,t,e){var f;const[n]=r.info,[i]=r.common,[o]=r.page,[l]=r.distanceField,h=an(o.file),c={};this._ownsTextures=e,this.font=n.face,this.size=n.size,this.lineHeight=i.lineHeight/h,this.chars={},this.pageTextures=c;for(let d=0;d<r.page.length;d++){const{id:m,file:g}=r.page[d];c[m]=t instanceof Array?t[d]:t[g],l!=null&&l.fieldType&&l.fieldType!=="none"&&(c[m].baseTexture.alphaMode=cr.NO_PREMULTIPLIED_ALPHA,c[m].baseTexture.mipmap=Sr.OFF)}for(let d=0;d<r.char.length;d++){const{id:m,page:g}=r.char[d];let{x:y,y:v,width:T,height:E,xoffset:I,yoffset:P,xadvance:w}=r.char[d];y/=h,v/=h,T/=h,E/=h,I/=h,P/=h,w/=h;const R=new Et(y+c[g].frame.x/h,v+c[g].frame.y/h,T,E);this.chars[m]={xOffset:I,yOffset:P,xAdvance:w,kerning:{},texture:new nt(c[g].baseTexture,R),page:g}}for(let d=0;d<r.kerning.length;d++){let{first:m,second:g,amount:y}=r.kerning[d];m/=h,g/=h,y/=h,this.chars[g]&&(this.chars[g].kerning[m]=y)}this.distanceFieldRange=l==null?void 0:l.distanceRange,this.distanceFieldType=((f=l==null?void 0:l.fieldType)==null?void 0:f.toLowerCase())??"none"}destroy(){for(const r in this.chars)this.chars[r].texture.destroy(),this.chars[r].texture=null;for(const r in this.pageTextures)this._ownsTextures&&this.pageTextures[r].destroy(!0),this.pageTextures[r]=null;this.chars=null,this.pageTextures=null}static install(r,t,e){let n;if(r instanceof pa)n=r;else{const o=_D(r);if(!o)throw new Error("Unrecognized data format for font.");n=o.parse(r)}t instanceof nt&&(t=[t]);const i=new ir(n,t,e);return ir.available[i.font]=i,i}static uninstall(r){const t=ir.available[r];if(!t)throw new Error(`No font found named '${r}'`);t.destroy(),delete ir.available[r]}static from(r,t,e){if(!r)throw new Error("[BitmapFont] Property `name` is required.");const{chars:n,padding:i,resolution:o,textureWidth:l,textureHeight:h,...c}=Object.assign({},ir.defaultOptions,e),f=xD(n),d=t instanceof Hn?t:new Hn(t),m=l,g=new pa;g.info[0]={face:d.fontFamily,size:d.fontSize},g.common[0]={lineHeight:d.fontSize};let y=0,v=0,T,E,I,P=0;const w=[];for(let O=0;O<f.length;O++){T||(T=Z.ADAPTER.createCanvas(),T.width=l,T.height=h,E=T.getContext("2d"),I=new pt(T,{resolution:o,...c}),w.push(new nt(I)),g.page.push({id:w.length-1,file:""}));const W=f[O],k=pe.measureText(W,d,!1,T),U=k.width,Y=Math.ceil(k.height),J=Math.ceil((d.fontStyle==="italic"?2:1)*U);if(v>=h-Y*o){if(v===0)throw new Error(`[BitmapFont] textureHeight ${h}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${W}')`);--O,T=null,E=null,I=null,v=0,y=0,P=0;continue}if(P=Math.max(Y+k.fontProperties.descent,P),J*o+y>=m){if(y===0)throw new Error(`[BitmapFont] textureWidth ${l}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${W}')`);--O,v+=P*o,v=Math.ceil(v),y=0,P=0;continue}vD(T,E,k,y,v,o,d);const z=Zo(k.text);g.char.push({id:z,page:w.length-1,x:y/o,y:v/o,width:J,height:Y,xoffset:0,yoffset:0,xadvance:Math.ceil(U-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0))}),y+=(J+2*i)*o,y=Math.ceil(y)}for(let O=0,W=f.length;O<W;O++){const k=f[O];for(let U=0;U<W;U++){const Y=f[U],J=E.measureText(k).width,z=E.measureText(Y).width,G=E.measureText(k+Y).width-(J+z);G&&g.kerning.push({first:Zo(k),second:Zo(Y),amount:G})}}const R=new ir(g,w,!0);return ir.available[r]!==void 0&&ir.uninstall(r),ir.available[r]=R,R}};let Re=ir;Re.ALPHA=[["a","z"],["A","Z"]," "];Re.NUMERIC=[["0","9"]];Re.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];Re.ASCII=[[" ","~"]];Re.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:ir.ALPHANUMERIC};Re.available={};var bD=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`,wD=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const Vp=[],Yp=[],jp=[],Gm=class extends ke{constructor(r,t={}){super(),this._tint=16777215;const{align:e,tint:n,maxWidth:i,letterSpacing:o,fontName:l,fontSize:h}=Object.assign({},Gm.styleDefaults,t);if(!Re.available[l])throw new Error(`Missing BitmapFont "${l}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=e,this._tint=n,this._font=void 0,this._fontName=l,this._fontSize=h,this.text=r,this._maxWidth=i,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new sn(()=>{this.dirty=!0},this,0,0),this._roundPixels=Z.ROUND_PIXELS,this.dirty=!0,this._resolution=Z.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var J;const r=Re.available[this._fontName],t=this.fontSize,e=t/r.size,n=new At,i=[],o=[],l=[],h=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",c=km(h),f=this._maxWidth*r.size/t,d=r.distanceFieldType==="none"?Vp:Yp;let m=null,g=0,y=0,v=0,T=-1,E=0,I=0,P=0,w=0;for(let z=0;z<c.length;z++){const q=c[z],G=Zo(q);if(/(?:\s)/.test(q)&&(T=z,E=g,w++),q==="\r"||q===`
`){o.push(g),l.push(-1),y=Math.max(y,g),++v,++I,n.x=0,n.y+=r.lineHeight,m=null,w=0;continue}const F=r.chars[G];if(!F)continue;m&&F.kerning[m]&&(n.x+=F.kerning[m]);const at=jp.pop()||{texture:nt.EMPTY,line:0,charCode:0,prevSpaces:0,position:new At};at.texture=F.texture,at.line=v,at.charCode=G,at.position.x=n.x+F.xOffset+this._letterSpacing/2,at.position.y=n.y+F.yOffset,at.prevSpaces=w,i.push(at),g=at.position.x+Math.max(F.xAdvance-F.xOffset,F.texture.orig.width),n.x+=F.xAdvance+this._letterSpacing,P=Math.max(P,F.yOffset+F.texture.height),m=G,T!==-1&&f>0&&n.x>f&&(++I,Ei(i,1+T-I,1+z-T),z=T,T=-1,o.push(E),l.push(i.length>0?i[i.length-1].prevSpaces:0),y=Math.max(y,E),v++,n.x=0,n.y+=r.lineHeight,m=null,w=0)}const R=c[c.length-1];R!=="\r"&&R!==`
`&&(/(?:\s)/.test(R)&&(g=E),o.push(g),y=Math.max(y,g),l.push(-1));const O=[];for(let z=0;z<=v;z++){let q=0;this._align==="right"?q=y-o[z]:this._align==="center"?q=(y-o[z])/2:this._align==="justify"&&(q=l[z]<0?0:(y-o[z])/l[z]),O.push(q)}const W=i.length,k={},U=[],Y=this._activePagesMeshData;d.push(...Y);for(let z=0;z<W;z++){const q=i[z].texture,G=q.baseTexture.uid;if(!k[G]){let F=d.pop();if(!F){const ft=new YM;let V,_t;r.distanceFieldType==="none"?(V=new $p(nt.EMPTY),_t=ut.NORMAL):(V=new $p(nt.EMPTY,{program:ar.from(wD,bD),uniforms:{uFWidth:0}}),_t=ut.NORMAL_NPM);const Ot=new hu(ft,V);Ot.blendMode=_t,F={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Ot,vertices:null,uvs:null,indices:null}}F.index=0,F.indexCount=0,F.vertexCount=0,F.uvsCount=0,F.total=0;const{_textureCache:at}=this;at[G]=at[G]||new nt(q.baseTexture),F.mesh.texture=at[G],F.mesh.tint=this._tint,U.push(F),k[G]=F}k[G].total++}for(let z=0;z<Y.length;z++)U.includes(Y[z])||this.removeChild(Y[z].mesh);for(let z=0;z<U.length;z++)U[z].mesh.parent!==this&&this.addChild(U[z].mesh);this._activePagesMeshData=U;for(const z in k){const q=k[z],G=q.total;if(!(((J=q.indices)==null?void 0:J.length)>6*G)||q.vertices.length<hu.BATCHABLE_SIZE*2)q.vertices=new Float32Array(4*2*G),q.uvs=new Float32Array(4*2*G),q.indices=new Uint16Array(6*G);else{const F=q.total,at=q.vertices;for(let ft=F*4*2;ft<at.length;ft++)at[ft]=0}q.mesh.size=6*G}for(let z=0;z<W;z++){const q=i[z];let G=q.position.x+O[q.line]*(this._align==="justify"?q.prevSpaces:1);this._roundPixels&&(G=Math.round(G));const F=G*e,at=q.position.y*e,ft=q.texture,V=k[ft.baseTexture.uid],_t=ft.frame,Ot=ft._uvs,$=V.index++;V.indices[$*6+0]=0+$*4,V.indices[$*6+1]=1+$*4,V.indices[$*6+2]=2+$*4,V.indices[$*6+3]=0+$*4,V.indices[$*6+4]=2+$*4,V.indices[$*6+5]=3+$*4,V.vertices[$*8+0]=F,V.vertices[$*8+1]=at,V.vertices[$*8+2]=F+_t.width*e,V.vertices[$*8+3]=at,V.vertices[$*8+4]=F+_t.width*e,V.vertices[$*8+5]=at+_t.height*e,V.vertices[$*8+6]=F,V.vertices[$*8+7]=at+_t.height*e,V.uvs[$*8+0]=Ot.x0,V.uvs[$*8+1]=Ot.y0,V.uvs[$*8+2]=Ot.x1,V.uvs[$*8+3]=Ot.y1,V.uvs[$*8+4]=Ot.x2,V.uvs[$*8+5]=Ot.y2,V.uvs[$*8+6]=Ot.x3,V.uvs[$*8+7]=Ot.y3}this._textWidth=y*e,this._textHeight=(n.y+r.lineHeight)*e;for(const z in k){const q=k[z];if(this.anchor.x!==0||this.anchor.y!==0){let ft=0;const V=this._textWidth*this.anchor.x,_t=this._textHeight*this.anchor.y;for(let Ot=0;Ot<q.total;Ot++)q.vertices[ft++]-=V,q.vertices[ft++]-=_t,q.vertices[ft++]-=V,q.vertices[ft++]-=_t,q.vertices[ft++]-=V,q.vertices[ft++]-=_t,q.vertices[ft++]-=V,q.vertices[ft++]-=_t}this._maxLineHeight=P*e;const G=q.mesh.geometry.getBuffer("aVertexPosition"),F=q.mesh.geometry.getBuffer("aTextureCoord"),at=q.mesh.geometry.getIndex();G.data=q.vertices,F.data=q.uvs,at.data=q.indices,G.update(),F.update(),at.update()}for(let z=0;z<i.length;z++)jp.push(i[z]);this._font=r,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(r){this._autoResolution&&this._resolution!==r.resolution&&(this._resolution=r.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:e,size:n}=Re.available[this._fontName];if(e!=="none"){const{a:i,b:o,c:l,d:h}=this.worldTransform,c=Math.sqrt(i*i+o*o),f=Math.sqrt(l*l+h*h),d=(Math.abs(c)+Math.abs(f))/2,m=this.fontSize/n,g=r._view.resolution;for(const y of this._activePagesMeshData)y.mesh.shader.uniforms.uFWidth=d*t*m*g}super._render(r)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const r=Re.available[this._fontName];if(!r)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==r&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tint}set tint(r){if(this._tint!==r){this._tint=r;for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=r}}get align(){return this._align}set align(r){this._align!==r&&(this._align=r,this.dirty=!0)}get fontName(){return this._fontName}set fontName(r){if(!Re.available[r])throw new Error(`Missing BitmapFont "${r}"`);this._fontName!==r&&(this._fontName=r,this.dirty=!0)}get fontSize(){return this._fontSize??Re.available[this._fontName].size}set fontSize(r){this._fontSize!==r&&(this._fontSize=r,this.dirty=!0)}get anchor(){return this._anchor}set anchor(r){typeof r=="number"?this._anchor.set(r):this._anchor.copyFrom(r)}get text(){return this._text}set text(r){r=String(r??""),this._text!==r&&(this._text=r,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(r){this._maxWidth!==r&&(this._maxWidth=r,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(r){this._letterSpacing!==r&&(this._letterSpacing=r,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(r){r!==this._roundPixels&&(this._roundPixels=r,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(r){this._autoResolution=!1,this._resolution!==r&&(this._resolution=r,this.dirty=!0)}destroy(r){const{_textureCache:t}=this,n=Re.available[this._fontName].distanceFieldType==="none"?Vp:Yp;n.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],n.filter(i=>t[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=nt.EMPTY});for(const i in t)t[i].destroy(),delete t[i];this._font=null,this._textureCache=null,super.destroy(r)}};let ED=Gm;ED.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const TD=[".xml",".fnt"],AD={extension:{type:K.LoadParser,priority:Cr.Normal},test(r){return TD.includes(me.extname(r).toLowerCase())},async testParse(r){return Ko.test(r)||du.test(r)},async parse(r,t,e){const n=Ko.test(r)?Ko.parse(r):du.parse(r),{src:i}=t,{page:o}=n,l=[];for(let f=0;f<o.length;++f){const d=o[f].file,m=me.join(me.dirname(i),d);l.push(m)}const h=await e.load(l),c=l.map(f=>h[f]);return Re.install(n,c,!0)},async load(r,t){return(await Z.ADAPTER.fetch(r)).text()},unload(r){r.destroy()}};it.add(AD);const SD={A:"menlo-bold-0.png",B:"menlo-bold-1.png",C:"menlo-bold-2.png",D:"menlo-bold-3.png",E:"menlo-bold-4.png",F:"menlo-bold-5.png",G:"menlo-bold-6.png",H:"menlo-bold-7.png",I:"menlo-bold-8.png",J:"menlo-bold-9.png",K:"menlo-bold-10.png",L:"menlo-bold-11.png",M:"menlo-bold-12.png",N:"menlo-bold-13.png",O:"menlo-bold-14.png",P:"menlo-bold-15.png",Q:"menlo-bold-16.png",R:"menlo-bold-17.png",S:"menlo-bold-18.png",T:"menlo-bold-19.png",U:"menlo-bold-20.png",V:"menlo-bold-21.png",W:"menlo-bold-22.png",X:"menlo-bold-23.png",Y:"menlo-bold-24.png",Z:"menlo-bold-25.png",a:"menlo-bold-26.png",b:"menlo-bold-27.png",c:"menlo-bold-28.png",d:"menlo-bold-29.png",e:"menlo-bold-30.png",f:"menlo-bold-31.png",g:"menlo-bold-32.png",h:"menlo-bold-33.png",i:"menlo-bold-34.png",j:"menlo-bold-35.png",k:"menlo-bold-36.png",l:"menlo-bold-37.png",m:"menlo-bold-38.png",n:"menlo-bold-39.png",o:"menlo-bold-40.png",p:"menlo-bold-41.png",q:"menlo-bold-42.png",r:"menlo-bold-43.png",s:"menlo-bold-44.png",t:"menlo-bold-45.png",u:"menlo-bold-46.png",v:"menlo-bold-47.png",w:"menlo-bold-48.png",x:"menlo-bold-49.png",y:"menlo-bold-50.png",z:"menlo-bold-51.png",0:"menlo-bold-52.png",1:"menlo-bold-53.png",2:"menlo-bold-54.png",3:"menlo-bold-55.png",4:"menlo-bold-56.png",5:"menlo-bold-57.png",6:"menlo-bold-58.png",7:"menlo-bold-59.png",8:"menlo-bold-60.png",9:"menlo-bold-61.png","!":"menlo-bold-62.png","@":"menlo-bold-63.png","#":"menlo-bold-64.png",$:"menlo-bold-65.png","%":"menlo-bold-66.png","^":"menlo-bold-67.png","&":"menlo-bold-68.png","*":"menlo-bold-69.png","(":"menlo-bold-70.png",")":"menlo-bold-71.png","-":"menlo-bold-72.png",_:"menlo-bold-73.png","=":"menlo-bold-74.png","+":"menlo-bold-75.png",",":"menlo-bold-76.png",".":"menlo-bold-77.png","<":"menlo-bold-78.png",">":"menlo-bold-79.png","/":"menlo-bold-80.png","?":"menlo-bold-81.png",";":"menlo-bold-82.png",":":"menlo-bold-83.png",'"':"menlo-bold-84.png","'":"menlo-bold-85.png","[":"menlo-bold-86.png","]":"menlo-bold-87.png","{":"menlo-bold-88.png","}":"menlo-bold-89.png","\\":"menlo-bold-90.png","|":"menlo-bold-91.png","`":"menlo-bold-92.png","~":"menlo-bold-93.png","•":"menlo-bold-94.png"},CD={A:"menlo-bold-half-0.png",B:"menlo-bold-half-1.png",C:"menlo-bold-half-2.png",D:"menlo-bold-half-3.png",E:"menlo-bold-half-4.png",F:"menlo-bold-half-5.png",G:"menlo-bold-half-6.png",H:"menlo-bold-half-7.png",I:"menlo-bold-half-8.png",J:"menlo-bold-half-9.png",K:"menlo-bold-half-10.png",L:"menlo-bold-half-11.png",M:"menlo-bold-half-12.png",N:"menlo-bold-half-13.png",O:"menlo-bold-half-14.png",P:"menlo-bold-half-15.png",Q:"menlo-bold-half-16.png",R:"menlo-bold-half-17.png",S:"menlo-bold-half-18.png",T:"menlo-bold-half-19.png",U:"menlo-bold-half-20.png",V:"menlo-bold-half-21.png",W:"menlo-bold-half-22.png",X:"menlo-bold-half-23.png",Y:"menlo-bold-half-24.png",Z:"menlo-bold-half-25.png",a:"menlo-bold-half-26.png",b:"menlo-bold-half-27.png",c:"menlo-bold-half-28.png",d:"menlo-bold-half-29.png",e:"menlo-bold-half-30.png",f:"menlo-bold-half-31.png",g:"menlo-bold-half-32.png",h:"menlo-bold-half-33.png",i:"menlo-bold-half-34.png",j:"menlo-bold-half-35.png",k:"menlo-bold-half-36.png",l:"menlo-bold-half-37.png",m:"menlo-bold-half-38.png",n:"menlo-bold-half-39.png",o:"menlo-bold-half-40.png",p:"menlo-bold-half-41.png",q:"menlo-bold-half-42.png",r:"menlo-bold-half-43.png",s:"menlo-bold-half-44.png",t:"menlo-bold-half-45.png",u:"menlo-bold-half-46.png",v:"menlo-bold-half-47.png",w:"menlo-bold-half-48.png",x:"menlo-bold-half-49.png",y:"menlo-bold-half-50.png",z:"menlo-bold-half-51.png",0:"menlo-bold-half-52.png",1:"menlo-bold-half-53.png",2:"menlo-bold-half-54.png",3:"menlo-bold-half-55.png",4:"menlo-bold-half-56.png",5:"menlo-bold-half-57.png",6:"menlo-bold-half-58.png",7:"menlo-bold-half-59.png",8:"menlo-bold-half-60.png",9:"menlo-bold-half-61.png","!":"menlo-bold-half-62.png","@":"menlo-bold-half-63.png","#":"menlo-bold-half-64.png",$:"menlo-bold-half-65.png","%":"menlo-bold-half-66.png","^":"menlo-bold-half-67.png","&":"menlo-bold-half-68.png","*":"menlo-bold-half-69.png","(":"menlo-bold-half-70.png",")":"menlo-bold-half-71.png","-":"menlo-bold-half-72.png",_:"menlo-bold-half-73.png","=":"menlo-bold-half-74.png","+":"menlo-bold-half-75.png",",":"menlo-bold-half-76.png",".":"menlo-bold-half-77.png","<":"menlo-bold-half-78.png",">":"menlo-bold-half-79.png","/":"menlo-bold-half-80.png","?":"menlo-bold-half-81.png",";":"menlo-bold-half-82.png",":":"menlo-bold-half-83.png",'"':"menlo-bold-half-84.png","'":"menlo-bold-half-85.png","[":"menlo-bold-half-86.png","]":"menlo-bold-half-87.png","{":"menlo-bold-half-88.png","}":"menlo-bold-half-89.png","\\":"menlo-bold-half-90.png","|":"menlo-bold-half-91.png","`":"menlo-bold-half-92.png","~":"menlo-bold-half-93.png","•":"menlo-bold-half-94.png"};let Hm;const $m={width:100,height:46},pi=window.innerWidth/$m.width,On={};async function ID(r){Hm=new Nu({view:r,width:window.innerWidth,height:pi*$m.height,autoDensity:!0,resolution:window.devicePixelRatio||1}),await RD()}const RD=async()=>(On.ascii=await Dn.load("/forcecrusher/fonts/menlo-bold.json"),On.text=await Dn.load("/forcecrusher/fonts/menlo-bold-half.json"),On.tile=await Dn.load("/forcecrusher/tile.png"),On),PD=r=>On.ascii.textures[SD[r]],MD=r=>On.text.textures[CD[r]],DD=()=>On.tile;class _r{constructor(t){Zt(this,"x",0);Zt(this,"y",0);Zt(this,"halfWidth",!1);Zt(this,"width");Zt(this,"height");Zt(this,"layers",[]);Zt(this,"sprites",[]);Zt(this,"tileSets",[]);Zt(this,"tints",[]);Zt(this,"alphas",[]);Zt(this,"visible",!0);Zt(this,"_getTexture",t=>{const{tileSet:e,char:n}=t;return e==="ascii"?PD(n):e==="text"?MD(n):DD()});Zt(this,"_createSprite",t=>{const{char:e,width:n,height:i,layer:o,x:l,y:h,tileSet:c,tint:f=16777215,alpha:d=1}=t,m=this._getTexture({tileSet:c,char:e});let g=new Oi(m);g.width=this.halfWidth?n/2:n,g.height=i,g.x=this.halfWidth?l*(n/2):l*n,g.y=h*i,g.tint=f,g.alpha=d,this.sprites[o][h][l]=g,this.layers[o].addChild(g)});Zt(this,"updateCell",t=>(Object.keys(t).forEach(e=>{const{char:n,tint:i,alpha:o,tileSet:l,x:h,y:c}=t[e];this.updateSprite({char:n,tint:i,alpha:o,tileSet:l,x:h,y:c,layer:parseInt(e)})}),this));Zt(this,"updateSprite",async t=>{const{char:e="",layer:n,x:i,y:o,tileSet:l="text",tint:h,alpha:c}=t,f=this.sprites[n][o][i];if(f)return f.texture=this._getTexture({tileSet:l,char:e}),h&&(f.tint=h),typeof c<"u"&&(f.alpha=c),this});Zt(this,"updateRows",t=>(t.forEach((e,n)=>{e.forEach((i,o)=>{this.clearRow(o,n),this.updateRow({...i,layer:o,y:n})})}),this));Zt(this,"updateRow",t=>{const{string:e="",layer:n=0,x:i,y:o,tileSet:l,tint:h,alpha:c}=t;return[...e].forEach((d,m)=>this.updateSprite({char:d,layer:n||0,x:i||0+m,y:o||0,tileSet:l||this.tileSets[n],tint:h||this.tints[n],alpha:c||this.alphas[n]})),(l||this.tileSets[n])==="tile"&&wn.times(this.width,d=>{this.updateSprite({layer:n,x:i||0+d,y:o||0,tileSet:l||this.tileSets[n],tint:h||this.tints[n],alpha:c||this.alphas[n]})}),this});Zt(this,"clearRow",(t,e)=>{const n=new Array(this.width+1).join(" ");this.updateRow({string:n,layer:t,y:e})});Zt(this,"clearView",()=>{let t=0;this.layers.forEach(()=>{wn.times(this.height,e=>{this.clearRow(t,e)}),t+=1})});Zt(this,"show",()=>{this.visible=!0,this.layers.forEach(t=>t.visible=this.visible)});Zt(this,"hide",()=>{this.visible=!1,this.layers.forEach(t=>t.visible=this.visible)});return this.width=t.width,this.height=t.height,this.tileSets=t.tileSets,this.tints=t.tints,this.alphas=t.alphas,this.halfWidth=this.tileSets.includes("text"),this.visible=t.visible,wn.times(t.layers,()=>this.layers.push(new ke)),this.layers.forEach(e=>{const n=this.halfWidth?t.x*(pi/2):t.x*pi,i=t.y*pi;e.x=n,e.y=i,e.interactiveChildren=!1,e.visible=this.visible,Hm.stage.addChild(e)}),wn.times(t.layers,()=>this.sprites.push(Array.from(Array(this.height),()=>Array.from(Array(this.width))))),wn.times(t.layers,e=>{wn.times(this.height,n=>{wn.times(this.width,async i=>{this._createSprite({char:"",width:pi,height:pi,layer:e,x:i,y:n,tileSet:t.tileSets[e],tint:t.tints[e],alpha:t.alphas[e]})})})}),this}}var Wm={exports:{}},$u={};Object.defineProperty($u,"__esModule",{value:!0});function pu(r,t){t=r.length;for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function BD(r){if(Array.isArray(r))return pu(r)}function OD(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Xm(r,t){if(r){if(typeof r=="string")return pu(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return pu(r,t)}}function FD(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LD(r){return BD(r)||OD(r)||Xm(r)||FD()}function ND(r,t){var e=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=Xm(r))||t){e&&(r=e);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,h;return{s:function(){e=e.call(r)},n:function(){var c=e.next();return o=c.done,c},e:function(c){l=!0,h=c},f:function(){try{!o&&e.return!=null&&e.return()}finally{if(l)throw h}}}}function UD(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function kD(r,t){if(typeof r!="object"||r===null)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var n=e.call(r,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function zm(r){var t=kD(r,"string");return typeof t=="symbol"?t:String(t)}function GD(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,zm(n.key),n)}}function HD(r,t,e){return t&&GD(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function $D(r,t,e){return t=zm(t),t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}var WD=function(){function r(){UD(this,r),$D(this,"subscribers",new Set)}return HD(r,[{key:"onSubscribe",get:function(){return this._onSubscribe||(this._onSubscribe=new r),this._onSubscribe}},{key:"onUnsubscribe",get:function(){return this._onUnsubscribe||(this._onUnsubscribe=new r),this._onUnsubscribe}},{key:"subscribe",value:function(e){var n,i=this;return this.subscribers.add(e),(n=this._onSubscribe)===null||n===void 0||n.emit(e),function(){return i.unsubscribe(e)}}},{key:"unsubscribe",value:function(e){var n;this.subscribers.delete(e),(n=this._onUnsubscribe)===null||n===void 0||n.emit(e)}},{key:"clear",value:function(){if(this._onUnsubscribe){var e=ND(this.subscribers),n;try{for(e.s();!(n=e.n()).done;){var i=n.value;this._onUnsubscribe.emit(i)}}catch(o){e.e(o)}finally{e.f()}}this.subscribers.clear()}},{key:"emit",value:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.subscribers.forEach(function(o){return o.apply(void 0,n)})}},{key:"emitAsync",value:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Promise.all(LD(this.subscribers).map(function(o){return o.apply(void 0,n)}))}}]),r}();$u.Event=WD;Wm.exports=$u;var qp=Wm.exports;function Kp(r,t){t=r.length;for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function XD(r,t){if(r){if(typeof r=="string")return Kp(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Kp(r,t)}}function zD(r,t){var e=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=XD(r))||t){e&&(r=e);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,h;return{s:function(){e=e.call(r)},n:function(){var c=e.next();return o=c.done,c},e:function(c){l=!0,h=c},f:function(){try{!o&&e.return!=null&&e.return()}finally{if(l)throw h}}}}function VD(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function YD(r,t){if(typeof r!="object"||r===null)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var n=e.call(r,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function Vm(r){var t=YD(r,"string");return typeof t=="symbol"?t:String(t)}function jD(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,Vm(n.key),n)}}function qD(r,t,e){return t&&jD(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Ho(r,t,e){return t=Vm(t),t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}var Ym;Ym=Symbol.iterator;var jm=function(){function r(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];VD(this,r),Ho(this,"_version",0),Ho(this,"onEntityAdded",new qp.Event),Ho(this,"onEntityRemoved",new qp.Event),Ho(this,"entityPositions",new Map),this._entities=t,this.add=this.add.bind(this),this.remove=this.remove.bind(this);for(var e=0;e<t.length;e++)this.entityPositions.set(t[e],e)}return qD(r,[{key:"version",get:function(){return this._version}},{key:"entities",get:function(){return this._entities}},{key:Ym,value:function(){var e=this,n=this._entities.length,i={value:void 0,done:!1};return{next:function(){return i.value=e._entities[--n],i.done=n<0,i}}}},{key:"size",get:function(){return this.entities.length}},{key:"first",get:function(){return this.entities[0]}},{key:"has",value:function(e){return this.entityPositions.has(e)}},{key:"add",value:function(e){return e&&!this.has(e)&&(this.entities.push(e),this.entityPositions.set(e,this.entities.length-1),this._version++,this.onEntityAdded.emit(e)),e}},{key:"remove",value:function(e){if(this.has(e)){this.onEntityRemoved.emit(e);var n=this.entityPositions.get(e);this.entityPositions.delete(e);var i=this.entities[this.entities.length-1];i!==e&&(this.entities[n]=i,this.entityPositions.set(i,n)),this.entities.pop(),this._version++}return e}},{key:"clear",value:function(){var e=zD(this),n;try{for(e.s();!(n=e.n()).done;){var i=n.value;this.remove(i)}}catch(o){e.e(o)}finally{e.f()}}}]),r}(),Zp=new WeakMap,Jp=0,KD=function(t){var e=Zp.get(t);return e!==void 0?e:(Zp.set(t,Jp),Jp++)};function ZD(){var r=new Array;function t(i){r.push(i)}function e(){r.length=0}function n(){r.forEach(function(i){return i()}),e()}return t.clear=e,t.flush=n,t}function gu(r,t){t=r.length;for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function JD(r){if(Array.isArray(r))return gu(r)}function QD(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function qm(r,t){if(r){if(typeof r=="string")return gu(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return gu(r,t)}}function tB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gs(r){return JD(r)||QD(r)||qm(r)||tB()}function $n(r){return $n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$n(r)}function eB(r,t){for(;!Object.prototype.hasOwnProperty.call(r,t)&&(r=$n(r),r!==null););return r}function ms(){return typeof Reflect<"u"&&Reflect.get?ms=Reflect.get.bind():ms=function(t,e,n){var i=eB(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ms.apply(this,arguments)}function mu(r,t){var e=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=qm(r))||t){e&&(r=e);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,h;return{s:function(){e=e.call(r)},n:function(){var c=e.next();return o=c.done,c},e:function(c){l=!0,h=c},f:function(){try{!o&&e.return!=null&&e.return()}finally{if(l)throw h}}}}function rB(r,t){if(typeof r!="object"||r===null)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var n=e.call(r,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function Km(r){var t=rB(r,"string");return typeof t=="symbol"?t:String(t)}function yi(r,t,e){return t=Km(t),t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function Qp(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function Rn(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Qp(Object(e),!0).forEach(function(n){yi(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):Qp(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}function Zm(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function nB(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,Km(n.key),n)}}function Jm(r,t,e){return t&&nB(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function vi(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _u(r,t){return _u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_u(r,t)}function Qm(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&_u(r,t)}function iB(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sB(r,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vi(r)}function t_(r){var t=iB();return function(){var n=$n(r),i;if(t){var o=$n(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return sB(this,i)}}var e_,oB=function(r){Qm(e,r);var t=t_(e);function e(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Zm(this,e),n=t.call(this,i),yi(vi(n),"queries",new Set),yi(vi(n),"entityToId",new Map),yi(vi(n),"idToEntity",new Map),yi(vi(n),"nextId",0),n.onEntityAdded.subscribe(function(o){n.reindex(o)}),n.onEntityRemoved.subscribe(function(o){if(n.queries.forEach(function(h){return h.remove(o)}),n.entityToId.has(o)){var l=n.entityToId.get(o);n.idToEntity.delete(l),n.entityToId.delete(o)}}),n}return Jm(e,[{key:"update",value:function(n){function i(o,l,h){return n.apply(this,arguments)}return i.toString=function(){return n.toString()},i}(function(n,i,o){if(typeof i=="function"){var l=i(n);l&&Object.assign(n,l)}else typeof i=="string"?n[i]=o:i&&Object.assign(n,i);return this.reindex(n),n})},{key:"addComponent",value:function(i,o,l){i[o]===void 0&&(i[o]=l,this.reindex(i))}},{key:"removeComponent",value:function(i,o){if(i[o]!==void 0){if(this.has(i)){var l=Rn({},i);delete l[o],this.reindex(i,l)}delete i[o]}}},{key:"query",value:function(i){var o=hB(i),l=r_(o),h=mu(this.queries),c;try{for(h.s();!(c=h.n()).done;){var f=c.value;if(f.key===l)return f}}catch(m){h.e(m)}finally{h.f()}var d=new aB(this,o);return this.queries.add(d),d}},{key:"with",value:function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return this.query({with:o,without:[],predicates:[]})}},{key:"without",value:function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return this.query({with:[],without:o,predicates:[]})}},{key:"where",value:function(i){return this.query({with:[],without:[],predicates:[i]})}},{key:"reindex",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(this.has(i)){var l=mu(this.queries),h;try{for(l.s();!(h=l.n()).done;){var c=h.value;c.evaluate(i,o)}}catch(f){l.e(f)}finally{l.f()}}}},{key:"id",value:function(i){if(this.has(i)){if(!this.entityToId.has(i)){var o=this.nextId++;this.entityToId.set(i,o),this.idToEntity.set(o,i)}return this.entityToId.get(i)}}},{key:"entity",value:function(i){return this.idToEntity.get(i)}}]),e}(jm);e_=Symbol.iterator;var aB=function(r){Qm(e,r);var t=t_(e);function e(n,i){var o;return Zm(this,e),o=t.call(this),yi(vi(o),"_isConnected",!1),o.world=n,o.config=i,o.key=r_(i),o.onEntityAdded.onSubscribe.subscribe(function(){return o.connect()}),o.onEntityRemoved.onSubscribe.subscribe(function(){return o.connect()}),o}return Jm(e,[{key:"isConnected",get:function(){return this._isConnected}},{key:"entities",get:function(){return this._isConnected||this.connect(),ms($n(e.prototype),"entities",this)}},{key:e_,value:function(){return this._isConnected||this.connect(),ms($n(e.prototype),Symbol.iterator,this).call(this)}},{key:"connect",value:function(){if(!this._isConnected){this._isConnected=!0;var i=mu(this.world),o;try{for(i.s();!(o=i.n()).done;){var l=o.value;this.evaluate(l)}}catch(h){i.e(h)}finally{i.f()}}return this}},{key:"disconnect",value:function(){return this._isConnected=!1,this}},{key:"with",value:function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return this.world.query(Rn(Rn({},this.config),{},{with:[].concat(gs(this.config.with),o)}))}},{key:"without",value:function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return this.world.query(Rn(Rn({},this.config),{},{without:[].concat(gs(this.config.without),o)}))}},{key:"where",value:function(i){return this.world.query(Rn(Rn({},this.config),{},{predicates:[].concat(gs(this.config.predicates),[i])}))}},{key:"want",value:function(i){return this.config.with.every(function(o){return i[o]!==void 0})&&this.config.without.every(function(o){return i[o]===void 0})&&this.config.predicates.every(function(o){return o(i)})}},{key:"evaluate",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(this.isConnected){var l=this.want(o),h=this.has(i);l&&!h?this.add(i):!l&&h&&this.remove(i)}}}]),e}(jm),tg=function(t){return gs(new Set(t.sort().filter(function(e){return!!e&&e!==""})))};function lB(r){return gs(new Set(r))}function hB(r){return{with:tg(r.with),without:tg(r.without),predicates:lB(r.predicates)}}function r_(r){return"".concat(r.with.join(","),":").concat(r.without.join(","),":").concat(r.predicates.map(function(t){return KD(t)}).join(","))}ZD();const Bt=new oB,Ta=r=>`${r.x},${r.y},${r.z}`,eg=(r,t)=>{const{x:e,y:n,z:i,width:o,height:l,hasWalls:h}=r,c={},f=e,d=e+o,m=n,g=n+l;if(h)for(let v=m+1;v<g-1;v++)for(let T=f+1;T<d-1;T++)c[`${T},${v},${i}`]={x:T,y:v,z:i,...t};else for(let v=m;v<g;v++)for(let T=f;T<d;T++)c[`${T},${v},${i}`]={x:T,y:v,z:i,...t};const y={x:Math.round((f+d)/2),y:Math.round((m+g)/2),z:i};return{x1:f,x2:d,y1:m,y2:g,z:i,center:y,hasWalls:h,tiles:c,width:o,height:l}},uB=(r,t)=>r.x1<=t.x2&&r.x2>=t.x1&&r.y1<=t.y2&&r.y2>=t.y1,cB=[{xx:1,xy:0,yx:0,yy:1},{xx:1,xy:0,yx:0,yy:-1},{xx:-1,xy:0,yx:0,yy:1},{xx:-1,xy:0,yx:0,yy:-1},{xx:0,xy:1,yx:1,yy:0},{xx:0,xy:1,yx:-1,yy:0},{xx:0,xy:-1,yx:1,yy:0},{xx:0,xy:-1,yx:-1,yy:0}];function fB(r,t,e,n,i){const{x:o,y:l,z:h}=n,c=new Set,f=new Set;for(const y of r)y.position.z===h&&f.add(Ta(y.position));const d=(y,v)=>{const T=`${y},${v},${h}`;return!!f.has(T)},m=(y,v)=>c.add(`${y},${v},${h}`);function g(y,v,T,E,I,P,w){let R=0;if(E<I)return;let O=!1;for(let W=T;W<w&&!O;W++){let k=-W;for(let U=-W;U<=0;U++){let Y=y+U*P.xx+k*P.xy,J=v+U*P.yx+k*P.yy,z=(U-.5)/(k+.5),q=(U+.5)/(k-.5);if(!(!(Y>=0&&J>=0&&Y<t&&J<e)||E<q)){if(I>z)break;if(Math.sqrt(U*U+k*k)<=w&&m(Y,J),O)if(d(Y,J)){R=q;continue}else O=!1,E=R;else d(Y,J)&&W<w&&(O=!0,g(y,v,W+1,E,z,P,w),R=q)}}}}m(o,l);for(let y of cB)g(o,l,1,1,0,y,i);return{fov:c}}const dB=Bt.with("inFov","position"),pB=Bt.with("opaque","position"),gB=Bt.with("pc","position"),mB=Bt.with("appearance","position"),yu=()=>{let r;for(const e of gB)r=e;if(!r)return;const t=fB(pB,74,39,r.position,10);for(const e of dB)Bt.removeComponent(e,"inFov");for(const e of mB)t.fov.has(Ta(e.position))&&(Bt.addComponent(e,"inFov",!0),Bt.addComponent(e,"revealed",!0))},_B=Bt.with("position","tryMove").without("paused"),yB=Bt.with("blocking","position").without("paused"),rg=()=>{for(const r of _B){const{position:t,tryMove:e}=r;for(const n of yB)if(n.position.x===r.tryMove.x&&n.position.y===r.tryMove.y)return Bt.removeComponent(r,"tryMove"),console.log(`blocked by ${n.name}`);t.x=e.x,t.y=e.y,t.z=e.z,Bt.removeComponent(r,"tryMove")}},vB=Bt.with("position","appearance","inFov","layer100"),xB=Bt.with("position","appearance","inFov","layer200"),bB=Bt.with("position","appearance","inFov","layer300"),wB=Bt.with("position","appearance","inFov","layer400"),EB=Bt.with("position","appearance","revealed","layer200").without("inFov"),TB=Bt.with("position","appearance","revealed","layer100").without("inFov"),AB=Bt.with("position","appearance","revealed","layer300").without("inFov"),SB=Bt.with("position","appearance","revealed","layer400").without("inFov"),tn=(r,t,e)=>{const{appearance:n,position:i}=t;if(!n||!i)return;const{char:o,tint:l,tileSet:h}=n,{x:c,y:f}=i;r==null||r.updateCell({0:{char:o,tint:65280,alpha:0,tileSet:"tile",x:c,y:f},1:{char:o,tint:l,alpha:e,tileSet:h,x:c,y:f}})},vu=()=>{const r=vr().views.map;if(r){for(const t of vB)tn(r,t,1);for(const t of xB)tn(r,t,1);for(const t of bB)tn(r,t,1);for(const t of wB)tn(r,t,1);for(const t of TB)tn(r,t,.35);for(const t of EB)tn(r,t,.35);for(const t of AB)tn(r,t,.35);for(const t of SB)tn(r,t,.35)}},CB=["ArrowLeft","ArrowDown","ArrowUp","ArrowRight","h","j","k","l"],IB=Bt.with("pc"),RB=()=>{const{userInput:r,gameState:t}=vr();if(!r)return Un(n=>{n.userInput=null});const{key:e}=r;if(t===s_.GAME&&CB.includes(e)){for(const n of IB)if(n!=null&&n.position){const{x:i,y:o,z:l}=n.position;if(e==="h"||e==="ArrowLeft"){const h={x:i-1,y:o,z:l};Bt.addComponent(n,"tryMove",h)}if(e==="j"||e==="ArrowDown"){const h={x:i,y:o+1,z:l};Bt.addComponent(n,"tryMove",h)}if(e==="k"||e==="ArrowUp"){const h={x:i,y:o-1,z:l};Bt.addComponent(n,"tryMove",h)}if(e==="l"||e==="ArrowRight"){const h={x:i+1,y:o,z:l};Bt.addComponent(n,"tryMove",h)}}}Un(n=>{n.userInput=null})};var Fi=(r=>(r.default="?",r.floor="•",r.owlbear="F",r.player="@",r.potion="!",r.rat="r",r.rock="*",r.wall="#",r))(Fi||{}),Li=(r=>(r[r.default=65399]="default",r[r.floor=3355443]="floor",r[r.owlbear=11027200]="owlbear",r[r.player=16777215]="player",r[r.potion=14329120]="potion",r[r.rat=14047863]="rat",r[r.rock=8355711]="rock",r[r.wall=8421504]="wall",r))(Li||{});const Aa={appearance:{char:Fi.default,tint:Li.default,tileSet:"ascii"},position:{x:0,y:0,z:0},name:"default"},n_={layer100:!0},i_={health:{max:1,current:1},blocking:!0,layer300:!0},PB={...Aa,...i_,appearance:{char:Fi.player,tint:Li.player,tileSet:"ascii"},health:{max:10,current:10},name:"player",pc:!0},MB={...Aa,...n_,appearance:{char:Fi.wall,tint:Li.wall,tileSet:"ascii"},blocking:!0,opaque:!0,name:"wall"},DB={...Aa,...n_,appearance:{char:Fi.floor,tint:Li.floor,tileSet:"ascii"},name:"floor"},BB={...Aa,...i_,appearance:{char:Fi.rat,tint:Li.rat,tileSet:"ascii"},health:{max:1,current:1},name:"rat"};function OB(r,t){const e={},n=Math.min(r.x,t.x),i=Math.max(r.x,t.x)+1;let o=n;for(;o<i;){const l={...t,x:o};e[Ta(l)]={...l,sprite:"FLOOR"},o++}return e}function FB(r,t){const e={},n=Math.min(r.y,t.y),i=Math.max(r.y,t.y)+1;let o=n;for(;o<i;){const l={...r,y:o};e[Ta(l)]={...l,sprite:"FLOOR"},o++}return e}const LB=r=>{const{pos:t,width:e,height:n,minRoomSize:i=6,maxRoomSize:o=12,maxRoomCount:l=30}=r,{x:h,y:c,z:f}=t,d={...eg({x:h,y:c,z:f,width:e,height:n,hasWalls:!1},{sprite:"WALL"}),rooms:[]};let m={};Pn.times(l,()=>{let v=Pn.random(i,o),T=Pn.random(i,o),E=Pn.random(h,e+h-v-1),I=Pn.random(c,n+c-T-1);const P=eg({x:E,y:I,z:f,width:v,height:T,hasWalls:!0},{sprite:"FLOOR"});d.rooms.some(w=>uB(w,P))||(d.rooms.push(P),m={...m,...P.tiles})});let g=null,y={};for(let v of d.rooms)g&&(y={...y,...OB(v.center,g.center),...FB(v.center,g.center)}),g=v;return d.tiles={...d.tiles,...m,...y},d},NB=()=>{const r=LB({pos:{x:0,y:0,z:0},width:74,height:39,minRoomSize:8,maxRoomSize:18,maxRoomCount:100}),t=Object.values(r.tiles);for(const e of t){if(e.sprite==="WALL"){const{x:n,y:i,z:o}=e;Bt.add({...MB,position:{x:n,y:i,z:o}})}if(e.sprite==="FLOOR"){const{x:n,y:i,z:o}=e;Bt.add({...DB,position:{x:n,y:i,z:o}})}}return r.rooms.forEach((e,n)=>{n&&Bt.add({...BB,position:e.center})}),r};var s_=(r=>(r.GAME="GAME",r.GAME_OVER="GAME_OVER",r.INVENTORY="INVENTORY",r.INSPECT="INSPECT",r.TARGET="TARGET",r))(s_||{});window.skulltooth=window.skulltooth||{};const Wu={fps:0,views:{},userInput:null,turn:"PLAYER",gameState:"GAME"};window.skulltooth.state=Wu;const Un=r=>{r(Wu)},vr=()=>Wu,UB=async()=>{await ID(document.querySelector("#canvas")),new _r({width:12,height:2,x:0,y:0,layers:2,tileSets:["tile","text"],tints:[16777215,16711799],alphas:[1,1],visible:!0}).updateRows([[{},{string:"skulltooth 2"}],[{tint:16711799},{string:"forcecrusher",tint:16777215}]]);const r=new _r({width:25,height:42,x:0,y:2,layers:1,tileSets:["text"],tints:[16711799],alphas:[1],visible:!0}),t=new _r({width:74,height:5,x:26,y:0,layers:1,tileSets:["text"],tints:[15658734],alphas:[1],visible:!0}),e=new _r({width:74,height:5,x:100,y:0,layers:1,tileSets:["text"],tints:[16711799],alphas:[1],visible:!0}),n=new _r({width:74,height:39,x:13,y:5,layers:3,tileSets:["tile","ascii","tile"],tints:[0,0,0],alphas:[1,1,0],visible:!0}),i=new _r({width:12,height:1,x:0,y:44,layers:1,tileSets:["text"],tints:[14540253],alphas:[1],visible:!0}).updateRows([[{string:"FPS: calc..."}]]);new _r({width:12,height:1,x:0,y:45,layers:1,tileSets:["text"],tints:[16777215],alphas:[1],visible:!0}).updateRows([[{string:"TAG: 566671d"}]]);const o=new _r({width:148,height:2,x:26,y:44,layers:1,tileSets:["text"],tints:[15658734],alphas:[1],visible:!0}),l=new _r({width:100,height:44,x:0,y:0,layers:1,tileSets:["tile"],tints:[1118481],alphas:[.75],visible:!1}),h=new _r({width:148,height:39,x:26,y:5,layers:2,tileSets:["text","text"],tints:[1118481,16777215],alphas:[1],visible:!1});Un(m=>{m.views.fps=i,m.views.map=n,m.views.log=t,m.views.senses=e,m.views.legend=r,m.views.inventory=h,m.views.menuUnderlay=l,m.views.controls=o});const f=NB().rooms[0].center,d=Bt.add(PB);d.position.x=f.x,d.position.y=f.y,d.position.z=f.z,yu(),vu(),o_(),document.addEventListener("keydown",m=>{Un(g=>{g.userInput=m})})};let Rh=0,$o=Date.now(),Wo=[];function o_(){var r;requestAnimationFrame(o_),vr().gameState==="GAME"&&(vr().userInput&&vr().turn==="PLAYER"&&(RB(),rg(),yu(),vu(),vr().gameState==="GAME"&&Un(t=>{t.turn="WORLD"})),vr().turn==="WORLD"&&(rg(),yu(),vu(),Un(t=>{t.turn="PLAYER"}))),$o||($o=Date.now()),Date.now()-$o>1e3&&(Wo.unshift(Rh),Wo.length>3&&Wo.pop(),isNaN(vr().fps)||(r=vr().views.fps)==null||r.updateRow({string:`FPS: ${vr().fps}     `,layer:0,x:0,y:0,tileSet:"text"}),$o=Date.now(),Rh=0),Un(t=>t.fps=Math.round(Pn.mean(Wo))),Rh++}UB();
