var ZE=Object.defineProperty;var JE=(e,t,r)=>t in e?ZE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Zt=(e,t,r)=>(JE(e,typeof t!="symbol"?t+"":t,r),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();var Ir=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ga(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function QE(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}),r}var _a={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */_a.exports;(function(e,t){(function(){var r,i="4.17.21",n=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",h="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",f=500,d="__lodash_placeholder__",g=1,m=2,v=4,_=1,w=2,x=1,A=2,S=4,E=8,I=16,D=32,L=64,O=128,F=256,X=512,j=30,z="...",K=800,W=16,k=1,at=2,dt=3,Y=1/0,yt=9007199254740991,Ot=17976931348623157e292,H=NaN,rt=4294967295,bt=rt-1,Pt=rt>>>1,Mt=[["ary",O],["bind",x],["bindKey",A],["curry",E],["curryRight",I],["flip",X],["partial",D],["partialRight",L],["rearg",F]],Nt="[object Arguments]",kt="[object Array]",ie="[object AsyncFunction]",Yt="[object Boolean]",ne="[object Date]",oe="[object DOMException]",Dt="[object Error]",Ut="[object Function]",jt="[object GeneratorFunction]",qt="[object Map]",ye="[object Number]",vi="[object Null]",yr="[object Object]",Pc="[object Promise]",gy="[object Proxy]",jn="[object RegExp]",tr="[object Set]",qn="[object String]",Hs="[object Symbol]",my="[object Undefined]",Kn="[object WeakMap]",vy="[object WeakSet]",Zn="[object ArrayBuffer]",Ji="[object DataView]",Ja="[object Float32Array]",Qa="[object Float64Array]",tl="[object Int8Array]",el="[object Int16Array]",rl="[object Int32Array]",il="[object Uint8Array]",nl="[object Uint8ClampedArray]",sl="[object Uint16Array]",ol="[object Uint32Array]",yy=/\b__p \+= '';/g,_y=/\b(__p \+=) '' \+/g,xy=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Rc=/&(?:amp|lt|gt|quot|#39);/g,Mc=/[&<>"']/g,by=RegExp(Rc.source),wy=RegExp(Mc.source),Ey=/<%-([\s\S]+?)%>/g,Ty=/<%([\s\S]+?)%>/g,Dc=/<%=([\s\S]+?)%>/g,Ay=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Sy=/^\w*$/,Cy=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,al=/[\\^$.*+?()[\]{}|]/g,Iy=RegExp(al.source),ll=/^\s+/,Py=/\s/,Ry=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,My=/\{\n\/\* \[wrapped with (.+)\] \*/,Dy=/,? & /,By=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Oy=/[()=,{}\[\]\/\s]/,Fy=/\\(\\)?/g,Ly=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Bc=/\w*$/,Ny=/^[-+]0x[0-9a-f]+$/i,ky=/^0b[01]+$/i,Uy=/^\[object .+?Constructor\]$/,Gy=/^0o[0-7]+$/i,Wy=/^(?:0|[1-9]\d*)$/,$y=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Xs=/($^)/,Hy=/['\n\r\u2028\u2029\\]/g,zs="\\ud800-\\udfff",Xy="\\u0300-\\u036f",zy="\\ufe20-\\ufe2f",Vy="\\u20d0-\\u20ff",Oc=Xy+zy+Vy,Fc="\\u2700-\\u27bf",Lc="a-z\\xdf-\\xf6\\xf8-\\xff",Yy="\\xac\\xb1\\xd7\\xf7",jy="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",qy="\\u2000-\\u206f",Ky=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Nc="A-Z\\xc0-\\xd6\\xd8-\\xde",kc="\\ufe0e\\ufe0f",Uc=Yy+jy+qy+Ky,hl="['’]",Zy="["+zs+"]",Gc="["+Uc+"]",Vs="["+Oc+"]",Wc="\\d+",Jy="["+Fc+"]",$c="["+Lc+"]",Hc="[^"+zs+Uc+Wc+Fc+Lc+Nc+"]",ul="\\ud83c[\\udffb-\\udfff]",Qy="(?:"+Vs+"|"+ul+")",Xc="[^"+zs+"]",cl="(?:\\ud83c[\\udde6-\\uddff]){2}",fl="[\\ud800-\\udbff][\\udc00-\\udfff]",Qi="["+Nc+"]",zc="\\u200d",Vc="(?:"+$c+"|"+Hc+")",t_="(?:"+Qi+"|"+Hc+")",Yc="(?:"+hl+"(?:d|ll|m|re|s|t|ve))?",jc="(?:"+hl+"(?:D|LL|M|RE|S|T|VE))?",qc=Qy+"?",Kc="["+kc+"]?",e_="(?:"+zc+"(?:"+[Xc,cl,fl].join("|")+")"+Kc+qc+")*",r_="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",i_="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Zc=Kc+qc+e_,n_="(?:"+[Jy,cl,fl].join("|")+")"+Zc,s_="(?:"+[Xc+Vs+"?",Vs,cl,fl,Zy].join("|")+")",o_=RegExp(hl,"g"),a_=RegExp(Vs,"g"),dl=RegExp(ul+"(?="+ul+")|"+s_+Zc,"g"),l_=RegExp([Qi+"?"+$c+"+"+Yc+"(?="+[Gc,Qi,"$"].join("|")+")",t_+"+"+jc+"(?="+[Gc,Qi+Vc,"$"].join("|")+")",Qi+"?"+Vc+"+"+Yc,Qi+"+"+jc,i_,r_,Wc,n_].join("|"),"g"),h_=RegExp("["+zc+zs+Oc+kc+"]"),u_=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,c_=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],f_=-1,Gt={};Gt[Ja]=Gt[Qa]=Gt[tl]=Gt[el]=Gt[rl]=Gt[il]=Gt[nl]=Gt[sl]=Gt[ol]=!0,Gt[Nt]=Gt[kt]=Gt[Zn]=Gt[Yt]=Gt[Ji]=Gt[ne]=Gt[Dt]=Gt[Ut]=Gt[qt]=Gt[ye]=Gt[yr]=Gt[jn]=Gt[tr]=Gt[qn]=Gt[Kn]=!1;var Lt={};Lt[Nt]=Lt[kt]=Lt[Zn]=Lt[Ji]=Lt[Yt]=Lt[ne]=Lt[Ja]=Lt[Qa]=Lt[tl]=Lt[el]=Lt[rl]=Lt[qt]=Lt[ye]=Lt[yr]=Lt[jn]=Lt[tr]=Lt[qn]=Lt[Hs]=Lt[il]=Lt[nl]=Lt[sl]=Lt[ol]=!0,Lt[Dt]=Lt[Ut]=Lt[Kn]=!1;var d_={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},p_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},g_={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},m_={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},v_=parseFloat,y_=parseInt,Jc=typeof Ir=="object"&&Ir&&Ir.Object===Object&&Ir,__=typeof self=="object"&&self&&self.Object===Object&&self,de=Jc||__||Function("return this")(),pl=t&&!t.nodeType&&t,yi=pl&&!0&&e&&!e.nodeType&&e,Qc=yi&&yi.exports===pl,gl=Qc&&Jc.process,$e=function(){try{var R=yi&&yi.require&&yi.require("util").types;return R||gl&&gl.binding&&gl.binding("util")}catch{}}(),tf=$e&&$e.isArrayBuffer,ef=$e&&$e.isDate,rf=$e&&$e.isMap,nf=$e&&$e.isRegExp,sf=$e&&$e.isSet,of=$e&&$e.isTypedArray;function De(R,N,B){switch(B.length){case 0:return R.call(N);case 1:return R.call(N,B[0]);case 2:return R.call(N,B[0],B[1]);case 3:return R.call(N,B[0],B[1],B[2])}return R.apply(N,B)}function x_(R,N,B,Q){for(var ft=-1,It=R==null?0:R.length;++ft<It;){var ae=R[ft];N(Q,ae,B(ae),R)}return Q}function He(R,N){for(var B=-1,Q=R==null?0:R.length;++B<Q&&N(R[B],B,R)!==!1;);return R}function b_(R,N){for(var B=R==null?0:R.length;B--&&N(R[B],B,R)!==!1;);return R}function af(R,N){for(var B=-1,Q=R==null?0:R.length;++B<Q;)if(!N(R[B],B,R))return!1;return!0}function Kr(R,N){for(var B=-1,Q=R==null?0:R.length,ft=0,It=[];++B<Q;){var ae=R[B];N(ae,B,R)&&(It[ft++]=ae)}return It}function Ys(R,N){var B=R==null?0:R.length;return!!B&&tn(R,N,0)>-1}function ml(R,N,B){for(var Q=-1,ft=R==null?0:R.length;++Q<ft;)if(B(N,R[Q]))return!0;return!1}function Wt(R,N){for(var B=-1,Q=R==null?0:R.length,ft=Array(Q);++B<Q;)ft[B]=N(R[B],B,R);return ft}function Zr(R,N){for(var B=-1,Q=N.length,ft=R.length;++B<Q;)R[ft+B]=N[B];return R}function vl(R,N,B,Q){var ft=-1,It=R==null?0:R.length;for(Q&&It&&(B=R[++ft]);++ft<It;)B=N(B,R[ft],ft,R);return B}function w_(R,N,B,Q){var ft=R==null?0:R.length;for(Q&&ft&&(B=R[--ft]);ft--;)B=N(B,R[ft],ft,R);return B}function yl(R,N){for(var B=-1,Q=R==null?0:R.length;++B<Q;)if(N(R[B],B,R))return!0;return!1}var E_=_l("length");function T_(R){return R.split("")}function A_(R){return R.match(By)||[]}function lf(R,N,B){var Q;return B(R,function(ft,It,ae){if(N(ft,It,ae))return Q=It,!1}),Q}function js(R,N,B,Q){for(var ft=R.length,It=B+(Q?1:-1);Q?It--:++It<ft;)if(N(R[It],It,R))return It;return-1}function tn(R,N,B){return N===N?N_(R,N,B):js(R,hf,B)}function S_(R,N,B,Q){for(var ft=B-1,It=R.length;++ft<It;)if(Q(R[ft],N))return ft;return-1}function hf(R){return R!==R}function uf(R,N){var B=R==null?0:R.length;return B?bl(R,N)/B:H}function _l(R){return function(N){return N==null?r:N[R]}}function xl(R){return function(N){return R==null?r:R[N]}}function cf(R,N,B,Q,ft){return ft(R,function(It,ae,Ft){B=Q?(Q=!1,It):N(B,It,ae,Ft)}),B}function C_(R,N){var B=R.length;for(R.sort(N);B--;)R[B]=R[B].value;return R}function bl(R,N){for(var B,Q=-1,ft=R.length;++Q<ft;){var It=N(R[Q]);It!==r&&(B=B===r?It:B+It)}return B}function wl(R,N){for(var B=-1,Q=Array(R);++B<R;)Q[B]=N(B);return Q}function I_(R,N){return Wt(N,function(B){return[B,R[B]]})}function ff(R){return R&&R.slice(0,mf(R)+1).replace(ll,"")}function Be(R){return function(N){return R(N)}}function El(R,N){return Wt(N,function(B){return R[B]})}function Jn(R,N){return R.has(N)}function df(R,N){for(var B=-1,Q=R.length;++B<Q&&tn(N,R[B],0)>-1;);return B}function pf(R,N){for(var B=R.length;B--&&tn(N,R[B],0)>-1;);return B}function P_(R,N){for(var B=R.length,Q=0;B--;)R[B]===N&&++Q;return Q}var R_=xl(d_),M_=xl(p_);function D_(R){return"\\"+m_[R]}function B_(R,N){return R==null?r:R[N]}function en(R){return h_.test(R)}function O_(R){return u_.test(R)}function F_(R){for(var N,B=[];!(N=R.next()).done;)B.push(N.value);return B}function Tl(R){var N=-1,B=Array(R.size);return R.forEach(function(Q,ft){B[++N]=[ft,Q]}),B}function gf(R,N){return function(B){return R(N(B))}}function Jr(R,N){for(var B=-1,Q=R.length,ft=0,It=[];++B<Q;){var ae=R[B];(ae===N||ae===d)&&(R[B]=d,It[ft++]=B)}return It}function qs(R){var N=-1,B=Array(R.size);return R.forEach(function(Q){B[++N]=Q}),B}function L_(R){var N=-1,B=Array(R.size);return R.forEach(function(Q){B[++N]=[Q,Q]}),B}function N_(R,N,B){for(var Q=B-1,ft=R.length;++Q<ft;)if(R[Q]===N)return Q;return-1}function k_(R,N,B){for(var Q=B+1;Q--;)if(R[Q]===N)return Q;return Q}function rn(R){return en(R)?G_(R):E_(R)}function er(R){return en(R)?W_(R):T_(R)}function mf(R){for(var N=R.length;N--&&Py.test(R.charAt(N)););return N}var U_=xl(g_);function G_(R){for(var N=dl.lastIndex=0;dl.test(R);)++N;return N}function W_(R){return R.match(dl)||[]}function $_(R){return R.match(l_)||[]}var H_=function R(N){N=N==null?de:nn.defaults(de.Object(),N,nn.pick(de,c_));var B=N.Array,Q=N.Date,ft=N.Error,It=N.Function,ae=N.Math,Ft=N.Object,Al=N.RegExp,X_=N.String,Xe=N.TypeError,Ks=B.prototype,z_=It.prototype,sn=Ft.prototype,Zs=N["__core-js_shared__"],Js=z_.toString,Bt=sn.hasOwnProperty,V_=0,vf=function(){var s=/[^.]+$/.exec(Zs&&Zs.keys&&Zs.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),Qs=sn.toString,Y_=Js.call(Ft),j_=de._,q_=Al("^"+Js.call(Bt).replace(al,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),to=Qc?N.Buffer:r,Qr=N.Symbol,eo=N.Uint8Array,yf=to?to.allocUnsafe:r,ro=gf(Ft.getPrototypeOf,Ft),_f=Ft.create,xf=sn.propertyIsEnumerable,io=Ks.splice,bf=Qr?Qr.isConcatSpreadable:r,Qn=Qr?Qr.iterator:r,_i=Qr?Qr.toStringTag:r,no=function(){try{var s=Ti(Ft,"defineProperty");return s({},"",{}),s}catch{}}(),K_=N.clearTimeout!==de.clearTimeout&&N.clearTimeout,Z_=Q&&Q.now!==de.Date.now&&Q.now,J_=N.setTimeout!==de.setTimeout&&N.setTimeout,so=ae.ceil,oo=ae.floor,Sl=Ft.getOwnPropertySymbols,Q_=to?to.isBuffer:r,wf=N.isFinite,t0=Ks.join,e0=gf(Ft.keys,Ft),le=ae.max,_e=ae.min,r0=Q.now,i0=N.parseInt,Ef=ae.random,n0=Ks.reverse,Cl=Ti(N,"DataView"),ts=Ti(N,"Map"),Il=Ti(N,"Promise"),on=Ti(N,"Set"),es=Ti(N,"WeakMap"),rs=Ti(Ft,"create"),ao=es&&new es,an={},s0=Ai(Cl),o0=Ai(ts),a0=Ai(Il),l0=Ai(on),h0=Ai(es),lo=Qr?Qr.prototype:r,is=lo?lo.valueOf:r,Tf=lo?lo.toString:r;function b(s){if(Kt(s)&&!pt(s)&&!(s instanceof wt)){if(s instanceof ze)return s;if(Bt.call(s,"__wrapped__"))return Ad(s)}return new ze(s)}var ln=function(){function s(){}return function(a){if(!Ht(a))return{};if(_f)return _f(a);s.prototype=a;var c=new s;return s.prototype=r,c}}();function ho(){}function ze(s,a){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!a,this.__index__=0,this.__values__=r}b.templateSettings={escape:Ey,evaluate:Ty,interpolate:Dc,variable:"",imports:{_:b}},b.prototype=ho.prototype,b.prototype.constructor=b,ze.prototype=ln(ho.prototype),ze.prototype.constructor=ze;function wt(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=rt,this.__views__=[]}function u0(){var s=new wt(this.__wrapped__);return s.__actions__=Se(this.__actions__),s.__dir__=this.__dir__,s.__filtered__=this.__filtered__,s.__iteratees__=Se(this.__iteratees__),s.__takeCount__=this.__takeCount__,s.__views__=Se(this.__views__),s}function c0(){if(this.__filtered__){var s=new wt(this);s.__dir__=-1,s.__filtered__=!0}else s=this.clone(),s.__dir__*=-1;return s}function f0(){var s=this.__wrapped__.value(),a=this.__dir__,c=pt(s),p=a<0,y=c?s.length:0,T=Tx(0,y,this.__views__),C=T.start,P=T.end,M=P-C,U=p?P:C-1,G=this.__iteratees__,$=G.length,q=0,tt=_e(M,this.__takeCount__);if(!c||!p&&y==M&&tt==M)return jf(s,this.__actions__);var lt=[];t:for(;M--&&q<tt;){U+=a;for(var vt=-1,ht=s[U];++vt<$;){var xt=G[vt],At=xt.iteratee,Le=xt.type,Te=At(ht);if(Le==at)ht=Te;else if(!Te){if(Le==k)continue t;break t}}lt[q++]=ht}return lt}wt.prototype=ln(ho.prototype),wt.prototype.constructor=wt;function xi(s){var a=-1,c=s==null?0:s.length;for(this.clear();++a<c;){var p=s[a];this.set(p[0],p[1])}}function d0(){this.__data__=rs?rs(null):{},this.size=0}function p0(s){var a=this.has(s)&&delete this.__data__[s];return this.size-=a?1:0,a}function g0(s){var a=this.__data__;if(rs){var c=a[s];return c===u?r:c}return Bt.call(a,s)?a[s]:r}function m0(s){var a=this.__data__;return rs?a[s]!==r:Bt.call(a,s)}function v0(s,a){var c=this.__data__;return this.size+=this.has(s)?0:1,c[s]=rs&&a===r?u:a,this}xi.prototype.clear=d0,xi.prototype.delete=p0,xi.prototype.get=g0,xi.prototype.has=m0,xi.prototype.set=v0;function Or(s){var a=-1,c=s==null?0:s.length;for(this.clear();++a<c;){var p=s[a];this.set(p[0],p[1])}}function y0(){this.__data__=[],this.size=0}function _0(s){var a=this.__data__,c=uo(a,s);if(c<0)return!1;var p=a.length-1;return c==p?a.pop():io.call(a,c,1),--this.size,!0}function x0(s){var a=this.__data__,c=uo(a,s);return c<0?r:a[c][1]}function b0(s){return uo(this.__data__,s)>-1}function w0(s,a){var c=this.__data__,p=uo(c,s);return p<0?(++this.size,c.push([s,a])):c[p][1]=a,this}Or.prototype.clear=y0,Or.prototype.delete=_0,Or.prototype.get=x0,Or.prototype.has=b0,Or.prototype.set=w0;function Fr(s){var a=-1,c=s==null?0:s.length;for(this.clear();++a<c;){var p=s[a];this.set(p[0],p[1])}}function E0(){this.size=0,this.__data__={hash:new xi,map:new(ts||Or),string:new xi}}function T0(s){var a=Eo(this,s).delete(s);return this.size-=a?1:0,a}function A0(s){return Eo(this,s).get(s)}function S0(s){return Eo(this,s).has(s)}function C0(s,a){var c=Eo(this,s),p=c.size;return c.set(s,a),this.size+=c.size==p?0:1,this}Fr.prototype.clear=E0,Fr.prototype.delete=T0,Fr.prototype.get=A0,Fr.prototype.has=S0,Fr.prototype.set=C0;function bi(s){var a=-1,c=s==null?0:s.length;for(this.__data__=new Fr;++a<c;)this.add(s[a])}function I0(s){return this.__data__.set(s,u),this}function P0(s){return this.__data__.has(s)}bi.prototype.add=bi.prototype.push=I0,bi.prototype.has=P0;function rr(s){var a=this.__data__=new Or(s);this.size=a.size}function R0(){this.__data__=new Or,this.size=0}function M0(s){var a=this.__data__,c=a.delete(s);return this.size=a.size,c}function D0(s){return this.__data__.get(s)}function B0(s){return this.__data__.has(s)}function O0(s,a){var c=this.__data__;if(c instanceof Or){var p=c.__data__;if(!ts||p.length<n-1)return p.push([s,a]),this.size=++c.size,this;c=this.__data__=new Fr(p)}return c.set(s,a),this.size=c.size,this}rr.prototype.clear=R0,rr.prototype.delete=M0,rr.prototype.get=D0,rr.prototype.has=B0,rr.prototype.set=O0;function Af(s,a){var c=pt(s),p=!c&&Si(s),y=!c&&!p&&ni(s),T=!c&&!p&&!y&&fn(s),C=c||p||y||T,P=C?wl(s.length,X_):[],M=P.length;for(var U in s)(a||Bt.call(s,U))&&!(C&&(U=="length"||y&&(U=="offset"||U=="parent")||T&&(U=="buffer"||U=="byteLength"||U=="byteOffset")||Ur(U,M)))&&P.push(U);return P}function Sf(s){var a=s.length;return a?s[Ul(0,a-1)]:r}function F0(s,a){return To(Se(s),wi(a,0,s.length))}function L0(s){return To(Se(s))}function Pl(s,a,c){(c!==r&&!ir(s[a],c)||c===r&&!(a in s))&&Lr(s,a,c)}function ns(s,a,c){var p=s[a];(!(Bt.call(s,a)&&ir(p,c))||c===r&&!(a in s))&&Lr(s,a,c)}function uo(s,a){for(var c=s.length;c--;)if(ir(s[c][0],a))return c;return-1}function N0(s,a,c,p){return ti(s,function(y,T,C){a(p,y,c(y),C)}),p}function Cf(s,a){return s&&xr(a,ce(a),s)}function k0(s,a){return s&&xr(a,Ie(a),s)}function Lr(s,a,c){a=="__proto__"&&no?no(s,a,{configurable:!0,enumerable:!0,value:c,writable:!0}):s[a]=c}function Rl(s,a){for(var c=-1,p=a.length,y=B(p),T=s==null;++c<p;)y[c]=T?r:uh(s,a[c]);return y}function wi(s,a,c){return s===s&&(c!==r&&(s=s<=c?s:c),a!==r&&(s=s>=a?s:a)),s}function Ve(s,a,c,p,y,T){var C,P=a&g,M=a&m,U=a&v;if(c&&(C=y?c(s,p,y,T):c(s)),C!==r)return C;if(!Ht(s))return s;var G=pt(s);if(G){if(C=Sx(s),!P)return Se(s,C)}else{var $=xe(s),q=$==Ut||$==jt;if(ni(s))return Zf(s,P);if($==yr||$==Nt||q&&!y){if(C=M||q?{}:md(s),!P)return M?gx(s,k0(C,s)):px(s,Cf(C,s))}else{if(!Lt[$])return y?s:{};C=Cx(s,$,P)}}T=new rr;var tt=T.get(s);if(tt)return tt;T.set(s,C),zd(s)?s.forEach(function(ht){C.add(Ve(ht,a,c,ht,s,T))}):Hd(s)&&s.forEach(function(ht,xt){C.set(xt,Ve(ht,a,c,xt,s,T))});var lt=U?M?Kl:ql:M?Ie:ce,vt=G?r:lt(s);return He(vt||s,function(ht,xt){vt&&(xt=ht,ht=s[xt]),ns(C,xt,Ve(ht,a,c,xt,s,T))}),C}function U0(s){var a=ce(s);return function(c){return If(c,s,a)}}function If(s,a,c){var p=c.length;if(s==null)return!p;for(s=Ft(s);p--;){var y=c[p],T=a[y],C=s[y];if(C===r&&!(y in s)||!T(C))return!1}return!0}function Pf(s,a,c){if(typeof s!="function")throw new Xe(l);return cs(function(){s.apply(r,c)},a)}function ss(s,a,c,p){var y=-1,T=Ys,C=!0,P=s.length,M=[],U=a.length;if(!P)return M;c&&(a=Wt(a,Be(c))),p?(T=ml,C=!1):a.length>=n&&(T=Jn,C=!1,a=new bi(a));t:for(;++y<P;){var G=s[y],$=c==null?G:c(G);if(G=p||G!==0?G:0,C&&$===$){for(var q=U;q--;)if(a[q]===$)continue t;M.push(G)}else T(a,$,p)||M.push(G)}return M}var ti=rd(_r),Rf=rd(Dl,!0);function G0(s,a){var c=!0;return ti(s,function(p,y,T){return c=!!a(p,y,T),c}),c}function co(s,a,c){for(var p=-1,y=s.length;++p<y;){var T=s[p],C=a(T);if(C!=null&&(P===r?C===C&&!Fe(C):c(C,P)))var P=C,M=T}return M}function W0(s,a,c,p){var y=s.length;for(c=mt(c),c<0&&(c=-c>y?0:y+c),p=p===r||p>y?y:mt(p),p<0&&(p+=y),p=c>p?0:Yd(p);c<p;)s[c++]=a;return s}function Mf(s,a){var c=[];return ti(s,function(p,y,T){a(p,y,T)&&c.push(p)}),c}function pe(s,a,c,p,y){var T=-1,C=s.length;for(c||(c=Px),y=[];++T<C;){var P=s[T];a>0&&c(P)?a>1?pe(P,a-1,c,p,y):Zr(y,P):p||(y[y.length]=P)}return y}var Ml=id(),Df=id(!0);function _r(s,a){return s&&Ml(s,a,ce)}function Dl(s,a){return s&&Df(s,a,ce)}function fo(s,a){return Kr(a,function(c){return Gr(s[c])})}function Ei(s,a){a=ri(a,s);for(var c=0,p=a.length;s!=null&&c<p;)s=s[br(a[c++])];return c&&c==p?s:r}function Bf(s,a,c){var p=a(s);return pt(s)?p:Zr(p,c(s))}function we(s){return s==null?s===r?my:vi:_i&&_i in Ft(s)?Ex(s):Lx(s)}function Bl(s,a){return s>a}function $0(s,a){return s!=null&&Bt.call(s,a)}function H0(s,a){return s!=null&&a in Ft(s)}function X0(s,a,c){return s>=_e(a,c)&&s<le(a,c)}function Ol(s,a,c){for(var p=c?ml:Ys,y=s[0].length,T=s.length,C=T,P=B(T),M=1/0,U=[];C--;){var G=s[C];C&&a&&(G=Wt(G,Be(a))),M=_e(G.length,M),P[C]=!c&&(a||y>=120&&G.length>=120)?new bi(C&&G):r}G=s[0];var $=-1,q=P[0];t:for(;++$<y&&U.length<M;){var tt=G[$],lt=a?a(tt):tt;if(tt=c||tt!==0?tt:0,!(q?Jn(q,lt):p(U,lt,c))){for(C=T;--C;){var vt=P[C];if(!(vt?Jn(vt,lt):p(s[C],lt,c)))continue t}q&&q.push(lt),U.push(tt)}}return U}function z0(s,a,c,p){return _r(s,function(y,T,C){a(p,c(y),T,C)}),p}function os(s,a,c){a=ri(a,s),s=xd(s,a);var p=s==null?s:s[br(je(a))];return p==null?r:De(p,s,c)}function Of(s){return Kt(s)&&we(s)==Nt}function V0(s){return Kt(s)&&we(s)==Zn}function Y0(s){return Kt(s)&&we(s)==ne}function as(s,a,c,p,y){return s===a?!0:s==null||a==null||!Kt(s)&&!Kt(a)?s!==s&&a!==a:j0(s,a,c,p,as,y)}function j0(s,a,c,p,y,T){var C=pt(s),P=pt(a),M=C?kt:xe(s),U=P?kt:xe(a);M=M==Nt?yr:M,U=U==Nt?yr:U;var G=M==yr,$=U==yr,q=M==U;if(q&&ni(s)){if(!ni(a))return!1;C=!0,G=!1}if(q&&!G)return T||(T=new rr),C||fn(s)?dd(s,a,c,p,y,T):bx(s,a,M,c,p,y,T);if(!(c&_)){var tt=G&&Bt.call(s,"__wrapped__"),lt=$&&Bt.call(a,"__wrapped__");if(tt||lt){var vt=tt?s.value():s,ht=lt?a.value():a;return T||(T=new rr),y(vt,ht,c,p,T)}}return q?(T||(T=new rr),wx(s,a,c,p,y,T)):!1}function q0(s){return Kt(s)&&xe(s)==qt}function Fl(s,a,c,p){var y=c.length,T=y,C=!p;if(s==null)return!T;for(s=Ft(s);y--;){var P=c[y];if(C&&P[2]?P[1]!==s[P[0]]:!(P[0]in s))return!1}for(;++y<T;){P=c[y];var M=P[0],U=s[M],G=P[1];if(C&&P[2]){if(U===r&&!(M in s))return!1}else{var $=new rr;if(p)var q=p(U,G,M,s,a,$);if(!(q===r?as(G,U,_|w,p,$):q))return!1}}return!0}function Ff(s){if(!Ht(s)||Mx(s))return!1;var a=Gr(s)?q_:Uy;return a.test(Ai(s))}function K0(s){return Kt(s)&&we(s)==jn}function Z0(s){return Kt(s)&&xe(s)==tr}function J0(s){return Kt(s)&&Ro(s.length)&&!!Gt[we(s)]}function Lf(s){return typeof s=="function"?s:s==null?Pe:typeof s=="object"?pt(s)?Uf(s[0],s[1]):kf(s):np(s)}function Ll(s){if(!us(s))return e0(s);var a=[];for(var c in Ft(s))Bt.call(s,c)&&c!="constructor"&&a.push(c);return a}function Q0(s){if(!Ht(s))return Fx(s);var a=us(s),c=[];for(var p in s)p=="constructor"&&(a||!Bt.call(s,p))||c.push(p);return c}function Nl(s,a){return s<a}function Nf(s,a){var c=-1,p=Ce(s)?B(s.length):[];return ti(s,function(y,T,C){p[++c]=a(y,T,C)}),p}function kf(s){var a=Jl(s);return a.length==1&&a[0][2]?yd(a[0][0],a[0][1]):function(c){return c===s||Fl(c,s,a)}}function Uf(s,a){return th(s)&&vd(a)?yd(br(s),a):function(c){var p=uh(c,s);return p===r&&p===a?ch(c,s):as(a,p,_|w)}}function po(s,a,c,p,y){s!==a&&Ml(a,function(T,C){if(y||(y=new rr),Ht(T))tx(s,a,C,c,po,p,y);else{var P=p?p(rh(s,C),T,C+"",s,a,y):r;P===r&&(P=T),Pl(s,C,P)}},Ie)}function tx(s,a,c,p,y,T,C){var P=rh(s,c),M=rh(a,c),U=C.get(M);if(U){Pl(s,c,U);return}var G=T?T(P,M,c+"",s,a,C):r,$=G===r;if($){var q=pt(M),tt=!q&&ni(M),lt=!q&&!tt&&fn(M);G=M,q||tt||lt?pt(P)?G=P:Jt(P)?G=Se(P):tt?($=!1,G=Zf(M,!0)):lt?($=!1,G=Jf(M,!0)):G=[]:fs(M)||Si(M)?(G=P,Si(P)?G=jd(P):(!Ht(P)||Gr(P))&&(G=md(M))):$=!1}$&&(C.set(M,G),y(G,M,p,T,C),C.delete(M)),Pl(s,c,G)}function Gf(s,a){var c=s.length;if(c)return a+=a<0?c:0,Ur(a,c)?s[a]:r}function Wf(s,a,c){a.length?a=Wt(a,function(T){return pt(T)?function(C){return Ei(C,T.length===1?T[0]:T)}:T}):a=[Pe];var p=-1;a=Wt(a,Be(ot()));var y=Nf(s,function(T,C,P){var M=Wt(a,function(U){return U(T)});return{criteria:M,index:++p,value:T}});return C_(y,function(T,C){return dx(T,C,c)})}function ex(s,a){return $f(s,a,function(c,p){return ch(s,p)})}function $f(s,a,c){for(var p=-1,y=a.length,T={};++p<y;){var C=a[p],P=Ei(s,C);c(P,C)&&ls(T,ri(C,s),P)}return T}function rx(s){return function(a){return Ei(a,s)}}function kl(s,a,c,p){var y=p?S_:tn,T=-1,C=a.length,P=s;for(s===a&&(a=Se(a)),c&&(P=Wt(s,Be(c)));++T<C;)for(var M=0,U=a[T],G=c?c(U):U;(M=y(P,G,M,p))>-1;)P!==s&&io.call(P,M,1),io.call(s,M,1);return s}function Hf(s,a){for(var c=s?a.length:0,p=c-1;c--;){var y=a[c];if(c==p||y!==T){var T=y;Ur(y)?io.call(s,y,1):$l(s,y)}}return s}function Ul(s,a){return s+oo(Ef()*(a-s+1))}function ix(s,a,c,p){for(var y=-1,T=le(so((a-s)/(c||1)),0),C=B(T);T--;)C[p?T:++y]=s,s+=c;return C}function Gl(s,a){var c="";if(!s||a<1||a>yt)return c;do a%2&&(c+=s),a=oo(a/2),a&&(s+=s);while(a);return c}function _t(s,a){return ih(_d(s,a,Pe),s+"")}function nx(s){return Sf(dn(s))}function sx(s,a){var c=dn(s);return To(c,wi(a,0,c.length))}function ls(s,a,c,p){if(!Ht(s))return s;a=ri(a,s);for(var y=-1,T=a.length,C=T-1,P=s;P!=null&&++y<T;){var M=br(a[y]),U=c;if(M==="__proto__"||M==="constructor"||M==="prototype")return s;if(y!=C){var G=P[M];U=p?p(G,M,P):r,U===r&&(U=Ht(G)?G:Ur(a[y+1])?[]:{})}ns(P,M,U),P=P[M]}return s}var Xf=ao?function(s,a){return ao.set(s,a),s}:Pe,ox=no?function(s,a){return no(s,"toString",{configurable:!0,enumerable:!1,value:dh(a),writable:!0})}:Pe;function ax(s){return To(dn(s))}function Ye(s,a,c){var p=-1,y=s.length;a<0&&(a=-a>y?0:y+a),c=c>y?y:c,c<0&&(c+=y),y=a>c?0:c-a>>>0,a>>>=0;for(var T=B(y);++p<y;)T[p]=s[p+a];return T}function lx(s,a){var c;return ti(s,function(p,y,T){return c=a(p,y,T),!c}),!!c}function go(s,a,c){var p=0,y=s==null?p:s.length;if(typeof a=="number"&&a===a&&y<=Pt){for(;p<y;){var T=p+y>>>1,C=s[T];C!==null&&!Fe(C)&&(c?C<=a:C<a)?p=T+1:y=T}return y}return Wl(s,a,Pe,c)}function Wl(s,a,c,p){var y=0,T=s==null?0:s.length;if(T===0)return 0;a=c(a);for(var C=a!==a,P=a===null,M=Fe(a),U=a===r;y<T;){var G=oo((y+T)/2),$=c(s[G]),q=$!==r,tt=$===null,lt=$===$,vt=Fe($);if(C)var ht=p||lt;else U?ht=lt&&(p||q):P?ht=lt&&q&&(p||!tt):M?ht=lt&&q&&!tt&&(p||!vt):tt||vt?ht=!1:ht=p?$<=a:$<a;ht?y=G+1:T=G}return _e(T,bt)}function zf(s,a){for(var c=-1,p=s.length,y=0,T=[];++c<p;){var C=s[c],P=a?a(C):C;if(!c||!ir(P,M)){var M=P;T[y++]=C===0?0:C}}return T}function Vf(s){return typeof s=="number"?s:Fe(s)?H:+s}function Oe(s){if(typeof s=="string")return s;if(pt(s))return Wt(s,Oe)+"";if(Fe(s))return Tf?Tf.call(s):"";var a=s+"";return a=="0"&&1/s==-Y?"-0":a}function ei(s,a,c){var p=-1,y=Ys,T=s.length,C=!0,P=[],M=P;if(c)C=!1,y=ml;else if(T>=n){var U=a?null:_x(s);if(U)return qs(U);C=!1,y=Jn,M=new bi}else M=a?[]:P;t:for(;++p<T;){var G=s[p],$=a?a(G):G;if(G=c||G!==0?G:0,C&&$===$){for(var q=M.length;q--;)if(M[q]===$)continue t;a&&M.push($),P.push(G)}else y(M,$,c)||(M!==P&&M.push($),P.push(G))}return P}function $l(s,a){return a=ri(a,s),s=xd(s,a),s==null||delete s[br(je(a))]}function Yf(s,a,c,p){return ls(s,a,c(Ei(s,a)),p)}function mo(s,a,c,p){for(var y=s.length,T=p?y:-1;(p?T--:++T<y)&&a(s[T],T,s););return c?Ye(s,p?0:T,p?T+1:y):Ye(s,p?T+1:0,p?y:T)}function jf(s,a){var c=s;return c instanceof wt&&(c=c.value()),vl(a,function(p,y){return y.func.apply(y.thisArg,Zr([p],y.args))},c)}function Hl(s,a,c){var p=s.length;if(p<2)return p?ei(s[0]):[];for(var y=-1,T=B(p);++y<p;)for(var C=s[y],P=-1;++P<p;)P!=y&&(T[y]=ss(T[y]||C,s[P],a,c));return ei(pe(T,1),a,c)}function qf(s,a,c){for(var p=-1,y=s.length,T=a.length,C={};++p<y;){var P=p<T?a[p]:r;c(C,s[p],P)}return C}function Xl(s){return Jt(s)?s:[]}function zl(s){return typeof s=="function"?s:Pe}function ri(s,a){return pt(s)?s:th(s,a)?[s]:Td(Rt(s))}var hx=_t;function ii(s,a,c){var p=s.length;return c=c===r?p:c,!a&&c>=p?s:Ye(s,a,c)}var Kf=K_||function(s){return de.clearTimeout(s)};function Zf(s,a){if(a)return s.slice();var c=s.length,p=yf?yf(c):new s.constructor(c);return s.copy(p),p}function Vl(s){var a=new s.constructor(s.byteLength);return new eo(a).set(new eo(s)),a}function ux(s,a){var c=a?Vl(s.buffer):s.buffer;return new s.constructor(c,s.byteOffset,s.byteLength)}function cx(s){var a=new s.constructor(s.source,Bc.exec(s));return a.lastIndex=s.lastIndex,a}function fx(s){return is?Ft(is.call(s)):{}}function Jf(s,a){var c=a?Vl(s.buffer):s.buffer;return new s.constructor(c,s.byteOffset,s.length)}function Qf(s,a){if(s!==a){var c=s!==r,p=s===null,y=s===s,T=Fe(s),C=a!==r,P=a===null,M=a===a,U=Fe(a);if(!P&&!U&&!T&&s>a||T&&C&&M&&!P&&!U||p&&C&&M||!c&&M||!y)return 1;if(!p&&!T&&!U&&s<a||U&&c&&y&&!p&&!T||P&&c&&y||!C&&y||!M)return-1}return 0}function dx(s,a,c){for(var p=-1,y=s.criteria,T=a.criteria,C=y.length,P=c.length;++p<C;){var M=Qf(y[p],T[p]);if(M){if(p>=P)return M;var U=c[p];return M*(U=="desc"?-1:1)}}return s.index-a.index}function td(s,a,c,p){for(var y=-1,T=s.length,C=c.length,P=-1,M=a.length,U=le(T-C,0),G=B(M+U),$=!p;++P<M;)G[P]=a[P];for(;++y<C;)($||y<T)&&(G[c[y]]=s[y]);for(;U--;)G[P++]=s[y++];return G}function ed(s,a,c,p){for(var y=-1,T=s.length,C=-1,P=c.length,M=-1,U=a.length,G=le(T-P,0),$=B(G+U),q=!p;++y<G;)$[y]=s[y];for(var tt=y;++M<U;)$[tt+M]=a[M];for(;++C<P;)(q||y<T)&&($[tt+c[C]]=s[y++]);return $}function Se(s,a){var c=-1,p=s.length;for(a||(a=B(p));++c<p;)a[c]=s[c];return a}function xr(s,a,c,p){var y=!c;c||(c={});for(var T=-1,C=a.length;++T<C;){var P=a[T],M=p?p(c[P],s[P],P,c,s):r;M===r&&(M=s[P]),y?Lr(c,P,M):ns(c,P,M)}return c}function px(s,a){return xr(s,Ql(s),a)}function gx(s,a){return xr(s,pd(s),a)}function vo(s,a){return function(c,p){var y=pt(c)?x_:N0,T=a?a():{};return y(c,s,ot(p,2),T)}}function hn(s){return _t(function(a,c){var p=-1,y=c.length,T=y>1?c[y-1]:r,C=y>2?c[2]:r;for(T=s.length>3&&typeof T=="function"?(y--,T):r,C&&Ee(c[0],c[1],C)&&(T=y<3?r:T,y=1),a=Ft(a);++p<y;){var P=c[p];P&&s(a,P,p,T)}return a})}function rd(s,a){return function(c,p){if(c==null)return c;if(!Ce(c))return s(c,p);for(var y=c.length,T=a?y:-1,C=Ft(c);(a?T--:++T<y)&&p(C[T],T,C)!==!1;);return c}}function id(s){return function(a,c,p){for(var y=-1,T=Ft(a),C=p(a),P=C.length;P--;){var M=C[s?P:++y];if(c(T[M],M,T)===!1)break}return a}}function mx(s,a,c){var p=a&x,y=hs(s);function T(){var C=this&&this!==de&&this instanceof T?y:s;return C.apply(p?c:this,arguments)}return T}function nd(s){return function(a){a=Rt(a);var c=en(a)?er(a):r,p=c?c[0]:a.charAt(0),y=c?ii(c,1).join(""):a.slice(1);return p[s]()+y}}function un(s){return function(a){return vl(rp(ep(a).replace(o_,"")),s,"")}}function hs(s){return function(){var a=arguments;switch(a.length){case 0:return new s;case 1:return new s(a[0]);case 2:return new s(a[0],a[1]);case 3:return new s(a[0],a[1],a[2]);case 4:return new s(a[0],a[1],a[2],a[3]);case 5:return new s(a[0],a[1],a[2],a[3],a[4]);case 6:return new s(a[0],a[1],a[2],a[3],a[4],a[5]);case 7:return new s(a[0],a[1],a[2],a[3],a[4],a[5],a[6])}var c=ln(s.prototype),p=s.apply(c,a);return Ht(p)?p:c}}function vx(s,a,c){var p=hs(s);function y(){for(var T=arguments.length,C=B(T),P=T,M=cn(y);P--;)C[P]=arguments[P];var U=T<3&&C[0]!==M&&C[T-1]!==M?[]:Jr(C,M);if(T-=U.length,T<c)return hd(s,a,yo,y.placeholder,r,C,U,r,r,c-T);var G=this&&this!==de&&this instanceof y?p:s;return De(G,this,C)}return y}function sd(s){return function(a,c,p){var y=Ft(a);if(!Ce(a)){var T=ot(c,3);a=ce(a),c=function(P){return T(y[P],P,y)}}var C=s(a,c,p);return C>-1?y[T?a[C]:C]:r}}function od(s){return kr(function(a){var c=a.length,p=c,y=ze.prototype.thru;for(s&&a.reverse();p--;){var T=a[p];if(typeof T!="function")throw new Xe(l);if(y&&!C&&wo(T)=="wrapper")var C=new ze([],!0)}for(p=C?p:c;++p<c;){T=a[p];var P=wo(T),M=P=="wrapper"?Zl(T):r;M&&eh(M[0])&&M[1]==(O|E|D|F)&&!M[4].length&&M[9]==1?C=C[wo(M[0])].apply(C,M[3]):C=T.length==1&&eh(T)?C[P]():C.thru(T)}return function(){var U=arguments,G=U[0];if(C&&U.length==1&&pt(G))return C.plant(G).value();for(var $=0,q=c?a[$].apply(this,U):G;++$<c;)q=a[$].call(this,q);return q}})}function yo(s,a,c,p,y,T,C,P,M,U){var G=a&O,$=a&x,q=a&A,tt=a&(E|I),lt=a&X,vt=q?r:hs(s);function ht(){for(var xt=arguments.length,At=B(xt),Le=xt;Le--;)At[Le]=arguments[Le];if(tt)var Te=cn(ht),Ne=P_(At,Te);if(p&&(At=td(At,p,y,tt)),T&&(At=ed(At,T,C,tt)),xt-=Ne,tt&&xt<U){var Qt=Jr(At,Te);return hd(s,a,yo,ht.placeholder,c,At,Qt,P,M,U-xt)}var nr=$?c:this,$r=q?nr[s]:s;return xt=At.length,P?At=Nx(At,P):lt&&xt>1&&At.reverse(),G&&M<xt&&(At.length=M),this&&this!==de&&this instanceof ht&&($r=vt||hs($r)),$r.apply(nr,At)}return ht}function ad(s,a){return function(c,p){return z0(c,s,a(p),{})}}function _o(s,a){return function(c,p){var y;if(c===r&&p===r)return a;if(c!==r&&(y=c),p!==r){if(y===r)return p;typeof c=="string"||typeof p=="string"?(c=Oe(c),p=Oe(p)):(c=Vf(c),p=Vf(p)),y=s(c,p)}return y}}function Yl(s){return kr(function(a){return a=Wt(a,Be(ot())),_t(function(c){var p=this;return s(a,function(y){return De(y,p,c)})})})}function xo(s,a){a=a===r?" ":Oe(a);var c=a.length;if(c<2)return c?Gl(a,s):a;var p=Gl(a,so(s/rn(a)));return en(a)?ii(er(p),0,s).join(""):p.slice(0,s)}function yx(s,a,c,p){var y=a&x,T=hs(s);function C(){for(var P=-1,M=arguments.length,U=-1,G=p.length,$=B(G+M),q=this&&this!==de&&this instanceof C?T:s;++U<G;)$[U]=p[U];for(;M--;)$[U++]=arguments[++P];return De(q,y?c:this,$)}return C}function ld(s){return function(a,c,p){return p&&typeof p!="number"&&Ee(a,c,p)&&(c=p=r),a=Wr(a),c===r?(c=a,a=0):c=Wr(c),p=p===r?a<c?1:-1:Wr(p),ix(a,c,p,s)}}function bo(s){return function(a,c){return typeof a=="string"&&typeof c=="string"||(a=qe(a),c=qe(c)),s(a,c)}}function hd(s,a,c,p,y,T,C,P,M,U){var G=a&E,$=G?C:r,q=G?r:C,tt=G?T:r,lt=G?r:T;a|=G?D:L,a&=~(G?L:D),a&S||(a&=~(x|A));var vt=[s,a,y,tt,$,lt,q,P,M,U],ht=c.apply(r,vt);return eh(s)&&bd(ht,vt),ht.placeholder=p,wd(ht,s,a)}function jl(s){var a=ae[s];return function(c,p){if(c=qe(c),p=p==null?0:_e(mt(p),292),p&&wf(c)){var y=(Rt(c)+"e").split("e"),T=a(y[0]+"e"+(+y[1]+p));return y=(Rt(T)+"e").split("e"),+(y[0]+"e"+(+y[1]-p))}return a(c)}}var _x=on&&1/qs(new on([,-0]))[1]==Y?function(s){return new on(s)}:mh;function ud(s){return function(a){var c=xe(a);return c==qt?Tl(a):c==tr?L_(a):I_(a,s(a))}}function Nr(s,a,c,p,y,T,C,P){var M=a&A;if(!M&&typeof s!="function")throw new Xe(l);var U=p?p.length:0;if(U||(a&=~(D|L),p=y=r),C=C===r?C:le(mt(C),0),P=P===r?P:mt(P),U-=y?y.length:0,a&L){var G=p,$=y;p=y=r}var q=M?r:Zl(s),tt=[s,a,c,p,y,G,$,T,C,P];if(q&&Ox(tt,q),s=tt[0],a=tt[1],c=tt[2],p=tt[3],y=tt[4],P=tt[9]=tt[9]===r?M?0:s.length:le(tt[9]-U,0),!P&&a&(E|I)&&(a&=~(E|I)),!a||a==x)var lt=mx(s,a,c);else a==E||a==I?lt=vx(s,a,P):(a==D||a==(x|D))&&!y.length?lt=yx(s,a,c,p):lt=yo.apply(r,tt);var vt=q?Xf:bd;return wd(vt(lt,tt),s,a)}function cd(s,a,c,p){return s===r||ir(s,sn[c])&&!Bt.call(p,c)?a:s}function fd(s,a,c,p,y,T){return Ht(s)&&Ht(a)&&(T.set(a,s),po(s,a,r,fd,T),T.delete(a)),s}function xx(s){return fs(s)?r:s}function dd(s,a,c,p,y,T){var C=c&_,P=s.length,M=a.length;if(P!=M&&!(C&&M>P))return!1;var U=T.get(s),G=T.get(a);if(U&&G)return U==a&&G==s;var $=-1,q=!0,tt=c&w?new bi:r;for(T.set(s,a),T.set(a,s);++$<P;){var lt=s[$],vt=a[$];if(p)var ht=C?p(vt,lt,$,a,s,T):p(lt,vt,$,s,a,T);if(ht!==r){if(ht)continue;q=!1;break}if(tt){if(!yl(a,function(xt,At){if(!Jn(tt,At)&&(lt===xt||y(lt,xt,c,p,T)))return tt.push(At)})){q=!1;break}}else if(!(lt===vt||y(lt,vt,c,p,T))){q=!1;break}}return T.delete(s),T.delete(a),q}function bx(s,a,c,p,y,T,C){switch(c){case Ji:if(s.byteLength!=a.byteLength||s.byteOffset!=a.byteOffset)return!1;s=s.buffer,a=a.buffer;case Zn:return!(s.byteLength!=a.byteLength||!T(new eo(s),new eo(a)));case Yt:case ne:case ye:return ir(+s,+a);case Dt:return s.name==a.name&&s.message==a.message;case jn:case qn:return s==a+"";case qt:var P=Tl;case tr:var M=p&_;if(P||(P=qs),s.size!=a.size&&!M)return!1;var U=C.get(s);if(U)return U==a;p|=w,C.set(s,a);var G=dd(P(s),P(a),p,y,T,C);return C.delete(s),G;case Hs:if(is)return is.call(s)==is.call(a)}return!1}function wx(s,a,c,p,y,T){var C=c&_,P=ql(s),M=P.length,U=ql(a),G=U.length;if(M!=G&&!C)return!1;for(var $=M;$--;){var q=P[$];if(!(C?q in a:Bt.call(a,q)))return!1}var tt=T.get(s),lt=T.get(a);if(tt&&lt)return tt==a&&lt==s;var vt=!0;T.set(s,a),T.set(a,s);for(var ht=C;++$<M;){q=P[$];var xt=s[q],At=a[q];if(p)var Le=C?p(At,xt,q,a,s,T):p(xt,At,q,s,a,T);if(!(Le===r?xt===At||y(xt,At,c,p,T):Le)){vt=!1;break}ht||(ht=q=="constructor")}if(vt&&!ht){var Te=s.constructor,Ne=a.constructor;Te!=Ne&&"constructor"in s&&"constructor"in a&&!(typeof Te=="function"&&Te instanceof Te&&typeof Ne=="function"&&Ne instanceof Ne)&&(vt=!1)}return T.delete(s),T.delete(a),vt}function kr(s){return ih(_d(s,r,Id),s+"")}function ql(s){return Bf(s,ce,Ql)}function Kl(s){return Bf(s,Ie,pd)}var Zl=ao?function(s){return ao.get(s)}:mh;function wo(s){for(var a=s.name+"",c=an[a],p=Bt.call(an,a)?c.length:0;p--;){var y=c[p],T=y.func;if(T==null||T==s)return y.name}return a}function cn(s){var a=Bt.call(b,"placeholder")?b:s;return a.placeholder}function ot(){var s=b.iteratee||ph;return s=s===ph?Lf:s,arguments.length?s(arguments[0],arguments[1]):s}function Eo(s,a){var c=s.__data__;return Rx(a)?c[typeof a=="string"?"string":"hash"]:c.map}function Jl(s){for(var a=ce(s),c=a.length;c--;){var p=a[c],y=s[p];a[c]=[p,y,vd(y)]}return a}function Ti(s,a){var c=B_(s,a);return Ff(c)?c:r}function Ex(s){var a=Bt.call(s,_i),c=s[_i];try{s[_i]=r;var p=!0}catch{}var y=Qs.call(s);return p&&(a?s[_i]=c:delete s[_i]),y}var Ql=Sl?function(s){return s==null?[]:(s=Ft(s),Kr(Sl(s),function(a){return xf.call(s,a)}))}:vh,pd=Sl?function(s){for(var a=[];s;)Zr(a,Ql(s)),s=ro(s);return a}:vh,xe=we;(Cl&&xe(new Cl(new ArrayBuffer(1)))!=Ji||ts&&xe(new ts)!=qt||Il&&xe(Il.resolve())!=Pc||on&&xe(new on)!=tr||es&&xe(new es)!=Kn)&&(xe=function(s){var a=we(s),c=a==yr?s.constructor:r,p=c?Ai(c):"";if(p)switch(p){case s0:return Ji;case o0:return qt;case a0:return Pc;case l0:return tr;case h0:return Kn}return a});function Tx(s,a,c){for(var p=-1,y=c.length;++p<y;){var T=c[p],C=T.size;switch(T.type){case"drop":s+=C;break;case"dropRight":a-=C;break;case"take":a=_e(a,s+C);break;case"takeRight":s=le(s,a-C);break}}return{start:s,end:a}}function Ax(s){var a=s.match(My);return a?a[1].split(Dy):[]}function gd(s,a,c){a=ri(a,s);for(var p=-1,y=a.length,T=!1;++p<y;){var C=br(a[p]);if(!(T=s!=null&&c(s,C)))break;s=s[C]}return T||++p!=y?T:(y=s==null?0:s.length,!!y&&Ro(y)&&Ur(C,y)&&(pt(s)||Si(s)))}function Sx(s){var a=s.length,c=new s.constructor(a);return a&&typeof s[0]=="string"&&Bt.call(s,"index")&&(c.index=s.index,c.input=s.input),c}function md(s){return typeof s.constructor=="function"&&!us(s)?ln(ro(s)):{}}function Cx(s,a,c){var p=s.constructor;switch(a){case Zn:return Vl(s);case Yt:case ne:return new p(+s);case Ji:return ux(s,c);case Ja:case Qa:case tl:case el:case rl:case il:case nl:case sl:case ol:return Jf(s,c);case qt:return new p;case ye:case qn:return new p(s);case jn:return cx(s);case tr:return new p;case Hs:return fx(s)}}function Ix(s,a){var c=a.length;if(!c)return s;var p=c-1;return a[p]=(c>1?"& ":"")+a[p],a=a.join(c>2?", ":" "),s.replace(Ry,`{
/* [wrapped with `+a+`] */
`)}function Px(s){return pt(s)||Si(s)||!!(bf&&s&&s[bf])}function Ur(s,a){var c=typeof s;return a=a??yt,!!a&&(c=="number"||c!="symbol"&&Wy.test(s))&&s>-1&&s%1==0&&s<a}function Ee(s,a,c){if(!Ht(c))return!1;var p=typeof a;return(p=="number"?Ce(c)&&Ur(a,c.length):p=="string"&&a in c)?ir(c[a],s):!1}function th(s,a){if(pt(s))return!1;var c=typeof s;return c=="number"||c=="symbol"||c=="boolean"||s==null||Fe(s)?!0:Sy.test(s)||!Ay.test(s)||a!=null&&s in Ft(a)}function Rx(s){var a=typeof s;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?s!=="__proto__":s===null}function eh(s){var a=wo(s),c=b[a];if(typeof c!="function"||!(a in wt.prototype))return!1;if(s===c)return!0;var p=Zl(c);return!!p&&s===p[0]}function Mx(s){return!!vf&&vf in s}var Dx=Zs?Gr:yh;function us(s){var a=s&&s.constructor,c=typeof a=="function"&&a.prototype||sn;return s===c}function vd(s){return s===s&&!Ht(s)}function yd(s,a){return function(c){return c==null?!1:c[s]===a&&(a!==r||s in Ft(c))}}function Bx(s){var a=Io(s,function(p){return c.size===f&&c.clear(),p}),c=a.cache;return a}function Ox(s,a){var c=s[1],p=a[1],y=c|p,T=y<(x|A|O),C=p==O&&c==E||p==O&&c==F&&s[7].length<=a[8]||p==(O|F)&&a[7].length<=a[8]&&c==E;if(!(T||C))return s;p&x&&(s[2]=a[2],y|=c&x?0:S);var P=a[3];if(P){var M=s[3];s[3]=M?td(M,P,a[4]):P,s[4]=M?Jr(s[3],d):a[4]}return P=a[5],P&&(M=s[5],s[5]=M?ed(M,P,a[6]):P,s[6]=M?Jr(s[5],d):a[6]),P=a[7],P&&(s[7]=P),p&O&&(s[8]=s[8]==null?a[8]:_e(s[8],a[8])),s[9]==null&&(s[9]=a[9]),s[0]=a[0],s[1]=y,s}function Fx(s){var a=[];if(s!=null)for(var c in Ft(s))a.push(c);return a}function Lx(s){return Qs.call(s)}function _d(s,a,c){return a=le(a===r?s.length-1:a,0),function(){for(var p=arguments,y=-1,T=le(p.length-a,0),C=B(T);++y<T;)C[y]=p[a+y];y=-1;for(var P=B(a+1);++y<a;)P[y]=p[y];return P[a]=c(C),De(s,this,P)}}function xd(s,a){return a.length<2?s:Ei(s,Ye(a,0,-1))}function Nx(s,a){for(var c=s.length,p=_e(a.length,c),y=Se(s);p--;){var T=a[p];s[p]=Ur(T,c)?y[T]:r}return s}function rh(s,a){if(!(a==="constructor"&&typeof s[a]=="function")&&a!="__proto__")return s[a]}var bd=Ed(Xf),cs=J_||function(s,a){return de.setTimeout(s,a)},ih=Ed(ox);function wd(s,a,c){var p=a+"";return ih(s,Ix(p,kx(Ax(p),c)))}function Ed(s){var a=0,c=0;return function(){var p=r0(),y=W-(p-c);if(c=p,y>0){if(++a>=K)return arguments[0]}else a=0;return s.apply(r,arguments)}}function To(s,a){var c=-1,p=s.length,y=p-1;for(a=a===r?p:a;++c<a;){var T=Ul(c,y),C=s[T];s[T]=s[c],s[c]=C}return s.length=a,s}var Td=Bx(function(s){var a=[];return s.charCodeAt(0)===46&&a.push(""),s.replace(Cy,function(c,p,y,T){a.push(y?T.replace(Fy,"$1"):p||c)}),a});function br(s){if(typeof s=="string"||Fe(s))return s;var a=s+"";return a=="0"&&1/s==-Y?"-0":a}function Ai(s){if(s!=null){try{return Js.call(s)}catch{}try{return s+""}catch{}}return""}function kx(s,a){return He(Mt,function(c){var p="_."+c[0];a&c[1]&&!Ys(s,p)&&s.push(p)}),s.sort()}function Ad(s){if(s instanceof wt)return s.clone();var a=new ze(s.__wrapped__,s.__chain__);return a.__actions__=Se(s.__actions__),a.__index__=s.__index__,a.__values__=s.__values__,a}function Ux(s,a,c){(c?Ee(s,a,c):a===r)?a=1:a=le(mt(a),0);var p=s==null?0:s.length;if(!p||a<1)return[];for(var y=0,T=0,C=B(so(p/a));y<p;)C[T++]=Ye(s,y,y+=a);return C}function Gx(s){for(var a=-1,c=s==null?0:s.length,p=0,y=[];++a<c;){var T=s[a];T&&(y[p++]=T)}return y}function Wx(){var s=arguments.length;if(!s)return[];for(var a=B(s-1),c=arguments[0],p=s;p--;)a[p-1]=arguments[p];return Zr(pt(c)?Se(c):[c],pe(a,1))}var $x=_t(function(s,a){return Jt(s)?ss(s,pe(a,1,Jt,!0)):[]}),Hx=_t(function(s,a){var c=je(a);return Jt(c)&&(c=r),Jt(s)?ss(s,pe(a,1,Jt,!0),ot(c,2)):[]}),Xx=_t(function(s,a){var c=je(a);return Jt(c)&&(c=r),Jt(s)?ss(s,pe(a,1,Jt,!0),r,c):[]});function zx(s,a,c){var p=s==null?0:s.length;return p?(a=c||a===r?1:mt(a),Ye(s,a<0?0:a,p)):[]}function Vx(s,a,c){var p=s==null?0:s.length;return p?(a=c||a===r?1:mt(a),a=p-a,Ye(s,0,a<0?0:a)):[]}function Yx(s,a){return s&&s.length?mo(s,ot(a,3),!0,!0):[]}function jx(s,a){return s&&s.length?mo(s,ot(a,3),!0):[]}function qx(s,a,c,p){var y=s==null?0:s.length;return y?(c&&typeof c!="number"&&Ee(s,a,c)&&(c=0,p=y),W0(s,a,c,p)):[]}function Sd(s,a,c){var p=s==null?0:s.length;if(!p)return-1;var y=c==null?0:mt(c);return y<0&&(y=le(p+y,0)),js(s,ot(a,3),y)}function Cd(s,a,c){var p=s==null?0:s.length;if(!p)return-1;var y=p-1;return c!==r&&(y=mt(c),y=c<0?le(p+y,0):_e(y,p-1)),js(s,ot(a,3),y,!0)}function Id(s){var a=s==null?0:s.length;return a?pe(s,1):[]}function Kx(s){var a=s==null?0:s.length;return a?pe(s,Y):[]}function Zx(s,a){var c=s==null?0:s.length;return c?(a=a===r?1:mt(a),pe(s,a)):[]}function Jx(s){for(var a=-1,c=s==null?0:s.length,p={};++a<c;){var y=s[a];p[y[0]]=y[1]}return p}function Pd(s){return s&&s.length?s[0]:r}function Qx(s,a,c){var p=s==null?0:s.length;if(!p)return-1;var y=c==null?0:mt(c);return y<0&&(y=le(p+y,0)),tn(s,a,y)}function tb(s){var a=s==null?0:s.length;return a?Ye(s,0,-1):[]}var eb=_t(function(s){var a=Wt(s,Xl);return a.length&&a[0]===s[0]?Ol(a):[]}),rb=_t(function(s){var a=je(s),c=Wt(s,Xl);return a===je(c)?a=r:c.pop(),c.length&&c[0]===s[0]?Ol(c,ot(a,2)):[]}),ib=_t(function(s){var a=je(s),c=Wt(s,Xl);return a=typeof a=="function"?a:r,a&&c.pop(),c.length&&c[0]===s[0]?Ol(c,r,a):[]});function nb(s,a){return s==null?"":t0.call(s,a)}function je(s){var a=s==null?0:s.length;return a?s[a-1]:r}function sb(s,a,c){var p=s==null?0:s.length;if(!p)return-1;var y=p;return c!==r&&(y=mt(c),y=y<0?le(p+y,0):_e(y,p-1)),a===a?k_(s,a,y):js(s,hf,y,!0)}function ob(s,a){return s&&s.length?Gf(s,mt(a)):r}var ab=_t(Rd);function Rd(s,a){return s&&s.length&&a&&a.length?kl(s,a):s}function lb(s,a,c){return s&&s.length&&a&&a.length?kl(s,a,ot(c,2)):s}function hb(s,a,c){return s&&s.length&&a&&a.length?kl(s,a,r,c):s}var ub=kr(function(s,a){var c=s==null?0:s.length,p=Rl(s,a);return Hf(s,Wt(a,function(y){return Ur(y,c)?+y:y}).sort(Qf)),p});function cb(s,a){var c=[];if(!(s&&s.length))return c;var p=-1,y=[],T=s.length;for(a=ot(a,3);++p<T;){var C=s[p];a(C,p,s)&&(c.push(C),y.push(p))}return Hf(s,y),c}function nh(s){return s==null?s:n0.call(s)}function fb(s,a,c){var p=s==null?0:s.length;return p?(c&&typeof c!="number"&&Ee(s,a,c)?(a=0,c=p):(a=a==null?0:mt(a),c=c===r?p:mt(c)),Ye(s,a,c)):[]}function db(s,a){return go(s,a)}function pb(s,a,c){return Wl(s,a,ot(c,2))}function gb(s,a){var c=s==null?0:s.length;if(c){var p=go(s,a);if(p<c&&ir(s[p],a))return p}return-1}function mb(s,a){return go(s,a,!0)}function vb(s,a,c){return Wl(s,a,ot(c,2),!0)}function yb(s,a){var c=s==null?0:s.length;if(c){var p=go(s,a,!0)-1;if(ir(s[p],a))return p}return-1}function _b(s){return s&&s.length?zf(s):[]}function xb(s,a){return s&&s.length?zf(s,ot(a,2)):[]}function bb(s){var a=s==null?0:s.length;return a?Ye(s,1,a):[]}function wb(s,a,c){return s&&s.length?(a=c||a===r?1:mt(a),Ye(s,0,a<0?0:a)):[]}function Eb(s,a,c){var p=s==null?0:s.length;return p?(a=c||a===r?1:mt(a),a=p-a,Ye(s,a<0?0:a,p)):[]}function Tb(s,a){return s&&s.length?mo(s,ot(a,3),!1,!0):[]}function Ab(s,a){return s&&s.length?mo(s,ot(a,3)):[]}var Sb=_t(function(s){return ei(pe(s,1,Jt,!0))}),Cb=_t(function(s){var a=je(s);return Jt(a)&&(a=r),ei(pe(s,1,Jt,!0),ot(a,2))}),Ib=_t(function(s){var a=je(s);return a=typeof a=="function"?a:r,ei(pe(s,1,Jt,!0),r,a)});function Pb(s){return s&&s.length?ei(s):[]}function Rb(s,a){return s&&s.length?ei(s,ot(a,2)):[]}function Mb(s,a){return a=typeof a=="function"?a:r,s&&s.length?ei(s,r,a):[]}function sh(s){if(!(s&&s.length))return[];var a=0;return s=Kr(s,function(c){if(Jt(c))return a=le(c.length,a),!0}),wl(a,function(c){return Wt(s,_l(c))})}function Md(s,a){if(!(s&&s.length))return[];var c=sh(s);return a==null?c:Wt(c,function(p){return De(a,r,p)})}var Db=_t(function(s,a){return Jt(s)?ss(s,a):[]}),Bb=_t(function(s){return Hl(Kr(s,Jt))}),Ob=_t(function(s){var a=je(s);return Jt(a)&&(a=r),Hl(Kr(s,Jt),ot(a,2))}),Fb=_t(function(s){var a=je(s);return a=typeof a=="function"?a:r,Hl(Kr(s,Jt),r,a)}),Lb=_t(sh);function Nb(s,a){return qf(s||[],a||[],ns)}function kb(s,a){return qf(s||[],a||[],ls)}var Ub=_t(function(s){var a=s.length,c=a>1?s[a-1]:r;return c=typeof c=="function"?(s.pop(),c):r,Md(s,c)});function Dd(s){var a=b(s);return a.__chain__=!0,a}function Gb(s,a){return a(s),s}function Ao(s,a){return a(s)}var Wb=kr(function(s){var a=s.length,c=a?s[0]:0,p=this.__wrapped__,y=function(T){return Rl(T,s)};return a>1||this.__actions__.length||!(p instanceof wt)||!Ur(c)?this.thru(y):(p=p.slice(c,+c+(a?1:0)),p.__actions__.push({func:Ao,args:[y],thisArg:r}),new ze(p,this.__chain__).thru(function(T){return a&&!T.length&&T.push(r),T}))});function $b(){return Dd(this)}function Hb(){return new ze(this.value(),this.__chain__)}function Xb(){this.__values__===r&&(this.__values__=Vd(this.value()));var s=this.__index__>=this.__values__.length,a=s?r:this.__values__[this.__index__++];return{done:s,value:a}}function zb(){return this}function Vb(s){for(var a,c=this;c instanceof ho;){var p=Ad(c);p.__index__=0,p.__values__=r,a?y.__wrapped__=p:a=p;var y=p;c=c.__wrapped__}return y.__wrapped__=s,a}function Yb(){var s=this.__wrapped__;if(s instanceof wt){var a=s;return this.__actions__.length&&(a=new wt(this)),a=a.reverse(),a.__actions__.push({func:Ao,args:[nh],thisArg:r}),new ze(a,this.__chain__)}return this.thru(nh)}function jb(){return jf(this.__wrapped__,this.__actions__)}var qb=vo(function(s,a,c){Bt.call(s,c)?++s[c]:Lr(s,c,1)});function Kb(s,a,c){var p=pt(s)?af:G0;return c&&Ee(s,a,c)&&(a=r),p(s,ot(a,3))}function Zb(s,a){var c=pt(s)?Kr:Mf;return c(s,ot(a,3))}var Jb=sd(Sd),Qb=sd(Cd);function t1(s,a){return pe(So(s,a),1)}function e1(s,a){return pe(So(s,a),Y)}function r1(s,a,c){return c=c===r?1:mt(c),pe(So(s,a),c)}function Bd(s,a){var c=pt(s)?He:ti;return c(s,ot(a,3))}function Od(s,a){var c=pt(s)?b_:Rf;return c(s,ot(a,3))}var i1=vo(function(s,a,c){Bt.call(s,c)?s[c].push(a):Lr(s,c,[a])});function n1(s,a,c,p){s=Ce(s)?s:dn(s),c=c&&!p?mt(c):0;var y=s.length;return c<0&&(c=le(y+c,0)),Mo(s)?c<=y&&s.indexOf(a,c)>-1:!!y&&tn(s,a,c)>-1}var s1=_t(function(s,a,c){var p=-1,y=typeof a=="function",T=Ce(s)?B(s.length):[];return ti(s,function(C){T[++p]=y?De(a,C,c):os(C,a,c)}),T}),o1=vo(function(s,a,c){Lr(s,c,a)});function So(s,a){var c=pt(s)?Wt:Nf;return c(s,ot(a,3))}function a1(s,a,c,p){return s==null?[]:(pt(a)||(a=a==null?[]:[a]),c=p?r:c,pt(c)||(c=c==null?[]:[c]),Wf(s,a,c))}var l1=vo(function(s,a,c){s[c?0:1].push(a)},function(){return[[],[]]});function h1(s,a,c){var p=pt(s)?vl:cf,y=arguments.length<3;return p(s,ot(a,4),c,y,ti)}function u1(s,a,c){var p=pt(s)?w_:cf,y=arguments.length<3;return p(s,ot(a,4),c,y,Rf)}function c1(s,a){var c=pt(s)?Kr:Mf;return c(s,Po(ot(a,3)))}function f1(s){var a=pt(s)?Sf:nx;return a(s)}function d1(s,a,c){(c?Ee(s,a,c):a===r)?a=1:a=mt(a);var p=pt(s)?F0:sx;return p(s,a)}function p1(s){var a=pt(s)?L0:ax;return a(s)}function g1(s){if(s==null)return 0;if(Ce(s))return Mo(s)?rn(s):s.length;var a=xe(s);return a==qt||a==tr?s.size:Ll(s).length}function m1(s,a,c){var p=pt(s)?yl:lx;return c&&Ee(s,a,c)&&(a=r),p(s,ot(a,3))}var v1=_t(function(s,a){if(s==null)return[];var c=a.length;return c>1&&Ee(s,a[0],a[1])?a=[]:c>2&&Ee(a[0],a[1],a[2])&&(a=[a[0]]),Wf(s,pe(a,1),[])}),Co=Z_||function(){return de.Date.now()};function y1(s,a){if(typeof a!="function")throw new Xe(l);return s=mt(s),function(){if(--s<1)return a.apply(this,arguments)}}function Fd(s,a,c){return a=c?r:a,a=s&&a==null?s.length:a,Nr(s,O,r,r,r,r,a)}function Ld(s,a){var c;if(typeof a!="function")throw new Xe(l);return s=mt(s),function(){return--s>0&&(c=a.apply(this,arguments)),s<=1&&(a=r),c}}var oh=_t(function(s,a,c){var p=x;if(c.length){var y=Jr(c,cn(oh));p|=D}return Nr(s,p,a,c,y)}),Nd=_t(function(s,a,c){var p=x|A;if(c.length){var y=Jr(c,cn(Nd));p|=D}return Nr(a,p,s,c,y)});function kd(s,a,c){a=c?r:a;var p=Nr(s,E,r,r,r,r,r,a);return p.placeholder=kd.placeholder,p}function Ud(s,a,c){a=c?r:a;var p=Nr(s,I,r,r,r,r,r,a);return p.placeholder=Ud.placeholder,p}function Gd(s,a,c){var p,y,T,C,P,M,U=0,G=!1,$=!1,q=!0;if(typeof s!="function")throw new Xe(l);a=qe(a)||0,Ht(c)&&(G=!!c.leading,$="maxWait"in c,T=$?le(qe(c.maxWait)||0,a):T,q="trailing"in c?!!c.trailing:q);function tt(Qt){var nr=p,$r=y;return p=y=r,U=Qt,C=s.apply($r,nr),C}function lt(Qt){return U=Qt,P=cs(xt,a),G?tt(Qt):C}function vt(Qt){var nr=Qt-M,$r=Qt-U,sp=a-nr;return $?_e(sp,T-$r):sp}function ht(Qt){var nr=Qt-M,$r=Qt-U;return M===r||nr>=a||nr<0||$&&$r>=T}function xt(){var Qt=Co();if(ht(Qt))return At(Qt);P=cs(xt,vt(Qt))}function At(Qt){return P=r,q&&p?tt(Qt):(p=y=r,C)}function Le(){P!==r&&Kf(P),U=0,p=M=y=P=r}function Te(){return P===r?C:At(Co())}function Ne(){var Qt=Co(),nr=ht(Qt);if(p=arguments,y=this,M=Qt,nr){if(P===r)return lt(M);if($)return Kf(P),P=cs(xt,a),tt(M)}return P===r&&(P=cs(xt,a)),C}return Ne.cancel=Le,Ne.flush=Te,Ne}var _1=_t(function(s,a){return Pf(s,1,a)}),x1=_t(function(s,a,c){return Pf(s,qe(a)||0,c)});function b1(s){return Nr(s,X)}function Io(s,a){if(typeof s!="function"||a!=null&&typeof a!="function")throw new Xe(l);var c=function(){var p=arguments,y=a?a.apply(this,p):p[0],T=c.cache;if(T.has(y))return T.get(y);var C=s.apply(this,p);return c.cache=T.set(y,C)||T,C};return c.cache=new(Io.Cache||Fr),c}Io.Cache=Fr;function Po(s){if(typeof s!="function")throw new Xe(l);return function(){var a=arguments;switch(a.length){case 0:return!s.call(this);case 1:return!s.call(this,a[0]);case 2:return!s.call(this,a[0],a[1]);case 3:return!s.call(this,a[0],a[1],a[2])}return!s.apply(this,a)}}function w1(s){return Ld(2,s)}var E1=hx(function(s,a){a=a.length==1&&pt(a[0])?Wt(a[0],Be(ot())):Wt(pe(a,1),Be(ot()));var c=a.length;return _t(function(p){for(var y=-1,T=_e(p.length,c);++y<T;)p[y]=a[y].call(this,p[y]);return De(s,this,p)})}),ah=_t(function(s,a){var c=Jr(a,cn(ah));return Nr(s,D,r,a,c)}),Wd=_t(function(s,a){var c=Jr(a,cn(Wd));return Nr(s,L,r,a,c)}),T1=kr(function(s,a){return Nr(s,F,r,r,r,a)});function A1(s,a){if(typeof s!="function")throw new Xe(l);return a=a===r?a:mt(a),_t(s,a)}function S1(s,a){if(typeof s!="function")throw new Xe(l);return a=a==null?0:le(mt(a),0),_t(function(c){var p=c[a],y=ii(c,0,a);return p&&Zr(y,p),De(s,this,y)})}function C1(s,a,c){var p=!0,y=!0;if(typeof s!="function")throw new Xe(l);return Ht(c)&&(p="leading"in c?!!c.leading:p,y="trailing"in c?!!c.trailing:y),Gd(s,a,{leading:p,maxWait:a,trailing:y})}function I1(s){return Fd(s,1)}function P1(s,a){return ah(zl(a),s)}function R1(){if(!arguments.length)return[];var s=arguments[0];return pt(s)?s:[s]}function M1(s){return Ve(s,v)}function D1(s,a){return a=typeof a=="function"?a:r,Ve(s,v,a)}function B1(s){return Ve(s,g|v)}function O1(s,a){return a=typeof a=="function"?a:r,Ve(s,g|v,a)}function F1(s,a){return a==null||If(s,a,ce(a))}function ir(s,a){return s===a||s!==s&&a!==a}var L1=bo(Bl),N1=bo(function(s,a){return s>=a}),Si=Of(function(){return arguments}())?Of:function(s){return Kt(s)&&Bt.call(s,"callee")&&!xf.call(s,"callee")},pt=B.isArray,k1=tf?Be(tf):V0;function Ce(s){return s!=null&&Ro(s.length)&&!Gr(s)}function Jt(s){return Kt(s)&&Ce(s)}function U1(s){return s===!0||s===!1||Kt(s)&&we(s)==Yt}var ni=Q_||yh,G1=ef?Be(ef):Y0;function W1(s){return Kt(s)&&s.nodeType===1&&!fs(s)}function $1(s){if(s==null)return!0;if(Ce(s)&&(pt(s)||typeof s=="string"||typeof s.splice=="function"||ni(s)||fn(s)||Si(s)))return!s.length;var a=xe(s);if(a==qt||a==tr)return!s.size;if(us(s))return!Ll(s).length;for(var c in s)if(Bt.call(s,c))return!1;return!0}function H1(s,a){return as(s,a)}function X1(s,a,c){c=typeof c=="function"?c:r;var p=c?c(s,a):r;return p===r?as(s,a,r,c):!!p}function lh(s){if(!Kt(s))return!1;var a=we(s);return a==Dt||a==oe||typeof s.message=="string"&&typeof s.name=="string"&&!fs(s)}function z1(s){return typeof s=="number"&&wf(s)}function Gr(s){if(!Ht(s))return!1;var a=we(s);return a==Ut||a==jt||a==ie||a==gy}function $d(s){return typeof s=="number"&&s==mt(s)}function Ro(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=yt}function Ht(s){var a=typeof s;return s!=null&&(a=="object"||a=="function")}function Kt(s){return s!=null&&typeof s=="object"}var Hd=rf?Be(rf):q0;function V1(s,a){return s===a||Fl(s,a,Jl(a))}function Y1(s,a,c){return c=typeof c=="function"?c:r,Fl(s,a,Jl(a),c)}function j1(s){return Xd(s)&&s!=+s}function q1(s){if(Dx(s))throw new ft(o);return Ff(s)}function K1(s){return s===null}function Z1(s){return s==null}function Xd(s){return typeof s=="number"||Kt(s)&&we(s)==ye}function fs(s){if(!Kt(s)||we(s)!=yr)return!1;var a=ro(s);if(a===null)return!0;var c=Bt.call(a,"constructor")&&a.constructor;return typeof c=="function"&&c instanceof c&&Js.call(c)==Y_}var hh=nf?Be(nf):K0;function J1(s){return $d(s)&&s>=-yt&&s<=yt}var zd=sf?Be(sf):Z0;function Mo(s){return typeof s=="string"||!pt(s)&&Kt(s)&&we(s)==qn}function Fe(s){return typeof s=="symbol"||Kt(s)&&we(s)==Hs}var fn=of?Be(of):J0;function Q1(s){return s===r}function tw(s){return Kt(s)&&xe(s)==Kn}function ew(s){return Kt(s)&&we(s)==vy}var rw=bo(Nl),iw=bo(function(s,a){return s<=a});function Vd(s){if(!s)return[];if(Ce(s))return Mo(s)?er(s):Se(s);if(Qn&&s[Qn])return F_(s[Qn]());var a=xe(s),c=a==qt?Tl:a==tr?qs:dn;return c(s)}function Wr(s){if(!s)return s===0?s:0;if(s=qe(s),s===Y||s===-Y){var a=s<0?-1:1;return a*Ot}return s===s?s:0}function mt(s){var a=Wr(s),c=a%1;return a===a?c?a-c:a:0}function Yd(s){return s?wi(mt(s),0,rt):0}function qe(s){if(typeof s=="number")return s;if(Fe(s))return H;if(Ht(s)){var a=typeof s.valueOf=="function"?s.valueOf():s;s=Ht(a)?a+"":a}if(typeof s!="string")return s===0?s:+s;s=ff(s);var c=ky.test(s);return c||Gy.test(s)?y_(s.slice(2),c?2:8):Ny.test(s)?H:+s}function jd(s){return xr(s,Ie(s))}function nw(s){return s?wi(mt(s),-yt,yt):s===0?s:0}function Rt(s){return s==null?"":Oe(s)}var sw=hn(function(s,a){if(us(a)||Ce(a)){xr(a,ce(a),s);return}for(var c in a)Bt.call(a,c)&&ns(s,c,a[c])}),qd=hn(function(s,a){xr(a,Ie(a),s)}),Do=hn(function(s,a,c,p){xr(a,Ie(a),s,p)}),ow=hn(function(s,a,c,p){xr(a,ce(a),s,p)}),aw=kr(Rl);function lw(s,a){var c=ln(s);return a==null?c:Cf(c,a)}var hw=_t(function(s,a){s=Ft(s);var c=-1,p=a.length,y=p>2?a[2]:r;for(y&&Ee(a[0],a[1],y)&&(p=1);++c<p;)for(var T=a[c],C=Ie(T),P=-1,M=C.length;++P<M;){var U=C[P],G=s[U];(G===r||ir(G,sn[U])&&!Bt.call(s,U))&&(s[U]=T[U])}return s}),uw=_t(function(s){return s.push(r,fd),De(Kd,r,s)});function cw(s,a){return lf(s,ot(a,3),_r)}function fw(s,a){return lf(s,ot(a,3),Dl)}function dw(s,a){return s==null?s:Ml(s,ot(a,3),Ie)}function pw(s,a){return s==null?s:Df(s,ot(a,3),Ie)}function gw(s,a){return s&&_r(s,ot(a,3))}function mw(s,a){return s&&Dl(s,ot(a,3))}function vw(s){return s==null?[]:fo(s,ce(s))}function yw(s){return s==null?[]:fo(s,Ie(s))}function uh(s,a,c){var p=s==null?r:Ei(s,a);return p===r?c:p}function _w(s,a){return s!=null&&gd(s,a,$0)}function ch(s,a){return s!=null&&gd(s,a,H0)}var xw=ad(function(s,a,c){a!=null&&typeof a.toString!="function"&&(a=Qs.call(a)),s[a]=c},dh(Pe)),bw=ad(function(s,a,c){a!=null&&typeof a.toString!="function"&&(a=Qs.call(a)),Bt.call(s,a)?s[a].push(c):s[a]=[c]},ot),ww=_t(os);function ce(s){return Ce(s)?Af(s):Ll(s)}function Ie(s){return Ce(s)?Af(s,!0):Q0(s)}function Ew(s,a){var c={};return a=ot(a,3),_r(s,function(p,y,T){Lr(c,a(p,y,T),p)}),c}function Tw(s,a){var c={};return a=ot(a,3),_r(s,function(p,y,T){Lr(c,y,a(p,y,T))}),c}var Aw=hn(function(s,a,c){po(s,a,c)}),Kd=hn(function(s,a,c,p){po(s,a,c,p)}),Sw=kr(function(s,a){var c={};if(s==null)return c;var p=!1;a=Wt(a,function(T){return T=ri(T,s),p||(p=T.length>1),T}),xr(s,Kl(s),c),p&&(c=Ve(c,g|m|v,xx));for(var y=a.length;y--;)$l(c,a[y]);return c});function Cw(s,a){return Zd(s,Po(ot(a)))}var Iw=kr(function(s,a){return s==null?{}:ex(s,a)});function Zd(s,a){if(s==null)return{};var c=Wt(Kl(s),function(p){return[p]});return a=ot(a),$f(s,c,function(p,y){return a(p,y[0])})}function Pw(s,a,c){a=ri(a,s);var p=-1,y=a.length;for(y||(y=1,s=r);++p<y;){var T=s==null?r:s[br(a[p])];T===r&&(p=y,T=c),s=Gr(T)?T.call(s):T}return s}function Rw(s,a,c){return s==null?s:ls(s,a,c)}function Mw(s,a,c,p){return p=typeof p=="function"?p:r,s==null?s:ls(s,a,c,p)}var Jd=ud(ce),Qd=ud(Ie);function Dw(s,a,c){var p=pt(s),y=p||ni(s)||fn(s);if(a=ot(a,4),c==null){var T=s&&s.constructor;y?c=p?new T:[]:Ht(s)?c=Gr(T)?ln(ro(s)):{}:c={}}return(y?He:_r)(s,function(C,P,M){return a(c,C,P,M)}),c}function Bw(s,a){return s==null?!0:$l(s,a)}function Ow(s,a,c){return s==null?s:Yf(s,a,zl(c))}function Fw(s,a,c,p){return p=typeof p=="function"?p:r,s==null?s:Yf(s,a,zl(c),p)}function dn(s){return s==null?[]:El(s,ce(s))}function Lw(s){return s==null?[]:El(s,Ie(s))}function Nw(s,a,c){return c===r&&(c=a,a=r),c!==r&&(c=qe(c),c=c===c?c:0),a!==r&&(a=qe(a),a=a===a?a:0),wi(qe(s),a,c)}function kw(s,a,c){return a=Wr(a),c===r?(c=a,a=0):c=Wr(c),s=qe(s),X0(s,a,c)}function Uw(s,a,c){if(c&&typeof c!="boolean"&&Ee(s,a,c)&&(a=c=r),c===r&&(typeof a=="boolean"?(c=a,a=r):typeof s=="boolean"&&(c=s,s=r)),s===r&&a===r?(s=0,a=1):(s=Wr(s),a===r?(a=s,s=0):a=Wr(a)),s>a){var p=s;s=a,a=p}if(c||s%1||a%1){var y=Ef();return _e(s+y*(a-s+v_("1e-"+((y+"").length-1))),a)}return Ul(s,a)}var Gw=un(function(s,a,c){return a=a.toLowerCase(),s+(c?tp(a):a)});function tp(s){return fh(Rt(s).toLowerCase())}function ep(s){return s=Rt(s),s&&s.replace($y,R_).replace(a_,"")}function Ww(s,a,c){s=Rt(s),a=Oe(a);var p=s.length;c=c===r?p:wi(mt(c),0,p);var y=c;return c-=a.length,c>=0&&s.slice(c,y)==a}function $w(s){return s=Rt(s),s&&wy.test(s)?s.replace(Mc,M_):s}function Hw(s){return s=Rt(s),s&&Iy.test(s)?s.replace(al,"\\$&"):s}var Xw=un(function(s,a,c){return s+(c?"-":"")+a.toLowerCase()}),zw=un(function(s,a,c){return s+(c?" ":"")+a.toLowerCase()}),Vw=nd("toLowerCase");function Yw(s,a,c){s=Rt(s),a=mt(a);var p=a?rn(s):0;if(!a||p>=a)return s;var y=(a-p)/2;return xo(oo(y),c)+s+xo(so(y),c)}function jw(s,a,c){s=Rt(s),a=mt(a);var p=a?rn(s):0;return a&&p<a?s+xo(a-p,c):s}function qw(s,a,c){s=Rt(s),a=mt(a);var p=a?rn(s):0;return a&&p<a?xo(a-p,c)+s:s}function Kw(s,a,c){return c||a==null?a=0:a&&(a=+a),i0(Rt(s).replace(ll,""),a||0)}function Zw(s,a,c){return(c?Ee(s,a,c):a===r)?a=1:a=mt(a),Gl(Rt(s),a)}function Jw(){var s=arguments,a=Rt(s[0]);return s.length<3?a:a.replace(s[1],s[2])}var Qw=un(function(s,a,c){return s+(c?"_":"")+a.toLowerCase()});function tE(s,a,c){return c&&typeof c!="number"&&Ee(s,a,c)&&(a=c=r),c=c===r?rt:c>>>0,c?(s=Rt(s),s&&(typeof a=="string"||a!=null&&!hh(a))&&(a=Oe(a),!a&&en(s))?ii(er(s),0,c):s.split(a,c)):[]}var eE=un(function(s,a,c){return s+(c?" ":"")+fh(a)});function rE(s,a,c){return s=Rt(s),c=c==null?0:wi(mt(c),0,s.length),a=Oe(a),s.slice(c,c+a.length)==a}function iE(s,a,c){var p=b.templateSettings;c&&Ee(s,a,c)&&(a=r),s=Rt(s),a=Do({},a,p,cd);var y=Do({},a.imports,p.imports,cd),T=ce(y),C=El(y,T),P,M,U=0,G=a.interpolate||Xs,$="__p += '",q=Al((a.escape||Xs).source+"|"+G.source+"|"+(G===Dc?Ly:Xs).source+"|"+(a.evaluate||Xs).source+"|$","g"),tt="//# sourceURL="+(Bt.call(a,"sourceURL")?(a.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++f_+"]")+`
`;s.replace(q,function(ht,xt,At,Le,Te,Ne){return At||(At=Le),$+=s.slice(U,Ne).replace(Hy,D_),xt&&(P=!0,$+=`' +
__e(`+xt+`) +
'`),Te&&(M=!0,$+=`';
`+Te+`;
__p += '`),At&&($+=`' +
((__t = (`+At+`)) == null ? '' : __t) +
'`),U=Ne+ht.length,ht}),$+=`';
`;var lt=Bt.call(a,"variable")&&a.variable;if(!lt)$=`with (obj) {
`+$+`
}
`;else if(Oy.test(lt))throw new ft(h);$=(M?$.replace(yy,""):$).replace(_y,"$1").replace(xy,"$1;"),$="function("+(lt||"obj")+`) {
`+(lt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(P?", __e = _.escape":"")+(M?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+$+`return __p
}`;var vt=ip(function(){return It(T,tt+"return "+$).apply(r,C)});if(vt.source=$,lh(vt))throw vt;return vt}function nE(s){return Rt(s).toLowerCase()}function sE(s){return Rt(s).toUpperCase()}function oE(s,a,c){if(s=Rt(s),s&&(c||a===r))return ff(s);if(!s||!(a=Oe(a)))return s;var p=er(s),y=er(a),T=df(p,y),C=pf(p,y)+1;return ii(p,T,C).join("")}function aE(s,a,c){if(s=Rt(s),s&&(c||a===r))return s.slice(0,mf(s)+1);if(!s||!(a=Oe(a)))return s;var p=er(s),y=pf(p,er(a))+1;return ii(p,0,y).join("")}function lE(s,a,c){if(s=Rt(s),s&&(c||a===r))return s.replace(ll,"");if(!s||!(a=Oe(a)))return s;var p=er(s),y=df(p,er(a));return ii(p,y).join("")}function hE(s,a){var c=j,p=z;if(Ht(a)){var y="separator"in a?a.separator:y;c="length"in a?mt(a.length):c,p="omission"in a?Oe(a.omission):p}s=Rt(s);var T=s.length;if(en(s)){var C=er(s);T=C.length}if(c>=T)return s;var P=c-rn(p);if(P<1)return p;var M=C?ii(C,0,P).join(""):s.slice(0,P);if(y===r)return M+p;if(C&&(P+=M.length-P),hh(y)){if(s.slice(P).search(y)){var U,G=M;for(y.global||(y=Al(y.source,Rt(Bc.exec(y))+"g")),y.lastIndex=0;U=y.exec(G);)var $=U.index;M=M.slice(0,$===r?P:$)}}else if(s.indexOf(Oe(y),P)!=P){var q=M.lastIndexOf(y);q>-1&&(M=M.slice(0,q))}return M+p}function uE(s){return s=Rt(s),s&&by.test(s)?s.replace(Rc,U_):s}var cE=un(function(s,a,c){return s+(c?" ":"")+a.toUpperCase()}),fh=nd("toUpperCase");function rp(s,a,c){return s=Rt(s),a=c?r:a,a===r?O_(s)?$_(s):A_(s):s.match(a)||[]}var ip=_t(function(s,a){try{return De(s,r,a)}catch(c){return lh(c)?c:new ft(c)}}),fE=kr(function(s,a){return He(a,function(c){c=br(c),Lr(s,c,oh(s[c],s))}),s});function dE(s){var a=s==null?0:s.length,c=ot();return s=a?Wt(s,function(p){if(typeof p[1]!="function")throw new Xe(l);return[c(p[0]),p[1]]}):[],_t(function(p){for(var y=-1;++y<a;){var T=s[y];if(De(T[0],this,p))return De(T[1],this,p)}})}function pE(s){return U0(Ve(s,g))}function dh(s){return function(){return s}}function gE(s,a){return s==null||s!==s?a:s}var mE=od(),vE=od(!0);function Pe(s){return s}function ph(s){return Lf(typeof s=="function"?s:Ve(s,g))}function yE(s){return kf(Ve(s,g))}function _E(s,a){return Uf(s,Ve(a,g))}var xE=_t(function(s,a){return function(c){return os(c,s,a)}}),bE=_t(function(s,a){return function(c){return os(s,c,a)}});function gh(s,a,c){var p=ce(a),y=fo(a,p);c==null&&!(Ht(a)&&(y.length||!p.length))&&(c=a,a=s,s=this,y=fo(a,ce(a)));var T=!(Ht(c)&&"chain"in c)||!!c.chain,C=Gr(s);return He(y,function(P){var M=a[P];s[P]=M,C&&(s.prototype[P]=function(){var U=this.__chain__;if(T||U){var G=s(this.__wrapped__),$=G.__actions__=Se(this.__actions__);return $.push({func:M,args:arguments,thisArg:s}),G.__chain__=U,G}return M.apply(s,Zr([this.value()],arguments))})}),s}function wE(){return de._===this&&(de._=j_),this}function mh(){}function EE(s){return s=mt(s),_t(function(a){return Gf(a,s)})}var TE=Yl(Wt),AE=Yl(af),SE=Yl(yl);function np(s){return th(s)?_l(br(s)):rx(s)}function CE(s){return function(a){return s==null?r:Ei(s,a)}}var IE=ld(),PE=ld(!0);function vh(){return[]}function yh(){return!1}function RE(){return{}}function ME(){return""}function DE(){return!0}function BE(s,a){if(s=mt(s),s<1||s>yt)return[];var c=rt,p=_e(s,rt);a=ot(a),s-=rt;for(var y=wl(p,a);++c<s;)a(c);return y}function OE(s){return pt(s)?Wt(s,br):Fe(s)?[s]:Se(Td(Rt(s)))}function FE(s){var a=++V_;return Rt(s)+a}var LE=_o(function(s,a){return s+a},0),NE=jl("ceil"),kE=_o(function(s,a){return s/a},1),UE=jl("floor");function GE(s){return s&&s.length?co(s,Pe,Bl):r}function WE(s,a){return s&&s.length?co(s,ot(a,2),Bl):r}function $E(s){return uf(s,Pe)}function HE(s,a){return uf(s,ot(a,2))}function XE(s){return s&&s.length?co(s,Pe,Nl):r}function zE(s,a){return s&&s.length?co(s,ot(a,2),Nl):r}var VE=_o(function(s,a){return s*a},1),YE=jl("round"),jE=_o(function(s,a){return s-a},0);function qE(s){return s&&s.length?bl(s,Pe):0}function KE(s,a){return s&&s.length?bl(s,ot(a,2)):0}return b.after=y1,b.ary=Fd,b.assign=sw,b.assignIn=qd,b.assignInWith=Do,b.assignWith=ow,b.at=aw,b.before=Ld,b.bind=oh,b.bindAll=fE,b.bindKey=Nd,b.castArray=R1,b.chain=Dd,b.chunk=Ux,b.compact=Gx,b.concat=Wx,b.cond=dE,b.conforms=pE,b.constant=dh,b.countBy=qb,b.create=lw,b.curry=kd,b.curryRight=Ud,b.debounce=Gd,b.defaults=hw,b.defaultsDeep=uw,b.defer=_1,b.delay=x1,b.difference=$x,b.differenceBy=Hx,b.differenceWith=Xx,b.drop=zx,b.dropRight=Vx,b.dropRightWhile=Yx,b.dropWhile=jx,b.fill=qx,b.filter=Zb,b.flatMap=t1,b.flatMapDeep=e1,b.flatMapDepth=r1,b.flatten=Id,b.flattenDeep=Kx,b.flattenDepth=Zx,b.flip=b1,b.flow=mE,b.flowRight=vE,b.fromPairs=Jx,b.functions=vw,b.functionsIn=yw,b.groupBy=i1,b.initial=tb,b.intersection=eb,b.intersectionBy=rb,b.intersectionWith=ib,b.invert=xw,b.invertBy=bw,b.invokeMap=s1,b.iteratee=ph,b.keyBy=o1,b.keys=ce,b.keysIn=Ie,b.map=So,b.mapKeys=Ew,b.mapValues=Tw,b.matches=yE,b.matchesProperty=_E,b.memoize=Io,b.merge=Aw,b.mergeWith=Kd,b.method=xE,b.methodOf=bE,b.mixin=gh,b.negate=Po,b.nthArg=EE,b.omit=Sw,b.omitBy=Cw,b.once=w1,b.orderBy=a1,b.over=TE,b.overArgs=E1,b.overEvery=AE,b.overSome=SE,b.partial=ah,b.partialRight=Wd,b.partition=l1,b.pick=Iw,b.pickBy=Zd,b.property=np,b.propertyOf=CE,b.pull=ab,b.pullAll=Rd,b.pullAllBy=lb,b.pullAllWith=hb,b.pullAt=ub,b.range=IE,b.rangeRight=PE,b.rearg=T1,b.reject=c1,b.remove=cb,b.rest=A1,b.reverse=nh,b.sampleSize=d1,b.set=Rw,b.setWith=Mw,b.shuffle=p1,b.slice=fb,b.sortBy=v1,b.sortedUniq=_b,b.sortedUniqBy=xb,b.split=tE,b.spread=S1,b.tail=bb,b.take=wb,b.takeRight=Eb,b.takeRightWhile=Tb,b.takeWhile=Ab,b.tap=Gb,b.throttle=C1,b.thru=Ao,b.toArray=Vd,b.toPairs=Jd,b.toPairsIn=Qd,b.toPath=OE,b.toPlainObject=jd,b.transform=Dw,b.unary=I1,b.union=Sb,b.unionBy=Cb,b.unionWith=Ib,b.uniq=Pb,b.uniqBy=Rb,b.uniqWith=Mb,b.unset=Bw,b.unzip=sh,b.unzipWith=Md,b.update=Ow,b.updateWith=Fw,b.values=dn,b.valuesIn=Lw,b.without=Db,b.words=rp,b.wrap=P1,b.xor=Bb,b.xorBy=Ob,b.xorWith=Fb,b.zip=Lb,b.zipObject=Nb,b.zipObjectDeep=kb,b.zipWith=Ub,b.entries=Jd,b.entriesIn=Qd,b.extend=qd,b.extendWith=Do,gh(b,b),b.add=LE,b.attempt=ip,b.camelCase=Gw,b.capitalize=tp,b.ceil=NE,b.clamp=Nw,b.clone=M1,b.cloneDeep=B1,b.cloneDeepWith=O1,b.cloneWith=D1,b.conformsTo=F1,b.deburr=ep,b.defaultTo=gE,b.divide=kE,b.endsWith=Ww,b.eq=ir,b.escape=$w,b.escapeRegExp=Hw,b.every=Kb,b.find=Jb,b.findIndex=Sd,b.findKey=cw,b.findLast=Qb,b.findLastIndex=Cd,b.findLastKey=fw,b.floor=UE,b.forEach=Bd,b.forEachRight=Od,b.forIn=dw,b.forInRight=pw,b.forOwn=gw,b.forOwnRight=mw,b.get=uh,b.gt=L1,b.gte=N1,b.has=_w,b.hasIn=ch,b.head=Pd,b.identity=Pe,b.includes=n1,b.indexOf=Qx,b.inRange=kw,b.invoke=ww,b.isArguments=Si,b.isArray=pt,b.isArrayBuffer=k1,b.isArrayLike=Ce,b.isArrayLikeObject=Jt,b.isBoolean=U1,b.isBuffer=ni,b.isDate=G1,b.isElement=W1,b.isEmpty=$1,b.isEqual=H1,b.isEqualWith=X1,b.isError=lh,b.isFinite=z1,b.isFunction=Gr,b.isInteger=$d,b.isLength=Ro,b.isMap=Hd,b.isMatch=V1,b.isMatchWith=Y1,b.isNaN=j1,b.isNative=q1,b.isNil=Z1,b.isNull=K1,b.isNumber=Xd,b.isObject=Ht,b.isObjectLike=Kt,b.isPlainObject=fs,b.isRegExp=hh,b.isSafeInteger=J1,b.isSet=zd,b.isString=Mo,b.isSymbol=Fe,b.isTypedArray=fn,b.isUndefined=Q1,b.isWeakMap=tw,b.isWeakSet=ew,b.join=nb,b.kebabCase=Xw,b.last=je,b.lastIndexOf=sb,b.lowerCase=zw,b.lowerFirst=Vw,b.lt=rw,b.lte=iw,b.max=GE,b.maxBy=WE,b.mean=$E,b.meanBy=HE,b.min=XE,b.minBy=zE,b.stubArray=vh,b.stubFalse=yh,b.stubObject=RE,b.stubString=ME,b.stubTrue=DE,b.multiply=VE,b.nth=ob,b.noConflict=wE,b.noop=mh,b.now=Co,b.pad=Yw,b.padEnd=jw,b.padStart=qw,b.parseInt=Kw,b.random=Uw,b.reduce=h1,b.reduceRight=u1,b.repeat=Zw,b.replace=Jw,b.result=Pw,b.round=YE,b.runInContext=R,b.sample=f1,b.size=g1,b.snakeCase=Qw,b.some=m1,b.sortedIndex=db,b.sortedIndexBy=pb,b.sortedIndexOf=gb,b.sortedLastIndex=mb,b.sortedLastIndexBy=vb,b.sortedLastIndexOf=yb,b.startCase=eE,b.startsWith=rE,b.subtract=jE,b.sum=qE,b.sumBy=KE,b.template=iE,b.times=BE,b.toFinite=Wr,b.toInteger=mt,b.toLength=Yd,b.toLower=nE,b.toNumber=qe,b.toSafeInteger=nw,b.toString=Rt,b.toUpper=sE,b.trim=oE,b.trimEnd=aE,b.trimStart=lE,b.truncate=hE,b.unescape=uE,b.uniqueId=FE,b.upperCase=cE,b.upperFirst=fh,b.each=Bd,b.eachRight=Od,b.first=Pd,gh(b,function(){var s={};return _r(b,function(a,c){Bt.call(b.prototype,c)||(s[c]=a)}),s}(),{chain:!1}),b.VERSION=i,He(["bind","bindKey","curry","curryRight","partial","partialRight"],function(s){b[s].placeholder=b}),He(["drop","take"],function(s,a){wt.prototype[s]=function(c){c=c===r?1:le(mt(c),0);var p=this.__filtered__&&!a?new wt(this):this.clone();return p.__filtered__?p.__takeCount__=_e(c,p.__takeCount__):p.__views__.push({size:_e(c,rt),type:s+(p.__dir__<0?"Right":"")}),p},wt.prototype[s+"Right"]=function(c){return this.reverse()[s](c).reverse()}}),He(["filter","map","takeWhile"],function(s,a){var c=a+1,p=c==k||c==dt;wt.prototype[s]=function(y){var T=this.clone();return T.__iteratees__.push({iteratee:ot(y,3),type:c}),T.__filtered__=T.__filtered__||p,T}}),He(["head","last"],function(s,a){var c="take"+(a?"Right":"");wt.prototype[s]=function(){return this[c](1).value()[0]}}),He(["initial","tail"],function(s,a){var c="drop"+(a?"":"Right");wt.prototype[s]=function(){return this.__filtered__?new wt(this):this[c](1)}}),wt.prototype.compact=function(){return this.filter(Pe)},wt.prototype.find=function(s){return this.filter(s).head()},wt.prototype.findLast=function(s){return this.reverse().find(s)},wt.prototype.invokeMap=_t(function(s,a){return typeof s=="function"?new wt(this):this.map(function(c){return os(c,s,a)})}),wt.prototype.reject=function(s){return this.filter(Po(ot(s)))},wt.prototype.slice=function(s,a){s=mt(s);var c=this;return c.__filtered__&&(s>0||a<0)?new wt(c):(s<0?c=c.takeRight(-s):s&&(c=c.drop(s)),a!==r&&(a=mt(a),c=a<0?c.dropRight(-a):c.take(a-s)),c)},wt.prototype.takeRightWhile=function(s){return this.reverse().takeWhile(s).reverse()},wt.prototype.toArray=function(){return this.take(rt)},_r(wt.prototype,function(s,a){var c=/^(?:filter|find|map|reject)|While$/.test(a),p=/^(?:head|last)$/.test(a),y=b[p?"take"+(a=="last"?"Right":""):a],T=p||/^find/.test(a);y&&(b.prototype[a]=function(){var C=this.__wrapped__,P=p?[1]:arguments,M=C instanceof wt,U=P[0],G=M||pt(C),$=function(xt){var At=y.apply(b,Zr([xt],P));return p&&q?At[0]:At};G&&c&&typeof U=="function"&&U.length!=1&&(M=G=!1);var q=this.__chain__,tt=!!this.__actions__.length,lt=T&&!q,vt=M&&!tt;if(!T&&G){C=vt?C:new wt(this);var ht=s.apply(C,P);return ht.__actions__.push({func:Ao,args:[$],thisArg:r}),new ze(ht,q)}return lt&&vt?s.apply(this,P):(ht=this.thru($),lt?p?ht.value()[0]:ht.value():ht)})}),He(["pop","push","shift","sort","splice","unshift"],function(s){var a=Ks[s],c=/^(?:push|sort|unshift)$/.test(s)?"tap":"thru",p=/^(?:pop|shift)$/.test(s);b.prototype[s]=function(){var y=arguments;if(p&&!this.__chain__){var T=this.value();return a.apply(pt(T)?T:[],y)}return this[c](function(C){return a.apply(pt(C)?C:[],y)})}}),_r(wt.prototype,function(s,a){var c=b[a];if(c){var p=c.name+"";Bt.call(an,p)||(an[p]=[]),an[p].push({name:a,func:c})}}),an[yo(r,A).name]=[{name:"wrapper",func:r}],wt.prototype.clone=u0,wt.prototype.reverse=c0,wt.prototype.value=f0,b.prototype.at=Wb,b.prototype.chain=$b,b.prototype.commit=Hb,b.prototype.next=Xb,b.prototype.plant=Vb,b.prototype.reverse=Yb,b.prototype.toJSON=b.prototype.valueOf=b.prototype.value=jb,b.prototype.first=b.prototype.head,Qn&&(b.prototype[Qn]=zb),b},nn=H_();yi?((yi.exports=nn)._=nn,pl._=nn):de._=nn}).call(Ir)})(_a,_a.exports);var Ze=_a.exports;const Ci=Ga(Ze);var qi=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(qi||{}),fu=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(fu||{}),ut=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(ut||{}),Pr=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(Pr||{}),V=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(V||{}),Pn=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(Pn||{}),st=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(st||{}),du=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(du||{}),zr=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(zr||{}),ci=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(ci||{}),Dr=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(Dr||{}),vr=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(vr||{}),Sr=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))(Sr||{}),ec=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(ec||{}),Je=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(Je||{}),ue=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(ue||{}),se=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(se||{}),Rr=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(Rr||{});const tT={createCanvas:(e,t)=>{const r=document.createElement("canvas");return r.width=e,r.height=t,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,"text/xml")},J={ADAPTER:tT,RESOLUTION:1,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,premultipliedAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1,hello:!1},CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var _h=/iPhone/i,op=/iPod/i,ap=/iPad/i,lp=/\biOS-universal(?:.+)Mac\b/i,xh=/\bAndroid(?:.+)Mobile\b/i,hp=/Android/i,pn=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Bo=/Silk/i,Hr=/Windows Phone/i,up=/\bWindows(?:.+)ARM\b/i,cp=/BlackBerry/i,fp=/BB10/i,dp=/Opera Mini/i,pp=/\b(CriOS|Chrome)(?:.+)Mobile/i,gp=/Mobile(?:.+)Firefox\b/i,mp=function(e){return typeof e<"u"&&e.platform==="MacIntel"&&typeof e.maxTouchPoints=="number"&&e.maxTouchPoints>1&&typeof MSStream>"u"};function eT(e){return function(t){return t.test(e)}}function rT(e){var t={userAgent:"",platform:"",maxTouchPoints:0};!e&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof e=="string"?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0});var r=t.userAgent,i=r.split("[FBAN");typeof i[1]<"u"&&(r=i[0]),i=r.split("Twitter"),typeof i[1]<"u"&&(r=i[0]);var n=eT(r),o={apple:{phone:n(_h)&&!n(Hr),ipod:n(op),tablet:!n(_h)&&(n(ap)||mp(t))&&!n(Hr),universal:n(lp),device:(n(_h)||n(op)||n(ap)||n(lp)||mp(t))&&!n(Hr)},amazon:{phone:n(pn),tablet:!n(pn)&&n(Bo),device:n(pn)||n(Bo)},android:{phone:!n(Hr)&&n(pn)||!n(Hr)&&n(xh),tablet:!n(Hr)&&!n(pn)&&!n(xh)&&(n(Bo)||n(hp)),device:!n(Hr)&&(n(pn)||n(Bo)||n(xh)||n(hp))||n(/\bokhttp\b/i)},windows:{phone:n(Hr),tablet:n(up),device:n(Hr)||n(up)},other:{blackberry:n(cp),blackberry10:n(fp),opera:n(dp),firefox:n(gp),chrome:n(pp),device:n(cp)||n(fp)||n(dp)||n(gp)||n(pp)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}const Vr=rT(globalThis.navigator);J.RETINA_PREFIX=/@([0-9\.]+)x/;J.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Zg={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(r=!1));function n(u,f,d){this.fn=u,this.context=f,this.once=d||!1}function o(u,f,d,g,m){if(typeof d!="function")throw new TypeError("The listener must be a function");var v=new n(d,g||u,m),_=r?r+f:f;return u._events[_]?u._events[_].fn?u._events[_]=[u._events[_],v]:u._events[_].push(v):(u._events[_]=v,u._eventsCount++),u}function l(u,f){--u._eventsCount===0?u._events=new i:delete u._events[f]}function h(){this._events=new i,this._eventsCount=0}h.prototype.eventNames=function(){var f=[],d,g;if(this._eventsCount===0)return f;for(g in d=this._events)t.call(d,g)&&f.push(r?g.slice(1):g);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(d)):f},h.prototype.listeners=function(f){var d=r?r+f:f,g=this._events[d];if(!g)return[];if(g.fn)return[g.fn];for(var m=0,v=g.length,_=new Array(v);m<v;m++)_[m]=g[m].fn;return _},h.prototype.listenerCount=function(f){var d=r?r+f:f,g=this._events[d];return g?g.fn?1:g.length:0},h.prototype.emit=function(f,d,g,m,v,_){var w=r?r+f:f;if(!this._events[w])return!1;var x=this._events[w],A=arguments.length,S,E;if(x.fn){switch(x.once&&this.removeListener(f,x.fn,void 0,!0),A){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,d),!0;case 3:return x.fn.call(x.context,d,g),!0;case 4:return x.fn.call(x.context,d,g,m),!0;case 5:return x.fn.call(x.context,d,g,m,v),!0;case 6:return x.fn.call(x.context,d,g,m,v,_),!0}for(E=1,S=new Array(A-1);E<A;E++)S[E-1]=arguments[E];x.fn.apply(x.context,S)}else{var I=x.length,D;for(E=0;E<I;E++)switch(x[E].once&&this.removeListener(f,x[E].fn,void 0,!0),A){case 1:x[E].fn.call(x[E].context);break;case 2:x[E].fn.call(x[E].context,d);break;case 3:x[E].fn.call(x[E].context,d,g);break;case 4:x[E].fn.call(x[E].context,d,g,m);break;default:if(!S)for(D=1,S=new Array(A-1);D<A;D++)S[D-1]=arguments[D];x[E].fn.apply(x[E].context,S)}}return!0},h.prototype.on=function(f,d,g){return o(this,f,d,g,!1)},h.prototype.once=function(f,d,g){return o(this,f,d,g,!0)},h.prototype.removeListener=function(f,d,g,m){var v=r?r+f:f;if(!this._events[v])return this;if(!d)return l(this,v),this;var _=this._events[v];if(_.fn)_.fn===d&&(!m||_.once)&&(!g||_.context===g)&&l(this,v);else{for(var w=0,x=[],A=_.length;w<A;w++)(_[w].fn!==d||m&&!_[w].once||g&&_[w].context!==g)&&x.push(_[w]);x.length?this._events[v]=x.length===1?x[0]:x:l(this,v)}return this},h.prototype.removeAllListeners=function(f){var d;return f?(d=r?r+f:f,this._events[d]&&l(this,d)):(this._events=new i,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=r,h.EventEmitter=h,e.exports=h})(Zg);var iT=Zg.exports;const Ls=Ga(iT);var rc={exports:{}};rc.exports=Wa;rc.exports.default=Wa;function Wa(e,t,r){r=r||2;var i=t&&t.length,n=i?t[0]*r:e.length,o=Jg(e,0,n,r,!0),l=[];if(!o||o.next===o.prev)return l;var h,u,f,d,g,m,v;if(i&&(o=lT(e,t,o,r)),e.length>80*r){h=f=e[0],u=d=e[1];for(var _=r;_<n;_+=r)g=e[_],m=e[_+1],g<h&&(h=g),m<u&&(u=m),g>f&&(f=g),m>d&&(d=m);v=Math.max(f-h,d-u),v=v!==0?32767/v:0}return Is(o,l,r,h,u,v,0),l}function Jg(e,t,r,i,n){var o,l;if(n===mu(e,t,r,i)>0)for(o=t;o<r;o+=i)l=vp(o,e[o],e[o+1],l);else for(o=r-i;o>=t;o-=i)l=vp(o,e[o],e[o+1],l);return l&&$a(l,l.next)&&(Rs(l),l=l.next),l}function Xi(e,t){if(!e)return e;t||(t=e);var r=e,i;do if(i=!1,!r.steiner&&($a(r,r.next)||zt(r.prev,r,r.next)===0)){if(Rs(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function Is(e,t,r,i,n,o,l){if(e){!l&&o&&dT(e,i,n,o);for(var h=e,u,f;e.prev!==e.next;){if(u=e.prev,f=e.next,o?sT(e,i,n,o):nT(e)){t.push(u.i/r|0),t.push(e.i/r|0),t.push(f.i/r|0),Rs(e),e=f.next,h=f.next;continue}if(e=f,e===h){l?l===1?(e=oT(Xi(e),t,r),Is(e,t,r,i,n,o,2)):l===2&&aT(e,t,r,i,n,o):Is(Xi(e),t,r,i,n,o,1);break}}}}function nT(e){var t=e.prev,r=e,i=e.next;if(zt(t,r,i)>=0)return!1;for(var n=t.x,o=r.x,l=i.x,h=t.y,u=r.y,f=i.y,d=n<o?n<l?n:l:o<l?o:l,g=h<u?h<f?h:f:u<f?u:f,m=n>o?n>l?n:l:o>l?o:l,v=h>u?h>f?h:f:u>f?u:f,_=i.next;_!==t;){if(_.x>=d&&_.x<=m&&_.y>=g&&_.y<=v&&Tn(n,h,o,u,l,f,_.x,_.y)&&zt(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function sT(e,t,r,i){var n=e.prev,o=e,l=e.next;if(zt(n,o,l)>=0)return!1;for(var h=n.x,u=o.x,f=l.x,d=n.y,g=o.y,m=l.y,v=h<u?h<f?h:f:u<f?u:f,_=d<g?d<m?d:m:g<m?g:m,w=h>u?h>f?h:f:u>f?u:f,x=d>g?d>m?d:m:g>m?g:m,A=pu(v,_,t,r,i),S=pu(w,x,t,r,i),E=e.prevZ,I=e.nextZ;E&&E.z>=A&&I&&I.z<=S;){if(E.x>=v&&E.x<=w&&E.y>=_&&E.y<=x&&E!==n&&E!==l&&Tn(h,d,u,g,f,m,E.x,E.y)&&zt(E.prev,E,E.next)>=0||(E=E.prevZ,I.x>=v&&I.x<=w&&I.y>=_&&I.y<=x&&I!==n&&I!==l&&Tn(h,d,u,g,f,m,I.x,I.y)&&zt(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;E&&E.z>=A;){if(E.x>=v&&E.x<=w&&E.y>=_&&E.y<=x&&E!==n&&E!==l&&Tn(h,d,u,g,f,m,E.x,E.y)&&zt(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;I&&I.z<=S;){if(I.x>=v&&I.x<=w&&I.y>=_&&I.y<=x&&I!==n&&I!==l&&Tn(h,d,u,g,f,m,I.x,I.y)&&zt(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function oT(e,t,r){var i=e;do{var n=i.prev,o=i.next.next;!$a(n,o)&&Qg(n,i,i.next,o)&&Ps(n,o)&&Ps(o,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(o.i/r|0),Rs(i),Rs(i.next),i=e=o),i=i.next}while(i!==e);return Xi(i)}function aT(e,t,r,i,n,o){var l=e;do{for(var h=l.next.next;h!==l.prev;){if(l.i!==h.i&&mT(l,h)){var u=tm(l,h);l=Xi(l,l.next),u=Xi(u,u.next),Is(l,t,r,i,n,o,0),Is(u,t,r,i,n,o,0);return}h=h.next}l=l.next}while(l!==e)}function lT(e,t,r,i){var n=[],o,l,h,u,f;for(o=0,l=t.length;o<l;o++)h=t[o]*i,u=o<l-1?t[o+1]*i:e.length,f=Jg(e,h,u,i,!1),f===f.next&&(f.steiner=!0),n.push(gT(f));for(n.sort(hT),o=0;o<n.length;o++)r=uT(n[o],r);return r}function hT(e,t){return e.x-t.x}function uT(e,t){var r=cT(e,t);if(!r)return t;var i=tm(r,e);return Xi(i,i.next),Xi(r,r.next)}function cT(e,t){var r=t,i=e.x,n=e.y,o=-1/0,l;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var h=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(h<=i&&h>o&&(o=h,l=r.x<r.next.x?r:r.next,h===i))return l}r=r.next}while(r!==t);if(!l)return null;var u=l,f=l.x,d=l.y,g=1/0,m;r=l;do i>=r.x&&r.x>=f&&i!==r.x&&Tn(n<d?i:o,n,f,d,n<d?o:i,n,r.x,r.y)&&(m=Math.abs(n-r.y)/(i-r.x),Ps(r,e)&&(m<g||m===g&&(r.x>l.x||r.x===l.x&&fT(l,r)))&&(l=r,g=m)),r=r.next;while(r!==u);return l}function fT(e,t){return zt(e.prev,e,t.prev)<0&&zt(t.next,e,e.next)<0}function dT(e,t,r,i){var n=e;do n.z===0&&(n.z=pu(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,pT(n)}function pT(e){var t,r,i,n,o,l,h,u,f=1;do{for(r=e,e=null,o=null,l=0;r;){for(l++,i=r,h=0,t=0;t<f&&(h++,i=i.nextZ,!!i);t++);for(u=f;h>0||u>0&&i;)h!==0&&(u===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,h--):(n=i,i=i.nextZ,u--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;r=i}o.nextZ=null,f*=2}while(l>1);return e}function pu(e,t,r,i,n){return e=(e-r)*n|0,t=(t-i)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function gT(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Tn(e,t,r,i,n,o,l,h){return(n-l)*(t-h)>=(e-l)*(o-h)&&(e-l)*(i-h)>=(r-l)*(t-h)&&(r-l)*(o-h)>=(n-l)*(i-h)}function mT(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!vT(e,t)&&(Ps(e,t)&&Ps(t,e)&&yT(e,t)&&(zt(e.prev,e,t.prev)||zt(e,t.prev,t))||$a(e,t)&&zt(e.prev,e,e.next)>0&&zt(t.prev,t,t.next)>0)}function zt(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function $a(e,t){return e.x===t.x&&e.y===t.y}function Qg(e,t,r,i){var n=Fo(zt(e,t,r)),o=Fo(zt(e,t,i)),l=Fo(zt(r,i,e)),h=Fo(zt(r,i,t));return!!(n!==o&&l!==h||n===0&&Oo(e,r,t)||o===0&&Oo(e,i,t)||l===0&&Oo(r,e,i)||h===0&&Oo(r,t,i))}function Oo(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Fo(e){return e>0?1:e<0?-1:0}function vT(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Qg(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Ps(e,t){return zt(e.prev,e,e.next)<0?zt(e,t,e.next)>=0&&zt(e,e.prev,t)>=0:zt(e,t,e.prev)<0||zt(e,e.next,t)<0}function yT(e,t){var r=e,i=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function tm(e,t){var r=new gu(e.i,e.x,e.y),i=new gu(t.i,t.x,t.y),n=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function vp(e,t,r,i){var n=new gu(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Rs(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function gu(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Wa.deviation=function(e,t,r,i){var n=t&&t.length,o=n?t[0]*r:e.length,l=Math.abs(mu(e,0,o,r));if(n)for(var h=0,u=t.length;h<u;h++){var f=t[h]*r,d=h<u-1?t[h+1]*r:e.length;l-=Math.abs(mu(e,f,d,r))}var g=0;for(h=0;h<i.length;h+=3){var m=i[h]*r,v=i[h+1]*r,_=i[h+2]*r;g+=Math.abs((e[m]-e[_])*(e[v+1]-e[m+1])-(e[m]-e[v])*(e[_+1]-e[m+1]))}return l===0&&g===0?0:Math.abs((g-l)/l)};function mu(e,t,r,i){for(var n=0,o=t,l=r-i;o<r;o+=i)n+=(e[l]-e[o])*(e[o+1]+e[l+1]),l=o;return n}Wa.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var o=0;o<e[n].length;o++)for(var l=0;l<t;l++)r.vertices.push(e[n][o][l]);n>0&&(i+=e[n-1].length,r.holes.push(i))}return r};var _T=rc.exports;const xT=Ga(_T);var xa={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */xa.exports;(function(e,t){(function(r){var i=t&&!t.nodeType&&t,n=e&&!e.nodeType&&e,o=typeof Ir=="object"&&Ir;(o.global===o||o.window===o||o.self===o)&&(r=o);var l,h=2147483647,u=36,f=1,d=26,g=38,m=700,v=72,_=128,w="-",x=/^xn--/,A=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=u-f,D=Math.floor,L=String.fromCharCode,O;function F(H){throw new RangeError(E[H])}function X(H,rt){for(var bt=H.length,Pt=[];bt--;)Pt[bt]=rt(H[bt]);return Pt}function j(H,rt){var bt=H.split("@"),Pt="";bt.length>1&&(Pt=bt[0]+"@",H=bt[1]),H=H.replace(S,".");var Mt=H.split("."),Nt=X(Mt,rt).join(".");return Pt+Nt}function z(H){for(var rt=[],bt=0,Pt=H.length,Mt,Nt;bt<Pt;)Mt=H.charCodeAt(bt++),Mt>=55296&&Mt<=56319&&bt<Pt?(Nt=H.charCodeAt(bt++),(Nt&64512)==56320?rt.push(((Mt&1023)<<10)+(Nt&1023)+65536):(rt.push(Mt),bt--)):rt.push(Mt);return rt}function K(H){return X(H,function(rt){var bt="";return rt>65535&&(rt-=65536,bt+=L(rt>>>10&1023|55296),rt=56320|rt&1023),bt+=L(rt),bt}).join("")}function W(H){return H-48<10?H-22:H-65<26?H-65:H-97<26?H-97:u}function k(H,rt){return H+22+75*(H<26)-((rt!=0)<<5)}function at(H,rt,bt){var Pt=0;for(H=bt?D(H/m):H>>1,H+=D(H/rt);H>I*d>>1;Pt+=u)H=D(H/I);return D(Pt+(I+1)*H/(H+g))}function dt(H){var rt=[],bt=H.length,Pt,Mt=0,Nt=_,kt=v,ie,Yt,ne,oe,Dt,Ut,jt,qt,ye;for(ie=H.lastIndexOf(w),ie<0&&(ie=0),Yt=0;Yt<ie;++Yt)H.charCodeAt(Yt)>=128&&F("not-basic"),rt.push(H.charCodeAt(Yt));for(ne=ie>0?ie+1:0;ne<bt;){for(oe=Mt,Dt=1,Ut=u;ne>=bt&&F("invalid-input"),jt=W(H.charCodeAt(ne++)),(jt>=u||jt>D((h-Mt)/Dt))&&F("overflow"),Mt+=jt*Dt,qt=Ut<=kt?f:Ut>=kt+d?d:Ut-kt,!(jt<qt);Ut+=u)ye=u-qt,Dt>D(h/ye)&&F("overflow"),Dt*=ye;Pt=rt.length+1,kt=at(Mt-oe,Pt,oe==0),D(Mt/Pt)>h-Nt&&F("overflow"),Nt+=D(Mt/Pt),Mt%=Pt,rt.splice(Mt++,0,Nt)}return K(rt)}function Y(H){var rt,bt,Pt,Mt,Nt,kt,ie,Yt,ne,oe,Dt,Ut=[],jt,qt,ye,vi;for(H=z(H),jt=H.length,rt=_,bt=0,Nt=v,kt=0;kt<jt;++kt)Dt=H[kt],Dt<128&&Ut.push(L(Dt));for(Pt=Mt=Ut.length,Mt&&Ut.push(w);Pt<jt;){for(ie=h,kt=0;kt<jt;++kt)Dt=H[kt],Dt>=rt&&Dt<ie&&(ie=Dt);for(qt=Pt+1,ie-rt>D((h-bt)/qt)&&F("overflow"),bt+=(ie-rt)*qt,rt=ie,kt=0;kt<jt;++kt)if(Dt=H[kt],Dt<rt&&++bt>h&&F("overflow"),Dt==rt){for(Yt=bt,ne=u;oe=ne<=Nt?f:ne>=Nt+d?d:ne-Nt,!(Yt<oe);ne+=u)vi=Yt-oe,ye=u-oe,Ut.push(L(k(oe+vi%ye,0))),Yt=D(vi/ye);Ut.push(L(k(Yt,0))),Nt=at(bt,qt,Pt==Mt),bt=0,++Pt}++bt,++rt}return Ut.join("")}function yt(H){return j(H,function(rt){return x.test(rt)?dt(rt.slice(4).toLowerCase()):rt})}function Ot(H){return j(H,function(rt){return A.test(rt)?"xn--"+Y(rt):rt})}if(l={version:"1.4.1",ucs2:{decode:z,encode:K},decode:dt,encode:Y,toASCII:Ot,toUnicode:yt},i&&n)if(e.exports==i)n.exports=l;else for(O in l)l.hasOwnProperty(O)&&(i[O]=l[O]);else r.punycode=l})(Ir)})(xa,xa.exports);var bT=xa.exports,wT=Error,ET=EvalError,TT=RangeError,AT=ReferenceError,em=SyntaxError,Ns=TypeError,ST=URIError,CT=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),i=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;t[r]=n;for(r in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var o=Object.getOwnPropertySymbols(t);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var l=Object.getOwnPropertyDescriptor(t,r);if(l.value!==n||l.enumerable!==!0)return!1}return!0},yp=typeof Symbol<"u"&&Symbol,IT=CT,PT=function(){return typeof yp!="function"||typeof Symbol!="function"||typeof yp("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:IT()},bh={__proto__:null,foo:{}},RT=Object,MT=function(){return{__proto__:bh}.foo===bh.foo&&!(bh instanceof RT)},DT="Function.prototype.bind called on incompatible ",BT=Object.prototype.toString,OT=Math.max,FT="[object Function]",_p=function(t,r){for(var i=[],n=0;n<t.length;n+=1)i[n]=t[n];for(var o=0;o<r.length;o+=1)i[o+t.length]=r[o];return i},LT=function(t,r){for(var i=[],n=r,o=0;n<t.length;n+=1,o+=1)i[o]=t[n];return i},NT=function(e,t){for(var r="",i=0;i<e.length;i+=1)r+=e[i],i+1<e.length&&(r+=t);return r},kT=function(t){var r=this;if(typeof r!="function"||BT.apply(r)!==FT)throw new TypeError(DT+r);for(var i=LT(arguments,1),n,o=function(){if(this instanceof n){var d=r.apply(this,_p(i,arguments));return Object(d)===d?d:this}return r.apply(t,_p(i,arguments))},l=OT(0,r.length-i.length),h=[],u=0;u<l;u++)h[u]="$"+u;if(n=Function("binder","return function ("+NT(h,",")+"){ return binder.apply(this,arguments); }")(o),r.prototype){var f=function(){};f.prototype=r.prototype,n.prototype=new f,f.prototype=null}return n},UT=kT,ic=Function.prototype.bind||UT,GT=Function.prototype.call,WT=Object.prototype.hasOwnProperty,$T=ic,HT=$T.call(GT,WT),Et,XT=wT,zT=ET,VT=TT,YT=AT,Fn=em,Rn=Ns,jT=ST,rm=Function,wh=function(e){try{return rm('"use strict"; return ('+e+").constructor;")()}catch{}},Gi=Object.getOwnPropertyDescriptor;if(Gi)try{Gi({},"")}catch{Gi=null}var Eh=function(){throw new Rn},qT=Gi?function(){try{return arguments.callee,Eh}catch{try{return Gi(arguments,"callee").get}catch{return Eh}}}():Eh,gn=PT(),KT=MT(),fe=Object.getPrototypeOf||(KT?function(e){return e.__proto__}:null),xn={},ZT=typeof Uint8Array>"u"||!fe?Et:fe(Uint8Array),Wi={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Et:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Et:ArrayBuffer,"%ArrayIteratorPrototype%":gn&&fe?fe([][Symbol.iterator]()):Et,"%AsyncFromSyncIteratorPrototype%":Et,"%AsyncFunction%":xn,"%AsyncGenerator%":xn,"%AsyncGeneratorFunction%":xn,"%AsyncIteratorPrototype%":xn,"%Atomics%":typeof Atomics>"u"?Et:Atomics,"%BigInt%":typeof BigInt>"u"?Et:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Et:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Et:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Et:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":XT,"%eval%":eval,"%EvalError%":zT,"%Float32Array%":typeof Float32Array>"u"?Et:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Et:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Et:FinalizationRegistry,"%Function%":rm,"%GeneratorFunction%":xn,"%Int8Array%":typeof Int8Array>"u"?Et:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Et:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Et:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":gn&&fe?fe(fe([][Symbol.iterator]())):Et,"%JSON%":typeof JSON=="object"?JSON:Et,"%Map%":typeof Map>"u"?Et:Map,"%MapIteratorPrototype%":typeof Map>"u"||!gn||!fe?Et:fe(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Et:Promise,"%Proxy%":typeof Proxy>"u"?Et:Proxy,"%RangeError%":VT,"%ReferenceError%":YT,"%Reflect%":typeof Reflect>"u"?Et:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Et:Set,"%SetIteratorPrototype%":typeof Set>"u"||!gn||!fe?Et:fe(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Et:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":gn&&fe?fe(""[Symbol.iterator]()):Et,"%Symbol%":gn?Symbol:Et,"%SyntaxError%":Fn,"%ThrowTypeError%":qT,"%TypedArray%":ZT,"%TypeError%":Rn,"%Uint8Array%":typeof Uint8Array>"u"?Et:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Et:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Et:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Et:Uint32Array,"%URIError%":jT,"%WeakMap%":typeof WeakMap>"u"?Et:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Et:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Et:WeakSet};if(fe)try{null.error}catch(e){var JT=fe(fe(e));Wi["%Error.prototype%"]=JT}var QT=function e(t){var r;if(t==="%AsyncFunction%")r=wh("async function () {}");else if(t==="%GeneratorFunction%")r=wh("function* () {}");else if(t==="%AsyncGeneratorFunction%")r=wh("async function* () {}");else if(t==="%AsyncGenerator%"){var i=e("%AsyncGeneratorFunction%");i&&(r=i.prototype)}else if(t==="%AsyncIteratorPrototype%"){var n=e("%AsyncGenerator%");n&&fe&&(r=fe(n.prototype))}return Wi[t]=r,r},xp={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ks=ic,ba=HT,tA=ks.call(Function.call,Array.prototype.concat),eA=ks.call(Function.apply,Array.prototype.splice),bp=ks.call(Function.call,String.prototype.replace),wa=ks.call(Function.call,String.prototype.slice),rA=ks.call(Function.call,RegExp.prototype.exec),iA=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,nA=/\\(\\)?/g,sA=function(t){var r=wa(t,0,1),i=wa(t,-1);if(r==="%"&&i!=="%")throw new Fn("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&r!=="%")throw new Fn("invalid intrinsic syntax, expected opening `%`");var n=[];return bp(t,iA,function(o,l,h,u){n[n.length]=h?bp(u,nA,"$1"):l||o}),n},oA=function(t,r){var i=t,n;if(ba(xp,i)&&(n=xp[i],i="%"+n[0]+"%"),ba(Wi,i)){var o=Wi[i];if(o===xn&&(o=QT(i)),typeof o>"u"&&!r)throw new Rn("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:o}}throw new Fn("intrinsic "+t+" does not exist!")},Xn=function(t,r){if(typeof t!="string"||t.length===0)throw new Rn("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Rn('"allowMissing" argument must be a boolean');if(rA(/^%?[^%]*%?$/,t)===null)throw new Fn("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=sA(t),n=i.length>0?i[0]:"",o=oA("%"+n+"%",r),l=o.name,h=o.value,u=!1,f=o.alias;f&&(n=f[0],eA(i,tA([0,1],f)));for(var d=1,g=!0;d<i.length;d+=1){var m=i[d],v=wa(m,0,1),_=wa(m,-1);if((v==='"'||v==="'"||v==="`"||_==='"'||_==="'"||_==="`")&&v!==_)throw new Fn("property names with quotes must have matching quotes");if((m==="constructor"||!g)&&(u=!0),n+="."+m,l="%"+n+"%",ba(Wi,l))h=Wi[l];else if(h!=null){if(!(m in h)){if(!r)throw new Rn("base intrinsic for "+t+" exists, but the property is not available.");return}if(Gi&&d+1>=i.length){var w=Gi(h,m);g=!!w,g&&"get"in w&&!("originalValue"in w.get)?h=w.get:h=h[m]}else g=ba(h,m),h=h[m];g&&!u&&(Wi[l]=h)}}return h},im={exports:{}},Th,wp;function nc(){if(wp)return Th;wp=1;var e=Xn,t=e("%Object.defineProperty%",!0)||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return Th=t,Th}var aA=Xn,la=aA("%Object.getOwnPropertyDescriptor%",!0);if(la)try{la([],"length")}catch{la=null}var nm=la,Ep=nc(),lA=em,mn=Ns,Tp=nm,hA=function(t,r,i){if(!t||typeof t!="object"&&typeof t!="function")throw new mn("`obj` must be an object or a function`");if(typeof r!="string"&&typeof r!="symbol")throw new mn("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new mn("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new mn("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new mn("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new mn("`loose`, if provided, must be a boolean");var n=arguments.length>3?arguments[3]:null,o=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,h=arguments.length>6?arguments[6]:!1,u=!!Tp&&Tp(t,r);if(Ep)Ep(t,r,{configurable:l===null&&u?u.configurable:!l,enumerable:n===null&&u?u.enumerable:!n,value:i,writable:o===null&&u?u.writable:!o});else if(h||!n&&!o&&!l)t[r]=i;else throw new lA("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},vu=nc(),sm=function(){return!!vu};sm.hasArrayLengthDefineBug=function(){if(!vu)return null;try{return vu([],"length",{value:1}).length!==1}catch{return!0}};var uA=sm,cA=Xn,Ap=hA,fA=uA(),Sp=nm,Cp=Ns,dA=cA("%Math.floor%"),pA=function(t,r){if(typeof t!="function")throw new Cp("`fn` is not a function");if(typeof r!="number"||r<0||r>4294967295||dA(r)!==r)throw new Cp("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],n=!0,o=!0;if("length"in t&&Sp){var l=Sp(t,"length");l&&!l.configurable&&(n=!1),l&&!l.writable&&(o=!1)}return(n||o||!i)&&(fA?Ap(t,"length",r,!0,!0):Ap(t,"length",r)),t};(function(e){var t=ic,r=Xn,i=pA,n=Ns,o=r("%Function.prototype.apply%"),l=r("%Function.prototype.call%"),h=r("%Reflect.apply%",!0)||t.call(l,o),u=nc(),f=r("%Math.max%");e.exports=function(m){if(typeof m!="function")throw new n("a function is required");var v=h(t,l,arguments);return i(v,1+f(0,m.length-(arguments.length-1)),!0)};var d=function(){return h(t,o,arguments)};u?u(e.exports,"apply",{value:d}):e.exports.apply=d})(im);var gA=im.exports,om=Xn,am=gA,mA=am(om("String.prototype.indexOf")),vA=function(t,r){var i=om(t,!!r);return typeof i=="function"&&mA(t,".prototype.")>-1?am(i):i};const yA={},_A=Object.freeze(Object.defineProperty({__proto__:null,default:yA},Symbol.toStringTag,{value:"Module"})),xA=QE(_A);var sc=typeof Map=="function"&&Map.prototype,Ah=Object.getOwnPropertyDescriptor&&sc?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Ea=sc&&Ah&&typeof Ah.get=="function"?Ah.get:null,Ip=sc&&Map.prototype.forEach,oc=typeof Set=="function"&&Set.prototype,Sh=Object.getOwnPropertyDescriptor&&oc?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Ta=oc&&Sh&&typeof Sh.get=="function"?Sh.get:null,Pp=oc&&Set.prototype.forEach,bA=typeof WeakMap=="function"&&WeakMap.prototype,Es=bA?WeakMap.prototype.has:null,wA=typeof WeakSet=="function"&&WeakSet.prototype,Ts=wA?WeakSet.prototype.has:null,EA=typeof WeakRef=="function"&&WeakRef.prototype,Rp=EA?WeakRef.prototype.deref:null,TA=Boolean.prototype.valueOf,AA=Object.prototype.toString,SA=Function.prototype.toString,CA=String.prototype.match,ac=String.prototype.slice,hi=String.prototype.replace,IA=String.prototype.toUpperCase,Mp=String.prototype.toLowerCase,lm=RegExp.prototype.test,Dp=Array.prototype.concat,Cr=Array.prototype.join,PA=Array.prototype.slice,Bp=Math.floor,yu=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Ch=Object.getOwnPropertySymbols,_u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ln=typeof Symbol=="function"&&typeof Symbol.iterator=="object",be=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ln||!0)?Symbol.toStringTag:null,hm=Object.prototype.propertyIsEnumerable,Op=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Fp(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||lm.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e=="number"){var i=e<0?-Bp(-e):Bp(e);if(i!==e){var n=String(i),o=ac.call(t,n.length+1);return hi.call(n,r,"$&_")+"."+hi.call(hi.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return hi.call(t,r,"$&_")}var xu=xA,Lp=xu.custom,Np=cm(Lp)?Lp:null,RA=function e(t,r,i,n){var o=r||{};if(oi(o,"quoteStyle")&&o.quoteStyle!=="single"&&o.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(oi(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var l=oi(o,"customInspect")?o.customInspect:!0;if(typeof l!="boolean"&&l!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(oi(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(oi(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var h=o.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return dm(t,o);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var u=String(t);return h?Fp(t,u):u}if(typeof t=="bigint"){var f=String(t)+"n";return h?Fp(t,f):f}var d=typeof o.depth>"u"?5:o.depth;if(typeof i>"u"&&(i=0),i>=d&&d>0&&typeof t=="object")return bu(t)?"[Array]":"[Object]";var g=jA(o,i);if(typeof n>"u")n=[];else if(fm(n,t)>=0)return"[Circular]";function m(W,k,at){if(k&&(n=PA.call(n),n.push(k)),at){var dt={depth:o.depth};return oi(o,"quoteStyle")&&(dt.quoteStyle=o.quoteStyle),e(W,dt,i+1,n)}return e(W,o,i+1,n)}if(typeof t=="function"&&!kp(t)){var v=UA(t),_=Lo(t,m);return"[Function"+(v?": "+v:" (anonymous)")+"]"+(_.length>0?" { "+Cr.call(_,", ")+" }":"")}if(cm(t)){var w=Ln?hi.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):_u.call(t);return typeof t=="object"&&!Ln?ds(w):w}if(zA(t)){for(var x="<"+Mp.call(String(t.nodeName)),A=t.attributes||[],S=0;S<A.length;S++)x+=" "+A[S].name+"="+um(MA(A[S].value),"double",o);return x+=">",t.childNodes&&t.childNodes.length&&(x+="..."),x+="</"+Mp.call(String(t.nodeName))+">",x}if(bu(t)){if(t.length===0)return"[]";var E=Lo(t,m);return g&&!YA(E)?"["+wu(E,g)+"]":"[ "+Cr.call(E,", ")+" ]"}if(BA(t)){var I=Lo(t,m);return!("cause"in Error.prototype)&&"cause"in t&&!hm.call(t,"cause")?"{ ["+String(t)+"] "+Cr.call(Dp.call("[cause]: "+m(t.cause),I),", ")+" }":I.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+Cr.call(I,", ")+" }"}if(typeof t=="object"&&l){if(Np&&typeof t[Np]=="function"&&xu)return xu(t,{depth:d-i});if(l!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(GA(t)){var D=[];return Ip&&Ip.call(t,function(W,k){D.push(m(k,t,!0)+" => "+m(W,t))}),Up("Map",Ea.call(t),D,g)}if(HA(t)){var L=[];return Pp&&Pp.call(t,function(W){L.push(m(W,t))}),Up("Set",Ta.call(t),L,g)}if(WA(t))return Ih("WeakMap");if(XA(t))return Ih("WeakSet");if($A(t))return Ih("WeakRef");if(FA(t))return ds(m(Number(t)));if(NA(t))return ds(m(yu.call(t)));if(LA(t))return ds(TA.call(t));if(OA(t))return ds(m(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(t===Ir)return"{ [object globalThis] }";if(!DA(t)&&!kp(t)){var O=Lo(t,m),F=Op?Op(t)===Object.prototype:t instanceof Object||t.constructor===Object,X=t instanceof Object?"":"null prototype",j=!F&&be&&Object(t)===t&&be in t?ac.call(mi(t),8,-1):X?"Object":"",z=F||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",K=z+(j||X?"["+Cr.call(Dp.call([],j||[],X||[]),": ")+"] ":"");return O.length===0?K+"{}":g?K+"{"+wu(O,g)+"}":K+"{ "+Cr.call(O,", ")+" }"}return String(t)};function um(e,t,r){var i=(r.quoteStyle||t)==="double"?'"':"'";return i+e+i}function MA(e){return hi.call(String(e),/"/g,"&quot;")}function bu(e){return mi(e)==="[object Array]"&&(!be||!(typeof e=="object"&&be in e))}function DA(e){return mi(e)==="[object Date]"&&(!be||!(typeof e=="object"&&be in e))}function kp(e){return mi(e)==="[object RegExp]"&&(!be||!(typeof e=="object"&&be in e))}function BA(e){return mi(e)==="[object Error]"&&(!be||!(typeof e=="object"&&be in e))}function OA(e){return mi(e)==="[object String]"&&(!be||!(typeof e=="object"&&be in e))}function FA(e){return mi(e)==="[object Number]"&&(!be||!(typeof e=="object"&&be in e))}function LA(e){return mi(e)==="[object Boolean]"&&(!be||!(typeof e=="object"&&be in e))}function cm(e){if(Ln)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!_u)return!1;try{return _u.call(e),!0}catch{}return!1}function NA(e){if(!e||typeof e!="object"||!yu)return!1;try{return yu.call(e),!0}catch{}return!1}var kA=Object.prototype.hasOwnProperty||function(e){return e in this};function oi(e,t){return kA.call(e,t)}function mi(e){return AA.call(e)}function UA(e){if(e.name)return e.name;var t=CA.call(SA.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function fm(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}function GA(e){if(!Ea||!e||typeof e!="object")return!1;try{Ea.call(e);try{Ta.call(e)}catch{return!0}return e instanceof Map}catch{}return!1}function WA(e){if(!Es||!e||typeof e!="object")return!1;try{Es.call(e,Es);try{Ts.call(e,Ts)}catch{return!0}return e instanceof WeakMap}catch{}return!1}function $A(e){if(!Rp||!e||typeof e!="object")return!1;try{return Rp.call(e),!0}catch{}return!1}function HA(e){if(!Ta||!e||typeof e!="object")return!1;try{Ta.call(e);try{Ea.call(e)}catch{return!0}return e instanceof Set}catch{}return!1}function XA(e){if(!Ts||!e||typeof e!="object")return!1;try{Ts.call(e,Ts);try{Es.call(e,Es)}catch{return!0}return e instanceof WeakSet}catch{}return!1}function zA(e){return!e||typeof e!="object"?!1:typeof HTMLElement<"u"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function dm(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,i="... "+r+" more character"+(r>1?"s":"");return dm(ac.call(e,0,t.maxStringLength),t)+i}var n=hi.call(hi.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,VA);return um(n,"single",t)}function VA(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+IA.call(t.toString(16))}function ds(e){return"Object("+e+")"}function Ih(e){return e+" { ? }"}function Up(e,t,r,i){var n=i?wu(r,i):Cr.call(r,", ");return e+" ("+t+") {"+n+"}"}function YA(e){for(var t=0;t<e.length;t++)if(fm(e[t],`
`)>=0)return!1;return!0}function jA(e,t){var r;if(e.indent==="	")r="	";else if(typeof e.indent=="number"&&e.indent>0)r=Cr.call(Array(e.indent+1)," ");else return null;return{base:r,prev:Cr.call(Array(t+1),r)}}function wu(e,t){if(e.length===0)return"";var r=`
`+t.prev+t.base;return r+Cr.call(e,","+r)+`
`+t.prev}function Lo(e,t){var r=bu(e),i=[];if(r){i.length=e.length;for(var n=0;n<e.length;n++)i[n]=oi(e,n)?t(e[n],e):""}var o=typeof Ch=="function"?Ch(e):[],l;if(Ln){l={};for(var h=0;h<o.length;h++)l["$"+o[h]]=o[h]}for(var u in e)oi(e,u)&&(r&&String(Number(u))===u&&u<e.length||Ln&&l["$"+u]instanceof Symbol||(lm.call(/[^\w$]/,u)?i.push(t(u,e)+": "+t(e[u],e)):i.push(u+": "+t(e[u],e))));if(typeof Ch=="function")for(var f=0;f<o.length;f++)hm.call(e,o[f])&&i.push("["+t(o[f])+"]: "+t(e[o[f]],e));return i}var pm=Xn,zn=vA,qA=RA,KA=Ns,No=pm("%WeakMap%",!0),ko=pm("%Map%",!0),ZA=zn("WeakMap.prototype.get",!0),JA=zn("WeakMap.prototype.set",!0),QA=zn("WeakMap.prototype.has",!0),tS=zn("Map.prototype.get",!0),eS=zn("Map.prototype.set",!0),rS=zn("Map.prototype.has",!0),lc=function(e,t){for(var r=e,i;(i=r.next)!==null;r=i)if(i.key===t)return r.next=i.next,i.next=e.next,e.next=i,i},iS=function(e,t){var r=lc(e,t);return r&&r.value},nS=function(e,t,r){var i=lc(e,t);i?i.value=r:e.next={key:t,next:e.next,value:r}},sS=function(e,t){return!!lc(e,t)},oS=function(){var t,r,i,n={assert:function(o){if(!n.has(o))throw new KA("Side channel does not contain "+qA(o))},get:function(o){if(No&&o&&(typeof o=="object"||typeof o=="function")){if(t)return ZA(t,o)}else if(ko){if(r)return tS(r,o)}else if(i)return iS(i,o)},has:function(o){if(No&&o&&(typeof o=="object"||typeof o=="function")){if(t)return QA(t,o)}else if(ko){if(r)return rS(r,o)}else if(i)return sS(i,o);return!1},set:function(o,l){No&&o&&(typeof o=="object"||typeof o=="function")?(t||(t=new No),JA(t,o,l)):ko?(r||(r=new ko),eS(r,o,l)):(i||(i={key:{},next:null}),nS(i,o,l))}};return n},aS=String.prototype.replace,lS=/%20/g,Ph={RFC1738:"RFC1738",RFC3986:"RFC3986"},hc={default:Ph.RFC3986,formatters:{RFC1738:function(e){return aS.call(e,lS,"+")},RFC3986:function(e){return String(e)}},RFC1738:Ph.RFC1738,RFC3986:Ph.RFC3986},hS=hc,Rh=Object.prototype.hasOwnProperty,Fi=Array.isArray,wr=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),uS=function(t){for(;t.length>1;){var r=t.pop(),i=r.obj[r.prop];if(Fi(i)){for(var n=[],o=0;o<i.length;++o)typeof i[o]<"u"&&n.push(i[o]);r.obj[r.prop]=n}}},gm=function(t,r){for(var i=r&&r.plainObjects?Object.create(null):{},n=0;n<t.length;++n)typeof t[n]<"u"&&(i[n]=t[n]);return i},cS=function e(t,r,i){if(!r)return t;if(typeof r!="object"){if(Fi(t))t.push(r);else if(t&&typeof t=="object")(i&&(i.plainObjects||i.allowPrototypes)||!Rh.call(Object.prototype,r))&&(t[r]=!0);else return[t,r];return t}if(!t||typeof t!="object")return[t].concat(r);var n=t;return Fi(t)&&!Fi(r)&&(n=gm(t,i)),Fi(t)&&Fi(r)?(r.forEach(function(o,l){if(Rh.call(t,l)){var h=t[l];h&&typeof h=="object"&&o&&typeof o=="object"?t[l]=e(h,o,i):t.push(o)}else t[l]=o}),t):Object.keys(r).reduce(function(o,l){var h=r[l];return Rh.call(o,l)?o[l]=e(o[l],h,i):o[l]=h,o},n)},fS=function(t,r){return Object.keys(r).reduce(function(i,n){return i[n]=r[n],i},t)},dS=function(e,t,r){var i=e.replace(/\+/g," ");if(r==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},Mh=1024,pS=function(t,r,i,n,o){if(t.length===0)return t;var l=t;if(typeof t=="symbol"?l=Symbol.prototype.toString.call(t):typeof t!="string"&&(l=String(t)),i==="iso-8859-1")return escape(l).replace(/%u[0-9a-f]{4}/gi,function(v){return"%26%23"+parseInt(v.slice(2),16)+"%3B"});for(var h="",u=0;u<l.length;u+=Mh){for(var f=l.length>=Mh?l.slice(u,u+Mh):l,d=[],g=0;g<f.length;++g){var m=f.charCodeAt(g);if(m===45||m===46||m===95||m===126||m>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122||o===hS.RFC1738&&(m===40||m===41)){d[d.length]=f.charAt(g);continue}if(m<128){d[d.length]=wr[m];continue}if(m<2048){d[d.length]=wr[192|m>>6]+wr[128|m&63];continue}if(m<55296||m>=57344){d[d.length]=wr[224|m>>12]+wr[128|m>>6&63]+wr[128|m&63];continue}g+=1,m=65536+((m&1023)<<10|f.charCodeAt(g)&1023),d[d.length]=wr[240|m>>18]+wr[128|m>>12&63]+wr[128|m>>6&63]+wr[128|m&63]}h+=d.join("")}return h},gS=function(t){for(var r=[{obj:{o:t},prop:"o"}],i=[],n=0;n<r.length;++n)for(var o=r[n],l=o.obj[o.prop],h=Object.keys(l),u=0;u<h.length;++u){var f=h[u],d=l[f];typeof d=="object"&&d!==null&&i.indexOf(d)===-1&&(r.push({obj:l,prop:f}),i.push(d))}return uS(r),t},mS=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},vS=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},yS=function(t,r){return[].concat(t,r)},_S=function(t,r){if(Fi(t)){for(var i=[],n=0;n<t.length;n+=1)i.push(r(t[n]));return i}return r(t)},mm={arrayToObject:gm,assign:fS,combine:yS,compact:gS,decode:dS,encode:pS,isBuffer:vS,isRegExp:mS,maybeMap:_S,merge:cS},vm=oS,ha=mm,As=hc,xS=Object.prototype.hasOwnProperty,ym={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,r){return t+"["+r+"]"},repeat:function(t){return t}},Ar=Array.isArray,bS=Array.prototype.push,_m=function(e,t){bS.apply(e,Ar(t)?t:[t])},wS=Date.prototype.toISOString,Gp=As.default,he={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:ha.encode,encodeValuesOnly:!1,format:Gp,formatter:As.formatters[Gp],indices:!1,serializeDate:function(t){return wS.call(t)},skipNulls:!1,strictNullHandling:!1},ES=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},Dh={},TS=function e(t,r,i,n,o,l,h,u,f,d,g,m,v,_,w,x,A,S){for(var E=t,I=S,D=0,L=!1;(I=I.get(Dh))!==void 0&&!L;){var O=I.get(t);if(D+=1,typeof O<"u"){if(O===D)throw new RangeError("Cyclic object value");L=!0}typeof I.get(Dh)>"u"&&(D=0)}if(typeof d=="function"?E=d(r,E):E instanceof Date?E=v(E):i==="comma"&&Ar(E)&&(E=ha.maybeMap(E,function(H){return H instanceof Date?v(H):H})),E===null){if(l)return f&&!x?f(r,he.encoder,A,"key",_):r;E=""}if(ES(E)||ha.isBuffer(E)){if(f){var F=x?r:f(r,he.encoder,A,"key",_);return[w(F)+"="+w(f(E,he.encoder,A,"value",_))]}return[w(r)+"="+w(String(E))]}var X=[];if(typeof E>"u")return X;var j;if(i==="comma"&&Ar(E))x&&f&&(E=ha.maybeMap(E,f)),j=[{value:E.length>0?E.join(",")||null:void 0}];else if(Ar(d))j=d;else{var z=Object.keys(E);j=g?z.sort(g):z}var K=u?r.replace(/\./g,"%2E"):r,W=n&&Ar(E)&&E.length===1?K+"[]":K;if(o&&Ar(E)&&E.length===0)return W+"[]";for(var k=0;k<j.length;++k){var at=j[k],dt=typeof at=="object"&&typeof at.value<"u"?at.value:E[at];if(!(h&&dt===null)){var Y=m&&u?at.replace(/\./g,"%2E"):at,yt=Ar(E)?typeof i=="function"?i(W,Y):W:W+(m?"."+Y:"["+Y+"]");S.set(t,D);var Ot=vm();Ot.set(Dh,S),_m(X,e(dt,yt,i,n,o,l,h,u,i==="comma"&&x&&Ar(E)?null:f,d,g,m,v,_,w,x,A,Ot))}}return X},AS=function(t){if(!t)return he;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=t.charset||he.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=As.default;if(typeof t.format<"u"){if(!xS.call(As.formatters,t.format))throw new TypeError("Unknown format option provided.");i=t.format}var n=As.formatters[i],o=he.filter;(typeof t.filter=="function"||Ar(t.filter))&&(o=t.filter);var l;if(t.arrayFormat in ym?l=t.arrayFormat:"indices"in t?l=t.indices?"indices":"repeat":l=he.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var h=typeof t.allowDots>"u"?t.encodeDotInKeys===!0?!0:he.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:he.addQueryPrefix,allowDots:h,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:he.allowEmptyArrays,arrayFormat:l,charset:r,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:he.charsetSentinel,commaRoundTrip:t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?he.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:he.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:he.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:he.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:he.encodeValuesOnly,filter:o,format:i,formatter:n,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:he.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:he.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:he.strictNullHandling}},SS=function(e,t){var r=e,i=AS(t),n,o;typeof i.filter=="function"?(o=i.filter,r=o("",r)):Ar(i.filter)&&(o=i.filter,n=o);var l=[];if(typeof r!="object"||r===null)return"";var h=ym[i.arrayFormat],u=h==="comma"&&i.commaRoundTrip;n||(n=Object.keys(r)),i.sort&&n.sort(i.sort);for(var f=vm(),d=0;d<n.length;++d){var g=n[d];i.skipNulls&&r[g]===null||_m(l,TS(r[g],g,h,u,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,f))}var m=l.join(i.delimiter),v=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?v+="utf8=%26%2310003%3B&":v+="utf8=%E2%9C%93&"),m.length>0?v+m:""},Nn=mm,Eu=Object.prototype.hasOwnProperty,CS=Array.isArray,te={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Nn.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},IS=function(e){return e.replace(/&#(\d+);/g,function(t,r){return String.fromCharCode(parseInt(r,10))})},xm=function(e,t){return e&&typeof e=="string"&&t.comma&&e.indexOf(",")>-1?e.split(","):e},PS="utf8=%26%2310003%3B",RS="utf8=%E2%9C%93",MS=function(t,r){var i={__proto__:null},n=r.ignoreQueryPrefix?t.replace(/^\?/,""):t,o=r.parameterLimit===1/0?void 0:r.parameterLimit,l=n.split(r.delimiter,o),h=-1,u,f=r.charset;if(r.charsetSentinel)for(u=0;u<l.length;++u)l[u].indexOf("utf8=")===0&&(l[u]===RS?f="utf-8":l[u]===PS&&(f="iso-8859-1"),h=u,u=l.length);for(u=0;u<l.length;++u)if(u!==h){var d=l[u],g=d.indexOf("]="),m=g===-1?d.indexOf("="):g+1,v,_;m===-1?(v=r.decoder(d,te.decoder,f,"key"),_=r.strictNullHandling?null:""):(v=r.decoder(d.slice(0,m),te.decoder,f,"key"),_=Nn.maybeMap(xm(d.slice(m+1),r),function(x){return r.decoder(x,te.decoder,f,"value")})),_&&r.interpretNumericEntities&&f==="iso-8859-1"&&(_=IS(_)),d.indexOf("[]=")>-1&&(_=CS(_)?[_]:_);var w=Eu.call(i,v);w&&r.duplicates==="combine"?i[v]=Nn.combine(i[v],_):(!w||r.duplicates==="last")&&(i[v]=_)}return i},DS=function(e,t,r,i){for(var n=i?t:xm(t,r),o=e.length-1;o>=0;--o){var l,h=e[o];if(h==="[]"&&r.parseArrays)l=r.allowEmptyArrays&&n===""?[]:[].concat(n);else{l=r.plainObjects?Object.create(null):{};var u=h.charAt(0)==="["&&h.charAt(h.length-1)==="]"?h.slice(1,-1):h,f=r.decodeDotInKeys?u.replace(/%2E/g,"."):u,d=parseInt(f,10);!r.parseArrays&&f===""?l={0:n}:!isNaN(d)&&h!==f&&String(d)===f&&d>=0&&r.parseArrays&&d<=r.arrayLimit?(l=[],l[d]=n):f!=="__proto__"&&(l[f]=n)}n=l}return n},BS=function(t,r,i,n){if(t){var o=i.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,l=/(\[[^[\]]*])/,h=/(\[[^[\]]*])/g,u=i.depth>0&&l.exec(o),f=u?o.slice(0,u.index):o,d=[];if(f){if(!i.plainObjects&&Eu.call(Object.prototype,f)&&!i.allowPrototypes)return;d.push(f)}for(var g=0;i.depth>0&&(u=h.exec(o))!==null&&g<i.depth;){if(g+=1,!i.plainObjects&&Eu.call(Object.prototype,u[1].slice(1,-1))&&!i.allowPrototypes)return;d.push(u[1])}return u&&d.push("["+o.slice(u.index)+"]"),DS(d,r,i,n)}},OS=function(t){if(!t)return te;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.decodeDotInKeys<"u"&&typeof t.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(t.decoder!==null&&typeof t.decoder<"u"&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=typeof t.charset>"u"?te.charset:t.charset,i=typeof t.duplicates>"u"?te.duplicates:t.duplicates;if(i!=="combine"&&i!=="first"&&i!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var n=typeof t.allowDots>"u"?t.decodeDotInKeys===!0?!0:te.allowDots:!!t.allowDots;return{allowDots:n,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:te.allowEmptyArrays,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:te.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:te.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:te.arrayLimit,charset:r,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:te.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:te.comma,decodeDotInKeys:typeof t.decodeDotInKeys=="boolean"?t.decodeDotInKeys:te.decodeDotInKeys,decoder:typeof t.decoder=="function"?t.decoder:te.decoder,delimiter:typeof t.delimiter=="string"||Nn.isRegExp(t.delimiter)?t.delimiter:te.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:te.depth,duplicates:i,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:te.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:te.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:te.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:te.strictNullHandling}},FS=function(e,t){var r=OS(t);if(e===""||e===null||typeof e>"u")return r.plainObjects?Object.create(null):{};for(var i=typeof e=="string"?MS(e,r):e,n=r.plainObjects?Object.create(null):{},o=Object.keys(i),l=0;l<o.length;++l){var h=o[l],u=BS(h,i[h],r,typeof e=="string");n=Nn.merge(n,u,r)}return r.allowSparse===!0?n:Nn.compact(n)},LS=SS,NS=FS,kS=hc,US={formats:kS,parse:NS,stringify:LS},GS=bT;function pr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var WS=/^([a-z0-9.+-]+:)/i,$S=/:[0-9]*$/,HS=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,XS=["<",">",'"',"`"," ","\r",`
`,"	"],zS=["{","}","|","\\","^","`"].concat(XS),Tu=["'"].concat(zS),Wp=["%","/","?",";","#"].concat(Tu),$p=["/","?","#"],VS=255,Hp=/^[+a-z0-9A-Z_-]{0,63}$/,YS=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,jS={javascript:!0,"javascript:":!0},Au={javascript:!0,"javascript:":!0},Mn={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Su=US;function Ha(e,t,r){if(e&&typeof e=="object"&&e instanceof pr)return e;var i=new pr;return i.parse(e,t,r),i}pr.prototype.parse=function(e,t,r){if(typeof e!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),n=i!==-1&&i<e.indexOf("#")?"?":"#",o=e.split(n),l=/\\/g;o[0]=o[0].replace(l,"/"),e=o.join(n);var h=e;if(h=h.trim(),!r&&e.split("#").length===1){var u=HS.exec(h);if(u)return this.path=h,this.href=h,this.pathname=u[1],u[2]?(this.search=u[2],t?this.query=Su.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var f=WS.exec(h);if(f){f=f[0];var d=f.toLowerCase();this.protocol=d,h=h.substr(f.length)}if(r||f||h.match(/^\/\/[^@/]+@[^@/]+/)){var g=h.substr(0,2)==="//";g&&!(f&&Au[f])&&(h=h.substr(2),this.slashes=!0)}if(!Au[f]&&(g||f&&!Mn[f])){for(var m=-1,v=0;v<$p.length;v++){var _=h.indexOf($p[v]);_!==-1&&(m===-1||_<m)&&(m=_)}var w,x;m===-1?x=h.lastIndexOf("@"):x=h.lastIndexOf("@",m),x!==-1&&(w=h.slice(0,x),h=h.slice(x+1),this.auth=decodeURIComponent(w)),m=-1;for(var v=0;v<Wp.length;v++){var _=h.indexOf(Wp[v]);_!==-1&&(m===-1||_<m)&&(m=_)}m===-1&&(m=h.length),this.host=h.slice(0,m),h=h.slice(m),this.parseHost(),this.hostname=this.hostname||"";var A=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!A)for(var S=this.hostname.split(/\./),v=0,E=S.length;v<E;v++){var I=S[v];if(I&&!I.match(Hp)){for(var D="",L=0,O=I.length;L<O;L++)I.charCodeAt(L)>127?D+="x":D+=I[L];if(!D.match(Hp)){var F=S.slice(0,v),X=S.slice(v+1),j=I.match(YS);j&&(F.push(j[1]),X.unshift(j[2])),X.length&&(h="/"+X.join(".")+h),this.hostname=F.join(".");break}}}this.hostname.length>VS?this.hostname="":this.hostname=this.hostname.toLowerCase(),A||(this.hostname=GS.toASCII(this.hostname));var z=this.port?":"+this.port:"",K=this.hostname||"";this.host=K+z,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),h[0]!=="/"&&(h="/"+h))}if(!jS[d])for(var v=0,E=Tu.length;v<E;v++){var W=Tu[v];if(h.indexOf(W)!==-1){var k=encodeURIComponent(W);k===W&&(k=escape(W)),h=h.split(W).join(k)}}var at=h.indexOf("#");at!==-1&&(this.hash=h.substr(at),h=h.slice(0,at));var dt=h.indexOf("?");if(dt!==-1?(this.search=h.substr(dt),this.query=h.substr(dt+1),t&&(this.query=Su.parse(this.query)),h=h.slice(0,dt)):t&&(this.search="",this.query={}),h&&(this.pathname=h),Mn[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var z=this.pathname||"",Y=this.search||"";this.path=z+Y}return this.href=this.format(),this};function qS(e){return typeof e=="string"&&(e=Ha(e)),e instanceof pr?e.format():pr.prototype.format.call(e)}pr.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,o="";this.host?n=e+this.host:this.hostname&&(n=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(o=Su.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var l=this.search||o&&"?"+o||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Mn[t])&&n!==!1?(n="//"+(n||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):n||(n=""),i&&i.charAt(0)!=="#"&&(i="#"+i),l&&l.charAt(0)!=="?"&&(l="?"+l),r=r.replace(/[?#]/g,function(h){return encodeURIComponent(h)}),l=l.replace("#","%23"),t+n+r+l+i};function KS(e,t){return Ha(e,!1,!0).resolve(t)}pr.prototype.resolve=function(e){return this.resolveObject(Ha(e,!1,!0)).format()};pr.prototype.resolveObject=function(e){if(typeof e=="string"){var t=new pr;t.parse(e,!1,!0),e=t}for(var r=new pr,i=Object.keys(this),n=0;n<i.length;n++){var o=i[n];r[o]=this[o]}if(r.hash=e.hash,e.href==="")return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),h=0;h<l.length;h++){var u=l[h];u!=="protocol"&&(r[u]=e[u])}return Mn[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!Mn[e.protocol]){for(var f=Object.keys(e),d=0;d<f.length;d++){var g=f[d];r[g]=e[g]}return r.href=r.format(),r}if(r.protocol=e.protocol,!e.host&&!Au[e.protocol]){for(var E=(e.pathname||"").split("/");E.length&&!(e.host=E.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),E[0]!==""&&E.unshift(""),E.length<2&&E.unshift(""),r.pathname=E.join("/")}else r.pathname=e.pathname;if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var m=r.pathname||"",v=r.search||"";r.path=m+v}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var _=r.pathname&&r.pathname.charAt(0)==="/",w=e.host||e.pathname&&e.pathname.charAt(0)==="/",x=w||_||r.host&&e.pathname,A=x,S=r.pathname&&r.pathname.split("/")||[],E=e.pathname&&e.pathname.split("/")||[],I=r.protocol&&!Mn[r.protocol];if(I&&(r.hostname="",r.port=null,r.host&&(S[0]===""?S[0]=r.host:S.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(E[0]===""?E[0]=e.host:E.unshift(e.host)),e.host=null),x=x&&(E[0]===""||S[0]==="")),w)r.host=e.host||e.host===""?e.host:r.host,r.hostname=e.hostname||e.hostname===""?e.hostname:r.hostname,r.search=e.search,r.query=e.query,S=E;else if(E.length)S||(S=[]),S.pop(),S=S.concat(E),r.search=e.search,r.query=e.query;else if(e.search!=null){if(I){r.host=S.shift(),r.hostname=r.host;var D=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;D&&(r.auth=D.shift(),r.hostname=D.shift(),r.host=r.hostname)}return r.search=e.search,r.query=e.query,(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!S.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var L=S.slice(-1)[0],O=(r.host||e.host||S.length>1)&&(L==="."||L==="..")||L==="",F=0,X=S.length;X>=0;X--)L=S[X],L==="."?S.splice(X,1):L===".."?(S.splice(X,1),F++):F&&(S.splice(X,1),F--);if(!x&&!A)for(;F--;F)S.unshift("..");x&&S[0]!==""&&(!S[0]||S[0].charAt(0)!=="/")&&S.unshift(""),O&&S.join("/").substr(-1)!=="/"&&S.push("");var j=S[0]===""||S[0]&&S[0].charAt(0)==="/";if(I){r.hostname=j?"":S.length?S.shift():"",r.host=r.hostname;var D=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;D&&(r.auth=D.shift(),r.hostname=D.shift(),r.host=r.hostname)}return x=x||r.host&&S.length,x&&!j&&S.unshift(""),S.length>0?r.pathname=S.join("/"):(r.pathname=null,r.path=null),(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r};pr.prototype.parseHost=function(){var e=this.host,t=$S.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};var ZS=Ha,JS=KS,QS=qS;const tC={parse:ZS,format:QS,resolve:JS};function sr(e){if(typeof e!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function ps(e){return e.split("?")[0].split("#")[0]}function eC(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function rC(e,t,r){return e.replace(new RegExp(eC(t),"g"),r)}function iC(e,t){let r="",i=0,n=-1,o=0,l=-1;for(let h=0;h<=e.length;++h){if(h<e.length)l=e.charCodeAt(h);else{if(l===47)break;l=47}if(l===47){if(!(n===h-1||o===1))if(n!==h-1&&o===2){if(r.length<2||i!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const u=r.lastIndexOf("/");if(u!==r.length-1){u===-1?(r="",i=0):(r=r.slice(0,u),i=r.length-1-r.lastIndexOf("/")),n=h,o=0;continue}}else if(r.length===2||r.length===1){r="",i=0,n=h,o=0;continue}}}else r.length>0?r+=`/${e.slice(n+1,h)}`:r=e.slice(n+1,h),i=h-n-1;n=h,o=0}else l===46&&o!==-1?++o:o=-1}return r}const ve={toPosix(e){return rC(e,"\\","/")},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},hasProtocol(e){return/^[^/:]+:\//.test(this.toPosix(e))},getProtocol(e){sr(e),e=this.toPosix(e);let t="";const r=/^file:\/\/\//.exec(e),i=/^[^/:]+:\/\//.exec(e),n=/^[^/:]+:\//.exec(e);if(r||i||n){const o=(r==null?void 0:r[0])||(i==null?void 0:i[0])||(n==null?void 0:n[0]);t=o,e=e.slice(o.length)}return t},toAbsolute(e,t,r){if(this.isDataUrl(e))return e;const i=ps(this.toPosix(t??J.ADAPTER.getBaseUrl())),n=ps(this.toPosix(r??this.rootname(i)));return sr(e),e=this.toPosix(e),e.startsWith("/")?ve.join(n,e.slice(1)):this.isAbsolute(e)?e:this.join(i,e)},normalize(e){if(e=this.toPosix(e),sr(e),e.length===0)return".";let t="";const r=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));const i=e.endsWith("/");return e=iC(e),e.length>0&&i&&(e+="/"),r?`/${e}`:t+e},isAbsolute(e){return sr(e),e=this.toPosix(e),this.hasProtocol(e)?!0:e.startsWith("/")},join(...e){if(e.length===0)return".";let t;for(let r=0;r<e.length;++r){const i=e[r];if(sr(i),i.length>0)if(t===void 0)t=i;else{const n=e[r-1]??"";this.extname(n)?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(e){if(sr(e),e.length===0)return".";e=this.toPosix(e);let t=e.charCodeAt(0);const r=t===47;let i=-1,n=!0;const o=this.getProtocol(e),l=e;e=e.slice(o.length);for(let h=e.length-1;h>=1;--h)if(t=e.charCodeAt(h),t===47){if(!n){i=h;break}}else n=!1;return i===-1?r?"/":this.isUrl(l)?o+e:o:r&&i===1?"//":o+e.slice(0,i)},rootname(e){sr(e),e=this.toPosix(e);let t="";if(e.startsWith("/")?t="/":t=this.getProtocol(e),this.isUrl(e)){const r=e.indexOf("/",t.length);r!==-1?t=e.slice(0,r):t=e,t.endsWith("/")||(t+="/")}return t},basename(e,t){sr(e),t&&sr(t),e=ps(this.toPosix(e));let r=0,i=-1,n=!0,o;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let l=t.length-1,h=-1;for(o=e.length-1;o>=0;--o){const u=e.charCodeAt(o);if(u===47){if(!n){r=o+1;break}}else h===-1&&(n=!1,h=o+1),l>=0&&(u===t.charCodeAt(l)?--l===-1&&(i=o):(l=-1,i=h))}return r===i?i=h:i===-1&&(i=e.length),e.slice(r,i)}for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!n){r=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":e.slice(r,i)},extname(e){sr(e),e=ps(this.toPosix(e));let t=-1,r=0,i=-1,n=!0,o=0;for(let l=e.length-1;l>=0;--l){const h=e.charCodeAt(l);if(h===47){if(!n){r=l+1;break}continue}i===-1&&(n=!1,i=l+1),h===46?t===-1?t=l:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||i===-1||o===0||o===1&&t===i-1&&t===r+1?"":e.slice(t,i)},parse(e){sr(e);const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;e=ps(this.toPosix(e));let r=e.charCodeAt(0);const i=this.isAbsolute(e);let n;t.root=this.rootname(e),i||this.hasProtocol(e)?n=1:n=0;let o=-1,l=0,h=-1,u=!0,f=e.length-1,d=0;for(;f>=n;--f){if(r=e.charCodeAt(f),r===47){if(!u){l=f+1;break}continue}h===-1&&(u=!1,h=f+1),r===46?o===-1?o=f:d!==1&&(d=1):o!==-1&&(d=-1)}return o===-1||h===-1||d===0||d===1&&o===h-1&&o===l+1?h!==-1&&(l===0&&i?t.base=t.name=e.slice(1,h):t.base=t.name=e.slice(l,h)):(l===0&&i?(t.name=e.slice(1,o),t.base=e.slice(1,h)):(t.name=e.slice(l,o),t.base=e.slice(l,h)),t.ext=e.slice(o,h)),t.dir=this.dirname(e),t},sep:"/",delimiter:":"},Xp={};function Ct(e,t,r=3){if(Xp[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`):(i=i.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${e}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`),console.warn(i))),Xp[t]=!0}let Bh;function nC(){return typeof Bh>"u"&&(Bh=function(){var r;const t={stencil:!0,failIfMajorPerformanceCaveat:J.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!J.ADAPTER.getWebGLRenderingContext())return!1;const i=J.ADAPTER.createCanvas();let n=i.getContext("webgl",t)||i.getContext("experimental-webgl",t);const o=!!((r=n==null?void 0:n.getContextAttributes())!=null&&r.stencil);if(n){const l=n.getExtension("WEBGL_lose_context");l&&l.loseContext()}return n=null,o}catch{return!1}}()),Bh}var sC="#f0f8ff",oC="#faebd7",aC="#00ffff",lC="#7fffd4",hC="#f0ffff",uC="#f5f5dc",cC="#ffe4c4",fC="#000000",dC="#ffebcd",pC="#0000ff",gC="#8a2be2",mC="#a52a2a",vC="#deb887",yC="#5f9ea0",_C="#7fff00",xC="#d2691e",bC="#ff7f50",wC="#6495ed",EC="#fff8dc",TC="#dc143c",AC="#00ffff",SC="#00008b",CC="#008b8b",IC="#b8860b",PC="#a9a9a9",RC="#006400",MC="#a9a9a9",DC="#bdb76b",BC="#8b008b",OC="#556b2f",FC="#ff8c00",LC="#9932cc",NC="#8b0000",kC="#e9967a",UC="#8fbc8f",GC="#483d8b",WC="#2f4f4f",$C="#2f4f4f",HC="#00ced1",XC="#9400d3",zC="#ff1493",VC="#00bfff",YC="#696969",jC="#696969",qC="#1e90ff",KC="#b22222",ZC="#fffaf0",JC="#228b22",QC="#ff00ff",tI="#dcdcdc",eI="#f8f8ff",rI="#daa520",iI="#ffd700",nI="#808080",sI="#008000",oI="#adff2f",aI="#808080",lI="#f0fff0",hI="#ff69b4",uI="#cd5c5c",cI="#4b0082",fI="#fffff0",dI="#f0e68c",pI="#fff0f5",gI="#e6e6fa",mI="#7cfc00",vI="#fffacd",yI="#add8e6",_I="#f08080",xI="#e0ffff",bI="#fafad2",wI="#d3d3d3",EI="#90ee90",TI="#d3d3d3",AI="#ffb6c1",SI="#ffa07a",CI="#20b2aa",II="#87cefa",PI="#778899",RI="#778899",MI="#b0c4de",DI="#ffffe0",BI="#00ff00",OI="#32cd32",FI="#faf0e6",LI="#ff00ff",NI="#800000",kI="#66cdaa",UI="#0000cd",GI="#ba55d3",WI="#9370db",$I="#3cb371",HI="#7b68ee",XI="#00fa9a",zI="#48d1cc",VI="#c71585",YI="#191970",jI="#f5fffa",qI="#ffe4e1",KI="#ffe4b5",ZI="#ffdead",JI="#000080",QI="#fdf5e6",tP="#808000",eP="#6b8e23",rP="#ffa500",iP="#ff4500",nP="#da70d6",sP="#eee8aa",oP="#98fb98",aP="#afeeee",lP="#db7093",hP="#ffefd5",uP="#ffdab9",cP="#cd853f",fP="#ffc0cb",dP="#dda0dd",pP="#b0e0e6",gP="#800080",mP="#663399",vP="#ff0000",yP="#bc8f8f",_P="#4169e1",xP="#8b4513",bP="#fa8072",wP="#f4a460",EP="#2e8b57",TP="#fff5ee",AP="#a0522d",SP="#c0c0c0",CP="#87ceeb",IP="#6a5acd",PP="#708090",RP="#708090",MP="#fffafa",DP="#00ff7f",BP="#4682b4",OP="#d2b48c",FP="#008080",LP="#d8bfd8",NP="#ff6347",kP="#40e0d0",UP="#ee82ee",GP="#f5deb3",WP="#ffffff",$P="#f5f5f5",HP="#ffff00",XP="#9acd32",zP={aliceblue:sC,antiquewhite:oC,aqua:aC,aquamarine:lC,azure:hC,beige:uC,bisque:cC,black:fC,blanchedalmond:dC,blue:pC,blueviolet:gC,brown:mC,burlywood:vC,cadetblue:yC,chartreuse:_C,chocolate:xC,coral:bC,cornflowerblue:wC,cornsilk:EC,crimson:TC,cyan:AC,darkblue:SC,darkcyan:CC,darkgoldenrod:IC,darkgray:PC,darkgreen:RC,darkgrey:MC,darkkhaki:DC,darkmagenta:BC,darkolivegreen:OC,darkorange:FC,darkorchid:LC,darkred:NC,darksalmon:kC,darkseagreen:UC,darkslateblue:GC,darkslategray:WC,darkslategrey:$C,darkturquoise:HC,darkviolet:XC,deeppink:zC,deepskyblue:VC,dimgray:YC,dimgrey:jC,dodgerblue:qC,firebrick:KC,floralwhite:ZC,forestgreen:JC,fuchsia:QC,gainsboro:tI,ghostwhite:eI,goldenrod:rI,gold:iI,gray:nI,green:sI,greenyellow:oI,grey:aI,honeydew:lI,hotpink:hI,indianred:uI,indigo:cI,ivory:fI,khaki:dI,lavenderblush:pI,lavender:gI,lawngreen:mI,lemonchiffon:vI,lightblue:yI,lightcoral:_I,lightcyan:xI,lightgoldenrodyellow:bI,lightgray:wI,lightgreen:EI,lightgrey:TI,lightpink:AI,lightsalmon:SI,lightseagreen:CI,lightskyblue:II,lightslategray:PI,lightslategrey:RI,lightsteelblue:MI,lightyellow:DI,lime:BI,limegreen:OI,linen:FI,magenta:LI,maroon:NI,mediumaquamarine:kI,mediumblue:UI,mediumorchid:GI,mediumpurple:WI,mediumseagreen:$I,mediumslateblue:HI,mediumspringgreen:XI,mediumturquoise:zI,mediumvioletred:VI,midnightblue:YI,mintcream:jI,mistyrose:qI,moccasin:KI,navajowhite:ZI,navy:JI,oldlace:QI,olive:tP,olivedrab:eP,orange:rP,orangered:iP,orchid:nP,palegoldenrod:sP,palegreen:oP,paleturquoise:aP,palevioletred:lP,papayawhip:hP,peachpuff:uP,peru:cP,pink:fP,plum:dP,powderblue:pP,purple:gP,rebeccapurple:mP,red:vP,rosybrown:yP,royalblue:_P,saddlebrown:xP,salmon:bP,sandybrown:wP,seagreen:EP,seashell:TP,sienna:AP,silver:SP,skyblue:CP,slateblue:IP,slategray:PP,slategrey:RP,snow:MP,springgreen:DP,steelblue:BP,tan:OP,teal:FP,thistle:LP,tomato:NP,turquoise:kP,violet:UP,wheat:GP,white:WP,whitesmoke:$P,yellow:HP,yellowgreen:XP};function Ms(e,t=[]){return t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(e&255)/255,t}function bm(e){let t=e.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}function uc(e){if(typeof e=="string"&&(e=zP[e.toLowerCase()]||e,e[0]==="#"&&(e=e.slice(1)),e.length===3)){const[t,r,i]=e;e=t+t+r+r+i+i}return parseInt(e,16)}function VP(){const e=[],t=[];for(let i=0;i<32;i++)e[i]=i,t[i]=i;e[ut.NORMAL_NPM]=ut.NORMAL,e[ut.ADD_NPM]=ut.ADD,e[ut.SCREEN_NPM]=ut.SCREEN,t[ut.NORMAL]=ut.NORMAL_NPM,t[ut.ADD]=ut.ADD_NPM,t[ut.SCREEN]=ut.SCREEN_NPM;const r=[];return r.push(t),r.push(e),r}const wm=VP();function Em(e,t){return wm[t?1:0][e]}function YP(e,t,r,i){return r=r||new Float32Array(4),i||i===void 0?(r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t):(r[0]=e[0],r[1]=e[1],r[2]=e[2]),r[3]=t,r}function cc(e,t){if(t===1)return(t*255<<24)+e;if(t===0)return 0;let r=e>>16&255,i=e>>8&255,n=e&255;return r=r*t+.5|0,i=i*t+.5|0,n=n*t+.5|0,(t*255<<24)+(r<<16)+(i<<8)+n}function Tm(e,t,r,i){return r=r||new Float32Array(4),r[0]=(e>>16&255)/255,r[1]=(e>>8&255)/255,r[2]=(e&255)/255,(i||i===void 0)&&(r[0]*=t,r[1]*=t,r[2]*=t),r[3]=t,r}function jP(e,t=null){const r=e*6;if(t=t||new Uint16Array(r),t.length!==r)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${r}`);for(let i=0,n=0;i<r;i+=6,n+=4)t[i+0]=n+0,t[i+1]=n+1,t[i+2]=n+2,t[i+3]=n+0,t[i+4]=n+2,t[i+5]=n+3;return t}function Am(e){if(e.BYTES_PER_ELEMENT===4)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(e.BYTES_PER_ELEMENT===2){if(e instanceof Uint16Array)return"Uint16Array"}else if(e.BYTES_PER_ELEMENT===1&&e instanceof Uint8Array)return"Uint8Array";return null}function Aa(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function zp(e){return!(e&e-1)&&!!e}function Vp(e){let t=(e>65535?1:0)<<4;e>>>=t;let r=(e>255?1:0)<<3;return e>>>=r,t|=r,r=(e>15?1:0)<<2,e>>>=r,t|=r,r=(e>3?1:0)<<1,e>>>=r,t|=r,t|e>>1}function Dn(e,t,r){const i=e.length;let n;if(t>=i||r===0)return;r=t+r>i?i-t:r;const o=i-r;for(n=t;n<o;++n)e[n]=e[n+r];e.length=o}function An(e){return e===0?0:e<0?-1:1}let qP=0;function zi(){return++qP}const Sm=class{constructor(e,t,r,i){this.left=e,this.top=t,this.right=r,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let Cu=Sm;Cu.EMPTY=new Sm(0,0,0,0);const Yp={},Tr=Object.create(null),si=Object.create(null);class jp{constructor(t,r,i){this._canvas=J.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||J.RESOLUTION,this.resize(t,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,r){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function qp(e,t,r){for(let i=0,n=4*r*t;i<t;++i,n+=4)if(e[n+3]!==0)return!1;return!0}function Kp(e,t,r,i,n){const o=4*t;for(let l=i,h=i*o+4*r;l<=n;++l,h+=o)if(e[h+3]!==0)return!1;return!0}function KP(e){const{width:t,height:r}=e,i=e.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const o=i.getImageData(0,0,t,r).data;let l=0,h=0,u=t-1,f=r-1;for(;h<r&&qp(o,t,h);)++h;if(h===r)return Cu.EMPTY;for(;qp(o,t,f);)--f;for(;Kp(o,t,l,h,f);)++l;for(;Kp(o,t,u,h,f);)--u;return++u,++f,new Cu(l,h,u,f)}function ZP(e){const t=KP(e),{width:r,height:i}=t;let n=null;if(!t.isEmpty()){const o=e.getContext("2d");if(o===null)throw new TypeError("Failed to get canvas 2D context");n=o.getImageData(t.left,t.top,r,i)}return{width:r,height:i,data:n}}let Uo;function JP(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location,Uo||(Uo=document.createElement("a")),Uo.href=e;const r=tC.parse(Uo.href),i=!r.port&&t.port===""||r.port===t.port;return r.hostname!==t.hostname||!i||r.protocol!==t.protocol?"anonymous":""}function fi(e,t=1){var i;const r=(i=J.RETINA_PREFIX)==null?void 0:i.exec(e);return r?parseFloat(r[1]):t}var Z=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))(Z||{});const Iu=e=>{if(typeof e=="function"||typeof e=="object"&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={...typeof e.extension!="object"?{type:e.extension}:e.extension,ref:e}}if(typeof e=="object")e={...e};else throw new Error("Invalid extension type");return typeof e.type=="string"&&(e.type=[e.type]),e},Zp=(e,t)=>Iu(e).priority??t,nt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(Iu).forEach(t=>{t.type.forEach(r=>{var i,n;return(n=(i=this._removeHandlers)[r])==null?void 0:n.call(i,t)})}),this},add(...e){return e.map(Iu).forEach(t=>{t.type.forEach(r=>{const i=this._addHandlers,n=this._queue;i[r]?i[r](t):(n[r]=n[r]||[],n[r].push(t))})}),this},handle(e,t,r){const i=this._addHandlers,n=this._removeHandlers;if(i[e]||n[e])throw new Error(`Extension type ${e} already has a handler`);i[e]=t,n[e]=r;const o=this._queue;return o[e]&&(o[e].forEach(l=>t(l)),delete o[e]),this},handleByMap(e,t){return this.handle(e,r=>{t[r.name]=r.ref},r=>{delete t[r.name]})},handleByList(e,t,r=-1){return this.handle(e,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((n,o)=>Zp(o,r)-Zp(n,r)))},i=>{const n=t.indexOf(i.ref);n!==-1&&t.splice(n,1)})}};class Pu{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const QP=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function tR(e){let t="";for(let r=0;r<e;++r)r>0&&(t+=`
else `),r<e-1&&(t+=`if(test == ${r}.0){}`);return t}function eR(e,t){if(e===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=t.createShader(t.FRAGMENT_SHADER);for(;;){const i=QP.replace(/%forloop%/gi,tR(e));if(t.shaderSource(r,i),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))e=e/2|0;else break}return e}const Oh=0,Fh=1,Lh=2,Nh=3,kh=4,Uh=5;class qr{constructor(){this.data=0,this.blendMode=ut.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Oh)}set blend(t){!!(this.data&1<<Oh)!==t&&(this.data^=1<<Oh)}get offsets(){return!!(this.data&1<<Fh)}set offsets(t){!!(this.data&1<<Fh)!==t&&(this.data^=1<<Fh)}get culling(){return!!(this.data&1<<Lh)}set culling(t){!!(this.data&1<<Lh)!==t&&(this.data^=1<<Lh)}get depthTest(){return!!(this.data&1<<Nh)}set depthTest(t){!!(this.data&1<<Nh)!==t&&(this.data^=1<<Nh)}get depthMask(){return!!(this.data&1<<Uh)}set depthMask(t){!!(this.data&1<<Uh)!==t&&(this.data^=1<<Uh)}get clockwiseFrontFace(){return!!(this.data&1<<kh)}set clockwiseFrontFace(t){!!(this.data&1<<kh)!==t&&(this.data^=1<<kh)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==ut.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new qr;return t.depthTest=!1,t.blend=!0,t}}const Ru=[];function Cm(e,t){if(!e)return null;let r="";if(typeof e=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);i&&(r=i[1].toLowerCase())}for(let i=Ru.length-1;i>=0;--i){const n=Ru[i];if(n.test&&n.test(e,r))return new n(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class gr{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,r,i,n,o,l,h,u){if(arguments.length>8)throw new Error("max arguments reached");const{name:f,items:d}=this;this._aliasCount++;for(let g=0,m=d.length;g<m;g++)d[g][f](t,r,i,n,o,l,h,u);return d===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const r=this.items.indexOf(t);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(gr.prototype,{dispatch:{value:gr.prototype.emit},run:{value:gr.prototype.emit}});class Ds{constructor(t=0,r=0){this._width=t,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new gr("setRealSize"),this.onUpdate=new gr("update"),this.onError=new gr("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,r){(t!==this._width||r!==this._height)&&(this._width=t,this._height=r,this.onResize.emit(t,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,r,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,r){return!1}}class Us extends Ds{constructor(t,r){const{width:i,height:n}=r||{};if(!i||!n)throw new Error("BufferResource width or height invalid");super(i,n),this.data=t}upload(t,r,i){const n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===vr.UNPACK);const o=r.realWidth,l=r.realHeight;return i.width===o&&i.height===l?n.texSubImage2D(r.target,0,0,0,o,l,r.format,i.type,this.data):(i.width=o,i.height=l,n.texImage2D(r.target,0,i.internalFormat,o,l,0,r.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const rR={scaleMode:zr.NEAREST,format:V.RGBA,alphaMode:vr.NPM},bn=class extends Ls{constructor(e=null,t=null){super(),t=Object.assign({},bn.defaultOptions,t);const{alphaMode:r,mipmap:i,anisotropicLevel:n,scaleMode:o,width:l,height:h,wrapMode:u,format:f,type:d,target:g,resolution:m,resourceOptions:v}=t;e&&!(e instanceof Ds)&&(e=Cm(e,v),e.internal=!0),this.resolution=m||J.RESOLUTION,this.width=Math.round((l||0)*this.resolution)/this.resolution,this.height=Math.round((h||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=n,this._wrapMode=u,this._scaleMode=o,this.format=f,this.type=d,this.target=g,this.alphaMode=r,this.uid=zi(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=l>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let r;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this}setSize(e,t,r){return r=r||this.resolution,this.setRealSize(e*r,t*r,r)}setRealSize(e,t,r){return this.resolution=r||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=zp(this.realWidth)&&zp(this.realHeight)}setResolution(e){const t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete si[this.cacheId],delete Tr[this.cacheId],this.cacheId=null),this.dispose(),bn.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,r=J.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let n=null;if(i)n=e;else{if(!e._pixiId){const l=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${l}_${zi()}`}n=e._pixiId}let o=si[n];if(i&&r&&!o)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return o||(o=new bn(e,t),o.cacheId=n,bn.addToCache(o,n)),o}static fromBuffer(e,t,r,i){e=e||new Float32Array(t*r*4);const n=new Us(e,{width:t,height:r}),o=e instanceof Float32Array?st.FLOAT:st.UNSIGNED_BYTE;return new bn(n,Object.assign({},rR,i||{width:t,height:r,type:o}))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),si[t]&&si[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),si[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=si[e];if(t){const r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete si[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete si[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};let gt=bn;gt.defaultOptions={mipmap:Dr.POW2,anisotropicLevel:0,scaleMode:zr.LINEAR,wrapMode:ci.CLAMP,alphaMode:vr.UNPACK,target:Pn.TEXTURE_2D,format:V.RGBA,type:st.UNSIGNED_BYTE};gt._globalBatch=0;class Mu{constructor(){this.texArray=null,this.blend=0,this.type=Pr.TRIANGLES,this.start=0,this.size=0,this.data=null}}let iR=0;class re{constructor(t,r=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=r,this.id=iR++,this.disposeRunner=new gr("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Rr.ELEMENT_ARRAY_BUFFER:Rr.ARRAY_BUFFER}get index(){return this.type===Rr.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new re(t)}}class Sa{constructor(t,r=0,i=!1,n=st.FLOAT,o,l,h,u=1){this.buffer=t,this.size=r,this.normalized=i,this.type=n,this.stride=o,this.start=l,this.instance=h,this.divisor=u}destroy(){this.buffer=null}static from(t,r,i,n,o){return new Sa(t,r,i,n,o)}}const nR={Float32Array,Uint32Array,Int32Array,Uint8Array};function sR(e,t){let r=0,i=0;const n={};for(let u=0;u<e.length;u++)i+=t[u],r+=e[u].length;const o=new ArrayBuffer(r*4);let l=null,h=0;for(let u=0;u<e.length;u++){const f=t[u],d=e[u],g=Am(d);n[g]||(n[g]=new nR[g](o)),l=n[g];for(let m=0;m<d.length;m++){const v=(m/f|0)*i+h,_=m%f;l[v+_]=d[m]}h+=f}return new Float32Array(o)}const Jp={5126:4,5123:2,5121:1};let oR=0;const aR={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class di{constructor(t=[],r={}){this.buffers=t,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=oR++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new gr("disposeGeometry"),this.refCount=0}addAttribute(t,r,i=0,n=!1,o,l,h,u=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof re||(r instanceof Array&&(r=new Float32Array(r)),r=new re(r));const f=t.split("|");if(f.length>1){for(let g=0;g<f.length;g++)this.addAttribute(f[g],r,i,n,o);return this}let d=this.buffers.indexOf(r);return d===-1&&(this.buffers.push(r),d=this.buffers.length-1),this.attributes[t]=new Sa(d,i,n,o,l,h,u),this.instanced=this.instanced||u,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof re||(t instanceof Array&&(t=new Uint16Array(t)),t=new re(t)),t.type=Rr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],r=[],i=new re;let n;for(n in this.attributes){const o=this.attributes[n],l=this.buffers[o.buffer];t.push(l.data),r.push(o.size*Jp[o.type]/4),o.buffer=0}for(i.data=sR(t,r),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const r=this.attributes[t];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new di;for(let r=0;r<this.buffers.length;r++)t.buffers[r]=new re(this.buffers[r].data.slice(0));for(const r in this.attributes){const i=this.attributes[r];t.attributes[r]=new Sa(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Rr.ELEMENT_ARRAY_BUFFER),t}static merge(t){const r=new di,i=[],n=[],o=[];let l;for(let h=0;h<t.length;h++){l=t[h];for(let u=0;u<l.buffers.length;u++)n[u]=n[u]||0,n[u]+=l.buffers[u].data.length,o[u]=0}for(let h=0;h<l.buffers.length;h++)i[h]=new aR[Am(l.buffers[h].data)](n[h]),r.buffers[h]=new re(i[h]);for(let h=0;h<t.length;h++){l=t[h];for(let u=0;u<l.buffers.length;u++)i[u].set(l.buffers[u].data,o[u]),o[u]+=l.buffers[u].data.length}if(r.attributes=l.attributes,l.indexBuffer){r.indexBuffer=r.buffers[l.buffers.indexOf(l.indexBuffer)],r.indexBuffer.type=Rr.ELEMENT_ARRAY_BUFFER;let h=0,u=0,f=0,d=0;for(let g=0;g<l.buffers.length;g++)if(l.buffers[g]!==l.indexBuffer){d=g;break}for(const g in l.attributes){const m=l.attributes[g];(m.buffer|0)===d&&(u+=m.size*Jp[m.type]/4)}for(let g=0;g<t.length;g++){const m=t[g].indexBuffer.data;for(let v=0;v<m.length;v++)r.indexBuffer.data[v+f]+=h;h+=t[g].buffers[d].data.length/u,f+=m.length}}return r}}class Im extends di{constructor(t=!1){super(),this._buffer=new re(null,t,!1),this._indexBuffer=new re(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,st.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,st.FLOAT).addAttribute("aColor",this._buffer,4,!0,st.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,st.FLOAT).addIndex(this._indexBuffer)}}const Ca=Math.PI*2,lR=180/Math.PI,hR=Math.PI/180;var me=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))(me||{});class St{constructor(t=0,r=0){this.x=0,this.y=0,this.x=t,this.y=r}clone(){return new St(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,r=t){return this.x=t,this.y=r,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const Go=[new St,new St,new St,new St];class Tt{constructor(t=0,r=0,i=0,n=0){this.x=Number(t),this.y=Number(r),this.width=Number(i),this.height=Number(n),this.type=me.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Tt(0,0,0,0)}clone(){return new Tt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,r){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(t,r){if(!r){const F=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=F)return!1;const j=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>j}const i=this.left,n=this.right,o=this.top,l=this.bottom;if(n<=i||l<=o)return!1;const h=Go[0].set(t.left,t.top),u=Go[1].set(t.left,t.bottom),f=Go[2].set(t.right,t.top),d=Go[3].set(t.right,t.bottom);if(f.x<=h.x||u.y<=h.y)return!1;const g=Math.sign(r.a*r.d-r.b*r.c);if(g===0||(r.apply(h,h),r.apply(u,u),r.apply(f,f),r.apply(d,d),Math.max(h.x,u.x,f.x,d.x)<=i||Math.min(h.x,u.x,f.x,d.x)>=n||Math.max(h.y,u.y,f.y,d.y)<=o||Math.min(h.y,u.y,f.y,d.y)>=l))return!1;const m=g*(u.y-h.y),v=g*(h.x-u.x),_=m*i+v*o,w=m*n+v*o,x=m*i+v*l,A=m*n+v*l;if(Math.max(_,w,x,A)<=m*h.x+v*h.y||Math.min(_,w,x,A)>=m*d.x+v*d.y)return!1;const S=g*(h.y-f.y),E=g*(f.x-h.x),I=S*i+E*o,D=S*n+E*o,L=S*i+E*l,O=S*n+E*l;return!(Math.max(I,D,L,O)<=S*h.x+E*h.y||Math.min(I,D,L,O)>=S*d.x+E*d.y)}pad(t=0,r=t){return this.x-=t,this.y-=r,this.width+=t*2,this.height+=r*2,this}fit(t){const r=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),o=Math.min(this.y+this.height,t.y+t.height);return this.x=r,this.width=Math.max(i-r,0),this.y=n,this.height=Math.max(o-n,0),this}ceil(t=1,r=.001){const i=Math.ceil((this.x+this.width-r)*t)/t,n=Math.ceil((this.y+this.height-r)*t)/t;return this.x=Math.floor((this.x+r)*t)/t,this.y=Math.floor((this.y+r)*t)/t,this.width=i-this.x,this.height=n-this.y,this}enlarge(t){const r=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),o=Math.max(this.y+this.height,t.y+t.height);return this.x=r,this.width=i-r,this.y=n,this.height=o-n,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class fc{constructor(t=0,r=0,i=0){this.x=t,this.y=r,this.radius=i,this.type=me.CIRC}clone(){return new fc(this.x,this.y,this.radius)}contains(t,r){if(this.radius<=0)return!1;const i=this.radius*this.radius;let n=this.x-t,o=this.y-r;return n*=n,o*=o,n+o<=i}getBounds(){return new Tt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class dc{constructor(t=0,r=0,i=0,n=0){this.x=t,this.y=r,this.width=i,this.height=n,this.type=me.ELIP}clone(){return new dc(this.x,this.y,this.width,this.height)}contains(t,r){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,n=(r-this.y)/this.height;return i*=i,n*=n,i+n<=1}getBounds(){return new Tt(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Bn{constructor(...t){let r=Array.isArray(t[0])?t[0]:t;if(typeof r[0]!="number"){const i=[];for(let n=0,o=r.length;n<o;n++)i.push(r[n].x,r[n].y);r=i}this.points=r,this.type=me.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),r=new Bn(t);return r.closeStroke=this.closeStroke,r}contains(t,r){let i=!1;const n=this.points.length/2;for(let o=0,l=n-1;o<n;l=o++){const h=this.points[o*2],u=this.points[o*2+1],f=this.points[l*2],d=this.points[l*2+1];u>r!=d>r&&t<(f-h)*((r-u)/(d-u))+h&&(i=!i)}return i}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,r)=>`${t}, ${r}`,"")}]`}}class pc{constructor(t=0,r=0,i=0,n=0,o=20){this.x=t,this.y=r,this.width=i,this.height=n,this.radius=o,this.type=me.RREC}clone(){return new pc(this.x,this.y,this.width,this.height,this.radius)}contains(t,r){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+i&&r<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let n=t-(this.x+i),o=r-(this.y+i);const l=i*i;if(n*n+o*o<=l||(n=t-(this.x+this.width-i),n*n+o*o<=l)||(o=r-(this.y+this.height-i),n*n+o*o<=l)||(n=t-(this.x+i),n*n+o*o<=l))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class $t{constructor(t=1,r=0,i=0,n=1,o=0,l=0){this.array=null,this.a=t,this.b=r,this.c=i,this.d=n,this.tx=o,this.ty=l}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,r,i,n,o,l){return this.a=t,this.b=r,this.c=i,this.d=n,this.tx=o,this.ty=l,this}toArray(t,r){this.array||(this.array=new Float32Array(9));const i=r||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,r){r=r||new St;const i=t.x,n=t.y;return r.x=this.a*i+this.c*n+this.tx,r.y=this.b*i+this.d*n+this.ty,r}applyInverse(t,r){r=r||new St;const i=1/(this.a*this.d+this.c*-this.b),n=t.x,o=t.y;return r.x=this.d*i*n+-this.c*i*o+(this.ty*this.c-this.tx*this.d)*i,r.y=this.a*i*o+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,r}translate(t,r){return this.tx+=t,this.ty+=r,this}scale(t,r){return this.a*=t,this.d*=r,this.c*=t,this.b*=r,this.tx*=t,this.ty*=r,this}rotate(t){const r=Math.cos(t),i=Math.sin(t),n=this.a,o=this.c,l=this.tx;return this.a=n*r-this.b*i,this.b=n*i+this.b*r,this.c=o*r-this.d*i,this.d=o*i+this.d*r,this.tx=l*r-this.ty*i,this.ty=l*i+this.ty*r,this}append(t){const r=this.a,i=this.b,n=this.c,o=this.d;return this.a=t.a*r+t.b*n,this.b=t.a*i+t.b*o,this.c=t.c*r+t.d*n,this.d=t.c*i+t.d*o,this.tx=t.tx*r+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*o+this.ty,this}setTransform(t,r,i,n,o,l,h,u,f){return this.a=Math.cos(h+f)*o,this.b=Math.sin(h+f)*o,this.c=-Math.sin(h-u)*l,this.d=Math.cos(h-u)*l,this.tx=t-(i*this.a+n*this.c),this.ty=r-(i*this.b+n*this.d),this}prepend(t){const r=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=r*t.a+this.ty*t.c+t.tx,this.ty=r*t.b+this.ty*t.d+t.ty,this}decompose(t){const r=this.a,i=this.b,n=this.c,o=this.d,l=t.pivot,h=-Math.atan2(-n,o),u=Math.atan2(i,r),f=Math.abs(h+u);return f<1e-5||Math.abs(Ca-f)<1e-5?(t.rotation=u,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=h,t.skew.y=u),t.scale.x=Math.sqrt(r*r+i*i),t.scale.y=Math.sqrt(n*n+o*o),t.position.x=this.tx+(l.x*r+l.y*n),t.position.y=this.ty+(l.x*i+l.y*o),t}invert(){const t=this.a,r=this.b,i=this.c,n=this.d,o=this.tx,l=t*n-r*i;return this.a=n/l,this.b=-r/l,this.c=-i/l,this.d=t/l,this.tx=(i*this.ty-n*o)/l,this.ty=-(t*this.ty-r*o)/l,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new $t;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new $t}static get TEMP_MATRIX(){return new $t}}const Ri=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Mi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Di=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Bi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Du=[],Pm=[],Wo=Math.sign;function uR(){for(let e=0;e<16;e++){const t=[];Du.push(t);for(let r=0;r<16;r++){const i=Wo(Ri[e]*Ri[r]+Di[e]*Mi[r]),n=Wo(Mi[e]*Ri[r]+Bi[e]*Mi[r]),o=Wo(Ri[e]*Di[r]+Di[e]*Bi[r]),l=Wo(Mi[e]*Di[r]+Bi[e]*Bi[r]);for(let h=0;h<16;h++)if(Ri[h]===i&&Mi[h]===n&&Di[h]===o&&Bi[h]===l){t.push(h);break}}}for(let e=0;e<16;e++){const t=new $t;t.set(Ri[e],Mi[e],Di[e],Bi[e],0,0),Pm.push(t)}}uR();const Xt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>Ri[e],uY:e=>Mi[e],vX:e=>Di[e],vY:e=>Bi[e],inv:e=>e&8?e&15:-e&7,add:(e,t)=>Du[e][t],sub:(e,t)=>Du[e][Xt.inv(t)],rotate180:e=>e^4,isVertical:e=>(e&3)===2,byDirection:(e,t)=>Math.abs(e)*2<=Math.abs(t)?t>=0?Xt.S:Xt.N:Math.abs(t)*2<=Math.abs(e)?e>0?Xt.E:Xt.W:t>0?e>0?Xt.SE:Xt.SW:e>0?Xt.NE:Xt.NW,matrixAppendRotationInv:(e,t,r=0,i=0)=>{const n=Pm[Xt.inv(t)];n.tx=r,n.ty=i,e.append(n)}};class ui{constructor(t,r,i=0,n=0){this._x=i,this._y=n,this.cb=t,this.scope=r}clone(t=this.cb,r=this.scope){return new ui(t,r,this._x,this._y)}set(t=0,r=t){return(this._x!==t||this._y!==r)&&(this._x=t,this._y=r,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const Rm=class{constructor(){this.worldTransform=new $t,this.localTransform=new $t,this.position=new ui(this.onChange,this,0,0),this.scale=new ui(this.onChange,this,1,1),this.pivot=new ui(this.onChange,this,0,0),this.skew=new ui(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){const r=e.worldTransform,i=this.worldTransform;i.a=t.a*r.a+t.b*r.c,i.b=t.a*r.b+t.b*r.d,i.c=t.c*r.a+t.d*r.c,i.d=t.c*r.b+t.d*r.d,i.tx=t.tx*r.a+t.ty*r.c+r.tx,i.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}};let gc=Rm;gc.IDENTITY=new Rm;var cR=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,fR=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Qp(e,t,r){const i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}function Gh(e){const t=new Array(e);for(let r=0;r<t.length;r++)t[r]=!1;return t}function Mm(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Gh(2*t);case"bvec3":return Gh(3*t);case"bvec4":return Gh(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const On=[{test:e=>e.type==="float"&&e.size===1&&!e.isArray,code:e=>`
            if(uv["${e}"] !== ud["${e}"].value)
            {
                ud["${e}"].value = uv["${e}"]
                gl.uniform1f(ud["${e}"].location, uv["${e}"])
            }
            `},{test:(e,t)=>(e.type==="sampler2D"||e.type==="samplerCube"||e.type==="sampler2DArray")&&e.size===1&&!e.isArray&&(t==null||t.castToBaseTexture!==void 0),code:e=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${e}"], t);

            if(ud["${e}"].value !== t)
            {
                ud["${e}"].value = t;
                gl.uniform1i(ud["${e}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(e,t)=>e.type==="mat3"&&e.size===1&&!e.isArray&&t.a!==void 0,code:e=>`
            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));
            `,codeUbo:e=>`
                var ${e}_matrix = uv.${e}.toArray(true);

                data[offset] = ${e}_matrix[0];
                data[offset+1] = ${e}_matrix[1];
                data[offset+2] = ${e}_matrix[2];
        
                data[offset + 4] = ${e}_matrix[3];
                data[offset + 5] = ${e}_matrix[4];
                data[offset + 6] = ${e}_matrix[5];
        
                data[offset + 8] = ${e}_matrix[6];
                data[offset + 9] = ${e}_matrix[7];
                data[offset + 10] = ${e}_matrix[8];
            `},{test:(e,t)=>e.type==="vec2"&&e.size===1&&!e.isArray&&t.x!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${e}"].location, v.x, v.y);
                }`,codeUbo:e=>`
                v = uv.${e};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:e=>e.type==="vec2"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);
                }
            `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.width!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:e=>e.type==="vec4"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])
                }`}],dR={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},pR={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function gR(e,t){var i;const r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const n in e.uniforms){const o=t[n];if(!o){(i=e.uniforms[n])!=null&&i.group&&(e.uniforms[n].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${n}, '${n}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${n}, syncData);
                    `));continue}const l=e.uniforms[n];let h=!1;for(let u=0;u<On.length;u++)if(On[u].test(o,l)){r.push(On[u].code(n,l)),h=!0;break}if(!h){const f=(o.size===1&&!o.isArray?dR:pR)[o.type].replace("location",`ud["${n}"].location`);r.push(`
            cu = ud["${n}"];
            cv = cu.value;
            v = uv["${n}"];
            ${f};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}const Dm={};let vn=Dm;function mR(){if(vn===Dm||vn!=null&&vn.isContextLost()){const e=J.ADAPTER.createCanvas();let t;J.PREFER_ENV>=qi.WEBGL2&&(t=e.getContext("webgl2",{})),t||(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),vn=t}return vn}let $o;function vR(){if(!$o){$o=Je.MEDIUM;const e=mR();e&&e.getShaderPrecisionFormat&&($o=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision?Je.HIGH:Je.MEDIUM)}return $o}function tg(e,t){const r=e.getShaderSource(t).split(`
`).map((f,d)=>`${d}: ${f}`),i=e.getShaderInfoLog(t),n=i.split(`
`),o={},l=n.map(f=>parseFloat(f.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(f=>f&&!o[f]?(o[f]=!0,!0):!1),h=[""];l.forEach(f=>{r[f-1]=`%c${r[f-1]}%c`,h.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const u=r.join(`
`);h[0]=u,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...h),console.groupEnd()}function yR(e,t,r,i){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||tg(e,r),e.getShaderParameter(i,e.COMPILE_STATUS)||tg(e,i),console.error("PixiJS Error: Could not initialize shader."),e.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}const _R={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Bm(e){return _R[e]}let Ho=null;const eg={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Om(e,t){if(!Ho){const r=Object.keys(eg);Ho={};for(let i=0;i<r.length;++i){const n=r[i];Ho[e[n]]=eg[n]}}return Ho[t]}function rg(e,t,r){if(e.substring(0,9)!=="precision"){let i=t;return t===Je.HIGH&&r!==Je.HIGH&&(i=Je.MEDIUM),`precision ${i} float;
${e}`}else if(r!==Je.HIGH&&e.substring(0,15)==="precision highp")return e.replace("precision highp","precision mediump");return e}let gs;function xR(){if(typeof gs=="boolean")return gs;try{gs=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{gs=!1}return gs}let bR=0;const Xo={},wn=class{constructor(e,t,r="pixi-shader",i={}){this.extra={},this.id=bR++,this.vertexSrc=e||wn.defaultVertexSrc,this.fragmentSrc=t||wn.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),Xo[r]?(Xo[r]++,r+=`-${Xo[r]}`):Xo[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=rg(this.vertexSrc,wn.defaultVertexPrecision,Je.HIGH),this.fragmentSrc=rg(this.fragmentSrc,wn.defaultFragmentPrecision,vR())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return fR}static get defaultFragmentSrc(){return cR}static from(e,t,r){const i=e+t;let n=Yp[i];return n||(Yp[i]=n=new wn(e,t,r)),n}};let fr=wn;fr.defaultVertexPrecision=Je.HIGH;fr.defaultFragmentPrecision=Vr.apple.device?Je.HIGH:Je.MEDIUM;let wR=0;class mr{constructor(t,r,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=wR++,this.static=!!r,this.ubo=!!i,t instanceof re?(this.buffer=t,this.buffer.type=Rr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new re(new Float32Array(1)),this.buffer.type=Rr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,r,i){if(!this.ubo)this.uniforms[t]=new mr(r,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,r,i){return new mr(t,r,i)}static uboFrom(t,r){return new mr(t,r??!0,!0)}}class Mr{constructor(t,r){this.uniformBindCount=0,this.program=t,r?r instanceof mr?this.uniformGroup=r:this.uniformGroup=new mr(r):this.uniformGroup=new mr({}),this.disposeRunner=new gr("disposeShader")}checkUniformExists(t,r){if(r.uniforms[t])return!0;for(const i in r.uniforms){const n=r.uniforms[i];if(n.group&&this.checkUniformExists(t,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,r,i){const n=fr.from(t,r);return new Mr(n,i)}}class ER{constructor(t,r){if(this.vertexSrc=t,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const i=new Int32Array(t);for(let o=0;o<t;o++)i[o]=o;this.defaultGroupCache[t]=mr.from({uSamplers:i},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${t}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new fr(this.vertexSrc,n)}const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new $t,default:this.defaultGroupCache[t]};return new Mr(this.programCache[t],r)}generateSampleSrc(t){let r="";r+=`
`,r+=`
`;for(let i=0;i<t;i++)i>0&&(r+=`
else `),i<t-1&&(r+=`if(vTextureId < ${i}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}}class Bu{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function TR(){return!Vr.apple.device}function AR(e){let t=!0;const r=J.ADAPTER.getNavigator();if(Vr.tablet||Vr.phone){if(Vr.apple.device){const i=r.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(Vr.android.device){const i=r.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?e:4}class Xa{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var SR=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,CR=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const ar=class extends Xa{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=Im,this.vertexSize=6,this.state=qr.for2d(),this.size=ar.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??AR(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??TR(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return Ct("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return CR}static get defaultFragmentTemplate(){return SR}setShaderGenerator({vertex:e=ar.defaultVertexSrc,fragment:t=ar.defaultFragmentTemplate}={}){this.shaderGenerator=new ER(e,t)}contextChange(){const e=this.renderer.gl;J.PREFER_ENV===qi.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),ar.defaultMaxTextures),this.maxTextures=eR(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:t}=ar,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;e.length<r;)e.push(new Mu);for(;t.length<i;)t.push(new Bu);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:t}=this,r=ar._textureArrayPool,i=this.renderer.batch,n=this._tempBoundTextures,o=this.renderer.textureGC.count;let l=++gt._globalBatch,h=0,u=r[0],f=0;i.copyBoundTextures(n,t);for(let d=0;d<this._bufferSize;++d){const g=e[d];e[d]=null,g._batchEnabled!==l&&(u.count>=t&&(i.boundArray(u,n,l,t),this.buildDrawCalls(u,f,d),f=d,u=r[++h],++l),g._batchEnabled=l,g.touched=o,u.elements[u.count++]=g)}u.count>0&&(i.boundArray(u,n,l,t),this.buildDrawCalls(u,f,this._bufferSize),++h,++l);for(let d=0;d<n.length;d++)n[d]=null;gt._globalBatch=l}buildDrawCalls(e,t,r){const{_bufferedElements:i,_attributeBuffer:n,_indexBuffer:o,vertexSize:l}=this,h=ar._drawCallPool;let u=this._dcIndex,f=this._aIndex,d=this._iIndex,g=h[u];g.start=this._iIndex,g.texArray=e;for(let m=t;m<r;++m){const v=i[m],_=v._texture.baseTexture,w=wm[_.alphaMode?1:0][v.blendMode];i[m]=null,t<m&&g.blend!==w&&(g.size=d-g.start,t=m,g=h[++u],g.texArray=e,g.start=d),this.packInterleavedGeometry(v,n,o,f,d),f+=v.vertexData.length/2*l,d+=v.indices.length,g.blend=w}t<r&&(g.size=d-g.start,++u),this._dcIndex=u,this._aIndex=f,this._iIndex=d}bindAndClearTexArray(e){const t=this.renderer.texture;for(let r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:r}=this;ar.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:t,state:r}=this.renderer,i=ar._drawCallPool;let n=null;for(let o=0;o<e;o++){const{texArray:l,type:h,size:u,start:f,blend:d}=i[o];n!==l&&(n=l,this.bindAndClearTexArray(l)),this.state.blendMode=d,r.set(this.state),t.drawElements(h,u,t.UNSIGNED_SHORT,f*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),ar.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const t=Aa(Math.ceil(e/8)),r=Vp(t),i=t*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new Pu(i*this.vertexSize*4)),n}getIndexBuffer(e){const t=Aa(Math.ceil(e/12)),r=Vp(t),i=t*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n}packInterleavedGeometry(e,t,r,i,n){const{uint32View:o,float32View:l}=t,h=i/this.vertexSize,u=e.uvs,f=e.indices,d=e.vertexData,g=e._texture.baseTexture._batchLocation,m=Math.min(e.worldAlpha,1),v=m<1&&e._texture.baseTexture.alphaMode?cc(e._tintRGB,m):e._tintRGB+(m*255<<24);for(let _=0;_<d.length;_+=2)l[i++]=d[_],l[i++]=d[_+1],l[i++]=u[_],l[i++]=u[_+1],o[i++]=v,l[i++]=g;for(let _=0;_<f.length;_++)r[n++]=h+f[_]}};let ur=ar;ur.defaultBatchSize=4096;ur.extension={name:"batch",type:Z.RendererPlugin};ur._drawCallPool=[];ur._textureArrayPool=[];nt.add(ur);var IR=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,PR=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const _s=class extends Mr{constructor(e,t,r){const i=fr.from(e||_s.defaultVertexSrc,t||_s.defaultFragmentSrc);super(i,r),this.padding=0,this.resolution=_s.defaultResolution,this.multisample=_s.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new qr}apply(e,t,r,i,n){e.applyFilter(this,t,r,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return PR}static get defaultFragmentSrc(){return IR}};let Ae=_s;Ae.defaultResolution=1;Ae.defaultMultisample=se.NONE;class Fm{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender,t.color&&(this.color=typeof t.color=="string"?uc(t.color):t.color),this.alpha=t.alpha}get color(){return this._backgroundColor}set color(t){this._backgroundColor=t,this._backgroundColorString=bm(t),Ms(t,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(t){this._backgroundColorRgba[3]=t}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}}Fm.extension={type:[Z.RendererSystem,Z.CanvasRendererSystem],name:"background"};nt.add(Fm);class Lm{constructor(t){this.renderer=t,this.emptyRenderer=new Xa(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,r){const{boundTextures:i}=this.renderer.texture;for(let n=r-1;n>=0;--n)t[n]=i[n]||null,t[n]&&(t[n]._batchLocation=n)}boundArray(t,r,i,n){const{elements:o,ids:l,count:h}=t;let u=0;for(let f=0;f<h;f++){const d=o[f],g=d._batchLocation;if(g>=0&&g<n&&r[g]===d){l[f]=g;continue}for(;u<n;){const m=r[u];if(m&&m._batchEnabled===i&&m._batchLocation===u){u++;continue}l[f]=u,d._batchLocation=u,r[u]=d;break}}}destroy(){this.renderer=null}}Lm.extension={type:Z.RendererSystem,name:"batch"};nt.add(Lm);let ig=0;class Nm{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=ig++}init(t){if(t.context)this.initFromContext(t.context);else{const r=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=ig++,this.renderer.runners.contextChange.emit(t);const r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const r=this.createContext(this.renderer.view,t);this.initFromContext(r)}createContext(t,r){let i;if(J.PREFER_ENV>=qi.WEBGL2&&(i=t.getContext("webgl2",r)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",r)||t.getContext("experimental-webgl",r),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,r={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const r=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const n=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Nm.extension={type:Z.RendererSystem,name:"context"};nt.add(Nm);class RR extends Us{upload(t,r,i){const n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===vr.UNPACK);const o=r.realWidth,l=r.realHeight;return i.width===o&&i.height===l?n.texSubImage2D(r.target,0,0,0,o,l,r.format,i.type,this.data):(i.width=o,i.height=l,n.texImage2D(r.target,0,i.internalFormat,o,l,0,r.format,i.type,this.data)),!0}}class Ou{constructor(t,r){this.width=Math.round(t||100),this.height=Math.round(r||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new gr("disposeFramebuffer"),this.multisample=se.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,r){return this.colorTextures[t]=r||new gt(null,{scaleMode:zr.NEAREST,resolution:1,mipmap:Dr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new gt(new RR(null,{width:this.width,height:this.height}),{scaleMode:zr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Dr.OFF,format:V.DEPTH_COMPONENT,type:st.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,r){if(t=Math.round(t),r=Math.round(r),!(t===this.width&&r===this.height)){this.width=t,this.height=r,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const n=this.colorTextures[i],o=n.resolution;n.setSize(t/o,r/o)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,r/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class km extends gt{constructor(t={}){if(typeof t=="number"){const r=arguments[0],i=arguments[1],n=arguments[2],o=arguments[3];t={width:r,height:i,scaleMode:n,resolution:o}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=se.NONE),super(null,t),this.mipmap=Dr.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new Ou(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}resize(t,r){this.framebuffer.resize(t*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class pi extends Ds{constructor(t){const r=t,i=r.naturalWidth||r.videoWidth||r.width,n=r.naturalHeight||r.videoHeight||r.height;super(i,n),this.source=t,this.noSubImage=!1}static crossOrigin(t,r,i){i===void 0&&!r.startsWith("data:")?t.crossOrigin=JP(r):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,r,i,n){const o=t.gl,l=r.realWidth,h=r.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1&&n.buffered.length===0)return!1;return o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===vr.UNPACK),!this.noSubImage&&r.target===o.TEXTURE_2D&&i.width===l&&i.height===h?o.texSubImage2D(o.TEXTURE_2D,0,0,0,r.format,i.type,n):(i.width=l,i.height=h,o.texImage2D(r.target,0,i.internalFormat,r.format,i.type,n)),!0}update(){if(this.destroyed)return;const t=this.source,r=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(r,i),super.update()}dispose(){this.source=null}}class Um extends pi{constructor(t,r){if(r=r||{},typeof t=="string"){const i=new Image;pi.crossOrigin(i,t,r.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??J.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((r,i)=>{const n=this.source;this.url=n.src;const o=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.resize(n.width,n.height),this._load=null,this.createBitmap?r(this.process()):r(this))};n.complete&&n.src?o():(n.onload=o,n.onerror=l=>{i(l),this.onError.emit(l)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const r=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(n=>n.blob()).then(n=>r(n,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===vr.UNPACK?"premultiply":"none"})).then(n=>this.destroyed?Promise.reject():(this.bitmap=n,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,r,i){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,r,i,this.bitmap),!this.preserveBitmap){let n=!0;const o=r._glTextures;for(const l in o){const h=o[l];if(h!==i&&h.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class Gm{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,r,i){const n=r.width,o=r.height;if(i){const l=t.width/2/n,h=t.height/2/o,u=t.x/n+l,f=t.y/o+h;i=Xt.add(i,Xt.NW),this.x0=u+l*Xt.uX(i),this.y0=f+h*Xt.uY(i),i=Xt.add(i,2),this.x1=u+l*Xt.uX(i),this.y1=f+h*Xt.uY(i),i=Xt.add(i,2),this.x2=u+l*Xt.uX(i),this.y2=f+h*Xt.uY(i),i=Xt.add(i,2),this.x3=u+l*Xt.uX(i),this.y3=f+h*Xt.uY(i)}else this.x0=t.x/n,this.y0=t.y/o,this.x1=(t.x+t.width)/n,this.y1=t.y/o,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/o,this.x3=t.x/n,this.y3=(t.y+t.height)/o;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const ng=new Gm;function zo(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}class it extends Ls{constructor(t,r,i,n,o,l){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new Tt(0,0,1,1)),t instanceof it&&(t=t.baseTexture),this.baseTexture=t,this._frame=r,this.trim=n,this.valid=!1,this._uvs=ng,this.uvMatrix=null,this.orig=i||r,this._rotate=Number(o||0),o===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=l?new St(l.x,l.y):new St(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=r:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:r}=this.baseTexture;r!=null&&r.url&&Tr[r.url]&&it.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,it.removeFromCache(this),this.textureCacheIds=null}clone(){var n;const t=this._frame.clone(),r=this._frame===this.orig?t:this.orig.clone(),i=new it(this.baseTexture,!this.noFrame&&t,r,(n=this.trim)==null?void 0:n.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===ng&&(this._uvs=new Gm),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,r={},i=J.STRICT_TEXTURE_CACHE){const n=typeof t=="string";let o=null;if(n)o=t;else if(t instanceof gt){if(!t.cacheId){const h=(r==null?void 0:r.pixiIdPrefix)||"pixiid";t.cacheId=`${h}-${zi()}`,gt.addToCache(t,t.cacheId)}o=t.cacheId}else{if(!t._pixiId){const h=(r==null?void 0:r.pixiIdPrefix)||"pixiid";t._pixiId=`${h}_${zi()}`}o=t._pixiId}let l=Tr[o];if(n&&i&&!l)throw new Error(`The cacheId "${o}" does not exist in TextureCache.`);return!l&&!(t instanceof gt)?(r.resolution||(r.resolution=fi(t)),l=new it(new gt(t,r)),l.baseTexture.cacheId=o,gt.addToCache(l.baseTexture,o),it.addToCache(l,o)):!l&&t instanceof gt&&(l=new it(t),it.addToCache(l,o)),l}static fromURL(t,r){const i=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),n=it.from(t,Object.assign({resourceOptions:i},r),!1),o=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):o.load().then(()=>Promise.resolve(n))}static fromBuffer(t,r,i,n){return new it(gt.fromBuffer(t,r,i,n))}static fromLoader(t,r,i,n){const o=new gt(t,Object.assign({scaleMode:J.SCALE_MODE,resolution:fi(r)},n)),{resource:l}=o;l instanceof Um&&(l.url=r);const h=new it(o);return i||(i=r),gt.addToCache(h.baseTexture,i),it.addToCache(h,i),i!==r&&(gt.addToCache(h.baseTexture,r),it.addToCache(h,r)),h.baseTexture.valid?Promise.resolve(h):new Promise(u=>{h.baseTexture.once("loaded",()=>u(h))})}static addToCache(t,r){r&&(t.textureCacheIds.includes(r)||t.textureCacheIds.push(r),Tr[r]&&Tr[r]!==t&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),Tr[r]=t)}static removeFromCache(t){if(typeof t=="string"){const r=Tr[t];if(r){const i=r.textureCacheIds.indexOf(t);return i>-1&&r.textureCacheIds.splice(i,1),delete Tr[t],r}}else if(t!=null&&t.textureCacheIds){for(let r=0;r<t.textureCacheIds.length;++r)Tr[t.textureCacheIds[r]]===t&&delete Tr[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:r,y:i,width:n,height:o}=t,l=r+n>this.baseTexture.width,h=i+o>this.baseTexture.height;if(l||h){const u=l&&h?"and":"or",f=`X: ${r} + ${n} = ${r+n} > ${this.baseTexture.width}`,d=`Y: ${i} + ${o} = ${i+o} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${f} ${u} ${d}`)}this.valid=n&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return it._EMPTY||(it._EMPTY=new it(new gt),zo(it._EMPTY),zo(it._EMPTY.baseTexture)),it._EMPTY}static get WHITE(){if(!it._WHITE){const t=J.ADAPTER.createCanvas(16,16),r=t.getContext("2d");t.width=16,t.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),it._WHITE=new it(gt.from(t)),zo(it._WHITE),zo(it._WHITE.baseTexture)}return it._WHITE}}class gi extends it{constructor(t,r){super(t,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,r,i=!0){const n=this.baseTexture.resolution,o=Math.round(t*n)/n,l=Math.round(r*n)/n;this.valid=o>0&&l>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=l,i&&this.baseTexture.resize(o,l),this.updateUvs()}setResolution(t){const{baseTexture:r}=this;r.resolution!==t&&(r.setResolution(t),this.resize(r.width,r.height,!1))}static create(t){return new gi(new km(t))}}class Wm{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,r,i=se.NONE){const n=new km(Object.assign({width:t,height:r,resolution:1,multisample:i},this.textureOptions));return new gi(n)}getOptimalTexture(t,r,i=1,n=se.NONE){let o;t=Math.ceil(t*i-1e-6),r=Math.ceil(r*i-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||r!==this._pixelsHeight?(t=Aa(t),r=Aa(r),o=((t&65535)<<16|r&65535)>>>0,n>1&&(o+=n*4294967296)):o=n>1?-n:-1,this.texturePool[o]||(this.texturePool[o]=[]);let l=this.texturePool[o].pop();return l||(l=this.createTexture(t,r,n)),l.filterPoolKey=o,l.setResolution(i),l}getFilterTexture(t,r,i){const n=this.getOptimalTexture(t.width,t.height,r||t.resolution,i||se.NONE);return n.filterFrame=t.filterFrame,n}returnTexture(t){const r=t.filterPoolKey;t.filterFrame=null,this.texturePool[r].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const r in this.texturePool){const i=this.texturePool[r];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const r in this.texturePool){if(!(Number(r)<0))continue;const i=this.texturePool[r];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Wm.SCREEN_KEY=-1;class MR extends di{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class $m extends di{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new re(this.vertices),this.uvBuffer=new re(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,r){let i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+r.width/t.width,this.uvs[3]=n,this.uvs[4]=i+r.width/t.width,this.uvs[5]=n+r.height/t.height,this.uvs[6]=i,this.uvs[7]=n+r.height/t.height,i=r.x,n=r.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+r.width,this.vertices[3]=n,this.vertices[4]=i+r.width,this.vertices[5]=n+r.height,this.vertices[6]=i,this.vertices[7]=n+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class DR{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=se.NONE,this.sourceFrame=new Tt,this.destinationFrame=new Tt,this.bindingSourceFrame=new Tt,this.bindingDestinationFrame=new Tt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Vo=[new St,new St,new St,new St],Wh=new $t;class Hm{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Wm,this.statePool=[],this.quad=new MR,this.quadUv=new $m,this.tempRect=new Tt,this.activeState={},this.globalUniforms=new mr({outputFrame:new Tt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,r){const i=this.renderer,n=this.defaultFilterStack,o=this.statePool.pop()||new DR,l=this.renderer.renderTexture;let h=r[0].resolution,u=r[0].multisample,f=r[0].padding,d=r[0].autoFit,g=r[0].legacy??!0;for(let _=1;_<r.length;_++){const w=r[_];h=Math.min(h,w.resolution),u=Math.min(u,w.multisample),f=this.useMaxPadding?Math.max(f,w.padding):f+w.padding,d=d&&w.autoFit,g=g||(w.legacy??!0)}n.length===1&&(this.defaultFilterStack[0].renderTexture=l.current),n.push(o),o.resolution=h,o.multisample=u,o.legacy=g,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(f);const m=this.tempRect.copyFrom(l.sourceFrame);i.projection.transform&&this.transformAABB(Wh.copyFrom(i.projection.transform).invert(),m),d?(o.sourceFrame.fit(m),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(m)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,l.current?l.current.resolution:i.resolution,l.sourceFrame,l.destinationFrame,i.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,h,u),o.filters=r,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;const v=this.tempRect;v.x=0,v.y=0,v.width=o.sourceFrame.width,v.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(l.sourceFrame),o.bindingDestinationFrame.copyFrom(l.destinationFrame),o.transform=i.projection.transform,i.projection.transform=null,l.bind(o.renderTexture,o.sourceFrame,v),i.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,r=t.pop(),i=r.filters;this.activeState=r;const n=this.globalUniforms.uniforms;n.outputFrame=r.sourceFrame,n.resolution=r.resolution;const o=n.inputSize,l=n.inputPixel,h=n.inputClamp;if(o[0]=r.destinationFrame.width,o[1]=r.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],l[0]=Math.round(o[0]*r.resolution),l[1]=Math.round(o[1]*r.resolution),l[2]=1/l[0],l[3]=1/l[1],h[0]=.5*l[2],h[1]=.5*l[3],h[2]=r.sourceFrame.width*o[2]-.5*l[2],h[3]=r.sourceFrame.height*o[3]-.5*l[3],r.legacy){const f=n.filterArea;f[0]=r.destinationFrame.width,f[1]=r.destinationFrame.height,f[2]=r.sourceFrame.x,f[3]=r.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();const u=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,r.renderTexture,u.renderTexture,Sr.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let f=r.renderTexture,d=this.getOptimalFilterTexture(f.width,f.height,r.resolution);d.filterFrame=f.filterFrame;let g=0;for(g=0;g<i.length-1;++g){g===1&&r.multisample>1&&(d=this.getOptimalFilterTexture(f.width,f.height,r.resolution),d.filterFrame=f.filterFrame),i[g].apply(this,f,d,Sr.CLEAR,r);const m=f;f=d,d=m}i[g].apply(this,f,u.renderTexture,Sr.BLEND,r),g>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(f),this.returnFilterTexture(d)}r.clear(),this.statePool.push(r)}bindAndClear(t,r=Sr.CLEAR){const{renderTexture:i,state:n}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const l=this.tempRect;l.x=0,l.y=0,l.width=t.filterFrame.width,l.height=t.filterFrame.height,i.bind(t,t.filterFrame,l)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const o=n.stateId&1||this.forceClear;(r===Sr.CLEAR||r===Sr.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,r,i,n){const o=this.renderer;o.state.set(t.state),this.bindAndClear(i,n),t.uniforms.uSampler=r,t.uniforms.filterGlobals=this.globalUniforms,o.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(r._frame,r.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(Pr.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(Pr.TRIANGLE_STRIP))}calculateSpriteMatrix(t,r){const{sourceFrame:i,destinationFrame:n}=this.activeState,{orig:o}=r._texture,l=t.set(n.width,0,0,n.height,i.x,i.y),h=r.worldTransform.copyTo($t.TEMP_MATRIX);return h.invert(),l.prepend(h),l.scale(1/o.width,1/o.height),l.translate(r.anchor.x,r.anchor.y),l}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,r,i=1,n=se.NONE){return this.texturePool.getOptimalTexture(t,r,i,n)}getFilterTexture(t,r,i){if(typeof t=="number"){const o=t;t=r,r=o}t=t||this.activeState.renderTexture;const n=this.texturePool.getOptimalTexture(t.width,t.height,r||t.resolution,i||se.NONE);return n.filterFrame=t.filterFrame,n}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,r){const i=Vo[0],n=Vo[1],o=Vo[2],l=Vo[3];i.set(r.left,r.top),n.set(r.left,r.bottom),o.set(r.right,r.top),l.set(r.right,r.bottom),t.apply(i,i),t.apply(n,n),t.apply(o,o),t.apply(l,l);const h=Math.min(i.x,n.x,o.x,l.x),u=Math.min(i.y,n.y,o.y,l.y),f=Math.max(i.x,n.x,o.x,l.x),d=Math.max(i.y,n.y,o.y,l.y);r.x=h,r.y=u,r.width=f-h,r.height=d-u}roundFrame(t,r,i,n,o){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(o){const{a:l,b:h,c:u,d:f}=o;if((Math.abs(h)>1e-4||Math.abs(u)>1e-4)&&(Math.abs(l)>1e-4||Math.abs(f)>1e-4))return}o=o?Wh.copyFrom(o):Wh.identity(),o.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.transformAABB(o,t),t.ceil(r),this.transformAABB(o.invert(),t)}}}Hm.extension={type:Z.RendererSystem,name:"filter"};nt.add(Hm);class BR{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=se.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const OR=new Tt;class Xm{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Ou(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Tt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;J.PREFER_ENV===qi.WEBGL_LEGACY&&(r=null,i=null),r?t.drawBuffers=n=>r.drawBuffersWEBGL(n):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,r,i=0){const{gl:n}=this;if(t){const o=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,o.framebuffer)),o.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,o.mipLevel=i),o.dirtyId!==t.dirtyId&&(o.dirtyId=t.dirtyId,o.dirtyFormat!==t.dirtyFormat?(o.dirtyFormat=t.dirtyFormat,o.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):o.dirtySize!==t.dirtySize&&(o.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let l=0;l<t.colorTextures.length;l++){const h=t.colorTextures[l];this.renderer.texture.unbind(h.parentTextureArray||h)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),r){const l=r.width>>i,h=r.height>>i,u=l/r.width;this.setViewport(r.x*u,r.y*u,l,h)}else{const l=t.width>>i,h=t.height>>i;this.setViewport(0,0,l,h)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,r,i,n){const o=this.viewport;t=Math.round(t),r=Math.round(r),i=Math.round(i),n=Math.round(n),(o.width!==i||o.height!==n||o.x!==t||o.y!==r)&&(o.x=t,o.y=r,o.width=i,o.height=n,this.gl.viewport(t,r,i,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,r,i,n,o=fu.COLOR|fu.DEPTH){const{gl:l}=this;l.clearColor(t,r,i,n),l.clear(o)}initFramebuffer(t){const{gl:r}=this,i=new BR(r.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){const{gl:r}=this,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height));const n=t.colorTextures;let o=n.length;r.drawBuffers||(o=Math.min(o,1));for(let l=0;l<o;l++){const h=n[l],u=h.parentTextureArray||h;this.renderer.texture.bind(u,0),l===0&&i.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,r){const{gl:i}=this,n=t.glFramebuffers[this.CONTEXT_UID],o=t.colorTextures;let l=o.length;i.drawBuffers||(l=Math.min(l,1)),n.multisample>1&&this.canMultisampleFramebuffer(t)?n.msaaBuffer=n.msaaBuffer||i.createRenderbuffer():n.msaaBuffer&&(i.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));const h=[];for(let u=0;u<l;u++){const f=o[u],d=f.parentTextureArray||f;this.renderer.texture.bind(d,0),u===0&&n.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,d._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+u,f.target,d._glTextures[this.CONTEXT_UID].texture,r),h.push(i.COLOR_ATTACHMENT0+u))}if(h.length>1&&i.drawBuffers(h),t.depthTexture&&this.writeDepthTexture){const f=t.depthTexture;this.renderer.texture.bind(f,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,f._glTextures[this.CONTEXT_UID].texture,r)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(n.stencil=n.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,n.stencil),n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,n.stencil)):n.stencil&&(i.deleteRenderbuffer(n.stencil),n.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:r}=this;let i=se.NONE;if(t<=1||r===null)return i;for(let n=0;n<r.length;n++)if(r[n]<=t){i=r[n];break}return i===1&&(i=se.NONE),i}blit(t,r,i){const{current:n,renderer:o,gl:l,CONTEXT_UID:h}=this;if(o.context.webGLVersion!==2||!n)return;const u=n.glFramebuffers[h];if(!u)return;if(!t){if(!u.msaaBuffer)return;const d=n.colorTextures[0];if(!d)return;u.blitFramebuffer||(u.blitFramebuffer=new Ou(n.width,n.height),u.blitFramebuffer.addColorTexture(0,d)),t=u.blitFramebuffer,t.colorTextures[0]!==d&&(t.colorTextures[0]=d,t.dirtyId++,t.dirtyFormat++),(t.width!==n.width||t.height!==n.height)&&(t.width=n.width,t.height=n.height,t.dirtyId++,t.dirtySize++)}r||(r=OR,r.width=n.width,r.height=n.height),i||(i=r);const f=r.width===i.width&&r.height===i.height;this.bind(t),l.bindFramebuffer(l.READ_FRAMEBUFFER,u.framebuffer),l.blitFramebuffer(r.left,r.top,r.right,r.bottom,i.left,i.top,i.right,i.bottom,l.COLOR_BUFFER_BIT,f?l.NEAREST:l.LINEAR)}disposeFramebuffer(t,r){const i=t.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];const o=this.managedFramebuffers.indexOf(t);o>=0&&this.managedFramebuffers.splice(o,1),t.disposeRunner.remove(this),r||(n.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&n.deleteRenderbuffer(i.msaaBuffer),i.stencil&&n.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&i.blitFramebuffer.dispose()}disposeAll(t){const r=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<r.length;i++)this.disposeFramebuffer(r[i],t)}forceStencil(){const t=this.current;if(!t)return;const r=t.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil)return;t.stencil=!0;const i=t.width,n=t.height,o=this.gl,l=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,l),r.msaaBuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,r.multisample,o.DEPTH24_STENCIL8,i,n):o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,i,n),r.stencil=l,o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,l)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Tt}destroy(){this.renderer=null}}Xm.extension={type:Z.RendererSystem,name:"framebuffer"};nt.add(Xm);const $h={5126:4,5123:2,5121:1};class zm{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;J.PREFER_ENV===qi.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=n=>i.bindVertexArrayOES(n),t.deleteVertexArray=n=>i.deleteVertexArrayOES(n)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){const i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(n,o)=>i.vertexAttribDivisorANGLE(n,o),t.drawElementsInstanced=(n,o,l,h,u)=>i.drawElementsInstancedANGLE(n,o,l,h,u),t.drawArraysInstanced=(n,o,l,h)=>i.drawArraysInstancedANGLE(n,o,l,h)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(t,r){r=r||this.renderer.shader.shader;const{gl:i}=this;let n=t.glVertexArrayObjects[this.CONTEXT_UID],o=!1;n||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=n={},o=!0);const l=n[r.program.id]||this.initGeometryVao(t,r,o);this._activeGeometry=t,this._activeVao!==l&&(this._activeVao=l,this.hasVao?i.bindVertexArray(l):this.activateVao(t,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,r=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){const n=t.buffers[i];r.update(n)}}checkCompatibility(t,r){const i=t.attributes,n=r.attributeData;for(const o in n)if(!i[o])throw new Error(`shader and geometry incompatible, geometry missing the "${o}" attribute`)}getSignature(t,r){const i=t.attributes,n=r.attributeData,o=["g",t.id];for(const l in i)n[l]&&o.push(l,n[l].location);return o.join("-")}initGeometryVao(t,r,i=!0){const n=this.gl,o=this.CONTEXT_UID,l=this.renderer.buffer,h=r.program;h.glPrograms[o]||this.renderer.shader.generateProgram(r),this.checkCompatibility(t,h);const u=this.getSignature(t,h),f=t.glVertexArrayObjects[this.CONTEXT_UID];let d=f[u];if(d)return f[h.id]=d,d;const g=t.buffers,m=t.attributes,v={},_={};for(const w in g)v[w]=0,_[w]=0;for(const w in m)!m[w].size&&h.attributeData[w]?m[w].size=h.attributeData[w].size:m[w].size||console.warn(`PIXI Geometry attribute '${w}' size cannot be determined (likely the bound shader does not have the attribute)`),v[m[w].buffer]+=m[w].size*$h[m[w].type];for(const w in m){const x=m[w],A=x.size;x.stride===void 0&&(v[x.buffer]===A*$h[x.type]?x.stride=0:x.stride=v[x.buffer]),x.start===void 0&&(x.start=_[x.buffer],_[x.buffer]+=A*$h[x.type])}d=n.createVertexArray(),n.bindVertexArray(d);for(let w=0;w<g.length;w++){const x=g[w];l.bind(x),i&&x._glBuffers[o].refCount++}return this.activateVao(t,h),f[h.id]=d,f[u]=d,n.bindVertexArray(null),l.unbind(Rr.ARRAY_BUFFER),d}disposeGeometry(t,r){var h;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const i=t.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,o=t.buffers,l=(h=this.renderer)==null?void 0:h.buffer;if(t.disposeRunner.remove(this),!!i){if(l)for(let u=0;u<o.length;u++){const f=o[u]._glBuffers[this.CONTEXT_UID];f&&(f.refCount--,f.refCount===0&&!r&&l.dispose(o[u],r))}if(!r){for(const u in i)if(u[0]==="g"){const f=i[u];this._activeVao===f&&this.unbind(),n.deleteVertexArray(f)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const r=Object.keys(this.managedGeometries);for(let i=0;i<r.length;i++)this.disposeGeometry(this.managedGeometries[r[i]],t)}activateVao(t,r){const i=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,l=t.buffers,h=t.attributes;t.indexBuffer&&o.bind(t.indexBuffer);let u=null;for(const f in h){const d=h[f],g=l[d.buffer],m=g._glBuffers[n];if(r.attributeData[f]){u!==m&&(o.bind(g),u=m);const v=r.attributeData[f].location;if(i.enableVertexAttribArray(v),i.vertexAttribPointer(v,d.size,d.type||i.FLOAT,d.normalized,d.stride,d.start),d.instance)if(this.hasInstance)i.vertexAttribDivisor(v,d.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,r,i,n){const{gl:o}=this,l=this._activeGeometry;if(l.indexBuffer){const h=l.indexBuffer.data.BYTES_PER_ELEMENT,u=h===2?o.UNSIGNED_SHORT:o.UNSIGNED_INT;h===2||h===4&&this.canUseUInt32ElementIndex?l.instanced?o.drawElementsInstanced(t,r||l.indexBuffer.data.length,u,(i||0)*h,n||1):o.drawElements(t,r||l.indexBuffer.data.length,u,(i||0)*h):console.warn("unsupported index buffer type: uint32")}else l.instanced?o.drawArraysInstanced(t,i,r||l.getSize(),n||1):o.drawArrays(t,i,r||l.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}zm.extension={type:Z.RendererSystem,name:"geometry"};nt.add(zm);const sg=new $t;class Vm{constructor(t,r){this._texture=t,this.mapCoord=new $t,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,r){r===void 0&&(r=t);const i=this.mapCoord;for(let n=0;n<t.length;n+=2){const o=t[n],l=t[n+1];r[n]=o*i.a+l*i.c+i.tx,r[n+1]=o*i.b+l*i.d+i.ty}return r}update(t){const r=this._texture;if(!r||!r.valid||!t&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;const i=r._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const n=r.orig,o=r.trim;o&&(sg.set(n.width/o.width,0,0,n.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(sg));const l=r.baseTexture,h=this.uClampFrame,u=this.clampMargin/l.resolution,f=this.clampOffset;return h[0]=(r._frame.x+u+f)/l.width,h[1]=(r._frame.y+u+f)/l.height,h[2]=(r._frame.x+r._frame.width-u+f)/l.width,h[3]=(r._frame.y+r._frame.height-u+f)/l.height,this.uClampOffset[0]=f/l.realWidth,this.uClampOffset[1]=f/l.realHeight,this.isSimple=r._frame.width===l.width&&r._frame.height===l.height&&r.rotate===0,!0}}var FR=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,LR=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class NR extends Ae{constructor(t,r,i){let n=null;typeof t!="string"&&r===void 0&&i===void 0&&(n=t,t=void 0,r=void 0,i=void 0),super(t||LR,r||FR,i),this.maskSprite=n,this.maskMatrix=new $t}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,r,i,n){const o=this._maskSprite,l=o._texture;l.valid&&(l.uvMatrix||(l.uvMatrix=new Vm(l,0)),l.uvMatrix.update(),this.uniforms.npmAlpha=l.baseTexture.alphaMode?0:1,this.uniforms.mask=l,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,o).prepend(l.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=l.uvMatrix.uClampFrame,t.applyFilter(this,r,i,n))}}class kR{constructor(t=null){this.type=ue.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=J.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=ue.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Ym{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,r){let i=r;if(!i.isMaskData){const o=this.maskDataPool.pop()||new kR;o.pooled=!0,o.maskObject=r,i=o}const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(n),i._colorMask=n?n._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==ue.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case ue.SCISSOR:this.renderer.scissor.push(i);break;case ue.STENCIL:this.renderer.stencil.push(i);break;case ue.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case ue.COLOR:this.pushColorMask(i);break}i.type===ue.SPRITE&&this.maskStack.push(i)}pop(t){const r=this.maskStack.pop();if(!(!r||r._target!==t)){if(r.enabled)switch(r.type){case ue.SCISSOR:this.renderer.scissor.pop(r);break;case ue.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case ue.SPRITE:this.popSpriteMask(r);break;case ue.COLOR:this.popColorMask(r);break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===ue.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){const r=t.maskObject;r?r.isSprite?t.type=ue.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=ue.SCISSOR:t.type=ue.STENCIL:t.type=ue.COLOR}pushSpriteMask(t){const{maskObject:r}=t,i=t._target;let n=t._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new NR]));const o=this.renderer,l=o.renderTexture;let h,u;if(l.current){const d=l.current;h=t.resolution||d.resolution,u=t.multisample??d.multisample}else h=t.resolution||o.resolution,u=t.multisample??o.multisample;n[0].resolution=h,n[0].multisample=u,n[0].maskSprite=r;const f=i.filterArea;i.filterArea=r.getBounds(!0),o.filter.push(i,n),i.filterArea=f,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const r=t._colorMask,i=t._colorMask=r&t.colorMask;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){const r=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==r&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}Ym.extension={type:Z.RendererSystem,name:"mask"};nt.add(Ym);class jm{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:r}=this.renderer,i=this.getStackLength();this.maskStack=t;const n=this.getStackLength();n!==i&&(n===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const og=new $t,ag=[],ua=class extends jm{constructor(e){super(e),this.glConst=J.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const t=e._scissorRect,{maskObject:r}=e,{renderer:i}=this,n=i.renderTexture,o=r.getBounds(!0,ag.pop()??new Tt);this.roundFrameToPixels(o,n.current?n.current.resolution:i.resolution,n.sourceFrame,n.destinationFrame,i.projection.transform),t&&o.fit(t),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:t,b:r,c:i,d:n}=e;return(Math.abs(r)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(n)>1e-4)}testScissor(e){const{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||ua.isMatrixRotated(t.worldTransform)||ua.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const r=e._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(e,t,r,i,n){ua.isMatrixRotated(n)||(n=n?og.copyFrom(n):og.identity(),n.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(n,e),e.fit(i),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:t}=this.renderer;e&&ag.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};let qm=ua;qm.extension={type:Z.RendererSystem,name:"scissor"};nt.add(qm);class Km extends jm{constructor(t){super(t),this.glConst=J.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const r=t.maskObject,{gl:i}=this.renderer,n=t._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;const o=t._colorMask;o!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,n,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,o!==0&&(t._colorMask=o,i.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)),this._useCurrent()}pop(t){const r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=i?i._colorMask:15;n!==0&&(i._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,n!==0&&(i._colorMask=n,r.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Km.extension={type:Z.RendererSystem,name:"stencil"};nt.add(Km);class Zm{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Ct("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return Ct("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return Ct("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(t){for(const r in t)this.plugins[r]=new t[r](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Zm.extension={type:[Z.RendererSystem,Z.CanvasRendererSystem],name:"_plugin"};nt.add(Zm);class Jm{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new $t,this.transform=null}update(t,r,i,n){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,n),this.transform&&this.projectionMatrix.append(this.transform);const o=this.renderer;o.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,o.globalUniforms.update(),o.shader.shader&&o.shader.syncUniformGroup(o.shader.shader.uniforms.globals)}calculateProjection(t,r,i,n){const o=this.projectionMatrix,l=n?-1:1;o.identity(),o.a=1/r.width*2,o.d=l*(1/r.height*2),o.tx=-1-r.x*o.a,o.ty=-l-r.y*o.d}setTransform(t){}destroy(){this.renderer=null}}Jm.extension={type:Z.RendererSystem,name:"projection"};nt.add(Jm);const UR=new gc;class Qm{constructor(t){this.renderer=t,this._tempMatrix=new $t}generateTexture(t,r){const{region:i,...n}=r||{},o=i||t.getLocalBounds(null,!0);o.width===0&&(o.width=1),o.height===0&&(o.height=1);const l=gi.create({width:o.width,height:o.height,...n});this._tempMatrix.tx=-o.x,this._tempMatrix.ty=-o.y;const h=t.transform;return t.transform=UR,this.renderer.render(t,{renderTexture:l,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=h,l}destroy(){}}Qm.extension={type:[Z.RendererSystem,Z.CanvasRendererSystem],name:"textureGenerator"};nt.add(Qm);const Ii=new Tt,ms=new Tt;class tv{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Tt,this.destinationFrame=new Tt,this.viewportFrame=new Tt}bind(t=null,r,i){const n=this.renderer;this.current=t;let o,l,h;t?(o=t.baseTexture,h=o.resolution,r||(Ii.width=t.frame.width,Ii.height=t.frame.height,r=Ii),i||(ms.x=t.frame.x,ms.y=t.frame.y,ms.width=r.width,ms.height=r.height,i=ms),l=o.framebuffer):(h=n.resolution,r||(Ii.width=n._view.screen.width,Ii.height=n._view.screen.height,r=Ii),i||(i=Ii,i.width=r.width,i.height=r.height));const u=this.viewportFrame;u.x=i.x*h,u.y=i.y*h,u.width=i.width*h,u.height=i.height*h,t||(u.y=n.view.height-(u.y+u.height)),u.ceil(),this.renderer.framebuffer.bind(l,u),this.renderer.projection.update(i,r,h,!l),t?this.renderer.mask.setMaskStack(o.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(i)}clear(t,r){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.renderer.background.colorRgba;const i=this.destinationFrame,n=this.current?this.current.baseTexture:this.renderer._view.screen,o=i.width!==n.width||i.height!==n.height;if(o){let{x:l,y:h,width:u,height:f}=this.viewportFrame;l=Math.round(l),h=Math.round(h),u=Math.round(u),f=Math.round(f),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,h,u,f)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],r),o&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}tv.extension={type:Z.RendererSystem,name:"renderTexture"};nt.add(tv);class GR{constructor(t,r){this.program=t,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function WR(e,t){const r={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){const o=t.getActiveAttrib(e,n);if(o.name.startsWith("gl_"))continue;const l=Om(t,o.type),h={type:l,name:o.name,size:Bm(l),location:t.getAttribLocation(e,o.name)};r[o.name]=h}return r}function $R(e,t){const r={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let n=0;n<i;n++){const o=t.getActiveUniform(e,n),l=o.name.replace(/\[.*?\]$/,""),h=!!o.name.match(/\[.*?\]$/),u=Om(t,o.type);r[l]={name:l,index:n,type:u,size:o.size,isArray:h,value:Mm(u,o.size)}}return r}function HR(e,t){var u;const r=Qp(e,e.VERTEX_SHADER,t.vertexSrc),i=Qp(e,e.FRAGMENT_SHADER,t.fragmentSrc),n=e.createProgram();e.attachShader(n,r),e.attachShader(n,i);const o=(u=t.extra)==null?void 0:u.transformFeedbackVaryings;if(o&&(typeof e.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(n,o.names,o.bufferMode==="separate"?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||yR(e,n,r,i),t.attributeData=WR(n,e),t.uniformData=$R(n,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const f=Object.keys(t.attributeData);f.sort((d,g)=>d>g?1:-1);for(let d=0;d<f.length;d++)t.attributeData[f[d]].location=d,e.bindAttribLocation(n,d,f[d]);e.linkProgram(n)}e.deleteShader(r),e.deleteShader(i);const l={};for(const f in t.uniformData){const d=t.uniformData[f];l[f]={location:e.getUniformLocation(n,f),value:Mm(d.type,d.size)}}return new GR(n,l)}function XR(e,t,r,i,n){r.buffer.update(n)}const zR={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},ev={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function VR(e){const t=e.map(o=>({data:o,offset:0,dataLen:0,dirty:0}));let r=0,i=0,n=0;for(let o=0;o<t.length;o++){const l=t[o];if(r=ev[l.data.type],l.data.size>1&&(r=Math.max(r,16)*l.data.size),l.dataLen=r,i%r!==0&&i<16){const h=i%r%16;i+=h,n+=h}i+r>16?(n=Math.ceil(n/16)*16,l.offset=n,n+=r,i=r):(l.offset=n,i+=r,n+=r)}return n=Math.ceil(n/16)*16,{uboElements:t,size:n}}function YR(e,t){const r=[];for(const i in e)t[i]&&r.push(t[i]);return r.sort((i,n)=>i.index-n.index),r}function jR(e,t){if(!e.autoManage)return{size:0,syncFunc:XR};const r=YR(e.uniforms,t),{uboElements:i,size:n}=VR(r),o=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let l=0;l<i.length;l++){const h=i[l],u=e.uniforms[h.data.name],f=h.data.name;let d=!1;for(let g=0;g<On.length;g++){const m=On[g];if(m.codeUbo&&m.test(h.data,u)){o.push(`offset = ${h.offset/4};`,On[g].codeUbo(h.data.name,u)),d=!0;break}}if(!d)if(h.data.size>1){const g=Bm(h.data.type),m=Math.max(ev[h.data.type]/16,1),v=g/m,_=(4-v%4)%4;o.push(`
                cv = ud.${f}.value;
                v = uv.${f};
                offset = ${h.offset/4};

                t = 0;

                for(var i=0; i < ${h.data.size*m}; i++)
                {
                    for(var j = 0; j < ${v}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${_};
                }

                `)}else{const g=zR[h.data.type];o.push(`
                cv = ud.${f}.value;
                v = uv.${f};
                offset = ${h.offset/4};
                ${g};
                `)}}return o.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join(`
`))}}let qR=0;const Yo={textureCount:0,uboCount:0};class rv{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=qR++}systemCheck(){if(!xR())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,r){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const i=t.program,n=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(n.program)),r||(Yo.textureCount=0,Yo.uboCount=0,this.syncUniformGroup(t.uniformGroup,Yo)),n}setUniforms(t){const r=this.shader.program,i=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,r){const i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,r))}syncUniforms(t,r,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(r.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){const r=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=gR(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[r],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,r){const i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;const n=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,r);t.buffer.update(),n(i.uniformData,t.uniforms,this.renderer,Yo,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[r])}createSyncBufferGroup(t,r,i){const{gl:n}=this.renderer;this.renderer.buffer.bind(t.buffer);const o=this.gl.getUniformBlockIndex(r.program,i);r.uniformBufferBindings[i]=this.shader.uniformBindCount,n.uniformBlockBinding(r.program,o,this.shader.uniformBindCount),this.shader.uniformBindCount++;const l=this.getSignature(t,this.shader.program.uniformData,"ubo");let h=this._uboCache[l];if(h||(h=this._uboCache[l]=jR(t,this.shader.program.uniformData)),t.autoManage){const u=new Float32Array(h.size/4);t.buffer.update(u)}return r.uniformGroups[t.id]=h.syncFunc,r.uniformGroups[t.id]}getSignature(t,r,i){const n=t.uniforms,o=[`${i}-`];for(const l in n)o.push(l),r[l]&&o.push(r[l].type);return o.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const r=this.gl,i=t.program,n=HR(r,i);return i.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}rv.extension={type:Z.RendererSystem,name:"shader"};nt.add(rv);class iv{constructor(t){this.renderer=t}run(t){const r=this.renderer;r.emitWithCustomOptions(r.runners.init,t),t.hello&&console.log(`PixiJS 7.1.0 - ${r.rendererLogId} - https://pixijs.com`),r.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}}iv.extension={type:[Z.RendererSystem,Z.CanvasRendererSystem],name:"startup"};nt.add(iv);function KR(e,t=[]){return t[ut.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.ADD]=[e.ONE,e.ONE],t[ut.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.NONE]=[0,0],t[ut.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[ut.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[ut.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[ut.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[ut.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[ut.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[ut.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[ut.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[ut.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[ut.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}const ZR=0,JR=1,QR=2,tM=3,eM=4,rM=5,Fu=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ut.NONE,this._blendEq=!1,this.map=[],this.map[ZR]=this.setBlend,this.map[JR]=this.setOffset,this.map[QR]=this.setCullFace,this.map[tM]=this.setDepthTest,this.map[eM]=this.setFrontFace,this.map[rM]=this.setDepthMask,this.checks=[],this.defaultState=new qr,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=KR(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,r=0;for(;t;)t&1&&this.map[r].call(this,!!(e.data&1<<r)),t=t>>1,r++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(Fu.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(Fu.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const t=this.blendModes[e],r=this.gl;t.length===2?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){const r=this.checks.indexOf(e);t&&r===-1?this.checks.push(e):!t&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let nv=Fu;nv.extension={type:Z.RendererSystem,name:"state"};nt.add(nv);class iM extends Ls{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const r=(t.priority??[]).filter(n=>t.systems[n]),i=[...r,...Object.keys(t.systems).filter(n=>!r.includes(n))];for(const n of i)this.addSystem(t.systems[n],n)}addRunners(...t){t.forEach(r=>{this.runners[r]=new gr(r)})}addSystem(t,r){const i=new t(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=i,this._systemsHash[r]=i;for(const n in this.runners)this.runners[n].add(i);return this}emitWithCustomOptions(t,r){const i=Object.keys(this._systemsHash);t.items.forEach(n=>{const o=i.find(l=>this._systemsHash[l]===n);n[t.name](r[o])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const ca=class{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=ca.defaultMaxIdle,this.checkCountMax=ca.defaultCheckCountMax,this.mode=ca.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==ec.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,t=e.managedTextures;let r=!1;for(let i=0;i<t.length;i++){const n=t[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[i]=null,r=!0)}if(r){let i=0;for(let n=0;n<t.length;n++)t[n]!==null&&(t[i++]=t[n]);t.length=i}}unload(e){const t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}};let cr=ca;cr.defaultMode=ec.AUTO;cr.defaultMaxIdle=60*60;cr.defaultCheckCountMax=60*10;cr.extension={type:Z.RendererSystem,name:"textureGC"};nt.add(cr);class Hh{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=st.UNSIGNED_BYTE,this.internalFormat=V.RGBA,this.samplerType=0}}function nM(e){let t;return"WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?t={[st.UNSIGNED_BYTE]:{[V.RGBA]:e.RGBA8,[V.RGB]:e.RGB8,[V.RG]:e.RG8,[V.RED]:e.R8,[V.RGBA_INTEGER]:e.RGBA8UI,[V.RGB_INTEGER]:e.RGB8UI,[V.RG_INTEGER]:e.RG8UI,[V.RED_INTEGER]:e.R8UI,[V.ALPHA]:e.ALPHA,[V.LUMINANCE]:e.LUMINANCE,[V.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[st.BYTE]:{[V.RGBA]:e.RGBA8_SNORM,[V.RGB]:e.RGB8_SNORM,[V.RG]:e.RG8_SNORM,[V.RED]:e.R8_SNORM,[V.RGBA_INTEGER]:e.RGBA8I,[V.RGB_INTEGER]:e.RGB8I,[V.RG_INTEGER]:e.RG8I,[V.RED_INTEGER]:e.R8I},[st.UNSIGNED_SHORT]:{[V.RGBA_INTEGER]:e.RGBA16UI,[V.RGB_INTEGER]:e.RGB16UI,[V.RG_INTEGER]:e.RG16UI,[V.RED_INTEGER]:e.R16UI,[V.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[st.SHORT]:{[V.RGBA_INTEGER]:e.RGBA16I,[V.RGB_INTEGER]:e.RGB16I,[V.RG_INTEGER]:e.RG16I,[V.RED_INTEGER]:e.R16I},[st.UNSIGNED_INT]:{[V.RGBA_INTEGER]:e.RGBA32UI,[V.RGB_INTEGER]:e.RGB32UI,[V.RG_INTEGER]:e.RG32UI,[V.RED_INTEGER]:e.R32UI,[V.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[st.INT]:{[V.RGBA_INTEGER]:e.RGBA32I,[V.RGB_INTEGER]:e.RGB32I,[V.RG_INTEGER]:e.RG32I,[V.RED_INTEGER]:e.R32I},[st.FLOAT]:{[V.RGBA]:e.RGBA32F,[V.RGB]:e.RGB32F,[V.RG]:e.RG32F,[V.RED]:e.R32F,[V.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[st.HALF_FLOAT]:{[V.RGBA]:e.RGBA16F,[V.RGB]:e.RGB16F,[V.RG]:e.RG16F,[V.RED]:e.R16F},[st.UNSIGNED_SHORT_5_6_5]:{[V.RGB]:e.RGB565},[st.UNSIGNED_SHORT_4_4_4_4]:{[V.RGBA]:e.RGBA4},[st.UNSIGNED_SHORT_5_5_5_1]:{[V.RGBA]:e.RGB5_A1},[st.UNSIGNED_INT_2_10_10_10_REV]:{[V.RGBA]:e.RGB10_A2,[V.RGBA_INTEGER]:e.RGB10_A2UI},[st.UNSIGNED_INT_10F_11F_11F_REV]:{[V.RGB]:e.R11F_G11F_B10F},[st.UNSIGNED_INT_5_9_9_9_REV]:{[V.RGB]:e.RGB9_E5},[st.UNSIGNED_INT_24_8]:{[V.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[st.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[V.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:t={[st.UNSIGNED_BYTE]:{[V.RGBA]:e.RGBA,[V.RGB]:e.RGB,[V.ALPHA]:e.ALPHA,[V.LUMINANCE]:e.LUMINANCE,[V.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[st.UNSIGNED_SHORT_5_6_5]:{[V.RGB]:e.RGB},[st.UNSIGNED_SHORT_4_4_4_4]:{[V.RGBA]:e.RGBA},[st.UNSIGNED_SHORT_5_5_5_1]:{[V.RGBA]:e.RGBA}},t}class sv{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new gt,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=nM(t);const r=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let n=0;n<r;n++)this.boundTextures[n]=null;this.emptyTextures={};const i=new Hh(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Hh(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let n=0;n<this.boundTextures.length;n++)this.bind(null,n)}bind(t,r=0){const{gl:i}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const n=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[r]!==t&&(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(t.target,n.texture)),n.dirtyId!==t.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),this.updateTexture(t)):n.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[r]=t}else this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:r,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let n=0;n<i.length;n++)i[n]===this.unknownTexture&&this.bind(null,n)}for(let n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(r.activeTexture(r.TEXTURE0+n),this.currentLocation=n),r.bindTexture(t.target,this.emptyTextures[t.target].texture),i[n]=null)}ensureSamplerType(t){const{boundTextures:r,hasIntegerTextures:i,CONTEXT_UID:n}=this;if(i)for(let o=t-1;o>=0;--o){const l=r[o];l&&l._glTextures[n].samplerType!==du.FLOAT&&this.renderer.texture.unbind(l)}}initTexture(t){const r=new Hh(this.gl.createTexture());return r.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),r}initTextureType(t,r){var i;r.internalFormat=((i=this.internalFormats[t.type])==null?void 0:i[t.format])??t.format,this.webGLVersion===2&&t.type===st.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=t.type}updateTexture(t){var n;const r=t._glTextures[this.CONTEXT_UID];if(!r)return;const i=this.renderer;if(this.initTextureType(t,r),(n=t.resource)!=null&&n.upload(i,t,r))r.samplerType!==du.FLOAT&&(this.hasIntegerTextures=!0);else{const o=t.realWidth,l=t.realHeight,h=i.gl;(r.width!==o||r.height!==l||r.dirtyId<0)&&(r.width=o,r.height=l,h.texImage2D(t.target,0,r.internalFormat,o,l,0,t.format,r.type,null))}t.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(t),r.dirtyId=t.dirtyId}destroyTexture(t,r){const{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!r)){const n=this.managedTextures.indexOf(t);n!==-1&&Dn(this.managedTextures,n,1)}}updateTextureStyle(t){var i;const r=t._glTextures[this.CONTEXT_UID];r&&((t.mipmap===Dr.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?r.mipmap=!1:r.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?r.wrapMode=ci.CLAMP:r.wrapMode=t.wrapMode,(i=t.resource)!=null&&i.style(this.renderer,t,r)||this.setStyle(t,r),r.dirtyStyleId=t.dirtyStyleId)}setStyle(t,r){const i=this.gl;if(r.mipmap&&t.mipmap!==Dr.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,r.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===zr.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const n=this.renderer.context.extensions.anisotropicFiltering;if(n&&t.anisotropicLevel>0&&t.scaleMode===zr.LINEAR){const o=Math.min(t.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,n.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===zr.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===zr.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}sv.extension={type:Z.RendererSystem,name:"texture"};nt.add(sv);class ov{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:r,CONTEXT_UID:i}=this,n=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,r){const{gl:i,renderer:n}=this;r&&n.shader.bind(r),i.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:r,renderer:i,CONTEXT_UID:n}=this,o=r.createTransformFeedback();t._glTransformFeedbacks[n]=o,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,o);for(let l=0;l<t.buffers.length;l++){const h=t.buffers[l];h&&(i.buffer.update(h),h._glBuffers[n].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,l,h._glBuffers[n].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),o}disposeTransformFeedback(t,r){const i=t._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this);const o=this.renderer.buffer;if(o)for(let l=0;l<t.buffers.length;l++){const h=t.buffers[l];if(!h)continue;const u=h._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!r&&o.dispose(h,r))}i&&(r||n.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}ov.extension={type:Z.RendererSystem,name:"transformFeedback"};nt.add(ov);class av{constructor(t){this.renderer=t}init(t){this.screen=new Tt(0,0,t.width,t.height),this.element=t.view||J.ADAPTER.createCanvas(),this.resolution=t.resolution||J.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,r){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(r*this.resolution);const i=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=i,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",i,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var r;t&&((r=this.element.parentNode)==null||r.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}av.extension={type:[Z.RendererSystem,Z.CanvasRendererSystem],name:"_view"};nt.add(av);J.PREFER_ENV=qi.WEBGL2;J.STRICT_TEXTURE_CACHE=!1;Object.defineProperties(J,{WRAP_MODE:{get(){return gt.defaultOptions.wrapMode},set(e){Ct("7.1.0","settings.WRAP_MODE is deprecated, use BaseTeture.defaultOptions.wrapMode"),gt.defaultOptions.wrapMode=e}},SCALE_MODE:{get(){return gt.defaultOptions.scaleMode},set(e){Ct("7.1.0","settings.SCALE_MODE is deprecated, use BaseTeture.defaultOptions.scaleMode"),gt.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get(){return gt.defaultOptions.mipmap},set(e){Ct("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTeture.defaultOptions.mipmap"),gt.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get(){return gt.defaultOptions.anisotropicLevel},set(e){Ct("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTeture.defaultOptions.anisotropicLevel"),gt.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get(){return Ct("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Ae.defaultResolution},set(e){Ae.defaultResolution=e}},FILTER_MULTISAMPLE:{get(){return Ct("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Ae.defaultMultisample},set(e){Ae.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get(){return ur.defaultMaxTextures},set(e){Ct("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),ur.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get(){return ur.defaultBatchSize},set(e){Ct("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),ur.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get(){return ur.canUploadSameBuffer},set(e){Ct("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),ur.canUploadSameBuffer=e}},GC_MODE:{get(){return cr.defaultMode},set(e){Ct("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),cr.defaultMode=e}},GC_MAX_IDLE:{get(){return cr.defaultMaxIdle},set(e){Ct("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),cr.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get(){return cr.defaultCheckCountMax},set(e){Ct("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),cr.defaultCheckCountMax=e}},PRECISION_VERTEX:{get(){return fr.defaultVertexPrecision},set(e){Ct("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),fr.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get(){return fr.defaultFragmentPrecision},set(e){Ct("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),fr.defaultFragmentPrecision=e}}});var kn=(e=>(e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(kn||{});class Xh{constructor(t,r=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=r,this.priority=i,this.once=n}match(t,r=null){return this.fn===t&&this.context===r}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=t?null:r,this.previous=null,r}}const ke=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Xh(null,null,1/0),this.deltaMS=1/ke.targetFPMS,this.elapsedMS=1/ke.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,r=kn.NORMAL){return this._addListener(new Xh(e,t,r))}addOnce(e,t,r=kn.NORMAL){return this._addListener(new Xh(e,t,r,!0))}_addListener(e){let t=this._head.next,r=this._head;if(!t)e.connect(r);else{for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}return this._startIfPossible(),this}remove(e,t){let r=this._head.next;for(;r;)r.match(e,t)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const n=e-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=e-n%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*ke.targetFPMS;const r=this._head;let i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,t)/1e3,ke.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!ke._shared){const e=ke._shared=new ke;e.autoStart=!0,e._protected=!0}return ke._shared}static get system(){if(!ke._system){const e=ke._system=new ke;e.autoStart=!0,e._protected=!0}return ke._system}};let Me=ke;Me.targetFPMS=.06;Object.defineProperties(J,{TARGET_FPMS:{get(){return Me.targetFPMS},set(e){Ct("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Me.targetFPMS=e}}});class lv{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,kn.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Me.shared:new Me,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}lv.extension=Z.Application;nt.add(lv);const hv=[];nt.handleByList(Z.Renderer,hv);function sM(e){for(const t of hv)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}var oM=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,aM=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const lM=oM,uv=aM;class cv{constructor(t){this.renderer=t}contextChange(t){let r;if(this.renderer.context.webGLVersion===1){const i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),r=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{const i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),r=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}r>=se.HIGH?this.multisample=se.HIGH:r>=se.MEDIUM?this.multisample=se.MEDIUM:r>=se.LOW?this.multisample=se.LOW:this.multisample=se.NONE}destroy(){}}cv.extension={type:Z.RendererSystem,name:"_multisample"};nt.add(cv);class hM{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class fv{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:r,CONTEXT_UID:i}=this,n=t._glBuffers[i]||this.createGLBuffer(t);r.bindBuffer(t.type,n.buffer)}unbind(t){const{gl:r}=this;r.bindBuffer(t,null)}bindBufferBase(t,r){const{gl:i,CONTEXT_UID:n}=this;if(this.boundBufferBases[r]!==t){const o=t._glBuffers[n]||this.createGLBuffer(t);this.boundBufferBases[r]=t,i.bindBufferBase(i.UNIFORM_BUFFER,r,o.buffer)}}bindBufferRange(t,r,i){const{gl:n,CONTEXT_UID:o}=this;i=i||0;const l=t._glBuffers[o]||this.createGLBuffer(t);n.bindBufferRange(n.UNIFORM_BUFFER,r||0,l.buffer,i*256,256)}update(t){const{gl:r,CONTEXT_UID:i}=this,n=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==n.updateID)if(n.updateID=t._updateID,r.bindBuffer(t.type,n.buffer),n.byteLength>=t.data.byteLength)r.bufferSubData(t.type,0,t.data);else{const o=t.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;n.byteLength=t.data.byteLength,r.bufferData(t.type,t.data,o)}}dispose(t,r){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const i=t._glBuffers[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this),i&&(r||n.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const r=Object.keys(this.managedBuffers);for(let i=0;i<r.length;i++)this.dispose(this.managedBuffers[r[i]],t)}createGLBuffer(t){const{CONTEXT_UID:r,gl:i}=this;return t._glBuffers[r]=new hM(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[r]}}fv.extension={type:Z.RendererSystem,name:"buffer"};nt.add(fv);class dv{constructor(t){this.renderer=t}render(t,r){const i=this.renderer;let n,o,l,h;if(r&&(n=r.renderTexture,o=r.clear,l=r.transform,h=r.skipUpdateTransform),this.renderingToScreen=!n,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=l,!i.context.isLost){if(n||(this.lastObjectRendered=t),!h){const u=t.enableTempParent();t.updateTransform(),t.disableTempParent(u)}i.renderTexture.bind(n),i.batch.currentRenderer.start(),(o??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),n&&(r.blit&&i.framebuffer.blit(),n.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}dv.extension={type:Z.RendererSystem,name:"objectRenderer"};nt.add(dv);const Lu=class extends iM{constructor(e){super(),e=Object.assign({},J.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new mr({projectionMatrix:new $t},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Lu.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(Ct("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha);const r={hello:e.hello,_plugin:Lu.__plugins,background:{alpha:e.backgroundAlpha,color:e.background??e.backgroundColor,clearBeforeRender:e.clearBeforeRender},_view:{height:e.height,width:e.width,autoDensity:e.autoDensity,resolution:e.resolution,view:e.view},context:{antialias:e.antialias,context:e.context,powerPreference:e.powerPreference,premultipliedAlpha:e.premultipliedAlpha,preserveDrawingBuffer:e.preserveDrawingBuffer}};this.startup.run(r),this.options=e}static test(e){return e!=null&&e.forceCanvas?!1:nC()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Ct("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Ct("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Ct("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Ct("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){Ct("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return Ct("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.color}set backgroundAlpha(e){Ct("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return Ct("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};let Vn=Lu;Vn.extension={type:Z.Renderer,priority:1};Vn.__plugins={};Vn.__systems={};nt.handleByMap(Z.RendererPlugin,Vn.__plugins);nt.handleByMap(Z.RendererSystem,Vn.__systems);nt.add(Vn);class pv extends Ds{constructor(t,r){const{width:i,height:n}=r||{};super(i,n),this.items=[],this.itemDirtyIds=[];for(let o=0;o<t;o++){const l=new gt;this.items.push(l),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,r){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof Ds?this.addResourceAt(t[i],i):this.addResourceAt(Cm(t[i],r),i))}dispose(){for(let t=0,r=this.length;t<r;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[r].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)}unbind(t){super.unbind(t);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)}load(){if(this._load)return this._load;const r=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(r).then(()=>{const{realWidth:i,realHeight:n}=this.items[0];return this.resize(i,n),Promise.resolve(this)}),this._load}}class uM extends pv{constructor(t,r){const{width:i,height:n}=r||{};let o,l;Array.isArray(t)?(o=t,l=t.length):l=t,super(l,{width:i,height:n}),o&&this.initFromArray(o,r)}addBaseTextureAt(t,r){if(t.resource)this.addResourceAt(t.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Pn.TEXTURE_2D_ARRAY}upload(t,r,i){const{length:n,itemDirtyIds:o,items:l}=this,{gl:h}=t;i.dirtyId<0&&h.texImage3D(h.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,n,0,r.format,i.type,null);for(let u=0;u<n;u++){const f=l[u];o[u]<f.dirtyId&&(o[u]=f.dirtyId,f.valid&&h.texSubImage3D(h.TEXTURE_2D_ARRAY,0,0,0,u,f.resource.width,f.resource.height,1,r.format,i.type,f.resource.source))}return!0}}class cM extends pi{constructor(t){super(t)}static test(t){const{OffscreenCanvas:r}=globalThis;return r&&t instanceof r?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const xs=class extends pv{constructor(e,t){const{width:r,height:i,autoLoad:n,linkBaseTexture:o}=t||{};if(e&&e.length!==xs.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:r,height:i});for(let l=0;l<xs.SIDES;l++)this.items[l].target=Pn.TEXTURE_CUBE_MAP_POSITIVE_X+l;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,t),n!==!1&&this.load()}bind(e){super.bind(e),e.target=Pn.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Pn.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,r){const i=this.itemDirtyIds;for(let n=0;n<xs.SIDES;n++){const o=this.items[n];(i[n]<o.dirtyId||r.dirtyId<t.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,r),i[n]=o.dirtyId):i[n]<-1&&(e.gl.texImage2D(o.target,0,r.internalFormat,t.realWidth,t.realHeight,0,t.format,r.type,null),i[n]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===xs.SIDES}};let gv=xs;gv.SIDES=6;class Sn extends pi{constructor(t,r){var i=(...n)=>{super(...n)};r=r||{},typeof t=="string"?(i(Sn.EMPTY),this.url=t):(i(t),this.url=null),this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,r)=>{if(this.url===null){t(this);return}try{const i=await J.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const n=await i.blob();if(this.destroyed)return;const o=await createImageBitmap(n,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===vr.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=o,this.update(),t(this)}catch(i){if(this.destroyed)return;r(i),this.onError.emit(i)}}),this._load)}upload(t,r,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(t,r,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return Sn._EMPTY=Sn._EMPTY??J.ADAPTER.createCanvas(0,0),Sn._EMPTY}}const fa=class extends pi{constructor(e,t){t=t||{},super(J.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),e(this)},fa.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;pi.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;const t=e.width,r=e.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=t*this.scale,n=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/r*t,n=this._overrideHeight||this._overrideWidth/t*r),i=Math.round(i),n=Math.round(n);const o=this.source;o.width=i,o.height=n,o._pixiId=`canvas_${zi()}`,o.getContext("2d").drawImage(e,0,0,t,r,0,0,i,n),this._resolve(),this._resolve=null}}static getSize(e){const t=fa.SVG_SIZE.exec(e),r={};return t&&(r[t[1]]=Math.round(parseFloat(t[3])),r[t[5]]=Math.round(parseFloat(t[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&fa.SVG_XML.test(e)}};let Bs=fa;Bs.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;Bs.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const Nu=class extends pi{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){const r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);const i=e[0].src||e[0];pi.crossOrigin(r,i,t.crossorigin);for(let n=0;n<e.length;++n){const o=document.createElement("source");let{src:l,mime:h}=e[n];l=l||e[n];const u=l.split("?").shift().toLowerCase(),f=u.slice(u.lastIndexOf(".")+1);h=h||Nu.MIME_TYPES[f]||`video/${f}`,o.src=l,o.type=h,r.appendChild(o)}e=r}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){const t=Me.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Me.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Me.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._isConnectedToTicker&&(Me.shared.remove(this.update,this),this._isConnectedToTicker=!1);const e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Me.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Me.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e)}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||Nu.TYPES.includes(t)}};let mc=Nu;mc.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];mc.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Ru.push(Sn,Um,cM,mc,Bs,Us,gv,uM);class Ia{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?Tt.EMPTY:(t=t||new Tt(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,r){const{a:i,b:n,c:o,d:l,tx:h,ty:u}=t,f=i*r.x+o*r.y+h,d=n*r.x+l*r.y+u;this.minX=Math.min(this.minX,f),this.maxX=Math.max(this.maxX,f),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)}addQuad(t){let r=this.minX,i=this.minY,n=this.maxX,o=this.maxY,l=t[0],h=t[1];r=l<r?l:r,i=h<i?h:i,n=l>n?l:n,o=h>o?h:o,l=t[2],h=t[3],r=l<r?l:r,i=h<i?h:i,n=l>n?l:n,o=h>o?h:o,l=t[4],h=t[5],r=l<r?l:r,i=h<i?h:i,n=l>n?l:n,o=h>o?h:o,l=t[6],h=t[7],r=l<r?l:r,i=h<i?h:i,n=l>n?l:n,o=h>o?h:o,this.minX=r,this.minY=i,this.maxX=n,this.maxY=o}addFrame(t,r,i,n,o){this.addFrameMatrix(t.worldTransform,r,i,n,o)}addFrameMatrix(t,r,i,n,o){const l=t.a,h=t.b,u=t.c,f=t.d,d=t.tx,g=t.ty;let m=this.minX,v=this.minY,_=this.maxX,w=this.maxY,x=l*r+u*i+d,A=h*r+f*i+g;m=x<m?x:m,v=A<v?A:v,_=x>_?x:_,w=A>w?A:w,x=l*n+u*i+d,A=h*n+f*i+g,m=x<m?x:m,v=A<v?A:v,_=x>_?x:_,w=A>w?A:w,x=l*r+u*o+d,A=h*r+f*o+g,m=x<m?x:m,v=A<v?A:v,_=x>_?x:_,w=A>w?A:w,x=l*n+u*o+d,A=h*n+f*o+g,m=x<m?x:m,v=A<v?A:v,_=x>_?x:_,w=A>w?A:w,this.minX=m,this.minY=v,this.maxX=_,this.maxY=w}addVertexData(t,r,i){let n=this.minX,o=this.minY,l=this.maxX,h=this.maxY;for(let u=r;u<i;u+=2){const f=t[u],d=t[u+1];n=f<n?f:n,o=d<o?d:o,l=f>l?f:l,h=d>h?d:h}this.minX=n,this.minY=o,this.maxX=l,this.maxY=h}addVertices(t,r,i,n){this.addVerticesMatrix(t.worldTransform,r,i,n)}addVerticesMatrix(t,r,i,n,o=0,l=o){const h=t.a,u=t.b,f=t.c,d=t.d,g=t.tx,m=t.ty;let v=this.minX,_=this.minY,w=this.maxX,x=this.maxY;for(let A=i;A<n;A+=2){const S=r[A],E=r[A+1],I=h*S+f*E+g,D=d*E+u*S+m;v=Math.min(v,I-o),w=Math.max(w,I+o),_=Math.min(_,D-l),x=Math.max(x,D+l)}this.minX=v,this.minY=_,this.maxX=w,this.maxY=x}addBounds(t){const r=this.minX,i=this.minY,n=this.maxX,o=this.maxY;this.minX=t.minX<r?t.minX:r,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>o?t.maxY:o}addBoundsMask(t,r){const i=t.minX>r.minX?t.minX:r.minX,n=t.minY>r.minY?t.minY:r.minY,o=t.maxX<r.maxX?t.maxX:r.maxX,l=t.maxY<r.maxY?t.maxY:r.maxY;if(i<=o&&n<=l){const h=this.minX,u=this.minY,f=this.maxX,d=this.maxY;this.minX=i<h?i:h,this.minY=n<u?n:u,this.maxX=o>f?o:f,this.maxY=l>d?l:d}}addBoundsMatrix(t,r){this.addFrameMatrix(r,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,r){const i=t.minX>r.x?t.minX:r.x,n=t.minY>r.y?t.minY:r.y,o=t.maxX<r.x+r.width?t.maxX:r.x+r.width,l=t.maxY<r.y+r.height?t.maxY:r.y+r.height;if(i<=o&&n<=l){const h=this.minX,u=this.minY,f=this.maxX,d=this.maxY;this.minX=i<h?i:h,this.minY=n<u?n:u,this.maxX=o>f?o:f,this.maxY=l>d?l:d}}pad(t=0,r=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=r,this.maxY+=r)}addFramePad(t,r,i,n,o,l){t-=o,r-=l,i+=o,n+=l,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>n?this.maxY:n}}class Vt extends Ls{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new gc,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Ia,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const r=Object.keys(t);for(let i=0;i<r.length;++i){const n=r[i];Object.defineProperty(Vt.prototype,n,Object.getOwnPropertyDescriptor(t,n))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,r){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new Tt),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new Tt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Ia);const r=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const n=this._bounds,o=this._boundsID;this._bounds=this._localBounds;const l=this.getBounds(!1,t);return this.parent=i,this.transform=r,this._bounds=n,this._bounds.updateID+=this._boundsID-o,l}toGlobal(t,r,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,r)}toLocal(t,r,i,n){return r&&(t=r.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,r=0,i=1,n=1,o=0,l=0,h=0,u=0,f=0){return this.position.x=t,this.position.y=r,this.scale.x=i||1,this.scale.y=n||1,this.rotation=o,this.skew.x=l,this.skew.y=h,this.pivot.x=u,this.pivot.y=f,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new fM),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*lR}set angle(t){this.transform.rotation=t*hR}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=t,this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}}class fM extends Vt{constructor(){super(...arguments),this.sortDirty=null}}Vt.prototype.displayObjectUpdateTransform=Vt.prototype.updateTransform;const dM=new $t;function pM(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}const ku=class extends Vt{constructor(){super(),this.children=[],this.sortableChildren=ku.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{const t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;const r=this.getChildIndex(e),i=this.getChildIndex(t);this.children[r]=t,this.children[i]=e,this.onChildrenChange(r<i?r:i)}getChildIndex(e){const t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const r=this.getChildIndex(e);Dn(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{const t=e[0],r=this.children.indexOf(t);if(r===-1)return null;t.parent=null,t.transform._parentID=-1,Dn(this.children,r,1),this._boundsID++,this.onChildrenChange(r),t.emit("removed",this),this.emit("childRemoved",t,this,r)}return e[0]}removeChildAt(e){const t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,Dn(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){const r=e,i=t,n=i-r;let o;if(n>0&&n<=i){o=this.children.splice(r,n);for(let l=0;l<o.length;++l)o[l].parent=null,o[l].transform&&(o[l].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let l=0;l<o.length;++l)o[l].emit("removed",this),this.emit("childRemoved",o[l],this,l);return o}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,r=this.children.length;t<r;++t){const i=this.children[t];i._lastSortedIndex=t,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(pM),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){const r=this.children[e];r.visible&&r.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const r=t._mask.isMaskData?t._mask.maskObject:t._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(t._bounds,r._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){const r=super.getLocalBounds(e);if(!t)for(let i=0,n=this.children.length;i<n;++i){const o=this.children[i];o.visible&&o.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(e){const t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let r,i;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==ku.prototype._render&&(r=this.getBounds(!0));const n=e.projection.transform;if(n&&(i?(i=dM.copyFrom(i),i.prepend(n)):i=n),r&&t.intersects(r,i))this._render(e);else if(this.cullArea)return;for(let o=0,l=this.children.length;o<l;++o){const h=this.children[o],u=h.cullable;h.cullable=u||!this.cullArea,h.render(e),h.cullable=u}}render(e){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let r=0,i=this.children.length;r<i;++r)this.children[r].render(e)}}renderAdvanced(e){var n,o,l;const t=this.filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let h=0;h<t.length;h++)t[h].enabled&&this._enabledFilters.push(t[h])}const i=t&&((n=this._enabledFilters)==null?void 0:n.length)||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==ue.NONE));if(i&&e.batch.flush(),t&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let h=0,u=this.children.length;h<u;++h)this.children[h].render(e)}i&&e.batch.flush(),r&&e.mask.pop(this),t&&((l=this._enabledFilters)!=null&&l.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const t=typeof e=="boolean"?e:e==null?void 0:e.children,r=this.removeChildren(0,this.children.length);if(t)for(let i=0;i<r.length;++i)r[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}};let Ge=ku;Ge.defaultSortableChildren=!1;Ge.prototype.containerUpdateTransform=Ge.prototype.updateTransform;Object.defineProperties(J,{SORTABLE_CHILDREN:{get(){return Ge.defaultSortableChildren},set(e){Ct("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Ge.defaultSortableChildren=e}}});const vs=new St,gM=new Uint16Array([0,1,2,0,2,3]);class Yn extends Ge{constructor(t){super(),this._anchor=new ui(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=ut.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||it.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=gM,this.pluginName="batch",this.isSprite=!0,this._roundPixels=J.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=An(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=An(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const r=this.transform.worldTransform,i=r.a,n=r.b,o=r.c,l=r.d,h=r.tx,u=r.ty,f=this.vertexData,d=t.trim,g=t.orig,m=this._anchor;let v=0,_=0,w=0,x=0;if(d?(_=d.x-m._x*g.width,v=_+d.width,x=d.y-m._y*g.height,w=x+d.height):(_=-m._x*g.width,v=_+g.width,x=-m._y*g.height,w=x+g.height),f[0]=i*_+o*x+h,f[1]=l*x+n*_+u,f[2]=i*v+o*x+h,f[3]=l*x+n*v+u,f[4]=i*v+o*w+h,f[5]=l*w+n*v+u,f[6]=i*_+o*w+h,f[7]=l*w+n*_+u,this._roundPixels){const A=J.RESOLUTION;for(let S=0;S<f.length;++S)f[S]=Math.round(f[S]*A)/A}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,r=this.vertexTrimmedData,i=t.orig,n=this._anchor,o=this.transform.worldTransform,l=o.a,h=o.b,u=o.c,f=o.d,d=o.tx,g=o.ty,m=-n._x*i.width,v=m+i.width,_=-n._y*i.height,w=_+i.height;r[0]=l*m+u*_+d,r[1]=f*_+h*m+g,r[2]=l*v+u*_+d,r[3]=f*_+h*v+g,r[4]=l*v+u*w+d,r[5]=f*w+h*v+g,r[6]=l*m+u*w+d,r[7]=f*w+h*m+g}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,r=this._texture.orig;!t||t.width===r.width&&t.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Ia),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Tt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,vs);const r=this._texture.orig.width,i=this._texture.orig.height,n=-r*this.anchor.x;let o=0;return vs.x>=n&&vs.x<n+r&&(o=-i*this.anchor.y,vs.y>=o&&vs.y<o+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!i)}this._texture=null}static from(t,r){const i=t instanceof it?t:it.from(t,r);return new Yn(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const r=An(this.scale.x)||1;this.scale.x=r*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const r=An(this.scale.y)||1;this.scale.y=r*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tint}set tint(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||it.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const mv=new $t;Vt.prototype._cacheAsBitmap=!1;Vt.prototype._cacheData=null;Vt.prototype._cacheAsBitmapResolution=null;Vt.prototype._cacheAsBitmapMultisample=null;class mM{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Vt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){if(this._cacheAsBitmap===e)return;this._cacheAsBitmap=e;let t;e?(this._cacheData||(this._cacheData=new mM),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});Vt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Vt.prototype._initCachedDisplayObject=function(t){var m,v;if((m=this._cacheData)!=null&&m.sprite)return;const r=this.alpha;this.alpha=1,t.batch.flush();const i=this.getLocalBounds(null,!0).clone();if((v=this.filters)!=null&&v.length){const _=this.filters[0].padding;i.pad(_)}i.ceil(J.RESOLUTION);const n=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),l=t.renderTexture.destinationFrame.clone(),h=t.projection.transform,u=gi.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),f=`cacheAsBitmap_${zi()}`;this._cacheData.textureCacheId=f,gt.addToCache(u.baseTexture,f),it.addToCache(u,f);const d=this.transform.localTransform.copyTo(mv).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:u,clear:!0,transform:d,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=h,t.renderTexture.bind(n,o,l),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const g=new Yn(u);g.transform.worldTransform=this.transform.worldTransform,g.anchor.x=-(i.x/i.width),g.anchor.y=-(i.y/i.height),g.alpha=r,g._bounds=this._bounds,this._cacheData.sprite=g,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=g.containsPoint.bind(g)};Vt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Vt.prototype._initCachedDisplayObjectCanvas=function(t){var d;if((d=this._cacheData)!=null&&d.sprite)return;const r=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;const n=t.canvasContext.activeContext,o=t._projTransform;r.ceil(J.RESOLUTION);const l=gi.create({width:r.width,height:r.height}),h=`cacheAsBitmap_${zi()}`;this._cacheData.textureCacheId=h,gt.addToCache(l.baseTexture,h),it.addToCache(l,h);const u=mv;this.transform.localTransform.copyTo(u),u.invert(),u.tx-=r.x,u.ty-=r.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:l,clear:!0,transform:u,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=o,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;const f=new Yn(l);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-(r.x/r.width),f.anchor.y=-(r.y/r.height),f.alpha=i,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=f.containsPoint.bind(f)};Vt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Vt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Vt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,gt.removeFromCache(this._cacheData.textureCacheId),it.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Vt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Vt.prototype.name=null;Ge.prototype.getChildByName=function(t,r){for(let i=0,n=this.children.length;i<n;i++)if(this.children[i].name===t)return this.children[i];if(r)for(let i=0,n=this.children.length;i<n;i++){const o=this.children[i];if(!o.getChildByName)continue;const l=o.getChildByName(t,!0);if(l)return l}return null};Vt.prototype.getGlobalPosition=function(t=new St,r=!1){return this.parent?this.parent.toGlobal(this.position,t,r):(t.x=this.position.x,t.y=this.position.y),t};var vM=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class yM extends Ae{constructor(t=1){super(lM,vM,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const _M={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},xM=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function bM(e){const t=_M[e],r=t.length;let i=xM,n="";const o="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let l;for(let h=0;h<e;h++){let u=o.replace("%index%",h.toString());l=h,h>=r&&(l=e-h-1),u=u.replace("%value%",t[l].toString()),n+=u,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",e.toString()),i}const wM=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function EM(e,t){const r=Math.ceil(e/2);let i=wM,n="",o;t?o="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":o="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let l=0;l<e;l++){let h=o.replace("%index%",l.toString());h=h.replace("%sampleIndex%",`${l-(r-1)}.0`),n+=h,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",e.toString()),i}class Uu extends Ae{constructor(t,r=8,i=4,n=J.FILTER_RESOLUTION,o=5){const l=EM(o,t),h=bM(o);super(l,h),this.horizontal=t,this.resolution=n,this._quality=0,this.quality=i,this.blur=r}apply(t,r,i,n){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/r.width):this.uniforms.strength=1/i.height*(i.height/r.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/r.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,r,i,n);else{const o=t.getFilterTexture(),l=t.renderer;let h=r,u=o;this.state.blend=!1,t.applyFilter(this,h,u,Sr.CLEAR);for(let f=1;f<this.passes-1;f++){t.bindAndClear(h,Sr.BLIT),this.uniforms.uSampler=u;const d=u;u=h,h=d,l.shader.bind(this),l.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,u,i,n),t.returnFilterTexture(o)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class TM extends Ae{constructor(t=8,r=4,i=Ae.defaultResolution,n=5){super(),this.blurXFilter=new Uu(!0,t,r,i,n),this.blurYFilter=new Uu(!1,t,r,i,n),this.resolution=i,this.quality=r,this.blur=t,this.repeatEdgePixels=!1}apply(t,r,i,n){const o=Math.abs(this.blurXFilter.strength),l=Math.abs(this.blurYFilter.strength);if(o&&l){const h=t.getFilterTexture();this.blurXFilter.apply(t,r,h,Sr.CLEAR),this.blurYFilter.apply(t,h,i,n),t.returnFilterTexture(h)}else l?this.blurYFilter.apply(t,r,i,n):this.blurXFilter.apply(t,r,i,n)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var AM=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Gu extends Ae{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(uv,AM,t),this.alpha=1}_loadMatrix(t,r=!1){let i=t;r&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(t,r,i){return t[0]=r[0]*i[0]+r[1]*i[5]+r[2]*i[10]+r[3]*i[15],t[1]=r[0]*i[1]+r[1]*i[6]+r[2]*i[11]+r[3]*i[16],t[2]=r[0]*i[2]+r[1]*i[7]+r[2]*i[12]+r[3]*i[17],t[3]=r[0]*i[3]+r[1]*i[8]+r[2]*i[13]+r[3]*i[18],t[4]=r[0]*i[4]+r[1]*i[9]+r[2]*i[14]+r[3]*i[19]+r[4],t[5]=r[5]*i[0]+r[6]*i[5]+r[7]*i[10]+r[8]*i[15],t[6]=r[5]*i[1]+r[6]*i[6]+r[7]*i[11]+r[8]*i[16],t[7]=r[5]*i[2]+r[6]*i[7]+r[7]*i[12]+r[8]*i[17],t[8]=r[5]*i[3]+r[6]*i[8]+r[7]*i[13]+r[8]*i[18],t[9]=r[5]*i[4]+r[6]*i[9]+r[7]*i[14]+r[8]*i[19]+r[9],t[10]=r[10]*i[0]+r[11]*i[5]+r[12]*i[10]+r[13]*i[15],t[11]=r[10]*i[1]+r[11]*i[6]+r[12]*i[11]+r[13]*i[16],t[12]=r[10]*i[2]+r[11]*i[7]+r[12]*i[12]+r[13]*i[17],t[13]=r[10]*i[3]+r[11]*i[8]+r[12]*i[13]+r[13]*i[18],t[14]=r[10]*i[4]+r[11]*i[9]+r[12]*i[14]+r[13]*i[19]+r[14],t[15]=r[15]*i[0]+r[16]*i[5]+r[17]*i[10]+r[18]*i[15],t[16]=r[15]*i[1]+r[16]*i[6]+r[17]*i[11]+r[18]*i[16],t[17]=r[15]*i[2]+r[16]*i[7]+r[17]*i[12]+r[18]*i[17],t[18]=r[15]*i[3]+r[16]*i[8]+r[17]*i[13]+r[18]*i[18],t[19]=r[15]*i[4]+r[16]*i[9]+r[17]*i[14]+r[18]*i[19]+r[19],t}_colorMatrix(t){const r=new Float32Array(t);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(t,r){const i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,r)}tint(t,r){const i=t>>16&255,n=t>>8&255,o=t&255,l=[i/255,0,0,0,0,0,n/255,0,0,0,0,0,o/255,0,0,0,0,0,1,0];this._loadMatrix(l,r)}greyscale(t,r){const i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,r)}blackAndWhite(t){const r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,t)}hue(t,r){t=(t||0)/180*Math.PI;const i=Math.cos(t),n=Math.sin(t),o=Math.sqrt,l=1/3,h=o(l),u=i+(1-i)*l,f=l*(1-i)-h*n,d=l*(1-i)+h*n,g=l*(1-i)+h*n,m=i+l*(1-i),v=l*(1-i)-h*n,_=l*(1-i)-h*n,w=l*(1-i)+h*n,x=i+l*(1-i),A=[u,f,d,0,0,g,m,v,0,0,_,w,x,0,0,0,0,0,1,0];this._loadMatrix(A,r)}contrast(t,r){const i=(t||0)+1,n=-.5*(i-1),o=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(o,r)}saturate(t=0,r){const i=t*2/3+1,n=(i-1)*-.5,o=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(o,r)}desaturate(){this.saturate(-1)}negative(t){const r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,t)}sepia(t){const r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,t)}technicolor(t){const r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,t)}polaroid(t){const r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,t)}toBGR(t){const r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,t)}kodachrome(t){const r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,t)}browni(t){const r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,t)}vintage(t){const r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,t)}colorTone(t,r,i,n,o){t=t||.2,r=r||.15,i=i||16770432,n=n||3375104;const l=(i>>16&255)/255,h=(i>>8&255)/255,u=(i&255)/255,f=(n>>16&255)/255,d=(n>>8&255)/255,g=(n&255)/255,m=[.3,.59,.11,0,0,l,h,u,t,0,f,d,g,r,0,l-f,h-d,u-g,0,0];this._loadMatrix(m,o)}night(t,r){t=t||.1;const i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(i,r)}predator(t,r){const i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,r)}lsd(t){const r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Gu.prototype.grayscale=Gu.prototype.greyscale;var SM=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,CM=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class IM extends Ae{constructor(t,r){const i=new $t;t.renderable=!1,super(CM,SM,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,r==null&&(r=20),this.scale=new St(r,r)}apply(t,r,i,n){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const o=this.maskSprite.worldTransform,l=Math.sqrt(o.a*o.a+o.b*o.b),h=Math.sqrt(o.c*o.c+o.d*o.d);l!==0&&h!==0&&(this.uniforms.rotation[0]=o.a/l,this.uniforms.rotation[1]=o.b/l,this.uniforms.rotation[2]=o.c/h,this.uniforms.rotation[3]=o.d/h),t.applyFilter(this,r,i,n)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var PM=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,RM=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class MM extends Ae{constructor(){super(RM,PM)}}var DM=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class BM extends Ae{constructor(t=.5,r=Math.random()){super(uv,DM,{uNoise:0,uSeed:0}),this.noise=t,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const lg={AlphaFilter:yM,BlurFilter:TM,BlurFilterPass:Uu,ColorMatrixFilter:Gu,DisplacementFilter:IM,FXAAFilter:MM,NoiseFilter:BM};Object.entries(lg).forEach(([e,t])=>{Object.defineProperty(lg,e,{get(){return Ct("7.1.0",`filters.${e} has moved to ${e}`),t}})});class Gs{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Gs.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new St,this.page=new St,this.AT_TARGET=1,this.BUBBLING_PHASE=2,this.CAPTURING_PHASE=3,this.NONE=0,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,r,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,r,i,n,o){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Pa extends Gs{constructor(){super(...arguments),this.client=new St,this.movement=new St,this.offset=new St,this.global=new St,this.screen=new St}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,r,i,n,o,l,h,u,f,d,g,m,v,_,w){throw new Error("Method not implemented.")}}class lr extends Pa{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Wu extends Pa{constructor(){super(...arguments),this.DOM_DELTA_LINE=0,this.DOM_DELTA_PAGE=1,this.DOM_DELTA_PIXEL=2}}const OM=2048,FM=new St,zh=new St;class LM{constructor(t){this.dispatch=new Ls,this.moveOnAll=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,r){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:r,priority:0}),this.mappingTable[t].sort((i,n)=>i.priority-n.priority)}dispatchEvent(t,r){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,r),this.dispatch.emit(r||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const r=this.mappingTable[t.type];if(r)for(let i=0,n=r.length;i<n;i++)r[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,r){const i=this.hitTestRecursive(this.rootTarget,this.rootTarget.interactive,FM.set(t,r),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(t,r){if(!t.target)return;const i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let n=0,o=i.length-1;n<o;n++)if(t.currentTarget=i[n],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,r),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let n=i.length-2;n>=0;n--)if(t.currentTarget=i[n],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,r,i=this.rootTarget){t.eventPhase=t.BUBBLING_PHASE;const n=i.children;if(n)for(let o=0;o<n.length;o++)this.all(t,r,n[o]);t.currentTarget=i,this.notifyTarget(t,r)}propagationPath(t){const r=[t];for(let i=0;i<OM&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(t.parent),t=t.parent}return r.reverse(),r}hitTestRecursive(t,r,i,n,o){if(!t||!t.visible||o(t,i))return null;if(t.interactiveChildren&&t.children){const l=t.children;for(let h=l.length-1;h>=0;h--){const u=l[h],f=this.hitTestRecursive(u,r||u.interactive,i,n,o);if(f){if(f.length>0&&!f[f.length-1].parent)continue;return(f.length>0||t.interactive)&&f.push(t),f}}}return r&&n(t,i)?t.interactive?[t]:[]:null}hitPruneFn(t,r){var i;if(t.hitArea&&(t.worldTransform.applyInverse(r,zh),!t.hitArea.contains(zh.x,zh.y)))return!0;if(t._mask){const n=t._mask.isMaskData?t._mask.maskObject:t._mask;if(n&&!((i=n.containsPoint)!=null&&i.call(n,r)))return!0}return!1}hitTestFn(t,r){return t.hitArea?!0:t.containsPoint?t.containsPoint(r):!1}notifyTarget(t,r){var o,l;r=r??t.type;const i=`on${r}`;(l=(o=t.currentTarget)[i])==null||l.call(o,t);const n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${r}capture`:r;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,r)}mapPointerDown(t){if(!(t instanceof lr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(t);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const n=r.button===2;this.dispatchEvent(r,n?"rightdown":"mousedown")}const i=this.trackingData(t.pointerId);i.pressTargetsByButton[t.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(t){var h;if(!(t instanceof lr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(t),i=r.pointerType==="mouse"||r.pointerType==="pen",n=this.trackingData(t.pointerId),o=this.findMountedTarget(n.overTargets);if(n.overTargets&&o!==r.target){const u=t.type==="mousemove"?"mouseout":"pointerout",f=this.createPointerEvent(t,u,o);if(this.dispatchEvent(f,"pointerout"),i&&this.dispatchEvent(f,"mouseout"),!r.composedPath().includes(o)){const d=this.createPointerEvent(t,"pointerleave",o);for(d.eventPhase=d.AT_TARGET;d.target&&!r.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),i&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(f)}if(o!==r.target){const u=t.type==="mousemove"?"mouseover":"pointerover",f=this.clonePointerEvent(r,u);this.dispatchEvent(f,"pointerover"),i&&this.dispatchEvent(f,"mouseover");let d=o==null?void 0:o.parent;for(;d&&d!==this.rootTarget.parent&&d!==r.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const m=this.clonePointerEvent(r,"pointerenter");for(m.eventPhase=m.AT_TARGET;m.target&&m.target!==o&&m.target!==this.rootTarget.parent;)m.currentTarget=m.target,this.notifyTarget(m),i&&this.notifyTarget(m,"mouseenter"),m.target=m.target.parent;this.freeEvent(m)}this.freeEvent(f)}const l=this.moveOnAll?"all":"dispatchEvent";this[l](r,"pointermove"),r.pointerType==="touch"&&this[l](r,"touchmove"),i&&(this[l](r,"mousemove"),this.cursor=(h=r.target)==null?void 0:h.cursor),n.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(t){var l;if(!(t instanceof lr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(t.pointerId),i=this.createPointerEvent(t),n=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),n&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=(l=i.target)==null?void 0:l.cursor);const o=this.clonePointerEvent(i,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;r.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(o)}mapPointerOut(t){if(!(t instanceof lr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(t.pointerId);if(r.overTargets){const i=t.pointerType==="mouse"||t.pointerType==="pen",n=this.findMountedTarget(r.overTargets),o=this.createPointerEvent(t,"pointerout",n);this.dispatchEvent(o),i&&this.dispatchEvent(o,"mouseout");const l=this.createPointerEvent(t,"pointerleave",n);for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==this.rootTarget.parent;)l.currentTarget=l.target,this.notifyTarget(l),i&&this.notifyTarget(l,"mouseleave"),l.target=l.target.parent;r.overTargets=null,this.freeEvent(o),this.freeEvent(l)}this.cursor=null}mapPointerUp(t){if(!(t instanceof lr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const h=i.button===2;this.dispatchEvent(i,h?"rightup":"mouseup")}const n=this.trackingData(t.pointerId),o=this.findMountedTarget(n.pressTargetsByButton[t.button]);let l=o;if(o&&!i.composedPath().includes(o)){let h=o;for(;h&&!i.composedPath().includes(h);){if(i.currentTarget=h,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const u=i.button===2;this.notifyTarget(i,u?"rightupoutside":"mouseupoutside")}h=h.parent}delete n.pressTargetsByButton[t.button],l=h}if(l){const h=this.clonePointerEvent(i,"click");h.target=l,h.path=null,n.clicksByButton[t.button]||(n.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:r});const u=n.clicksByButton[t.button];u.target===h.target&&r-u.timeStamp<200?++u.clickCount:u.clickCount=1,u.target=h.target,u.timeStamp=r,h.detail=u.clickCount,h.pointerType==="mouse"?this.dispatchEvent(h,"click"):h.pointerType==="touch"&&this.dispatchEvent(h,"tap"),this.dispatchEvent(h,"pointertap"),this.freeEvent(h)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof lr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.pressTargetsByButton[t.button]),n=this.createPointerEvent(t);if(i){let o=i;for(;o;)n.currentTarget=o,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch"?this.notifyTarget(n,"touchendoutside"):(n.pointerType==="mouse"||n.pointerType==="pen")&&this.notifyTarget(n,n.button===2?"rightupoutside":"mouseupoutside"),o=o.parent;delete r.pressTargetsByButton[t.button]}this.freeEvent(n)}mapWheel(t){if(!(t instanceof Wu)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const r=this.createWheelEvent(t);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(t){if(!t)return null;let r=t[0];for(let i=1;i<t.length&&t[i].parent===r;i++)r=t[i];return r}createPointerEvent(t,r,i){const n=this.allocateEvent(lr);return this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=i??this.hitTest(n.global.x,n.global.y),typeof r=="string"&&(n.type=r),n}createWheelEvent(t){const r=this.allocateEvent(Wu);return this.copyWheelData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(t,r){const i=this.allocateEvent(lr);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=r??i.type,i}copyWheelData(t,r){r.deltaMode=t.deltaMode,r.deltaX=t.deltaX,r.deltaY=t.deltaY,r.deltaZ=t.deltaZ}copyPointerData(t,r){t instanceof lr&&r instanceof lr&&(r.pointerId=t.pointerId,r.width=t.width,r.height=t.height,r.isPrimary=t.isPrimary,r.pointerType=t.pointerType,r.pressure=t.pressure,r.tangentialPressure=t.tangentialPressure,r.tiltX=t.tiltX,r.tiltY=t.tiltY,r.twist=t.twist)}copyMouseData(t,r){t instanceof Pa&&r instanceof Pa&&(r.altKey=t.altKey,r.button=t.button,r.buttons=t.buttons,r.client.copyFrom(t.client),r.ctrlKey=t.ctrlKey,r.metaKey=t.metaKey,r.movement.copyFrom(t.movement),r.screen.copyFrom(t.screen),r.global.copyFrom(t.global))}copyData(t,r){r.isTrusted=t.isTrusted,r.srcElement=t.srcElement,r.timeStamp=performance.now(),r.type=t.type,r.detail=t.detail,r.view=t.view,r.which=t.which,r.layer.copyFrom(t.layer),r.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const r=this.eventPool.get(t).pop()||new t(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const r=t.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(t)}notifyListeners(t,r){const i=t.currentTarget._events[r];if(i)if("fn"in i)i.fn.call(i.context,t);else for(let n=0,o=i.length;n<o&&!t.propagationImmediatelyStopped;n++)i[n].fn.call(i[n].context,t)}}const NM=1,kM={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class vv{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new LM(null),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new lr(null),this.rootWheelEvent=new Wu(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}init(){const{view:t,resolution:r}=this.renderer;this.setTargetElement(t),this.resolution=r}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let r=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(r=!1),this.currentCursor===t)return;this.currentCursor=t;const i=this.cursorStyles[t];if(i)switch(typeof i){case"string":r&&(this.domElement.style.cursor=i);break;case"function":i(t);break;case"object":r&&Object.assign(this.domElement.style,i);break}else r&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}onPointerDown(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const r=this.normalizeToPointerData(t);this.autoPreventDefault&&r[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let i=0,n=r.length;i<n;i++){const o=r[i],l=this.bootstrapEvent(this.rootPointerEvent,o);this.rootBoundary.mapEvent(l)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const r=this.normalizeToPointerData(t);for(let i=0,n=r.length;i<n;i++){const o=this.bootstrapEvent(this.rootPointerEvent,r[i]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;let r=t.target;t.composedPath&&t.composedPath().length>0&&(r=t.composedPath()[0]);const i=r!==this.domElement?"outside":"",n=this.normalizeToPointerData(t);for(let o=0,l=n.length;o<l;o++){const h=this.bootstrapEvent(this.rootPointerEvent,n[o]);h.type+=i,this.rootBoundary.mapEvent(h)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const r=this.normalizeToPointerData(t);for(let i=0,n=r.length;i<n;i++){const o=this.bootstrapEvent(this.rootPointerEvent,r[i]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){const r=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(r)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,r,i){let n;this.domElement.parentElement?n=this.domElement.getBoundingClientRect():n={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const o=1/this.resolution;t.x=(r-n.left)*(this.domElement.width/n.width)*o,t.y=(i-n.top)*(this.domElement.height/n.height)*o}normalizeToPointerData(t){const r=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let i=0,n=t.changedTouches.length;i<n;i++){const o=t.changedTouches[i];typeof o.button>"u"&&(o.button=0),typeof o.buttons>"u"&&(o.buttons=1),typeof o.isPrimary>"u"&&(o.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof o.width>"u"&&(o.width=o.radiusX||1),typeof o.height>"u"&&(o.height=o.radiusY||1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="touch"),typeof o.pointerId>"u"&&(o.pointerId=o.identifier||0),typeof o.pressure>"u"&&(o.pressure=o.force||.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),typeof o.layerX>"u"&&(o.layerX=o.offsetX=o.clientX),typeof o.layerY>"u"&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,o.type=t.type,r.push(o)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const i=t;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=NM),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,r.push(i)}else r.push(t);return r}normalizeWheelEvent(t){const r=this.rootWheelEvent;return this.transferMouseData(r,t),r.deltaX=t.deltaX,r.deltaY=t.deltaY,r.deltaZ=t.deltaZ,r.deltaMode=t.deltaMode,this.mapPositionToPoint(r.screen,t.clientX,t.clientY),r.global.copyFrom(r.screen),r.offset.copyFrom(r.screen),r.nativeEvent=t,r.type=t.type,r}bootstrapEvent(t,r){return t.originalEvent=null,t.nativeEvent=r,t.pointerId=r.pointerId,t.width=r.width,t.height=r.height,t.isPrimary=r.isPrimary,t.pointerType=r.pointerType,t.pressure=r.pressure,t.tangentialPressure=r.tangentialPressure,t.tiltX=r.tiltX,t.tiltY=r.tiltY,t.twist=r.twist,this.transferMouseData(t,r),this.mapPositionToPoint(t.screen,r.clientX,r.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=r.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=kM[t.type]||t.type),t}transferMouseData(t,r){t.isTrusted=r.isTrusted,t.srcElement=r.srcElement,t.timeStamp=performance.now(),t.type=r.type,t.altKey=r.altKey,t.button=r.button,t.buttons=r.buttons,t.client.x=r.clientX,t.client.y=r.clientY,t.ctrlKey=r.ctrlKey,t.metaKey=r.metaKey,t.movement.x=r.movementX,t.movement.y=r.movementY,t.page.x=r.pageX,t.page.y=r.pageY,t.relatedTarget=null,t.shiftKey=r.shiftKey}}vv.extension={name:"events",type:[Z.RendererSystem,Z.CanvasRendererSystem]};nt.add(vv);const UM={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,ontouchstart:null,onwheel:null,interactive:!1,interactiveChildren:!0,hitArea:null,addEventListener(e,t,r){const i=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,n=typeof t=="function"?void 0:t;e=i?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.on(e,t,n)},removeEventListener(e,t,r){const i=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,n=typeof t=="function"?void 0:t;e=i?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.off(e,t,n)},dispatchEvent(e){if(!(e instanceof Gs))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};Vt.mixin(UM);const GM={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Vt.mixin(GM);const WM=9,jo=100,$M=0,HM=0,hg=2,ug=1,XM=-1e3,zM=-1e3,VM=2;class yv{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Vr.tablet||Vr.phone)&&this.createTouchHook();const r=document.createElement("div");r.style.width=`${jo}px`,r.style.height=`${jo}px`,r.style.position="absolute",r.style.top=`${$M}px`,r.style.left=`${HM}px`,r.style.zIndex=hg.toString(),this.div=r,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${ug}px`,t.style.height=`${ug}px`,t.style.position="absolute",t.style.top=`${XM}px`,t.style.left=`${zM}px`,t.style.zIndex=VM.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const r=t.children;if(r)for(let i=0;i<r.length;i++)this.updateAccessibleObjects(r[i])}update(){const t=performance.now();if(Vr.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:r,y:i,width:n,height:o}=this.renderer.view.getBoundingClientRect(),{width:l,height:h,resolution:u}=this.renderer,f=n/l*u,d=o/h*u;let g=this.div;g.style.left=`${r}px`,g.style.top=`${i}px`,g.style.width=`${l}px`,g.style.height=`${h}px`;for(let m=0;m<this.children.length;m++){const v=this.children[m];if(v.renderId!==this.renderId)v._accessibleActive=!1,Dn(this.children,m,1),this.div.removeChild(v._accessibleDiv),this.pool.push(v._accessibleDiv),v._accessibleDiv=null,m--;else{g=v._accessibleDiv;let _=v.hitArea;const w=v.worldTransform;v.hitArea?(g.style.left=`${(w.tx+_.x*w.a)*f}px`,g.style.top=`${(w.ty+_.y*w.d)*d}px`,g.style.width=`${_.width*w.a*f}px`,g.style.height=`${_.height*w.d*d}px`):(_=v.getBounds(),this.capHitArea(_),g.style.left=`${_.x*f}px`,g.style.top=`${_.y*d}px`,g.style.width=`${_.width*f}px`,g.style.height=`${_.height*d}px`,g.title!==v.accessibleTitle&&v.accessibleTitle!==null&&(g.title=v.accessibleTitle),g.getAttribute("aria-label")!==v.accessibleHint&&v.accessibleHint!==null&&g.setAttribute("aria-label",v.accessibleHint)),(v.accessibleTitle!==g.title||v.tabIndex!==g.tabIndex)&&(g.title=v.accessibleTitle,g.tabIndex=v.tabIndex,this.debug&&this.updateDebugHTML(g))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:r,height:i}=this.renderer;t.x+t.width>r&&(t.width=r-t.x),t.y+t.height>i&&(t.height=i-t.y)}addChild(t){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${jo}px`,r.style.height=`${jo}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=hg.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=t.accessiblePointerEvents,r.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?r.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(r.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&r.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(r),t._accessibleActive=!0,t._accessibleDiv=r,r.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,r){const{displayObject:i}=t.target,n=this.renderer.events.rootBoundary,o=Object.assign(new Gs(n),{target:i});n.rootTarget=this.renderer.lastObjectRendered,r.forEach(l=>n.dispatchEvent(o,l))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===WM&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}yv.extension={name:"accessibility",type:[Z.RendererPlugin,Z.CanvasRendererPlugin]};nt.add(yv);const $u=class{constructor(e){this.stage=new Ge,e=Object.assign({forceCanvas:!1},e),this.renderer=sM(e),$u._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(e,t){const r=$u._plugins.slice(0);r.reverse(),r.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};let vc=$u;vc._plugins=[];nt.handleByList(Z.Application,vc._plugins);class _v{static init(t){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,i;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:n,clientHeight:o}=this._resizeTo;r=n,i=o}this.renderer.resize(r,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}_v.extension=Z.Application;nt.add(_v);const cg={loader:Z.LoadParser,resolver:Z.ResolveParser,cache:Z.CacheParser,detection:Z.DetectionParser};nt.handle(Z.Asset,e=>{const t=e.ref;Object.entries(cg).filter(([r])=>!!t[r]).forEach(([r,i])=>nt.add(Object.assign(t[r],{extension:t[r].extension??i})))},e=>{const t=e.ref;Object.keys(cg).filter(r=>!!t[r]).forEach(r=>nt.remove(t[r]))});class YM{constructor(t,r=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(t){t.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<r;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function xv(e,t){if(Array.isArray(t)){for(const r of t)if(e.startsWith(`data:${r}`))return!0;return!1}return e.startsWith(`data:${t}`)}function za(e,t){const r=e.split("?")[0],i=ve.extname(r).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const Yr=(e,t)=>(Array.isArray(e)||(e=[e]),t?e.map(r=>typeof r=="string"?t(r):r):e);function bv(e,t,r,i,n){const o=t[r];for(let l=0;l<o.length;l++){const h=o[l];r<t.length-1?bv(e.replace(i[r],h),t,r+1,i,n):n.push(e.replace(i[r],h))}}function jM(e){const t=/\{(.*?)\}/g,r=e.match(t),i=[];if(r){const n=[];r.forEach(o=>{const l=o.substring(1,o.length-1).split(",");n.push(l)}),bv(e,n,0,r,i)}else i.push(e);return i}const Ra=e=>!Array.isArray(e);class qM{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const r=this._cache.get(t);return r||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),r}set(t,r){const i=Yr(t);let n;for(let h=0;h<this.parsers.length;h++){const u=this.parsers[h];if(u.test(r)){n=u.getCacheableAssets(i,r);break}}n||(n={},i.forEach(h=>{n[h]=r}));const o=Object.keys(n),l={cacheKeys:o,keys:i};if(i.forEach(h=>{this._cacheMap.set(h,l)}),o.forEach(h=>{this._cache.has(h)&&this._cache.get(h)!==r&&console.warn("[Cache] already has key:",h),this._cache.set(h,n[h])}),r instanceof it){const h=r;i.forEach(u=>{h.baseTexture!==it.EMPTY.baseTexture&&gt.addToCache(h.baseTexture,u),it.addToCache(h,u)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const r=this._cacheMap.get(t);r.cacheKeys.forEach(n=>{this._cache.delete(n)}),r.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const ys=new qM;class KM{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(t,r){const i={promise:null,parser:null};return i.promise=(async()=>{var o,l;let n=null;for(let h=0;h<this.parsers.length;h++){const u=this.parsers[h];if(u.load&&((o=u.test)!=null&&o.call(u,t,r,this))){n=await u.load(t,r,this),i.parser=u;break}}if(!i.parser)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has being added`),null;for(let h=0;h<this.parsers.length;h++){const u=this.parsers[h];u.parse&&u.parse&&await((l=u.testParse)==null?void 0:l.call(u,n,r,this))&&(n=await u.parse(n,r,this)||n,i.parser=u)}return n})(),i}async load(t,r){let i=0;const n={},o=Ra(t),l=Yr(t,f=>({src:f})),h=l.length,u=l.map(async f=>{const d=ve.toAbsolute(f.src);if(!n[f.src])try{this.promiseCache[d]||(this.promiseCache[d]=this._getLoadPromiseAndParser(d,f)),n[f.src]=await this.promiseCache[d].promise,r&&r(++i/h)}catch(g){throw delete this.promiseCache[d],delete n[f.src],new Error(`[Loader.load] Failed to load ${d}.
${g}`)}});return await Promise.all(u),o?n[l[0].src]:n}async unload(t){const i=Yr(t,n=>({src:n})).map(async n=>{var h,u;const o=ve.toAbsolute(n.src),l=this.promiseCache[o];if(l){const f=await l.promise;(u=(h=l.parser)==null?void 0:h.unload)==null||u.call(h,f,n,this),delete this.promiseCache[o]}});await Promise.all(i)}get parsers(){return this._parsers}}var Br=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(Br||{});const ZM={extension:{type:Z.LoadParser,priority:Br.Low},test(e){return ve.extname(e).toLowerCase()===".json"},async load(e){return await(await J.ADAPTER.fetch(e)).json()}};nt.add(ZM);const JM={extension:{type:Z.LoadParser,priority:Br.Low},test(e){return ve.extname(e).toLowerCase()===".txt"},async load(e){return await(await J.ADAPTER.fetch(e)).text()}};nt.add(JM);const QM=["normal","bold","100","200","300","400","500","600","700","800","900"],tD=[".ttf",".otf",".woff",".woff2"],eD=["font/ttf","font/otf","font/woff","font/woff2"];function rD(e){const t=ve.extname(e);return ve.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ")}const iD={extension:{type:Z.LoadParser,priority:Br.Low},test(e){return xv(e,eD)||za(e,tD)},async load(e,t){var i,n,o;if(!globalThis.navigator.onLine)throw new Error("[loadWebFont] Cannot load font - navigator is offline");const r=J.ADAPTER.getFontFaceSet();if(r){const l=[],h=((i=t.data)==null?void 0:i.family)??rD(e),u=((o=(n=t.data)==null?void 0:n.weights)==null?void 0:o.filter(d=>QM.includes(d)))??["normal"],f=t.data??{};for(let d=0;d<u.length;d++){const g=u[d],m=new FontFace(h,`url(${encodeURI(e)})`,{...f,weight:g});await m.load(),r.add(m),l.push(m)}return l.length===1?l[0]:l}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach(t=>J.ADAPTER.getFontFaceSet().delete(t))}};nt.add(iD);let fg=0,Vh;const nD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",sD={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${nD}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},oD={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Yh;class aD{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const r=URL.createObjectURL(new Blob([sD.code],{type:"application/javascript"})),i=new Worker(r);i.addEventListener("message",n=>{i.terminate(),URL.revokeObjectURL(r),t(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Vh===void 0&&(Vh=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Vh&&(Yh||(Yh=URL.createObjectURL(new Blob([oD.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Yh),t.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,r){await this._initWorkers();const i=new Promise((n,o)=>{this.queue.push({id:t,arguments:r,resolve:n,reject:o})});return this.next(),i}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const r=this.queue.pop(),i=r.id;this.resolveHash[fg]={resolve:r.resolve,reject:r.reject},t.postMessage({data:r.arguments,uuid:fg++,id:i})}}const dg=new aD;function Va(e,t,r){const i=new it(e);return i.baseTexture.on("dispose",()=>{delete t.promiseCache[r]}),i}const lD=[".jpeg",".jpg",".png",".webp",".avif"],hD=["image/jpeg","image/png","image/webp","image/avif"];async function uD(e){const t=await J.ADAPTER.fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);const r=await t.blob();return await createImageBitmap(r)}const Os={extension:{type:Z.LoadParser,priority:Br.High},config:{preferWorkers:!0},test(e){return xv(e,hD)||za(e,lD)},async load(e,t,r){let i=null;globalThis.createImageBitmap?this.config.preferWorkers&&await dg.isImageBitmapSupported()?i=await dg.loadImageBitmap(e):i=await uD(e):i=await new Promise(o=>{i=new Image,i.crossOrigin="anonymous",i.src=e,i.complete?o(i):i.onload=()=>{o(i)}});const n=new gt(i,{resolution:fi(e),...t.data});return n.resource.src=e,Va(n,r,e)},unload(e){e.destroy(!0)}};nt.add(Os);const cD={extension:{type:Z.LoadParser,priority:Br.High},test(e){return ve.extname(e).toLowerCase()===".svg"},async testParse(e){return Bs.test(e)},async parse(e,t,r){var l,h,u;const i=new Bs(e,(l=t==null?void 0:t.data)==null?void 0:l.resourceOptions),n=new gt(i,{resolution:fi(e),...t==null?void 0:t.data});n.resource.src=e;const o=Va(n,r,e);return(u=(h=t==null?void 0:t.data)==null?void 0:h.resourceOptions)!=null&&u.autoLoad||await i.load(),o},async load(e,t){return(await J.ADAPTER.fetch(e)).text()},unload:Os.unload};nt.add(cD);class fD{constructor(){this._bundleIdConnector="-",this._createBundleAssetId=(t,r)=>`${t}${this._bundleIdConnector}${r}`,this._extractAssetIdFromBundle=(t,r)=>r.replace(`${t}${this._bundleIdConnector}`,""),this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this._preferredOrder=[],this._resolverHash={},this._assetMap={},this._rootPath=null,this._basePath=null,this._manifest=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const r=t;this._defaultSearchParams=Object.keys(r).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(r[i])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(t,r){const i=[];Array.isArray(r)?r.forEach(n=>{if(typeof n.name=="string"){const o=this._createBundleAssetId(t,n.name);i.push(o),this.add([n.name,o],n.srcs)}else{const o=n.name.map(l=>this._createBundleAssetId(t,l));o.forEach(l=>{i.push(l)}),this.add([...n.name,...o],n.srcs)}}):Object.keys(r).forEach(n=>{i.push(this._createBundleAssetId(t,n)),this.add([n,this._createBundleAssetId(t,n)],r[n])}),this._bundles[t]=i}add(t,r,i){const n=Yr(t);n.forEach(l=>{this._assetMap[l]&&console.warn(`[Resolver] already has key: ${l} overwriting`)}),Array.isArray(r)||(typeof r=="string"?r=jM(r):r=[r]);const o=r.map(l=>{let h=l;if(typeof l=="string"){let u=!1;for(let f=0;f<this._parsers.length;f++){const d=this._parsers[f];if(d.test(l)){h=d.parse(l),u=!0;break}}u||(h={src:l})}return h.format||(h.format=h.src.split(".").pop()),h.alias||(h.alias=n),(this._basePath||this._rootPath)&&(h.src=ve.toAbsolute(h.src,this._basePath,this._rootPath)),h.src=this._appendDefaultSearchParams(h.src),h.data=h.data??i,h});n.forEach(l=>{this._assetMap[l]=o})}resolveBundle(t){const r=Ra(t);t=Yr(t);const i={};return t.forEach(n=>{const o=this._bundles[n];if(o){const l=this.resolve(o),h={};for(const u in l){const f=l[u];h[this._extractAssetIdFromBundle(n,u)]=f}i[n]=h}}),r?i[t[0]]:i}resolveUrl(t){const r=this.resolve(t);if(typeof t!="string"){const i={};for(const n in r)i[n]=r[n].src;return i}return r.src}resolve(t){const r=Ra(t);t=Yr(t);const i={};return t.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let o=this._assetMap[n];const l=this._getPreferredOrder(o),h=o[0];l==null||l.priority.forEach(u=>{l.params[u].forEach(f=>{const d=o.filter(g=>g[u]?g[u]===f:!1);d.length&&(o=d)})}),this._resolverHash[n]=o[0]??h}else{let o=n;(this._basePath||this._rootPath)&&(o=ve.toAbsolute(o,this._basePath,this._rootPath)),o=this._appendDefaultSearchParams(o),this._resolverHash[n]={src:o}}i[n]=this._resolverHash[n]}),r?i[t[0]]:i}_getPreferredOrder(t){for(let r=0;r<t.length;r++){const i=t[0],n=this._preferredOrder.find(o=>o.params.format.includes(i.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const r=/\?/.test(t)?"&":"?";return`${t}${r}${this._defaultSearchParams}`}}class dD{constructor(){this._detections=[],this._initialized=!1,this.resolver=new fD,this.loader=new KM,this.cache=ys,this._backgroundLoader=new YM(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var o,l,h;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let u=t.manifest;typeof u=="string"&&(u=await this.load(u)),this.resolver.addManifest(u)}const r=((o=t.texturePreference)==null?void 0:o.resolution)??1,i=typeof r=="number"?[r]:r;let n=[];if((l=t.texturePreference)!=null&&l.format){const u=(h=t.texturePreference)==null?void 0:h.format;n=typeof u=="string"?[u]:u;for(const f of this._detections)await f.test()||(n=await f.remove(n))}else for(const u of this._detections)await u.test()&&(n=await u.add(n));this.resolver.prefer({params:{format:n,resolution:i}})}add(t,r,i){this.resolver.add(t,r,i)}async load(t,r){this._initialized||await this.init();const i=Ra(t),n=Yr(t).map(h=>typeof h!="string"?(this.resolver.add(h.src,h),h.src):h),o=this.resolver.resolve(n),l=await this._mapLoadToResolve(o,r);return i?l[n[0]]:l}addBundle(t,r){this.resolver.addBundle(t,r)}async loadBundle(t,r){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const n=this.resolver.resolveBundle(t),o={},l=Object.keys(n);let h=0,u=0;const f=()=>{r==null||r(++h/u)},d=l.map(g=>{const m=n[g];return u+=Object.keys(m).length,this._mapLoadToResolve(m,f).then(v=>{o[g]=v})});return await Promise.all(d),i?o[t[0]]:o}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const r=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const r=this.resolver.resolveBundle(t);Object.values(r).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return ys.get(t);const r={};for(let i=0;i<t.length;i++)r[i]=ys.get(t[i]);return r}async _mapLoadToResolve(t,r){const i=Object.values(t),n=Object.keys(t);this._backgroundLoader.active=!1;const o=await this.loader.load(i,r);this._backgroundLoader.active=!0;const l={};return i.forEach((h,u)=>{const f=o[h.src],d=[h.src];h.alias&&d.push(...h.alias),l[n[u]]=f,ys.set(d,f)}),l}async unload(t){this._initialized||await this.init();const r=Yr(t).map(n=>typeof n!="string"?n.src:n),i=this.resolver.resolve(r);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=Yr(t);const r=this.resolver.resolveBundle(t),i=Object.keys(r).map(n=>this._unloadFromResolved(r[n]));await Promise.all(i)}async _unloadFromResolved(t){const r=Object.values(t);r.forEach(i=>{ys.remove(i.src)}),await this.loader.unload(r)}get detections(){return this._detections}get preferWorkers(){return Os.config.preferWorkers}set preferWorkers(t){Os.config.preferWorkers=t}}const Li=new dD;nt.handleByList(Z.LoadParser,Li.loader.parsers).handleByList(Z.ResolveParser,Li.resolver.parsers).handleByList(Z.CacheParser,Li.cache.parsers).handleByList(Z.DetectionParser,Li.detections);const pD={extension:Z.CacheParser,test:e=>Array.isArray(e)&&e.every(t=>t instanceof it),getCacheableAssets:(e,t)=>{const r={};return e.forEach(i=>{t.forEach((n,o)=>{r[i+(o===0?"":o+1)]=n})}),r}};nt.add(pD);const gD={extension:{type:Z.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const t=await J.ADAPTER.fetch("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=").then(r=>r.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"avif"],remove:async e=>e.filter(t=>t!=="avif")};nt.add(gD);const mD={extension:{type:Z.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const t=await J.ADAPTER.fetch("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=").then(r=>r.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"webp"],remove:async e=>e.filter(t=>t!=="webp")};nt.add(mD);const pg=["png","jpg","jpeg"],vD={extension:{type:Z.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...pg],remove:async e=>e.filter(t=>!pg.includes(t))};nt.add(vD);const yD={extension:Z.ResolveParser,test:Os.test,parse:e=>{var t;return{resolution:parseFloat(((t=J.RETINA_PREFIX.exec(e))==null?void 0:t[1])??"1"),format:e.split(".").pop(),src:e}}};nt.add(yD);var Ue=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e))(Ue||{});const Ma={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let Xr,En;function gg(){En={s3tc:Xr.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Xr.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Xr.getExtension("WEBGL_compressed_texture_etc"),etc1:Xr.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Xr.getExtension("WEBGL_compressed_texture_pvrtc")||Xr.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Xr.getExtension("WEBGL_compressed_texture_atc"),astc:Xr.getExtension("WEBGL_compressed_texture_astc")}}const _D={extension:{type:Z.DetectionParser,priority:2},test:async()=>{const t=J.ADAPTER.createCanvas().getContext("webgl");return t?(Xr=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{En||gg();const t=[];for(const r in En)En[r]&&t.push(r);return[...t,...e]},remove:async e=>(En||gg(),e.filter(t=>!(t in En)))};nt.add(_D);class xD extends Us{constructor(t,r={width:1,height:1,autoLoad:!0}){let i,n;typeof t=="string"?(i=t,n=new Uint8Array):(i=null,n=t),super(n,r),this.origin=i,this.buffer=n?new Pu(n):null,this.origin&&r.autoLoad!==!1&&this.load(),n!=null&&n.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}async load(){const i=await(await(await fetch(this.origin)).blob()).arrayBuffer();return this.data=new Uint32Array(i),this.buffer=new Pu(i),this.loaded=!0,this.onBlobLoaded(i),this.update(),this}}class $i extends xD{constructor(t,r){super(t,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=$i._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||$i._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,r,i){const n=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let l=0,h=this.levels;l<h;l++){const{levelID:u,levelWidth:f,levelHeight:d,levelBuffer:g}=this._levelBuffers[l];n.compressedTexImage2D(n.TEXTURE_2D,u,this.format,f,d,0,g)}return!0}onBlobLoaded(){this._levelBuffers=$i._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,r,i,n,o,l,h){const u=new Array(i);let f=t.byteOffset,d=l,g=h,m=d+n-1&~(n-1),v=g+o-1&~(o-1),_=m*v*Ma[r];for(let w=0;w<i;w++)u[w]={levelID:w,levelWidth:i>1?d:m,levelHeight:i>1?g:v,levelBuffer:new Uint8Array(t.buffer,f,_)},f+=_,d=d>>1||1,g=g>>1||1,m=d+n-1&~(n-1),v=g+o-1&~(o-1),_=m*v*Ma[r];return u}}const jh=4,qo=124,bD=32,mg=20,wD=542327876,Ko={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},ED={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Zo={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},TD=1,AD=2,SD=4,CD=64,ID=512,PD=131072,RD=827611204,MD=861165636,DD=894720068,BD=808540228,OD=4,FD={[RD]:Ue.COMPRESSED_RGBA_S3TC_DXT1_EXT,[MD]:Ue.COMPRESSED_RGBA_S3TC_DXT3_EXT,[DD]:Ue.COMPRESSED_RGBA_S3TC_DXT5_EXT},LD={70:Ue.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Ue.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Ue.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Ue.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Ue.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Ue.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Ue.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Ue.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Ue.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function ND(e){const t=new Uint32Array(e);if(t[0]!==wD)throw new Error("Invalid DDS file magic word");const i=new Uint32Array(e,0,qo/Uint32Array.BYTES_PER_ELEMENT),n=i[Ko.HEIGHT],o=i[Ko.WIDTH],l=i[Ko.MIPMAP_COUNT],h=new Uint32Array(e,Ko.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,bD/Uint32Array.BYTES_PER_ELEMENT),u=h[TD];if(u&SD){const f=h[ED.FOURCC];if(f!==BD){const E=FD[f],I=jh+qo,D=new Uint8Array(e,I);return[new $i(D,{format:E,width:o,height:n,levels:l})]}const d=jh+qo,g=new Uint32Array(t.buffer,d,mg/Uint32Array.BYTES_PER_ELEMENT),m=g[Zo.DXGI_FORMAT],v=g[Zo.RESOURCE_DIMENSION],_=g[Zo.MISC_FLAG],w=g[Zo.ARRAY_SIZE],x=LD[m];if(x===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${m}`);if(_===OD)throw new Error("DDSParser does not support cubemap textures");if(v===6)throw new Error("DDSParser does not supported 3D texture data");const A=new Array,S=jh+qo+mg;if(w===1)A.push(new Uint8Array(e,S));else{const E=Ma[x];let I=0,D=o,L=n;for(let F=0;F<l;F++){const X=Math.max(1,D+3&-4),j=Math.max(1,L+3&-4),z=X*j*E;I+=z,D=D>>>1,L=L>>>1}let O=S;for(let F=0;F<w;F++)A.push(new Uint8Array(e,O,I)),O+=I}return A.map(E=>new $i(E,{format:x,width:o,height:n,levels:l}))}throw u&CD?new Error("DDSParser does not support uncompressed texture data."):u&ID?new Error("DDSParser does not supported YUV uncompressed texture data."):u&PD?new Error("DDSParser does not support single-channel (lumninance) texture data!"):u&AD?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const vg=[171,75,84,88,32,49,49,187,13,10,26,10],kD=67305985,or={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Hu=64,yg={[st.UNSIGNED_BYTE]:1,[st.UNSIGNED_SHORT]:2,[st.INT]:4,[st.UNSIGNED_INT]:4,[st.FLOAT]:4,[st.HALF_FLOAT]:8},UD={[V.RGBA]:4,[V.RGB]:3,[V.RG]:2,[V.RED]:1,[V.LUMINANCE]:1,[V.LUMINANCE_ALPHA]:2,[V.ALPHA]:1},GD={[st.UNSIGNED_SHORT_4_4_4_4]:2,[st.UNSIGNED_SHORT_5_5_5_1]:2,[st.UNSIGNED_SHORT_5_6_5]:2};function WD(e,t,r=!1){const i=new DataView(t);if(!$D(e,i))return null;const n=i.getUint32(or.ENDIANNESS,!0)===kD,o=i.getUint32(or.GL_TYPE,n),l=i.getUint32(or.GL_FORMAT,n),h=i.getUint32(or.GL_INTERNAL_FORMAT,n),u=i.getUint32(or.PIXEL_WIDTH,n),f=i.getUint32(or.PIXEL_HEIGHT,n)||1,d=i.getUint32(or.PIXEL_DEPTH,n)||1,g=i.getUint32(or.NUMBER_OF_ARRAY_ELEMENTS,n)||1,m=i.getUint32(or.NUMBER_OF_FACES,n),v=i.getUint32(or.NUMBER_OF_MIPMAP_LEVELS,n),_=i.getUint32(or.BYTES_OF_KEY_VALUE_DATA,n);if(f===0||d!==1)throw new Error("Only 2D textures are supported");if(m!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(g!==1)throw new Error("WebGL does not support array textures");const w=4,x=4,A=u+3&-4,S=f+3&-4,E=new Array(g);let I=u*f;o===0&&(I=A*S);let D;if(o!==0?yg[o]?D=yg[o]*UD[l]:D=GD[o]:D=Ma[h],D===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const L=r?XD(i,_,n):null;let F=I*D,X=u,j=f,z=A,K=S,W=Hu+_;for(let k=0;k<v;k++){const at=i.getUint32(W,n);let dt=W+4;for(let Y=0;Y<g;Y++){let yt=E[Y];yt||(yt=E[Y]=new Array(v)),yt[k]={levelID:k,levelWidth:v>1||o!==0?X:z,levelHeight:v>1||o!==0?j:K,levelBuffer:new Uint8Array(t,dt,F)},dt+=F}W+=at+4,W=W%4!==0?W+4-W%4:W,X=X>>1||1,j=j>>1||1,z=X+w-1&~(w-1),K=j+x-1&~(x-1),F=z*K*D}return o!==0?{uncompressed:E.map(k=>{let at=k[0].levelBuffer,dt=!1;return o===st.FLOAT?at=new Float32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4):o===st.UNSIGNED_INT?(dt=!0,at=new Uint32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4)):o===st.INT&&(dt=!0,at=new Int32Array(k[0].levelBuffer.buffer,k[0].levelBuffer.byteOffset,k[0].levelBuffer.byteLength/4)),{resource:new Us(at,{width:k[0].levelWidth,height:k[0].levelHeight}),type:o,format:dt?HD(l):l}}),kvData:L}:{compressed:E.map(k=>new $i(null,{format:h,width:u,height:f,levels:v,levelBuffers:k})),kvData:L}}function $D(e,t){for(let r=0;r<vg.length;r++)if(t.getUint8(r)!==vg[r])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}function HD(e){switch(e){case V.RGBA:return V.RGBA_INTEGER;case V.RGB:return V.RGB_INTEGER;case V.RG:return V.RG_INTEGER;case V.RED:return V.RED_INTEGER;default:return e}}function XD(e,t,r){const i=new Map;let n=0;for(;n<t;){const o=e.getUint32(Hu+n,r),l=Hu+n+4,h=3-(o+3)%4;if(o===0||o>t-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let u=0;for(;u<o&&e.getUint8(l+u)!==0;u++);if(u===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const f=new TextDecoder().decode(new Uint8Array(e.buffer,l,u)),d=new DataView(e.buffer,l+u+1,o-u-1);i.set(f,d),n+=4+o+h}return i}const zD={extension:{type:Z.LoadParser,priority:Br.High},test(e){return za(e,".dds")},async load(e,t,r){const n=await(await J.ADAPTER.fetch(e)).arrayBuffer(),l=ND(n).map(h=>{const u=new gt(h,{mipmap:Dr.OFF,alphaMode:vr.NO_PREMULTIPLIED_ALPHA,resolution:fi(e),...t.data});return Va(u,r,e)});return l.length===1?l[0]:l},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};nt.add(zD);const VD={extension:{type:Z.LoadParser,priority:Br.High},test(e){return za(e,".ktx")},async load(e,t,r){const n=await(await J.ADAPTER.fetch(e)).arrayBuffer(),{compressed:o,uncompressed:l,kvData:h}=WD(e,n),u=o??l,f={mipmap:Dr.OFF,alphaMode:vr.NO_PREMULTIPLIED_ALPHA,resolution:fi(e),...t.data},d=u.map(g=>{u===l&&Object.assign(f,{type:g.type,format:g.format});const m=new gt(g,f);return m.ktxKeyValueData=h,Va(m,r,e)});return d.length===1?d[0]:d},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};nt.add(VD);const YD={extension:Z.ResolveParser,test:e=>{const r=e.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(r)},parse:e=>{var i,n;if(e.split("?")[0].split(".").pop()==="ktx"){const o=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(o.some(l=>e.endsWith(l)))return{resolution:parseFloat(((i=J.RETINA_PREFIX.exec(e))==null?void 0:i[1])??"1"),format:o.find(l=>e.endsWith(l)),src:e}}return{resolution:parseFloat(((n=J.RETINA_PREFIX.exec(e))==null?void 0:n[1])??"1"),format:e.split(".").pop(),src:e}}};nt.add(YD);const _g=new Tt,xg=4,Xu=class{constructor(e){this.renderer=e}async image(e,t,r){const i=new Image;return i.src=await this.base64(e,t,r),i}async base64(e,t,r){const i=this.canvas(e);if(i.toDataURL!==void 0)return i.toDataURL(t,r);if(i.convertToBlob!==void 0){const n=await i.convertToBlob({type:t,quality:r});return await new Promise(o=>{const l=new FileReader;l.onload=()=>o(l.result),l.readAsDataURL(n)})}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(e,t){const r=this.renderer;let i,n=!1,o,l=!1;e&&(e instanceof gi?o=e:(o=this.renderer.generateTexture(e),l=!0)),o?(i=o.baseTexture.resolution,t=t??o.frame,n=!1,r.renderTexture.bind(o)):(i=r.resolution,t||(t=_g,t.width=r.width,t.height=r.height),n=!0,r.renderTexture.bind(null));const h=Math.round(t.width*i),u=Math.round(t.height*i);let f=new jp(h,u,1);const d=new Uint8Array(xg*h*u),g=r.gl;g.readPixels(Math.round(t.x*i),Math.round(t.y*i),h,u,g.RGBA,g.UNSIGNED_BYTE,d);const m=f.context.getImageData(0,0,h,u);if(Xu.arrayPostDivide(d,m.data),f.context.putImageData(m,0,0),n){const v=new jp(f.width,f.height,1);v.context.scale(1,-1),v.context.drawImage(f.canvas,0,-u),f.destroy(),f=v}return l&&o.destroy(!0),f.canvas}pixels(e,t){const r=this.renderer;let i,n,o=!1;e&&(e instanceof gi?n=e:(n=this.renderer.generateTexture(e),o=!0)),n?(i=n.baseTexture.resolution,t=t??n.frame,r.renderTexture.bind(n)):(i=r.resolution,t||(t=_g,t.width=r.width,t.height=r.height),r.renderTexture.bind(null));const l=Math.round(t.width*i),h=Math.round(t.height*i),u=new Uint8Array(xg*l*h),f=r.gl;return f.readPixels(Math.round(t.x*i),Math.round(t.y*i),l,h,f.RGBA,f.UNSIGNED_BYTE,u),o&&n.destroy(!0),Xu.arrayPostDivide(u,u),u}destroy(){this.renderer=null}static arrayPostDivide(e,t){for(let r=0;r<e.length;r+=4){const i=t[r+3]=e[r+3];i!==0?(t[r]=Math.round(Math.min(e[r]*255/i,255)),t[r+1]=Math.round(Math.min(e[r+1]*255/i,255)),t[r+2]=Math.round(Math.min(e[r+2]*255/i,255))):(t[r]=e[r],t[r+1]=e[r+1],t[r+2]=e[r+2])}}};let wv=Xu;wv.extension={name:"extract",type:Z.RendererSystem};nt.add(wv);const Da={build(e){const t=e.points;let r,i,n,o,l,h;if(e.type===me.CIRC){const _=e.shape;r=_.x,i=_.y,l=h=_.radius,n=o=0}else if(e.type===me.ELIP){const _=e.shape;r=_.x,i=_.y,l=_.width,h=_.height,n=o=0}else{const _=e.shape,w=_.width/2,x=_.height/2;r=_.x+w,i=_.y+x,l=h=Math.max(0,Math.min(_.radius,Math.min(w,x))),n=w-l,o=x-h}if(!(l>=0&&h>=0&&n>=0&&o>=0)){t.length=0;return}const u=Math.ceil(2.3*Math.sqrt(l+h)),f=u*8+(n?4:0)+(o?4:0);if(t.length=f,f===0)return;if(u===0){t.length=8,t[0]=t[6]=r+n,t[1]=t[3]=i+o,t[2]=t[4]=r-n,t[5]=t[7]=i-o;return}let d=0,g=u*4+(n?2:0)+2,m=g,v=f;{const _=n+l,w=o,x=r+_,A=r-_,S=i+w;if(t[d++]=x,t[d++]=S,t[--g]=S,t[--g]=A,o){const E=i-w;t[m++]=A,t[m++]=E,t[--v]=E,t[--v]=x}}for(let _=1;_<u;_++){const w=Math.PI/2*(_/u),x=n+Math.cos(w)*l,A=o+Math.sin(w)*h,S=r+x,E=r-x,I=i+A,D=i-A;t[d++]=S,t[d++]=I,t[--g]=I,t[--g]=E,t[m++]=E,t[m++]=D,t[--v]=D,t[--v]=S}{const _=n,w=o+h,x=r+_,A=r-_,S=i+w,E=i-w;t[d++]=x,t[d++]=S,t[--v]=E,t[--v]=x,n&&(t[d++]=A,t[d++]=S,t[--v]=E,t[--v]=A)}},triangulate(e,t){const r=e.points,i=t.points,n=t.indices;if(r.length===0)return;let o=i.length/2;const l=o;let h,u;if(e.type!==me.RREC){const d=e.shape;h=d.x,u=d.y}else{const d=e.shape;h=d.x+d.width/2,u=d.y+d.height/2}const f=e.matrix;i.push(e.matrix?f.a*h+f.c*u+f.tx:h,e.matrix?f.b*h+f.d*u+f.ty:u),o++,i.push(r[0],r[1]);for(let d=2;d<r.length;d+=2)i.push(r[d],r[d+1]),n.push(o++,l,o);n.push(l+1,l,o)}};function bg(e,t=!1){const r=e.length;if(r<6)return;let i=0;for(let n=0,o=e[r-2],l=e[r-1];n<r;n+=2){const h=e[n],u=e[n+1];i+=(h-o)*(u+l),o=h,l=u}if(!t&&i>0||t&&i<=0){const n=r/2;for(let o=n+n%2;o<r;o+=2){const l=r-o-2,h=r-o-1,u=o,f=o+1;[e[l],e[u]]=[e[u],e[l]],[e[h],e[f]]=[e[f],e[h]]}}}const Ev={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let r=e.points;const i=e.holes,n=t.points,o=t.indices;if(r.length>=6){bg(r,!1);const l=[];for(let f=0;f<i.length;f++){const d=i[f];bg(d.points,!0),l.push(r.length/2),r=r.concat(d.points)}const h=xT(r,l,2);if(!h)return;const u=n.length/2;for(let f=0;f<h.length;f+=3)o.push(h[f]+u),o.push(h[f+1]+u),o.push(h[f+2]+u);for(let f=0;f<r.length;f++)n.push(r[f])}}},jD={build(e){const t=e.shape,r=t.x,i=t.y,n=t.width,o=t.height,l=e.points;l.length=0,n>=0&&o>=0&&l.push(r,i,r+n,i,r+n,i+o,r,i+o)},triangulate(e,t){const r=e.points,i=t.points;if(r.length===0)return;const n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},qD={build(e){Da.build(e)},triangulate(e,t){Da.triangulate(e,t)}};var ai=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(ai||{}),Ni=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))(Ni||{});const Un={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};class wg{static curveTo(t,r,i,n,o,l){const h=l[l.length-2],f=l[l.length-1]-r,d=h-t,g=n-r,m=i-t,v=Math.abs(f*m-d*g);if(v<1e-8||o===0)return(l[l.length-2]!==t||l[l.length-1]!==r)&&l.push(t,r),null;const _=f*f+d*d,w=g*g+m*m,x=f*g+d*m,A=o*Math.sqrt(_)/v,S=o*Math.sqrt(w)/v,E=A*x/_,I=S*x/w,D=A*m+S*d,L=A*g+S*f,O=d*(S+E),F=f*(S+E),X=m*(A+I),j=g*(A+I),z=Math.atan2(F-L,O-D),K=Math.atan2(j-L,X-D);return{cx:D+t,cy:L+r,radius:o,startAngle:z,endAngle:K,anticlockwise:d*g>m*f}}static arc(t,r,i,n,o,l,h,u,f){const d=h-l,g=Un._segmentsCount(Math.abs(d)*o,Math.ceil(Math.abs(d)/Ca)*40),m=d/(g*2),v=m*2,_=Math.cos(m),w=Math.sin(m),x=g-1,A=x%1/x;for(let S=0;S<=x;++S){const E=S+A*S,I=m+l+v*E,D=Math.cos(I),L=-Math.sin(I);f.push((_*D+w*L)*o+i,(_*-L+w*D)*o+n)}}}class KD{constructor(){this.reset()}begin(t,r,i){this.reset(),this.style=t,this.start=r,this.attribStart=i}end(t,r){this.attribSize=r-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class yc{static curveLength(t,r,i,n,o,l,h,u){let d=0,g=0,m=0,v=0,_=0,w=0,x=0,A=0,S=0,E=0,I=0,D=t,L=r;for(let O=1;O<=10;++O)g=O/10,m=g*g,v=m*g,_=1-g,w=_*_,x=w*_,A=x*t+3*w*g*i+3*_*m*o+v*h,S=x*r+3*w*g*n+3*_*m*l+v*u,E=D-A,I=L-S,D=A,L=S,d+=Math.sqrt(E*E+I*I);return d}static curveTo(t,r,i,n,o,l,h){const u=h[h.length-2],f=h[h.length-1];h.length-=2;const d=Un._segmentsCount(yc.curveLength(u,f,t,r,i,n,o,l));let g=0,m=0,v=0,_=0,w=0;h.push(u,f);for(let x=1,A=0;x<=d;++x)A=x/d,g=1-A,m=g*g,v=m*g,_=A*A,w=_*A,h.push(v*u+3*m*A*t+3*g*_*i+w*o,v*f+3*m*A*r+3*g*_*n+w*l)}}function Eg(e,t,r,i,n,o,l,h){const u=e-r*n,f=t-i*n,d=e+r*o,g=t+i*o;let m,v;l?(m=i,v=-r):(m=-i,v=r);const _=u+m,w=f+v,x=d+m,A=g+v;return h.push(_,w),h.push(x,A),2}function Pi(e,t,r,i,n,o,l,h){const u=r-e,f=i-t;let d=Math.atan2(u,f),g=Math.atan2(n-e,o-t);h&&d<g?d+=Math.PI*2:!h&&d>g&&(g+=Math.PI*2);let m=d;const v=g-d,_=Math.abs(v),w=Math.sqrt(u*u+f*f),x=(15*_*Math.sqrt(w)/Math.PI>>0)+1,A=v/x;if(m+=A,h){l.push(e,t),l.push(r,i);for(let S=1,E=m;S<x;S++,E+=A)l.push(e,t),l.push(e+Math.sin(E)*w,t+Math.cos(E)*w);l.push(e,t),l.push(n,o)}else{l.push(r,i),l.push(e,t);for(let S=1,E=m;S<x;S++,E+=A)l.push(e+Math.sin(E)*w,t+Math.cos(E)*w),l.push(e,t);l.push(n,o),l.push(e,t)}return x*2}function ZD(e,t){const r=e.shape;let i=e.points||r.points.slice();const n=t.closePointEps;if(i.length===0)return;const o=e.lineStyle,l=new St(i[0],i[1]),h=new St(i[i.length-2],i[i.length-1]),u=r.type!==me.POLY||r.closeStroke,f=Math.abs(l.x-h.x)<n&&Math.abs(l.y-h.y)<n;if(u){i=i.slice(),f&&(i.pop(),i.pop(),h.set(i[i.length-2],i[i.length-1]));const Y=(l.x+h.x)*.5,yt=(h.y+l.y)*.5;i.unshift(Y,yt),i.push(Y,yt)}const d=t.points,g=i.length/2;let m=i.length;const v=d.length/2,_=o.width/2,w=_*_,x=o.miterLimit*o.miterLimit;let A=i[0],S=i[1],E=i[2],I=i[3],D=0,L=0,O=-(S-I),F=A-E,X=0,j=0,z=Math.sqrt(O*O+F*F);O/=z,F/=z,O*=_,F*=_;const K=o.alignment,W=(1-K)*2,k=K*2;u||(o.cap===Ni.ROUND?m+=Pi(A-O*(W-k)*.5,S-F*(W-k)*.5,A-O*W,S-F*W,A+O*k,S+F*k,d,!0)+2:o.cap===Ni.SQUARE&&(m+=Eg(A,S,O,F,W,k,!0,d))),d.push(A-O*W,S-F*W),d.push(A+O*k,S+F*k);for(let Y=1;Y<g-1;++Y){A=i[(Y-1)*2],S=i[(Y-1)*2+1],E=i[Y*2],I=i[Y*2+1],D=i[(Y+1)*2],L=i[(Y+1)*2+1],O=-(S-I),F=A-E,z=Math.sqrt(O*O+F*F),O/=z,F/=z,O*=_,F*=_,X=-(I-L),j=E-D,z=Math.sqrt(X*X+j*j),X/=z,j/=z,X*=_,j*=_;const yt=E-A,Ot=S-I,H=E-D,rt=L-I,bt=yt*H+Ot*rt,Pt=Ot*H-rt*yt,Mt=Pt<0;if(Math.abs(Pt)<.001*Math.abs(bt)){d.push(E-O*W,I-F*W),d.push(E+O*k,I+F*k),bt>=0&&(o.join===ai.ROUND?m+=Pi(E,I,E-O*W,I-F*W,E-X*W,I-j*W,d,!1)+4:m+=2,d.push(E-X*k,I-j*k),d.push(E+X*W,I+j*W));continue}const Nt=(-O+A)*(-F+I)-(-O+E)*(-F+S),kt=(-X+D)*(-j+I)-(-X+E)*(-j+L),ie=(yt*kt-H*Nt)/Pt,Yt=(rt*Nt-Ot*kt)/Pt,ne=(ie-E)*(ie-E)+(Yt-I)*(Yt-I),oe=E+(ie-E)*W,Dt=I+(Yt-I)*W,Ut=E-(ie-E)*k,jt=I-(Yt-I)*k,qt=Math.min(yt*yt+Ot*Ot,H*H+rt*rt),ye=Mt?W:k,vi=qt+ye*ye*w;ne<=vi?o.join===ai.BEVEL||ne/w>x?(Mt?(d.push(oe,Dt),d.push(E+O*k,I+F*k),d.push(oe,Dt),d.push(E+X*k,I+j*k)):(d.push(E-O*W,I-F*W),d.push(Ut,jt),d.push(E-X*W,I-j*W),d.push(Ut,jt)),m+=2):o.join===ai.ROUND?Mt?(d.push(oe,Dt),d.push(E+O*k,I+F*k),m+=Pi(E,I,E+O*k,I+F*k,E+X*k,I+j*k,d,!0)+4,d.push(oe,Dt),d.push(E+X*k,I+j*k)):(d.push(E-O*W,I-F*W),d.push(Ut,jt),m+=Pi(E,I,E-O*W,I-F*W,E-X*W,I-j*W,d,!1)+4,d.push(E-X*W,I-j*W),d.push(Ut,jt)):(d.push(oe,Dt),d.push(Ut,jt)):(d.push(E-O*W,I-F*W),d.push(E+O*k,I+F*k),o.join===ai.ROUND?Mt?m+=Pi(E,I,E+O*k,I+F*k,E+X*k,I+j*k,d,!0)+2:m+=Pi(E,I,E-O*W,I-F*W,E-X*W,I-j*W,d,!1)+2:o.join===ai.MITER&&ne/w<=x&&(Mt?(d.push(Ut,jt),d.push(Ut,jt)):(d.push(oe,Dt),d.push(oe,Dt)),m+=2),d.push(E-X*W,I-j*W),d.push(E+X*k,I+j*k),m+=2)}A=i[(g-2)*2],S=i[(g-2)*2+1],E=i[(g-1)*2],I=i[(g-1)*2+1],O=-(S-I),F=A-E,z=Math.sqrt(O*O+F*F),O/=z,F/=z,O*=_,F*=_,d.push(E-O*W,I-F*W),d.push(E+O*k,I+F*k),u||(o.cap===Ni.ROUND?m+=Pi(E-O*(W-k)*.5,I-F*(W-k)*.5,E-O*W,I-F*W,E+O*k,I+F*k,d,!1)+2:o.cap===Ni.SQUARE&&(m+=Eg(E,I,O,F,W,k,!1,d)));const at=t.indices,dt=Un.epsilon*Un.epsilon;for(let Y=v;Y<m+v-2;++Y)A=d[Y*2],S=d[Y*2+1],E=d[(Y+1)*2],I=d[(Y+1)*2+1],D=d[(Y+2)*2],L=d[(Y+2)*2+1],!(Math.abs(A*(I-L)+E*(L-S)+D*(S-I))<dt)&&at.push(Y,Y+1,Y+2)}function JD(e,t){let r=0;const i=e.shape,n=e.points||i.points,o=i.type!==me.POLY||i.closeStroke;if(n.length===0)return;const l=t.points,h=t.indices,u=n.length/2,f=l.length/2;let d=f;for(l.push(n[0],n[1]),r=1;r<u;r++)l.push(n[r*2],n[r*2+1]),h.push(d,d+1),d++;o&&h.push(d,f)}function Tg(e,t){e.lineStyle.native?JD(e,t):ZD(e,t)}class _c{static curveLength(t,r,i,n,o,l){const h=t-2*i+o,u=r-2*n+l,f=2*i-2*t,d=2*n-2*r,g=4*(h*h+u*u),m=4*(h*f+u*d),v=f*f+d*d,_=2*Math.sqrt(g+m+v),w=Math.sqrt(g),x=2*g*w,A=2*Math.sqrt(v),S=m/w;return(x*_+w*m*(_-A)+(4*v*g-m*m)*Math.log((2*w+S+_)/(S+A)))/(4*x)}static curveTo(t,r,i,n,o){const l=o[o.length-2],h=o[o.length-1],u=Un._segmentsCount(_c.curveLength(l,h,t,r,i,n));let f=0,d=0;for(let g=1;g<=u;++g){const m=g/u;f=l+(t-l)*m,d=h+(r-h)*m,o.push(f+(t+(i-t)*m-f)*m,d+(r+(n-r)*m-d)*m)}}}const qh={[me.POLY]:Ev,[me.CIRC]:Da,[me.ELIP]:Da,[me.RECT]:jD,[me.RREC]:qD},Ag=[],Jo=[];class Ba{constructor(t,r=null,i=null,n=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=r,this.matrix=n,this.type=t.type}clone(){return new Ba(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const yn=new St,Tv=class extends Im{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Ia,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Jo.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t.reset(),Ag.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,r=null,i=null){const n=new Ba(e,t,r,i);return this.graphicsData.push(n),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;const r=new Ba(e,null,null,t),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const t=this.graphicsData;for(let r=0;r<t.length;++r){const i=t[r];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,yn):yn.copyFrom(e),i.shape.contains(yn.x,yn.y))){let n=!1;if(i.holes){for(let o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(yn.x,yn.y)){n=!0;break}}if(!n)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,t=this.graphicsData;let r=null,i=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],i=r.style);for(let h=this.shapeIndex;h<t.length;h++){this.shapeIndex++;const u=t[h],f=u.fillStyle,d=u.lineStyle;qh[u.type].build(u),u.matrix&&this.transformPoints(u.points,u.matrix),(f.visible||d.visible)&&this.processHoles(u.holes);for(let m=0;m<2;m++){const v=m===0?f:d;if(!v.visible)continue;const _=v.texture.baseTexture,w=this.indices.length,x=this.points.length/2;_.wrapMode=ci.REPEAT,m===0?this.processFill(u):this.processLine(u);const A=this.points.length/2-x;A!==0&&(r&&!this._compareStyles(i,v)&&(r.end(w,x),r=null),r||(r=Ag.pop()||new KD,r.begin(v,w,x),this.batches.push(r),i=v),this.addUvs(this.points,e,v.texture,x,A,v.matrix))}}const n=this.indices.length,o=this.points.length/2;if(r&&r.end(n,o),this.batches.length===0){this.batchable=!0;return}const l=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&l===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=l?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){const r=this.graphicsData[e],i=r.fillStyle,n=r.lineStyle;if(i&&!i.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let t=0,r=e.length;t<r;t++){const i=e[t];for(let n=0;n<i.size;n++){const o=i.start+n;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<Tv.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++gt._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),Jo.push(this.drawCalls[d]);this.drawCalls.length=0;const t=this.colors,r=this.textureIds;let i=Jo.pop();i||(i=new Mu,i.texArray=new Bu),i.texArray.count=0,i.start=0,i.size=0,i.type=Pr.TRIANGLES;let n=0,o=null,l=0,h=!1,u=Pr.TRIANGLES,f=0;this.drawCalls.push(i);for(let d=0;d<this.batches.length;d++){const g=this.batches[d],m=8,v=g.style,_=v.texture.baseTexture;h!==!!v.native&&(h=!!v.native,u=h?Pr.LINES:Pr.TRIANGLES,o=null,n=m,e++),o!==_&&(o=_,_._batchEnabled!==e&&(n===m&&(e++,n=0,i.size>0&&(i=Jo.pop(),i||(i=new Mu,i.texArray=new Bu),this.drawCalls.push(i)),i.start=f,i.size=0,i.texArray.count=0,i.type=u),_.touched=1,_._batchEnabled=e,_._batchLocation=n,_.wrapMode=ci.REPEAT,i.texArray.elements[i.texArray.count++]=_,n++)),i.size+=g.size,f+=g.size,l=_._batchLocation,this.addColors(t,v.color,v.alpha,g.attribSize,g.attribStart),this.addTextureIds(r,l,g.attribSize,g.attribStart)}gt._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,t=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(e.length*3*4),o=new Float32Array(n),l=new Uint32Array(n);let h=0;for(let u=0;u<e.length/2;u++)o[h++]=e[u*2],o[h++]=e[u*2+1],o[h++]=t[u*2],o[h++]=t[u*2+1],l[h++]=r[u],o[h++]=i[u];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?Ev.triangulate(e,this):qh[e.type].triangulate(e,this)}processLine(e){Tg(e,this);for(let t=0;t<e.holes.length;t++)Tg(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){const r=e[t];qh[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let r=0;r<e.length/2;r++){const i=e[r*2],n=e[r*2+1];e[r*2]=t.a*i+t.c*n+t.tx,e[r*2+1]=t.b*i+t.d*n+t.ty}}addColors(e,t,r,i,n=0){const o=(t>>16)+(t&65280)+((t&255)<<16),l=cc(o,r);e.length=Math.max(e.length,n+i);for(let h=0;h<i;h++)e[n+h]=l}addTextureIds(e,t,r,i=0){e.length=Math.max(e.length,i+r);for(let n=0;n<r;n++)e[i+n]=t}addUvs(e,t,r,i,n,o=null){let l=0;const h=t.length,u=r.frame;for(;l<n;){let d=e[(i+l)*2],g=e[(i+l)*2+1];if(o){const m=o.a*d+o.c*g+o.tx;g=o.b*d+o.d*g+o.ty,d=m}l++,t.push(d/u.width,g/u.height)}const f=r.baseTexture;(u.width<f.width||u.height<f.height)&&this.adjustUvs(t,r,h,n)}adjustUvs(e,t,r,i){const n=t.baseTexture,o=1e-6,l=r+i*2,h=t.frame,u=h.width/n.width,f=h.height/n.height;let d=h.x/h.width,g=h.y/h.height,m=Math.floor(e[r]+o),v=Math.floor(e[r+1]+o);for(let _=r+2;_<l;_+=2)m=Math.min(m,Math.floor(e[_]+o)),v=Math.min(v,Math.floor(e[_+1]+o));d-=m,g-=v;for(let _=r;_<l;_+=2)e[_]=(e[_]+d)*u,e[_+1]=(e[_+1]+g)*f}};let Av=Tv;Av.BATCHABLE_SIZE=100;class Ya{constructor(){this.color=16777215,this.alpha=1,this.texture=it.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new Ya;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=it.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class xc extends Ya{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Ni.BUTT,this.join=ai.MITER,this.miterLimit=10}clone(){const t=new xc;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const QD=new Float32Array(3),Kh={},da=class extends Ge{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Ya,this._lineStyle=new xc,this._matrix=null,this._holeMode=!1,this.state=qr.for2d(),this._geometry=e||new Av,this._geometry.refCount++,this._transformID=-1,this.tint=16777215,this.blendMode=ut.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new da(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(e){this._tint=e}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,r=1,i=.5,n=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:r,alignment:i,native:n}),this.lineTextureStyle(e)}lineTextureStyle(e){e=Object.assign({width:0,texture:it.WHITE,color:e!=null&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Ni.BUTT,join:ai.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();const t=e.width>0&&e.alpha>0;return t?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:t},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Bn,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Bn,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);const r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return(i!==e||n!==t)&&r.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,r,i){this._initCurve();const n=this.currentPath.points;return n.length===0&&this.moveTo(0,0),_c.curveTo(e,t,r,i,n),this}bezierCurveTo(e,t,r,i,n,o){return this._initCurve(),yc.curveTo(e,t,r,i,n,o,this.currentPath.points),this}arcTo(e,t,r,i,n){this._initCurve(e,t);const o=this.currentPath.points,l=wg.curveTo(e,t,r,i,n,o);if(l){const{cx:h,cy:u,radius:f,startAngle:d,endAngle:g,anticlockwise:m}=l;this.arc(h,u,f,d,g,m)}return this}arc(e,t,r,i,n,o=!1){if(i===n)return this;if(!o&&n<=i?n+=Ca:o&&i<=n&&(i+=Ca),n-i===0)return this;const h=e+Math.cos(i)*r,u=t+Math.sin(i)*r,f=this._geometry.closePointEps;let d=this.currentPath?this.currentPath.points:null;if(d){const g=Math.abs(d[d.length-2]-h),m=Math.abs(d[d.length-1]-u);g<f&&m<f||d.push(h,u)}else this.moveTo(h,u),d=this.currentPath.points;return wg.arc(h,u,e,t,r,i,n,o,d),this}beginFill(e=0,t=1){return this.beginTextureFill({texture:it.WHITE,color:e,alpha:t})}beginTextureFill(e){e=Object.assign({texture:it.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();const t=e.alpha>0;return t?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:t},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,r,i){return this.drawShape(new Tt(e,t,r,i))}drawRoundedRect(e,t,r,i,n){return this.drawShape(new pc(e,t,r,i,n))}drawCircle(e,t,r){return this.drawShape(new fc(e,t,r))}drawEllipse(e,t,r,i){return this.drawShape(new dc(e,t,r,i))}drawPolygon(...e){let t,r=!0;const i=e[0];i.points?(r=i.closeStroke,t=i.points):Array.isArray(e[0])?t=e[0]:t=e;const n=new Bn(t);return n.closeStroke=r,this.drawShape(n),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===me.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,t=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(let i=0;i<r;i++){const n=e.batches[i],o=n.style.color,l=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),h=new Float32Array(e.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),u=new Uint16Array(e.indicesUint16.buffer,n.start*2,n.size),f={vertexData:l,blendMode:t,indices:u,uvs:h,_batchRGB:Ms(o),_tintRGB:o,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[i]=f}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,r=this.batches.length;t<r;t++){const i=this.batches[t];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){const t=this._resolveDirectShader(e),r=this._geometry,i=this.tint,n=this.worldAlpha,o=t.uniforms,l=r.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(i>>16&255)/255*n,o.tint[1]=(i>>8&255)/255*n,o.tint[2]=(i&255)/255*n,o.tint[3]=n,e.shader.bind(t),e.geometry.bind(r,t),e.state.set(this.state);for(let h=0,u=l.length;h<u;h++)this._renderDrawCallDirect(e,r.drawCalls[h])}_renderDrawCallDirect(e,t){const{texArray:r,type:i,size:n,start:o}=t,l=r.count;for(let h=0;h<l;h++)e.texture.bind(r.elements[h],h);e.geometry.draw(i,n,o)}_resolveDirectShader(e){let t=this.shader;const r=this.pluginName;if(!t){if(!Kh[r]){const{maxTextures:i}=e.plugins[r],n=new Int32Array(i);for(let h=0;h<i;h++)n[h]=h;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new $t,default:mr.from({uSamplers:n},!0)},l=e.plugins[r]._shader.program;Kh[r]=new Mr(l,o)}t=Kh[r]}return t}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:t,minY:r,maxX:i,maxY:n}=e.bounds;this._bounds.addFrame(this.transform,t,r,i,n)}containsPoint(e){return this.worldTransform.applyInverse(e,da._TEMP_POINT),this._geometry.containsPoint(da._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const e=Ms(this.tint,QD);for(let t=0;t<this.batches.length;t++){const r=this.batches[t],i=r._batchRGB,n=e[0]*i[0]*255,o=e[1]*i[1]*255,l=e[2]*i[2]*255,h=(n<<16)+(o<<8)+(l|0);r._tintRGB=(h>>16)+(h&65280)+((h&255)<<16)}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const t=this.transform.worldTransform,r=t.a,i=t.b,n=t.c,o=t.d,l=t.tx,h=t.ty,u=this._geometry.points,f=this.vertexData;let d=0;for(let g=0;g<u.length;g+=2){const m=u[g],v=u[g+1];f[d++]=r*m+n*v+l,f[d++]=o*v+i*m+h}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};let ja=da;ja.curves=Un;ja._TEMP_POINT=new St;class tB{constructor(t,r){this.uvBuffer=t,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}}const Zh=new St,Sg=new Bn,Sv=class extends Ge{constructor(e,t,r,i=Pr.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=r||qr.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=J.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Pr.TRIANGLES&&t.length<Sv.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const t=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;const i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){const t=this.geometry.buffers[0],r=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));const n=this.transform.worldTransform,o=n.a,l=n.b,h=n.c,u=n.d,f=n.tx,d=n.ty,g=this.vertexData;for(let m=0;m<g.length/2;m++){const v=r[m*2],_=r[m*2+1];g[m*2]=o*v+h*_+f,g[m*2+1]=l*v+u*_+d}if(this._roundPixels){const m=J.RESOLUTION;for(let v=0;v<g.length;++v)g[v]=Math.round(g[v]*m)/m}this.vertexDirty=i}calculateUvs(){const e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new tB(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Zh);const t=this.geometry.getBuffer("aVertexPosition").data,r=Sg.points,i=this.geometry.getIndex().data,n=i.length,o=this.drawMode===4?3:1;for(let l=0;l+2<n;l+=o){const h=i[l]*2,u=i[l+1]*2,f=i[l+2]*2;if(r[0]=t[h],r[1]=t[h+1],r[2]=t[u],r[3]=t[u+1],r[4]=t[f],r[5]=t[f+1],Sg.contains(Zh.x,Zh.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let zu=Sv;zu.BATCHABLE_SIZE=100;class eB extends di{constructor(t,r,i){super();const n=new re(t),o=new re(r,!0),l=new re(i,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,st.FLOAT).addAttribute("aTextureCoord",o,2,!1,st.FLOAT).addIndex(l),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var rB=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,iB=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Cg extends Mr{constructor(t,r){const i={uSampler:t,alpha:1,uTextureMatrix:$t.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(i,r.uniforms),super(r.program||fr.from(iB,rB),i),this._colorDirty=!1,this.uvMatrix=new Vm(t),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this.tint=r.tint,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16),this._colorDirty=!0)}get tint(){return this._tint}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture;Tm(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class Ig{constructor(t,r,i){this.geometry=new di,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let n=0;n<t.length;++n){let o=t[n];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||st.FLOAT,offset:o.offset},r[n]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let r=0;this.indexBuffer=new re(jP(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let l=0;l<this.dynamicProperties.length;++l){const h=this.dynamicProperties[l];h.offset=r,r+=h.size,this.dynamicStride+=h.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new re(this.dynamicData,!1,!1);let n=0;this.staticStride=0;for(let l=0;l<this.staticProperties.length;++l){const h=this.staticProperties[l];h.offset=n,n+=h.size,this.staticStride+=h.size}const o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new re(this.staticData,!0,!1);for(let l=0;l<this.dynamicProperties.length;++l){const h=this.dynamicProperties[l];t.addAttribute(h.attributeName,this.dynamicBuffer,0,h.type===st.UNSIGNED_BYTE,h.type,this.dynamicStride*4,h.offset*4)}for(let l=0;l<this.staticProperties.length;++l){const h=this.staticProperties[l];t.addAttribute(h.attributeName,this.staticBuffer,0,h.type===st.UNSIGNED_BYTE,h.type,this.staticStride*4,h.offset*4)}}uploadDynamic(t,r,i){for(let n=0;n<this.dynamicProperties.length;n++){const o=this.dynamicProperties[n];o.uploadFunction(t,r,i,o.type===st.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,r,i){for(let n=0;n<this.staticProperties.length;n++){const o=this.staticProperties[n];o.uploadFunction(t,r,i,o.type===st.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var nB=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,sB=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class Cv extends Xa{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new $t,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:st.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Mr.from(sB,nB,{}),this.state=qr.for2d()}render(t){const r=t.children,i=t._maxSize,n=t._batchSize,o=this.renderer;let l=r.length;if(l===0)return;l>i&&!t.autoResize&&(l=i);let h=t._buffers;h||(h=t._buffers=this.generateBuffers(t));const u=r[0]._texture.baseTexture,f=u.alphaMode>0;this.state.blendMode=Em(t.blendMode,f),o.state.set(this.state);const d=o.gl,g=t.worldTransform.copyTo(this.tempMatrix);g.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=g.toArray(!0),this.shader.uniforms.uColor=YP(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,f),this.shader.uniforms.uSampler=u,this.renderer.shader.bind(this.shader);let m=!1;for(let v=0,_=0;v<l;v+=n,_+=1){let w=l-v;w>n&&(w=n),_>=h.length&&h.push(this._generateOneMoreBuffer(t));const x=h[_];x.uploadDynamic(r,v,w);const A=t._bufferUpdateIDs[_]||0;m=m||x._updateID<A,m&&(x._updateID=t._updateID,x.uploadStatic(r,v,w)),o.geometry.bind(x.geometry),d.drawElements(d.TRIANGLES,w*6,d.UNSIGNED_SHORT,0)}}generateBuffers(t){const r=[],i=t._maxSize,n=t._batchSize,o=t._properties;for(let l=0;l<i;l+=n)r.push(new Ig(this.properties,o,n));return r}_generateOneMoreBuffer(t){const r=t._batchSize,i=t._properties;return new Ig(this.properties,i,r)}uploadVertices(t,r,i,n,o,l){let h=0,u=0,f=0,d=0;for(let g=0;g<i;++g){const m=t[r+g],v=m._texture,_=m.scale.x,w=m.scale.y,x=v.trim,A=v.orig;x?(u=x.x-m.anchor.x*A.width,h=u+x.width,d=x.y-m.anchor.y*A.height,f=d+x.height):(h=A.width*(1-m.anchor.x),u=A.width*-m.anchor.x,f=A.height*(1-m.anchor.y),d=A.height*-m.anchor.y),n[l]=u*_,n[l+1]=d*w,n[l+o]=h*_,n[l+o+1]=d*w,n[l+o*2]=h*_,n[l+o*2+1]=f*w,n[l+o*3]=u*_,n[l+o*3+1]=f*w,l+=o*4}}uploadPosition(t,r,i,n,o,l){for(let h=0;h<i;h++){const u=t[r+h].position;n[l]=u.x,n[l+1]=u.y,n[l+o]=u.x,n[l+o+1]=u.y,n[l+o*2]=u.x,n[l+o*2+1]=u.y,n[l+o*3]=u.x,n[l+o*3+1]=u.y,l+=o*4}}uploadRotation(t,r,i,n,o,l){for(let h=0;h<i;h++){const u=t[r+h].rotation;n[l]=u,n[l+o]=u,n[l+o*2]=u,n[l+o*3]=u,l+=o*4}}uploadUvs(t,r,i,n,o,l){for(let h=0;h<i;++h){const u=t[r+h]._texture._uvs;u?(n[l]=u.x0,n[l+1]=u.y0,n[l+o]=u.x1,n[l+o+1]=u.y1,n[l+o*2]=u.x2,n[l+o*2+1]=u.y2,n[l+o*3]=u.x3,n[l+o*3+1]=u.y3,l+=o*4):(n[l]=0,n[l+1]=0,n[l+o]=0,n[l+o+1]=0,n[l+o*2]=0,n[l+o*2+1]=0,n[l+o*3]=0,n[l+o*3+1]=0,l+=o*4)}}uploadTint(t,r,i,n,o,l){for(let h=0;h<i;++h){const u=t[r+h],f=u._texture.baseTexture.alphaMode>0,d=u.alpha,g=d<1&&f?cc(u._tintRGB,d):u._tintRGB+(d*255<<24);n[l]=g,n[l+o]=g,n[l+o*2]=g,n[l+o*3]=g,l+=o*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Cv.extension={name:"particle",type:Z.RendererPlugin};nt.add(Cv);var qa=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(qa||{});const Qo={willReadFrequently:!0},et=class{static get experimentalLetterSpacingSupported(){let e=et._experimentalLetterSpacingSupported;if(e!==void 0){const t=J.ADAPTER.getCanvasRenderingContext2D().prototype;e=et._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,r,i,n,o,l,h,u){this.text=e,this.style=t,this.width=r,this.height=i,this.lines=n,this.lineWidths=o,this.lineHeight=l,this.maxLineWidth=h,this.fontProperties=u}static measureText(e,t,r,i=et._canvas){r=r??t.wordWrap;const n=t.toFontString(),o=et.measureFont(n);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);const l=i.getContext("2d",Qo);l.font=n;const u=(r?et.wordWrap(e,t,i):e).split(/(?:\r\n|\r|\n)/),f=new Array(u.length);let d=0;for(let _=0;_<u.length;_++){const w=et._measureText(u[_],t.letterSpacing,l);f[_]=w,d=Math.max(d,w)}let g=d+t.strokeThickness;t.dropShadow&&(g+=t.dropShadowDistance);const m=t.lineHeight||o.fontSize+t.strokeThickness;let v=Math.max(m,o.fontSize+t.strokeThickness*2)+(u.length-1)*(m+t.leading);return t.dropShadow&&(v+=t.dropShadowDistance),new et(e,t,g,v,u,f,m+t.leading,d,o)}static _measureText(e,t,r){let i=!1;et.experimentalLetterSpacingSupported&&(et.experimentalLetterSpacing?(r.letterSpacing=`${t}px`,r.textLetterSpacing=`${t}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let n=r.measureText(e).width;return n>0&&(i?n-=t:n+=(et.graphemeSegmenter(e).length-1)*t),n}static wordWrap(e,t,r=et._canvas){const i=r.getContext("2d",Qo);let n=0,o="",l="";const h=Object.create(null),{letterSpacing:u,whiteSpace:f}=t,d=et.collapseSpaces(f),g=et.collapseNewlines(f);let m=!d;const v=t.wordWrapWidth+u,_=et.tokenize(e);for(let w=0;w<_.length;w++){let x=_[w];if(et.isNewline(x)){if(!g){l+=et.addLine(o),m=!d,o="",n=0;continue}x=" "}if(d){const S=et.isBreakingSpace(x),E=et.isBreakingSpace(o[o.length-1]);if(S&&E)continue}const A=et.getFromCache(x,u,h,i);if(A>v)if(o!==""&&(l+=et.addLine(o),o="",n=0),et.canBreakWords(x,t.breakWords)){const S=et.wordWrapSplit(x);for(let E=0;E<S.length;E++){let I=S[E],D=I,L=1;for(;S[E+L];){const F=S[E+L];if(!et.canBreakChars(D,F,x,E,t.breakWords))I+=F;else break;D=F,L++}E+=L-1;const O=et.getFromCache(I,u,h,i);O+n>v&&(l+=et.addLine(o),m=!1,o="",n=0),o+=I,n+=O}}else{o.length>0&&(l+=et.addLine(o),o="",n=0);const S=w===_.length-1;l+=et.addLine(x,!S),m=!1,o="",n=0}else A+n>v&&(m=!1,l+=et.addLine(o),o="",n=0),(o.length>0||!et.isBreakingSpace(x)||m)&&(o+=x,n+=A)}return l+=et.addLine(o,!1),l}static addLine(e,t=!0){return e=et.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,r,i){let n=r[e];return typeof n!="number"&&(n=et._measureText(e,t,i)+t,r[e]=n),n}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const r=e[t];if(!et.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:et._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:et._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const t=[];let r="";if(typeof e!="string")return t;for(let i=0;i<e.length;i++){const n=e[i],o=e[i+1];if(et.isBreakingSpace(n,o)||et.isNewline(n)){r!==""&&(t.push(r),r=""),t.push(n);continue}r+=n}return r!==""&&t.push(r),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,r,i,n){return!0}static wordWrapSplit(e){return et.graphemeSegmenter(e)}static measureFont(e){if(et._fonts[e])return et._fonts[e];const t={ascent:0,descent:0,fontSize:0},r=et._canvas,i=et._context;i.font=e;const n=et.METRICS_STRING+et.BASELINE_SYMBOL,o=Math.ceil(i.measureText(n).width);let l=Math.ceil(i.measureText(et.BASELINE_SYMBOL).width);const h=Math.ceil(et.HEIGHT_MULTIPLIER*l);if(l=l*et.BASELINE_MULTIPLIER|0,o===0||h===0)return et._fonts[e]=t,t;r.width=o,r.height=h,i.fillStyle="#f00",i.fillRect(0,0,o,h),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(n,0,l);const u=i.getImageData(0,0,o,h).data,f=u.length,d=o*4;let g=0,m=0,v=!1;for(g=0;g<l;++g){for(let _=0;_<d;_+=4)if(u[m+_]!==255){v=!0;break}if(!v)m+=d;else break}for(t.ascent=l-g,m=f-d,v=!1,g=h;g>l;--g){for(let _=0;_<d;_+=4)if(u[m+_]!==255){v=!0;break}if(!v)m-=d;else break}return t.descent=g-l,t.fontSize=t.ascent+t.descent,et._fonts[e]=t,t}static clearMetrics(e=""){e?delete et._fonts[e]:et._fonts={}}static get _canvas(){if(!et.__canvas){let e;try{const t=new OffscreenCanvas(0,0),r=t.getContext("2d",Qo);if(r!=null&&r.measureText)return et.__canvas=t,t;e=J.ADAPTER.createCanvas()}catch{e=J.ADAPTER.createCanvas()}e.width=e.height=10,et.__canvas=e}return et.__canvas}static get _context(){return et.__context||(et.__context=et._canvas.getContext("2d",Qo)),et.__context}};let ge=et;ge.METRICS_STRING="|ÉqÅ";ge.BASELINE_SYMBOL="M";ge.BASELINE_MULTIPLIER=1.4;ge.HEIGHT_MULTIPLIER=2;ge.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const e=new Intl.Segmenter;return t=>[...e.segment(t)].map(r=>r.segment)}return e=>[...e]})();ge.experimentalLetterSpacing=!1;ge._fonts={};ge._newlines=[10,13];ge._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const oB=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],bs=class{constructor(e){this.styleID=0,this.reset(),Qh(this,e,e)}clone(){const e={};return Qh(e,this,bs.defaultStyle),new bs(e)}reset(){Qh(this,bs.defaultStyle,bs.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const t=Jh(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const t=Jh(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){aB(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const t=Jh(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let r=t.length-1;r>=0;r--){let i=t[r].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!oB.includes(i)&&(i=`"${i}"`),t[r]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};let Vi=bs;Vi.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:qa.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function Pg(e){return typeof e=="number"?bm(e):(typeof e=="string"&&e.startsWith("0x")&&(e=e.replace("0x","#")),e)}function Jh(e){if(Array.isArray(e)){for(let t=0;t<e.length;++t)e[t]=Pg(e[t]);return e}else return Pg(e)}function aB(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}function Qh(e,t,r){for(const i in r)Array.isArray(t[i])?e[i]=t[i].slice():e[i]=t[i]}const lB={texture:!0,children:!1,baseTexture:!0},Vu=class extends Yn{constructor(e,t,r){let i=!1;r||(r=J.ADAPTER.createCanvas(),i=!0),r.width=3,r.height=3;const n=it.from(r);n.orig=new Tt,n.trim=new Tt,super(n),this._ownCanvas=i,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=Vu.defaultResolution??J.RESOLUTION,this._autoResolution=Vu.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return ge.experimentalLetterSpacing}static set experimentalLetterSpacing(e){Ct("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),ge.experimentalLetterSpacing=e}updateText(e){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const r=this.context,i=ge.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=i.width,o=i.height,l=i.lines,h=i.lineHeight,u=i.lineWidths,f=i.maxLineWidth,d=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+t.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=t.strokeThickness,r.textBaseline=t.textBaseline,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit;let g,m;const v=t.dropShadow?2:1;for(let _=0;_<v;++_){const w=t.dropShadow&&_===0,x=w?Math.ceil(Math.max(1,o)+t.padding*2):0,A=x*this._resolution;if(w){r.fillStyle="black",r.strokeStyle="black";const E=t.dropShadowColor,I=Ms(typeof E=="number"?E:uc(E)),D=t.dropShadowBlur*this._resolution,L=t.dropShadowDistance*this._resolution;r.shadowColor=`rgba(${I[0]*255},${I[1]*255},${I[2]*255},${t.dropShadowAlpha})`,r.shadowBlur=D,r.shadowOffsetX=Math.cos(t.dropShadowAngle)*L,r.shadowOffsetY=Math.sin(t.dropShadowAngle)*L+A}else r.fillStyle=this._generateFillStyle(t,l,i),r.strokeStyle=t.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let S=(h-d.fontSize)/2;h-d.fontSize<0&&(S=0);for(let E=0;E<l.length;E++)g=t.strokeThickness/2,m=t.strokeThickness/2+E*h+d.ascent+S,t.align==="right"?g+=f-u[E]:t.align==="center"&&(g+=(f-u[E])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(l[E],g+t.padding,m+t.padding-x,!0),t.fill&&this.drawLetterSpacing(l[E],g+t.padding,m+t.padding-x)}this.updateTexture()}drawLetterSpacing(e,t,r,i=!1){const o=this._style.letterSpacing;let l=!1;if(ge.experimentalLetterSpacingSupported&&(ge.experimentalLetterSpacing?(this.context.letterSpacing=`${o}px`,this.context.textLetterSpacing=`${o}px`,l=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),o===0||l){i?this.context.strokeText(e,t,r):this.context.fillText(e,t,r);return}let h=t;const u=ge.graphemeSegmenter(e);let f=this.context.measureText(e).width,d=0;for(let g=0;g<u.length;++g){const m=u[g];i?this.context.strokeText(m,h,r):this.context.fillText(m,h,r);let v="";for(let _=g+1;_<u.length;++_)v+=u[_];d=this.context.measureText(v).width,h+=f-d+o,f=d}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=ZP(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const t=this._texture,r=this._style,i=r.trim?0:r.padding,n=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-i*2,t.orig.height=t._frame.height-i*2,this._onTextureUpdate(),n.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,r){const i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let n;const o=e.dropShadow?e.dropShadowDistance:0,l=e.padding||0,h=this.canvas.width/this._resolution-o-l*2,u=this.canvas.height/this._resolution-o-l*2,f=i.slice(),d=e.fillGradientStops.slice();if(!d.length){const g=f.length+1;for(let m=1;m<g;++m)d.push(m/g)}if(f.unshift(i[0]),d.unshift(0),f.push(i[i.length-1]),d.push(1),e.fillGradientType===qa.LINEAR_VERTICAL){n=this.context.createLinearGradient(h/2,l,h/2,u+l);const g=r.fontProperties.fontSize+e.strokeThickness;for(let m=0;m<t.length;m++){const v=r.lineHeight*(m-1)+g,_=r.lineHeight*m;let w=_;m>0&&v>_&&(w=(_+v)/2);const x=_+g,A=r.lineHeight*(m+1);let S=x;m+1<t.length&&A<x&&(S=(x+A)/2);const E=(S-w)/u;for(let I=0;I<f.length;I++){let D=0;typeof d[I]=="number"?D=d[I]:D=I/f.length;let L=Math.min(1,Math.max(0,w/u+D*E));L=Number(L.toFixed(5)),n.addColorStop(L,f[I])}}}else{n=this.context.createLinearGradient(l,u/2,h+l,u/2);const g=f.length+1;let m=1;for(let v=0;v<f.length;v++){let _;typeof d[v]=="number"?_=d[v]:_=m/g,n.addColorStop(_,f[v]),m++}}return n}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},lB,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const t=An(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const t=An(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof Vi?this._style=e:this._style=new Vi(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};let bc=Vu;bc.defaultAutoResolution=!0;class hB{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function uB(e,t){var i;let r=!1;if((i=e==null?void 0:e._textures)!=null&&i.length){for(let n=0;n<e._textures.length;n++)if(e._textures[n]instanceof it){const o=e._textures[n].baseTexture;t.includes(o)||(t.push(o),r=!0)}}return r}function cB(e,t){if(e.baseTexture instanceof gt){const r=e.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function fB(e,t){if(e._texture&&e._texture instanceof it){const r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function dB(e,t){return t instanceof bc?(t.updateText(!0),!0):!1}function pB(e,t){if(t instanceof Vi){const r=t.toFontString();return ge.measureFont(r),!0}return!1}function gB(e,t){if(e instanceof bc){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);const r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function mB(e,t){return e instanceof Vi?(t.includes(e)||t.push(e),!0):!1}const Iv=class{constructor(e){this.limiter=new hB(Iv.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(gB),this.registerFindHook(mB),this.registerFindHook(uB),this.registerFindHook(cB),this.registerFindHook(fB),this.registerUploadHook(dB),this.registerUploadHook(pB)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,Me.system.addOnce(this.tick,this,kn.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let t=!1;if(e&&!e._destroyed){for(let r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Me.system.addOnce(this.tick,this,kn.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let t=0,r=e.length;t<r;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof Ge)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&Me.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Oa=Iv;Oa.uploadsPerFrame=4;Object.defineProperties(J,{UPLOADS_PER_FRAME:{get(){return Oa.uploadsPerFrame},set(e){Ct("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Oa.uploadsPerFrame=e}}});function Pv(e,t){return t instanceof gt?(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0):!1}function vB(e,t){if(!(t instanceof ja))return!1;const{geometry:r}=t;t.finishPoly(),r.updateBatches();const{batches:i}=r;for(let n=0;n<i.length;n++){const{texture:o}=i[n].style;o&&Pv(e,o.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function yB(e,t){return e instanceof ja?(t.push(e),!0):!1}class Rv extends Oa{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(yB),this.registerUploadHook(Pv),this.registerUploadHook(vB)}}Rv.extension={name:"prepare",type:Z.RendererSystem};nt.add(Rv);var _B=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,xB=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,bB=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,Rg=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,wB=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const ta=new $t;class Mv extends Xa{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new $m,this.state=qr.for2d()}contextChange(){const t=this.renderer,r={globals:t.globalUniforms};this.simpleShader=Mr.from(Rg,wB,r),this.shader=t.context.webGLVersion>1?Mr.from(xB,_B,r):Mr.from(Rg,bB,r)}render(t){const r=this.renderer,i=this.quad;let n=i.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y);const o=t.uvRespectAnchor?t.anchor.x:0,l=t.uvRespectAnchor?t.anchor.y:0;n=i.uvs,n[0]=n[6]=-o,n[1]=n[3]=-l,n[2]=n[4]=1-o,n[5]=n[7]=1-l,i.invalidate();const h=t._texture,u=h.baseTexture,f=u.alphaMode>0,d=t.tileTransform.localTransform,g=t.uvMatrix;let m=u.isPowerOfTwo&&h.frame.width===u.width&&h.frame.height===u.height;m&&(u._glTextures[r.CONTEXT_UID]?m=u.wrapMode!==ci.CLAMP:u.wrapMode===ci.CLAMP&&(u.wrapMode=ci.REPEAT));const v=m?this.simpleShader:this.shader,_=h.width,w=h.height,x=t._width,A=t._height;ta.set(d.a*_/x,d.b*_/A,d.c*w/x,d.d*w/A,d.tx/x,d.ty/A),ta.invert(),m?ta.prepend(g.mapCoord):(v.uniforms.uMapCoord=g.mapCoord.toArray(!0),v.uniforms.uClampFrame=g.uClampFrame,v.uniforms.uClampOffset=g.uClampOffset),v.uniforms.uTransform=ta.toArray(!0),v.uniforms.uColor=Tm(t.tint,t.worldAlpha,v.uniforms.uColor,f),v.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),v.uniforms.uSampler=h,r.shader.bind(v),r.geometry.bind(i),this.state.blendMode=Em(t.blendMode,f),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}Mv.extension={name:"tilingSprite",type:Z.RendererPlugin};nt.add(Mv);const ws=class{constructor(e,t,r=null){this.linkedSheets=[],this._texture=e instanceof it?e:null,this.baseTexture=e instanceof gt?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:t}=this.data.meta;let r=fi(e,null);return r===null&&(r=parseFloat(t??"1")),r!==1&&this.baseTexture.setResolution(r),r}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=ws.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const r=ws.BATCH_SIZE;for(;t-e<r&&t<this._frameKeys.length;){const i=this._frameKeys[t],n=this._frames[i],o=n.frame;if(o){let l=null,h=null;const u=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,f=new Tt(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);n.rotated?l=new Tt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):l=new Tt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(h=new Tt(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new it(this.baseTexture,l,f,h,n.rotated?2:0,n.anchor),it.addToCache(this.textures[i],i)}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let r=0;r<e[t].length;r++){const i=e[t][r];this.animations[t].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ws.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ws.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var t;for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let Yu=ws;Yu.BATCH_SIZE=1e3;const EB=["jpg","png","jpeg","avif","webp"];function Dv(e,t,r){const i={};if(e.forEach(n=>{i[n]=t}),Object.keys(t.textures).forEach(n=>{i[n]=t.textures[n]}),!r){const n=ve.dirname(e[0]);t.linkedSheets.forEach((o,l)=>{const h=Dv([`${n}/${t.data.meta.related_multi_packs[l]}`],o,!0);Object.assign(i,h)})}return i}const TB={extension:Z.Asset,cache:{test:e=>e instanceof Yu,getCacheableAssets:(e,t)=>Dv(e,t,!1)},resolver:{test:e=>{const r=e.split("?")[0].split("."),i=r.pop(),n=r.pop();return i==="json"&&EB.includes(n)},parse:e=>{var r;const t=e.split(".");return{resolution:parseFloat(((r=J.RETINA_PREFIX.exec(e))==null?void 0:r[1])??"1"),format:t[t.length-2],src:e}}},loader:{extension:{type:Z.LoadParser,priority:Br.Normal},async testParse(e,t){return ve.extname(t.src).toLowerCase()===".json"&&!!e.frames},async parse(e,t,r){var f,d;let i=ve.dirname(t.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");const n=i+e.meta.image,l=(await r.load([n]))[n],h=new Yu(l.baseTexture,e,t.src);await h.parse();const u=(f=e==null?void 0:e.meta)==null?void 0:f.related_multi_packs;if(Array.isArray(u)){const g=[];for(const v of u){if(typeof v!="string")continue;const _=i+v;(d=t.data)!=null&&d.ignoreMultiPack||g.push(r.load({src:_,data:{ignoreMultiPack:!0}}))}const m=await Promise.all(g);h.linkedSheets=m,m.forEach(v=>{v.linkedSheets=[h].concat(h.linkedSheets.filter(_=>_!==v))})}return h},unload(e){e.destroy(!0)}}};nt.add(TB);class Fa{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class pa{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const r=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const o in r){const l=r[o].match(/^[a-z]+/gm)[0],h=r[o].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),u={};for(const f in h){const d=h[f].split("="),g=d[0],m=d[1].replace(/"/gm,""),v=parseFloat(m),_=isNaN(v)?m:v;u[g]=_}i[l].push(u)}const n=new Fa;return i.info.forEach(o=>n.info.push({face:o.face,size:parseInt(o.size,10)})),i.common.forEach(o=>n.common.push({lineHeight:parseInt(o.lineHeight,10)})),i.page.forEach(o=>n.page.push({id:parseInt(o.id,10),file:o.file})),i.char.forEach(o=>n.char.push({id:parseInt(o.id,10),page:parseInt(o.page,10),x:parseInt(o.x,10),y:parseInt(o.y,10),width:parseInt(o.width,10),height:parseInt(o.height,10),xoffset:parseInt(o.xoffset,10),yoffset:parseInt(o.yoffset,10),xadvance:parseInt(o.xadvance,10)})),i.kerning.forEach(o=>n.kerning.push({first:parseInt(o.first,10),second:parseInt(o.second,10),amount:parseInt(o.amount,10)})),i.distanceField.forEach(o=>n.distanceField.push({distanceRange:parseInt(o.distanceRange,10),fieldType:o.fieldType})),n}}class ju{static test(t){const r=t;return"getElementsByTagName"in r&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const r=new Fa,i=t.getElementsByTagName("info"),n=t.getElementsByTagName("common"),o=t.getElementsByTagName("page"),l=t.getElementsByTagName("char"),h=t.getElementsByTagName("kerning"),u=t.getElementsByTagName("distanceField");for(let f=0;f<i.length;f++)r.info.push({face:i[f].getAttribute("face"),size:parseInt(i[f].getAttribute("size"),10)});for(let f=0;f<n.length;f++)r.common.push({lineHeight:parseInt(n[f].getAttribute("lineHeight"),10)});for(let f=0;f<o.length;f++)r.page.push({id:parseInt(o[f].getAttribute("id"),10)||0,file:o[f].getAttribute("file")});for(let f=0;f<l.length;f++){const d=l[f];r.char.push({id:parseInt(d.getAttribute("id"),10),page:parseInt(d.getAttribute("page"),10)||0,x:parseInt(d.getAttribute("x"),10),y:parseInt(d.getAttribute("y"),10),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10),xoffset:parseInt(d.getAttribute("xoffset"),10),yoffset:parseInt(d.getAttribute("yoffset"),10),xadvance:parseInt(d.getAttribute("xadvance"),10)})}for(let f=0;f<h.length;f++)r.kerning.push({first:parseInt(h[f].getAttribute("first"),10),second:parseInt(h[f].getAttribute("second"),10),amount:parseInt(h[f].getAttribute("amount"),10)});for(let f=0;f<u.length;f++)r.distanceField.push({fieldType:u[f].getAttribute("fieldType"),distanceRange:parseInt(u[f].getAttribute("distanceRange"),10)});return r}}class qu{static test(t){return typeof t=="string"&&t.includes("<font>")?ju.test(J.ADAPTER.parseXML(t)):!1}static parse(t){return ju.parse(J.ADAPTER.parseXML(t))}}const tu=[pa,ju,qu];function AB(e){for(let t=0;t<tu.length;t++)if(tu[t].test(e))return tu[t];return null}function SB(e,t,r,i,n,o){const l=r.fill;if(Array.isArray(l)){if(l.length===1)return l[0]}else return l;let h;const u=r.dropShadow?r.dropShadowDistance:0,f=r.padding||0,d=e.width/i-u-f*2,g=e.height/i-u-f*2,m=l.slice(),v=r.fillGradientStops.slice();if(!v.length){const _=m.length+1;for(let w=1;w<_;++w)v.push(w/_)}if(m.unshift(l[0]),v.unshift(0),m.push(l[l.length-1]),v.push(1),r.fillGradientType===qa.LINEAR_VERTICAL){h=t.createLinearGradient(d/2,f,d/2,g+f);let _=0;const x=(o.fontProperties.fontSize+r.strokeThickness)/g;for(let A=0;A<n.length;A++){const S=o.lineHeight*A;for(let E=0;E<m.length;E++){let I=0;typeof v[E]=="number"?I=v[E]:I=E/m.length;const D=S/g+I*x;let L=Math.max(_,D);L=Math.min(L,1),h.addColorStop(L,m[E]),_=L}}}else{h=t.createLinearGradient(f,g/2,d+f,g/2);const _=m.length+1;let w=1;for(let x=0;x<m.length;x++){let A;typeof v[x]=="number"?A=v[x]:A=w/_,h.addColorStop(A,m[x]),w++}}return h}function CB(e,t,r,i,n,o,l){const h=r.text,u=r.fontProperties;t.translate(i,n),t.scale(o,o);const f=l.strokeThickness/2,d=-(l.strokeThickness/2);if(t.font=l.toFontString(),t.lineWidth=l.strokeThickness,t.textBaseline=l.textBaseline,t.lineJoin=l.lineJoin,t.miterLimit=l.miterLimit,t.fillStyle=SB(e,t,l,o,[h],r),t.strokeStyle=l.stroke,l.dropShadow){const g=l.dropShadowColor,m=Ms(typeof g=="number"?g:uc(g)),v=l.dropShadowBlur*o,_=l.dropShadowDistance*o;t.shadowColor=`rgba(${m[0]*255},${m[1]*255},${m[2]*255},${l.dropShadowAlpha})`,t.shadowBlur=v,t.shadowOffsetX=Math.cos(l.dropShadowAngle)*_,t.shadowOffsetY=Math.sin(l.dropShadowAngle)*_}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;l.stroke&&l.strokeThickness&&t.strokeText(h,f,d+r.lineHeight-u.descent),l.fill&&t.fillText(h,f,d+r.lineHeight-u.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function ga(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}function Bv(e){return Array.from?Array.from(e):e.split("")}function IB(e){typeof e=="string"&&(e=[e]);const t=[];for(let r=0,i=e.length;r<i;r++){const n=e[r];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);const o=n[0].charCodeAt(0),l=n[1].charCodeAt(0);if(l<o)throw new Error("[BitmapFont]: Invalid character range.");for(let h=o,u=l;h<=u;h++)t.push(String.fromCharCode(h))}else t.push(...Bv(n))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const hr=class{constructor(e,t,r){var f;const[i]=e.info,[n]=e.common,[o]=e.page,[l]=e.distanceField,h=fi(o.file),u={};this._ownsTextures=r,this.font=i.face,this.size=i.size,this.lineHeight=n.lineHeight/h,this.chars={},this.pageTextures=u;for(let d=0;d<e.page.length;d++){const{id:g,file:m}=e.page[d];u[g]=t instanceof Array?t[d]:t[m],l!=null&&l.fieldType&&l.fieldType!=="none"&&(u[g].baseTexture.alphaMode=vr.NO_PREMULTIPLIED_ALPHA,u[g].baseTexture.mipmap=Dr.OFF)}for(let d=0;d<e.char.length;d++){const{id:g,page:m}=e.char[d];let{x:v,y:_,width:w,height:x,xoffset:A,yoffset:S,xadvance:E}=e.char[d];v/=h,_/=h,w/=h,x/=h,A/=h,S/=h,E/=h;const I=new Tt(v+u[m].frame.x/h,_+u[m].frame.y/h,w,x);this.chars[g]={xOffset:A,yOffset:S,xAdvance:E,kerning:{},texture:new it(u[m].baseTexture,I),page:m}}for(let d=0;d<e.kerning.length;d++){let{first:g,second:m,amount:v}=e.kerning[d];g/=h,m/=h,v/=h,this.chars[m]&&(this.chars[m].kerning[g]=v)}this.distanceFieldRange=l==null?void 0:l.distanceRange,this.distanceFieldType=((f=l==null?void 0:l.fieldType)==null?void 0:f.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,r){let i;if(e instanceof Fa)i=e;else{const o=AB(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}t instanceof it&&(t=[t]);const n=new hr(i,t,r);return hr.available[n.font]=n,n}static uninstall(e){const t=hr.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete hr.available[e]}static from(e,t,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:n,resolution:o,textureWidth:l,textureHeight:h,...u}=Object.assign({},hr.defaultOptions,r),f=IB(i),d=t instanceof Vi?t:new Vi(t),g=l,m=new Fa;m.info[0]={face:d.fontFamily,size:d.fontSize},m.common[0]={lineHeight:d.fontSize};let v=0,_=0,w,x,A,S=0;const E=[];for(let D=0;D<f.length;D++){w||(w=J.ADAPTER.createCanvas(),w.width=l,w.height=h,x=w.getContext("2d"),A=new gt(w,{resolution:o,...u}),E.push(new it(A)),m.page.push({id:E.length-1,file:""}));const L=f[D],O=ge.measureText(L,d,!1,w),F=O.width,X=Math.ceil(O.height),j=Math.ceil((d.fontStyle==="italic"?2:1)*F);if(_>=h-X*o){if(_===0)throw new Error(`[BitmapFont] textureHeight ${h}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${L}')`);--D,w=null,x=null,A=null,_=0,v=0,S=0;continue}if(S=Math.max(X+O.fontProperties.descent,S),j*o+v>=g){if(v===0)throw new Error(`[BitmapFont] textureWidth ${l}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${L}')`);--D,_+=S*o,_=Math.ceil(_),v=0,S=0;continue}CB(w,x,O,v,_,o,d);const z=ga(O.text);m.char.push({id:z,page:E.length-1,x:v/o,y:_/o,width:j,height:X,xoffset:0,yoffset:0,xadvance:Math.ceil(F-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0))}),v+=(j+2*n)*o,v=Math.ceil(v)}for(let D=0,L=f.length;D<L;D++){const O=f[D];for(let F=0;F<L;F++){const X=f[F],j=x.measureText(O).width,z=x.measureText(X).width,W=x.measureText(O+X).width-(j+z);W&&m.kerning.push({first:ga(O),second:ga(X),amount:W})}}const I=new hr(m,E,!0);return hr.available[e]!==void 0&&hr.uninstall(e),hr.available[e]=I,I}};let Re=hr;Re.ALPHA=[["a","z"],["A","Z"]," "];Re.NUMERIC=[["0","9"]];Re.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];Re.ASCII=[[" ","~"]];Re.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:hr.ALPHANUMERIC};Re.available={};var PB=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`,RB=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const Mg=[],Dg=[],Bg=[],Ov=class extends Ge{constructor(e,t={}){super(),this._tint=16777215;const{align:r,tint:i,maxWidth:n,letterSpacing:o,fontName:l,fontSize:h}=Object.assign({},Ov.styleDefaults,t);if(!Re.available[l])throw new Error(`Missing BitmapFont "${l}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tint=i,this._font=void 0,this._fontName=l,this._fontSize=h,this.text=e,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new ui(()=>{this.dirty=!0},this,0,0),this._roundPixels=J.ROUND_PIXELS,this.dirty=!0,this._resolution=J.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var j;const e=Re.available[this._fontName],t=this.fontSize,r=t/e.size,i=new St,n=[],o=[],l=[],h=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",u=Bv(h),f=this._maxWidth*e.size/t,d=e.distanceFieldType==="none"?Mg:Dg;let g=null,m=0,v=0,_=0,w=-1,x=0,A=0,S=0,E=0;for(let z=0;z<u.length;z++){const K=u[z],W=ga(K);if(/(?:\s)/.test(K)&&(w=z,x=m,E++),K==="\r"||K===`
`){o.push(m),l.push(-1),v=Math.max(v,m),++_,++A,i.x=0,i.y+=e.lineHeight,g=null,E=0;continue}const k=e.chars[W];if(!k)continue;g&&k.kerning[g]&&(i.x+=k.kerning[g]);const at=Bg.pop()||{texture:it.EMPTY,line:0,charCode:0,prevSpaces:0,position:new St};at.texture=k.texture,at.line=_,at.charCode=W,at.position.x=i.x+k.xOffset+this._letterSpacing/2,at.position.y=i.y+k.yOffset,at.prevSpaces=E,n.push(at),m=at.position.x+Math.max(k.xAdvance-k.xOffset,k.texture.orig.width),i.x+=k.xAdvance+this._letterSpacing,S=Math.max(S,k.yOffset+k.texture.height),g=W,w!==-1&&f>0&&i.x>f&&(++A,Dn(n,1+w-A,1+z-w),z=w,w=-1,o.push(x),l.push(n.length>0?n[n.length-1].prevSpaces:0),v=Math.max(v,x),_++,i.x=0,i.y+=e.lineHeight,g=null,E=0)}const I=u[u.length-1];I!=="\r"&&I!==`
`&&(/(?:\s)/.test(I)&&(m=x),o.push(m),v=Math.max(v,m),l.push(-1));const D=[];for(let z=0;z<=_;z++){let K=0;this._align==="right"?K=v-o[z]:this._align==="center"?K=(v-o[z])/2:this._align==="justify"&&(K=l[z]<0?0:(v-o[z])/l[z]),D.push(K)}const L=n.length,O={},F=[],X=this._activePagesMeshData;d.push(...X);for(let z=0;z<L;z++){const K=n[z].texture,W=K.baseTexture.uid;if(!O[W]){let k=d.pop();if(!k){const dt=new eB;let Y,yt;e.distanceFieldType==="none"?(Y=new Cg(it.EMPTY),yt=ut.NORMAL):(Y=new Cg(it.EMPTY,{program:fr.from(RB,PB),uniforms:{uFWidth:0}}),yt=ut.NORMAL_NPM);const Ot=new zu(dt,Y);Ot.blendMode=yt,k={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Ot,vertices:null,uvs:null,indices:null}}k.index=0,k.indexCount=0,k.vertexCount=0,k.uvsCount=0,k.total=0;const{_textureCache:at}=this;at[W]=at[W]||new it(K.baseTexture),k.mesh.texture=at[W],k.mesh.tint=this._tint,F.push(k),O[W]=k}O[W].total++}for(let z=0;z<X.length;z++)F.includes(X[z])||this.removeChild(X[z].mesh);for(let z=0;z<F.length;z++)F[z].mesh.parent!==this&&this.addChild(F[z].mesh);this._activePagesMeshData=F;for(const z in O){const K=O[z],W=K.total;if(!(((j=K.indices)==null?void 0:j.length)>6*W)||K.vertices.length<zu.BATCHABLE_SIZE*2)K.vertices=new Float32Array(4*2*W),K.uvs=new Float32Array(4*2*W),K.indices=new Uint16Array(6*W);else{const k=K.total,at=K.vertices;for(let dt=k*4*2;dt<at.length;dt++)at[dt]=0}K.mesh.size=6*W}for(let z=0;z<L;z++){const K=n[z];let W=K.position.x+D[K.line]*(this._align==="justify"?K.prevSpaces:1);this._roundPixels&&(W=Math.round(W));const k=W*r,at=K.position.y*r,dt=K.texture,Y=O[dt.baseTexture.uid],yt=dt.frame,Ot=dt._uvs,H=Y.index++;Y.indices[H*6+0]=0+H*4,Y.indices[H*6+1]=1+H*4,Y.indices[H*6+2]=2+H*4,Y.indices[H*6+3]=0+H*4,Y.indices[H*6+4]=2+H*4,Y.indices[H*6+5]=3+H*4,Y.vertices[H*8+0]=k,Y.vertices[H*8+1]=at,Y.vertices[H*8+2]=k+yt.width*r,Y.vertices[H*8+3]=at,Y.vertices[H*8+4]=k+yt.width*r,Y.vertices[H*8+5]=at+yt.height*r,Y.vertices[H*8+6]=k,Y.vertices[H*8+7]=at+yt.height*r,Y.uvs[H*8+0]=Ot.x0,Y.uvs[H*8+1]=Ot.y0,Y.uvs[H*8+2]=Ot.x1,Y.uvs[H*8+3]=Ot.y1,Y.uvs[H*8+4]=Ot.x2,Y.uvs[H*8+5]=Ot.y2,Y.uvs[H*8+6]=Ot.x3,Y.uvs[H*8+7]=Ot.y3}this._textWidth=v*r,this._textHeight=(i.y+e.lineHeight)*r;for(const z in O){const K=O[z];if(this.anchor.x!==0||this.anchor.y!==0){let dt=0;const Y=this._textWidth*this.anchor.x,yt=this._textHeight*this.anchor.y;for(let Ot=0;Ot<K.total;Ot++)K.vertices[dt++]-=Y,K.vertices[dt++]-=yt,K.vertices[dt++]-=Y,K.vertices[dt++]-=yt,K.vertices[dt++]-=Y,K.vertices[dt++]-=yt,K.vertices[dt++]-=Y,K.vertices[dt++]-=yt}this._maxLineHeight=S*r;const W=K.mesh.geometry.getBuffer("aVertexPosition"),k=K.mesh.geometry.getBuffer("aTextureCoord"),at=K.mesh.geometry.getIndex();W.data=K.vertices,k.data=K.uvs,at.data=K.indices,W.update(),k.update(),at.update()}for(let z=0;z<n.length;z++)Bg.push(n[z]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:r,size:i}=Re.available[this._fontName];if(r!=="none"){const{a:n,b:o,c:l,d:h}=this.worldTransform,u=Math.sqrt(n*n+o*o),f=Math.sqrt(l*l+h*h),d=(Math.abs(u)+Math.abs(f))/2,g=this.fontSize/i,m=e._view.resolution;for(const v of this._activePagesMeshData)v.mesh.shader.uniforms.uFWidth=d*t*g*m}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=Re.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tint}set tint(e){if(this._tint!==e){this._tint=e;for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!Re.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??Re.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:t}=this,i=Re.available[this._fontName].distanceFieldType==="none"?Mg:Dg;i.push(...this._activePagesMeshData);for(const n of this._activePagesMeshData)this.removeChild(n.mesh);this._activePagesMeshData=[],i.filter(n=>t[n.mesh.texture.baseTexture.uid]).forEach(n=>{n.mesh.texture=it.EMPTY});for(const n in t)t[n].destroy(),delete t[n];this._font=null,this._textureCache=null,super.destroy(e)}};let MB=Ov;MB.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const DB=[".xml",".fnt"],BB={extension:{type:Z.LoadParser,priority:Br.Normal},test(e){return DB.includes(ve.extname(e).toLowerCase())},async testParse(e){return pa.test(e)||qu.test(e)},async parse(e,t,r){const i=pa.test(e)?pa.parse(e):qu.parse(e),{src:n}=t,{page:o}=i,l=[];for(let f=0;f<o.length;++f){const d=o[f].file,g=ve.join(ve.dirname(n),d);l.push(g)}const h=await r.load(l),u=l.map(f=>h[f]);return Re.install(i,u,!0)},async load(e,t){return(await J.ADAPTER.fetch(e)).text()},unload(e){e.destroy()}};nt.add(BB);const OB={A:"menlo-bold-0.png",B:"menlo-bold-1.png",C:"menlo-bold-2.png",D:"menlo-bold-3.png",E:"menlo-bold-4.png",F:"menlo-bold-5.png",G:"menlo-bold-6.png",H:"menlo-bold-7.png",I:"menlo-bold-8.png",J:"menlo-bold-9.png",K:"menlo-bold-10.png",L:"menlo-bold-11.png",M:"menlo-bold-12.png",N:"menlo-bold-13.png",O:"menlo-bold-14.png",P:"menlo-bold-15.png",Q:"menlo-bold-16.png",R:"menlo-bold-17.png",S:"menlo-bold-18.png",T:"menlo-bold-19.png",U:"menlo-bold-20.png",V:"menlo-bold-21.png",W:"menlo-bold-22.png",X:"menlo-bold-23.png",Y:"menlo-bold-24.png",Z:"menlo-bold-25.png",a:"menlo-bold-26.png",b:"menlo-bold-27.png",c:"menlo-bold-28.png",d:"menlo-bold-29.png",e:"menlo-bold-30.png",f:"menlo-bold-31.png",g:"menlo-bold-32.png",h:"menlo-bold-33.png",i:"menlo-bold-34.png",j:"menlo-bold-35.png",k:"menlo-bold-36.png",l:"menlo-bold-37.png",m:"menlo-bold-38.png",n:"menlo-bold-39.png",o:"menlo-bold-40.png",p:"menlo-bold-41.png",q:"menlo-bold-42.png",r:"menlo-bold-43.png",s:"menlo-bold-44.png",t:"menlo-bold-45.png",u:"menlo-bold-46.png",v:"menlo-bold-47.png",w:"menlo-bold-48.png",x:"menlo-bold-49.png",y:"menlo-bold-50.png",z:"menlo-bold-51.png",0:"menlo-bold-52.png",1:"menlo-bold-53.png",2:"menlo-bold-54.png",3:"menlo-bold-55.png",4:"menlo-bold-56.png",5:"menlo-bold-57.png",6:"menlo-bold-58.png",7:"menlo-bold-59.png",8:"menlo-bold-60.png",9:"menlo-bold-61.png","!":"menlo-bold-62.png","@":"menlo-bold-63.png","#":"menlo-bold-64.png",$:"menlo-bold-65.png","%":"menlo-bold-66.png","^":"menlo-bold-67.png","&":"menlo-bold-68.png","*":"menlo-bold-69.png","(":"menlo-bold-70.png",")":"menlo-bold-71.png","-":"menlo-bold-72.png",_:"menlo-bold-73.png","=":"menlo-bold-74.png","+":"menlo-bold-75.png",",":"menlo-bold-76.png",".":"menlo-bold-77.png","<":"menlo-bold-78.png",">":"menlo-bold-79.png","/":"menlo-bold-80.png","?":"menlo-bold-81.png",";":"menlo-bold-82.png",":":"menlo-bold-83.png",'"':"menlo-bold-84.png","'":"menlo-bold-85.png","[":"menlo-bold-86.png","]":"menlo-bold-87.png","{":"menlo-bold-88.png","}":"menlo-bold-89.png","\\":"menlo-bold-90.png","|":"menlo-bold-91.png","`":"menlo-bold-92.png","~":"menlo-bold-93.png","•":"menlo-bold-94.png"},FB={A:"menlo-bold-half-0.png",B:"menlo-bold-half-1.png",C:"menlo-bold-half-2.png",D:"menlo-bold-half-3.png",E:"menlo-bold-half-4.png",F:"menlo-bold-half-5.png",G:"menlo-bold-half-6.png",H:"menlo-bold-half-7.png",I:"menlo-bold-half-8.png",J:"menlo-bold-half-9.png",K:"menlo-bold-half-10.png",L:"menlo-bold-half-11.png",M:"menlo-bold-half-12.png",N:"menlo-bold-half-13.png",O:"menlo-bold-half-14.png",P:"menlo-bold-half-15.png",Q:"menlo-bold-half-16.png",R:"menlo-bold-half-17.png",S:"menlo-bold-half-18.png",T:"menlo-bold-half-19.png",U:"menlo-bold-half-20.png",V:"menlo-bold-half-21.png",W:"menlo-bold-half-22.png",X:"menlo-bold-half-23.png",Y:"menlo-bold-half-24.png",Z:"menlo-bold-half-25.png",a:"menlo-bold-half-26.png",b:"menlo-bold-half-27.png",c:"menlo-bold-half-28.png",d:"menlo-bold-half-29.png",e:"menlo-bold-half-30.png",f:"menlo-bold-half-31.png",g:"menlo-bold-half-32.png",h:"menlo-bold-half-33.png",i:"menlo-bold-half-34.png",j:"menlo-bold-half-35.png",k:"menlo-bold-half-36.png",l:"menlo-bold-half-37.png",m:"menlo-bold-half-38.png",n:"menlo-bold-half-39.png",o:"menlo-bold-half-40.png",p:"menlo-bold-half-41.png",q:"menlo-bold-half-42.png",r:"menlo-bold-half-43.png",s:"menlo-bold-half-44.png",t:"menlo-bold-half-45.png",u:"menlo-bold-half-46.png",v:"menlo-bold-half-47.png",w:"menlo-bold-half-48.png",x:"menlo-bold-half-49.png",y:"menlo-bold-half-50.png",z:"menlo-bold-half-51.png",0:"menlo-bold-half-52.png",1:"menlo-bold-half-53.png",2:"menlo-bold-half-54.png",3:"menlo-bold-half-55.png",4:"menlo-bold-half-56.png",5:"menlo-bold-half-57.png",6:"menlo-bold-half-58.png",7:"menlo-bold-half-59.png",8:"menlo-bold-half-60.png",9:"menlo-bold-half-61.png","!":"menlo-bold-half-62.png","@":"menlo-bold-half-63.png","#":"menlo-bold-half-64.png",$:"menlo-bold-half-65.png","%":"menlo-bold-half-66.png","^":"menlo-bold-half-67.png","&":"menlo-bold-half-68.png","*":"menlo-bold-half-69.png","(":"menlo-bold-half-70.png",")":"menlo-bold-half-71.png","-":"menlo-bold-half-72.png",_:"menlo-bold-half-73.png","=":"menlo-bold-half-74.png","+":"menlo-bold-half-75.png",",":"menlo-bold-half-76.png",".":"menlo-bold-half-77.png","<":"menlo-bold-half-78.png",">":"menlo-bold-half-79.png","/":"menlo-bold-half-80.png","?":"menlo-bold-half-81.png",";":"menlo-bold-half-82.png",":":"menlo-bold-half-83.png",'"':"menlo-bold-half-84.png","'":"menlo-bold-half-85.png","[":"menlo-bold-half-86.png","]":"menlo-bold-half-87.png","{":"menlo-bold-half-88.png","}":"menlo-bold-half-89.png","\\":"menlo-bold-half-90.png","|":"menlo-bold-half-91.png","`":"menlo-bold-half-92.png","~":"menlo-bold-half-93.png","•":"menlo-bold-half-94.png"};let Fv;const Lv={width:100,height:46},li=window.innerWidth/Lv.width,LB=(e,t,r)=>{const i=Math.trunc(e/li),n=Math.trunc(t/li);return`${i},${n},${r}`},ki={};async function NB(e){Fv=new vc({view:e,width:window.innerWidth,height:li*Lv.height,autoDensity:!0,resolution:window.devicePixelRatio||1}),await kB()}const kB=async()=>(ki.ascii=await Li.load("/forcecrusher/fonts/menlo-bold.json"),ki.text=await Li.load("/forcecrusher/fonts/menlo-bold-half.json"),ki.tile=await Li.load("/forcecrusher/tile.png"),ki),UB=e=>ki.ascii.textures[OB[e]],GB=e=>ki.text.textures[FB[e]],WB=()=>ki.tile;class Er{constructor(t){Zt(this,"x",0);Zt(this,"y",0);Zt(this,"halfWidth",!1);Zt(this,"width");Zt(this,"height");Zt(this,"layers",[]);Zt(this,"sprites",[]);Zt(this,"tileSets",[]);Zt(this,"tints",[]);Zt(this,"alphas",[]);Zt(this,"visible",!0);Zt(this,"_getTexture",t=>{const{tileSet:r,char:i}=t;return r==="ascii"?UB(i):r==="text"?GB(i):WB()});Zt(this,"_createSprite",t=>{const{char:r,width:i,height:n,layer:o,x:l,y:h,tileSet:u,tint:f=16777215,alpha:d=1}=t,g=this._getTexture({tileSet:u,char:r});let m=new Yn(g);m.width=this.halfWidth?i/2:i,m.height=n,m.x=this.halfWidth?l*(i/2):l*i,m.y=h*n,m.tint=f,m.alpha=d,this.sprites[o][h][l]=m,this.layers[o].addChild(m)});Zt(this,"updateCell",t=>(Object.keys(t).forEach(r=>{const{char:i,tint:n,alpha:o,tileSet:l,x:h,y:u}=t[r];this.updateSprite({char:i,tint:n,alpha:o,tileSet:l,x:h,y:u,layer:parseInt(r)})}),this));Zt(this,"updateSprite",async t=>{const{char:r="",layer:i,x:n,y:o,tileSet:l="text",tint:h,alpha:u}=t,f=this.sprites[i][o][n];if(f)return f.texture=this._getTexture({tileSet:l,char:r}),h&&(f.tint=h),typeof u<"u"&&(f.alpha=u),this});Zt(this,"updateRows",t=>(t.forEach((r,i)=>{r.forEach((n,o)=>{this.clearRow(o,i),this.updateRow({...n,layer:o,y:i})})}),this));Zt(this,"updateRow",t=>{const{string:r="",layer:i=0,x:n,y:o,tileSet:l,tint:h,alpha:u}=t;return[...r].forEach((d,g)=>this.updateSprite({char:d,layer:i||0,x:n||0+g,y:o||0,tileSet:l||this.tileSets[i],tint:h||this.tints[i],alpha:u||this.alphas[i]})),(l||this.tileSets[i])==="tile"&&Ci.times(this.width,d=>{this.updateSprite({layer:i,x:n||0+d,y:o||0,tileSet:l||this.tileSets[i],tint:h||this.tints[i],alpha:u||this.alphas[i]})}),this});Zt(this,"clearRow",(t,r)=>{const i=new Array(this.width+1).join(" ");this.updateRow({string:i,layer:t,y:r})});Zt(this,"clearView",()=>{let t=0;this.layers.forEach(()=>{Ci.times(this.height,r=>{this.clearRow(t,r)}),t+=1})});Zt(this,"show",()=>{this.visible=!0,this.layers.forEach(t=>t.visible=this.visible)});Zt(this,"hide",()=>{this.visible=!1,this.layers.forEach(t=>t.visible=this.visible)});return this.width=t.width,this.height=t.height,this.tileSets=t.tileSets,this.tints=t.tints,this.alphas=t.alphas,this.halfWidth=this.tileSets.includes("text"),this.visible=t.visible,Ci.times(t.layers,()=>this.layers.push(new Ge)),this.layers.forEach(r=>{const i=this.halfWidth?t.x*(li/2):t.x*li,n=t.y*li;r.x=i,r.y=n,r.interactiveChildren=!1,r.visible=this.visible,Fv.stage.addChild(r)}),Ci.times(t.layers,()=>this.sprites.push(Array.from(Array(this.height),()=>Array.from(Array(this.width))))),Ci.times(t.layers,r=>{Ci.times(this.height,i=>{Ci.times(this.width,async n=>{this._createSprite({char:"",width:li,height:li,layer:r,x:n,y:i,tileSet:t.tileSets[r],tint:t.tints[r],alpha:t.alphas[r]})})})}),this}}var Nv={exports:{}},wc={};Object.defineProperty(wc,"__esModule",{value:!0});function Ku(e,t){t=e.length;for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function $B(e){if(Array.isArray(e))return Ku(e)}function HB(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kv(e,t){if(e){if(typeof e=="string")return Ku(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ku(e,t)}}function XB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zB(e){return $B(e)||HB(e)||kv(e)||XB()}function VB(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=kv(e))||t){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,h;return{s:function(){r=r.call(e)},n:function(){var u=r.next();return o=u.done,u},e:function(u){l=!0,h=u},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(l)throw h}}}}function YB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jB(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Uv(e){var t=jB(e,"string");return typeof t=="symbol"?t:String(t)}function qB(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Uv(i.key),i)}}function KB(e,t,r){return t&&qB(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZB(e,t,r){return t=Uv(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var JB=function(){function e(){YB(this,e),ZB(this,"subscribers",new Set)}return KB(e,[{key:"onSubscribe",get:function(){return this._onSubscribe||(this._onSubscribe=new e),this._onSubscribe}},{key:"onUnsubscribe",get:function(){return this._onUnsubscribe||(this._onUnsubscribe=new e),this._onUnsubscribe}},{key:"subscribe",value:function(r){var i,n=this;return this.subscribers.add(r),(i=this._onSubscribe)===null||i===void 0||i.emit(r),function(){return n.unsubscribe(r)}}},{key:"unsubscribe",value:function(r){var i;this.subscribers.delete(r),(i=this._onUnsubscribe)===null||i===void 0||i.emit(r)}},{key:"clear",value:function(){if(this._onUnsubscribe){var r=VB(this.subscribers),i;try{for(r.s();!(i=r.n()).done;){var n=i.value;this._onUnsubscribe.emit(n)}}catch(o){r.e(o)}finally{r.f()}}this.subscribers.clear()}},{key:"emit",value:function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];this.subscribers.forEach(function(o){return o.apply(void 0,i)})}},{key:"emitAsync",value:function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return Promise.all(zB(this.subscribers).map(function(o){return o.apply(void 0,i)}))}}]),e}();wc.Event=JB;Nv.exports=wc;var Og=Nv.exports;function Fg(e,t){t=e.length;for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function QB(e,t){if(e){if(typeof e=="string")return Fg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fg(e,t)}}function tO(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=QB(e))||t){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,h;return{s:function(){r=r.call(e)},n:function(){var u=r.next();return o=u.done,u},e:function(u){l=!0,h=u},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(l)throw h}}}}function eO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rO(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Gv(e){var t=rO(e,"string");return typeof t=="symbol"?t:String(t)}function iO(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Gv(i.key),i)}}function nO(e,t,r){return t&&iO(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ea(e,t,r){return t=Gv(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Wv;Wv=Symbol.iterator;var $v=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];eO(this,e),ea(this,"_version",0),ea(this,"onEntityAdded",new Og.Event),ea(this,"onEntityRemoved",new Og.Event),ea(this,"entityPositions",new Map),this._entities=t,this.add=this.add.bind(this),this.remove=this.remove.bind(this);for(var r=0;r<t.length;r++)this.entityPositions.set(t[r],r)}return nO(e,[{key:"version",get:function(){return this._version}},{key:"entities",get:function(){return this._entities}},{key:Wv,value:function(){var r=this,i=this._entities.length,n={value:void 0,done:!1};return{next:function(){return n.value=r._entities[--i],n.done=i<0,n}}}},{key:"size",get:function(){return this.entities.length}},{key:"first",get:function(){return this.entities[0]}},{key:"has",value:function(r){return this.entityPositions.has(r)}},{key:"add",value:function(r){return r&&!this.has(r)&&(this.entities.push(r),this.entityPositions.set(r,this.entities.length-1),this._version++,this.onEntityAdded.emit(r)),r}},{key:"remove",value:function(r){if(this.has(r)){this.onEntityRemoved.emit(r);var i=this.entityPositions.get(r);this.entityPositions.delete(r);var n=this.entities[this.entities.length-1];n!==r&&(this.entities[i]=n,this.entityPositions.set(n,i)),this.entities.pop(),this._version++}return r}},{key:"clear",value:function(){var r=tO(this),i;try{for(r.s();!(i=r.n()).done;){var n=i.value;this.remove(n)}}catch(o){r.e(o)}finally{r.f()}}}]),e}(),Lg=new WeakMap,Ng=0,sO=function(t){var r=Lg.get(t);return r!==void 0?r:(Lg.set(t,Ng),Ng++)};function oO(){var e=new Array;function t(n){e.push(n)}function r(){e.length=0}function i(){e.forEach(function(n){return n()}),r()}return t.clear=r,t.flush=i,t}function Zu(e,t){t=e.length;for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function aO(e){if(Array.isArray(e))return Zu(e)}function lO(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Hv(e,t){if(e){if(typeof e=="string")return Zu(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zu(e,t)}}function hO(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ss(e){return aO(e)||lO(e)||Hv(e)||hO()}function Yi(e){return Yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yi(e)}function uO(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Yi(e),e!==null););return e}function Cs(){return typeof Reflect<"u"&&Reflect.get?Cs=Reflect.get.bind():Cs=function(t,r,i){var n=uO(t,r);if(n){var o=Object.getOwnPropertyDescriptor(n,r);return o.get?o.get.call(arguments.length<3?t:i):o.value}},Cs.apply(this,arguments)}function Ju(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Hv(e))||t){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,h;return{s:function(){r=r.call(e)},n:function(){var u=r.next();return o=u.done,u},e:function(u){l=!0,h=u},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(l)throw h}}}}function cO(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Xv(e){var t=cO(e,"string");return typeof t=="symbol"?t:String(t)}function Cn(e,t,r){return t=Xv(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function Oi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kg(Object(r),!0).forEach(function(i){Cn(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kg(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function zv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fO(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Xv(i.key),i)}}function Vv(e,t,r){return t&&fO(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function In(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qu(e,t){return Qu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},Qu(e,t)}function Yv(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qu(e,t)}function dO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pO(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return In(e)}function jv(e){var t=dO();return function(){var i=Yi(e),n;if(t){var o=Yi(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return pO(this,n)}}var qv,gO=function(e){Yv(r,e);var t=jv(r);function r(){var i,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return zv(this,r),i=t.call(this,n),Cn(In(i),"queries",new Set),Cn(In(i),"entityToId",new Map),Cn(In(i),"idToEntity",new Map),Cn(In(i),"nextId",0),i.onEntityAdded.subscribe(function(o){i.reindex(o)}),i.onEntityRemoved.subscribe(function(o){if(i.queries.forEach(function(h){return h.remove(o)}),i.entityToId.has(o)){var l=i.entityToId.get(o);i.idToEntity.delete(l),i.entityToId.delete(o)}}),i}return Vv(r,[{key:"update",value:function(i){function n(o,l,h){return i.apply(this,arguments)}return n.toString=function(){return i.toString()},n}(function(i,n,o){if(typeof n=="function"){var l=n(i);l&&Object.assign(i,l)}else typeof n=="string"?i[n]=o:n&&Object.assign(i,n);return this.reindex(i),i})},{key:"addComponent",value:function(n,o,l){n[o]===void 0&&(n[o]=l,this.reindex(n))}},{key:"removeComponent",value:function(n,o){if(n[o]!==void 0){if(this.has(n)){var l=Oi({},n);delete l[o],this.reindex(n,l)}delete n[o]}}},{key:"query",value:function(n){var o=yO(n),l=Kv(o),h=Ju(this.queries),u;try{for(h.s();!(u=h.n()).done;){var f=u.value;if(f.key===l)return f}}catch(g){h.e(g)}finally{h.f()}var d=new mO(this,o);return this.queries.add(d),d}},{key:"with",value:function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return this.query({with:o,without:[],predicates:[]})}},{key:"without",value:function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return this.query({with:[],without:o,predicates:[]})}},{key:"where",value:function(n){return this.query({with:[],without:[],predicates:[n]})}},{key:"reindex",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n;if(this.has(n)){var l=Ju(this.queries),h;try{for(l.s();!(h=l.n()).done;){var u=h.value;u.evaluate(n,o)}}catch(f){l.e(f)}finally{l.f()}}}},{key:"id",value:function(n){if(this.has(n)){if(!this.entityToId.has(n)){var o=this.nextId++;this.entityToId.set(n,o),this.idToEntity.set(o,n)}return this.entityToId.get(n)}}},{key:"entity",value:function(n){return this.idToEntity.get(n)}}]),r}($v);qv=Symbol.iterator;var mO=function(e){Yv(r,e);var t=jv(r);function r(i,n){var o;return zv(this,r),o=t.call(this),Cn(In(o),"_isConnected",!1),o.world=i,o.config=n,o.key=Kv(n),o.onEntityAdded.onSubscribe.subscribe(function(){return o.connect()}),o.onEntityRemoved.onSubscribe.subscribe(function(){return o.connect()}),o}return Vv(r,[{key:"isConnected",get:function(){return this._isConnected}},{key:"entities",get:function(){return this._isConnected||this.connect(),Cs(Yi(r.prototype),"entities",this)}},{key:qv,value:function(){return this._isConnected||this.connect(),Cs(Yi(r.prototype),Symbol.iterator,this).call(this)}},{key:"connect",value:function(){if(!this._isConnected){this._isConnected=!0;var n=Ju(this.world),o;try{for(n.s();!(o=n.n()).done;){var l=o.value;this.evaluate(l)}}catch(h){n.e(h)}finally{n.f()}}return this}},{key:"disconnect",value:function(){return this._isConnected=!1,this}},{key:"with",value:function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return this.world.query(Oi(Oi({},this.config),{},{with:[].concat(Ss(this.config.with),o)}))}},{key:"without",value:function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return this.world.query(Oi(Oi({},this.config),{},{without:[].concat(Ss(this.config.without),o)}))}},{key:"where",value:function(n){return this.world.query(Oi(Oi({},this.config),{},{predicates:[].concat(Ss(this.config.predicates),[n])}))}},{key:"want",value:function(n){return this.config.with.every(function(o){return n[o]!==void 0})&&this.config.without.every(function(o){return n[o]===void 0})&&this.config.predicates.every(function(o){return o(n)})}},{key:"evaluate",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n;if(this.isConnected){var l=this.want(o),h=this.has(n);l&&!h?this.add(n):!l&&h&&this.remove(n)}}}]),r}($v),Ug=function(t){return Ss(new Set(t.sort().filter(function(r){return!!r&&r!==""})))};function vO(e){return Ss(new Set(e))}function yO(e){return{with:Ug(e.with),without:Ug(e.without),predicates:vO(e.predicates)}}function Kv(e){return"".concat(e.with.join(","),":").concat(e.without.join(","),":").concat(e.predicates.map(function(t){return sO(t)}).join(","))}oO();const ct=new gO;var Ec={exports:{}};Ec.exports;(function(e){(function(){var t,r,i,n,o,l,h,u,f,d,g,m,v,_,w;i=Math.floor,d=Math.min,r=function(x,A){return x<A?-1:x>A?1:0},f=function(x,A,S,E,I){var D;if(S==null&&(S=0),I==null&&(I=r),S<0)throw new Error("lo must be non-negative");for(E==null&&(E=x.length);S<E;)D=i((S+E)/2),I(A,x[D])<0?E=D:S=D+1;return[].splice.apply(x,[S,S-S].concat(A)),A},l=function(x,A,S){return S==null&&(S=r),x.push(A),_(x,0,x.length-1,S)},o=function(x,A){var S,E;return A==null&&(A=r),S=x.pop(),x.length?(E=x[0],x[0]=S,w(x,0,A)):E=S,E},u=function(x,A,S){var E;return S==null&&(S=r),E=x[0],x[0]=A,w(x,0,S),E},h=function(x,A,S){var E;return S==null&&(S=r),x.length&&S(x[0],A)<0&&(E=[x[0],A],A=E[0],x[0]=E[1],w(x,0,S)),A},n=function(x,A){var S,E,I,D,L,O;for(A==null&&(A=r),D=(function(){O=[];for(var F=0,X=i(x.length/2);0<=X?F<X:F>X;0<=X?F++:F--)O.push(F);return O}).apply(this).reverse(),L=[],E=0,I=D.length;E<I;E++)S=D[E],L.push(w(x,S,A));return L},v=function(x,A,S){var E;if(S==null&&(S=r),E=x.indexOf(A),E!==-1)return _(x,0,E,S),w(x,E,S)},g=function(x,A,S){var E,I,D,L,O;if(S==null&&(S=r),I=x.slice(0,A),!I.length)return I;for(n(I,S),O=x.slice(A),D=0,L=O.length;D<L;D++)E=O[D],h(I,E,S);return I.sort(S).reverse()},m=function(x,A,S){var E,I,D,L,O,F,X,j,z;if(S==null&&(S=r),A*10<=x.length){if(D=x.slice(0,A).sort(S),!D.length)return D;for(I=D[D.length-1],X=x.slice(A),L=0,F=X.length;L<F;L++)E=X[L],S(E,I)<0&&(f(D,E,0,null,S),D.pop(),I=D[D.length-1]);return D}for(n(x,S),z=[],O=0,j=d(A,x.length);0<=j?O<j:O>j;0<=j?++O:--O)z.push(o(x,S));return z},_=function(x,A,S,E){var I,D,L;for(E==null&&(E=r),I=x[S];S>A;){if(L=S-1>>1,D=x[L],E(I,D)<0){x[S]=D,S=L;continue}break}return x[S]=I},w=function(x,A,S){var E,I,D,L,O;for(S==null&&(S=r),I=x.length,O=A,D=x[A],E=2*A+1;E<I;)L=E+1,L<I&&!(S(x[E],x[L])<0)&&(E=L),x[A]=x[E],A=E,E=2*A+1;return x[A]=D,_(x,O,A,S)},t=function(){x.push=l,x.pop=o,x.replace=u,x.pushpop=h,x.heapify=n,x.updateItem=v,x.nlargest=g,x.nsmallest=m;function x(A){this.cmp=A??r,this.nodes=[]}return x.prototype.push=function(A){return l(this.nodes,A,this.cmp)},x.prototype.pop=function(){return o(this.nodes,this.cmp)},x.prototype.peek=function(){return this.nodes[0]},x.prototype.contains=function(A){return this.nodes.indexOf(A)!==-1},x.prototype.replace=function(A){return u(this.nodes,A,this.cmp)},x.prototype.pushpop=function(A){return h(this.nodes,A,this.cmp)},x.prototype.heapify=function(){return n(this.nodes,this.cmp)},x.prototype.updateItem=function(A){return v(this.nodes,A,this.cmp)},x.prototype.clear=function(){return this.nodes=[]},x.prototype.empty=function(){return this.nodes.length===0},x.prototype.size=function(){return this.nodes.length},x.prototype.clone=function(){var A;return A=new x,A.nodes=this.nodes.slice(0),A},x.prototype.toArray=function(){return this.nodes.slice(0)},x.prototype.insert=x.prototype.push,x.prototype.top=x.prototype.peek,x.prototype.front=x.prototype.peek,x.prototype.has=x.prototype.contains,x.prototype.copy=x.prototype.clone,x}(),e!==null&&e.exports?e.exports=t:window.Heap=t}).call(Ir)})(Ec);var _O=Ec.exports,Ka=_O;function xO(e,t,r){this.x=e,this.y=t,this.walkable=r===void 0?!0:r}var Tc=xO,bO={Always:1,Never:2,IfAtMostOneObstacle:3,OnlyWhenNoObstacles:4},Qe=bO,Zv=Tc,ra=Qe;function jr(e,t,r){var i;typeof e!="object"?i=e:(t=e.length,i=e[0].length,r=e),this.width=i,this.height=t,this.nodes=this._buildNodes(i,t,r)}jr.prototype._buildNodes=function(e,t,r){var i,n,o=new Array(t);for(i=0;i<t;++i)for(o[i]=new Array(e),n=0;n<e;++n)o[i][n]=new Zv(n,i);if(r===void 0)return o;if(r.length!==t||r[0].length!==e)throw new Error("Matrix size does not fit");for(i=0;i<t;++i)for(n=0;n<e;++n)r[i][n]&&(o[i][n].walkable=!1);return o};jr.prototype.getNodeAt=function(e,t){return this.nodes[t][e]};jr.prototype.isWalkableAt=function(e,t){return this.isInside(e,t)&&this.nodes[t][e].walkable};jr.prototype.isInside=function(e,t){return e>=0&&e<this.width&&t>=0&&t<this.height};jr.prototype.setWalkableAt=function(e,t,r){this.nodes[t][e].walkable=r};jr.prototype.getNeighbors=function(e,t){var r=e.x,i=e.y,n=[],o=!1,l=!1,h=!1,u=!1,f=!1,d=!1,g=!1,m=!1,v=this.nodes;if(this.isWalkableAt(r,i-1)&&(n.push(v[i-1][r]),o=!0),this.isWalkableAt(r+1,i)&&(n.push(v[i][r+1]),h=!0),this.isWalkableAt(r,i+1)&&(n.push(v[i+1][r]),f=!0),this.isWalkableAt(r-1,i)&&(n.push(v[i][r-1]),g=!0),t===ra.Never)return n;if(t===ra.OnlyWhenNoObstacles)l=g&&o,u=o&&h,d=h&&f,m=f&&g;else if(t===ra.IfAtMostOneObstacle)l=g||o,u=o||h,d=h||f,m=f||g;else if(t===ra.Always)l=!0,u=!0,d=!0,m=!0;else throw new Error("Incorrect value of diagonalMovement");return l&&this.isWalkableAt(r-1,i-1)&&n.push(v[i-1][r-1]),u&&this.isWalkableAt(r+1,i-1)&&n.push(v[i-1][r+1]),d&&this.isWalkableAt(r+1,i+1)&&n.push(v[i+1][r+1]),m&&this.isWalkableAt(r-1,i+1)&&n.push(v[i+1][r-1]),n};jr.prototype.clone=function(){var e,t,r=this.width,i=this.height,n=this.nodes,o=new jr(r,i),l=new Array(i);for(e=0;e<i;++e)for(l[e]=new Array(r),t=0;t<r;++t)l[e][t]=new Zv(t,e,n[e][t].walkable);return o.nodes=l,o};var wO=jr,We={};function tc(e){for(var t=[[e.x,e.y]];e.parent;)e=e.parent,t.push([e.x,e.y]);return t.reverse()}We.backtrace=tc;function EO(e,t){var r=tc(e),i=tc(t);return r.concat(i.reverse())}We.biBacktrace=EO;function TO(e){var t,r=0,i,n,o,l;for(t=1;t<e.length;++t)i=e[t-1],n=e[t],o=i[0]-n[0],l=i[1]-n[1],r+=Math.sqrt(o*o+l*l);return r}We.pathLength=TO;function Ac(e,t,r,i){var n=Math.abs,o=[],l,h,u,f,d,g;for(u=n(r-e),f=n(i-t),l=e<r?1:-1,h=t<i?1:-1,d=u-f;o.push([e,t]),!(e===r&&t===i);)g=2*d,g>-f&&(d=d-f,e=e+l),g<u&&(d=d+u,t=t+h);return o}We.interpolate=Ac;function AO(e){var t=[],r=e.length,i,n,o,l,h,u;if(r<2)return t;for(h=0;h<r-1;++h)for(i=e[h],n=e[h+1],o=Ac(i[0],i[1],n[0],n[1]),l=o.length,u=0;u<l-1;++u)t.push(o[u]);return t.push(e[r-1]),t}We.expandPath=AO;function SO(e,t){var r=t.length,i=t[0][0],n=t[0][1],o=t[r-1][0],l=t[r-1][1],h,u,f,d,g,m,v,_,w,x,A;for(h=i,u=n,g=[[h,u]],m=2;m<r;++m){for(_=t[m],f=_[0],d=_[1],w=Ac(h,u,f,d),A=!1,v=1;v<w.length;++v)if(x=w[v],!e.isWalkableAt(x[0],x[1])){A=!0;break}A&&(lastValidCoord=t[m-1],g.push(lastValidCoord),h=lastValidCoord[0],u=lastValidCoord[1])}return g.push([o,l]),g}We.smoothenPath=SO;function CO(e){if(e.length<3)return e;var t=[],r=e[0][0],i=e[0][1],n=e[1][0],o=e[1][1],l=n-r,h=o-i,u,f,d,g,m,v;for(m=Math.sqrt(l*l+h*h),l/=m,h/=m,t.push([r,i]),v=2;v<e.length;v++)u=n,f=o,d=l,g=h,n=e[v][0],o=e[v][1],l=n-u,h=o-f,m=Math.sqrt(l*l+h*h),l/=m,h/=m,(l!==d||h!==g)&&t.push([u,f]);return t.push([n,o]),t}We.compressPath=CO;var Ws={manhattan:function(e,t){return e+t},euclidean:function(e,t){return Math.sqrt(e*e+t*t)},octile:function(e,t){var r=Math.SQRT2-1;return e<t?r*e+t:r*t+e},chebyshev:function(e,t){return Math.max(e,t)}},IO=Ka,PO=We,eu=Ws,ia=Qe;function Jv(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.heuristic=e.heuristic||eu.manhattan,this.weight=e.weight||1,this.diagonalMovement=e.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=ia.OnlyWhenNoObstacles:this.diagonalMovement=ia.IfAtMostOneObstacle:this.diagonalMovement=ia.Never),this.diagonalMovement===ia.Never?this.heuristic=e.heuristic||eu.manhattan:this.heuristic=e.heuristic||eu.octile}Jv.prototype.findPath=function(e,t,r,i,n){var o=new IO(function(D,L){return D.f-L.f}),l=n.getNodeAt(e,t),h=n.getNodeAt(r,i),u=this.heuristic,f=this.diagonalMovement,d=this.weight,g=Math.abs,m=Math.SQRT2,v,_,w,x,A,S,E,I;for(l.g=0,l.f=0,o.push(l),l.opened=!0;!o.empty();){if(v=o.pop(),v.closed=!0,v===h)return PO.backtrace(h);for(_=n.getNeighbors(v,f),x=0,A=_.length;x<A;++x)w=_[x],!w.closed&&(S=w.x,E=w.y,I=v.g+(S-v.x===0||E-v.y===0?1:m),(!w.opened||I<w.g)&&(w.g=I,w.h=w.h||d*u(g(S-r),g(E-i)),w.f=w.g+w.h,w.parent=v,w.opened?o.updateItem(w):(o.push(w),w.opened=!0)))}return[]};var Sc=Jv,Qv=Sc;function La(e){Qv.call(this,e);var t=this.heuristic;this.heuristic=function(r,i){return t(r,i)*1e6}}La.prototype=new Qv;La.prototype.constructor=La;var RO=La,MO=We,ru=Qe;function ty(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=ru.OnlyWhenNoObstacles:this.diagonalMovement=ru.IfAtMostOneObstacle:this.diagonalMovement=ru.Never)}ty.prototype.findPath=function(e,t,r,i,n){var o=[],l=this.diagonalMovement,h=n.getNodeAt(e,t),u=n.getNodeAt(r,i),f,d,g,m,v;for(o.push(h),h.opened=!0;o.length;){if(g=o.shift(),g.closed=!0,g===u)return MO.backtrace(u);for(f=n.getNeighbors(g,l),m=0,v=f.length;m<v;++m)d=f[m],!(d.closed||d.opened)&&(o.push(d),d.opened=!0,d.parent=g)}return[]};var DO=ty,ey=Sc;function Na(e){ey.call(this,e),this.heuristic=function(t,r){return 0}}Na.prototype=new ey;Na.prototype.constructor=Na;var BO=Na,Gg=Ka,Wg=We,iu=Ws,na=Qe;function ry(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.heuristic=e.heuristic||iu.manhattan,this.weight=e.weight||1,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=na.OnlyWhenNoObstacles:this.diagonalMovement=na.IfAtMostOneObstacle:this.diagonalMovement=na.Never),this.diagonalMovement===na.Never?this.heuristic=e.heuristic||iu.manhattan:this.heuristic=e.heuristic||iu.octile}ry.prototype.findPath=function(e,t,r,i,n){var o=function(X,j){return X.f-j.f},l=new Gg(o),h=new Gg(o),u=n.getNodeAt(e,t),f=n.getNodeAt(r,i),d=this.heuristic,g=this.diagonalMovement,m=this.weight,v=Math.abs,_=Math.SQRT2,w,x,A,S,E,I,D,L,O=1,F=2;for(u.g=0,u.f=0,l.push(u),u.opened=O,f.g=0,f.f=0,h.push(f),f.opened=F;!l.empty()&&!h.empty();){for(w=l.pop(),w.closed=!0,x=n.getNeighbors(w,g),S=0,E=x.length;S<E;++S)if(A=x[S],!A.closed){if(A.opened===F)return Wg.biBacktrace(w,A);I=A.x,D=A.y,L=w.g+(I-w.x===0||D-w.y===0?1:_),(!A.opened||L<A.g)&&(A.g=L,A.h=A.h||m*d(v(I-r),v(D-i)),A.f=A.g+A.h,A.parent=w,A.opened?l.updateItem(A):(l.push(A),A.opened=O))}for(w=h.pop(),w.closed=!0,x=n.getNeighbors(w,g),S=0,E=x.length;S<E;++S)if(A=x[S],!A.closed){if(A.opened===O)return Wg.biBacktrace(A,w);I=A.x,D=A.y,L=w.g+(I-w.x===0||D-w.y===0?1:_),(!A.opened||L<A.g)&&(A.g=L,A.h=A.h||m*d(v(I-e),v(D-t)),A.f=A.g+A.h,A.parent=w,A.opened?h.updateItem(A):(h.push(A),A.opened=F))}}return[]};var Cc=ry,iy=Cc;function ka(e){iy.call(this,e);var t=this.heuristic;this.heuristic=function(r,i){return t(r,i)*1e6}}ka.prototype=new iy;ka.prototype.constructor=ka;var OO=ka,$g=We,nu=Qe;function ny(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=nu.OnlyWhenNoObstacles:this.diagonalMovement=nu.IfAtMostOneObstacle:this.diagonalMovement=nu.Never)}ny.prototype.findPath=function(e,t,r,i,n){var o=n.getNodeAt(e,t),l=n.getNodeAt(r,i),h=[],u=[],f,d,g,m=this.diagonalMovement,v=0,_=1,w,x;for(h.push(o),o.opened=!0,o.by=v,u.push(l),l.opened=!0,l.by=_;h.length&&u.length;){for(g=h.shift(),g.closed=!0,f=n.getNeighbors(g,m),w=0,x=f.length;w<x;++w)if(d=f[w],!d.closed){if(d.opened){if(d.by===_)return $g.biBacktrace(g,d);continue}h.push(d),d.parent=g,d.opened=!0,d.by=v}for(g=u.shift(),g.closed=!0,f=n.getNeighbors(g,m),w=0,x=f.length;w<x;++w)if(d=f[w],!d.closed){if(d.opened){if(d.by===v)return $g.biBacktrace(d,g);continue}u.push(d),d.parent=g,d.opened=!0,d.by=_}}return[]};var FO=ny,sy=Cc;function Ua(e){sy.call(this,e),this.heuristic=function(t,r){return 0}}Ua.prototype=new sy;Ua.prototype.constructor=Ua;var LO=Ua,su=Ws,Hg=Tc,sa=Qe;function oy(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.heuristic=e.heuristic||su.manhattan,this.weight=e.weight||1,this.trackRecursion=e.trackRecursion||!1,this.timeLimit=e.timeLimit||1/0,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=sa.OnlyWhenNoObstacles:this.diagonalMovement=sa.IfAtMostOneObstacle:this.diagonalMovement=sa.Never),this.diagonalMovement===sa.Never?this.heuristic=e.heuristic||su.manhattan:this.heuristic=e.heuristic||su.octile}oy.prototype.findPath=function(e,t,r,i,n){var o=new Date().getTime(),l=(function(w,x){return this.heuristic(Math.abs(x.x-w.x),Math.abs(x.y-w.y))}).bind(this),h=function(w,x){return w.x===x.x||w.y===x.y?1:Math.SQRT2},u=(function(w,x,A,S,E){if(this.timeLimit>0&&new Date().getTime()-o>this.timeLimit*1e3)return 1/0;var I=x+l(w,d)*this.weight;if(I>A)return I;if(w==d)return S[E]=[w.x,w.y],w;var D,L,O,F,X=n.getNeighbors(w,this.diagonalMovement);for(O=0,D=1/0;F=X[O];++O){if(this.trackRecursion&&(F.retainCount=F.retainCount+1||1,F.tested!==!0&&(F.tested=!0)),L=u(F,x+h(w,F),A,S,E+1),L instanceof Hg)return S[E]=[w.x,w.y],L;this.trackRecursion&&--F.retainCount===0&&(F.tested=!1),L<D&&(D=L)}return D}).bind(this),f=n.getNodeAt(e,t),d=n.getNodeAt(r,i),g=l(f,d),m,v,_;for(m=0;;++m){if(v=[],_=u(f,0,g,v,0),_===1/0)return[];if(_ instanceof Hg)return v;g=_}return[]};var NO=oy,kO=Ka,Xg=We,ay=Ws;function Ic(e){e=e||{},this.heuristic=e.heuristic||ay.manhattan,this.trackJumpRecursion=e.trackJumpRecursion||!1}Ic.prototype.findPath=function(e,t,r,i,n){var o=this.openList=new kO(function(f,d){return f.f-d.f}),l=this.startNode=n.getNodeAt(e,t),h=this.endNode=n.getNodeAt(r,i),u;for(this.grid=n,l.g=0,l.f=0,o.push(l),l.opened=!0;!o.empty();){if(u=o.pop(),u.closed=!0,u===h)return Xg.expandPath(Xg.backtrace(h));this._identifySuccessors(u)}return[]};Ic.prototype._identifySuccessors=function(e){var t=this.grid,r=this.heuristic,i=this.openList,n=this.endNode.x,o=this.endNode.y,l,h,u,f,d,g=e.x,m=e.y,v,_,w,x,A,S=Math.abs;for(l=this._findNeighbors(e),f=0,d=l.length;f<d;++f)if(h=l[f],u=this._jump(h[0],h[1],g,m),u){if(v=u[0],_=u[1],A=t.getNodeAt(v,_),A.closed)continue;w=ay.octile(S(v-g),S(_-m)),x=e.g+w,(!A.opened||x<A.g)&&(A.g=x,A.h=A.h||r(S(v-n),S(_-o)),A.f=A.g+A.h,A.parent=e,A.opened?i.updateItem(A):(i.push(A),A.opened=!0))}};var Za=Ic,ly=Za,UO=Qe;function Gn(e){ly.call(this,e)}Gn.prototype=new ly;Gn.prototype.constructor=Gn;Gn.prototype._jump=function(e,t,r,i){var n=this.grid,o=e-r,l=t-i;if(!n.isWalkableAt(e,t))return null;if(this.trackJumpRecursion===!0&&(n.getNodeAt(e,t).tested=!0),n.getNodeAt(e,t)===this.endNode)return[e,t];if(o!==0){if(n.isWalkableAt(e,t-1)&&!n.isWalkableAt(e-o,t-1)||n.isWalkableAt(e,t+1)&&!n.isWalkableAt(e-o,t+1))return[e,t]}else if(l!==0){if(n.isWalkableAt(e-1,t)&&!n.isWalkableAt(e-1,t-l)||n.isWalkableAt(e+1,t)&&!n.isWalkableAt(e+1,t-l))return[e,t];if(this._jump(e+1,t,e,t)||this._jump(e-1,t,e,t))return[e,t]}else throw new Error("Only horizontal and vertical movements are allowed");return this._jump(e+o,t+l,e,t)};Gn.prototype._findNeighbors=function(e){var t=e.parent,r=e.x,i=e.y,n=this.grid,o,l,h,u,f=[],d,g,m,v;if(t)o=t.x,l=t.y,h=(r-o)/Math.max(Math.abs(r-o),1),u=(i-l)/Math.max(Math.abs(i-l),1),h!==0?(n.isWalkableAt(r,i-1)&&f.push([r,i-1]),n.isWalkableAt(r,i+1)&&f.push([r,i+1]),n.isWalkableAt(r+h,i)&&f.push([r+h,i])):u!==0&&(n.isWalkableAt(r-1,i)&&f.push([r-1,i]),n.isWalkableAt(r+1,i)&&f.push([r+1,i]),n.isWalkableAt(r,i+u)&&f.push([r,i+u]));else for(d=n.getNeighbors(e,UO.Never),m=0,v=d.length;m<v;++m)g=d[m],f.push([g.x,g.y]);return f};var GO=Gn,hy=Za,WO=Qe;function Wn(e){hy.call(this,e)}Wn.prototype=new hy;Wn.prototype.constructor=Wn;Wn.prototype._jump=function(e,t,r,i){var n=this.grid,o=e-r,l=t-i;if(!n.isWalkableAt(e,t))return null;if(this.trackJumpRecursion===!0&&(n.getNodeAt(e,t).tested=!0),n.getNodeAt(e,t)===this.endNode)return[e,t];if(o!==0&&l!==0){if(n.isWalkableAt(e-o,t+l)&&!n.isWalkableAt(e-o,t)||n.isWalkableAt(e+o,t-l)&&!n.isWalkableAt(e,t-l))return[e,t];if(this._jump(e+o,t,e,t)||this._jump(e,t+l,e,t))return[e,t]}else if(o!==0){if(n.isWalkableAt(e+o,t+1)&&!n.isWalkableAt(e,t+1)||n.isWalkableAt(e+o,t-1)&&!n.isWalkableAt(e,t-1))return[e,t]}else if(n.isWalkableAt(e+1,t+l)&&!n.isWalkableAt(e+1,t)||n.isWalkableAt(e-1,t+l)&&!n.isWalkableAt(e-1,t))return[e,t];return this._jump(e+o,t+l,e,t)};Wn.prototype._findNeighbors=function(e){var t=e.parent,r=e.x,i=e.y,n=this.grid,o,l,h,u,f=[],d,g,m,v;if(t)o=t.x,l=t.y,h=(r-o)/Math.max(Math.abs(r-o),1),u=(i-l)/Math.max(Math.abs(i-l),1),h!==0&&u!==0?(n.isWalkableAt(r,i+u)&&f.push([r,i+u]),n.isWalkableAt(r+h,i)&&f.push([r+h,i]),n.isWalkableAt(r+h,i+u)&&f.push([r+h,i+u]),n.isWalkableAt(r-h,i)||f.push([r-h,i+u]),n.isWalkableAt(r,i-u)||f.push([r+h,i-u])):h===0?(n.isWalkableAt(r,i+u)&&f.push([r,i+u]),n.isWalkableAt(r+1,i)||f.push([r+1,i+u]),n.isWalkableAt(r-1,i)||f.push([r-1,i+u])):(n.isWalkableAt(r+h,i)&&f.push([r+h,i]),n.isWalkableAt(r,i+1)||f.push([r+h,i+1]),n.isWalkableAt(r,i-1)||f.push([r+h,i-1]));else for(d=n.getNeighbors(e,WO.Always),m=0,v=d.length;m<v;++m)g=d[m],f.push([g.x,g.y]);return f};var $O=Wn,uy=Za,HO=Qe;function $n(e){uy.call(this,e)}$n.prototype=new uy;$n.prototype.constructor=$n;$n.prototype._jump=function(e,t,r,i){var n=this.grid,o=e-r,l=t-i;if(!n.isWalkableAt(e,t))return null;if(this.trackJumpRecursion===!0&&(n.getNodeAt(e,t).tested=!0),n.getNodeAt(e,t)===this.endNode)return[e,t];if(o!==0&&l!==0){if(this._jump(e+o,t,e,t)||this._jump(e,t+l,e,t))return[e,t]}else if(o!==0){if(n.isWalkableAt(e,t-1)&&!n.isWalkableAt(e-o,t-1)||n.isWalkableAt(e,t+1)&&!n.isWalkableAt(e-o,t+1))return[e,t]}else if(l!==0&&(n.isWalkableAt(e-1,t)&&!n.isWalkableAt(e-1,t-l)||n.isWalkableAt(e+1,t)&&!n.isWalkableAt(e+1,t-l)))return[e,t];return n.isWalkableAt(e+o,t)&&n.isWalkableAt(e,t+l)?this._jump(e+o,t+l,e,t):null};$n.prototype._findNeighbors=function(e){var t=e.parent,r=e.x,i=e.y,n=this.grid,o,l,h,u,f=[],d,g,m,v;if(t)if(o=t.x,l=t.y,h=(r-o)/Math.max(Math.abs(r-o),1),u=(i-l)/Math.max(Math.abs(i-l),1),h!==0&&u!==0)n.isWalkableAt(r,i+u)&&f.push([r,i+u]),n.isWalkableAt(r+h,i)&&f.push([r+h,i]),n.isWalkableAt(r,i+u)&&n.isWalkableAt(r+h,i)&&f.push([r+h,i+u]);else{var _;if(h!==0){_=n.isWalkableAt(r+h,i);var w=n.isWalkableAt(r,i+1),x=n.isWalkableAt(r,i-1);_&&(f.push([r+h,i]),w&&f.push([r+h,i+1]),x&&f.push([r+h,i-1])),w&&f.push([r,i+1]),x&&f.push([r,i-1])}else if(u!==0){_=n.isWalkableAt(r,i+u);var A=n.isWalkableAt(r+1,i),S=n.isWalkableAt(r-1,i);_&&(f.push([r,i+u]),A&&f.push([r+1,i+u]),S&&f.push([r-1,i+u])),A&&f.push([r+1,i]),S&&f.push([r-1,i])}}else for(d=n.getNeighbors(e,HO.OnlyWhenNoObstacles),m=0,v=d.length;m<v;++m)g=d[m],f.push([g.x,g.y]);return f};var XO=$n,cy=Za,zO=Qe;function Hn(e){cy.call(this,e)}Hn.prototype=new cy;Hn.prototype.constructor=Hn;Hn.prototype._jump=function(e,t,r,i){var n=this.grid,o=e-r,l=t-i;if(!n.isWalkableAt(e,t))return null;if(this.trackJumpRecursion===!0&&(n.getNodeAt(e,t).tested=!0),n.getNodeAt(e,t)===this.endNode)return[e,t];if(o!==0&&l!==0){if(n.isWalkableAt(e-o,t+l)&&!n.isWalkableAt(e-o,t)||n.isWalkableAt(e+o,t-l)&&!n.isWalkableAt(e,t-l))return[e,t];if(this._jump(e+o,t,e,t)||this._jump(e,t+l,e,t))return[e,t]}else if(o!==0){if(n.isWalkableAt(e+o,t+1)&&!n.isWalkableAt(e,t+1)||n.isWalkableAt(e+o,t-1)&&!n.isWalkableAt(e,t-1))return[e,t]}else if(n.isWalkableAt(e+1,t+l)&&!n.isWalkableAt(e+1,t)||n.isWalkableAt(e-1,t+l)&&!n.isWalkableAt(e-1,t))return[e,t];return n.isWalkableAt(e+o,t)||n.isWalkableAt(e,t+l)?this._jump(e+o,t+l,e,t):null};Hn.prototype._findNeighbors=function(e){var t=e.parent,r=e.x,i=e.y,n=this.grid,o,l,h,u,f=[],d,g,m,v;if(t)o=t.x,l=t.y,h=(r-o)/Math.max(Math.abs(r-o),1),u=(i-l)/Math.max(Math.abs(i-l),1),h!==0&&u!==0?(n.isWalkableAt(r,i+u)&&f.push([r,i+u]),n.isWalkableAt(r+h,i)&&f.push([r+h,i]),(n.isWalkableAt(r,i+u)||n.isWalkableAt(r+h,i))&&f.push([r+h,i+u]),!n.isWalkableAt(r-h,i)&&n.isWalkableAt(r,i+u)&&f.push([r-h,i+u]),!n.isWalkableAt(r,i-u)&&n.isWalkableAt(r+h,i)&&f.push([r+h,i-u])):h===0?n.isWalkableAt(r,i+u)&&(f.push([r,i+u]),n.isWalkableAt(r+1,i)||f.push([r+1,i+u]),n.isWalkableAt(r-1,i)||f.push([r-1,i+u])):n.isWalkableAt(r+h,i)&&(f.push([r+h,i]),n.isWalkableAt(r,i+1)||f.push([r+h,i+1]),n.isWalkableAt(r,i-1)||f.push([r+h,i-1]));else for(d=n.getNeighbors(e,zO.IfAtMostOneObstacle),m=0,v=d.length;m<v;++m)g=d[m],f.push([g.x,g.y]);return f};var VO=Hn,ou=Qe,YO=GO,jO=$O,qO=XO,KO=VO;function ZO(e){return e=e||{},e.diagonalMovement===ou.Never?new YO(e):e.diagonalMovement===ou.Always?new jO(e):e.diagonalMovement===ou.OnlyWhenNoObstacles?new qO(e):new KO(e)}var JO=ZO,QO={Heap:Ka,Node:Tc,Grid:wO,Util:We,DiagonalMovement:Qe,Heuristic:Ws,AStarFinder:Sc,BestFirstFinder:RO,BreadthFirstFinder:DO,DijkstraFinder:BO,BiAStarFinder:Cc,BiBestFirstFinder:OO,BiBreadthFirstFinder:FO,BiDijkstraFinder:LO,IDAStarFinder:NO,JumpPointFinder:JO},tF=QO;const zg=Ga(tF),eF=ct.with("position"),rF=(e,t)=>{const{width:r,height:i}=ee().views.map,n=new zg.Grid(r,i);for(const h of eF)if(h.blocking&&!h.pathThrough){const{x:u,y:f}=h.position;n.setWalkableAt(u,f,!1)}return n.setWalkableAt(e.x,e.y,!0),n.setWalkableAt(t.x,t.y,!0),new zg.AStarFinder({}).findPath(e.x,e.y,t.x,t.y,n)},iF=ct.with("pc","position"),nF=ct.with("ai","position"),sF=()=>{const[e]=iF.entities;for(const t of nF){const r=rF(t.position,e.position);if(r[1]){const i={x:r[1][0],y:r[1][1],z:t.position.z};ct.addComponent(t,"tryMove",i)}}},ji=e=>`${e.x},${e.y},${e.z}`,Vg=(e,t)=>{const{x:r,y:i,z:n,width:o,height:l,hasWalls:h}=e,u={},f=r,d=r+o,g=i,m=i+l;if(h)for(let _=g+1;_<m-1;_++)for(let w=f+1;w<d-1;w++)u[`${w},${_},${n}`]={x:w,y:_,z:n,...t};else for(let _=g;_<m;_++)for(let w=f;w<d;w++)u[`${w},${_},${n}`]={x:w,y:_,z:n,...t};const v={x:Math.round((f+d)/2),y:Math.round((g+m)/2),z:n};return{x1:f,x2:d,y1:g,y2:m,z:n,center:v,hasWalls:h,tiles:u,width:o,height:l}},oF=(e,t)=>e.x1<=t.x2&&e.x2>=t.x1&&e.y1<=t.y2&&e.y2>=t.y1,aF=(e,t)=>{const r=Math.pow(t.x-e.x,2),i=Math.pow(t.y-e.y,2);return Math.floor(Math.sqrt(r+i))},lF=[{xx:1,xy:0,yx:0,yy:1},{xx:1,xy:0,yx:0,yy:-1},{xx:-1,xy:0,yx:0,yy:1},{xx:-1,xy:0,yx:0,yy:-1},{xx:0,xy:1,yx:1,yy:0},{xx:0,xy:1,yx:-1,yy:0},{xx:0,xy:-1,yx:1,yy:0},{xx:0,xy:-1,yx:-1,yy:0}];function hF(e,t,r,i,n){const{x:o,y:l,z:h}=i,u=new Set,f=new Set;for(const v of e)v.position.z===h&&f.add(ji(v.position));const d=(v,_)=>{const w=`${v},${_},${h}`;return!!f.has(w)},g=(v,_)=>u.add(`${v},${_},${h}`);function m(v,_,w,x,A,S,E){let I=0;if(x<A)return;let D=!1;for(let L=w;L<E&&!D;L++){let O=-L;for(let F=-L;F<=0;F++){let X=v+F*S.xx+O*S.xy,j=_+F*S.yx+O*S.yy,z=(F-.5)/(O+.5),K=(F+.5)/(O-.5);if(!(!(X>=0&&j>=0&&X<t&&j<r)||x<K)){if(A>z)break;if(Math.sqrt(F*F+O*O)<=E&&g(X,j),D)if(d(X,j)){I=K;continue}else D=!1,x=I;else d(X,j)&&L<E&&(D=!0,m(v,_,L+1,x,z,S,E),I=K)}}}}g(o,l);for(let v of lF)m(o,l,1,1,0,v,n);return{fov:u}}const uF=ct.with("inFov","position"),cF=ct.with("opaque","position"),fF=ct.with("pc","position"),dF=ct.with("appearance","position"),ma=()=>{let e;for(const r of fF)e=r;if(!e)return;const t=hF(cF,74,39,e.position,10);for(const r of uF)ct.removeComponent(r,"inFov");for(const r of dF)t.fov.has(ji(r.position))&&(ct.addComponent(r,"inFov",!0),ct.addComponent(r,"revealed",!0))},va=e=>{console.log(JSON.parse(JSON.stringify(e)))},Hi=e=>{dr(t=>t.log.push(e))},pF=ct.with("pc"),gF=ct.with("tryPickUp"),mF=()=>{var t,r;const[e]=pF;for(const i of gF){if(!i.pickUp){console.log("Entity is not a pickup"),va(i);break}const{pickerId:n}=i.tryPickUp,o=ct.entity(n);if(!o){console.log(`pickerId ${n} does not exist`);break}const{container:l}=o;if(!l){console.log("Picker has no container"),va(o),o===e&&Hi("You have nowhere to put that."),ct.removeComponent(i,"tryPickUp");break}if(l.contents.length>=l.slots){console.log("Picker has no room in container"),va(o),o===e&&Hi(`You have no room in your ${(t=e==null?void 0:e.container)==null?void 0:t.name}.`),ct.removeComponent(i,"tryPickUp");break}const h=ct.id(i);if(Ze.isUndefined(h)){console.log(`pickupId ${h} does not exist`),ct.removeComponent(i,"tryPickUp");break}l.contents.push(h),ct.removeComponent(i,"tryPickUp"),ct.removeComponent(i,"position"),Hi(`${o.name} puts ${i.name} in ${(r=o==null?void 0:o.container)==null?void 0:r.name}`)}},vF=ct.with("position","tryMove"),yF=ct.with("blocking","position"),Yg=()=>{for(const e of vF){const{position:t,tryMove:r}=e;let i=!1;for(const n of yF)if(n.position.x===r.x&&n.position.y===r.y){ct.removeComponent(e,"tryMove"),n.health?(n.health.current-=5,(e.pc||n.pc)&&Hi(`${n.name} attacked by ${e.name} for 5hp`)):e.pc&&Hi(`${e.name} blocked by ${n.name}`),i=!0;break}i||(t.x=r.x,t.y=r.y,t.z=r.z,ct.removeComponent(e,"tryMove"))}},_n=(e,t)=>{let r=e;if(r.length>t){const i=r.length-(t-3);r=r.substring(0,r.length-i).trim().concat("...")}return r},_F=e=>e<4?(100-(5-e)*7)/100:1,au=ct.with("position","appearance","layer100"),lu=ct.with("position","appearance","layer200"),hu=ct.with("position","appearance","layer300"),uu=ct.with("position","appearance","layer400"),xF=ct.with("inFov","legendable","position","appearance","name"),bF=ct.with("pc","position"),Ke=(e,t,r)=>{const{appearance:i,position:n}=t;if(!i||!n)return;const{char:o,tint:l,tileSet:h}=i,{x:u,y:f}=n;e==null||e.updateCell({0:{char:o,tint:65280,alpha:0,tileSet:"tile",x:u,y:f},1:{char:o,tint:l,alpha:r,tileSet:h,x:u,y:f}})},ya=()=>{const e=ee().views.map;if(!e)return;for(const r of au)r.inFov&&Ke(e,r,1);for(const r of lu)r.inFov&&Ke(e,r,1);for(const r of hu)r.inFov&&Ke(e,r,1);for(const r of uu)r.inFov&&Ke(e,r,1);for(const r of au)!r.inFov&&r.revealed&&Ke(e,r,.35);for(const r of lu)!r.inFov&&r.revealed&&Ke(e,r,.35);for(const r of hu)!r.inFov&&r.revealed&&Ke(e,r,.35);for(const r of uu)!r.inFov&&r.revealed&&Ke(e,r,.35);if(window.skulltooth.debug){for(const r of au)Ke(e,r,1);for(const r of lu)Ke(e,r,1);for(const r of hu)Ke(e,r,1);for(const r of uu)Ke(e,r,1)}{const r=ee().views.senses,i=ee().senses,n=r.width-1;r==null||r.updateRows([[{string:_n(i.feel,n)}],[{string:_n(i.see,n)}],[{string:_n(i.hear,n)}],[{string:_n(i.smell,n)}],[{string:_n(i.taste,n)}]])}{const r=ee().views.legend;if(r){const i=[],[n]=bF;for(const l of xF)i.push(l);i.sort(l=>aF(n.position,l.position)),r==null||r.clearView();const o=[];i.forEach(l=>{const h=l.appearance.char,u=l.name,f=`${h} ${u}`;o.push([{string:f}])}),r==null||r.updateRows(o)}}{const r=ee().views.log;if(r){const i=ee().log,n=i.slice(Math.max(i.length-5,0)),o=r.width-1;r==null||r.updateRows(n.map((l,h)=>[{string:_n(l,o),alpha:_F(h)}]))}}const t=ee().views.controls;if(t){let r="(arrows/hjkl)Move (i)Inventory";ee().gameState===Ui.INVENTORY&&(r="(i/escape)Return to Game (d)Drop (c)Consume"),t==null||t.updateRows([[],[{string:r}]])}},wF=["ArrowLeft","ArrowDown","ArrowUp","ArrowRight","h","j","k","l"],jg=ct.with("pc"),EF=ct.with("pickUp"),qg=()=>{const{userInput:e,gameState:t}=ee();if(!e)return dr(n=>{n.userInput=null});const{key:r}=e,[i]=jg;if(t===Ui.GAME){if(r==="i"&&dr(n=>n.gameState=Ui.INVENTORY),wF.includes(r)){for(const n of jg)if(n!=null&&n.position){const{x:o,y:l,z:h}=n.position;if(r==="h"||r==="ArrowLeft"){const u={x:o-1,y:l,z:h};ct.addComponent(n,"tryMove",u)}if(r==="j"||r==="ArrowDown"){const u={x:o,y:l+1,z:h};ct.addComponent(n,"tryMove",u)}if(r==="k"||r==="ArrowUp"){const u={x:o,y:l-1,z:h};ct.addComponent(n,"tryMove",u)}if(r==="l"||r==="ArrowRight"){const u={x:o+1,y:l,z:h};ct.addComponent(n,"tryMove",u)}}}if(r==="g"){let n=!0;for(const o of EF){if(!i.position||!o.position)break;if(ji(i.position)===ji(o.position)){const l=ct.id(i);Ze.isUndefined(l)||(ct.addComponent(o,"tryPickUp",{pickerId:l}),n=!1)}}n&&Hi("There is nothing to pickup")}}t===Ui.INVENTORY&&(r==="i"||r==="Escape")&&dr(n=>n.gameState=Ui.GAME),dr(n=>{n.userInput=null})};var Ki=(e=>(e.default="?",e.floor="•",e.owlbear="F",e.player="@",e.potion="!",e.rat="r",e.rock="*",e.wall="#",e))(Ki||{}),Zi=(e=>(e[e.default=65399]="default",e[e.floor=3355443]="floor",e[e.owlbear=11027200]="owlbear",e[e.player=16777215]="player",e[e.potion=14329120]="potion",e[e.rat=14047863]="rat",e[e.rock=8355711]="rock",e[e.wall=8421504]="wall",e))(Zi||{});const $s={appearance:{char:Ki.default,tint:Zi.default,tileSet:"ascii"},position:{x:0,y:0,z:0},name:"default"},fy={layer100:!0},dy={health:{max:1,current:1},blocking:!0,layer300:!0},TF={...$s,...dy,appearance:{char:Ki.player,tint:Zi.player,tileSet:"ascii"},health:{max:10,current:10},legendable:!0,name:"player",pc:!0,container:{name:"Haversack",description:"A simple medium sized burlap pouch with a single shoulder strap.",slots:1,contents:[]}},AF={...$s,...fy,appearance:{char:Ki.wall,tint:Zi.wall,tileSet:"ascii"},blocking:!0,opaque:!0,name:"wall"},SF={...$s,...fy,appearance:{char:Ki.floor,tint:Zi.floor,tileSet:"ascii"},name:"floor"},CF={...$s,...dy,ai:!0,appearance:{char:Ki.rat,tint:Zi.rat,tileSet:"ascii"},health:{max:1,current:1},legendable:!0,name:"rat",pathThrough:!0};({...$s,appearance:(Ki.rock,Zi.rock)});function IF(e,t){const r={},i=Math.min(e.x,t.x),n=Math.max(e.x,t.x)+1;let o=i;for(;o<n;){const l={...t,x:o};r[ji(l)]={...l,sprite:"FLOOR"},o++}return r}function PF(e,t){const r={},i=Math.min(e.y,t.y),n=Math.max(e.y,t.y)+1;let o=i;for(;o<n;){const l={...e,y:o};r[ji(l)]={...l,sprite:"FLOOR"},o++}return r}const RF=e=>{const{pos:t,width:r,height:i,minRoomSize:n=6,maxRoomSize:o=12,maxRoomCount:l=30}=e,{x:h,y:u,z:f}=t,d={...Vg({x:h,y:u,z:f,width:r,height:i,hasWalls:!1},{sprite:"WALL"}),rooms:[]};let g={};Ze.times(l,()=>{let _=Ze.random(n,o),w=Ze.random(n,o),x=Ze.random(h,r+h-_-1),A=Ze.random(u,i+u-w-1);const S=Vg({x,y:A,z:f,width:_,height:w,hasWalls:!0},{sprite:"FLOOR"});d.rooms.some(E=>oF(E,S))||(d.rooms.push(S),g={...g,...S.tiles})});let m=null,v={};for(let _ of d.rooms)m&&(v={...v,...IF(_.center,m.center),...PF(_.center,m.center)}),m=_;return d.tiles={...d.tiles,...g,...v},d},MF=()=>{const e=RF({pos:{x:0,y:0,z:0},width:74,height:39,minRoomSize:8,maxRoomSize:18,maxRoomCount:100}),t=Object.values(e.tiles);for(const r of t){if(r.sprite==="WALL"){const{x:i,y:n,z:o}=r;ct.add({...Ze.cloneDeep(AF),position:{x:i,y:n,z:o}})}if(r.sprite==="FLOOR"){const{x:i,y:n,z:o}=r;ct.add({...Ze.cloneDeep(SF),position:{x:i,y:n,z:o}})}}return e.rooms.forEach((r,i)=>{i&&ct.add({...Ze.cloneDeep(CF),position:r.center})}),e},DF=ct.with("health").without("dead"),Kg=()=>{for(const e of DF)e.health.current<=0&&(e.appearance&&(e.appearance.char="%"),ct.removeComponent(e,"ai"),ct.removeComponent(e,"blocking"),ct.removeComponent(e,"layer300"),ct.addComponent(e,"dead",!0),ct.addComponent(e,"pickUp",!0),ct.addComponent(e,"layer200",!0),Hi(`${e.name} has died!`),e.pc&&(dr(t=>t.gameState=Ui.GAME_OVER),console.log("Game Over!")))};var Ui=(e=>(e.GAME="GAME",e.GAME_OVER="GAME_OVER",e.INVENTORY="INVENTORY",e.INSPECT="INSPECT",e.TARGET="TARGET",e))(Ui||{});window.skulltooth=window.skulltooth||{};window.skulltooth.debug=!1;const Fs={fps:0,gameState:"GAME",log:["hello world","your adventure begins anew!"],senses:{feel:"You feel nothing.",see:"You see nothing.",hear:"You hear nothing.",smell:"You smell nothing.",taste:"You taste nothing."},turn:"PLAYER",userInput:null,views:{}};window.skulltooth.state=Fs;const dr=e=>{e(Fs)},ee=()=>Fs,BF=async()=>{await NB(document.querySelector("#canvas")),new Er({width:12,height:2,x:0,y:0,layers:2,tileSets:["tile","text"],tints:[16777215,16711799],alphas:[1,1],visible:!0}).updateRows([[{},{string:"skulltooth 2"}],[{tint:16711799},{string:"forcecrusher",tint:16777215}]]);const e=new Er({width:25,height:42,x:0,y:2,layers:1,tileSets:["text"],tints:[16711799],alphas:[1],visible:!0}),t=new Er({width:74,height:5,x:26,y:0,layers:1,tileSets:["text"],tints:[15658734],alphas:[1],visible:!0}),r=new Er({width:74,height:5,x:100,y:0,layers:1,tileSets:["text"],tints:[16711799],alphas:[1],visible:!0}),i=new Er({width:74,height:39,x:13,y:5,layers:3,tileSets:["tile","ascii","tile"],tints:[0,0,0],alphas:[1,1,0],visible:!0}),n=new Er({width:12,height:1,x:0,y:44,layers:1,tileSets:["text"],tints:[14540253],alphas:[1],visible:!0}).updateRows([[{string:"FPS: calc..."}]]);new Er({width:12,height:1,x:0,y:45,layers:1,tileSets:["text"],tints:[16777215],alphas:[1],visible:!0}).updateRows([[{string:"TAG: 74552d8"}]]);const o=new Er({width:148,height:2,x:26,y:44,layers:1,tileSets:["text"],tints:[15658734],alphas:[1],visible:!0}),l=new Er({width:100,height:44,x:0,y:0,layers:1,tileSets:["tile"],tints:[1118481],alphas:[.75],visible:!1}),h=new Er({width:148,height:39,x:26,y:5,layers:2,tileSets:["text","text"],tints:[1118481,16777215],alphas:[1],visible:!1});dr(g=>{g.views.fps=n,g.views.map=i,g.views.log=t,g.views.senses=r,g.views.legend=e,g.views.inventory=h,g.views.menuUnderlay=l,g.views.controls=o});const f=MF().rooms[0].center,d=ct.add(TF);d.position.x=f.x,d.position.y=f.y,d.position.z=f.z,ma(),ya(),py(),document.addEventListener("keydown",g=>{dr(m=>{m.userInput=g})}),document.addEventListener("mousedown",g=>{const m=g.x-Fs.views.map.layers[0].x,v=g.layerY-Fs.views.map.layers[0].y,w=LB(m,v,0);if(window.skulltooth.debug===!0){const x=ct.with("position");for(const A of x)w===ji(A.position)&&(console.log(w),va(A))}})};let cu=0,oa=Date.now(),aa=[];function py(){var e;requestAnimationFrame(py),ee().gameState==="INVENTORY"&&ee().userInput&&ee().turn==="PLAYER"&&(qg(),ma(),ya()),ee().gameState==="GAME"&&(ee().userInput&&ee().turn==="PLAYER"&&(qg(),mF(),Yg(),Kg(),ma(),ya(),ee().gameState==="GAME"&&dr(t=>{t.turn="WORLD"})),ee().turn==="WORLD"&&(sF(),Yg(),Kg(),ma(),ya(),dr(t=>{t.turn="PLAYER"}))),oa||(oa=Date.now()),Date.now()-oa>1e3&&(aa.unshift(cu),aa.length>3&&aa.pop(),isNaN(ee().fps)||(e=ee().views.fps)==null||e.updateRow({string:`FPS: ${ee().fps}     `,layer:0,x:0,y:0,tileSet:"text"}),oa=Date.now(),cu=0),dr(t=>t.fps=Math.round(Ze.mean(aa))),cu++}BF();
