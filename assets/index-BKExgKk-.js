var U$=Object.defineProperty;var z$=(t,e,r)=>e in t?U$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var _r=(t,e,r)=>(z$(t,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Qn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function G$(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var Xm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Xm.exports;(function(t,e){(function(){var r,n="4.17.21",i=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",s="Expected a function",o="Invalid `variable` option passed into `_.template`",l="__lodash_hash_undefined__",u=500,c="__lodash_placeholder__",f=1,h=2,p=4,m=1,v=2,y=1,x=2,S=4,b=8,A=16,E=32,_=64,T=128,M=256,N=512,I=30,F="...",P=800,U=16,G=1,V=2,$=3,j=1/0,k=9007199254740991,Z=17976931348623157e292,z=NaN,me=4294967295,fe=me-1,ue=me>>>1,le=[["ary",T],["bind",y],["bindKey",x],["curry",b],["curryRight",A],["flip",N],["partial",E],["partialRight",_],["rearg",M]],ke="[object Arguments]",Me="[object Array]",Se="[object AsyncFunction]",oe="[object Boolean]",K="[object Date]",de="[object DOMException]",_e="[object Error]",be="[object Function]",$e="[object GeneratorFunction]",Oe="[object Map]",Qe="[object Number]",ae="[object Null]",ce="[object Object]",Ce="[object Promise]",Ue="[object Proxy]",Ve="[object RegExp]",je="[object Set]",ht="[object String]",re="[object Symbol]",we="[object Undefined]",Ne="[object WeakMap]",Ge="[object WeakSet]",He="[object ArrayBuffer]",We="[object DataView]",ft="[object Float32Array]",st="[object Float64Array]",dt="[object Int8Array]",at="[object Int16Array]",tr="[object Int32Array]",Ot="[object Uint8Array]",fr="[object Uint8ClampedArray]",R="[object Uint16Array]",ge="[object Uint32Array]",Le=/\b__p \+= '';/g,rt=/\b(__p \+=) '' \+/g,Xe=/(__e\(.*?\)|\b__t\)) \+\n'';/g,qt=/&(?:amp|lt|gt|quot|#39);/g,pn=/[&<>"']/g,fs=RegExp(qt.source),Co=RegExp(pn.source),js=/<%-([\s\S]+?)%>/g,Tl=/<%([\s\S]+?)%>/g,To=/<%=([\s\S]+?)%>/g,Ia=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fa=/^\w*$/,No=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Oa=/[\\^$.*+?()[\]{}|]/g,Xr=RegExp(Oa.source),fn=/^\s+/,Nl=/\s/,Ys=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ks=/\{\n\/\* \[wrapped with (.+)\] \*/,Zs=/,? & /,Ml=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ea=/[()=,{}\[\]\/\s]/,Ba=/\\(\\)?/g,hi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ta=/\w*$/,Il=/^[-+]0x[0-9a-f]+$/i,ra=/^0b[01]+$/i,Eu=/^\[object .+?Constructor\]$/,ga=/^0o[0-7]+$/i,Su=/^(?:0|[1-9]\d*)$/,Mo=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,jr=/($^)/,di=/['\n\r\u2028\u2029\\]/g,ir="\\ud800-\\udfff",Tn="\\u0300-\\u036f",Ra="\\ufe20-\\ufe2f",ya="\\u20d0-\\u20ff",ki=Tn+Ra+ya,Qs="\\u2700-\\u27bf",Pa="a-z\\xdf-\\xf6\\xf8-\\xff",Io="\\xac\\xb1\\xd7\\xf7",Du="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",kc="\\u2000-\\u206f",Er=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fl="A-Z\\xc0-\\xd6\\xd8-\\xde",Ol="\\ufe0e\\ufe0f",Fo=Io+Du+kc+Er,hs="['’]",Lc="["+ir+"]",Oo="["+Fo+"]",$a="["+ki+"]",Hr="\\d+",Js="["+Qs+"]",eo="["+Pa+"]",ds="[^"+ir+Fo+Hr+Qs+Pa+Fl+"]",Bo="\\ud83c[\\udffb-\\udfff]",Bl="(?:"+$a+"|"+Bo+")",Ro="[^"+ir+"]",Cu="(?:\\ud83c[\\udde6-\\uddff]){2}",to="[\\ud800-\\udbff][\\udc00-\\udfff]",ps="["+Fl+"]",Uc="\\u200d",Tr="(?:"+eo+"|"+ds+")",zc="(?:"+ps+"|"+ds+")",Gc="(?:"+hs+"(?:d|ll|m|re|s|t|ve))?",qc="(?:"+hs+"(?:D|LL|M|RE|S|T|VE))?",ri=Bl+"?",ms="["+Ol+"]?",Tu="(?:"+Uc+"(?:"+[Ro,Cu,to].join("|")+")"+ms+ri+")*",ka="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Hc="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Rl=ms+ri+Tu,_n="(?:"+[Js,Cu,to].join("|")+")"+Rl,na="(?:"+[Ro+$a+"?",$a,Cu,to,Lc].join("|")+")",Po=RegExp(hs,"g"),$o=RegExp($a,"g"),ko=RegExp(Bo+"(?="+Bo+")|"+na+Rl,"g"),La=RegExp([ps+"?"+eo+"+"+Gc+"(?="+[Oo,ps,"$"].join("|")+")",zc+"+"+qc+"(?="+[Oo,ps+Tr,"$"].join("|")+")",ps+"?"+Tr+"+"+Gc,ps+"+"+qc,Hc,ka,Hr,_n].join("|"),"g"),Bh=RegExp("["+Uc+ir+ki+Ol+"]"),ia=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Pl=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Wc=-1,Wr={};Wr[ft]=Wr[st]=Wr[dt]=Wr[at]=Wr[tr]=Wr[Ot]=Wr[fr]=Wr[R]=Wr[ge]=!0,Wr[ke]=Wr[Me]=Wr[He]=Wr[oe]=Wr[We]=Wr[K]=Wr[_e]=Wr[be]=Wr[Oe]=Wr[Qe]=Wr[ce]=Wr[Ve]=Wr[je]=Wr[ht]=Wr[Ne]=!1;var Ur={};Ur[ke]=Ur[Me]=Ur[He]=Ur[We]=Ur[oe]=Ur[K]=Ur[ft]=Ur[st]=Ur[dt]=Ur[at]=Ur[tr]=Ur[Oe]=Ur[Qe]=Ur[ce]=Ur[Ve]=Ur[je]=Ur[ht]=Ur[re]=Ur[Ot]=Ur[fr]=Ur[R]=Ur[ge]=!0,Ur[_e]=Ur[be]=Ur[Ne]=!1;var $l={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Vc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Rh={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Lo={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ph=parseFloat,$h=parseInt,te=typeof Qn=="object"&&Qn&&Qn.Object===Object&&Qn,Dr=typeof self=="object"&&self&&self.Object===Object&&self,hn=te||Dr||Function("return this")(),Di=e&&!e.nodeType&&e,ba=Di&&!0&&t&&!t.nodeType&&t,ot=ba&&ba.exports===Di,Ua=ot&&te.process,Nn=function(){try{var W=ba&&ba.require&&ba.require("util").types;return W||Ua&&Ua.binding&&Ua.binding("util")}catch{}}(),Rt=Nn&&Nn.isArrayBuffer,Ci=Nn&&Nn.isDate,Uo=Nn&&Nn.isMap,zo=Nn&&Nn.isRegExp,Go=Nn&&Nn.isSet,kl=Nn&&Nn.isTypedArray;function gn(W,ne,J){switch(J.length){case 0:return W.call(ne);case 1:return W.call(ne,J[0]);case 2:return W.call(ne,J[0],J[1]);case 3:return W.call(ne,J[0],J[1],J[2])}return W.apply(ne,J)}function ct(W,ne,J,ye){for(var he=-1,Te=W==null?0:W.length;++he<Te;){var Ae=W[he];ne(ye,Ae,J(Ae),W)}return ye}function ni(W,ne){for(var J=-1,ye=W==null?0:W.length;++J<ye&&ne(W[J],J,W)!==!1;);return W}function Nu(W,ne){for(var J=W==null?0:W.length;J--&&ne(W[J],J,W)!==!1;);return W}function Mu(W,ne){for(var J=-1,ye=W==null?0:W.length;++J<ye;)if(!ne(W[J],J,W))return!1;return!0}function un(W,ne){for(var J=-1,ye=W==null?0:W.length,he=0,Te=[];++J<ye;){var Ae=W[J];ne(Ae,J,W)&&(Te[he++]=Ae)}return Te}function za(W,ne){var J=W==null?0:W.length;return!!J&&Ga(W,ne,0)>-1}function vs(W,ne,J){for(var ye=-1,he=W==null?0:W.length;++ye<he;)if(J(ne,W[ye]))return!0;return!1}function Qr(W,ne){for(var J=-1,ye=W==null?0:W.length,he=Array(ye);++J<ye;)he[J]=ne(W[J],J,W);return he}function ii(W,ne){for(var J=-1,ye=ne.length,he=W.length;++J<ye;)W[he+J]=ne[J];return W}function Iu(W,ne,J,ye){var he=-1,Te=W==null?0:W.length;for(ye&&Te&&(J=W[++he]);++he<Te;)J=ne(J,W[he],he,W);return J}function Xc(W,ne,J,ye){var he=W==null?0:W.length;for(ye&&he&&(J=W[--he]);he--;)J=ne(J,W[he],he,W);return J}function ro(W,ne){for(var J=-1,ye=W==null?0:W.length;++J<ye;)if(ne(W[J],J,W))return!0;return!1}var Ll=Ti("length");function gs(W){return W.split("")}function Ul(W){return W.match(Ml)||[]}function Fu(W,ne,J){var ye;return J(W,function(he,Te,Ae){if(ne(he,Te,Ae))return ye=Te,!1}),ye}function ys(W,ne,J,ye){for(var he=W.length,Te=J+(ye?1:-1);ye?Te--:++Te<he;)if(ne(W[Te],Te,W))return Te;return-1}function Ga(W,ne,J){return ne===ne?qa(W,ne,J):ys(W,Yc,J)}function jc(W,ne,J,ye){for(var he=J-1,Te=W.length;++he<Te;)if(ye(W[he],ne))return he;return-1}function Yc(W){return W!==W}function Ou(W,ne){var J=W==null?0:W.length;return J?qo(W,ne)/J:z}function Ti(W){return function(ne){return ne==null?r:ne[W]}}function zl(W){return function(ne){return W==null?r:W[ne]}}function bs(W,ne,J,ye,he){return he(W,function(Te,Ae,Ee){J=ye?(ye=!1,Te):ne(J,Te,Ae,Ee)}),J}function aa(W,ne){var J=W.length;for(W.sort(ne);J--;)W[J]=W[J].value;return W}function qo(W,ne){for(var J,ye=-1,he=W.length;++ye<he;){var Te=ne(W[ye]);Te!==r&&(J=J===r?Te:J+Te)}return J}function Bu(W,ne){for(var J=-1,ye=Array(W);++J<W;)ye[J]=ne(J);return ye}function xs(W,ne){return Qr(ne,function(J){return[J,W[J]]})}function Ho(W){return W&&W.slice(0,w(W)+1).replace(fn,"")}function Hn(W){return function(ne){return W(ne)}}function no(W,ne){return Qr(ne,function(J){return W[J]})}function ws(W,ne){return W.has(ne)}function Ru(W,ne){for(var J=-1,ye=W.length;++J<ye&&Ga(ne,W[J],0)>-1;);return J}function Gl(W,ne){for(var J=W.length;J--&&Ga(ne,W[J],0)>-1;);return J}function ql(W,ne){for(var J=W.length,ye=0;J--;)W[J]===ne&&++ye;return ye}var Pu=zl($l),an=zl(Vc);function Kc(W){return"\\"+Lo[W]}function H(W,ne){return W==null?r:W[ne]}function ve(W){return Bh.test(W)}function Ie(W){return ia.test(W)}function ze(W){for(var ne,J=[];!(ne=W.next()).done;)J.push(ne.value);return J}function tt(W){var ne=-1,J=Array(W.size);return W.forEach(function(ye,he){J[++ne]=[he,ye]}),J}function Et(W,ne){return function(J){return W(ne(J))}}function mr(W,ne){for(var J=-1,ye=W.length,he=0,Te=[];++J<ye;){var Ae=W[J];(Ae===ne||Ae===c)&&(W[J]=c,Te[he++]=J)}return Te}function Gr(W){var ne=-1,J=Array(W.size);return W.forEach(function(ye){J[++ne]=ye}),J}function Mn(W){var ne=-1,J=Array(W.size);return W.forEach(function(ye){J[++ne]=[ye,ye]}),J}function qa(W,ne,J){for(var ye=J-1,he=W.length;++ye<he;)if(W[ye]===ne)return ye;return-1}function $u(W,ne,J){for(var ye=J+1;ye--;)if(W[ye]===ne)return ye;return ye}function Li(W){return ve(W)?O(W):Ll(W)}function sa(W){return ve(W)?L(W):gs(W)}function w(W){for(var ne=W.length;ne--&&Nl.test(W.charAt(ne)););return ne}var C=zl(Rh);function O(W){for(var ne=ko.lastIndex=0;ko.test(W);)++ne;return ne}function L(W){return W.match(ko)||[]}function q(W){return W.match(La)||[]}var Y=function W(ne){ne=ne==null?hn:se.defaults(hn.Object(),ne,se.pick(hn,Pl));var J=ne.Array,ye=ne.Date,he=ne.Error,Te=ne.Function,Ae=ne.Math,Ee=ne.Object,Fe=ne.RegExp,Be=ne.String,Pe=ne.TypeError,qe=J.prototype,Ye=Te.prototype,et=Ee.prototype,vt=ne["__core-js_shared__"],xt=Ye.toString,Je=et.hasOwnProperty,bt=0,_t=function(){var d=/[^.]+$/.exec(vt&&vt.keys&&vt.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),yt=et.toString,Mt=xt.call(Ee),lr=hn._,vr=Fe("^"+xt.call(Je).replace(Oa,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),hr=ot?ne.Buffer:r,An=ne.Symbol,Jt=ne.Uint8Array,Wn=hr?hr.allocUnsafe:r,In=Et(Ee.getPrototypeOf,Ee),Hl=Ee.create,ai=et.propertyIsEnumerable,Ha=qe.splice,Zc=An?An.isConcatSpreadable:r,kh=An?An.iterator:r,Wl=An?An.toStringTag:r,ip=function(){try{var d=Kl(Ee,"defineProperty");return d({},"",{}),d}catch{}}(),LO=ne.clearTimeout!==hn.clearTimeout&&ne.clearTimeout,UO=ye&&ye.now!==hn.Date.now&&ye.now,zO=ne.setTimeout!==hn.setTimeout&&ne.setTimeout,ap=Ae.ceil,sp=Ae.floor,Tg=Ee.getOwnPropertySymbols,GO=hr?hr.isBuffer:r,rw=ne.isFinite,qO=qe.join,HO=Et(Ee.keys,Ee),Vn=Ae.max,Ni=Ae.min,WO=ye.now,VO=ne.parseInt,nw=Ae.random,XO=qe.reverse,Ng=Kl(ne,"DataView"),Lh=Kl(ne,"Map"),Mg=Kl(ne,"Promise"),Qc=Kl(ne,"Set"),Uh=Kl(ne,"WeakMap"),zh=Kl(Ee,"create"),op=Uh&&new Uh,Jc={},jO=Zl(Ng),YO=Zl(Lh),KO=Zl(Mg),ZO=Zl(Qc),QO=Zl(Uh),up=An?An.prototype:r,Gh=up?up.valueOf:r,iw=up?up.toString:r;function Q(d){if(En(d)&&!dr(d)&&!(d instanceof Fr)){if(d instanceof Wa)return d;if(Je.call(d,"__wrapped__"))return a_(d)}return new Wa(d)}var ef=function(){function d(){}return function(g){if(!yn(g))return{};if(Hl)return Hl(g);d.prototype=g;var D=new d;return d.prototype=r,D}}();function lp(){}function Wa(d,g){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!g,this.__index__=0,this.__values__=r}Q.templateSettings={escape:js,evaluate:Tl,interpolate:To,variable:"",imports:{_:Q}},Q.prototype=lp.prototype,Q.prototype.constructor=Q,Wa.prototype=ef(lp.prototype),Wa.prototype.constructor=Wa;function Fr(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=me,this.__views__=[]}function JO(){var d=new Fr(this.__wrapped__);return d.__actions__=oa(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=oa(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=oa(this.__views__),d}function eB(){if(this.__filtered__){var d=new Fr(this);d.__dir__=-1,d.__filtered__=!0}else d=this.clone(),d.__dir__*=-1;return d}function tB(){var d=this.__wrapped__.value(),g=this.__dir__,D=dr(d),B=g<0,X=D?d.length:0,ie=dR(0,X,this.__views__),xe=ie.start,De=ie.end,Re=De-xe,nt=B?De:xe-1,it=this.__iteratees__,lt=it.length,Ct=0,Pt=Ni(Re,this.__takeCount__);if(!D||!B&&X==Re&&Pt==Re)return Tw(d,this.__actions__);var Yt=[];e:for(;Re--&&Ct<Pt;){nt+=g;for(var Ar=-1,Kt=d[nt];++Ar<lt;){var Nr=it[Ar],Pr=Nr.iteratee,_a=Nr.type,Gi=Pr(Kt);if(_a==V)Kt=Gi;else if(!Gi){if(_a==G)continue e;break e}}Yt[Ct++]=Kt}return Yt}Fr.prototype=ef(lp.prototype),Fr.prototype.constructor=Fr;function Vl(d){var g=-1,D=d==null?0:d.length;for(this.clear();++g<D;){var B=d[g];this.set(B[0],B[1])}}function rB(){this.__data__=zh?zh(null):{},this.size=0}function nB(d){var g=this.has(d)&&delete this.__data__[d];return this.size-=g?1:0,g}function iB(d){var g=this.__data__;if(zh){var D=g[d];return D===l?r:D}return Je.call(g,d)?g[d]:r}function aB(d){var g=this.__data__;return zh?g[d]!==r:Je.call(g,d)}function sB(d,g){var D=this.__data__;return this.size+=this.has(d)?0:1,D[d]=zh&&g===r?l:g,this}Vl.prototype.clear=rB,Vl.prototype.delete=nB,Vl.prototype.get=iB,Vl.prototype.has=aB,Vl.prototype.set=sB;function Wo(d){var g=-1,D=d==null?0:d.length;for(this.clear();++g<D;){var B=d[g];this.set(B[0],B[1])}}function oB(){this.__data__=[],this.size=0}function uB(d){var g=this.__data__,D=cp(g,d);if(D<0)return!1;var B=g.length-1;return D==B?g.pop():Ha.call(g,D,1),--this.size,!0}function lB(d){var g=this.__data__,D=cp(g,d);return D<0?r:g[D][1]}function cB(d){return cp(this.__data__,d)>-1}function fB(d,g){var D=this.__data__,B=cp(D,d);return B<0?(++this.size,D.push([d,g])):D[B][1]=g,this}Wo.prototype.clear=oB,Wo.prototype.delete=uB,Wo.prototype.get=lB,Wo.prototype.has=cB,Wo.prototype.set=fB;function Vo(d){var g=-1,D=d==null?0:d.length;for(this.clear();++g<D;){var B=d[g];this.set(B[0],B[1])}}function hB(){this.size=0,this.__data__={hash:new Vl,map:new(Lh||Wo),string:new Vl}}function dB(d){var g=_p(this,d).delete(d);return this.size-=g?1:0,g}function pB(d){return _p(this,d).get(d)}function mB(d){return _p(this,d).has(d)}function vB(d,g){var D=_p(this,d),B=D.size;return D.set(d,g),this.size+=D.size==B?0:1,this}Vo.prototype.clear=hB,Vo.prototype.delete=dB,Vo.prototype.get=pB,Vo.prototype.has=mB,Vo.prototype.set=vB;function Xl(d){var g=-1,D=d==null?0:d.length;for(this.__data__=new Vo;++g<D;)this.add(d[g])}function gB(d){return this.__data__.set(d,l),this}function yB(d){return this.__data__.has(d)}Xl.prototype.add=Xl.prototype.push=gB,Xl.prototype.has=yB;function _s(d){var g=this.__data__=new Wo(d);this.size=g.size}function bB(){this.__data__=new Wo,this.size=0}function xB(d){var g=this.__data__,D=g.delete(d);return this.size=g.size,D}function wB(d){return this.__data__.get(d)}function _B(d){return this.__data__.has(d)}function AB(d,g){var D=this.__data__;if(D instanceof Wo){var B=D.__data__;if(!Lh||B.length<i-1)return B.push([d,g]),this.size=++D.size,this;D=this.__data__=new Vo(B)}return D.set(d,g),this.size=D.size,this}_s.prototype.clear=bB,_s.prototype.delete=xB,_s.prototype.get=wB,_s.prototype.has=_B,_s.prototype.set=AB;function aw(d,g){var D=dr(d),B=!D&&Ql(d),X=!D&&!B&&Gu(d),ie=!D&&!B&&!X&&af(d),xe=D||B||X||ie,De=xe?Bu(d.length,Be):[],Re=De.length;for(var nt in d)(g||Je.call(d,nt))&&!(xe&&(nt=="length"||X&&(nt=="offset"||nt=="parent")||ie&&(nt=="buffer"||nt=="byteLength"||nt=="byteOffset")||Ko(nt,Re)))&&De.push(nt);return De}function sw(d){var g=d.length;return g?d[zg(0,g-1)]:r}function EB(d,g){return Ap(oa(d),jl(g,0,d.length))}function SB(d){return Ap(oa(d))}function Ig(d,g,D){(D!==r&&!As(d[g],D)||D===r&&!(g in d))&&Xo(d,g,D)}function qh(d,g,D){var B=d[g];(!(Je.call(d,g)&&As(B,D))||D===r&&!(g in d))&&Xo(d,g,D)}function cp(d,g){for(var D=d.length;D--;)if(As(d[D][0],g))return D;return-1}function DB(d,g,D,B){return ku(d,function(X,ie,xe){g(B,X,D(X),xe)}),B}function ow(d,g){return d&&ao(g,si(g),d)}function CB(d,g){return d&&ao(g,la(g),d)}function Xo(d,g,D){g=="__proto__"&&ip?ip(d,g,{configurable:!0,enumerable:!0,value:D,writable:!0}):d[g]=D}function Fg(d,g){for(var D=-1,B=g.length,X=J(B),ie=d==null;++D<B;)X[D]=ie?r:h0(d,g[D]);return X}function jl(d,g,D){return d===d&&(D!==r&&(d=d<=D?d:D),g!==r&&(d=d>=g?d:g)),d}function Va(d,g,D,B,X,ie){var xe,De=g&f,Re=g&h,nt=g&p;if(D&&(xe=X?D(d,B,X,ie):D(d)),xe!==r)return xe;if(!yn(d))return d;var it=dr(d);if(it){if(xe=mR(d),!De)return oa(d,xe)}else{var lt=Mi(d),Ct=lt==be||lt==$e;if(Gu(d))return Iw(d,De);if(lt==ce||lt==ke||Ct&&!X){if(xe=Re||Ct?{}:Kw(d),!De)return Re?iR(d,CB(xe,d)):nR(d,ow(xe,d))}else{if(!Ur[lt])return X?d:{};xe=vR(d,lt,De)}}ie=new _s;var Pt=ie.get(d);if(Pt)return Pt;ie.set(d,xe),S_(d)?d.forEach(function(Kt){xe.add(Va(Kt,g,D,Kt,d,ie))}):A_(d)&&d.forEach(function(Kt,Nr){xe.set(Nr,Va(Kt,g,D,Nr,d,ie))});var Yt=nt?Re?Qg:Zg:Re?la:si,Ar=it?r:Yt(d);return ni(Ar||d,function(Kt,Nr){Ar&&(Nr=Kt,Kt=d[Nr]),qh(xe,Nr,Va(Kt,g,D,Nr,d,ie))}),xe}function TB(d){var g=si(d);return function(D){return uw(D,d,g)}}function uw(d,g,D){var B=D.length;if(d==null)return!B;for(d=Ee(d);B--;){var X=D[B],ie=g[X],xe=d[X];if(xe===r&&!(X in d)||!ie(xe))return!1}return!0}function lw(d,g,D){if(typeof d!="function")throw new Pe(s);return Kh(function(){d.apply(r,D)},g)}function Hh(d,g,D,B){var X=-1,ie=za,xe=!0,De=d.length,Re=[],nt=g.length;if(!De)return Re;D&&(g=Qr(g,Hn(D))),B?(ie=vs,xe=!1):g.length>=i&&(ie=ws,xe=!1,g=new Xl(g));e:for(;++X<De;){var it=d[X],lt=D==null?it:D(it);if(it=B||it!==0?it:0,xe&&lt===lt){for(var Ct=nt;Ct--;)if(g[Ct]===lt)continue e;Re.push(it)}else ie(g,lt,B)||Re.push(it)}return Re}var ku=Pw(io),cw=Pw(Bg,!0);function NB(d,g){var D=!0;return ku(d,function(B,X,ie){return D=!!g(B,X,ie),D}),D}function fp(d,g,D){for(var B=-1,X=d.length;++B<X;){var ie=d[B],xe=g(ie);if(xe!=null&&(De===r?xe===xe&&!wa(xe):D(xe,De)))var De=xe,Re=ie}return Re}function MB(d,g,D,B){var X=d.length;for(D=wr(D),D<0&&(D=-D>X?0:X+D),B=B===r||B>X?X:wr(B),B<0&&(B+=X),B=D>B?0:C_(B);D<B;)d[D++]=g;return d}function fw(d,g){var D=[];return ku(d,function(B,X,ie){g(B,X,ie)&&D.push(B)}),D}function pi(d,g,D,B,X){var ie=-1,xe=d.length;for(D||(D=yR),X=[];++ie<xe;){var De=d[ie];g>0&&D(De)?g>1?pi(De,g-1,D,B,X):ii(X,De):B||(X[X.length]=De)}return X}var Og=$w(),hw=$w(!0);function io(d,g){return d&&Og(d,g,si)}function Bg(d,g){return d&&hw(d,g,si)}function hp(d,g){return un(g,function(D){return Zo(d[D])})}function Yl(d,g){g=Uu(g,d);for(var D=0,B=g.length;d!=null&&D<B;)d=d[so(g[D++])];return D&&D==B?d:r}function dw(d,g,D){var B=g(d);return dr(d)?B:ii(B,D(d))}function Ui(d){return d==null?d===r?we:ae:Wl&&Wl in Ee(d)?hR(d):SR(d)}function Rg(d,g){return d>g}function IB(d,g){return d!=null&&Je.call(d,g)}function FB(d,g){return d!=null&&g in Ee(d)}function OB(d,g,D){return d>=Ni(g,D)&&d<Vn(g,D)}function Pg(d,g,D){for(var B=D?vs:za,X=d[0].length,ie=d.length,xe=ie,De=J(ie),Re=1/0,nt=[];xe--;){var it=d[xe];xe&&g&&(it=Qr(it,Hn(g))),Re=Ni(it.length,Re),De[xe]=!D&&(g||X>=120&&it.length>=120)?new Xl(xe&&it):r}it=d[0];var lt=-1,Ct=De[0];e:for(;++lt<X&&nt.length<Re;){var Pt=it[lt],Yt=g?g(Pt):Pt;if(Pt=D||Pt!==0?Pt:0,!(Ct?ws(Ct,Yt):B(nt,Yt,D))){for(xe=ie;--xe;){var Ar=De[xe];if(!(Ar?ws(Ar,Yt):B(d[xe],Yt,D)))continue e}Ct&&Ct.push(Yt),nt.push(Pt)}}return nt}function BB(d,g,D,B){return io(d,function(X,ie,xe){g(B,D(X),ie,xe)}),B}function Wh(d,g,D){g=Uu(g,d),d=e_(d,g);var B=d==null?d:d[so(ja(g))];return B==null?r:gn(B,d,D)}function pw(d){return En(d)&&Ui(d)==ke}function RB(d){return En(d)&&Ui(d)==He}function PB(d){return En(d)&&Ui(d)==K}function Vh(d,g,D,B,X){return d===g?!0:d==null||g==null||!En(d)&&!En(g)?d!==d&&g!==g:$B(d,g,D,B,Vh,X)}function $B(d,g,D,B,X,ie){var xe=dr(d),De=dr(g),Re=xe?Me:Mi(d),nt=De?Me:Mi(g);Re=Re==ke?ce:Re,nt=nt==ke?ce:nt;var it=Re==ce,lt=nt==ce,Ct=Re==nt;if(Ct&&Gu(d)){if(!Gu(g))return!1;xe=!0,it=!1}if(Ct&&!it)return ie||(ie=new _s),xe||af(d)?Xw(d,g,D,B,X,ie):cR(d,g,Re,D,B,X,ie);if(!(D&m)){var Pt=it&&Je.call(d,"__wrapped__"),Yt=lt&&Je.call(g,"__wrapped__");if(Pt||Yt){var Ar=Pt?d.value():d,Kt=Yt?g.value():g;return ie||(ie=new _s),X(Ar,Kt,D,B,ie)}}return Ct?(ie||(ie=new _s),fR(d,g,D,B,X,ie)):!1}function kB(d){return En(d)&&Mi(d)==Oe}function $g(d,g,D,B){var X=D.length,ie=X,xe=!B;if(d==null)return!ie;for(d=Ee(d);X--;){var De=D[X];if(xe&&De[2]?De[1]!==d[De[0]]:!(De[0]in d))return!1}for(;++X<ie;){De=D[X];var Re=De[0],nt=d[Re],it=De[1];if(xe&&De[2]){if(nt===r&&!(Re in d))return!1}else{var lt=new _s;if(B)var Ct=B(nt,it,Re,d,g,lt);if(!(Ct===r?Vh(it,nt,m|v,B,lt):Ct))return!1}}return!0}function mw(d){if(!yn(d)||xR(d))return!1;var g=Zo(d)?vr:Eu;return g.test(Zl(d))}function LB(d){return En(d)&&Ui(d)==Ve}function UB(d){return En(d)&&Mi(d)==je}function zB(d){return En(d)&&Np(d.length)&&!!Wr[Ui(d)]}function vw(d){return typeof d=="function"?d:d==null?ca:typeof d=="object"?dr(d)?bw(d[0],d[1]):yw(d):k_(d)}function kg(d){if(!Yh(d))return HO(d);var g=[];for(var D in Ee(d))Je.call(d,D)&&D!="constructor"&&g.push(D);return g}function GB(d){if(!yn(d))return ER(d);var g=Yh(d),D=[];for(var B in d)B=="constructor"&&(g||!Je.call(d,B))||D.push(B);return D}function Lg(d,g){return d<g}function gw(d,g){var D=-1,B=ua(d)?J(d.length):[];return ku(d,function(X,ie,xe){B[++D]=g(X,ie,xe)}),B}function yw(d){var g=e0(d);return g.length==1&&g[0][2]?Qw(g[0][0],g[0][1]):function(D){return D===d||$g(D,d,g)}}function bw(d,g){return r0(d)&&Zw(g)?Qw(so(d),g):function(D){var B=h0(D,d);return B===r&&B===g?d0(D,d):Vh(g,B,m|v)}}function dp(d,g,D,B,X){d!==g&&Og(g,function(ie,xe){if(X||(X=new _s),yn(ie))qB(d,g,xe,D,dp,B,X);else{var De=B?B(i0(d,xe),ie,xe+"",d,g,X):r;De===r&&(De=ie),Ig(d,xe,De)}},la)}function qB(d,g,D,B,X,ie,xe){var De=i0(d,D),Re=i0(g,D),nt=xe.get(Re);if(nt){Ig(d,D,nt);return}var it=ie?ie(De,Re,D+"",d,g,xe):r,lt=it===r;if(lt){var Ct=dr(Re),Pt=!Ct&&Gu(Re),Yt=!Ct&&!Pt&&af(Re);it=Re,Ct||Pt||Yt?dr(De)?it=De:Fn(De)?it=oa(De):Pt?(lt=!1,it=Iw(Re,!0)):Yt?(lt=!1,it=Fw(Re,!0)):it=[]:Zh(Re)||Ql(Re)?(it=De,Ql(De)?it=T_(De):(!yn(De)||Zo(De))&&(it=Kw(Re))):lt=!1}lt&&(xe.set(Re,it),X(it,Re,B,ie,xe),xe.delete(Re)),Ig(d,D,it)}function xw(d,g){var D=d.length;if(D)return g+=g<0?D:0,Ko(g,D)?d[g]:r}function ww(d,g,D){g.length?g=Qr(g,function(ie){return dr(ie)?function(xe){return Yl(xe,ie.length===1?ie[0]:ie)}:ie}):g=[ca];var B=-1;g=Qr(g,Hn(Wt()));var X=gw(d,function(ie,xe,De){var Re=Qr(g,function(nt){return nt(ie)});return{criteria:Re,index:++B,value:ie}});return aa(X,function(ie,xe){return rR(ie,xe,D)})}function HB(d,g){return _w(d,g,function(D,B){return d0(d,B)})}function _w(d,g,D){for(var B=-1,X=g.length,ie={};++B<X;){var xe=g[B],De=Yl(d,xe);D(De,xe)&&Xh(ie,Uu(xe,d),De)}return ie}function WB(d){return function(g){return Yl(g,d)}}function Ug(d,g,D,B){var X=B?jc:Ga,ie=-1,xe=g.length,De=d;for(d===g&&(g=oa(g)),D&&(De=Qr(d,Hn(D)));++ie<xe;)for(var Re=0,nt=g[ie],it=D?D(nt):nt;(Re=X(De,it,Re,B))>-1;)De!==d&&Ha.call(De,Re,1),Ha.call(d,Re,1);return d}function Aw(d,g){for(var D=d?g.length:0,B=D-1;D--;){var X=g[D];if(D==B||X!==ie){var ie=X;Ko(X)?Ha.call(d,X,1):Hg(d,X)}}return d}function zg(d,g){return d+sp(nw()*(g-d+1))}function VB(d,g,D,B){for(var X=-1,ie=Vn(ap((g-d)/(D||1)),0),xe=J(ie);ie--;)xe[B?ie:++X]=d,d+=D;return xe}function Gg(d,g){var D="";if(!d||g<1||g>k)return D;do g%2&&(D+=d),g=sp(g/2),g&&(d+=d);while(g);return D}function Sr(d,g){return a0(Jw(d,g,ca),d+"")}function XB(d){return sw(sf(d))}function jB(d,g){var D=sf(d);return Ap(D,jl(g,0,D.length))}function Xh(d,g,D,B){if(!yn(d))return d;g=Uu(g,d);for(var X=-1,ie=g.length,xe=ie-1,De=d;De!=null&&++X<ie;){var Re=so(g[X]),nt=D;if(Re==="__proto__"||Re==="constructor"||Re==="prototype")return d;if(X!=xe){var it=De[Re];nt=B?B(it,Re,De):r,nt===r&&(nt=yn(it)?it:Ko(g[X+1])?[]:{})}qh(De,Re,nt),De=De[Re]}return d}var Ew=op?function(d,g){return op.set(d,g),d}:ca,YB=ip?function(d,g){return ip(d,"toString",{configurable:!0,enumerable:!1,value:m0(g),writable:!0})}:ca;function KB(d){return Ap(sf(d))}function Xa(d,g,D){var B=-1,X=d.length;g<0&&(g=-g>X?0:X+g),D=D>X?X:D,D<0&&(D+=X),X=g>D?0:D-g>>>0,g>>>=0;for(var ie=J(X);++B<X;)ie[B]=d[B+g];return ie}function ZB(d,g){var D;return ku(d,function(B,X,ie){return D=g(B,X,ie),!D}),!!D}function pp(d,g,D){var B=0,X=d==null?B:d.length;if(typeof g=="number"&&g===g&&X<=ue){for(;B<X;){var ie=B+X>>>1,xe=d[ie];xe!==null&&!wa(xe)&&(D?xe<=g:xe<g)?B=ie+1:X=ie}return X}return qg(d,g,ca,D)}function qg(d,g,D,B){var X=0,ie=d==null?0:d.length;if(ie===0)return 0;g=D(g);for(var xe=g!==g,De=g===null,Re=wa(g),nt=g===r;X<ie;){var it=sp((X+ie)/2),lt=D(d[it]),Ct=lt!==r,Pt=lt===null,Yt=lt===lt,Ar=wa(lt);if(xe)var Kt=B||Yt;else nt?Kt=Yt&&(B||Ct):De?Kt=Yt&&Ct&&(B||!Pt):Re?Kt=Yt&&Ct&&!Pt&&(B||!Ar):Pt||Ar?Kt=!1:Kt=B?lt<=g:lt<g;Kt?X=it+1:ie=it}return Ni(ie,fe)}function Sw(d,g){for(var D=-1,B=d.length,X=0,ie=[];++D<B;){var xe=d[D],De=g?g(xe):xe;if(!D||!As(De,Re)){var Re=De;ie[X++]=xe===0?0:xe}}return ie}function Dw(d){return typeof d=="number"?d:wa(d)?z:+d}function xa(d){if(typeof d=="string")return d;if(dr(d))return Qr(d,xa)+"";if(wa(d))return iw?iw.call(d):"";var g=d+"";return g=="0"&&1/d==-j?"-0":g}function Lu(d,g,D){var B=-1,X=za,ie=d.length,xe=!0,De=[],Re=De;if(D)xe=!1,X=vs;else if(ie>=i){var nt=g?null:uR(d);if(nt)return Gr(nt);xe=!1,X=ws,Re=new Xl}else Re=g?[]:De;e:for(;++B<ie;){var it=d[B],lt=g?g(it):it;if(it=D||it!==0?it:0,xe&&lt===lt){for(var Ct=Re.length;Ct--;)if(Re[Ct]===lt)continue e;g&&Re.push(lt),De.push(it)}else X(Re,lt,D)||(Re!==De&&Re.push(lt),De.push(it))}return De}function Hg(d,g){return g=Uu(g,d),d=e_(d,g),d==null||delete d[so(ja(g))]}function Cw(d,g,D,B){return Xh(d,g,D(Yl(d,g)),B)}function mp(d,g,D,B){for(var X=d.length,ie=B?X:-1;(B?ie--:++ie<X)&&g(d[ie],ie,d););return D?Xa(d,B?0:ie,B?ie+1:X):Xa(d,B?ie+1:0,B?X:ie)}function Tw(d,g){var D=d;return D instanceof Fr&&(D=D.value()),Iu(g,function(B,X){return X.func.apply(X.thisArg,ii([B],X.args))},D)}function Wg(d,g,D){var B=d.length;if(B<2)return B?Lu(d[0]):[];for(var X=-1,ie=J(B);++X<B;)for(var xe=d[X],De=-1;++De<B;)De!=X&&(ie[X]=Hh(ie[X]||xe,d[De],g,D));return Lu(pi(ie,1),g,D)}function Nw(d,g,D){for(var B=-1,X=d.length,ie=g.length,xe={};++B<X;){var De=B<ie?g[B]:r;D(xe,d[B],De)}return xe}function Vg(d){return Fn(d)?d:[]}function Xg(d){return typeof d=="function"?d:ca}function Uu(d,g){return dr(d)?d:r0(d,g)?[d]:i_(Yr(d))}var QB=Sr;function zu(d,g,D){var B=d.length;return D=D===r?B:D,!g&&D>=B?d:Xa(d,g,D)}var Mw=LO||function(d){return hn.clearTimeout(d)};function Iw(d,g){if(g)return d.slice();var D=d.length,B=Wn?Wn(D):new d.constructor(D);return d.copy(B),B}function jg(d){var g=new d.constructor(d.byteLength);return new Jt(g).set(new Jt(d)),g}function JB(d,g){var D=g?jg(d.buffer):d.buffer;return new d.constructor(D,d.byteOffset,d.byteLength)}function eR(d){var g=new d.constructor(d.source,ta.exec(d));return g.lastIndex=d.lastIndex,g}function tR(d){return Gh?Ee(Gh.call(d)):{}}function Fw(d,g){var D=g?jg(d.buffer):d.buffer;return new d.constructor(D,d.byteOffset,d.length)}function Ow(d,g){if(d!==g){var D=d!==r,B=d===null,X=d===d,ie=wa(d),xe=g!==r,De=g===null,Re=g===g,nt=wa(g);if(!De&&!nt&&!ie&&d>g||ie&&xe&&Re&&!De&&!nt||B&&xe&&Re||!D&&Re||!X)return 1;if(!B&&!ie&&!nt&&d<g||nt&&D&&X&&!B&&!ie||De&&D&&X||!xe&&X||!Re)return-1}return 0}function rR(d,g,D){for(var B=-1,X=d.criteria,ie=g.criteria,xe=X.length,De=D.length;++B<xe;){var Re=Ow(X[B],ie[B]);if(Re){if(B>=De)return Re;var nt=D[B];return Re*(nt=="desc"?-1:1)}}return d.index-g.index}function Bw(d,g,D,B){for(var X=-1,ie=d.length,xe=D.length,De=-1,Re=g.length,nt=Vn(ie-xe,0),it=J(Re+nt),lt=!B;++De<Re;)it[De]=g[De];for(;++X<xe;)(lt||X<ie)&&(it[D[X]]=d[X]);for(;nt--;)it[De++]=d[X++];return it}function Rw(d,g,D,B){for(var X=-1,ie=d.length,xe=-1,De=D.length,Re=-1,nt=g.length,it=Vn(ie-De,0),lt=J(it+nt),Ct=!B;++X<it;)lt[X]=d[X];for(var Pt=X;++Re<nt;)lt[Pt+Re]=g[Re];for(;++xe<De;)(Ct||X<ie)&&(lt[Pt+D[xe]]=d[X++]);return lt}function oa(d,g){var D=-1,B=d.length;for(g||(g=J(B));++D<B;)g[D]=d[D];return g}function ao(d,g,D,B){var X=!D;D||(D={});for(var ie=-1,xe=g.length;++ie<xe;){var De=g[ie],Re=B?B(D[De],d[De],De,D,d):r;Re===r&&(Re=d[De]),X?Xo(D,De,Re):qh(D,De,Re)}return D}function nR(d,g){return ao(d,t0(d),g)}function iR(d,g){return ao(d,jw(d),g)}function vp(d,g){return function(D,B){var X=dr(D)?ct:DB,ie=g?g():{};return X(D,d,Wt(B,2),ie)}}function tf(d){return Sr(function(g,D){var B=-1,X=D.length,ie=X>1?D[X-1]:r,xe=X>2?D[2]:r;for(ie=d.length>3&&typeof ie=="function"?(X--,ie):r,xe&&zi(D[0],D[1],xe)&&(ie=X<3?r:ie,X=1),g=Ee(g);++B<X;){var De=D[B];De&&d(g,De,B,ie)}return g})}function Pw(d,g){return function(D,B){if(D==null)return D;if(!ua(D))return d(D,B);for(var X=D.length,ie=g?X:-1,xe=Ee(D);(g?ie--:++ie<X)&&B(xe[ie],ie,xe)!==!1;);return D}}function $w(d){return function(g,D,B){for(var X=-1,ie=Ee(g),xe=B(g),De=xe.length;De--;){var Re=xe[d?De:++X];if(D(ie[Re],Re,ie)===!1)break}return g}}function aR(d,g,D){var B=g&y,X=jh(d);function ie(){var xe=this&&this!==hn&&this instanceof ie?X:d;return xe.apply(B?D:this,arguments)}return ie}function kw(d){return function(g){g=Yr(g);var D=ve(g)?sa(g):r,B=D?D[0]:g.charAt(0),X=D?zu(D,1).join(""):g.slice(1);return B[d]()+X}}function rf(d){return function(g){return Iu(P_(R_(g).replace(Po,"")),d,"")}}function jh(d){return function(){var g=arguments;switch(g.length){case 0:return new d;case 1:return new d(g[0]);case 2:return new d(g[0],g[1]);case 3:return new d(g[0],g[1],g[2]);case 4:return new d(g[0],g[1],g[2],g[3]);case 5:return new d(g[0],g[1],g[2],g[3],g[4]);case 6:return new d(g[0],g[1],g[2],g[3],g[4],g[5]);case 7:return new d(g[0],g[1],g[2],g[3],g[4],g[5],g[6])}var D=ef(d.prototype),B=d.apply(D,g);return yn(B)?B:D}}function sR(d,g,D){var B=jh(d);function X(){for(var ie=arguments.length,xe=J(ie),De=ie,Re=nf(X);De--;)xe[De]=arguments[De];var nt=ie<3&&xe[0]!==Re&&xe[ie-1]!==Re?[]:mr(xe,Re);if(ie-=nt.length,ie<D)return qw(d,g,gp,X.placeholder,r,xe,nt,r,r,D-ie);var it=this&&this!==hn&&this instanceof X?B:d;return gn(it,this,xe)}return X}function Lw(d){return function(g,D,B){var X=Ee(g);if(!ua(g)){var ie=Wt(D,3);g=si(g),D=function(De){return ie(X[De],De,X)}}var xe=d(g,D,B);return xe>-1?X[ie?g[xe]:xe]:r}}function Uw(d){return Yo(function(g){var D=g.length,B=D,X=Wa.prototype.thru;for(d&&g.reverse();B--;){var ie=g[B];if(typeof ie!="function")throw new Pe(s);if(X&&!xe&&wp(ie)=="wrapper")var xe=new Wa([],!0)}for(B=xe?B:D;++B<D;){ie=g[B];var De=wp(ie),Re=De=="wrapper"?Jg(ie):r;Re&&n0(Re[0])&&Re[1]==(T|b|E|M)&&!Re[4].length&&Re[9]==1?xe=xe[wp(Re[0])].apply(xe,Re[3]):xe=ie.length==1&&n0(ie)?xe[De]():xe.thru(ie)}return function(){var nt=arguments,it=nt[0];if(xe&&nt.length==1&&dr(it))return xe.plant(it).value();for(var lt=0,Ct=D?g[lt].apply(this,nt):it;++lt<D;)Ct=g[lt].call(this,Ct);return Ct}})}function gp(d,g,D,B,X,ie,xe,De,Re,nt){var it=g&T,lt=g&y,Ct=g&x,Pt=g&(b|A),Yt=g&N,Ar=Ct?r:jh(d);function Kt(){for(var Nr=arguments.length,Pr=J(Nr),_a=Nr;_a--;)Pr[_a]=arguments[_a];if(Pt)var Gi=nf(Kt),Aa=ql(Pr,Gi);if(B&&(Pr=Bw(Pr,B,X,Pt)),ie&&(Pr=Rw(Pr,ie,xe,Pt)),Nr-=Aa,Pt&&Nr<nt){var On=mr(Pr,Gi);return qw(d,g,gp,Kt.placeholder,D,Pr,On,De,Re,nt-Nr)}var Es=lt?D:this,Jo=Ct?Es[d]:d;return Nr=Pr.length,De?Pr=DR(Pr,De):Yt&&Nr>1&&Pr.reverse(),it&&Re<Nr&&(Pr.length=Re),this&&this!==hn&&this instanceof Kt&&(Jo=Ar||jh(Jo)),Jo.apply(Es,Pr)}return Kt}function zw(d,g){return function(D,B){return BB(D,d,g(B),{})}}function yp(d,g){return function(D,B){var X;if(D===r&&B===r)return g;if(D!==r&&(X=D),B!==r){if(X===r)return B;typeof D=="string"||typeof B=="string"?(D=xa(D),B=xa(B)):(D=Dw(D),B=Dw(B)),X=d(D,B)}return X}}function Yg(d){return Yo(function(g){return g=Qr(g,Hn(Wt())),Sr(function(D){var B=this;return d(g,function(X){return gn(X,B,D)})})})}function bp(d,g){g=g===r?" ":xa(g);var D=g.length;if(D<2)return D?Gg(g,d):g;var B=Gg(g,ap(d/Li(g)));return ve(g)?zu(sa(B),0,d).join(""):B.slice(0,d)}function oR(d,g,D,B){var X=g&y,ie=jh(d);function xe(){for(var De=-1,Re=arguments.length,nt=-1,it=B.length,lt=J(it+Re),Ct=this&&this!==hn&&this instanceof xe?ie:d;++nt<it;)lt[nt]=B[nt];for(;Re--;)lt[nt++]=arguments[++De];return gn(Ct,X?D:this,lt)}return xe}function Gw(d){return function(g,D,B){return B&&typeof B!="number"&&zi(g,D,B)&&(D=B=r),g=Qo(g),D===r?(D=g,g=0):D=Qo(D),B=B===r?g<D?1:-1:Qo(B),VB(g,D,B,d)}}function xp(d){return function(g,D){return typeof g=="string"&&typeof D=="string"||(g=Ya(g),D=Ya(D)),d(g,D)}}function qw(d,g,D,B,X,ie,xe,De,Re,nt){var it=g&b,lt=it?xe:r,Ct=it?r:xe,Pt=it?ie:r,Yt=it?r:ie;g|=it?E:_,g&=~(it?_:E),g&S||(g&=~(y|x));var Ar=[d,g,X,Pt,lt,Yt,Ct,De,Re,nt],Kt=D.apply(r,Ar);return n0(d)&&t_(Kt,Ar),Kt.placeholder=B,r_(Kt,d,g)}function Kg(d){var g=Ae[d];return function(D,B){if(D=Ya(D),B=B==null?0:Ni(wr(B),292),B&&rw(D)){var X=(Yr(D)+"e").split("e"),ie=g(X[0]+"e"+(+X[1]+B));return X=(Yr(ie)+"e").split("e"),+(X[0]+"e"+(+X[1]-B))}return g(D)}}var uR=Qc&&1/Gr(new Qc([,-0]))[1]==j?function(d){return new Qc(d)}:y0;function Hw(d){return function(g){var D=Mi(g);return D==Oe?tt(g):D==je?Mn(g):xs(g,d(g))}}function jo(d,g,D,B,X,ie,xe,De){var Re=g&x;if(!Re&&typeof d!="function")throw new Pe(s);var nt=B?B.length:0;if(nt||(g&=~(E|_),B=X=r),xe=xe===r?xe:Vn(wr(xe),0),De=De===r?De:wr(De),nt-=X?X.length:0,g&_){var it=B,lt=X;B=X=r}var Ct=Re?r:Jg(d),Pt=[d,g,D,B,X,it,lt,ie,xe,De];if(Ct&&AR(Pt,Ct),d=Pt[0],g=Pt[1],D=Pt[2],B=Pt[3],X=Pt[4],De=Pt[9]=Pt[9]===r?Re?0:d.length:Vn(Pt[9]-nt,0),!De&&g&(b|A)&&(g&=~(b|A)),!g||g==y)var Yt=aR(d,g,D);else g==b||g==A?Yt=sR(d,g,De):(g==E||g==(y|E))&&!X.length?Yt=oR(d,g,D,B):Yt=gp.apply(r,Pt);var Ar=Ct?Ew:t_;return r_(Ar(Yt,Pt),d,g)}function Ww(d,g,D,B){return d===r||As(d,et[D])&&!Je.call(B,D)?g:d}function Vw(d,g,D,B,X,ie){return yn(d)&&yn(g)&&(ie.set(g,d),dp(d,g,r,Vw,ie),ie.delete(g)),d}function lR(d){return Zh(d)?r:d}function Xw(d,g,D,B,X,ie){var xe=D&m,De=d.length,Re=g.length;if(De!=Re&&!(xe&&Re>De))return!1;var nt=ie.get(d),it=ie.get(g);if(nt&&it)return nt==g&&it==d;var lt=-1,Ct=!0,Pt=D&v?new Xl:r;for(ie.set(d,g),ie.set(g,d);++lt<De;){var Yt=d[lt],Ar=g[lt];if(B)var Kt=xe?B(Ar,Yt,lt,g,d,ie):B(Yt,Ar,lt,d,g,ie);if(Kt!==r){if(Kt)continue;Ct=!1;break}if(Pt){if(!ro(g,function(Nr,Pr){if(!ws(Pt,Pr)&&(Yt===Nr||X(Yt,Nr,D,B,ie)))return Pt.push(Pr)})){Ct=!1;break}}else if(!(Yt===Ar||X(Yt,Ar,D,B,ie))){Ct=!1;break}}return ie.delete(d),ie.delete(g),Ct}function cR(d,g,D,B,X,ie,xe){switch(D){case We:if(d.byteLength!=g.byteLength||d.byteOffset!=g.byteOffset)return!1;d=d.buffer,g=g.buffer;case He:return!(d.byteLength!=g.byteLength||!ie(new Jt(d),new Jt(g)));case oe:case K:case Qe:return As(+d,+g);case _e:return d.name==g.name&&d.message==g.message;case Ve:case ht:return d==g+"";case Oe:var De=tt;case je:var Re=B&m;if(De||(De=Gr),d.size!=g.size&&!Re)return!1;var nt=xe.get(d);if(nt)return nt==g;B|=v,xe.set(d,g);var it=Xw(De(d),De(g),B,X,ie,xe);return xe.delete(d),it;case re:if(Gh)return Gh.call(d)==Gh.call(g)}return!1}function fR(d,g,D,B,X,ie){var xe=D&m,De=Zg(d),Re=De.length,nt=Zg(g),it=nt.length;if(Re!=it&&!xe)return!1;for(var lt=Re;lt--;){var Ct=De[lt];if(!(xe?Ct in g:Je.call(g,Ct)))return!1}var Pt=ie.get(d),Yt=ie.get(g);if(Pt&&Yt)return Pt==g&&Yt==d;var Ar=!0;ie.set(d,g),ie.set(g,d);for(var Kt=xe;++lt<Re;){Ct=De[lt];var Nr=d[Ct],Pr=g[Ct];if(B)var _a=xe?B(Pr,Nr,Ct,g,d,ie):B(Nr,Pr,Ct,d,g,ie);if(!(_a===r?Nr===Pr||X(Nr,Pr,D,B,ie):_a)){Ar=!1;break}Kt||(Kt=Ct=="constructor")}if(Ar&&!Kt){var Gi=d.constructor,Aa=g.constructor;Gi!=Aa&&"constructor"in d&&"constructor"in g&&!(typeof Gi=="function"&&Gi instanceof Gi&&typeof Aa=="function"&&Aa instanceof Aa)&&(Ar=!1)}return ie.delete(d),ie.delete(g),Ar}function Yo(d){return a0(Jw(d,r,u_),d+"")}function Zg(d){return dw(d,si,t0)}function Qg(d){return dw(d,la,jw)}var Jg=op?function(d){return op.get(d)}:y0;function wp(d){for(var g=d.name+"",D=Jc[g],B=Je.call(Jc,g)?D.length:0;B--;){var X=D[B],ie=X.func;if(ie==null||ie==d)return X.name}return g}function nf(d){var g=Je.call(Q,"placeholder")?Q:d;return g.placeholder}function Wt(){var d=Q.iteratee||v0;return d=d===v0?vw:d,arguments.length?d(arguments[0],arguments[1]):d}function _p(d,g){var D=d.__data__;return bR(g)?D[typeof g=="string"?"string":"hash"]:D.map}function e0(d){for(var g=si(d),D=g.length;D--;){var B=g[D],X=d[B];g[D]=[B,X,Zw(X)]}return g}function Kl(d,g){var D=H(d,g);return mw(D)?D:r}function hR(d){var g=Je.call(d,Wl),D=d[Wl];try{d[Wl]=r;var B=!0}catch{}var X=yt.call(d);return B&&(g?d[Wl]=D:delete d[Wl]),X}var t0=Tg?function(d){return d==null?[]:(d=Ee(d),un(Tg(d),function(g){return ai.call(d,g)}))}:b0,jw=Tg?function(d){for(var g=[];d;)ii(g,t0(d)),d=In(d);return g}:b0,Mi=Ui;(Ng&&Mi(new Ng(new ArrayBuffer(1)))!=We||Lh&&Mi(new Lh)!=Oe||Mg&&Mi(Mg.resolve())!=Ce||Qc&&Mi(new Qc)!=je||Uh&&Mi(new Uh)!=Ne)&&(Mi=function(d){var g=Ui(d),D=g==ce?d.constructor:r,B=D?Zl(D):"";if(B)switch(B){case jO:return We;case YO:return Oe;case KO:return Ce;case ZO:return je;case QO:return Ne}return g});function dR(d,g,D){for(var B=-1,X=D.length;++B<X;){var ie=D[B],xe=ie.size;switch(ie.type){case"drop":d+=xe;break;case"dropRight":g-=xe;break;case"take":g=Ni(g,d+xe);break;case"takeRight":d=Vn(d,g-xe);break}}return{start:d,end:g}}function pR(d){var g=d.match(Ks);return g?g[1].split(Zs):[]}function Yw(d,g,D){g=Uu(g,d);for(var B=-1,X=g.length,ie=!1;++B<X;){var xe=so(g[B]);if(!(ie=d!=null&&D(d,xe)))break;d=d[xe]}return ie||++B!=X?ie:(X=d==null?0:d.length,!!X&&Np(X)&&Ko(xe,X)&&(dr(d)||Ql(d)))}function mR(d){var g=d.length,D=new d.constructor(g);return g&&typeof d[0]=="string"&&Je.call(d,"index")&&(D.index=d.index,D.input=d.input),D}function Kw(d){return typeof d.constructor=="function"&&!Yh(d)?ef(In(d)):{}}function vR(d,g,D){var B=d.constructor;switch(g){case He:return jg(d);case oe:case K:return new B(+d);case We:return JB(d,D);case ft:case st:case dt:case at:case tr:case Ot:case fr:case R:case ge:return Fw(d,D);case Oe:return new B;case Qe:case ht:return new B(d);case Ve:return eR(d);case je:return new B;case re:return tR(d)}}function gR(d,g){var D=g.length;if(!D)return d;var B=D-1;return g[B]=(D>1?"& ":"")+g[B],g=g.join(D>2?", ":" "),d.replace(Ys,`{
/* [wrapped with `+g+`] */
`)}function yR(d){return dr(d)||Ql(d)||!!(Zc&&d&&d[Zc])}function Ko(d,g){var D=typeof d;return g=g??k,!!g&&(D=="number"||D!="symbol"&&Su.test(d))&&d>-1&&d%1==0&&d<g}function zi(d,g,D){if(!yn(D))return!1;var B=typeof g;return(B=="number"?ua(D)&&Ko(g,D.length):B=="string"&&g in D)?As(D[g],d):!1}function r0(d,g){if(dr(d))return!1;var D=typeof d;return D=="number"||D=="symbol"||D=="boolean"||d==null||wa(d)?!0:Fa.test(d)||!Ia.test(d)||g!=null&&d in Ee(g)}function bR(d){var g=typeof d;return g=="string"||g=="number"||g=="symbol"||g=="boolean"?d!=="__proto__":d===null}function n0(d){var g=wp(d),D=Q[g];if(typeof D!="function"||!(g in Fr.prototype))return!1;if(d===D)return!0;var B=Jg(D);return!!B&&d===B[0]}function xR(d){return!!_t&&_t in d}var wR=vt?Zo:x0;function Yh(d){var g=d&&d.constructor,D=typeof g=="function"&&g.prototype||et;return d===D}function Zw(d){return d===d&&!yn(d)}function Qw(d,g){return function(D){return D==null?!1:D[d]===g&&(g!==r||d in Ee(D))}}function _R(d){var g=Cp(d,function(B){return D.size===u&&D.clear(),B}),D=g.cache;return g}function AR(d,g){var D=d[1],B=g[1],X=D|B,ie=X<(y|x|T),xe=B==T&&D==b||B==T&&D==M&&d[7].length<=g[8]||B==(T|M)&&g[7].length<=g[8]&&D==b;if(!(ie||xe))return d;B&y&&(d[2]=g[2],X|=D&y?0:S);var De=g[3];if(De){var Re=d[3];d[3]=Re?Bw(Re,De,g[4]):De,d[4]=Re?mr(d[3],c):g[4]}return De=g[5],De&&(Re=d[5],d[5]=Re?Rw(Re,De,g[6]):De,d[6]=Re?mr(d[5],c):g[6]),De=g[7],De&&(d[7]=De),B&T&&(d[8]=d[8]==null?g[8]:Ni(d[8],g[8])),d[9]==null&&(d[9]=g[9]),d[0]=g[0],d[1]=X,d}function ER(d){var g=[];if(d!=null)for(var D in Ee(d))g.push(D);return g}function SR(d){return yt.call(d)}function Jw(d,g,D){return g=Vn(g===r?d.length-1:g,0),function(){for(var B=arguments,X=-1,ie=Vn(B.length-g,0),xe=J(ie);++X<ie;)xe[X]=B[g+X];X=-1;for(var De=J(g+1);++X<g;)De[X]=B[X];return De[g]=D(xe),gn(d,this,De)}}function e_(d,g){return g.length<2?d:Yl(d,Xa(g,0,-1))}function DR(d,g){for(var D=d.length,B=Ni(g.length,D),X=oa(d);B--;){var ie=g[B];d[B]=Ko(ie,D)?X[ie]:r}return d}function i0(d,g){if(!(g==="constructor"&&typeof d[g]=="function")&&g!="__proto__")return d[g]}var t_=n_(Ew),Kh=zO||function(d,g){return hn.setTimeout(d,g)},a0=n_(YB);function r_(d,g,D){var B=g+"";return a0(d,gR(B,CR(pR(B),D)))}function n_(d){var g=0,D=0;return function(){var B=WO(),X=U-(B-D);if(D=B,X>0){if(++g>=P)return arguments[0]}else g=0;return d.apply(r,arguments)}}function Ap(d,g){var D=-1,B=d.length,X=B-1;for(g=g===r?B:g;++D<g;){var ie=zg(D,X),xe=d[ie];d[ie]=d[D],d[D]=xe}return d.length=g,d}var i_=_R(function(d){var g=[];return d.charCodeAt(0)===46&&g.push(""),d.replace(No,function(D,B,X,ie){g.push(X?ie.replace(Ba,"$1"):B||D)}),g});function so(d){if(typeof d=="string"||wa(d))return d;var g=d+"";return g=="0"&&1/d==-j?"-0":g}function Zl(d){if(d!=null){try{return xt.call(d)}catch{}try{return d+""}catch{}}return""}function CR(d,g){return ni(le,function(D){var B="_."+D[0];g&D[1]&&!za(d,B)&&d.push(B)}),d.sort()}function a_(d){if(d instanceof Fr)return d.clone();var g=new Wa(d.__wrapped__,d.__chain__);return g.__actions__=oa(d.__actions__),g.__index__=d.__index__,g.__values__=d.__values__,g}function TR(d,g,D){(D?zi(d,g,D):g===r)?g=1:g=Vn(wr(g),0);var B=d==null?0:d.length;if(!B||g<1)return[];for(var X=0,ie=0,xe=J(ap(B/g));X<B;)xe[ie++]=Xa(d,X,X+=g);return xe}function NR(d){for(var g=-1,D=d==null?0:d.length,B=0,X=[];++g<D;){var ie=d[g];ie&&(X[B++]=ie)}return X}function MR(){var d=arguments.length;if(!d)return[];for(var g=J(d-1),D=arguments[0],B=d;B--;)g[B-1]=arguments[B];return ii(dr(D)?oa(D):[D],pi(g,1))}var IR=Sr(function(d,g){return Fn(d)?Hh(d,pi(g,1,Fn,!0)):[]}),FR=Sr(function(d,g){var D=ja(g);return Fn(D)&&(D=r),Fn(d)?Hh(d,pi(g,1,Fn,!0),Wt(D,2)):[]}),OR=Sr(function(d,g){var D=ja(g);return Fn(D)&&(D=r),Fn(d)?Hh(d,pi(g,1,Fn,!0),r,D):[]});function BR(d,g,D){var B=d==null?0:d.length;return B?(g=D||g===r?1:wr(g),Xa(d,g<0?0:g,B)):[]}function RR(d,g,D){var B=d==null?0:d.length;return B?(g=D||g===r?1:wr(g),g=B-g,Xa(d,0,g<0?0:g)):[]}function PR(d,g){return d&&d.length?mp(d,Wt(g,3),!0,!0):[]}function $R(d,g){return d&&d.length?mp(d,Wt(g,3),!0):[]}function kR(d,g,D,B){var X=d==null?0:d.length;return X?(D&&typeof D!="number"&&zi(d,g,D)&&(D=0,B=X),MB(d,g,D,B)):[]}function s_(d,g,D){var B=d==null?0:d.length;if(!B)return-1;var X=D==null?0:wr(D);return X<0&&(X=Vn(B+X,0)),ys(d,Wt(g,3),X)}function o_(d,g,D){var B=d==null?0:d.length;if(!B)return-1;var X=B-1;return D!==r&&(X=wr(D),X=D<0?Vn(B+X,0):Ni(X,B-1)),ys(d,Wt(g,3),X,!0)}function u_(d){var g=d==null?0:d.length;return g?pi(d,1):[]}function LR(d){var g=d==null?0:d.length;return g?pi(d,j):[]}function UR(d,g){var D=d==null?0:d.length;return D?(g=g===r?1:wr(g),pi(d,g)):[]}function zR(d){for(var g=-1,D=d==null?0:d.length,B={};++g<D;){var X=d[g];B[X[0]]=X[1]}return B}function l_(d){return d&&d.length?d[0]:r}function GR(d,g,D){var B=d==null?0:d.length;if(!B)return-1;var X=D==null?0:wr(D);return X<0&&(X=Vn(B+X,0)),Ga(d,g,X)}function qR(d){var g=d==null?0:d.length;return g?Xa(d,0,-1):[]}var HR=Sr(function(d){var g=Qr(d,Vg);return g.length&&g[0]===d[0]?Pg(g):[]}),WR=Sr(function(d){var g=ja(d),D=Qr(d,Vg);return g===ja(D)?g=r:D.pop(),D.length&&D[0]===d[0]?Pg(D,Wt(g,2)):[]}),VR=Sr(function(d){var g=ja(d),D=Qr(d,Vg);return g=typeof g=="function"?g:r,g&&D.pop(),D.length&&D[0]===d[0]?Pg(D,r,g):[]});function XR(d,g){return d==null?"":qO.call(d,g)}function ja(d){var g=d==null?0:d.length;return g?d[g-1]:r}function jR(d,g,D){var B=d==null?0:d.length;if(!B)return-1;var X=B;return D!==r&&(X=wr(D),X=X<0?Vn(B+X,0):Ni(X,B-1)),g===g?$u(d,g,X):ys(d,Yc,X,!0)}function YR(d,g){return d&&d.length?xw(d,wr(g)):r}var KR=Sr(c_);function c_(d,g){return d&&d.length&&g&&g.length?Ug(d,g):d}function ZR(d,g,D){return d&&d.length&&g&&g.length?Ug(d,g,Wt(D,2)):d}function QR(d,g,D){return d&&d.length&&g&&g.length?Ug(d,g,r,D):d}var JR=Yo(function(d,g){var D=d==null?0:d.length,B=Fg(d,g);return Aw(d,Qr(g,function(X){return Ko(X,D)?+X:X}).sort(Ow)),B});function eP(d,g){var D=[];if(!(d&&d.length))return D;var B=-1,X=[],ie=d.length;for(g=Wt(g,3);++B<ie;){var xe=d[B];g(xe,B,d)&&(D.push(xe),X.push(B))}return Aw(d,X),D}function s0(d){return d==null?d:XO.call(d)}function tP(d,g,D){var B=d==null?0:d.length;return B?(D&&typeof D!="number"&&zi(d,g,D)?(g=0,D=B):(g=g==null?0:wr(g),D=D===r?B:wr(D)),Xa(d,g,D)):[]}function rP(d,g){return pp(d,g)}function nP(d,g,D){return qg(d,g,Wt(D,2))}function iP(d,g){var D=d==null?0:d.length;if(D){var B=pp(d,g);if(B<D&&As(d[B],g))return B}return-1}function aP(d,g){return pp(d,g,!0)}function sP(d,g,D){return qg(d,g,Wt(D,2),!0)}function oP(d,g){var D=d==null?0:d.length;if(D){var B=pp(d,g,!0)-1;if(As(d[B],g))return B}return-1}function uP(d){return d&&d.length?Sw(d):[]}function lP(d,g){return d&&d.length?Sw(d,Wt(g,2)):[]}function cP(d){var g=d==null?0:d.length;return g?Xa(d,1,g):[]}function fP(d,g,D){return d&&d.length?(g=D||g===r?1:wr(g),Xa(d,0,g<0?0:g)):[]}function hP(d,g,D){var B=d==null?0:d.length;return B?(g=D||g===r?1:wr(g),g=B-g,Xa(d,g<0?0:g,B)):[]}function dP(d,g){return d&&d.length?mp(d,Wt(g,3),!1,!0):[]}function pP(d,g){return d&&d.length?mp(d,Wt(g,3)):[]}var mP=Sr(function(d){return Lu(pi(d,1,Fn,!0))}),vP=Sr(function(d){var g=ja(d);return Fn(g)&&(g=r),Lu(pi(d,1,Fn,!0),Wt(g,2))}),gP=Sr(function(d){var g=ja(d);return g=typeof g=="function"?g:r,Lu(pi(d,1,Fn,!0),r,g)});function yP(d){return d&&d.length?Lu(d):[]}function bP(d,g){return d&&d.length?Lu(d,Wt(g,2)):[]}function xP(d,g){return g=typeof g=="function"?g:r,d&&d.length?Lu(d,r,g):[]}function o0(d){if(!(d&&d.length))return[];var g=0;return d=un(d,function(D){if(Fn(D))return g=Vn(D.length,g),!0}),Bu(g,function(D){return Qr(d,Ti(D))})}function f_(d,g){if(!(d&&d.length))return[];var D=o0(d);return g==null?D:Qr(D,function(B){return gn(g,r,B)})}var wP=Sr(function(d,g){return Fn(d)?Hh(d,g):[]}),_P=Sr(function(d){return Wg(un(d,Fn))}),AP=Sr(function(d){var g=ja(d);return Fn(g)&&(g=r),Wg(un(d,Fn),Wt(g,2))}),EP=Sr(function(d){var g=ja(d);return g=typeof g=="function"?g:r,Wg(un(d,Fn),r,g)}),SP=Sr(o0);function DP(d,g){return Nw(d||[],g||[],qh)}function CP(d,g){return Nw(d||[],g||[],Xh)}var TP=Sr(function(d){var g=d.length,D=g>1?d[g-1]:r;return D=typeof D=="function"?(d.pop(),D):r,f_(d,D)});function h_(d){var g=Q(d);return g.__chain__=!0,g}function NP(d,g){return g(d),d}function Ep(d,g){return g(d)}var MP=Yo(function(d){var g=d.length,D=g?d[0]:0,B=this.__wrapped__,X=function(ie){return Fg(ie,d)};return g>1||this.__actions__.length||!(B instanceof Fr)||!Ko(D)?this.thru(X):(B=B.slice(D,+D+(g?1:0)),B.__actions__.push({func:Ep,args:[X],thisArg:r}),new Wa(B,this.__chain__).thru(function(ie){return g&&!ie.length&&ie.push(r),ie}))});function IP(){return h_(this)}function FP(){return new Wa(this.value(),this.__chain__)}function OP(){this.__values__===r&&(this.__values__=D_(this.value()));var d=this.__index__>=this.__values__.length,g=d?r:this.__values__[this.__index__++];return{done:d,value:g}}function BP(){return this}function RP(d){for(var g,D=this;D instanceof lp;){var B=a_(D);B.__index__=0,B.__values__=r,g?X.__wrapped__=B:g=B;var X=B;D=D.__wrapped__}return X.__wrapped__=d,g}function PP(){var d=this.__wrapped__;if(d instanceof Fr){var g=d;return this.__actions__.length&&(g=new Fr(this)),g=g.reverse(),g.__actions__.push({func:Ep,args:[s0],thisArg:r}),new Wa(g,this.__chain__)}return this.thru(s0)}function $P(){return Tw(this.__wrapped__,this.__actions__)}var kP=vp(function(d,g,D){Je.call(d,D)?++d[D]:Xo(d,D,1)});function LP(d,g,D){var B=dr(d)?Mu:NB;return D&&zi(d,g,D)&&(g=r),B(d,Wt(g,3))}function UP(d,g){var D=dr(d)?un:fw;return D(d,Wt(g,3))}var zP=Lw(s_),GP=Lw(o_);function qP(d,g){return pi(Sp(d,g),1)}function HP(d,g){return pi(Sp(d,g),j)}function WP(d,g,D){return D=D===r?1:wr(D),pi(Sp(d,g),D)}function d_(d,g){var D=dr(d)?ni:ku;return D(d,Wt(g,3))}function p_(d,g){var D=dr(d)?Nu:cw;return D(d,Wt(g,3))}var VP=vp(function(d,g,D){Je.call(d,D)?d[D].push(g):Xo(d,D,[g])});function XP(d,g,D,B){d=ua(d)?d:sf(d),D=D&&!B?wr(D):0;var X=d.length;return D<0&&(D=Vn(X+D,0)),Mp(d)?D<=X&&d.indexOf(g,D)>-1:!!X&&Ga(d,g,D)>-1}var jP=Sr(function(d,g,D){var B=-1,X=typeof g=="function",ie=ua(d)?J(d.length):[];return ku(d,function(xe){ie[++B]=X?gn(g,xe,D):Wh(xe,g,D)}),ie}),YP=vp(function(d,g,D){Xo(d,D,g)});function Sp(d,g){var D=dr(d)?Qr:gw;return D(d,Wt(g,3))}function KP(d,g,D,B){return d==null?[]:(dr(g)||(g=g==null?[]:[g]),D=B?r:D,dr(D)||(D=D==null?[]:[D]),ww(d,g,D))}var ZP=vp(function(d,g,D){d[D?0:1].push(g)},function(){return[[],[]]});function QP(d,g,D){var B=dr(d)?Iu:bs,X=arguments.length<3;return B(d,Wt(g,4),D,X,ku)}function JP(d,g,D){var B=dr(d)?Xc:bs,X=arguments.length<3;return B(d,Wt(g,4),D,X,cw)}function e4(d,g){var D=dr(d)?un:fw;return D(d,Tp(Wt(g,3)))}function t4(d){var g=dr(d)?sw:XB;return g(d)}function r4(d,g,D){(D?zi(d,g,D):g===r)?g=1:g=wr(g);var B=dr(d)?EB:jB;return B(d,g)}function n4(d){var g=dr(d)?SB:KB;return g(d)}function i4(d){if(d==null)return 0;if(ua(d))return Mp(d)?Li(d):d.length;var g=Mi(d);return g==Oe||g==je?d.size:kg(d).length}function a4(d,g,D){var B=dr(d)?ro:ZB;return D&&zi(d,g,D)&&(g=r),B(d,Wt(g,3))}var s4=Sr(function(d,g){if(d==null)return[];var D=g.length;return D>1&&zi(d,g[0],g[1])?g=[]:D>2&&zi(g[0],g[1],g[2])&&(g=[g[0]]),ww(d,pi(g,1),[])}),Dp=UO||function(){return hn.Date.now()};function o4(d,g){if(typeof g!="function")throw new Pe(s);return d=wr(d),function(){if(--d<1)return g.apply(this,arguments)}}function m_(d,g,D){return g=D?r:g,g=d&&g==null?d.length:g,jo(d,T,r,r,r,r,g)}function v_(d,g){var D;if(typeof g!="function")throw new Pe(s);return d=wr(d),function(){return--d>0&&(D=g.apply(this,arguments)),d<=1&&(g=r),D}}var u0=Sr(function(d,g,D){var B=y;if(D.length){var X=mr(D,nf(u0));B|=E}return jo(d,B,g,D,X)}),g_=Sr(function(d,g,D){var B=y|x;if(D.length){var X=mr(D,nf(g_));B|=E}return jo(g,B,d,D,X)});function y_(d,g,D){g=D?r:g;var B=jo(d,b,r,r,r,r,r,g);return B.placeholder=y_.placeholder,B}function b_(d,g,D){g=D?r:g;var B=jo(d,A,r,r,r,r,r,g);return B.placeholder=b_.placeholder,B}function x_(d,g,D){var B,X,ie,xe,De,Re,nt=0,it=!1,lt=!1,Ct=!0;if(typeof d!="function")throw new Pe(s);g=Ya(g)||0,yn(D)&&(it=!!D.leading,lt="maxWait"in D,ie=lt?Vn(Ya(D.maxWait)||0,g):ie,Ct="trailing"in D?!!D.trailing:Ct);function Pt(On){var Es=B,Jo=X;return B=X=r,nt=On,xe=d.apply(Jo,Es),xe}function Yt(On){return nt=On,De=Kh(Nr,g),it?Pt(On):xe}function Ar(On){var Es=On-Re,Jo=On-nt,L_=g-Es;return lt?Ni(L_,ie-Jo):L_}function Kt(On){var Es=On-Re,Jo=On-nt;return Re===r||Es>=g||Es<0||lt&&Jo>=ie}function Nr(){var On=Dp();if(Kt(On))return Pr(On);De=Kh(Nr,Ar(On))}function Pr(On){return De=r,Ct&&B?Pt(On):(B=X=r,xe)}function _a(){De!==r&&Mw(De),nt=0,B=Re=X=De=r}function Gi(){return De===r?xe:Pr(Dp())}function Aa(){var On=Dp(),Es=Kt(On);if(B=arguments,X=this,Re=On,Es){if(De===r)return Yt(Re);if(lt)return Mw(De),De=Kh(Nr,g),Pt(Re)}return De===r&&(De=Kh(Nr,g)),xe}return Aa.cancel=_a,Aa.flush=Gi,Aa}var u4=Sr(function(d,g){return lw(d,1,g)}),l4=Sr(function(d,g,D){return lw(d,Ya(g)||0,D)});function c4(d){return jo(d,N)}function Cp(d,g){if(typeof d!="function"||g!=null&&typeof g!="function")throw new Pe(s);var D=function(){var B=arguments,X=g?g.apply(this,B):B[0],ie=D.cache;if(ie.has(X))return ie.get(X);var xe=d.apply(this,B);return D.cache=ie.set(X,xe)||ie,xe};return D.cache=new(Cp.Cache||Vo),D}Cp.Cache=Vo;function Tp(d){if(typeof d!="function")throw new Pe(s);return function(){var g=arguments;switch(g.length){case 0:return!d.call(this);case 1:return!d.call(this,g[0]);case 2:return!d.call(this,g[0],g[1]);case 3:return!d.call(this,g[0],g[1],g[2])}return!d.apply(this,g)}}function f4(d){return v_(2,d)}var h4=QB(function(d,g){g=g.length==1&&dr(g[0])?Qr(g[0],Hn(Wt())):Qr(pi(g,1),Hn(Wt()));var D=g.length;return Sr(function(B){for(var X=-1,ie=Ni(B.length,D);++X<ie;)B[X]=g[X].call(this,B[X]);return gn(d,this,B)})}),l0=Sr(function(d,g){var D=mr(g,nf(l0));return jo(d,E,r,g,D)}),w_=Sr(function(d,g){var D=mr(g,nf(w_));return jo(d,_,r,g,D)}),d4=Yo(function(d,g){return jo(d,M,r,r,r,g)});function p4(d,g){if(typeof d!="function")throw new Pe(s);return g=g===r?g:wr(g),Sr(d,g)}function m4(d,g){if(typeof d!="function")throw new Pe(s);return g=g==null?0:Vn(wr(g),0),Sr(function(D){var B=D[g],X=zu(D,0,g);return B&&ii(X,B),gn(d,this,X)})}function v4(d,g,D){var B=!0,X=!0;if(typeof d!="function")throw new Pe(s);return yn(D)&&(B="leading"in D?!!D.leading:B,X="trailing"in D?!!D.trailing:X),x_(d,g,{leading:B,maxWait:g,trailing:X})}function g4(d){return m_(d,1)}function y4(d,g){return l0(Xg(g),d)}function b4(){if(!arguments.length)return[];var d=arguments[0];return dr(d)?d:[d]}function x4(d){return Va(d,p)}function w4(d,g){return g=typeof g=="function"?g:r,Va(d,p,g)}function _4(d){return Va(d,f|p)}function A4(d,g){return g=typeof g=="function"?g:r,Va(d,f|p,g)}function E4(d,g){return g==null||uw(d,g,si(g))}function As(d,g){return d===g||d!==d&&g!==g}var S4=xp(Rg),D4=xp(function(d,g){return d>=g}),Ql=pw(function(){return arguments}())?pw:function(d){return En(d)&&Je.call(d,"callee")&&!ai.call(d,"callee")},dr=J.isArray,C4=Rt?Hn(Rt):RB;function ua(d){return d!=null&&Np(d.length)&&!Zo(d)}function Fn(d){return En(d)&&ua(d)}function T4(d){return d===!0||d===!1||En(d)&&Ui(d)==oe}var Gu=GO||x0,N4=Ci?Hn(Ci):PB;function M4(d){return En(d)&&d.nodeType===1&&!Zh(d)}function I4(d){if(d==null)return!0;if(ua(d)&&(dr(d)||typeof d=="string"||typeof d.splice=="function"||Gu(d)||af(d)||Ql(d)))return!d.length;var g=Mi(d);if(g==Oe||g==je)return!d.size;if(Yh(d))return!kg(d).length;for(var D in d)if(Je.call(d,D))return!1;return!0}function F4(d,g){return Vh(d,g)}function O4(d,g,D){D=typeof D=="function"?D:r;var B=D?D(d,g):r;return B===r?Vh(d,g,r,D):!!B}function c0(d){if(!En(d))return!1;var g=Ui(d);return g==_e||g==de||typeof d.message=="string"&&typeof d.name=="string"&&!Zh(d)}function B4(d){return typeof d=="number"&&rw(d)}function Zo(d){if(!yn(d))return!1;var g=Ui(d);return g==be||g==$e||g==Se||g==Ue}function __(d){return typeof d=="number"&&d==wr(d)}function Np(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=k}function yn(d){var g=typeof d;return d!=null&&(g=="object"||g=="function")}function En(d){return d!=null&&typeof d=="object"}var A_=Uo?Hn(Uo):kB;function R4(d,g){return d===g||$g(d,g,e0(g))}function P4(d,g,D){return D=typeof D=="function"?D:r,$g(d,g,e0(g),D)}function $4(d){return E_(d)&&d!=+d}function k4(d){if(wR(d))throw new he(a);return mw(d)}function L4(d){return d===null}function U4(d){return d==null}function E_(d){return typeof d=="number"||En(d)&&Ui(d)==Qe}function Zh(d){if(!En(d)||Ui(d)!=ce)return!1;var g=In(d);if(g===null)return!0;var D=Je.call(g,"constructor")&&g.constructor;return typeof D=="function"&&D instanceof D&&xt.call(D)==Mt}var f0=zo?Hn(zo):LB;function z4(d){return __(d)&&d>=-k&&d<=k}var S_=Go?Hn(Go):UB;function Mp(d){return typeof d=="string"||!dr(d)&&En(d)&&Ui(d)==ht}function wa(d){return typeof d=="symbol"||En(d)&&Ui(d)==re}var af=kl?Hn(kl):zB;function G4(d){return d===r}function q4(d){return En(d)&&Mi(d)==Ne}function H4(d){return En(d)&&Ui(d)==Ge}var W4=xp(Lg),V4=xp(function(d,g){return d<=g});function D_(d){if(!d)return[];if(ua(d))return Mp(d)?sa(d):oa(d);if(kh&&d[kh])return ze(d[kh]());var g=Mi(d),D=g==Oe?tt:g==je?Gr:sf;return D(d)}function Qo(d){if(!d)return d===0?d:0;if(d=Ya(d),d===j||d===-j){var g=d<0?-1:1;return g*Z}return d===d?d:0}function wr(d){var g=Qo(d),D=g%1;return g===g?D?g-D:g:0}function C_(d){return d?jl(wr(d),0,me):0}function Ya(d){if(typeof d=="number")return d;if(wa(d))return z;if(yn(d)){var g=typeof d.valueOf=="function"?d.valueOf():d;d=yn(g)?g+"":g}if(typeof d!="string")return d===0?d:+d;d=Ho(d);var D=ra.test(d);return D||ga.test(d)?$h(d.slice(2),D?2:8):Il.test(d)?z:+d}function T_(d){return ao(d,la(d))}function X4(d){return d?jl(wr(d),-k,k):d===0?d:0}function Yr(d){return d==null?"":xa(d)}var j4=tf(function(d,g){if(Yh(g)||ua(g)){ao(g,si(g),d);return}for(var D in g)Je.call(g,D)&&qh(d,D,g[D])}),N_=tf(function(d,g){ao(g,la(g),d)}),Ip=tf(function(d,g,D,B){ao(g,la(g),d,B)}),Y4=tf(function(d,g,D,B){ao(g,si(g),d,B)}),K4=Yo(Fg);function Z4(d,g){var D=ef(d);return g==null?D:ow(D,g)}var Q4=Sr(function(d,g){d=Ee(d);var D=-1,B=g.length,X=B>2?g[2]:r;for(X&&zi(g[0],g[1],X)&&(B=1);++D<B;)for(var ie=g[D],xe=la(ie),De=-1,Re=xe.length;++De<Re;){var nt=xe[De],it=d[nt];(it===r||As(it,et[nt])&&!Je.call(d,nt))&&(d[nt]=ie[nt])}return d}),J4=Sr(function(d){return d.push(r,Vw),gn(M_,r,d)});function e5(d,g){return Fu(d,Wt(g,3),io)}function t5(d,g){return Fu(d,Wt(g,3),Bg)}function r5(d,g){return d==null?d:Og(d,Wt(g,3),la)}function n5(d,g){return d==null?d:hw(d,Wt(g,3),la)}function i5(d,g){return d&&io(d,Wt(g,3))}function a5(d,g){return d&&Bg(d,Wt(g,3))}function s5(d){return d==null?[]:hp(d,si(d))}function o5(d){return d==null?[]:hp(d,la(d))}function h0(d,g,D){var B=d==null?r:Yl(d,g);return B===r?D:B}function u5(d,g){return d!=null&&Yw(d,g,IB)}function d0(d,g){return d!=null&&Yw(d,g,FB)}var l5=zw(function(d,g,D){g!=null&&typeof g.toString!="function"&&(g=yt.call(g)),d[g]=D},m0(ca)),c5=zw(function(d,g,D){g!=null&&typeof g.toString!="function"&&(g=yt.call(g)),Je.call(d,g)?d[g].push(D):d[g]=[D]},Wt),f5=Sr(Wh);function si(d){return ua(d)?aw(d):kg(d)}function la(d){return ua(d)?aw(d,!0):GB(d)}function h5(d,g){var D={};return g=Wt(g,3),io(d,function(B,X,ie){Xo(D,g(B,X,ie),B)}),D}function d5(d,g){var D={};return g=Wt(g,3),io(d,function(B,X,ie){Xo(D,X,g(B,X,ie))}),D}var p5=tf(function(d,g,D){dp(d,g,D)}),M_=tf(function(d,g,D,B){dp(d,g,D,B)}),m5=Yo(function(d,g){var D={};if(d==null)return D;var B=!1;g=Qr(g,function(ie){return ie=Uu(ie,d),B||(B=ie.length>1),ie}),ao(d,Qg(d),D),B&&(D=Va(D,f|h|p,lR));for(var X=g.length;X--;)Hg(D,g[X]);return D});function v5(d,g){return I_(d,Tp(Wt(g)))}var g5=Yo(function(d,g){return d==null?{}:HB(d,g)});function I_(d,g){if(d==null)return{};var D=Qr(Qg(d),function(B){return[B]});return g=Wt(g),_w(d,D,function(B,X){return g(B,X[0])})}function y5(d,g,D){g=Uu(g,d);var B=-1,X=g.length;for(X||(X=1,d=r);++B<X;){var ie=d==null?r:d[so(g[B])];ie===r&&(B=X,ie=D),d=Zo(ie)?ie.call(d):ie}return d}function b5(d,g,D){return d==null?d:Xh(d,g,D)}function x5(d,g,D,B){return B=typeof B=="function"?B:r,d==null?d:Xh(d,g,D,B)}var F_=Hw(si),O_=Hw(la);function w5(d,g,D){var B=dr(d),X=B||Gu(d)||af(d);if(g=Wt(g,4),D==null){var ie=d&&d.constructor;X?D=B?new ie:[]:yn(d)?D=Zo(ie)?ef(In(d)):{}:D={}}return(X?ni:io)(d,function(xe,De,Re){return g(D,xe,De,Re)}),D}function _5(d,g){return d==null?!0:Hg(d,g)}function A5(d,g,D){return d==null?d:Cw(d,g,Xg(D))}function E5(d,g,D,B){return B=typeof B=="function"?B:r,d==null?d:Cw(d,g,Xg(D),B)}function sf(d){return d==null?[]:no(d,si(d))}function S5(d){return d==null?[]:no(d,la(d))}function D5(d,g,D){return D===r&&(D=g,g=r),D!==r&&(D=Ya(D),D=D===D?D:0),g!==r&&(g=Ya(g),g=g===g?g:0),jl(Ya(d),g,D)}function C5(d,g,D){return g=Qo(g),D===r?(D=g,g=0):D=Qo(D),d=Ya(d),OB(d,g,D)}function T5(d,g,D){if(D&&typeof D!="boolean"&&zi(d,g,D)&&(g=D=r),D===r&&(typeof g=="boolean"?(D=g,g=r):typeof d=="boolean"&&(D=d,d=r)),d===r&&g===r?(d=0,g=1):(d=Qo(d),g===r?(g=d,d=0):g=Qo(g)),d>g){var B=d;d=g,g=B}if(D||d%1||g%1){var X=nw();return Ni(d+X*(g-d+Ph("1e-"+((X+"").length-1))),g)}return zg(d,g)}var N5=rf(function(d,g,D){return g=g.toLowerCase(),d+(D?B_(g):g)});function B_(d){return p0(Yr(d).toLowerCase())}function R_(d){return d=Yr(d),d&&d.replace(Mo,Pu).replace($o,"")}function M5(d,g,D){d=Yr(d),g=xa(g);var B=d.length;D=D===r?B:jl(wr(D),0,B);var X=D;return D-=g.length,D>=0&&d.slice(D,X)==g}function I5(d){return d=Yr(d),d&&Co.test(d)?d.replace(pn,an):d}function F5(d){return d=Yr(d),d&&Xr.test(d)?d.replace(Oa,"\\$&"):d}var O5=rf(function(d,g,D){return d+(D?"-":"")+g.toLowerCase()}),B5=rf(function(d,g,D){return d+(D?" ":"")+g.toLowerCase()}),R5=kw("toLowerCase");function P5(d,g,D){d=Yr(d),g=wr(g);var B=g?Li(d):0;if(!g||B>=g)return d;var X=(g-B)/2;return bp(sp(X),D)+d+bp(ap(X),D)}function $5(d,g,D){d=Yr(d),g=wr(g);var B=g?Li(d):0;return g&&B<g?d+bp(g-B,D):d}function k5(d,g,D){d=Yr(d),g=wr(g);var B=g?Li(d):0;return g&&B<g?bp(g-B,D)+d:d}function L5(d,g,D){return D||g==null?g=0:g&&(g=+g),VO(Yr(d).replace(fn,""),g||0)}function U5(d,g,D){return(D?zi(d,g,D):g===r)?g=1:g=wr(g),Gg(Yr(d),g)}function z5(){var d=arguments,g=Yr(d[0]);return d.length<3?g:g.replace(d[1],d[2])}var G5=rf(function(d,g,D){return d+(D?"_":"")+g.toLowerCase()});function q5(d,g,D){return D&&typeof D!="number"&&zi(d,g,D)&&(g=D=r),D=D===r?me:D>>>0,D?(d=Yr(d),d&&(typeof g=="string"||g!=null&&!f0(g))&&(g=xa(g),!g&&ve(d))?zu(sa(d),0,D):d.split(g,D)):[]}var H5=rf(function(d,g,D){return d+(D?" ":"")+p0(g)});function W5(d,g,D){return d=Yr(d),D=D==null?0:jl(wr(D),0,d.length),g=xa(g),d.slice(D,D+g.length)==g}function V5(d,g,D){var B=Q.templateSettings;D&&zi(d,g,D)&&(g=r),d=Yr(d),g=Ip({},g,B,Ww);var X=Ip({},g.imports,B.imports,Ww),ie=si(X),xe=no(X,ie),De,Re,nt=0,it=g.interpolate||jr,lt="__p += '",Ct=Fe((g.escape||jr).source+"|"+it.source+"|"+(it===To?hi:jr).source+"|"+(g.evaluate||jr).source+"|$","g"),Pt="//# sourceURL="+(Je.call(g,"sourceURL")?(g.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Wc+"]")+`
`;d.replace(Ct,function(Kt,Nr,Pr,_a,Gi,Aa){return Pr||(Pr=_a),lt+=d.slice(nt,Aa).replace(di,Kc),Nr&&(De=!0,lt+=`' +
__e(`+Nr+`) +
'`),Gi&&(Re=!0,lt+=`';
`+Gi+`;
__p += '`),Pr&&(lt+=`' +
((__t = (`+Pr+`)) == null ? '' : __t) +
'`),nt=Aa+Kt.length,Kt}),lt+=`';
`;var Yt=Je.call(g,"variable")&&g.variable;if(!Yt)lt=`with (obj) {
`+lt+`
}
`;else if(ea.test(Yt))throw new he(o);lt=(Re?lt.replace(Le,""):lt).replace(rt,"$1").replace(Xe,"$1;"),lt="function("+(Yt||"obj")+`) {
`+(Yt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(De?", __e = _.escape":"")+(Re?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+lt+`return __p
}`;var Ar=$_(function(){return Te(ie,Pt+"return "+lt).apply(r,xe)});if(Ar.source=lt,c0(Ar))throw Ar;return Ar}function X5(d){return Yr(d).toLowerCase()}function j5(d){return Yr(d).toUpperCase()}function Y5(d,g,D){if(d=Yr(d),d&&(D||g===r))return Ho(d);if(!d||!(g=xa(g)))return d;var B=sa(d),X=sa(g),ie=Ru(B,X),xe=Gl(B,X)+1;return zu(B,ie,xe).join("")}function K5(d,g,D){if(d=Yr(d),d&&(D||g===r))return d.slice(0,w(d)+1);if(!d||!(g=xa(g)))return d;var B=sa(d),X=Gl(B,sa(g))+1;return zu(B,0,X).join("")}function Z5(d,g,D){if(d=Yr(d),d&&(D||g===r))return d.replace(fn,"");if(!d||!(g=xa(g)))return d;var B=sa(d),X=Ru(B,sa(g));return zu(B,X).join("")}function Q5(d,g){var D=I,B=F;if(yn(g)){var X="separator"in g?g.separator:X;D="length"in g?wr(g.length):D,B="omission"in g?xa(g.omission):B}d=Yr(d);var ie=d.length;if(ve(d)){var xe=sa(d);ie=xe.length}if(D>=ie)return d;var De=D-Li(B);if(De<1)return B;var Re=xe?zu(xe,0,De).join(""):d.slice(0,De);if(X===r)return Re+B;if(xe&&(De+=Re.length-De),f0(X)){if(d.slice(De).search(X)){var nt,it=Re;for(X.global||(X=Fe(X.source,Yr(ta.exec(X))+"g")),X.lastIndex=0;nt=X.exec(it);)var lt=nt.index;Re=Re.slice(0,lt===r?De:lt)}}else if(d.indexOf(xa(X),De)!=De){var Ct=Re.lastIndexOf(X);Ct>-1&&(Re=Re.slice(0,Ct))}return Re+B}function J5(d){return d=Yr(d),d&&fs.test(d)?d.replace(qt,C):d}var e$=rf(function(d,g,D){return d+(D?" ":"")+g.toUpperCase()}),p0=kw("toUpperCase");function P_(d,g,D){return d=Yr(d),g=D?r:g,g===r?Ie(d)?q(d):Ul(d):d.match(g)||[]}var $_=Sr(function(d,g){try{return gn(d,r,g)}catch(D){return c0(D)?D:new he(D)}}),t$=Yo(function(d,g){return ni(g,function(D){D=so(D),Xo(d,D,u0(d[D],d))}),d});function r$(d){var g=d==null?0:d.length,D=Wt();return d=g?Qr(d,function(B){if(typeof B[1]!="function")throw new Pe(s);return[D(B[0]),B[1]]}):[],Sr(function(B){for(var X=-1;++X<g;){var ie=d[X];if(gn(ie[0],this,B))return gn(ie[1],this,B)}})}function n$(d){return TB(Va(d,f))}function m0(d){return function(){return d}}function i$(d,g){return d==null||d!==d?g:d}var a$=Uw(),s$=Uw(!0);function ca(d){return d}function v0(d){return vw(typeof d=="function"?d:Va(d,f))}function o$(d){return yw(Va(d,f))}function u$(d,g){return bw(d,Va(g,f))}var l$=Sr(function(d,g){return function(D){return Wh(D,d,g)}}),c$=Sr(function(d,g){return function(D){return Wh(d,D,g)}});function g0(d,g,D){var B=si(g),X=hp(g,B);D==null&&!(yn(g)&&(X.length||!B.length))&&(D=g,g=d,d=this,X=hp(g,si(g)));var ie=!(yn(D)&&"chain"in D)||!!D.chain,xe=Zo(d);return ni(X,function(De){var Re=g[De];d[De]=Re,xe&&(d.prototype[De]=function(){var nt=this.__chain__;if(ie||nt){var it=d(this.__wrapped__),lt=it.__actions__=oa(this.__actions__);return lt.push({func:Re,args:arguments,thisArg:d}),it.__chain__=nt,it}return Re.apply(d,ii([this.value()],arguments))})}),d}function f$(){return hn._===this&&(hn._=lr),this}function y0(){}function h$(d){return d=wr(d),Sr(function(g){return xw(g,d)})}var d$=Yg(Qr),p$=Yg(Mu),m$=Yg(ro);function k_(d){return r0(d)?Ti(so(d)):WB(d)}function v$(d){return function(g){return d==null?r:Yl(d,g)}}var g$=Gw(),y$=Gw(!0);function b0(){return[]}function x0(){return!1}function b$(){return{}}function x$(){return""}function w$(){return!0}function _$(d,g){if(d=wr(d),d<1||d>k)return[];var D=me,B=Ni(d,me);g=Wt(g),d-=me;for(var X=Bu(B,g);++D<d;)g(D);return X}function A$(d){return dr(d)?Qr(d,so):wa(d)?[d]:oa(i_(Yr(d)))}function E$(d){var g=++bt;return Yr(d)+g}var S$=yp(function(d,g){return d+g},0),D$=Kg("ceil"),C$=yp(function(d,g){return d/g},1),T$=Kg("floor");function N$(d){return d&&d.length?fp(d,ca,Rg):r}function M$(d,g){return d&&d.length?fp(d,Wt(g,2),Rg):r}function I$(d){return Ou(d,ca)}function F$(d,g){return Ou(d,Wt(g,2))}function O$(d){return d&&d.length?fp(d,ca,Lg):r}function B$(d,g){return d&&d.length?fp(d,Wt(g,2),Lg):r}var R$=yp(function(d,g){return d*g},1),P$=Kg("round"),$$=yp(function(d,g){return d-g},0);function k$(d){return d&&d.length?qo(d,ca):0}function L$(d,g){return d&&d.length?qo(d,Wt(g,2)):0}return Q.after=o4,Q.ary=m_,Q.assign=j4,Q.assignIn=N_,Q.assignInWith=Ip,Q.assignWith=Y4,Q.at=K4,Q.before=v_,Q.bind=u0,Q.bindAll=t$,Q.bindKey=g_,Q.castArray=b4,Q.chain=h_,Q.chunk=TR,Q.compact=NR,Q.concat=MR,Q.cond=r$,Q.conforms=n$,Q.constant=m0,Q.countBy=kP,Q.create=Z4,Q.curry=y_,Q.curryRight=b_,Q.debounce=x_,Q.defaults=Q4,Q.defaultsDeep=J4,Q.defer=u4,Q.delay=l4,Q.difference=IR,Q.differenceBy=FR,Q.differenceWith=OR,Q.drop=BR,Q.dropRight=RR,Q.dropRightWhile=PR,Q.dropWhile=$R,Q.fill=kR,Q.filter=UP,Q.flatMap=qP,Q.flatMapDeep=HP,Q.flatMapDepth=WP,Q.flatten=u_,Q.flattenDeep=LR,Q.flattenDepth=UR,Q.flip=c4,Q.flow=a$,Q.flowRight=s$,Q.fromPairs=zR,Q.functions=s5,Q.functionsIn=o5,Q.groupBy=VP,Q.initial=qR,Q.intersection=HR,Q.intersectionBy=WR,Q.intersectionWith=VR,Q.invert=l5,Q.invertBy=c5,Q.invokeMap=jP,Q.iteratee=v0,Q.keyBy=YP,Q.keys=si,Q.keysIn=la,Q.map=Sp,Q.mapKeys=h5,Q.mapValues=d5,Q.matches=o$,Q.matchesProperty=u$,Q.memoize=Cp,Q.merge=p5,Q.mergeWith=M_,Q.method=l$,Q.methodOf=c$,Q.mixin=g0,Q.negate=Tp,Q.nthArg=h$,Q.omit=m5,Q.omitBy=v5,Q.once=f4,Q.orderBy=KP,Q.over=d$,Q.overArgs=h4,Q.overEvery=p$,Q.overSome=m$,Q.partial=l0,Q.partialRight=w_,Q.partition=ZP,Q.pick=g5,Q.pickBy=I_,Q.property=k_,Q.propertyOf=v$,Q.pull=KR,Q.pullAll=c_,Q.pullAllBy=ZR,Q.pullAllWith=QR,Q.pullAt=JR,Q.range=g$,Q.rangeRight=y$,Q.rearg=d4,Q.reject=e4,Q.remove=eP,Q.rest=p4,Q.reverse=s0,Q.sampleSize=r4,Q.set=b5,Q.setWith=x5,Q.shuffle=n4,Q.slice=tP,Q.sortBy=s4,Q.sortedUniq=uP,Q.sortedUniqBy=lP,Q.split=q5,Q.spread=m4,Q.tail=cP,Q.take=fP,Q.takeRight=hP,Q.takeRightWhile=dP,Q.takeWhile=pP,Q.tap=NP,Q.throttle=v4,Q.thru=Ep,Q.toArray=D_,Q.toPairs=F_,Q.toPairsIn=O_,Q.toPath=A$,Q.toPlainObject=T_,Q.transform=w5,Q.unary=g4,Q.union=mP,Q.unionBy=vP,Q.unionWith=gP,Q.uniq=yP,Q.uniqBy=bP,Q.uniqWith=xP,Q.unset=_5,Q.unzip=o0,Q.unzipWith=f_,Q.update=A5,Q.updateWith=E5,Q.values=sf,Q.valuesIn=S5,Q.without=wP,Q.words=P_,Q.wrap=y4,Q.xor=_P,Q.xorBy=AP,Q.xorWith=EP,Q.zip=SP,Q.zipObject=DP,Q.zipObjectDeep=CP,Q.zipWith=TP,Q.entries=F_,Q.entriesIn=O_,Q.extend=N_,Q.extendWith=Ip,g0(Q,Q),Q.add=S$,Q.attempt=$_,Q.camelCase=N5,Q.capitalize=B_,Q.ceil=D$,Q.clamp=D5,Q.clone=x4,Q.cloneDeep=_4,Q.cloneDeepWith=A4,Q.cloneWith=w4,Q.conformsTo=E4,Q.deburr=R_,Q.defaultTo=i$,Q.divide=C$,Q.endsWith=M5,Q.eq=As,Q.escape=I5,Q.escapeRegExp=F5,Q.every=LP,Q.find=zP,Q.findIndex=s_,Q.findKey=e5,Q.findLast=GP,Q.findLastIndex=o_,Q.findLastKey=t5,Q.floor=T$,Q.forEach=d_,Q.forEachRight=p_,Q.forIn=r5,Q.forInRight=n5,Q.forOwn=i5,Q.forOwnRight=a5,Q.get=h0,Q.gt=S4,Q.gte=D4,Q.has=u5,Q.hasIn=d0,Q.head=l_,Q.identity=ca,Q.includes=XP,Q.indexOf=GR,Q.inRange=C5,Q.invoke=f5,Q.isArguments=Ql,Q.isArray=dr,Q.isArrayBuffer=C4,Q.isArrayLike=ua,Q.isArrayLikeObject=Fn,Q.isBoolean=T4,Q.isBuffer=Gu,Q.isDate=N4,Q.isElement=M4,Q.isEmpty=I4,Q.isEqual=F4,Q.isEqualWith=O4,Q.isError=c0,Q.isFinite=B4,Q.isFunction=Zo,Q.isInteger=__,Q.isLength=Np,Q.isMap=A_,Q.isMatch=R4,Q.isMatchWith=P4,Q.isNaN=$4,Q.isNative=k4,Q.isNil=U4,Q.isNull=L4,Q.isNumber=E_,Q.isObject=yn,Q.isObjectLike=En,Q.isPlainObject=Zh,Q.isRegExp=f0,Q.isSafeInteger=z4,Q.isSet=S_,Q.isString=Mp,Q.isSymbol=wa,Q.isTypedArray=af,Q.isUndefined=G4,Q.isWeakMap=q4,Q.isWeakSet=H4,Q.join=XR,Q.kebabCase=O5,Q.last=ja,Q.lastIndexOf=jR,Q.lowerCase=B5,Q.lowerFirst=R5,Q.lt=W4,Q.lte=V4,Q.max=N$,Q.maxBy=M$,Q.mean=I$,Q.meanBy=F$,Q.min=O$,Q.minBy=B$,Q.stubArray=b0,Q.stubFalse=x0,Q.stubObject=b$,Q.stubString=x$,Q.stubTrue=w$,Q.multiply=R$,Q.nth=YR,Q.noConflict=f$,Q.noop=y0,Q.now=Dp,Q.pad=P5,Q.padEnd=$5,Q.padStart=k5,Q.parseInt=L5,Q.random=T5,Q.reduce=QP,Q.reduceRight=JP,Q.repeat=U5,Q.replace=z5,Q.result=y5,Q.round=P$,Q.runInContext=W,Q.sample=t4,Q.size=i4,Q.snakeCase=G5,Q.some=a4,Q.sortedIndex=rP,Q.sortedIndexBy=nP,Q.sortedIndexOf=iP,Q.sortedLastIndex=aP,Q.sortedLastIndexBy=sP,Q.sortedLastIndexOf=oP,Q.startCase=H5,Q.startsWith=W5,Q.subtract=$$,Q.sum=k$,Q.sumBy=L$,Q.template=V5,Q.times=_$,Q.toFinite=Qo,Q.toInteger=wr,Q.toLength=C_,Q.toLower=X5,Q.toNumber=Ya,Q.toSafeInteger=X4,Q.toString=Yr,Q.toUpper=j5,Q.trim=Y5,Q.trimEnd=K5,Q.trimStart=Z5,Q.truncate=Q5,Q.unescape=J5,Q.uniqueId=E$,Q.upperCase=e$,Q.upperFirst=p0,Q.each=d_,Q.eachRight=p_,Q.first=l_,g0(Q,function(){var d={};return io(Q,function(g,D){Je.call(Q.prototype,D)||(d[D]=g)}),d}(),{chain:!1}),Q.VERSION=n,ni(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){Q[d].placeholder=Q}),ni(["drop","take"],function(d,g){Fr.prototype[d]=function(D){D=D===r?1:Vn(wr(D),0);var B=this.__filtered__&&!g?new Fr(this):this.clone();return B.__filtered__?B.__takeCount__=Ni(D,B.__takeCount__):B.__views__.push({size:Ni(D,me),type:d+(B.__dir__<0?"Right":"")}),B},Fr.prototype[d+"Right"]=function(D){return this.reverse()[d](D).reverse()}}),ni(["filter","map","takeWhile"],function(d,g){var D=g+1,B=D==G||D==$;Fr.prototype[d]=function(X){var ie=this.clone();return ie.__iteratees__.push({iteratee:Wt(X,3),type:D}),ie.__filtered__=ie.__filtered__||B,ie}}),ni(["head","last"],function(d,g){var D="take"+(g?"Right":"");Fr.prototype[d]=function(){return this[D](1).value()[0]}}),ni(["initial","tail"],function(d,g){var D="drop"+(g?"":"Right");Fr.prototype[d]=function(){return this.__filtered__?new Fr(this):this[D](1)}}),Fr.prototype.compact=function(){return this.filter(ca)},Fr.prototype.find=function(d){return this.filter(d).head()},Fr.prototype.findLast=function(d){return this.reverse().find(d)},Fr.prototype.invokeMap=Sr(function(d,g){return typeof d=="function"?new Fr(this):this.map(function(D){return Wh(D,d,g)})}),Fr.prototype.reject=function(d){return this.filter(Tp(Wt(d)))},Fr.prototype.slice=function(d,g){d=wr(d);var D=this;return D.__filtered__&&(d>0||g<0)?new Fr(D):(d<0?D=D.takeRight(-d):d&&(D=D.drop(d)),g!==r&&(g=wr(g),D=g<0?D.dropRight(-g):D.take(g-d)),D)},Fr.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},Fr.prototype.toArray=function(){return this.take(me)},io(Fr.prototype,function(d,g){var D=/^(?:filter|find|map|reject)|While$/.test(g),B=/^(?:head|last)$/.test(g),X=Q[B?"take"+(g=="last"?"Right":""):g],ie=B||/^find/.test(g);X&&(Q.prototype[g]=function(){var xe=this.__wrapped__,De=B?[1]:arguments,Re=xe instanceof Fr,nt=De[0],it=Re||dr(xe),lt=function(Nr){var Pr=X.apply(Q,ii([Nr],De));return B&&Ct?Pr[0]:Pr};it&&D&&typeof nt=="function"&&nt.length!=1&&(Re=it=!1);var Ct=this.__chain__,Pt=!!this.__actions__.length,Yt=ie&&!Ct,Ar=Re&&!Pt;if(!ie&&it){xe=Ar?xe:new Fr(this);var Kt=d.apply(xe,De);return Kt.__actions__.push({func:Ep,args:[lt],thisArg:r}),new Wa(Kt,Ct)}return Yt&&Ar?d.apply(this,De):(Kt=this.thru(lt),Yt?B?Kt.value()[0]:Kt.value():Kt)})}),ni(["pop","push","shift","sort","splice","unshift"],function(d){var g=qe[d],D=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",B=/^(?:pop|shift)$/.test(d);Q.prototype[d]=function(){var X=arguments;if(B&&!this.__chain__){var ie=this.value();return g.apply(dr(ie)?ie:[],X)}return this[D](function(xe){return g.apply(dr(xe)?xe:[],X)})}}),io(Fr.prototype,function(d,g){var D=Q[g];if(D){var B=D.name+"";Je.call(Jc,B)||(Jc[B]=[]),Jc[B].push({name:g,func:D})}}),Jc[gp(r,x).name]=[{name:"wrapper",func:r}],Fr.prototype.clone=JO,Fr.prototype.reverse=eB,Fr.prototype.value=tB,Q.prototype.at=MP,Q.prototype.chain=IP,Q.prototype.commit=FP,Q.prototype.next=OP,Q.prototype.plant=RP,Q.prototype.reverse=PP,Q.prototype.toJSON=Q.prototype.valueOf=Q.prototype.value=$P,Q.prototype.first=Q.prototype.head,kh&&(Q.prototype[kh]=BP),Q},se=Y();ba?((ba.exports=se)._=se,Di._=se):hn._=se}).call(Qn)})(Xm,Xm.exports);var Qt=Xm.exports;const Wu=gl(Qt);var Sc=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(Sc||{}),Wy=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(Wy||{}),Zt=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(Zt||{}),po=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(po||{}),wt=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(wt||{}),Pf=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(Pf||{}),Ht=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(Ht||{}),Vy=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(Vy||{}),ou=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(ou||{}),al=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(al||{}),xo=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(xo||{}),Us=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(Us||{}),fo=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(fo||{}),gb=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(gb||{}),rs=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(rs||{}),jn=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(jn||{}),zn=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(zn||{}),vo=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(vo||{});const q$={createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>new DOMParser().parseFromString(t,"text/xml")},Nt={ADAPTER:q$,RESOLUTION:1,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,premultipliedAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1,hello:!1},CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var w0=/iPhone/i,U_=/iPod/i,z_=/iPad/i,G_=/\biOS-universal(?:.+)Mac\b/i,_0=/\bAndroid(?:.+)Mobile\b/i,q_=/Android/i,of=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Fp=/Silk/i,eu=/Windows Phone/i,H_=/\bWindows(?:.+)ARM\b/i,W_=/BlackBerry/i,V_=/BB10/i,X_=/Opera Mini/i,j_=/\b(CriOS|Chrome)(?:.+)Mobile/i,Y_=/Mobile(?:.+)Firefox\b/i,K_=function(t){return typeof t<"u"&&t.platform==="MacIntel"&&typeof t.maxTouchPoints=="number"&&t.maxTouchPoints>1&&typeof MSStream>"u"};function H$(t){return function(e){return e.test(t)}}function W$(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof t=="string"?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var r=e.userAgent,n=r.split("[FBAN");typeof n[1]<"u"&&(r=n[0]),n=r.split("Twitter"),typeof n[1]<"u"&&(r=n[0]);var i=H$(r),a={apple:{phone:i(w0)&&!i(eu),ipod:i(U_),tablet:!i(w0)&&(i(z_)||K_(e))&&!i(eu),universal:i(G_),device:(i(w0)||i(U_)||i(z_)||i(G_)||K_(e))&&!i(eu)},amazon:{phone:i(of),tablet:!i(of)&&i(Fp),device:i(of)||i(Fp)},android:{phone:!i(eu)&&i(of)||!i(eu)&&i(_0),tablet:!i(eu)&&!i(of)&&!i(_0)&&(i(Fp)||i(q_)),device:!i(eu)&&(i(of)||i(Fp)||i(_0)||i(q_))||i(/\bokhttp\b/i)},windows:{phone:i(eu),tablet:i(H_),device:i(eu)||i(H_)},other:{blackberry:i(W_),blackberry10:i(V_),opera:i(X_),firefox:i(Y_),chrome:i(j_),device:i(W_)||i(V_)||i(X_)||i(Y_)||i(j_)},any:!1,phone:!1,tablet:!1};return a.any=a.apple.device||a.android.device||a.windows.device||a.other.device,a.phone=a.apple.phone||a.android.phone||a.windows.phone,a.tablet=a.apple.tablet||a.android.tablet||a.windows.tablet,a}const uu=W$(globalThis.navigator);Nt.RETINA_PREFIX=/@([0-9\.]+)x/;Nt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var L2={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function a(l,u,c,f,h){if(typeof c!="function")throw new TypeError("The listener must be a function");var p=new i(c,f||l,h),m=r?r+u:u;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],p]:l._events[m].push(p):(l._events[m]=p,l._eventsCount++),l}function s(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,f;if(this._eventsCount===0)return u;for(f in c=this._events)e.call(c,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=r?r+u:u,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,p=f.length,m=new Array(p);h<p;h++)m[h]=f[h].fn;return m},o.prototype.listenerCount=function(u){var c=r?r+u:u,f=this._events[c];return f?f.fn?1:f.length:0},o.prototype.emit=function(u,c,f,h,p,m){var v=r?r+u:u;if(!this._events[v])return!1;var y=this._events[v],x=arguments.length,S,b;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),x){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,c),!0;case 3:return y.fn.call(y.context,c,f),!0;case 4:return y.fn.call(y.context,c,f,h),!0;case 5:return y.fn.call(y.context,c,f,h,p),!0;case 6:return y.fn.call(y.context,c,f,h,p,m),!0}for(b=1,S=new Array(x-1);b<x;b++)S[b-1]=arguments[b];y.fn.apply(y.context,S)}else{var A=y.length,E;for(b=0;b<A;b++)switch(y[b].once&&this.removeListener(u,y[b].fn,void 0,!0),x){case 1:y[b].fn.call(y[b].context);break;case 2:y[b].fn.call(y[b].context,c);break;case 3:y[b].fn.call(y[b].context,c,f);break;case 4:y[b].fn.call(y[b].context,c,f,h);break;default:if(!S)for(E=1,S=new Array(x-1);E<x;E++)S[E-1]=arguments[E];y[b].fn.apply(y[b].context,S)}}return!0},o.prototype.on=function(u,c,f){return a(this,u,c,f,!1)},o.prototype.once=function(u,c,f){return a(this,u,c,f,!0)},o.prototype.removeListener=function(u,c,f,h){var p=r?r+u:u;if(!this._events[p])return this;if(!c)return s(this,p),this;var m=this._events[p];if(m.fn)m.fn===c&&(!h||m.once)&&(!f||m.context===f)&&s(this,p);else{for(var v=0,y=[],x=m.length;v<x;v++)(m[v].fn!==c||h&&!m[v].once||f&&m[v].context!==f)&&y.push(m[v]);y.length?this._events[p]=y.length===1?y[0]:y:s(this,p)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=r?r+u:u,this._events[c]&&s(this,c)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o})(L2);var V$=L2.exports;const Rd=gl(V$);var yb={exports:{}};yb.exports=qv;yb.exports.default=qv;function qv(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,a=U2(t,0,i,r,!0),s=[];if(!a||a.next===a.prev)return s;var o,l,u,c,f,h,p;if(n&&(a=Z$(t,e,a,r)),t.length>80*r){o=u=t[0],l=c=t[1];for(var m=r;m<i;m+=r)f=t[m],h=t[m+1],f<o&&(o=f),h<l&&(l=h),f>u&&(u=f),h>c&&(c=h);p=Math.max(u-o,c-l),p=p!==0?32767/p:0}return _d(a,s,r,o,l,p,0),s}function U2(t,e,r,n,i){var a,s;if(i===Yy(t,e,r,n)>0)for(a=e;a<r;a+=n)s=Z_(a,t[a],t[a+1],s);else for(a=r-n;a>=e;a-=n)s=Z_(a,t[a],t[a+1],s);return s&&Hv(s,s.next)&&(Ed(s),s=s.next),s}function gc(t,e){if(!t)return t;e||(e=t);var r=t,n;do if(n=!1,!r.steiner&&(Hv(r,r.next)||xn(r.prev,r,r.next)===0)){if(Ed(r),r=e=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==e);return e}function _d(t,e,r,n,i,a,s){if(t){!s&&a&&rk(t,n,i,a);for(var o=t,l,u;t.prev!==t.next;){if(l=t.prev,u=t.next,a?j$(t,n,i,a):X$(t)){e.push(l.i/r|0),e.push(t.i/r|0),e.push(u.i/r|0),Ed(t),t=u.next,o=u.next;continue}if(t=u,t===o){s?s===1?(t=Y$(gc(t),e,r),_d(t,e,r,n,i,a,2)):s===2&&K$(t,e,r,n,i,a):_d(gc(t),e,r,n,i,a,1);break}}}}function X$(t){var e=t.prev,r=t,n=t.next;if(xn(e,r,n)>=0)return!1;for(var i=e.x,a=r.x,s=n.x,o=e.y,l=r.y,u=n.y,c=i<a?i<s?i:s:a<s?a:s,f=o<l?o<u?o:u:l<u?l:u,h=i>a?i>s?i:s:a>s?a:s,p=o>l?o>u?o:u:l>u?l:u,m=n.next;m!==e;){if(m.x>=c&&m.x<=h&&m.y>=f&&m.y<=p&&Cf(i,o,a,l,s,u,m.x,m.y)&&xn(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function j$(t,e,r,n){var i=t.prev,a=t,s=t.next;if(xn(i,a,s)>=0)return!1;for(var o=i.x,l=a.x,u=s.x,c=i.y,f=a.y,h=s.y,p=o<l?o<u?o:u:l<u?l:u,m=c<f?c<h?c:h:f<h?f:h,v=o>l?o>u?o:u:l>u?l:u,y=c>f?c>h?c:h:f>h?f:h,x=Xy(p,m,e,r,n),S=Xy(v,y,e,r,n),b=t.prevZ,A=t.nextZ;b&&b.z>=x&&A&&A.z<=S;){if(b.x>=p&&b.x<=v&&b.y>=m&&b.y<=y&&b!==i&&b!==s&&Cf(o,c,l,f,u,h,b.x,b.y)&&xn(b.prev,b,b.next)>=0||(b=b.prevZ,A.x>=p&&A.x<=v&&A.y>=m&&A.y<=y&&A!==i&&A!==s&&Cf(o,c,l,f,u,h,A.x,A.y)&&xn(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;b&&b.z>=x;){if(b.x>=p&&b.x<=v&&b.y>=m&&b.y<=y&&b!==i&&b!==s&&Cf(o,c,l,f,u,h,b.x,b.y)&&xn(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;A&&A.z<=S;){if(A.x>=p&&A.x<=v&&A.y>=m&&A.y<=y&&A!==i&&A!==s&&Cf(o,c,l,f,u,h,A.x,A.y)&&xn(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function Y$(t,e,r){var n=t;do{var i=n.prev,a=n.next.next;!Hv(i,a)&&z2(i,n,n.next,a)&&Ad(i,a)&&Ad(a,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(a.i/r|0),Ed(n),Ed(n.next),n=t=a),n=n.next}while(n!==t);return gc(n)}function K$(t,e,r,n,i,a){var s=t;do{for(var o=s.next.next;o!==s.prev;){if(s.i!==o.i&&ak(s,o)){var l=G2(s,o);s=gc(s,s.next),l=gc(l,l.next),_d(s,e,r,n,i,a,0),_d(l,e,r,n,i,a,0);return}o=o.next}s=s.next}while(s!==t)}function Z$(t,e,r,n){var i=[],a,s,o,l,u;for(a=0,s=e.length;a<s;a++)o=e[a]*n,l=a<s-1?e[a+1]*n:t.length,u=U2(t,o,l,n,!1),u===u.next&&(u.steiner=!0),i.push(ik(u));for(i.sort(Q$),a=0;a<i.length;a++)r=J$(i[a],r);return r}function Q$(t,e){return t.x-e.x}function J$(t,e){var r=ek(t,e);if(!r)return e;var n=G2(r,t);return gc(n,n.next),gc(r,r.next)}function ek(t,e){var r=e,n=t.x,i=t.y,a=-1/0,s;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var o=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=n&&o>a&&(a=o,s=r.x<r.next.x?r:r.next,o===n))return s}r=r.next}while(r!==e);if(!s)return null;var l=s,u=s.x,c=s.y,f=1/0,h;r=s;do n>=r.x&&r.x>=u&&n!==r.x&&Cf(i<c?n:a,i,u,c,i<c?a:n,i,r.x,r.y)&&(h=Math.abs(i-r.y)/(n-r.x),Ad(r,t)&&(h<f||h===f&&(r.x>s.x||r.x===s.x&&tk(s,r)))&&(s=r,f=h)),r=r.next;while(r!==l);return s}function tk(t,e){return xn(t.prev,t,e.prev)<0&&xn(e.next,t,t.next)<0}function rk(t,e,r,n){var i=t;do i.z===0&&(i.z=Xy(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,nk(i)}function nk(t){var e,r,n,i,a,s,o,l,u=1;do{for(r=t,t=null,a=null,s=0;r;){for(s++,n=r,o=0,e=0;e<u&&(o++,n=n.nextZ,!!n);e++);for(l=u;o>0||l>0&&n;)o!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,o--):(i=n,n=n.nextZ,l--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;r=n}a.nextZ=null,u*=2}while(s>1);return t}function Xy(t,e,r,n,i){return t=(t-r)*i|0,e=(e-n)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function ik(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function Cf(t,e,r,n,i,a,s,o){return(i-s)*(e-o)>=(t-s)*(a-o)&&(t-s)*(n-o)>=(r-s)*(e-o)&&(r-s)*(a-o)>=(i-s)*(n-o)}function ak(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!sk(t,e)&&(Ad(t,e)&&Ad(e,t)&&ok(t,e)&&(xn(t.prev,t,e.prev)||xn(t,e.prev,e))||Hv(t,e)&&xn(t.prev,t,t.next)>0&&xn(e.prev,e,e.next)>0)}function xn(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Hv(t,e){return t.x===e.x&&t.y===e.y}function z2(t,e,r,n){var i=Bp(xn(t,e,r)),a=Bp(xn(t,e,n)),s=Bp(xn(r,n,t)),o=Bp(xn(r,n,e));return!!(i!==a&&s!==o||i===0&&Op(t,r,e)||a===0&&Op(t,n,e)||s===0&&Op(r,t,n)||o===0&&Op(r,e,n))}function Op(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Bp(t){return t>0?1:t<0?-1:0}function sk(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&z2(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function Ad(t,e){return xn(t.prev,t,t.next)<0?xn(t,e,t.next)>=0&&xn(t,t.prev,e)>=0:xn(t,e,t.prev)<0||xn(t,t.next,e)<0}function ok(t,e){var r=t,n=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==t);return n}function G2(t,e){var r=new jy(t.i,t.x,t.y),n=new jy(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function Z_(t,e,r,n){var i=new jy(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Ed(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function jy(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}qv.deviation=function(t,e,r,n){var i=e&&e.length,a=i?e[0]*r:t.length,s=Math.abs(Yy(t,0,a,r));if(i)for(var o=0,l=e.length;o<l;o++){var u=e[o]*r,c=o<l-1?e[o+1]*r:t.length;s-=Math.abs(Yy(t,u,c,r))}var f=0;for(o=0;o<n.length;o+=3){var h=n[o]*r,p=n[o+1]*r,m=n[o+2]*r;f+=Math.abs((t[h]-t[m])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[m+1]-t[h+1]))}return s===0&&f===0?0:Math.abs((f-s)/s)};function Yy(t,e,r,n){for(var i=0,a=e,s=r-n;a<r;a+=n)i+=(t[s]-t[a])*(t[a+1]+t[s+1]),s=a;return i}qv.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var a=0;a<t[i].length;a++)for(var s=0;s<e;s++)r.vertices.push(t[i][a][s]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r};var uk=yb.exports;const lk=gl(uk);var jm={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */jm.exports;(function(t,e){(function(r){var n=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,a=typeof Qn=="object"&&Qn;(a.global===a||a.window===a||a.self===a)&&(r=a);var s,o=2147483647,l=36,u=1,c=26,f=38,h=700,p=72,m=128,v="-",y=/^xn--/,x=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=l-u,E=Math.floor,_=String.fromCharCode,T;function M(z){throw new RangeError(b[z])}function N(z,me){for(var fe=z.length,ue=[];fe--;)ue[fe]=me(z[fe]);return ue}function I(z,me){var fe=z.split("@"),ue="";fe.length>1&&(ue=fe[0]+"@",z=fe[1]),z=z.replace(S,".");var le=z.split("."),ke=N(le,me).join(".");return ue+ke}function F(z){for(var me=[],fe=0,ue=z.length,le,ke;fe<ue;)le=z.charCodeAt(fe++),le>=55296&&le<=56319&&fe<ue?(ke=z.charCodeAt(fe++),(ke&64512)==56320?me.push(((le&1023)<<10)+(ke&1023)+65536):(me.push(le),fe--)):me.push(le);return me}function P(z){return N(z,function(me){var fe="";return me>65535&&(me-=65536,fe+=_(me>>>10&1023|55296),me=56320|me&1023),fe+=_(me),fe}).join("")}function U(z){return z-48<10?z-22:z-65<26?z-65:z-97<26?z-97:l}function G(z,me){return z+22+75*(z<26)-((me!=0)<<5)}function V(z,me,fe){var ue=0;for(z=fe?E(z/h):z>>1,z+=E(z/me);z>A*c>>1;ue+=l)z=E(z/A);return E(ue+(A+1)*z/(z+f))}function $(z){var me=[],fe=z.length,ue,le=0,ke=m,Me=p,Se,oe,K,de,_e,be,$e,Oe,Qe;for(Se=z.lastIndexOf(v),Se<0&&(Se=0),oe=0;oe<Se;++oe)z.charCodeAt(oe)>=128&&M("not-basic"),me.push(z.charCodeAt(oe));for(K=Se>0?Se+1:0;K<fe;){for(de=le,_e=1,be=l;K>=fe&&M("invalid-input"),$e=U(z.charCodeAt(K++)),($e>=l||$e>E((o-le)/_e))&&M("overflow"),le+=$e*_e,Oe=be<=Me?u:be>=Me+c?c:be-Me,!($e<Oe);be+=l)Qe=l-Oe,_e>E(o/Qe)&&M("overflow"),_e*=Qe;ue=me.length+1,Me=V(le-de,ue,de==0),E(le/ue)>o-ke&&M("overflow"),ke+=E(le/ue),le%=ue,me.splice(le++,0,ke)}return P(me)}function j(z){var me,fe,ue,le,ke,Me,Se,oe,K,de,_e,be=[],$e,Oe,Qe,ae;for(z=F(z),$e=z.length,me=m,fe=0,ke=p,Me=0;Me<$e;++Me)_e=z[Me],_e<128&&be.push(_(_e));for(ue=le=be.length,le&&be.push(v);ue<$e;){for(Se=o,Me=0;Me<$e;++Me)_e=z[Me],_e>=me&&_e<Se&&(Se=_e);for(Oe=ue+1,Se-me>E((o-fe)/Oe)&&M("overflow"),fe+=(Se-me)*Oe,me=Se,Me=0;Me<$e;++Me)if(_e=z[Me],_e<me&&++fe>o&&M("overflow"),_e==me){for(oe=fe,K=l;de=K<=ke?u:K>=ke+c?c:K-ke,!(oe<de);K+=l)ae=oe-de,Qe=l-de,be.push(_(G(de+ae%Qe,0))),oe=E(ae/Qe);be.push(_(G(oe,0))),ke=V(fe,Oe,ue==le),fe=0,++ue}++fe,++me}return be.join("")}function k(z){return I(z,function(me){return y.test(me)?$(me.slice(4).toLowerCase()):me})}function Z(z){return I(z,function(me){return x.test(me)?"xn--"+j(me):me})}if(s={version:"1.4.1",ucs2:{decode:F,encode:P},decode:$,encode:j,toASCII:Z,toUnicode:k},n&&i)if(t.exports==n)i.exports=s;else for(T in s)s.hasOwnProperty(T)&&(n[T]=s[T]);else r.punycode=s})(Qn)})(jm,jm.exports);var ck=jm.exports,fk=Error,hk=EvalError,dk=RangeError,pk=ReferenceError,q2=SyntaxError,Pd=TypeError,mk=URIError,vk=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,r);if(s.value!==i||s.enumerable!==!0)return!1}return!0},Q_=typeof Symbol<"u"&&Symbol,gk=vk,yk=function(){return typeof Q_!="function"||typeof Symbol!="function"||typeof Q_("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:gk()},A0={__proto__:null,foo:{}},bk=Object,xk=function(){return{__proto__:A0}.foo===A0.foo&&!(A0 instanceof bk)},wk="Function.prototype.bind called on incompatible ",_k=Object.prototype.toString,Ak=Math.max,Ek="[object Function]",J_=function(e,r){for(var n=[],i=0;i<e.length;i+=1)n[i]=e[i];for(var a=0;a<r.length;a+=1)n[a+e.length]=r[a];return n},Sk=function(e,r){for(var n=[],i=r,a=0;i<e.length;i+=1,a+=1)n[a]=e[i];return n},Dk=function(t,e){for(var r="",n=0;n<t.length;n+=1)r+=t[n],n+1<t.length&&(r+=e);return r},Ck=function(e){var r=this;if(typeof r!="function"||_k.apply(r)!==Ek)throw new TypeError(wk+r);for(var n=Sk(arguments,1),i,a=function(){if(this instanceof i){var c=r.apply(this,J_(n,arguments));return Object(c)===c?c:this}return r.apply(e,J_(n,arguments))},s=Ak(0,r.length-n.length),o=[],l=0;l<s;l++)o[l]="$"+l;if(i=Function("binder","return function ("+Dk(o,",")+"){ return binder.apply(this,arguments); }")(a),r.prototype){var u=function(){};u.prototype=r.prototype,i.prototype=new u,u.prototype=null}return i},Tk=Ck,bb=Function.prototype.bind||Tk,Nk=Function.prototype.call,Mk=Object.prototype.hasOwnProperty,Ik=bb,Fk=Ik.call(Nk,Mk),Or,Ok=fk,Bk=hk,Rk=dk,Pk=pk,Xf=q2,$f=Pd,$k=mk,H2=Function,E0=function(t){try{return H2('"use strict"; return ('+t+").constructor;")()}catch{}},dc=Object.getOwnPropertyDescriptor;if(dc)try{dc({},"")}catch{dc=null}var S0=function(){throw new $f},kk=dc?function(){try{return arguments.callee,S0}catch{try{return dc(arguments,"callee").get}catch{return S0}}}():S0,uf=yk(),Lk=xk(),ci=Object.getPrototypeOf||(Lk?function(t){return t.__proto__}:null),_f={},Uk=typeof Uint8Array>"u"||!ci?Or:ci(Uint8Array),pc={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Or:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Or:ArrayBuffer,"%ArrayIteratorPrototype%":uf&&ci?ci([][Symbol.iterator]()):Or,"%AsyncFromSyncIteratorPrototype%":Or,"%AsyncFunction%":_f,"%AsyncGenerator%":_f,"%AsyncGeneratorFunction%":_f,"%AsyncIteratorPrototype%":_f,"%Atomics%":typeof Atomics>"u"?Or:Atomics,"%BigInt%":typeof BigInt>"u"?Or:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Or:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Or:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Or:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Ok,"%eval%":eval,"%EvalError%":Bk,"%Float32Array%":typeof Float32Array>"u"?Or:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Or:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Or:FinalizationRegistry,"%Function%":H2,"%GeneratorFunction%":_f,"%Int8Array%":typeof Int8Array>"u"?Or:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Or:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Or:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":uf&&ci?ci(ci([][Symbol.iterator]())):Or,"%JSON%":typeof JSON=="object"?JSON:Or,"%Map%":typeof Map>"u"?Or:Map,"%MapIteratorPrototype%":typeof Map>"u"||!uf||!ci?Or:ci(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Or:Promise,"%Proxy%":typeof Proxy>"u"?Or:Proxy,"%RangeError%":Rk,"%ReferenceError%":Pk,"%Reflect%":typeof Reflect>"u"?Or:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Or:Set,"%SetIteratorPrototype%":typeof Set>"u"||!uf||!ci?Or:ci(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Or:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":uf&&ci?ci(""[Symbol.iterator]()):Or,"%Symbol%":uf?Symbol:Or,"%SyntaxError%":Xf,"%ThrowTypeError%":kk,"%TypedArray%":Uk,"%TypeError%":$f,"%Uint8Array%":typeof Uint8Array>"u"?Or:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Or:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Or:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Or:Uint32Array,"%URIError%":$k,"%WeakMap%":typeof WeakMap>"u"?Or:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Or:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Or:WeakSet};if(ci)try{null.error}catch(t){var zk=ci(ci(t));pc["%Error.prototype%"]=zk}var Gk=function t(e){var r;if(e==="%AsyncFunction%")r=E0("async function () {}");else if(e==="%GeneratorFunction%")r=E0("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=E0("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&ci&&(r=ci(i.prototype))}return pc[e]=r,r},eA={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},$d=bb,Ym=Fk,qk=$d.call(Function.call,Array.prototype.concat),Hk=$d.call(Function.apply,Array.prototype.splice),tA=$d.call(Function.call,String.prototype.replace),Km=$d.call(Function.call,String.prototype.slice),Wk=$d.call(Function.call,RegExp.prototype.exec),Vk=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Xk=/\\(\\)?/g,jk=function(e){var r=Km(e,0,1),n=Km(e,-1);if(r==="%"&&n!=="%")throw new Xf("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Xf("invalid intrinsic syntax, expected opening `%`");var i=[];return tA(e,Vk,function(a,s,o,l){i[i.length]=o?tA(l,Xk,"$1"):s||a}),i},Yk=function(e,r){var n=e,i;if(Ym(eA,n)&&(i=eA[n],n="%"+i[0]+"%"),Ym(pc,n)){var a=pc[n];if(a===_f&&(a=Gk(n)),typeof a>"u"&&!r)throw new $f("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:a}}throw new Xf("intrinsic "+e+" does not exist!")},vh=function(e,r){if(typeof e!="string"||e.length===0)throw new $f("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new $f('"allowMissing" argument must be a boolean');if(Wk(/^%?[^%]*%?$/,e)===null)throw new Xf("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=jk(e),i=n.length>0?n[0]:"",a=Yk("%"+i+"%",r),s=a.name,o=a.value,l=!1,u=a.alias;u&&(i=u[0],Hk(n,qk([0,1],u)));for(var c=1,f=!0;c<n.length;c+=1){var h=n[c],p=Km(h,0,1),m=Km(h,-1);if((p==='"'||p==="'"||p==="`"||m==='"'||m==="'"||m==="`")&&p!==m)throw new Xf("property names with quotes must have matching quotes");if((h==="constructor"||!f)&&(l=!0),i+="."+h,s="%"+i+"%",Ym(pc,s))o=pc[s];else if(o!=null){if(!(h in o)){if(!r)throw new $f("base intrinsic for "+e+" exists, but the property is not available.");return}if(dc&&c+1>=n.length){var v=dc(o,h);f=!!v,f&&"get"in v&&!("originalValue"in v.get)?o=v.get:o=o[h]}else f=Ym(o,h),o=o[h];f&&!l&&(pc[s]=o)}}return o},W2={exports:{}},D0,rA;function xb(){if(rA)return D0;rA=1;var t=vh,e=t("%Object.defineProperty%",!0)||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return D0=e,D0}var Kk=vh,Fm=Kk("%Object.getOwnPropertyDescriptor%",!0);if(Fm)try{Fm([],"length")}catch{Fm=null}var V2=Fm,nA=xb(),Zk=q2,lf=Pd,iA=V2,Qk=function(e,r,n){if(!e||typeof e!="object"&&typeof e!="function")throw new lf("`obj` must be an object or a function`");if(typeof r!="string"&&typeof r!="symbol")throw new lf("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new lf("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new lf("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new lf("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new lf("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,a=arguments.length>4?arguments[4]:null,s=arguments.length>5?arguments[5]:null,o=arguments.length>6?arguments[6]:!1,l=!!iA&&iA(e,r);if(nA)nA(e,r,{configurable:s===null&&l?l.configurable:!s,enumerable:i===null&&l?l.enumerable:!i,value:n,writable:a===null&&l?l.writable:!a});else if(o||!i&&!a&&!s)e[r]=n;else throw new Zk("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Ky=xb(),X2=function(){return!!Ky};X2.hasArrayLengthDefineBug=function(){if(!Ky)return null;try{return Ky([],"length",{value:1}).length!==1}catch{return!0}};var Jk=X2,e8=vh,aA=Qk,t8=Jk(),sA=V2,oA=Pd,r8=e8("%Math.floor%"),n8=function(e,r){if(typeof e!="function")throw new oA("`fn` is not a function");if(typeof r!="number"||r<0||r>4294967295||r8(r)!==r)throw new oA("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],i=!0,a=!0;if("length"in e&&sA){var s=sA(e,"length");s&&!s.configurable&&(i=!1),s&&!s.writable&&(a=!1)}return(i||a||!n)&&(t8?aA(e,"length",r,!0,!0):aA(e,"length",r)),e};(function(t){var e=bb,r=vh,n=n8,i=Pd,a=r("%Function.prototype.apply%"),s=r("%Function.prototype.call%"),o=r("%Reflect.apply%",!0)||e.call(s,a),l=xb(),u=r("%Math.max%");t.exports=function(h){if(typeof h!="function")throw new i("a function is required");var p=o(e,s,arguments);return n(p,1+u(0,h.length-(arguments.length-1)),!0)};var c=function(){return o(e,a,arguments)};l?l(t.exports,"apply",{value:c}):t.exports.apply=c})(W2);var i8=W2.exports,j2=vh,Y2=i8,a8=Y2(j2("String.prototype.indexOf")),s8=function(e,r){var n=j2(e,!!r);return typeof n=="function"&&a8(e,".prototype.")>-1?Y2(n):n};const o8={},u8=Object.freeze(Object.defineProperty({__proto__:null,default:o8},Symbol.toStringTag,{value:"Module"})),K2=G$(u8);var wb=typeof Map=="function"&&Map.prototype,C0=Object.getOwnPropertyDescriptor&&wb?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Zm=wb&&C0&&typeof C0.get=="function"?C0.get:null,uA=wb&&Map.prototype.forEach,_b=typeof Set=="function"&&Set.prototype,T0=Object.getOwnPropertyDescriptor&&_b?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Qm=_b&&T0&&typeof T0.get=="function"?T0.get:null,lA=_b&&Set.prototype.forEach,l8=typeof WeakMap=="function"&&WeakMap.prototype,md=l8?WeakMap.prototype.has:null,c8=typeof WeakSet=="function"&&WeakSet.prototype,vd=c8?WeakSet.prototype.has:null,f8=typeof WeakRef=="function"&&WeakRef.prototype,cA=f8?WeakRef.prototype.deref:null,h8=Boolean.prototype.valueOf,d8=Object.prototype.toString,p8=Function.prototype.toString,m8=String.prototype.match,Ab=String.prototype.slice,el=String.prototype.replace,v8=String.prototype.toUpperCase,fA=String.prototype.toLowerCase,Z2=RegExp.prototype.test,hA=Array.prototype.concat,ho=Array.prototype.join,g8=Array.prototype.slice,dA=Math.floor,Zy=typeof BigInt=="function"?BigInt.prototype.valueOf:null,N0=Object.getOwnPropertySymbols,Qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,jf=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Bi=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===jf||!0)?Symbol.toStringTag:null,Q2=Object.prototype.propertyIsEnumerable,pA=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function mA(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||Z2.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-dA(-t):dA(t);if(n!==t){var i=String(n),a=Ab.call(e,i.length+1);return el.call(i,r,"$&_")+"."+el.call(el.call(a,/([0-9]{3})/g,"$&_"),/_$/,"")}}return el.call(e,r,"$&_")}var Jy=K2,vA=Jy.custom,gA=eN(vA)?vA:null,y8=function t(e,r,n,i){var a=r||{};if(ju(a,"quoteStyle")&&a.quoteStyle!=="single"&&a.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(ju(a,"maxStringLength")&&(typeof a.maxStringLength=="number"?a.maxStringLength<0&&a.maxStringLength!==1/0:a.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var s=ju(a,"customInspect")?a.customInspect:!0;if(typeof s!="boolean"&&s!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(ju(a,"indent")&&a.indent!==null&&a.indent!=="	"&&!(parseInt(a.indent,10)===a.indent&&a.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(ju(a,"numericSeparator")&&typeof a.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var o=a.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return rN(e,a);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return o?mA(e,l):l}if(typeof e=="bigint"){var u=String(e)+"n";return o?mA(e,u):u}var c=typeof a.depth>"u"?5:a.depth;if(typeof n>"u"&&(n=0),n>=c&&c>0&&typeof e=="object")return e1(e)?"[Array]":"[Object]";var f=P8(a,n);if(typeof i>"u")i=[];else if(tN(i,e)>=0)return"[Circular]";function h(U,G,V){if(G&&(i=g8.call(i),i.push(G)),V){var $={depth:a.depth};return ju(a,"quoteStyle")&&($.quoteStyle=a.quoteStyle),t(U,$,n+1,i)}return t(U,a,n+1,i)}if(typeof e=="function"&&!yA(e)){var p=C8(e),m=Rp(e,h);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(m.length>0?" { "+ho.call(m,", ")+" }":"")}if(eN(e)){var v=jf?el.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Qy.call(e);return typeof e=="object"&&!jf?Qh(v):v}if(O8(e)){for(var y="<"+fA.call(String(e.nodeName)),x=e.attributes||[],S=0;S<x.length;S++)y+=" "+x[S].name+"="+J2(b8(x[S].value),"double",a);return y+=">",e.childNodes&&e.childNodes.length&&(y+="..."),y+="</"+fA.call(String(e.nodeName))+">",y}if(e1(e)){if(e.length===0)return"[]";var b=Rp(e,h);return f&&!R8(b)?"["+t1(b,f)+"]":"[ "+ho.call(b,", ")+" ]"}if(w8(e)){var A=Rp(e,h);return!("cause"in Error.prototype)&&"cause"in e&&!Q2.call(e,"cause")?"{ ["+String(e)+"] "+ho.call(hA.call("[cause]: "+h(e.cause),A),", ")+" }":A.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+ho.call(A,", ")+" }"}if(typeof e=="object"&&s){if(gA&&typeof e[gA]=="function"&&Jy)return Jy(e,{depth:c-n});if(s!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(T8(e)){var E=[];return uA&&uA.call(e,function(U,G){E.push(h(G,e,!0)+" => "+h(U,e))}),bA("Map",Zm.call(e),E,f)}if(I8(e)){var _=[];return lA&&lA.call(e,function(U){_.push(h(U,e))}),bA("Set",Qm.call(e),_,f)}if(N8(e))return M0("WeakMap");if(F8(e))return M0("WeakSet");if(M8(e))return M0("WeakRef");if(A8(e))return Qh(h(Number(e)));if(S8(e))return Qh(h(Zy.call(e)));if(E8(e))return Qh(h8.call(e));if(_8(e))return Qh(h(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===Qn)return"{ [object globalThis] }";if(!x8(e)&&!yA(e)){var T=Rp(e,h),M=pA?pA(e)===Object.prototype:e instanceof Object||e.constructor===Object,N=e instanceof Object?"":"null prototype",I=!M&&Bi&&Object(e)===e&&Bi in e?Ab.call(yl(e),8,-1):N?"Object":"",F=M||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",P=F+(I||N?"["+ho.call(hA.call([],I||[],N||[]),": ")+"] ":"");return T.length===0?P+"{}":f?P+"{"+t1(T,f)+"}":P+"{ "+ho.call(T,", ")+" }"}return String(e)};function J2(t,e,r){var n=(r.quoteStyle||e)==="double"?'"':"'";return n+t+n}function b8(t){return el.call(String(t),/"/g,"&quot;")}function e1(t){return yl(t)==="[object Array]"&&(!Bi||!(typeof t=="object"&&Bi in t))}function x8(t){return yl(t)==="[object Date]"&&(!Bi||!(typeof t=="object"&&Bi in t))}function yA(t){return yl(t)==="[object RegExp]"&&(!Bi||!(typeof t=="object"&&Bi in t))}function w8(t){return yl(t)==="[object Error]"&&(!Bi||!(typeof t=="object"&&Bi in t))}function _8(t){return yl(t)==="[object String]"&&(!Bi||!(typeof t=="object"&&Bi in t))}function A8(t){return yl(t)==="[object Number]"&&(!Bi||!(typeof t=="object"&&Bi in t))}function E8(t){return yl(t)==="[object Boolean]"&&(!Bi||!(typeof t=="object"&&Bi in t))}function eN(t){if(jf)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Qy)return!1;try{return Qy.call(t),!0}catch{}return!1}function S8(t){if(!t||typeof t!="object"||!Zy)return!1;try{return Zy.call(t),!0}catch{}return!1}var D8=Object.prototype.hasOwnProperty||function(t){return t in this};function ju(t,e){return D8.call(t,e)}function yl(t){return d8.call(t)}function C8(t){if(t.name)return t.name;var e=m8.call(p8.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function tN(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function T8(t){if(!Zm||!t||typeof t!="object")return!1;try{Zm.call(t);try{Qm.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function N8(t){if(!md||!t||typeof t!="object")return!1;try{md.call(t,md);try{vd.call(t,vd)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function M8(t){if(!cA||!t||typeof t!="object")return!1;try{return cA.call(t),!0}catch{}return!1}function I8(t){if(!Qm||!t||typeof t!="object")return!1;try{Qm.call(t);try{Zm.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function F8(t){if(!vd||!t||typeof t!="object")return!1;try{vd.call(t,vd);try{md.call(t,md)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function O8(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function rN(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return rN(Ab.call(t,0,e.maxStringLength),e)+n}var i=el.call(el.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,B8);return J2(i,"single",e)}function B8(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+v8.call(e.toString(16))}function Qh(t){return"Object("+t+")"}function M0(t){return t+" { ? }"}function bA(t,e,r,n){var i=n?t1(r,n):ho.call(r,", ");return t+" ("+e+") {"+i+"}"}function R8(t){for(var e=0;e<t.length;e++)if(tN(t[e],`
`)>=0)return!1;return!0}function P8(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=ho.call(Array(t.indent+1)," ");else return null;return{base:r,prev:ho.call(Array(e+1),r)}}function t1(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+ho.call(t,","+r)+`
`+e.prev}function Rp(t,e){var r=e1(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=ju(t,i)?e(t[i],t):""}var a=typeof N0=="function"?N0(t):[],s;if(jf){s={};for(var o=0;o<a.length;o++)s["$"+a[o]]=a[o]}for(var l in t)ju(t,l)&&(r&&String(Number(l))===l&&l<t.length||jf&&s["$"+l]instanceof Symbol||(Z2.call(/[^\w$]/,l)?n.push(e(l,t)+": "+e(t[l],t)):n.push(l+": "+e(t[l],t))));if(typeof N0=="function")for(var u=0;u<a.length;u++)Q2.call(t,a[u])&&n.push("["+e(a[u])+"]: "+e(t[a[u]],t));return n}var nN=vh,gh=s8,$8=y8,k8=Pd,Pp=nN("%WeakMap%",!0),$p=nN("%Map%",!0),L8=gh("WeakMap.prototype.get",!0),U8=gh("WeakMap.prototype.set",!0),z8=gh("WeakMap.prototype.has",!0),G8=gh("Map.prototype.get",!0),q8=gh("Map.prototype.set",!0),H8=gh("Map.prototype.has",!0),Eb=function(t,e){for(var r=t,n;(n=r.next)!==null;r=n)if(n.key===e)return r.next=n.next,n.next=t.next,t.next=n,n},W8=function(t,e){var r=Eb(t,e);return r&&r.value},V8=function(t,e,r){var n=Eb(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},X8=function(t,e){return!!Eb(t,e)},j8=function(){var e,r,n,i={assert:function(a){if(!i.has(a))throw new k8("Side channel does not contain "+$8(a))},get:function(a){if(Pp&&a&&(typeof a=="object"||typeof a=="function")){if(e)return L8(e,a)}else if($p){if(r)return G8(r,a)}else if(n)return W8(n,a)},has:function(a){if(Pp&&a&&(typeof a=="object"||typeof a=="function")){if(e)return z8(e,a)}else if($p){if(r)return H8(r,a)}else if(n)return X8(n,a);return!1},set:function(a,s){Pp&&a&&(typeof a=="object"||typeof a=="function")?(e||(e=new Pp),U8(e,a,s)):$p?(r||(r=new $p),q8(r,a,s)):(n||(n={key:{},next:null}),V8(n,a,s))}};return i},Y8=String.prototype.replace,K8=/%20/g,I0={RFC1738:"RFC1738",RFC3986:"RFC3986"},Sb={default:I0.RFC3986,formatters:{RFC1738:function(t){return Y8.call(t,K8,"+")},RFC3986:function(t){return String(t)}},RFC1738:I0.RFC1738,RFC3986:I0.RFC3986},Z8=Sb,F0=Object.prototype.hasOwnProperty,oc=Array.isArray,oo=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),Q8=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(oc(n)){for(var i=[],a=0;a<n.length;++a)typeof n[a]<"u"&&i.push(n[a]);r.obj[r.prop]=i}}},iN=function(e,r){for(var n=r&&r.plainObjects?Object.create(null):{},i=0;i<e.length;++i)typeof e[i]<"u"&&(n[i]=e[i]);return n},J8=function t(e,r,n){if(!r)return e;if(typeof r!="object"){if(oc(e))e.push(r);else if(e&&typeof e=="object")(n&&(n.plainObjects||n.allowPrototypes)||!F0.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object")return[e].concat(r);var i=e;return oc(e)&&!oc(r)&&(i=iN(e,n)),oc(e)&&oc(r)?(r.forEach(function(a,s){if(F0.call(e,s)){var o=e[s];o&&typeof o=="object"&&a&&typeof a=="object"?e[s]=t(o,a,n):e.push(a)}else e[s]=a}),e):Object.keys(r).reduce(function(a,s){var o=r[s];return F0.call(a,s)?a[s]=t(a[s],o,n):a[s]=o,a},i)},eL=function(e,r){return Object.keys(r).reduce(function(n,i){return n[i]=r[i],n},e)},tL=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},O0=1024,rL=function(e,r,n,i,a){if(e.length===0)return e;var s=e;if(typeof e=="symbol"?s=Symbol.prototype.toString.call(e):typeof e!="string"&&(s=String(e)),n==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(p){return"%26%23"+parseInt(p.slice(2),16)+"%3B"});for(var o="",l=0;l<s.length;l+=O0){for(var u=s.length>=O0?s.slice(l,l+O0):s,c=[],f=0;f<u.length;++f){var h=u.charCodeAt(f);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||a===Z8.RFC1738&&(h===40||h===41)){c[c.length]=u.charAt(f);continue}if(h<128){c[c.length]=oo[h];continue}if(h<2048){c[c.length]=oo[192|h>>6]+oo[128|h&63];continue}if(h<55296||h>=57344){c[c.length]=oo[224|h>>12]+oo[128|h>>6&63]+oo[128|h&63];continue}f+=1,h=65536+((h&1023)<<10|u.charCodeAt(f)&1023),c[c.length]=oo[240|h>>18]+oo[128|h>>12&63]+oo[128|h>>6&63]+oo[128|h&63]}o+=c.join("")}return o},nL=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],i=0;i<r.length;++i)for(var a=r[i],s=a.obj[a.prop],o=Object.keys(s),l=0;l<o.length;++l){var u=o[l],c=s[u];typeof c=="object"&&c!==null&&n.indexOf(c)===-1&&(r.push({obj:s,prop:u}),n.push(c))}return Q8(r),e},iL=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},aL=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},sL=function(e,r){return[].concat(e,r)},oL=function(e,r){if(oc(e)){for(var n=[],i=0;i<e.length;i+=1)n.push(r(e[i]));return n}return r(e)},aN={arrayToObject:iN,assign:eL,combine:sL,compact:nL,decode:tL,encode:rL,isBuffer:aL,isRegExp:iL,maybeMap:oL,merge:J8},sN=j8,Om=aN,gd=Sb,uL=Object.prototype.hasOwnProperty,oN={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},lo=Array.isArray,lL=Array.prototype.push,uN=function(t,e){lL.apply(t,lo(e)?e:[e])},cL=Date.prototype.toISOString,xA=gd.default,Xn={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Om.encode,encodeValuesOnly:!1,format:xA,formatter:gd.formatters[xA],indices:!1,serializeDate:function(e){return cL.call(e)},skipNulls:!1,strictNullHandling:!1},fL=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},B0={},hL=function t(e,r,n,i,a,s,o,l,u,c,f,h,p,m,v,y,x,S){for(var b=e,A=S,E=0,_=!1;(A=A.get(B0))!==void 0&&!_;){var T=A.get(e);if(E+=1,typeof T<"u"){if(T===E)throw new RangeError("Cyclic object value");_=!0}typeof A.get(B0)>"u"&&(E=0)}if(typeof c=="function"?b=c(r,b):b instanceof Date?b=p(b):n==="comma"&&lo(b)&&(b=Om.maybeMap(b,function(z){return z instanceof Date?p(z):z})),b===null){if(s)return u&&!y?u(r,Xn.encoder,x,"key",m):r;b=""}if(fL(b)||Om.isBuffer(b)){if(u){var M=y?r:u(r,Xn.encoder,x,"key",m);return[v(M)+"="+v(u(b,Xn.encoder,x,"value",m))]}return[v(r)+"="+v(String(b))]}var N=[];if(typeof b>"u")return N;var I;if(n==="comma"&&lo(b))y&&u&&(b=Om.maybeMap(b,u)),I=[{value:b.length>0?b.join(",")||null:void 0}];else if(lo(c))I=c;else{var F=Object.keys(b);I=f?F.sort(f):F}var P=l?r.replace(/\./g,"%2E"):r,U=i&&lo(b)&&b.length===1?P+"[]":P;if(a&&lo(b)&&b.length===0)return U+"[]";for(var G=0;G<I.length;++G){var V=I[G],$=typeof V=="object"&&typeof V.value<"u"?V.value:b[V];if(!(o&&$===null)){var j=h&&l?V.replace(/\./g,"%2E"):V,k=lo(b)?typeof n=="function"?n(U,j):U:U+(h?"."+j:"["+j+"]");S.set(e,E);var Z=sN();Z.set(B0,S),uN(N,t($,k,n,i,a,s,o,l,n==="comma"&&y&&lo(b)?null:u,c,f,h,p,m,v,y,x,Z))}}return N},dL=function(e){if(!e)return Xn;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||Xn.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=gd.default;if(typeof e.format<"u"){if(!uL.call(gd.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var i=gd.formatters[n],a=Xn.filter;(typeof e.filter=="function"||lo(e.filter))&&(a=e.filter);var s;if(e.arrayFormat in oN?s=e.arrayFormat:"indices"in e?s=e.indices?"indices":"repeat":s=Xn.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var o=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Xn.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Xn.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Xn.allowEmptyArrays,arrayFormat:s,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Xn.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Xn.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Xn.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Xn.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Xn.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Xn.encodeValuesOnly,filter:a,format:n,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Xn.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Xn.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Xn.strictNullHandling}},pL=function(t,e){var r=t,n=dL(e),i,a;typeof n.filter=="function"?(a=n.filter,r=a("",r)):lo(n.filter)&&(a=n.filter,i=a);var s=[];if(typeof r!="object"||r===null)return"";var o=oN[n.arrayFormat],l=o==="comma"&&n.commaRoundTrip;i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var u=sN(),c=0;c<i.length;++c){var f=i[c];n.skipNulls&&r[f]===null||uN(s,hL(r[f],f,o,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,u))}var h=s.join(n.delimiter),p=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),h.length>0?p+h:""},Yf=aN,r1=Object.prototype.hasOwnProperty,mL=Array.isArray,Bn={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:Yf.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},vL=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},lN=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},gL="utf8=%26%2310003%3B",yL="utf8=%E2%9C%93",bL=function(e,r){var n={__proto__:null},i=r.ignoreQueryPrefix?e.replace(/^\?/,""):e,a=r.parameterLimit===1/0?void 0:r.parameterLimit,s=i.split(r.delimiter,a),o=-1,l,u=r.charset;if(r.charsetSentinel)for(l=0;l<s.length;++l)s[l].indexOf("utf8=")===0&&(s[l]===yL?u="utf-8":s[l]===gL&&(u="iso-8859-1"),o=l,l=s.length);for(l=0;l<s.length;++l)if(l!==o){var c=s[l],f=c.indexOf("]="),h=f===-1?c.indexOf("="):f+1,p,m;h===-1?(p=r.decoder(c,Bn.decoder,u,"key"),m=r.strictNullHandling?null:""):(p=r.decoder(c.slice(0,h),Bn.decoder,u,"key"),m=Yf.maybeMap(lN(c.slice(h+1),r),function(y){return r.decoder(y,Bn.decoder,u,"value")})),m&&r.interpretNumericEntities&&u==="iso-8859-1"&&(m=vL(m)),c.indexOf("[]=")>-1&&(m=mL(m)?[m]:m);var v=r1.call(n,p);v&&r.duplicates==="combine"?n[p]=Yf.combine(n[p],m):(!v||r.duplicates==="last")&&(n[p]=m)}return n},xL=function(t,e,r,n){for(var i=n?e:lN(e,r),a=t.length-1;a>=0;--a){var s,o=t[a];if(o==="[]"&&r.parseArrays)s=r.allowEmptyArrays&&i===""?[]:[].concat(i);else{s=r.plainObjects?Object.create(null):{};var l=o.charAt(0)==="["&&o.charAt(o.length-1)==="]"?o.slice(1,-1):o,u=r.decodeDotInKeys?l.replace(/%2E/g,"."):l,c=parseInt(u,10);!r.parseArrays&&u===""?s={0:i}:!isNaN(c)&&o!==u&&String(c)===u&&c>=0&&r.parseArrays&&c<=r.arrayLimit?(s=[],s[c]=i):u!=="__proto__"&&(s[u]=i)}i=s}return i},wL=function(e,r,n,i){if(e){var a=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,s=/(\[[^[\]]*])/,o=/(\[[^[\]]*])/g,l=n.depth>0&&s.exec(a),u=l?a.slice(0,l.index):a,c=[];if(u){if(!n.plainObjects&&r1.call(Object.prototype,u)&&!n.allowPrototypes)return;c.push(u)}for(var f=0;n.depth>0&&(l=o.exec(a))!==null&&f<n.depth;){if(f+=1,!n.plainObjects&&r1.call(Object.prototype,l[1].slice(1,-1))&&!n.allowPrototypes)return;c.push(l[1])}return l&&c.push("["+a.slice(l.index)+"]"),xL(c,r,n,i)}},_L=function(e){if(!e)return Bn;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=typeof e.charset>"u"?Bn.charset:e.charset,n=typeof e.duplicates>"u"?Bn.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:Bn.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Bn.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Bn.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Bn.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Bn.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Bn.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Bn.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:Bn.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:Bn.decoder,delimiter:typeof e.delimiter=="string"||Yf.isRegExp(e.delimiter)?e.delimiter:Bn.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Bn.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Bn.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Bn.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Bn.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Bn.strictNullHandling}},AL=function(t,e){var r=_L(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?Object.create(null):{};for(var n=typeof t=="string"?bL(t,r):t,i=r.plainObjects?Object.create(null):{},a=Object.keys(n),s=0;s<a.length;++s){var o=a[s],l=wL(o,n[o],r,typeof t=="string");i=Yf.merge(i,l,r)}return r.allowSparse===!0?i:Yf.compact(i)},EL=pL,SL=AL,DL=Sb,CL={formats:DL,parse:SL,stringify:EL},TL=ck;function Ps(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var NL=/^([a-z0-9.+-]+:)/i,ML=/:[0-9]*$/,IL=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,FL=["<",">",'"',"`"," ","\r",`
`,"	"],OL=["{","}","|","\\","^","`"].concat(FL),n1=["'"].concat(OL),wA=["%","/","?",";","#"].concat(n1),_A=["/","?","#"],BL=255,AA=/^[+a-z0-9A-Z_-]{0,63}$/,RL=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,PL={javascript:!0,"javascript:":!0},i1={javascript:!0,"javascript:":!0},kf={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},a1=CL;function Wv(t,e,r){if(t&&typeof t=="object"&&t instanceof Ps)return t;var n=new Ps;return n.parse(t,e,r),n}Ps.prototype.parse=function(t,e,r){if(typeof t!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=n!==-1&&n<t.indexOf("#")?"?":"#",a=t.split(i),s=/\\/g;a[0]=a[0].replace(s,"/"),t=a.join(i);var o=t;if(o=o.trim(),!r&&t.split("#").length===1){var l=IL.exec(o);if(l)return this.path=o,this.href=o,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=a1.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=NL.exec(o);if(u){u=u[0];var c=u.toLowerCase();this.protocol=c,o=o.substr(u.length)}if(r||u||o.match(/^\/\/[^@/]+@[^@/]+/)){var f=o.substr(0,2)==="//";f&&!(u&&i1[u])&&(o=o.substr(2),this.slashes=!0)}if(!i1[u]&&(f||u&&!kf[u])){for(var h=-1,p=0;p<_A.length;p++){var m=o.indexOf(_A[p]);m!==-1&&(h===-1||m<h)&&(h=m)}var v,y;h===-1?y=o.lastIndexOf("@"):y=o.lastIndexOf("@",h),y!==-1&&(v=o.slice(0,y),o=o.slice(y+1),this.auth=decodeURIComponent(v)),h=-1;for(var p=0;p<wA.length;p++){var m=o.indexOf(wA[p]);m!==-1&&(h===-1||m<h)&&(h=m)}h===-1&&(h=o.length),this.host=o.slice(0,h),o=o.slice(h),this.parseHost(),this.hostname=this.hostname||"";var x=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!x)for(var S=this.hostname.split(/\./),p=0,b=S.length;p<b;p++){var A=S[p];if(A&&!A.match(AA)){for(var E="",_=0,T=A.length;_<T;_++)A.charCodeAt(_)>127?E+="x":E+=A[_];if(!E.match(AA)){var M=S.slice(0,p),N=S.slice(p+1),I=A.match(RL);I&&(M.push(I[1]),N.unshift(I[2])),N.length&&(o="/"+N.join(".")+o),this.hostname=M.join(".");break}}}this.hostname.length>BL?this.hostname="":this.hostname=this.hostname.toLowerCase(),x||(this.hostname=TL.toASCII(this.hostname));var F=this.port?":"+this.port:"",P=this.hostname||"";this.host=P+F,this.href+=this.host,x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),o[0]!=="/"&&(o="/"+o))}if(!PL[c])for(var p=0,b=n1.length;p<b;p++){var U=n1[p];if(o.indexOf(U)!==-1){var G=encodeURIComponent(U);G===U&&(G=escape(U)),o=o.split(U).join(G)}}var V=o.indexOf("#");V!==-1&&(this.hash=o.substr(V),o=o.slice(0,V));var $=o.indexOf("?");if($!==-1?(this.search=o.substr($),this.query=o.substr($+1),e&&(this.query=a1.parse(this.query)),o=o.slice(0,$)):e&&(this.search="",this.query={}),o&&(this.pathname=o),kf[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var F=this.pathname||"",j=this.search||"";this.path=F+j}return this.href=this.format(),this};function $L(t){return typeof t=="string"&&(t=Wv(t)),t instanceof Ps?t.format():Ps.prototype.format.call(t)}Ps.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,a="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(a=a1.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var s=this.search||a&&"?"+a||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||kf[e])&&i!==!1?(i="//"+(i||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):i||(i=""),n&&n.charAt(0)!=="#"&&(n="#"+n),s&&s.charAt(0)!=="?"&&(s="?"+s),r=r.replace(/[?#]/g,function(o){return encodeURIComponent(o)}),s=s.replace("#","%23"),e+i+r+s+n};function kL(t,e){return Wv(t,!1,!0).resolve(e)}Ps.prototype.resolve=function(t){return this.resolveObject(Wv(t,!1,!0)).format()};Ps.prototype.resolveObject=function(t){if(typeof t=="string"){var e=new Ps;e.parse(t,!1,!0),t=e}for(var r=new Ps,n=Object.keys(this),i=0;i<n.length;i++){var a=n[i];r[a]=this[a]}if(r.hash=t.hash,t.href==="")return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var s=Object.keys(t),o=0;o<s.length;o++){var l=s[o];l!=="protocol"&&(r[l]=t[l])}return kf[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!kf[t.protocol]){for(var u=Object.keys(t),c=0;c<u.length;c++){var f=u[c];r[f]=t[f]}return r.href=r.format(),r}if(r.protocol=t.protocol,!t.host&&!i1[t.protocol]){for(var b=(t.pathname||"").split("/");b.length&&!(t.host=b.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),b[0]!==""&&b.unshift(""),b.length<2&&b.unshift(""),r.pathname=b.join("/")}else r.pathname=t.pathname;if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var h=r.pathname||"",p=r.search||"";r.path=h+p}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var m=r.pathname&&r.pathname.charAt(0)==="/",v=t.host||t.pathname&&t.pathname.charAt(0)==="/",y=v||m||r.host&&t.pathname,x=y,S=r.pathname&&r.pathname.split("/")||[],b=t.pathname&&t.pathname.split("/")||[],A=r.protocol&&!kf[r.protocol];if(A&&(r.hostname="",r.port=null,r.host&&(S[0]===""?S[0]=r.host:S.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(b[0]===""?b[0]=t.host:b.unshift(t.host)),t.host=null),y=y&&(b[0]===""||S[0]==="")),v)r.host=t.host||t.host===""?t.host:r.host,r.hostname=t.hostname||t.hostname===""?t.hostname:r.hostname,r.search=t.search,r.query=t.query,S=b;else if(b.length)S||(S=[]),S.pop(),S=S.concat(b),r.search=t.search,r.query=t.query;else if(t.search!=null){if(A){r.host=S.shift(),r.hostname=r.host;var E=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;E&&(r.auth=E.shift(),r.hostname=E.shift(),r.host=r.hostname)}return r.search=t.search,r.query=t.query,(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!S.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var _=S.slice(-1)[0],T=(r.host||t.host||S.length>1)&&(_==="."||_==="..")||_==="",M=0,N=S.length;N>=0;N--)_=S[N],_==="."?S.splice(N,1):_===".."?(S.splice(N,1),M++):M&&(S.splice(N,1),M--);if(!y&&!x)for(;M--;M)S.unshift("..");y&&S[0]!==""&&(!S[0]||S[0].charAt(0)!=="/")&&S.unshift(""),T&&S.join("/").substr(-1)!=="/"&&S.push("");var I=S[0]===""||S[0]&&S[0].charAt(0)==="/";if(A){r.hostname=I?"":S.length?S.shift():"",r.host=r.hostname;var E=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;E&&(r.auth=E.shift(),r.hostname=E.shift(),r.host=r.hostname)}return y=y||r.host&&S.length,y&&!I&&S.unshift(""),S.length>0?r.pathname=S.join("/"):(r.pathname=null,r.path=null),(r.pathname!==null||r.search!==null)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r};Ps.prototype.parseHost=function(){var t=this.host,e=ML.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var LL=Wv,UL=kL,zL=$L;const GL={parse:LL,format:zL,resolve:UL};function Ss(t){if(typeof t!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function Jh(t){return t.split("?")[0].split("#")[0]}function qL(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function HL(t,e,r){return t.replace(new RegExp(qL(e),"g"),r)}function WL(t,e){let r="",n=0,i=-1,a=0,s=-1;for(let o=0;o<=t.length;++o){if(o<t.length)s=t.charCodeAt(o);else{if(s===47)break;s=47}if(s===47){if(!(i===o-1||a===1))if(i!==o-1&&a===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",n=0):(r=r.slice(0,l),n=r.length-1-r.lastIndexOf("/")),i=o,a=0;continue}}else if(r.length===2||r.length===1){r="",n=0,i=o,a=0;continue}}}else r.length>0?r+=`/${t.slice(i+1,o)}`:r=t.slice(i+1,o),n=o-i-1;i=o,a=0}else s===46&&a!==-1?++a:a=-1}return r}const xi={toPosix(t){return HL(t,"\\","/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},hasProtocol(t){return/^[^/:]+:\//.test(this.toPosix(t))},getProtocol(t){Ss(t),t=this.toPosix(t);let e="";const r=/^file:\/\/\//.exec(t),n=/^[^/:]+:\/\//.exec(t),i=/^[^/:]+:\//.exec(t);if(r||n||i){const a=(r==null?void 0:r[0])||(n==null?void 0:n[0])||(i==null?void 0:i[0]);e=a,t=t.slice(a.length)}return e},toAbsolute(t,e,r){if(this.isDataUrl(t))return t;const n=Jh(this.toPosix(e??Nt.ADAPTER.getBaseUrl())),i=Jh(this.toPosix(r??this.rootname(n)));return Ss(t),t=this.toPosix(t),t.startsWith("/")?xi.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(n,t)},normalize(t){if(t=this.toPosix(t),Ss(t),t.length===0)return".";let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const n=t.endsWith("/");return t=WL(t),t.length>0&&n&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return Ss(t),t=this.toPosix(t),this.hasProtocol(t)?!0:t.startsWith("/")},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){const n=t[r];if(Ss(n),n.length>0)if(e===void 0)e=n;else{const i=t[r-1]??"";this.extname(i)?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(t){if(Ss(t),t.length===0)return".";t=this.toPosix(t);let e=t.charCodeAt(0);const r=e===47;let n=-1,i=!0;const a=this.getProtocol(t),s=t;t=t.slice(a.length);for(let o=t.length-1;o>=1;--o)if(e=t.charCodeAt(o),e===47){if(!i){n=o;break}}else i=!1;return n===-1?r?"/":this.isUrl(s)?a+t:a:r&&n===1?"//":a+t.slice(0,n)},rootname(t){Ss(t),t=this.toPosix(t);let e="";if(t.startsWith("/")?e="/":e=this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);r!==-1?e=t.slice(0,r):e=t,e.endsWith("/")||(e+="/")}return e},basename(t,e){Ss(t),e&&Ss(e),t=Jh(this.toPosix(t));let r=0,n=-1,i=!0,a;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let s=e.length-1,o=-1;for(a=t.length-1;a>=0;--a){const l=t.charCodeAt(a);if(l===47){if(!i){r=a+1;break}}else o===-1&&(i=!1,o=a+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=a):(s=-1,n=o))}return r===n?n=o:n===-1&&(n=t.length),t.slice(r,n)}for(a=t.length-1;a>=0;--a)if(t.charCodeAt(a)===47){if(!i){r=a+1;break}}else n===-1&&(i=!1,n=a+1);return n===-1?"":t.slice(r,n)},extname(t){Ss(t),t=Jh(this.toPosix(t));let e=-1,r=0,n=-1,i=!0,a=0;for(let s=t.length-1;s>=0;--s){const o=t.charCodeAt(s);if(o===47){if(!i){r=s+1;break}continue}n===-1&&(i=!1,n=s+1),o===46?e===-1?e=s:a!==1&&(a=1):e!==-1&&(a=-1)}return e===-1||n===-1||a===0||a===1&&e===n-1&&e===r+1?"":t.slice(e,n)},parse(t){Ss(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;t=Jh(this.toPosix(t));let r=t.charCodeAt(0);const n=this.isAbsolute(t);let i;e.root=this.rootname(t),n||this.hasProtocol(t)?i=1:i=0;let a=-1,s=0,o=-1,l=!0,u=t.length-1,c=0;for(;u>=i;--u){if(r=t.charCodeAt(u),r===47){if(!l){s=u+1;break}continue}o===-1&&(l=!1,o=u+1),r===46?a===-1?a=u:c!==1&&(c=1):a!==-1&&(c=-1)}return a===-1||o===-1||c===0||c===1&&a===o-1&&a===s+1?o!==-1&&(s===0&&n?e.base=e.name=t.slice(1,o):e.base=e.name=t.slice(s,o)):(s===0&&n?(e.name=t.slice(1,a),e.base=t.slice(1,o)):(e.name=t.slice(s,a),e.base=t.slice(s,o)),e.ext=t.slice(a,o)),e.dir=this.dirname(t),e},sep:"/",delimiter:":"},EA={};function qr(t,e,r=3){if(EA[e])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`):(n=n.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${t}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${t}`),console.warn(n))),EA[e]=!0}let R0;function VL(){return typeof R0>"u"&&(R0=function(){var r;const e={stencil:!0,failIfMajorPerformanceCaveat:Nt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!Nt.ADAPTER.getWebGLRenderingContext())return!1;const n=Nt.ADAPTER.createCanvas();let i=n.getContext("webgl",e)||n.getContext("experimental-webgl",e);const a=!!((r=i==null?void 0:i.getContextAttributes())!=null&&r.stencil);if(i){const s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,a}catch{return!1}}()),R0}var XL="#f0f8ff",jL="#faebd7",YL="#00ffff",KL="#7fffd4",ZL="#f0ffff",QL="#f5f5dc",JL="#ffe4c4",e6="#000000",t6="#ffebcd",r6="#0000ff",n6="#8a2be2",i6="#a52a2a",a6="#deb887",s6="#5f9ea0",o6="#7fff00",u6="#d2691e",l6="#ff7f50",c6="#6495ed",f6="#fff8dc",h6="#dc143c",d6="#00ffff",p6="#00008b",m6="#008b8b",v6="#b8860b",g6="#a9a9a9",y6="#006400",b6="#a9a9a9",x6="#bdb76b",w6="#8b008b",_6="#556b2f",A6="#ff8c00",E6="#9932cc",S6="#8b0000",D6="#e9967a",C6="#8fbc8f",T6="#483d8b",N6="#2f4f4f",M6="#2f4f4f",I6="#00ced1",F6="#9400d3",O6="#ff1493",B6="#00bfff",R6="#696969",P6="#696969",$6="#1e90ff",k6="#b22222",L6="#fffaf0",U6="#228b22",z6="#ff00ff",G6="#dcdcdc",q6="#f8f8ff",H6="#daa520",W6="#ffd700",V6="#808080",X6="#008000",j6="#adff2f",Y6="#808080",K6="#f0fff0",Z6="#ff69b4",Q6="#cd5c5c",J6="#4b0082",eU="#fffff0",tU="#f0e68c",rU="#fff0f5",nU="#e6e6fa",iU="#7cfc00",aU="#fffacd",sU="#add8e6",oU="#f08080",uU="#e0ffff",lU="#fafad2",cU="#d3d3d3",fU="#90ee90",hU="#d3d3d3",dU="#ffb6c1",pU="#ffa07a",mU="#20b2aa",vU="#87cefa",gU="#778899",yU="#778899",bU="#b0c4de",xU="#ffffe0",wU="#00ff00",_U="#32cd32",AU="#faf0e6",EU="#ff00ff",SU="#800000",DU="#66cdaa",CU="#0000cd",TU="#ba55d3",NU="#9370db",MU="#3cb371",IU="#7b68ee",FU="#00fa9a",OU="#48d1cc",BU="#c71585",RU="#191970",PU="#f5fffa",$U="#ffe4e1",kU="#ffe4b5",LU="#ffdead",UU="#000080",zU="#fdf5e6",GU="#808000",qU="#6b8e23",HU="#ffa500",WU="#ff4500",VU="#da70d6",XU="#eee8aa",jU="#98fb98",YU="#afeeee",KU="#db7093",ZU="#ffefd5",QU="#ffdab9",JU="#cd853f",e7="#ffc0cb",t7="#dda0dd",r7="#b0e0e6",n7="#800080",i7="#663399",a7="#ff0000",s7="#bc8f8f",o7="#4169e1",u7="#8b4513",l7="#fa8072",c7="#f4a460",f7="#2e8b57",h7="#fff5ee",d7="#a0522d",p7="#c0c0c0",m7="#87ceeb",v7="#6a5acd",g7="#708090",y7="#708090",b7="#fffafa",x7="#00ff7f",w7="#4682b4",_7="#d2b48c",A7="#008080",E7="#d8bfd8",S7="#ff6347",D7="#40e0d0",C7="#ee82ee",T7="#f5deb3",N7="#ffffff",M7="#f5f5f5",I7="#ffff00",F7="#9acd32",O7={aliceblue:XL,antiquewhite:jL,aqua:YL,aquamarine:KL,azure:ZL,beige:QL,bisque:JL,black:e6,blanchedalmond:t6,blue:r6,blueviolet:n6,brown:i6,burlywood:a6,cadetblue:s6,chartreuse:o6,chocolate:u6,coral:l6,cornflowerblue:c6,cornsilk:f6,crimson:h6,cyan:d6,darkblue:p6,darkcyan:m6,darkgoldenrod:v6,darkgray:g6,darkgreen:y6,darkgrey:b6,darkkhaki:x6,darkmagenta:w6,darkolivegreen:_6,darkorange:A6,darkorchid:E6,darkred:S6,darksalmon:D6,darkseagreen:C6,darkslateblue:T6,darkslategray:N6,darkslategrey:M6,darkturquoise:I6,darkviolet:F6,deeppink:O6,deepskyblue:B6,dimgray:R6,dimgrey:P6,dodgerblue:$6,firebrick:k6,floralwhite:L6,forestgreen:U6,fuchsia:z6,gainsboro:G6,ghostwhite:q6,goldenrod:H6,gold:W6,gray:V6,green:X6,greenyellow:j6,grey:Y6,honeydew:K6,hotpink:Z6,indianred:Q6,indigo:J6,ivory:eU,khaki:tU,lavenderblush:rU,lavender:nU,lawngreen:iU,lemonchiffon:aU,lightblue:sU,lightcoral:oU,lightcyan:uU,lightgoldenrodyellow:lU,lightgray:cU,lightgreen:fU,lightgrey:hU,lightpink:dU,lightsalmon:pU,lightseagreen:mU,lightskyblue:vU,lightslategray:gU,lightslategrey:yU,lightsteelblue:bU,lightyellow:xU,lime:wU,limegreen:_U,linen:AU,magenta:EU,maroon:SU,mediumaquamarine:DU,mediumblue:CU,mediumorchid:TU,mediumpurple:NU,mediumseagreen:MU,mediumslateblue:IU,mediumspringgreen:FU,mediumturquoise:OU,mediumvioletred:BU,midnightblue:RU,mintcream:PU,mistyrose:$U,moccasin:kU,navajowhite:LU,navy:UU,oldlace:zU,olive:GU,olivedrab:qU,orange:HU,orangered:WU,orchid:VU,palegoldenrod:XU,palegreen:jU,paleturquoise:YU,palevioletred:KU,papayawhip:ZU,peachpuff:QU,peru:JU,pink:e7,plum:t7,powderblue:r7,purple:n7,rebeccapurple:i7,red:a7,rosybrown:s7,royalblue:o7,saddlebrown:u7,salmon:l7,sandybrown:c7,seagreen:f7,seashell:h7,sienna:d7,silver:p7,skyblue:m7,slateblue:v7,slategray:g7,slategrey:y7,snow:b7,springgreen:x7,steelblue:w7,tan:_7,teal:A7,thistle:E7,tomato:S7,turquoise:D7,violet:C7,wheat:T7,white:N7,whitesmoke:M7,yellow:I7,yellowgreen:F7};function Sd(t,e=[]){return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(t&255)/255,e}function cN(t){let e=t.toString(16);return e="000000".substring(0,6-e.length)+e,`#${e}`}function Db(t){if(typeof t=="string"&&(t=O7[t.toLowerCase()]||t,t[0]==="#"&&(t=t.slice(1)),t.length===3)){const[e,r,n]=t;t=e+e+r+r+n+n}return parseInt(t,16)}function B7(){const t=[],e=[];for(let n=0;n<32;n++)t[n]=n,e[n]=n;t[Zt.NORMAL_NPM]=Zt.NORMAL,t[Zt.ADD_NPM]=Zt.ADD,t[Zt.SCREEN_NPM]=Zt.SCREEN,e[Zt.NORMAL]=Zt.NORMAL_NPM,e[Zt.ADD]=Zt.ADD_NPM,e[Zt.SCREEN]=Zt.SCREEN_NPM;const r=[];return r.push(e),r.push(t),r}const fN=B7();function hN(t,e){return fN[e?1:0][t]}function R7(t,e,r,n){return r=r||new Float32Array(4),n||n===void 0?(r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e):(r[0]=t[0],r[1]=t[1],r[2]=t[2]),r[3]=e,r}function Cb(t,e){if(e===1)return(e*255<<24)+t;if(e===0)return 0;let r=t>>16&255,n=t>>8&255,i=t&255;return r=r*e+.5|0,n=n*e+.5|0,i=i*e+.5|0,(e*255<<24)+(r<<16)+(n<<8)+i}function dN(t,e,r,n){return r=r||new Float32Array(4),r[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(t&255)/255,(n||n===void 0)&&(r[0]*=e,r[1]*=e,r[2]*=e),r[3]=e,r}function P7(t,e=null){const r=t*6;if(e=e||new Uint16Array(r),e.length!==r)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${r}`);for(let n=0,i=0;n<r;n+=6,i+=4)e[n+0]=i+0,e[n+1]=i+1,e[n+2]=i+2,e[n+3]=i+0,e[n+4]=i+2,e[n+5]=i+3;return e}function pN(t){if(t.BYTES_PER_ELEMENT===4)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(t.BYTES_PER_ELEMENT===2){if(t instanceof Uint16Array)return"Uint16Array"}else if(t.BYTES_PER_ELEMENT===1&&t instanceof Uint8Array)return"Uint8Array";return null}function Jm(t){return t+=t===0?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1}function SA(t){return!(t&t-1)&&!!t}function DA(t){let e=(t>65535?1:0)<<4;t>>>=e;let r=(t>255?1:0)<<3;return t>>>=r,e|=r,r=(t>15?1:0)<<2,t>>>=r,e|=r,r=(t>3?1:0)<<1,t>>>=r,e|=r,e|t>>1}function Lf(t,e,r){const n=t.length;let i;if(e>=n||r===0)return;r=e+r>n?n-e:r;const a=n-r;for(i=e;i<a;++i)t[i]=t[i+r];t.length=a}function Tf(t){return t===0?0:t<0?-1:1}let $7=0;function yc(){return++$7}const mN=class{constructor(t,e,r,n){this.left=t,this.top=e,this.right=r,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let s1=mN;s1.EMPTY=new mN(0,0,0,0);const CA={},uo=Object.create(null),qu=Object.create(null);class TA{constructor(e,r,n){this._canvas=Nt.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||Nt.RESOLUTION,this.resize(e,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,r){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function NA(t,e,r){for(let n=0,i=4*r*e;n<e;++n,i+=4)if(t[i+3]!==0)return!1;return!0}function MA(t,e,r,n,i){const a=4*e;for(let s=n,o=n*a+4*r;s<=i;++s,o+=a)if(t[o+3]!==0)return!1;return!0}function k7(t){const{width:e,height:r}=t,n=t.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const a=n.getImageData(0,0,e,r).data;let s=0,o=0,l=e-1,u=r-1;for(;o<r&&NA(a,e,o);)++o;if(o===r)return s1.EMPTY;for(;NA(a,e,u);)--u;for(;MA(a,e,s,o,u);)++s;for(;MA(a,e,l,o,u);)--l;return++l,++u,new s1(s,o,l,u)}function L7(t){const e=k7(t),{width:r,height:n}=e;let i=null;if(!e.isEmpty()){const a=t.getContext("2d");if(a===null)throw new TypeError("Failed to get canvas 2D context");i=a.getImageData(e.left,e.top,r,n)}return{width:r,height:n,data:i}}let kp;function U7(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location,kp||(kp=document.createElement("a")),kp.href=t;const r=GL.parse(kp.href),n=!r.port&&e.port===""||r.port===e.port;return r.hostname!==e.hostname||!n||r.protocol!==e.protocol?"anonymous":""}function ol(t,e=1){var n;const r=(n=Nt.RETINA_PREFIX)==null?void 0:n.exec(t);return r?parseFloat(r[1]):e}var Tt=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(Tt||{});const o1=t=>{if(typeof t=="function"||typeof t=="object"&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={...typeof t.extension!="object"?{type:t.extension}:t.extension,ref:t}}if(typeof t=="object")t={...t};else throw new Error("Invalid extension type");return typeof t.type=="string"&&(t.type=[t.type]),t},IA=(t,e)=>o1(t).priority??e,Lt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(o1).forEach(e=>{e.type.forEach(r=>{var n,i;return(i=(n=this._removeHandlers)[r])==null?void 0:i.call(n,e)})}),this},add(...t){return t.map(o1).forEach(e=>{e.type.forEach(r=>{const n=this._addHandlers,i=this._queue;n[r]?n[r](e):(i[r]=i[r]||[],i[r].push(e))})}),this},handle(t,e,r){const n=this._addHandlers,i=this._removeHandlers;if(n[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);n[t]=e,i[t]=r;const a=this._queue;return a[t]&&(a[t].forEach(s=>e(s)),delete a[t]),this},handleByMap(t,e){return this.handle(t,r=>{e[r.name]=r.ref},r=>{delete e[r.name]})},handleByList(t,e,r=-1){return this.handle(t,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((i,a)=>IA(a,r)-IA(i,r)))},n=>{const i=e.indexOf(n.ref);i!==-1&&e.splice(i,1)})}};class u1{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const z7=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function G7(t){let e="";for(let r=0;r<t;++r)r>0&&(e+=`
else `),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function q7(t,e){if(t===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);for(;;){const n=z7.replace(/%forloop%/gi,G7(t));if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))t=t/2|0;else break}return t}const P0=0,$0=1,k0=2,L0=3,U0=4,z0=5;class xu{constructor(){this.data=0,this.blendMode=Zt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<P0)}set blend(e){!!(this.data&1<<P0)!==e&&(this.data^=1<<P0)}get offsets(){return!!(this.data&1<<$0)}set offsets(e){!!(this.data&1<<$0)!==e&&(this.data^=1<<$0)}get culling(){return!!(this.data&1<<k0)}set culling(e){!!(this.data&1<<k0)!==e&&(this.data^=1<<k0)}get depthTest(){return!!(this.data&1<<L0)}set depthTest(e){!!(this.data&1<<L0)!==e&&(this.data^=1<<L0)}get depthMask(){return!!(this.data&1<<z0)}set depthMask(e){!!(this.data&1<<z0)!==e&&(this.data^=1<<z0)}get clockwiseFrontFace(){return!!(this.data&1<<U0)}set clockwiseFrontFace(e){!!(this.data&1<<U0)!==e&&(this.data^=1<<U0)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==Zt.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new xu;return e.depthTest=!1,e.blend=!0,e}}const l1=[];function vN(t,e){if(!t)return null;let r="";if(typeof t=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);n&&(r=n[1].toLowerCase())}for(let n=l1.length-1;n>=0;--n){const i=l1[n];if(i.test&&i.test(t,r))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class $s{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,r,n,i,a,s,o,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:c}=this;this._aliasCount++;for(let f=0,h=c.length;f<h;f++)c[f][u](e,r,n,i,a,s,o,l);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const r=this.items.indexOf(e);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties($s.prototype,{dispatch:{value:$s.prototype.emit},run:{value:$s.prototype.emit}});class Dd{constructor(e=0,r=0){this._width=e,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new $s("setRealSize"),this.onUpdate=new $s("update"),this.onError=new $s("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,r){(e!==this._width||r!==this._height)&&(this._width=e,this._height=r,this.onResize.emit(e,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,r,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,r){return!1}}class kd extends Dd{constructor(e,r){const{width:n,height:i}=r||{};if(!n||!i)throw new Error("BufferResource width or height invalid");super(n,i),this.data=e}upload(e,r,n){const i=e.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Us.UNPACK);const a=r.realWidth,s=r.realHeight;return n.width===a&&n.height===s?i.texSubImage2D(r.target,0,0,0,a,s,r.format,n.type,this.data):(n.width=a,n.height=s,i.texImage2D(r.target,0,n.internalFormat,a,s,0,r.format,n.type,this.data)),!0}dispose(){this.data=null}static test(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array}}const H7={scaleMode:ou.NEAREST,format:wt.RGBA,alphaMode:Us.NPM},Af=class extends Rd{constructor(t=null,e=null){super(),e=Object.assign({},Af.defaultOptions,e);const{alphaMode:r,mipmap:n,anisotropicLevel:i,scaleMode:a,width:s,height:o,wrapMode:l,format:u,type:c,target:f,resolution:h,resourceOptions:p}=e;t&&!(t instanceof Dd)&&(t=vN(t,p),t.internal=!0),this.resolution=h||Nt.RESOLUTION,this.width=Math.round((s||0)*this.resolution)/this.resolution,this.height=Math.round((o||0)*this.resolution)/this.resolution,this._mipmap=n,this.anisotropicLevel=i,this._wrapMode=l,this._scaleMode=a,this.format=u,this.type=c,this.target=f,this.alphaMode=r,this.uid=yc(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=s>0&&o>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let r;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this}setSize(t,e,r){return r=r||this.resolution,this.setRealSize(t*r,e*r,r)}setRealSize(t,e,r){return this.resolution=r||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=SA(this.realWidth)&&SA(this.realHeight)}setResolution(t){const e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete qu[this.cacheId],delete uo[this.cacheId],this.cacheId=null),this.dispose(),Af.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,r=Nt.STRICT_TEXTURE_CACHE){const n=typeof t=="string";let i=null;if(n)i=t;else{if(!t._pixiId){const s=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${s}_${yc()}`}i=t._pixiId}let a=qu[i];if(n&&r&&!a)throw new Error(`The cacheId "${i}" does not exist in BaseTextureCache.`);return a||(a=new Af(t,e),a.cacheId=i,Af.addToCache(a,i)),a}static fromBuffer(t,e,r,n){t=t||new Float32Array(e*r*4);const i=new kd(t,{width:e,height:r}),a=t instanceof Float32Array?Ht.FLOAT:Ht.UNSIGNED_BYTE;return new Af(i,Object.assign({},H7,n||{width:e,height:r,type:a}))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),qu[e]&&qu[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),qu[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=qu[t];if(e){const r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete qu[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete qu[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};let pr=Af;pr.defaultOptions={mipmap:xo.POW2,anisotropicLevel:0,scaleMode:ou.LINEAR,wrapMode:al.CLAMP,alphaMode:Us.UNPACK,target:Pf.TEXTURE_2D,format:wt.RGBA,type:Ht.UNSIGNED_BYTE};pr._globalBatch=0;class c1{constructor(){this.texArray=null,this.blend=0,this.type=po.TRIANGLES,this.start=0,this.size=0,this.data=null}}let W7=0;class Pn{constructor(e,r=!0,n=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=r,this.id=W7++,this.disposeRunner=new $s("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?vo.ELEMENT_ARRAY_BUFFER:vo.ARRAY_BUFFER}get index(){return this.type===vo.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new Pn(e)}}class ev{constructor(e,r=0,n=!1,i=Ht.FLOAT,a,s,o,l=1){this.buffer=e,this.size=r,this.normalized=n,this.type=i,this.stride=a,this.start=s,this.instance=o,this.divisor=l}destroy(){this.buffer=null}static from(e,r,n,i,a){return new ev(e,r,n,i,a)}}const V7={Float32Array,Uint32Array,Int32Array,Uint8Array};function X7(t,e){let r=0,n=0;const i={};for(let l=0;l<t.length;l++)n+=e[l],r+=t[l].length;const a=new ArrayBuffer(r*4);let s=null,o=0;for(let l=0;l<t.length;l++){const u=e[l],c=t[l],f=pN(c);i[f]||(i[f]=new V7[f](a)),s=i[f];for(let h=0;h<c.length;h++){const p=(h/u|0)*n+o,m=h%u;s[p+m]=c[h]}o+=u}return new Float32Array(a)}const FA={5126:4,5123:2,5121:1};let j7=0;const Y7={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class ul{constructor(e=[],r={}){this.buffers=e,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=j7++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new $s("disposeGeometry"),this.refCount=0}addAttribute(e,r,n=0,i=!1,a,s,o,l=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof Pn||(r instanceof Array&&(r=new Float32Array(r)),r=new Pn(r));const u=e.split("|");if(u.length>1){for(let f=0;f<u.length;f++)this.addAttribute(u[f],r,n,i,a);return this}let c=this.buffers.indexOf(r);return c===-1&&(this.buffers.push(r),c=this.buffers.length-1),this.attributes[e]=new ev(c,n,i,a,s,o,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof Pn||(e instanceof Array&&(e=new Uint16Array(e)),e=new Pn(e)),e.type=vo.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],r=[],n=new Pn;let i;for(i in this.attributes){const a=this.attributes[i],s=this.buffers[a.buffer];e.push(s.data),r.push(a.size*FA[a.type]/4),a.buffer=0}for(n.data=X7(e,r),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const r=this.attributes[e];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new ul;for(let r=0;r<this.buffers.length;r++)e.buffers[r]=new Pn(this.buffers[r].data.slice(0));for(const r in this.attributes){const n=this.attributes[r];e.attributes[r]=new ev(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=vo.ELEMENT_ARRAY_BUFFER),e}static merge(e){const r=new ul,n=[],i=[],a=[];let s;for(let o=0;o<e.length;o++){s=e[o];for(let l=0;l<s.buffers.length;l++)i[l]=i[l]||0,i[l]+=s.buffers[l].data.length,a[l]=0}for(let o=0;o<s.buffers.length;o++)n[o]=new Y7[pN(s.buffers[o].data)](i[o]),r.buffers[o]=new Pn(n[o]);for(let o=0;o<e.length;o++){s=e[o];for(let l=0;l<s.buffers.length;l++)n[l].set(s.buffers[l].data,a[l]),a[l]+=s.buffers[l].data.length}if(r.attributes=s.attributes,s.indexBuffer){r.indexBuffer=r.buffers[s.buffers.indexOf(s.indexBuffer)],r.indexBuffer.type=vo.ELEMENT_ARRAY_BUFFER;let o=0,l=0,u=0,c=0;for(let f=0;f<s.buffers.length;f++)if(s.buffers[f]!==s.indexBuffer){c=f;break}for(const f in s.attributes){const h=s.attributes[f];(h.buffer|0)===c&&(l+=h.size*FA[h.type]/4)}for(let f=0;f<e.length;f++){const h=e[f].indexBuffer.data;for(let p=0;p<h.length;p++)r.indexBuffer.data[p+u]+=o;o+=e[f].buffers[c].data.length/l,u+=h.length}}return r}}class gN extends ul{constructor(e=!1){super(),this._buffer=new Pn(null,e,!1),this._indexBuffer=new Pn(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Ht.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,Ht.FLOAT).addAttribute("aColor",this._buffer,4,!0,Ht.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Ht.FLOAT).addIndex(this._indexBuffer)}}const tv=Math.PI*2,K7=180/Math.PI,Z7=Math.PI/180;var gi=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(gi||{});class zr{constructor(e=0,r=0){this.x=0,this.y=0,this.x=e,this.y=r}clone(){return new zr(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,r=e){return this.x=e,this.y=r,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const Lp=[new zr,new zr,new zr,new zr];class Br{constructor(e=0,r=0,n=0,i=0){this.x=Number(e),this.y=Number(r),this.width=Number(n),this.height=Number(i),this.type=gi.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Br(0,0,0,0)}clone(){return new Br(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,r){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(e,r){if(!r){const M=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=M)return!1;const I=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>I}const n=this.left,i=this.right,a=this.top,s=this.bottom;if(i<=n||s<=a)return!1;const o=Lp[0].set(e.left,e.top),l=Lp[1].set(e.left,e.bottom),u=Lp[2].set(e.right,e.top),c=Lp[3].set(e.right,e.bottom);if(u.x<=o.x||l.y<=o.y)return!1;const f=Math.sign(r.a*r.d-r.b*r.c);if(f===0||(r.apply(o,o),r.apply(l,l),r.apply(u,u),r.apply(c,c),Math.max(o.x,l.x,u.x,c.x)<=n||Math.min(o.x,l.x,u.x,c.x)>=i||Math.max(o.y,l.y,u.y,c.y)<=a||Math.min(o.y,l.y,u.y,c.y)>=s))return!1;const h=f*(l.y-o.y),p=f*(o.x-l.x),m=h*n+p*a,v=h*i+p*a,y=h*n+p*s,x=h*i+p*s;if(Math.max(m,v,y,x)<=h*o.x+p*o.y||Math.min(m,v,y,x)>=h*c.x+p*c.y)return!1;const S=f*(o.y-u.y),b=f*(u.x-o.x),A=S*n+b*a,E=S*i+b*a,_=S*n+b*s,T=S*i+b*s;return!(Math.max(A,E,_,T)<=S*o.x+b*o.y||Math.min(A,E,_,T)>=S*c.x+b*c.y)}pad(e=0,r=e){return this.x-=e,this.y-=r,this.width+=e*2,this.height+=r*2,this}fit(e){const r=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),a=Math.min(this.y+this.height,e.y+e.height);return this.x=r,this.width=Math.max(n-r,0),this.y=i,this.height=Math.max(a-i,0),this}ceil(e=1,r=.001){const n=Math.ceil((this.x+this.width-r)*e)/e,i=Math.ceil((this.y+this.height-r)*e)/e;return this.x=Math.floor((this.x+r)*e)/e,this.y=Math.floor((this.y+r)*e)/e,this.width=n-this.x,this.height=i-this.y,this}enlarge(e){const r=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),a=Math.max(this.y+this.height,e.y+e.height);return this.x=r,this.width=n-r,this.y=i,this.height=a-i,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Tb{constructor(e=0,r=0,n=0){this.x=e,this.y=r,this.radius=n,this.type=gi.CIRC}clone(){return new Tb(this.x,this.y,this.radius)}contains(e,r){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-e,a=this.y-r;return i*=i,a*=a,i+a<=n}getBounds(){return new Br(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Nb{constructor(e=0,r=0,n=0,i=0){this.x=e,this.y=r,this.width=n,this.height=i,this.type=gi.ELIP}clone(){return new Nb(this.x,this.y,this.width,this.height)}contains(e,r){if(this.width<=0||this.height<=0)return!1;let n=(e-this.x)/this.width,i=(r-this.y)/this.height;return n*=n,i*=i,n+i<=1}getBounds(){return new Br(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Uf{constructor(...e){let r=Array.isArray(e[0])?e[0]:e;if(typeof r[0]!="number"){const n=[];for(let i=0,a=r.length;i<a;i++)n.push(r[i].x,r[i].y);r=n}this.points=r,this.type=gi.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),r=new Uf(e);return r.closeStroke=this.closeStroke,r}contains(e,r){let n=!1;const i=this.points.length/2;for(let a=0,s=i-1;a<i;s=a++){const o=this.points[a*2],l=this.points[a*2+1],u=this.points[s*2],c=this.points[s*2+1];l>r!=c>r&&e<(u-o)*((r-l)/(c-l))+o&&(n=!n)}return n}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((e,r)=>`${e}, ${r}`,"")}]`}}class Mb{constructor(e=0,r=0,n=0,i=0,a=20){this.x=e,this.y=r,this.width=n,this.height=i,this.radius=a,this.type=gi.RREC}clone(){return new Mb(this.x,this.y,this.width,this.height,this.radius)}contains(e,r){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+n&&r<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let i=e-(this.x+n),a=r-(this.y+n);const s=n*n;if(i*i+a*a<=s||(i=e-(this.x+this.width-n),i*i+a*a<=s)||(a=r-(this.y+this.height-n),i*i+a*a<=s)||(i=e-(this.x+n),i*i+a*a<=s))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}let qn=class Bm{constructor(e=1,r=0,n=0,i=1,a=0,s=0){this.array=null,this.a=e,this.b=r,this.c=n,this.d=i,this.tx=a,this.ty=s}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,r,n,i,a,s){return this.a=e,this.b=r,this.c=n,this.d=i,this.tx=a,this.ty=s,this}toArray(e,r){this.array||(this.array=new Float32Array(9));const n=r||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,r){r=r||new zr;const n=e.x,i=e.y;return r.x=this.a*n+this.c*i+this.tx,r.y=this.b*n+this.d*i+this.ty,r}applyInverse(e,r){r=r||new zr;const n=1/(this.a*this.d+this.c*-this.b),i=e.x,a=e.y;return r.x=this.d*n*i+-this.c*n*a+(this.ty*this.c-this.tx*this.d)*n,r.y=this.a*n*a+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,r}translate(e,r){return this.tx+=e,this.ty+=r,this}scale(e,r){return this.a*=e,this.d*=r,this.c*=e,this.b*=r,this.tx*=e,this.ty*=r,this}rotate(e){const r=Math.cos(e),n=Math.sin(e),i=this.a,a=this.c,s=this.tx;return this.a=i*r-this.b*n,this.b=i*n+this.b*r,this.c=a*r-this.d*n,this.d=a*n+this.d*r,this.tx=s*r-this.ty*n,this.ty=s*n+this.ty*r,this}append(e){const r=this.a,n=this.b,i=this.c,a=this.d;return this.a=e.a*r+e.b*i,this.b=e.a*n+e.b*a,this.c=e.c*r+e.d*i,this.d=e.c*n+e.d*a,this.tx=e.tx*r+e.ty*i+this.tx,this.ty=e.tx*n+e.ty*a+this.ty,this}setTransform(e,r,n,i,a,s,o,l,u){return this.a=Math.cos(o+u)*a,this.b=Math.sin(o+u)*a,this.c=-Math.sin(o-l)*s,this.d=Math.cos(o-l)*s,this.tx=e-(n*this.a+i*this.c),this.ty=r-(n*this.b+i*this.d),this}prepend(e){const r=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,i=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty,this}decompose(e){const r=this.a,n=this.b,i=this.c,a=this.d,s=e.pivot,o=-Math.atan2(-i,a),l=Math.atan2(n,r),u=Math.abs(o+l);return u<1e-5||Math.abs(tv-u)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=l),e.scale.x=Math.sqrt(r*r+n*n),e.scale.y=Math.sqrt(i*i+a*a),e.position.x=this.tx+(s.x*r+s.y*i),e.position.y=this.ty+(s.x*n+s.y*a),e}invert(){const e=this.a,r=this.b,n=this.c,i=this.d,a=this.tx,s=e*i-r*n;return this.a=i/s,this.b=-r/s,this.c=-n/s,this.d=e/s,this.tx=(n*this.ty-i*a)/s,this.ty=-(e*this.ty-r*a)/s,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Bm;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Bm}static get TEMP_MATRIX(){return new Bm}};const tc=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],rc=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],nc=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ic=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],f1=[],yN=[],Up=Math.sign;function Q7(){for(let t=0;t<16;t++){const e=[];f1.push(e);for(let r=0;r<16;r++){const n=Up(tc[t]*tc[r]+nc[t]*rc[r]),i=Up(rc[t]*tc[r]+ic[t]*rc[r]),a=Up(tc[t]*nc[r]+nc[t]*ic[r]),s=Up(rc[t]*nc[r]+ic[t]*ic[r]);for(let o=0;o<16;o++)if(tc[o]===n&&rc[o]===i&&nc[o]===a&&ic[o]===s){e.push(o);break}}}for(let t=0;t<16;t++){const e=new qn;e.set(tc[t],rc[t],nc[t],ic[t],0,0),yN.push(e)}}Q7();const bn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>tc[t],uY:t=>rc[t],vX:t=>nc[t],vY:t=>ic[t],inv:t=>t&8?t&15:-t&7,add:(t,e)=>f1[t][e],sub:(t,e)=>f1[t][bn.inv(e)],rotate180:t=>t^4,isVertical:t=>(t&3)===2,byDirection:(t,e)=>Math.abs(t)*2<=Math.abs(e)?e>=0?bn.S:bn.N:Math.abs(e)*2<=Math.abs(t)?t>0?bn.E:bn.W:e>0?t>0?bn.SE:bn.SW:t>0?bn.NE:bn.NW,matrixAppendRotationInv:(t,e,r=0,n=0)=>{const i=yN[bn.inv(e)];i.tx=r,i.ty=n,t.append(i)}};class tl{constructor(e,r,n=0,i=0){this._x=n,this._y=i,this.cb=e,this.scope=r}clone(e=this.cb,r=this.scope){return new tl(e,r,this._x,this._y)}set(e=0,r=e){return(this._x!==e||this._y!==r)&&(this._x=e,this._y=r,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}const bN=class{constructor(){this.worldTransform=new qn,this.localTransform=new qn,this.position=new tl(this.onChange,this,0,0),this.scale=new tl(this.onChange,this,1,1),this.pivot=new tl(this.onChange,this,0,0),this.skew=new tl(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};let Ib=bN;Ib.IDENTITY=new bN;var J7=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,e9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function OA(t,e,r){const n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),n}function G0(t){const e=new Array(t);for(let r=0;r<e.length;r++)e[r]=!1;return e}function xN(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return G0(2*e);case"bvec3":return G0(3*e);case"bvec4":return G0(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const zf=[{test:t=>t.type==="float"&&t.size===1&&!t.isArray,code:t=>`
            if(uv["${t}"] !== ud["${t}"].value)
            {
                ud["${t}"].value = uv["${t}"]
                gl.uniform1f(ud["${t}"].location, uv["${t}"])
            }
            `},{test:(t,e)=>(t.type==="sampler2D"||t.type==="samplerCube"||t.type==="sampler2DArray")&&t.size===1&&!t.isArray&&(e==null||e.castToBaseTexture!==void 0),code:t=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${t}"], t);

            if(ud["${t}"].value !== t)
            {
                ud["${t}"].value = t;
                gl.uniform1i(ud["${t}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(t,e)=>t.type==="mat3"&&t.size===1&&!t.isArray&&e.a!==void 0,code:t=>`
            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));
            `,codeUbo:t=>`
                var ${t}_matrix = uv.${t}.toArray(true);

                data[offset] = ${t}_matrix[0];
                data[offset+1] = ${t}_matrix[1];
                data[offset+2] = ${t}_matrix[2];
        
                data[offset + 4] = ${t}_matrix[3];
                data[offset + 5] = ${t}_matrix[4];
                data[offset + 6] = ${t}_matrix[5];
        
                data[offset + 8] = ${t}_matrix[6];
                data[offset + 9] = ${t}_matrix[7];
                data[offset + 10] = ${t}_matrix[8];
            `},{test:(t,e)=>t.type==="vec2"&&t.size===1&&!t.isArray&&e.x!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${t}"].location, v.x, v.y);
                }`,codeUbo:t=>`
                v = uv.${t};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:t=>t.type==="vec2"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);
                }
            `},{test:(t,e)=>t.type==="vec4"&&t.size===1&&!t.isArray&&e.width!==void 0,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:t=>`
                    v = uv.${t};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:t=>t.type==="vec4"&&t.size===1&&!t.isArray,code:t=>`
                cv = ud["${t}"].value;
                v = uv["${t}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])
                }`}],t9={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},r9={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function n9(t,e){var n;const r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in t.uniforms){const a=e[i];if(!a){(n=t.uniforms[i])!=null&&n.group&&(t.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const s=t.uniforms[i];let o=!1;for(let l=0;l<zf.length;l++)if(zf[l].test(a,s)){r.push(zf[l].code(i,s)),o=!0;break}if(!o){const u=(a.size===1&&!a.isArray?t9:r9)[a.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${u};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}const wN={};let cf=wN;function i9(){if(cf===wN||cf!=null&&cf.isContextLost()){const t=Nt.ADAPTER.createCanvas();let e;Nt.PREFER_ENV>=Sc.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),cf=e}return cf}let zp;function a9(){if(!zp){zp=rs.MEDIUM;const t=i9();t&&t.getShaderPrecisionFormat&&(zp=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?rs.HIGH:rs.MEDIUM)}return zp}function BA(t,e){const r=t.getShaderSource(e).split(`
`).map((u,c)=>`${c}: ${u}`),n=t.getShaderInfoLog(e),i=n.split(`
`),a={},s=i.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!a[u]?(a[u]=!0,!0):!1),o=[""];s.forEach(u=>{r[u-1]=`%c${r[u-1]}%c`,o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=r.join(`
`);o[0]=l,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...o),console.groupEnd()}function s9(t,e,r,n){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||BA(t,r),t.getShaderParameter(n,t.COMPILE_STATUS)||BA(t,n),console.error("PixiJS Error: Could not initialize shader."),t.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}const o9={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function _N(t){return o9[t]}let Gp=null;const RA={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function AN(t,e){if(!Gp){const r=Object.keys(RA);Gp={};for(let n=0;n<r.length;++n){const i=r[n];Gp[t[i]]=RA[i]}}return Gp[e]}function PA(t,e,r){if(t.substring(0,9)!=="precision"){let n=e;return e===rs.HIGH&&r!==rs.HIGH&&(n=rs.MEDIUM),`precision ${n} float;
${t}`}else if(r!==rs.HIGH&&t.substring(0,15)==="precision highp")return t.replace("precision highp","precision mediump");return t}let ed;function u9(){if(typeof ed=="boolean")return ed;try{ed=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{ed=!1}return ed}let l9=0;const qp={},Ef=class{constructor(t,e,r="pixi-shader",n={}){this.extra={},this.id=l9++,this.vertexSrc=t||Ef.defaultVertexSrc,this.fragmentSrc=e||Ef.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=n,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),qp[r]?(qp[r]++,r+=`-${qp[r]}`):qp[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=PA(this.vertexSrc,Ef.defaultVertexPrecision,rs.HIGH),this.fragmentSrc=PA(this.fragmentSrc,Ef.defaultFragmentPrecision,a9())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return e9}static get defaultFragmentSrc(){return J7}static from(t,e,r){const n=t+e;let i=CA[n];return i||(CA[n]=i=new Ef(t,e,r)),i}};let Rs=Ef;Rs.defaultVertexPrecision=rs.HIGH;Rs.defaultFragmentPrecision=uu.apple.device?rs.HIGH:rs.MEDIUM;let c9=0;class ks{constructor(e,r,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=c9++,this.static=!!r,this.ubo=!!n,e instanceof Pn?(this.buffer=e,this.buffer.type=vo.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new Pn(new Float32Array(1)),this.buffer.type=vo.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,r,n){if(!this.ubo)this.uniforms[e]=new ks(r,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,r,n){return new ks(e,r,n)}static uboFrom(e,r){return new ks(e,r??!0,!0)}}class go{constructor(e,r){this.uniformBindCount=0,this.program=e,r?r instanceof ks?this.uniformGroup=r:this.uniformGroup=new ks(r):this.uniformGroup=new ks({}),this.disposeRunner=new $s("disposeShader")}checkUniformExists(e,r){if(r.uniforms[e])return!0;for(const n in r.uniforms){const i=r.uniforms[n];if(i.group&&this.checkUniformExists(e,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,r,n){const i=Rs.from(e,r);return new go(i,n)}}class f9{constructor(e,r){if(this.vertexSrc=e,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const n=new Int32Array(e);for(let a=0;a<e;a++)n[a]=a;this.defaultGroupCache[e]=ks.from({uSamplers:n},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${e}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Rs(this.vertexSrc,i)}const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new qn,default:this.defaultGroupCache[e]};return new go(this.programCache[e],r)}generateSampleSrc(e){let r="";r+=`
`,r+=`
`;for(let n=0;n<e;n++)n>0&&(r+=`
else `),n<e-1&&(r+=`if(vTextureId < ${n}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}}class h1{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function h9(){return!uu.apple.device}function d9(t){let e=!0;const r=Nt.ADAPTER.getNavigator();if(uu.tablet||uu.phone){if(uu.apple.device){const n=r.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(e=!1)}if(uu.android.device){const n=r.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(e=!1)}}return e?t:4}class Vv{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var p9=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,m9=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Ts=class extends Vv{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=gN,this.vertexSize=6,this.state=xu.for2d(),this.size=Ts.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??d9(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??h9(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return qr("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return m9}static get defaultFragmentTemplate(){return p9}setShaderGenerator({vertex:t=Ts.defaultVertexSrc,fragment:e=Ts.defaultFragmentTemplate}={}){this.shaderGenerator=new f9(t,e)}contextChange(){const t=this.renderer.gl;Nt.PREFER_ENV===Sc.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Ts.defaultMaxTextures),this.maxTextures=q7(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=Ts,r=this.size/4,n=Math.floor(r/this.maxTextures)+1;for(;t.length<r;)t.push(new c1);for(;e.length<n;)e.push(new h1);for(let i=0;i<this.maxTextures;i++)this._tempBoundTextures[i]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,r=Ts._textureArrayPool,n=this.renderer.batch,i=this._tempBoundTextures,a=this.renderer.textureGC.count;let s=++pr._globalBatch,o=0,l=r[0],u=0;n.copyBoundTextures(i,e);for(let c=0;c<this._bufferSize;++c){const f=t[c];t[c]=null,f._batchEnabled!==s&&(l.count>=e&&(n.boundArray(l,i,s,e),this.buildDrawCalls(l,u,c),u=c,l=r[++o],++s),f._batchEnabled=s,f.touched=a,l.elements[l.count++]=f)}l.count>0&&(n.boundArray(l,i,s,e),this.buildDrawCalls(l,u,this._bufferSize),++o,++s);for(let c=0;c<i.length;c++)i[c]=null;pr._globalBatch=s}buildDrawCalls(t,e,r){const{_bufferedElements:n,_attributeBuffer:i,_indexBuffer:a,vertexSize:s}=this,o=Ts._drawCallPool;let l=this._dcIndex,u=this._aIndex,c=this._iIndex,f=o[l];f.start=this._iIndex,f.texArray=t;for(let h=e;h<r;++h){const p=n[h],m=p._texture.baseTexture,v=fN[m.alphaMode?1:0][p.blendMode];n[h]=null,e<h&&f.blend!==v&&(f.size=c-f.start,e=h,f=o[++l],f.texArray=t,f.start=c),this.packInterleavedGeometry(p,i,a,u,c),u+=p.vertexData.length/2*s,c+=p.indices.length,f.blend=v}e<r&&(f.size=c-f.start,++l),this._dcIndex=l,this._aIndex=u,this._iIndex=c}bindAndClearTexArray(t){const e=this.renderer.texture;for(let r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:r}=this;Ts.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:r}=this.renderer,n=Ts._drawCallPool;let i=null;for(let a=0;a<t;a++){const{texArray:s,type:o,size:l,start:u,blend:c}=n[a];i!==s&&(i=s,this.bindAndClearTexArray(s)),this.state.blendMode=c,r.set(this.state),e.drawElements(o,l,e.UNSIGNED_SHORT,u*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Ts.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=Jm(Math.ceil(t/8)),r=DA(e),n=e*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let i=this._aBuffers[n];return i||(this._aBuffers[n]=i=new u1(n*this.vertexSize*4)),i}getIndexBuffer(t){const e=Jm(Math.ceil(t/12)),r=DA(e),n=e*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let i=this._iBuffers[r];return i||(this._iBuffers[r]=i=new Uint16Array(n)),i}packInterleavedGeometry(t,e,r,n,i){const{uint32View:a,float32View:s}=e,o=n/this.vertexSize,l=t.uvs,u=t.indices,c=t.vertexData,f=t._texture.baseTexture._batchLocation,h=Math.min(t.worldAlpha,1),p=h<1&&t._texture.baseTexture.alphaMode?Cb(t._tintRGB,h):t._tintRGB+(h*255<<24);for(let m=0;m<c.length;m+=2)s[n++]=c[m],s[n++]=c[m+1],s[n++]=l[m],s[n++]=l[m+1],a[n++]=p,s[n++]=f;for(let m=0;m<u.length;m++)r[i++]=o+u[m]}};let Fs=Ts;Fs.defaultBatchSize=4096;Fs.extension={name:"batch",type:Tt.RendererPlugin};Fs._drawCallPool=[];Fs._textureArrayPool=[];Lt.add(Fs);var v9=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,g9=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const ld=class extends go{constructor(t,e,r){const n=Rs.from(t||ld.defaultVertexSrc,e||ld.defaultFragmentSrc);super(n,r),this.padding=0,this.resolution=ld.defaultResolution,this.multisample=ld.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new xu}apply(t,e,r,n,i){t.applyFilter(this,e,r,n)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return g9}static get defaultFragmentSrc(){return v9}};let Wi=ld;Wi.defaultResolution=1;Wi.defaultMultisample=zn.NONE;class EN{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender,e.color&&(this.color=typeof e.color=="string"?Db(e.color):e.color),this.alpha=e.alpha}get color(){return this._backgroundColor}set color(e){this._backgroundColor=e,this._backgroundColorString=cN(e),Sd(e,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(e){this._backgroundColorRgba[3]=e}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}}EN.extension={type:[Tt.RendererSystem,Tt.CanvasRendererSystem],name:"background"};Lt.add(EN);class SN{constructor(e){this.renderer=e,this.emptyRenderer=new Vv(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,r){const{boundTextures:n}=this.renderer.texture;for(let i=r-1;i>=0;--i)e[i]=n[i]||null,e[i]&&(e[i]._batchLocation=i)}boundArray(e,r,n,i){const{elements:a,ids:s,count:o}=e;let l=0;for(let u=0;u<o;u++){const c=a[u],f=c._batchLocation;if(f>=0&&f<i&&r[f]===c){s[u]=f;continue}for(;l<i;){const h=r[l];if(h&&h._batchEnabled===n&&h._batchLocation===l){l++;continue}s[u]=l,c._batchLocation=l,r[l]=c;break}}}destroy(){this.renderer=null}}SN.extension={type:Tt.RendererSystem,name:"batch"};Lt.add(SN);let $A=0;class DN{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=$A++}init(e){if(e.context)this.initFromContext(e.context);else{const r=this.renderer.background.alpha<1,n=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:n,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=$A++,this.renderer.runners.contextChange.emit(e);const r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const r=this.createContext(this.renderer.view,e);this.initFromContext(r)}createContext(e,r){let n;if(Nt.PREFER_ENV>=Sc.WEBGL2&&(n=e.getContext("webgl2",r)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=e.getContext("webgl",r)||e.getContext("experimental-webgl",r),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,r={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const r=e.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=n||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}DN.extension={type:Tt.RendererSystem,name:"context"};Lt.add(DN);class y9 extends kd{upload(e,r,n){const i=e.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Us.UNPACK);const a=r.realWidth,s=r.realHeight;return n.width===a&&n.height===s?i.texSubImage2D(r.target,0,0,0,a,s,r.format,n.type,this.data):(n.width=a,n.height=s,i.texImage2D(r.target,0,n.internalFormat,a,s,0,r.format,n.type,this.data)),!0}}class d1{constructor(e,r){this.width=Math.round(e||100),this.height=Math.round(r||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new $s("disposeFramebuffer"),this.multisample=zn.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,r){return this.colorTextures[e]=r||new pr(null,{scaleMode:ou.NEAREST,resolution:1,mipmap:xo.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new pr(new y9(null,{width:this.width,height:this.height}),{scaleMode:ou.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:xo.OFF,format:wt.DEPTH_COMPONENT,type:Ht.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,r){if(e=Math.round(e),r=Math.round(r),!(e===this.width&&r===this.height)){this.width=e,this.height=r,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const i=this.colorTextures[n],a=i.resolution;i.setSize(e/a,r/a)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,r/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class CN extends pr{constructor(e={}){if(typeof e=="number"){const r=arguments[0],n=arguments[1],i=arguments[2],a=arguments[3];e={width:r,height:n,scaleMode:i,resolution:a}}e.width=e.width||100,e.height=e.height||100,e.multisample??(e.multisample=zn.NONE),super(null,e),this.mipmap=xo.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new d1(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}resize(e,r){this.framebuffer.resize(e*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class ll extends Dd{constructor(e){const r=e,n=r.naturalWidth||r.videoWidth||r.width,i=r.naturalHeight||r.videoHeight||r.height;super(n,i),this.source=e,this.noSubImage=!1}static crossOrigin(e,r,n){n===void 0&&!r.startsWith("data:")?e.crossOrigin=U7(r):n!==!1&&(e.crossOrigin=typeof n=="string"?n:"anonymous")}upload(e,r,n,i){const a=e.gl,s=r.realWidth,o=r.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1&&i.buffered.length===0)return!1;return a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Us.UNPACK),!this.noSubImage&&r.target===a.TEXTURE_2D&&n.width===s&&n.height===o?a.texSubImage2D(a.TEXTURE_2D,0,0,0,r.format,n.type,i):(n.width=s,n.height=o,a.texImage2D(r.target,0,n.internalFormat,r.format,n.type,i)),!0}update(){if(this.destroyed)return;const e=this.source,r=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;this.resize(r,n),super.update()}dispose(){this.source=null}}class TN extends ll{constructor(e,r){if(r=r||{},typeof e=="string"){const n=new Image;ll.crossOrigin(n,e,r.crossorigin),n.src=e,e=n}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??Nt.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((r,n)=>{const i=this.source;this.url=i.src;const a=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.resize(i.width,i.height),this._load=null,this.createBitmap?r(this.process()):r(this))};i.complete&&i.src?a():(i.onload=a,i.onerror=s=>{n(s),this.onError.emit(s)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const r=globalThis.createImageBitmap,n=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:n?"cors":"no-cors"}).then(i=>i.blob()).then(i=>r(i,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Us.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,r,n){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,r,n,this.bitmap),!this.preserveBitmap){let i=!0;const a=r._glTextures;for(const s in a){const o=a[s];if(o!==n&&o.dirtyId!==r.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class NN{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,r,n){const i=r.width,a=r.height;if(n){const s=e.width/2/i,o=e.height/2/a,l=e.x/i+s,u=e.y/a+o;n=bn.add(n,bn.NW),this.x0=l+s*bn.uX(n),this.y0=u+o*bn.uY(n),n=bn.add(n,2),this.x1=l+s*bn.uX(n),this.y1=u+o*bn.uY(n),n=bn.add(n,2),this.x2=l+s*bn.uX(n),this.y2=u+o*bn.uY(n),n=bn.add(n,2),this.x3=l+s*bn.uX(n),this.y3=u+o*bn.uY(n)}else this.x0=e.x/i,this.y0=e.y/a,this.x1=(e.x+e.width)/i,this.y1=e.y/a,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/a,this.x3=e.x/i,this.y3=(e.y+e.height)/a;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const kA=new NN;function Hp(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class kt extends Rd{constructor(e,r,n,i,a,s){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new Br(0,0,1,1)),e instanceof kt&&(e=e.baseTexture),this.baseTexture=e,this._frame=r,this.trim=i,this.valid=!1,this._uvs=kA,this.uvMatrix=null,this.orig=n||r,this._rotate=Number(a||0),a===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new zr(s.x,s.y):new zr(0,0),this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=r:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:r}=this.baseTexture;r!=null&&r.url&&uo[r.url]&&kt.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,kt.removeFromCache(this),this.textureCacheIds=null}clone(){var i;const e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),n=new kt(this.baseTexture,!this.noFrame&&e,r,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(n._frame=e),n}updateUvs(){this._uvs===kA&&(this._uvs=new NN),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,r={},n=Nt.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let a=null;if(i)a=e;else if(e instanceof pr){if(!e.cacheId){const o=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e.cacheId=`${o}-${yc()}`,pr.addToCache(e,e.cacheId)}a=e.cacheId}else{if(!e._pixiId){const o=(r==null?void 0:r.pixiIdPrefix)||"pixiid";e._pixiId=`${o}_${yc()}`}a=e._pixiId}let s=uo[a];if(i&&n&&!s)throw new Error(`The cacheId "${a}" does not exist in TextureCache.`);return!s&&!(e instanceof pr)?(r.resolution||(r.resolution=ol(e)),s=new kt(new pr(e,r)),s.baseTexture.cacheId=a,pr.addToCache(s.baseTexture,a),kt.addToCache(s,a)):!s&&e instanceof pr&&(s=new kt(e),kt.addToCache(s,a)),s}static fromURL(e,r){const n=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),i=kt.from(e,Object.assign({resourceOptions:n},r),!1),a=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):a.load().then(()=>Promise.resolve(i))}static fromBuffer(e,r,n,i){return new kt(pr.fromBuffer(e,r,n,i))}static fromLoader(e,r,n,i){const a=new pr(e,Object.assign({scaleMode:Nt.SCALE_MODE,resolution:ol(r)},i)),{resource:s}=a;s instanceof TN&&(s.url=r);const o=new kt(a);return n||(n=r),pr.addToCache(o.baseTexture,n),kt.addToCache(o,n),n!==r&&(pr.addToCache(o.baseTexture,r),kt.addToCache(o,r)),o.baseTexture.valid?Promise.resolve(o):new Promise(l=>{o.baseTexture.once("loaded",()=>l(o))})}static addToCache(e,r){r&&(e.textureCacheIds.includes(r)||e.textureCacheIds.push(r),uo[r]&&uo[r]!==e&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),uo[r]=e)}static removeFromCache(e){if(typeof e=="string"){const r=uo[e];if(r){const n=r.textureCacheIds.indexOf(e);return n>-1&&r.textureCacheIds.splice(n,1),delete uo[e],r}}else if(e!=null&&e.textureCacheIds){for(let r=0;r<e.textureCacheIds.length;++r)uo[e.textureCacheIds[r]]===e&&delete uo[e.textureCacheIds[r]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:r,y:n,width:i,height:a}=e,s=r+i>this.baseTexture.width,o=n+a>this.baseTexture.height;if(s||o){const l=s&&o?"and":"or",u=`X: ${r} + ${i} = ${r+i} > ${this.baseTexture.width}`,c=`Y: ${n} + ${a} = ${n+a} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${l} ${c}`)}this.valid=i&&a&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return kt._EMPTY||(kt._EMPTY=new kt(new pr),Hp(kt._EMPTY),Hp(kt._EMPTY.baseTexture)),kt._EMPTY}static get WHITE(){if(!kt._WHITE){const e=Nt.ADAPTER.createCanvas(16,16),r=e.getContext("2d");e.width=16,e.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),kt._WHITE=new kt(pr.from(e)),Hp(kt._WHITE),Hp(kt._WHITE.baseTexture)}return kt._WHITE}}class cl extends kt{constructor(e,r){super(e,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,r,n=!0){const i=this.baseTexture.resolution,a=Math.round(e*i)/i,s=Math.round(r*i)/i;this.valid=a>0&&s>0,this._frame.width=this.orig.width=a,this._frame.height=this.orig.height=s,n&&this.baseTexture.resize(a,s),this.updateUvs()}setResolution(e){const{baseTexture:r}=this;r.resolution!==e&&(r.setResolution(e),this.resize(r.width,r.height,!1))}static create(e){return new cl(new CN(e))}}class MN{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,r,n=zn.NONE){const i=new CN(Object.assign({width:e,height:r,resolution:1,multisample:n},this.textureOptions));return new cl(i)}getOptimalTexture(e,r,n=1,i=zn.NONE){let a;e=Math.ceil(e*n-1e-6),r=Math.ceil(r*n-1e-6),!this.enableFullScreen||e!==this._pixelsWidth||r!==this._pixelsHeight?(e=Jm(e),r=Jm(r),a=((e&65535)<<16|r&65535)>>>0,i>1&&(a+=i*4294967296)):a=i>1?-i:-1,this.texturePool[a]||(this.texturePool[a]=[]);let s=this.texturePool[a].pop();return s||(s=this.createTexture(e,r,i)),s.filterPoolKey=a,s.setResolution(n),s}getFilterTexture(e,r,n){const i=this.getOptimalTexture(e.width,e.height,r||e.resolution,n||zn.NONE);return i.filterFrame=e.filterFrame,i}returnTexture(e){const r=e.filterPoolKey;e.filterFrame=null,this.texturePool[r].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const r in this.texturePool){const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const r in this.texturePool){if(!(Number(r)<0))continue;const n=this.texturePool[r];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}MN.SCREEN_KEY=-1;class b9 extends ul{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class IN extends ul{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Pn(this.vertices),this.uvBuffer=new Pn(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,r){let n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+r.width/e.width,this.uvs[3]=i,this.uvs[4]=n+r.width/e.width,this.uvs[5]=i+r.height/e.height,this.uvs[6]=n,this.uvs[7]=i+r.height/e.height,n=r.x,i=r.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+r.width,this.vertices[3]=i,this.vertices[4]=n+r.width,this.vertices[5]=i+r.height,this.vertices[6]=n,this.vertices[7]=i+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class x9{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=zn.NONE,this.sourceFrame=new Br,this.destinationFrame=new Br,this.bindingSourceFrame=new Br,this.bindingDestinationFrame=new Br,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Wp=[new zr,new zr,new zr,new zr],q0=new qn;class FN{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new MN,this.statePool=[],this.quad=new b9,this.quadUv=new IN,this.tempRect=new Br,this.activeState={},this.globalUniforms=new ks({outputFrame:new Br,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,r){const n=this.renderer,i=this.defaultFilterStack,a=this.statePool.pop()||new x9,s=this.renderer.renderTexture;let o=r[0].resolution,l=r[0].multisample,u=r[0].padding,c=r[0].autoFit,f=r[0].legacy??!0;for(let m=1;m<r.length;m++){const v=r[m];o=Math.min(o,v.resolution),l=Math.min(l,v.multisample),u=this.useMaxPadding?Math.max(u,v.padding):u+v.padding,c=c&&v.autoFit,f=f||(v.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=s.current),i.push(a),a.resolution=o,a.multisample=l,a.legacy=f,a.target=e,a.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),a.sourceFrame.pad(u);const h=this.tempRect.copyFrom(s.sourceFrame);n.projection.transform&&this.transformAABB(q0.copyFrom(n.projection.transform).invert(),h),c?(a.sourceFrame.fit(h),(a.sourceFrame.width<=0||a.sourceFrame.height<=0)&&(a.sourceFrame.width=0,a.sourceFrame.height=0)):a.sourceFrame.intersects(h)||(a.sourceFrame.width=0,a.sourceFrame.height=0),this.roundFrame(a.sourceFrame,s.current?s.current.resolution:n.resolution,s.sourceFrame,s.destinationFrame,n.projection.transform),a.renderTexture=this.getOptimalFilterTexture(a.sourceFrame.width,a.sourceFrame.height,o,l),a.filters=r,a.destinationFrame.width=a.renderTexture.width,a.destinationFrame.height=a.renderTexture.height;const p=this.tempRect;p.x=0,p.y=0,p.width=a.sourceFrame.width,p.height=a.sourceFrame.height,a.renderTexture.filterFrame=a.sourceFrame,a.bindingSourceFrame.copyFrom(s.sourceFrame),a.bindingDestinationFrame.copyFrom(s.destinationFrame),a.transform=n.projection.transform,n.projection.transform=null,s.bind(a.renderTexture,a.sourceFrame,p),n.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,r=e.pop(),n=r.filters;this.activeState=r;const i=this.globalUniforms.uniforms;i.outputFrame=r.sourceFrame,i.resolution=r.resolution;const a=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(a[0]=r.destinationFrame.width,a[1]=r.destinationFrame.height,a[2]=1/a[0],a[3]=1/a[1],s[0]=Math.round(a[0]*r.resolution),s[1]=Math.round(a[1]*r.resolution),s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=r.sourceFrame.width*a[2]-.5*s[2],o[3]=r.sourceFrame.height*a[3]-.5*s[3],r.legacy){const u=i.filterArea;u[0]=r.destinationFrame.width,u[1]=r.destinationFrame.height,u[2]=r.sourceFrame.x,u[3]=r.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,r.renderTexture,l.renderTexture,fo.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let u=r.renderTexture,c=this.getOptimalFilterTexture(u.width,u.height,r.resolution);c.filterFrame=u.filterFrame;let f=0;for(f=0;f<n.length-1;++f){f===1&&r.multisample>1&&(c=this.getOptimalFilterTexture(u.width,u.height,r.resolution),c.filterFrame=u.filterFrame),n[f].apply(this,u,c,fo.CLEAR,r);const h=u;u=c,c=h}n[f].apply(this,u,l.renderTexture,fo.BLEND,r),f>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(c)}r.clear(),this.statePool.push(r)}bindAndClear(e,r=fo.CLEAR){const{renderTexture:n,state:i}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e!=null&&e.filterFrame){const s=this.tempRect;s.x=0,s.y=0,s.width=e.filterFrame.width,s.height=e.filterFrame.height,n.bind(e,e.filterFrame,s)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const a=i.stateId&1||this.forceClear;(r===fo.CLEAR||r===fo.BLIT&&a)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,r,n,i){const a=this.renderer;a.state.set(e.state),this.bindAndClear(n,i),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,a.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(r._frame,r.filterFrame),a.geometry.bind(this.quadUv),a.geometry.draw(po.TRIANGLES)):(a.geometry.bind(this.quad),a.geometry.draw(po.TRIANGLE_STRIP))}calculateSpriteMatrix(e,r){const{sourceFrame:n,destinationFrame:i}=this.activeState,{orig:a}=r._texture,s=e.set(i.width,0,0,i.height,n.x,n.y),o=r.worldTransform.copyTo(qn.TEMP_MATRIX);return o.invert(),s.prepend(o),s.scale(1/a.width,1/a.height),s.translate(r.anchor.x,r.anchor.y),s}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,r,n=1,i=zn.NONE){return this.texturePool.getOptimalTexture(e,r,n,i)}getFilterTexture(e,r,n){if(typeof e=="number"){const a=e;e=r,r=a}e=e||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(e.width,e.height,r||e.resolution,n||zn.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,r){const n=Wp[0],i=Wp[1],a=Wp[2],s=Wp[3];n.set(r.left,r.top),i.set(r.left,r.bottom),a.set(r.right,r.top),s.set(r.right,r.bottom),e.apply(n,n),e.apply(i,i),e.apply(a,a),e.apply(s,s);const o=Math.min(n.x,i.x,a.x,s.x),l=Math.min(n.y,i.y,a.y,s.y),u=Math.max(n.x,i.x,a.x,s.x),c=Math.max(n.y,i.y,a.y,s.y);r.x=o,r.y=l,r.width=u-o,r.height=c-l}roundFrame(e,r,n,i,a){if(!(e.width<=0||e.height<=0||n.width<=0||n.height<=0)){if(a){const{a:s,b:o,c:l,d:u}=a;if((Math.abs(o)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(s)>1e-4||Math.abs(u)>1e-4))return}a=a?q0.copyFrom(a):q0.identity(),a.translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(a,e),e.ceil(r),this.transformAABB(a.invert(),e)}}}FN.extension={type:Tt.RendererSystem,name:"filter"};Lt.add(FN);class w9{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=zn.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const _9=new Br;class ON{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new d1(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Br,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;Nt.PREFER_ENV===Sc.WEBGL_LEGACY&&(r=null,n=null),r?e.drawBuffers=i=>r.drawBuffersWEBGL(i):(this.hasMRT=!1,e.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,r,n=0){const{gl:i}=this;if(e){const a=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,a.framebuffer)),a.mipLevel!==n&&(e.dirtyId++,e.dirtyFormat++,a.mipLevel=n),a.dirtyId!==e.dirtyId&&(a.dirtyId=e.dirtyId,a.dirtyFormat!==e.dirtyFormat?(a.dirtyFormat=e.dirtyFormat,a.dirtySize=e.dirtySize,this.updateFramebuffer(e,n)):a.dirtySize!==e.dirtySize&&(a.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let s=0;s<e.colorTextures.length;s++){const o=e.colorTextures[s];this.renderer.texture.unbind(o.parentTextureArray||o)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),r){const s=r.width>>n,o=r.height>>n,l=s/r.width;this.setViewport(r.x*l,r.y*l,s,o)}else{const s=e.width>>n,o=e.height>>n;this.setViewport(0,0,s,o)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,r,n,i){const a=this.viewport;e=Math.round(e),r=Math.round(r),n=Math.round(n),i=Math.round(i),(a.width!==n||a.height!==i||a.x!==e||a.y!==r)&&(a.x=e,a.y=r,a.width=n,a.height=i,this.gl.viewport(e,r,n,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,r,n,i,a=Wy.COLOR|Wy.DEPTH){const{gl:s}=this;s.clearColor(e,r,n,i),s.clear(a)}initFramebuffer(e){const{gl:r}=this,n=new w9(r.createFramebuffer());return n.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(e),e.disposeRunner.add(this),n}resizeFramebuffer(e){const{gl:r}=this,n=e.glFramebuffers[this.CONTEXT_UID];n.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,n.stencil),n.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,r.DEPTH24_STENCIL8,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e.width,e.height));const i=e.colorTextures;let a=i.length;r.drawBuffers||(a=Math.min(a,1));for(let s=0;s<a;s++){const o=i[s],l=o.parentTextureArray||o;this.renderer.texture.bind(l,0),s===0&&n.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,r){const{gl:n}=this,i=e.glFramebuffers[this.CONTEXT_UID],a=e.colorTextures;let s=a.length;n.drawBuffers||(s=Math.min(s,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer():i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const o=[];for(let l=0;l<s;l++){const u=a[l],c=u.parentTextureArray||u;this.renderer.texture.bind(c,0),l===0&&i.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+l,u.target,c._glTextures[this.CONTEXT_UID].texture,r),o.push(n.COLOR_ATTACHMENT0+l))}if(o.length>1&&n.drawBuffers(o),e.depthTexture&&this.writeDepthTexture){const u=e.depthTexture;this.renderer.texture.bind(u,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,u._glTextures[this.CONTEXT_UID].texture,r)}(e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)?(i.stencil=i.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.DEPTH24_STENCIL8,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,i.stencil)):i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:r}=this;let n=zn.NONE;if(e<=1||r===null)return n;for(let i=0;i<r.length;i++)if(r[i]<=e){n=r[i];break}return n===1&&(n=zn.NONE),n}blit(e,r,n){const{current:i,renderer:a,gl:s,CONTEXT_UID:o}=this;if(a.context.webGLVersion!==2||!i)return;const l=i.glFramebuffers[o];if(!l)return;if(!e){if(!l.msaaBuffer)return;const c=i.colorTextures[0];if(!c)return;l.blitFramebuffer||(l.blitFramebuffer=new d1(i.width,i.height),l.blitFramebuffer.addColorTexture(0,c)),e=l.blitFramebuffer,e.colorTextures[0]!==c&&(e.colorTextures[0]=c,e.dirtyId++,e.dirtyFormat++),(e.width!==i.width||e.height!==i.height)&&(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}r||(r=_9,r.width=i.width,r.height=i.height),n||(n=r);const u=r.width===n.width&&r.height===n.height;this.bind(e),s.bindFramebuffer(s.READ_FRAMEBUFFER,l.framebuffer),s.blitFramebuffer(r.left,r.top,r.right,r.bottom,n.left,n.top,n.right,n.bottom,s.COLOR_BUFFER_BIT,u?s.NEAREST:s.LINEAR)}disposeFramebuffer(e,r){const n=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!n)return;delete e.glFramebuffers[this.CONTEXT_UID];const a=this.managedFramebuffers.indexOf(e);a>=0&&this.managedFramebuffers.splice(a,1),e.disposeRunner.remove(this),r||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&n.blitFramebuffer.dispose()}disposeAll(e){const r=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<r.length;n++)this.disposeFramebuffer(r[n],e)}forceStencil(){const e=this.current;if(!e)return;const r=e.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil)return;e.stencil=!0;const n=e.width,i=e.height,a=this.gl,s=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,s),r.msaaBuffer?a.renderbufferStorageMultisample(a.RENDERBUFFER,r.multisample,a.DEPTH24_STENCIL8,n,i):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,n,i),r.stencil=s,a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,s)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Br}destroy(){this.renderer=null}}ON.extension={type:Tt.RendererSystem,name:"framebuffer"};Lt.add(ON);const H0={5126:4,5123:2,5121:1};class BN{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;Nt.PREFER_ENV===Sc.WEBGL_LEGACY&&(n=null),n?(e.createVertexArray=()=>n.createVertexArrayOES(),e.bindVertexArray=i=>n.bindVertexArrayOES(i),e.deleteVertexArray=i=>n.deleteVertexArrayOES(i)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){const n=e.getExtension("ANGLE_instanced_arrays");n?(e.vertexAttribDivisor=(i,a)=>n.vertexAttribDivisorANGLE(i,a),e.drawElementsInstanced=(i,a,s,o,l)=>n.drawElementsInstancedANGLE(i,a,s,o,l),e.drawArraysInstanced=(i,a,s,o)=>n.drawArraysInstancedANGLE(i,a,s,o)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(e,r){r=r||this.renderer.shader.shader;const{gl:n}=this;let i=e.glVertexArrayObjects[this.CONTEXT_UID],a=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},a=!0);const s=i[r.program.id]||this.initGeometryVao(e,r,a);this._activeGeometry=e,this._activeVao!==s&&(this._activeVao=s,this.hasVao?n.bindVertexArray(s):this.activateVao(e,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,r=this.renderer.buffer;for(let n=0;n<e.buffers.length;n++){const i=e.buffers[n];r.update(i)}}checkCompatibility(e,r){const n=e.attributes,i=r.attributeData;for(const a in i)if(!n[a])throw new Error(`shader and geometry incompatible, geometry missing the "${a}" attribute`)}getSignature(e,r){const n=e.attributes,i=r.attributeData,a=["g",e.id];for(const s in n)i[s]&&a.push(s,i[s].location);return a.join("-")}initGeometryVao(e,r,n=!0){const i=this.gl,a=this.CONTEXT_UID,s=this.renderer.buffer,o=r.program;o.glPrograms[a]||this.renderer.shader.generateProgram(r),this.checkCompatibility(e,o);const l=this.getSignature(e,o),u=e.glVertexArrayObjects[this.CONTEXT_UID];let c=u[l];if(c)return u[o.id]=c,c;const f=e.buffers,h=e.attributes,p={},m={};for(const v in f)p[v]=0,m[v]=0;for(const v in h)!h[v].size&&o.attributeData[v]?h[v].size=o.attributeData[v].size:h[v].size||console.warn(`PIXI Geometry attribute '${v}' size cannot be determined (likely the bound shader does not have the attribute)`),p[h[v].buffer]+=h[v].size*H0[h[v].type];for(const v in h){const y=h[v],x=y.size;y.stride===void 0&&(p[y.buffer]===x*H0[y.type]?y.stride=0:y.stride=p[y.buffer]),y.start===void 0&&(y.start=m[y.buffer],m[y.buffer]+=x*H0[y.type])}c=i.createVertexArray(),i.bindVertexArray(c);for(let v=0;v<f.length;v++){const y=f[v];s.bind(y),n&&y._glBuffers[a].refCount++}return this.activateVao(e,o),u[o.id]=c,u[l]=c,i.bindVertexArray(null),s.unbind(vo.ARRAY_BUFFER),c}disposeGeometry(e,r){var o;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const n=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,a=e.buffers,s=(o=this.renderer)==null?void 0:o.buffer;if(e.disposeRunner.remove(this),!!n){if(s)for(let l=0;l<a.length;l++){const u=a[l]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!r&&s.dispose(a[l],r))}if(!r){for(const l in n)if(l[0]==="g"){const u=n[l];this._activeVao===u&&this.unbind(),i.deleteVertexArray(u)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const r=Object.keys(this.managedGeometries);for(let n=0;n<r.length;n++)this.disposeGeometry(this.managedGeometries[r[n]],e)}activateVao(e,r){const n=this.gl,i=this.CONTEXT_UID,a=this.renderer.buffer,s=e.buffers,o=e.attributes;e.indexBuffer&&a.bind(e.indexBuffer);let l=null;for(const u in o){const c=o[u],f=s[c.buffer],h=f._glBuffers[i];if(r.attributeData[u]){l!==h&&(a.bind(f),l=h);const p=r.attributeData[u].location;if(n.enableVertexAttribArray(p),n.vertexAttribPointer(p,c.size,c.type||n.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)n.vertexAttribDivisor(p,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,r,n,i){const{gl:a}=this,s=this._activeGeometry;if(s.indexBuffer){const o=s.indexBuffer.data.BYTES_PER_ELEMENT,l=o===2?a.UNSIGNED_SHORT:a.UNSIGNED_INT;o===2||o===4&&this.canUseUInt32ElementIndex?s.instanced?a.drawElementsInstanced(e,r||s.indexBuffer.data.length,l,(n||0)*o,i||1):a.drawElements(e,r||s.indexBuffer.data.length,l,(n||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?a.drawArraysInstanced(e,n,r||s.getSize(),i||1):a.drawArrays(e,n,r||s.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}BN.extension={type:Tt.RendererSystem,name:"geometry"};Lt.add(BN);const LA=new qn;class RN{constructor(e,r){this._texture=e,this.mapCoord=new qn,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,r){r===void 0&&(r=e);const n=this.mapCoord;for(let i=0;i<e.length;i+=2){const a=e[i],s=e[i+1];r[i]=a*n.a+s*n.c+n.tx,r[i+1]=a*n.b+s*n.d+n.ty}return r}update(e){const r=this._texture;if(!r||!r.valid||!e&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;const n=r._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const i=r.orig,a=r.trim;a&&(LA.set(i.width/a.width,0,0,i.height/a.height,-a.x/a.width,-a.y/a.height),this.mapCoord.append(LA));const s=r.baseTexture,o=this.uClampFrame,l=this.clampMargin/s.resolution,u=this.clampOffset;return o[0]=(r._frame.x+l+u)/s.width,o[1]=(r._frame.y+l+u)/s.height,o[2]=(r._frame.x+r._frame.width-l+u)/s.width,o[3]=(r._frame.y+r._frame.height-l+u)/s.height,this.uClampOffset[0]=u/s.realWidth,this.uClampOffset[1]=u/s.realHeight,this.isSimple=r._frame.width===s.width&&r._frame.height===s.height&&r.rotate===0,!0}}var A9=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,E9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class S9 extends Wi{constructor(e,r,n){let i=null;typeof e!="string"&&r===void 0&&n===void 0&&(i=e,e=void 0,r=void 0,n=void 0),super(e||E9,r||A9,n),this.maskSprite=i,this.maskMatrix=new qn}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,r,n,i){const a=this._maskSprite,s=a._texture;s.valid&&(s.uvMatrix||(s.uvMatrix=new RN(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,a).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=a.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,e.applyFilter(this,r,n,i))}}class D9{constructor(e=null){this.type=jn.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Nt.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=jn.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class PN{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,r){let n=r;if(!n.isMaskData){const a=this.maskDataPool.pop()||new D9;a.pooled=!0,a.maskObject=r,n=a}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(i),n._colorMask=i?i._colorMask:15,n.autoDetect&&this.detect(n),n._target=e,n.type!==jn.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case jn.SCISSOR:this.renderer.scissor.push(n);break;case jn.STENCIL:this.renderer.stencil.push(n);break;case jn.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case jn.COLOR:this.pushColorMask(n);break}n.type===jn.SPRITE&&this.maskStack.push(n)}pop(e){const r=this.maskStack.pop();if(!(!r||r._target!==e)){if(r.enabled)switch(r.type){case jn.SCISSOR:this.renderer.scissor.pop(r);break;case jn.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case jn.SPRITE:this.popSpriteMask(r);break;case jn.COLOR:this.popColorMask(r);break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===jn.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(e){const r=e.maskObject;r?r.isSprite?e.type=jn.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=jn.SCISSOR:e.type=jn.STENCIL:e.type=jn.COLOR}pushSpriteMask(e){const{maskObject:r}=e,n=e._target;let i=e._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new S9]));const a=this.renderer,s=a.renderTexture;let o,l;if(s.current){const c=s.current;o=e.resolution||c.resolution,l=e.multisample??c.multisample}else o=e.resolution||a.resolution,l=e.multisample??a.multisample;i[0].resolution=o,i[0].multisample=l,i[0].maskSprite=r;const u=n.filterArea;n.filterArea=r.getBounds(!0),a.filter.push(n,i),n.filterArea=u,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const r=e._colorMask,n=e._colorMask=r&e.colorMask;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(e){const r=e._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==r&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}PN.extension={type:Tt.RendererSystem,name:"mask"};Lt.add(PN);class $N{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:r}=this.renderer,n=this.getStackLength();this.maskStack=e;const i=this.getStackLength();i!==n&&(i===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const UA=new qn,zA=[],Rm=class extends $N{constructor(t){super(t),this.glConst=Nt.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:r}=t,{renderer:n}=this,i=n.renderTexture,a=r.getBounds(!0,zA.pop()??new Br);this.roundFrameToPixels(a,i.current?i.current.resolution:n.resolution,i.sourceFrame,i.destinationFrame,n.projection.transform),e&&a.fit(e),t._scissorRectLocal=a}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:r,c:n,d:i}=t;return(Math.abs(r)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(i)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||Rm.isMatrixRotated(e.worldTransform)||Rm.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const r=t._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(t,e,r,n,i){Rm.isMatrixRotated(i)||(i=i?UA.copyFrom(i):UA.identity(),i.translate(-r.x,-r.y).scale(n.width/r.width,n.height/r.height).translate(n.x,n.y),this.renderer.filter.transformAABB(i,t),t.fit(n),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&zA.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};let kN=Rm;kN.extension={type:Tt.RendererSystem,name:"scissor"};Lt.add(kN);class LN extends $N{constructor(e){super(e),this.glConst=Nt.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const r=e.maskObject,{gl:n}=this.renderer,i=e._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),e._stencilCounter++;const a=e._colorMask;a!==0&&(e._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,a!==0&&(e._colorMask=a,n.colorMask((a&1)!==0,(a&2)!==0,(a&4)!==0,(a&8)!==0)),this._useCurrent()}pop(e){const r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=n?n._colorMask:15;i!==0&&(n._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,i!==0&&(n._colorMask=i,r.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}LN.extension={type:Tt.RendererSystem,name:"stencil"};Lt.add(LN);class UN{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return qr("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return qr("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return qr("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(e){for(const r in e)this.plugins[r]=new e[r](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}UN.extension={type:[Tt.RendererSystem,Tt.CanvasRendererSystem],name:"_plugin"};Lt.add(UN);class zN{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new qn,this.transform=null}update(e,r,n,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);const a=this.renderer;a.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,a.globalUniforms.update(),a.shader.shader&&a.shader.syncUniformGroup(a.shader.shader.uniforms.globals)}calculateProjection(e,r,n,i){const a=this.projectionMatrix,s=i?-1:1;a.identity(),a.a=1/r.width*2,a.d=s*(1/r.height*2),a.tx=-1-r.x*a.a,a.ty=-s-r.y*a.d}setTransform(e){}destroy(){this.renderer=null}}zN.extension={type:Tt.RendererSystem,name:"projection"};Lt.add(zN);const C9=new Ib;class GN{constructor(e){this.renderer=e,this._tempMatrix=new qn}generateTexture(e,r){const{region:n,...i}=r||{},a=n||e.getLocalBounds(null,!0);a.width===0&&(a.width=1),a.height===0&&(a.height=1);const s=cl.create({width:a.width,height:a.height,...i});this._tempMatrix.tx=-a.x,this._tempMatrix.ty=-a.y;const o=e.transform;return e.transform=C9,this.renderer.render(e,{renderTexture:s,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=o,s}destroy(){}}GN.extension={type:[Tt.RendererSystem,Tt.CanvasRendererSystem],name:"textureGenerator"};Lt.add(GN);const Jl=new Br,td=new Br;class qN{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Br,this.destinationFrame=new Br,this.viewportFrame=new Br}bind(e=null,r,n){const i=this.renderer;this.current=e;let a,s,o;e?(a=e.baseTexture,o=a.resolution,r||(Jl.width=e.frame.width,Jl.height=e.frame.height,r=Jl),n||(td.x=e.frame.x,td.y=e.frame.y,td.width=r.width,td.height=r.height,n=td),s=a.framebuffer):(o=i.resolution,r||(Jl.width=i._view.screen.width,Jl.height=i._view.screen.height,r=Jl),n||(n=Jl,n.width=r.width,n.height=r.height));const l=this.viewportFrame;l.x=n.x*o,l.y=n.y*o,l.width=n.width*o,l.height=n.height*o,e||(l.y=i.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(s,l),this.renderer.projection.update(n,r,o,!s),e?this.renderer.mask.setMaskStack(a.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(n)}clear(e,r){this.current?e=e||this.current.baseTexture.clearColor:e=e||this.renderer.background.colorRgba;const n=this.destinationFrame,i=this.current?this.current.baseTexture:this.renderer._view.screen,a=n.width!==i.width||n.height!==i.height;if(a){let{x:s,y:o,width:l,height:u}=this.viewportFrame;s=Math.round(s),o=Math.round(o),l=Math.round(l),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(s,o,l,u)}this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],r),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}qN.extension={type:Tt.RendererSystem,name:"renderTexture"};Lt.add(qN);class T9{constructor(e,r){this.program=e,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function N9(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const a=e.getActiveAttrib(t,i);if(a.name.startsWith("gl_"))continue;const s=AN(e,a.type),o={type:s,name:a.name,size:_N(s),location:e.getAttribLocation(t,a.name)};r[a.name]=o}return r}function M9(t,e){const r={},n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const a=e.getActiveUniform(t,i),s=a.name.replace(/\[.*?\]$/,""),o=!!a.name.match(/\[.*?\]$/),l=AN(e,a.type);r[s]={name:s,index:i,type:l,size:a.size,isArray:o,value:xN(l,a.size)}}return r}function I9(t,e){var l;const r=OA(t,t.VERTEX_SHADER,e.vertexSrc),n=OA(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,r),t.attachShader(i,n);const a=(l=e.extra)==null?void 0:l.transformFeedbackVaryings;if(a&&(typeof t.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,a.names,a.bufferMode==="separate"?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||s9(t,i,r,n),e.attributeData=N9(i,t),e.uniformData=M9(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const u=Object.keys(e.attributeData);u.sort((c,f)=>c>f?1:-1);for(let c=0;c<u.length;c++)e.attributeData[u[c]].location=c,t.bindAttribLocation(i,c,u[c]);t.linkProgram(i)}t.deleteShader(r),t.deleteShader(n);const s={};for(const u in e.uniformData){const c=e.uniformData[u];s[u]={location:t.getUniformLocation(i,u),value:xN(c.type,c.size)}}return new T9(i,s)}function F9(t,e,r,n,i){r.buffer.update(i)}const O9={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},HN={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function B9(t){const e=t.map(a=>({data:a,offset:0,dataLen:0,dirty:0}));let r=0,n=0,i=0;for(let a=0;a<e.length;a++){const s=e[a];if(r=HN[s.data.type],s.data.size>1&&(r=Math.max(r,16)*s.data.size),s.dataLen=r,n%r!==0&&n<16){const o=n%r%16;n+=o,i+=o}n+r>16?(i=Math.ceil(i/16)*16,s.offset=i,i+=r,n=r):(s.offset=i,n+=r,i+=r)}return i=Math.ceil(i/16)*16,{uboElements:e,size:i}}function R9(t,e){const r=[];for(const n in t)e[n]&&r.push(e[n]);return r.sort((n,i)=>n.index-i.index),r}function P9(t,e){if(!t.autoManage)return{size:0,syncFunc:F9};const r=R9(t.uniforms,e),{uboElements:n,size:i}=B9(r),a=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let s=0;s<n.length;s++){const o=n[s],l=t.uniforms[o.data.name],u=o.data.name;let c=!1;for(let f=0;f<zf.length;f++){const h=zf[f];if(h.codeUbo&&h.test(o.data,l)){a.push(`offset = ${o.offset/4};`,zf[f].codeUbo(o.data.name,l)),c=!0;break}}if(!c)if(o.data.size>1){const f=_N(o.data.type),h=Math.max(HN[o.data.type]/16,1),p=f/h,m=(4-p%4)%4;a.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${o.offset/4};

                t = 0;

                for(var i=0; i < ${o.data.size*h}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{const f=O9[o.data.type];a.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${o.offset/4};
                ${f};
                `)}}return a.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",a.join(`
`))}}let $9=0;const Vp={textureCount:0,uboCount:0};class WN{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=$9++}systemCheck(){if(!u9())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,r){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const n=e.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),r||(Vp.textureCount=0,Vp.uboCount=0,this.syncUniformGroup(e.uniformGroup,Vp)),i}setUniforms(e){const r=this.shader.program,n=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(n.uniformData,e,this.renderer)}syncUniformGroup(e,r){const n=this.getGlProgram();(!e.static||e.dirtyId!==n.uniformDirtyGroups[e.id])&&(n.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,n,r))}syncUniforms(e,r,n){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(r.uniformData,e.uniforms,this.renderer,n)}createSyncGroups(e){const r=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=n9(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[r],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,r){const n=this.getGlProgram();if(!e.static||e.dirtyId!==0||!n.uniformGroups[e.id]){e.dirtyId=0;const i=n.uniformGroups[e.id]||this.createSyncBufferGroup(e,n,r);e.buffer.update(),i(n.uniformData,e.uniforms,this.renderer,Vp,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,n.uniformBufferBindings[r])}createSyncBufferGroup(e,r,n){const{gl:i}=this.renderer;this.renderer.buffer.bind(e.buffer);const a=this.gl.getUniformBlockIndex(r.program,n);r.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(r.program,a,this.shader.uniformBindCount),this.shader.uniformBindCount++;const s=this.getSignature(e,this.shader.program.uniformData,"ubo");let o=this._uboCache[s];if(o||(o=this._uboCache[s]=P9(e,this.shader.program.uniformData)),e.autoManage){const l=new Float32Array(o.size/4);e.buffer.update(l)}return r.uniformGroups[e.id]=o.syncFunc,r.uniformGroups[e.id]}getSignature(e,r,n){const i=e.uniforms,a=[`${n}-`];for(const s in i)a.push(s),r[s]&&a.push(r[s].type);return a.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const r=this.gl,n=e.program,i=I9(r,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}WN.extension={type:Tt.RendererSystem,name:"shader"};Lt.add(WN);class VN{constructor(e){this.renderer=e}run(e){const r=this.renderer;r.emitWithCustomOptions(r.runners.init,e),e.hello&&console.log(`PixiJS 7.1.0 - ${r.rendererLogId} - https://pixijs.com`),r.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}}VN.extension={type:[Tt.RendererSystem,Tt.CanvasRendererSystem],name:"startup"};Lt.add(VN);function k9(t,e=[]){return e[Zt.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.ADD]=[t.ONE,t.ONE],e[Zt.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.NONE]=[0,0],e[Zt.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[Zt.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Zt.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Zt.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Zt.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Zt.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[Zt.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Zt.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Zt.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Zt.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Zt.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}const L9=0,U9=1,z9=2,G9=3,q9=4,H9=5,p1=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Zt.NONE,this._blendEq=!1,this.map=[],this.map[L9]=this.setBlend,this.map[U9]=this.setOffset,this.map[z9]=this.setCullFace,this.map[G9]=this.setDepthTest,this.map[q9]=this.setFrontFace,this.map[H9]=this.setDepthMask,this.checks=[],this.defaultState=new xu,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=k9(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,r=0;for(;e;)e&1&&this.map[r].call(this,!!(t.data&1<<r)),e=e>>1,r++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(p1.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(p1.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],r=this.gl;e.length===2?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const r=this.checks.indexOf(t);e&&r===-1?this.checks.push(t):!e&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};let XN=p1;XN.extension={type:Tt.RendererSystem,name:"state"};Lt.add(XN);class W9 extends Rd{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const r=(e.priority??[]).filter(i=>e.systems[i]),n=[...r,...Object.keys(e.systems).filter(i=>!r.includes(i))];for(const i of n)this.addSystem(e.systems[i],i)}addRunners(...e){e.forEach(r=>{this.runners[r]=new $s(r)})}addSystem(e,r){const n=new e(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=n,this._systemsHash[r]=n;for(const i in this.runners)this.runners[i].add(n);return this}emitWithCustomOptions(e,r){const n=Object.keys(this._systemsHash);e.items.forEach(i=>{const a=n.find(s=>this._systemsHash[s]===i);i[e.name](r[a])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const Pm=class{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=Pm.defaultMaxIdle,this.checkCountMax=Pm.defaultCheckCountMax,this.mode=Pm.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==gb.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let r=!1;for(let n=0;n<e.length;n++){const i=e[n];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),e[n]=null,r=!0)}if(r){let n=0;for(let i=0;i<e.length;i++)e[i]!==null&&(e[n++]=e[i]);e.length=n}}unload(t){const e=this.renderer.texture,r=t._texture;r&&!r.framebuffer&&e.destroyTexture(r);for(let n=t.children.length-1;n>=0;n--)this.unload(t.children[n])}destroy(){this.renderer=null}};let Os=Pm;Os.defaultMode=gb.AUTO;Os.defaultMaxIdle=60*60;Os.defaultCheckCountMax=60*10;Os.extension={type:Tt.RendererSystem,name:"textureGC"};Lt.add(Os);class W0{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=Ht.UNSIGNED_BYTE,this.internalFormat=wt.RGBA,this.samplerType=0}}function V9(t){let e;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?e={[Ht.UNSIGNED_BYTE]:{[wt.RGBA]:t.RGBA8,[wt.RGB]:t.RGB8,[wt.RG]:t.RG8,[wt.RED]:t.R8,[wt.RGBA_INTEGER]:t.RGBA8UI,[wt.RGB_INTEGER]:t.RGB8UI,[wt.RG_INTEGER]:t.RG8UI,[wt.RED_INTEGER]:t.R8UI,[wt.ALPHA]:t.ALPHA,[wt.LUMINANCE]:t.LUMINANCE,[wt.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[Ht.BYTE]:{[wt.RGBA]:t.RGBA8_SNORM,[wt.RGB]:t.RGB8_SNORM,[wt.RG]:t.RG8_SNORM,[wt.RED]:t.R8_SNORM,[wt.RGBA_INTEGER]:t.RGBA8I,[wt.RGB_INTEGER]:t.RGB8I,[wt.RG_INTEGER]:t.RG8I,[wt.RED_INTEGER]:t.R8I},[Ht.UNSIGNED_SHORT]:{[wt.RGBA_INTEGER]:t.RGBA16UI,[wt.RGB_INTEGER]:t.RGB16UI,[wt.RG_INTEGER]:t.RG16UI,[wt.RED_INTEGER]:t.R16UI,[wt.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[Ht.SHORT]:{[wt.RGBA_INTEGER]:t.RGBA16I,[wt.RGB_INTEGER]:t.RGB16I,[wt.RG_INTEGER]:t.RG16I,[wt.RED_INTEGER]:t.R16I},[Ht.UNSIGNED_INT]:{[wt.RGBA_INTEGER]:t.RGBA32UI,[wt.RGB_INTEGER]:t.RGB32UI,[wt.RG_INTEGER]:t.RG32UI,[wt.RED_INTEGER]:t.R32UI,[wt.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[Ht.INT]:{[wt.RGBA_INTEGER]:t.RGBA32I,[wt.RGB_INTEGER]:t.RGB32I,[wt.RG_INTEGER]:t.RG32I,[wt.RED_INTEGER]:t.R32I},[Ht.FLOAT]:{[wt.RGBA]:t.RGBA32F,[wt.RGB]:t.RGB32F,[wt.RG]:t.RG32F,[wt.RED]:t.R32F,[wt.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[Ht.HALF_FLOAT]:{[wt.RGBA]:t.RGBA16F,[wt.RGB]:t.RGB16F,[wt.RG]:t.RG16F,[wt.RED]:t.R16F},[Ht.UNSIGNED_SHORT_5_6_5]:{[wt.RGB]:t.RGB565},[Ht.UNSIGNED_SHORT_4_4_4_4]:{[wt.RGBA]:t.RGBA4},[Ht.UNSIGNED_SHORT_5_5_5_1]:{[wt.RGBA]:t.RGB5_A1},[Ht.UNSIGNED_INT_2_10_10_10_REV]:{[wt.RGBA]:t.RGB10_A2,[wt.RGBA_INTEGER]:t.RGB10_A2UI},[Ht.UNSIGNED_INT_10F_11F_11F_REV]:{[wt.RGB]:t.R11F_G11F_B10F},[Ht.UNSIGNED_INT_5_9_9_9_REV]:{[wt.RGB]:t.RGB9_E5},[Ht.UNSIGNED_INT_24_8]:{[wt.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[Ht.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[wt.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:e={[Ht.UNSIGNED_BYTE]:{[wt.RGBA]:t.RGBA,[wt.RGB]:t.RGB,[wt.ALPHA]:t.ALPHA,[wt.LUMINANCE]:t.LUMINANCE,[wt.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[Ht.UNSIGNED_SHORT_5_6_5]:{[wt.RGB]:t.RGB},[Ht.UNSIGNED_SHORT_4_4_4_4]:{[wt.RGBA]:t.RGBA},[Ht.UNSIGNED_SHORT_5_5_5_1]:{[wt.RGBA]:t.RGBA}},e}class jN{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new pr,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=V9(e);const r=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let i=0;i<r;i++)this.boundTextures[i]=null;this.emptyTextures={};const n=new W0(e.createTexture());e.bindTexture(e.TEXTURE_2D,n.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=n,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new W0(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(e,r=0){const{gl:n}=this;if(e=e==null?void 0:e.castToBaseTexture(),e!=null&&e.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[r]!==e&&(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[r]=e}else this.currentLocation!==r&&(this.currentLocation=r,n.activeTexture(n.TEXTURE0+r)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:r,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<n.length;i++)n[i]===e&&(this.currentLocation!==i&&(r.activeTexture(r.TEXTURE0+i),this.currentLocation=i),r.bindTexture(e.target,this.emptyTextures[e.target].texture),n[i]=null)}ensureSamplerType(e){const{boundTextures:r,hasIntegerTextures:n,CONTEXT_UID:i}=this;if(n)for(let a=e-1;a>=0;--a){const s=r[a];s&&s._glTextures[i].samplerType!==Vy.FLOAT&&this.renderer.texture.unbind(s)}}initTexture(e){const r=new W0(this.gl.createTexture());return r.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),r}initTextureType(e,r){var n;r.internalFormat=((n=this.internalFormats[e.type])==null?void 0:n[e.format])??e.format,this.webGLVersion===2&&e.type===Ht.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=e.type}updateTexture(e){var i;const r=e._glTextures[this.CONTEXT_UID];if(!r)return;const n=this.renderer;if(this.initTextureType(e,r),(i=e.resource)!=null&&i.upload(n,e,r))r.samplerType!==Vy.FLOAT&&(this.hasIntegerTextures=!0);else{const a=e.realWidth,s=e.realHeight,o=n.gl;(r.width!==a||r.height!==s||r.dirtyId<0)&&(r.width=a,r.height=s,o.texImage2D(e.target,0,r.internalFormat,a,s,0,e.format,r.type,null))}e.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(e),r.dirtyId=e.dirtyId}destroyTexture(e,r){const{gl:n}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),n.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!r)){const i=this.managedTextures.indexOf(e);i!==-1&&Lf(this.managedTextures,i,1)}}updateTextureStyle(e){var n;const r=e._glTextures[this.CONTEXT_UID];r&&((e.mipmap===xo.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?r.mipmap=!1:r.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?r.wrapMode=al.CLAMP:r.wrapMode=e.wrapMode,(n=e.resource)!=null&&n.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)}setStyle(e,r){const n=this.gl;if(r.mipmap&&e.mipmap!==xo.ON_MANUAL&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,r.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===ou.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===ou.LINEAR){const a=Math.min(e.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,a)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===ou.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode===ou.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}jN.extension={type:Tt.RendererSystem,name:"texture"};Lt.add(jN);class YN{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glTransformFeedbacks[n]||this.createGLTransformFeedback(e);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,r){const{gl:n,renderer:i}=this;r&&i.shader.bind(r),n.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:r,renderer:n,CONTEXT_UID:i}=this,a=r.createTransformFeedback();e._glTransformFeedbacks[i]=a,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,a);for(let s=0;s<e.buffers.length;s++){const o=e.buffers[s];o&&(n.buffer.update(o),o._glBuffers[i].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,s,o._glBuffers[i].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),a}disposeTransformFeedback(e,r){const n=e._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this);const a=this.renderer.buffer;if(a)for(let s=0;s<e.buffers.length;s++){const o=e.buffers[s];if(!o)continue;const l=o._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!r&&a.dispose(o,r))}n&&(r||i.deleteTransformFeedback(n),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}YN.extension={type:Tt.RendererSystem,name:"transformFeedback"};Lt.add(YN);class KN{constructor(e){this.renderer=e}init(e){this.screen=new Br(0,0,e.width,e.height),this.element=e.view||Nt.ADAPTER.createCanvas(),this.resolution=e.resolution||Nt.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,r){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(r*this.resolution);const n=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",n,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var r;e&&((r=this.element.parentNode)==null||r.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}KN.extension={type:[Tt.RendererSystem,Tt.CanvasRendererSystem],name:"_view"};Lt.add(KN);Nt.PREFER_ENV=Sc.WEBGL2;Nt.STRICT_TEXTURE_CACHE=!1;Object.defineProperties(Nt,{WRAP_MODE:{get(){return pr.defaultOptions.wrapMode},set(t){qr("7.1.0","settings.WRAP_MODE is deprecated, use BaseTeture.defaultOptions.wrapMode"),pr.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return pr.defaultOptions.scaleMode},set(t){qr("7.1.0","settings.SCALE_MODE is deprecated, use BaseTeture.defaultOptions.scaleMode"),pr.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return pr.defaultOptions.mipmap},set(t){qr("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTeture.defaultOptions.mipmap"),pr.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return pr.defaultOptions.anisotropicLevel},set(t){qr("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTeture.defaultOptions.anisotropicLevel"),pr.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return qr("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Wi.defaultResolution},set(t){Wi.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return qr("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Wi.defaultMultisample},set(t){Wi.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return Fs.defaultMaxTextures},set(t){qr("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Fs.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return Fs.defaultBatchSize},set(t){qr("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Fs.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return Fs.canUploadSameBuffer},set(t){qr("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Fs.canUploadSameBuffer=t}},GC_MODE:{get(){return Os.defaultMode},set(t){qr("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Os.defaultMode=t}},GC_MAX_IDLE:{get(){return Os.defaultMaxIdle},set(t){qr("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Os.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return Os.defaultCheckCountMax},set(t){qr("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Os.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return Rs.defaultVertexPrecision},set(t){qr("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Rs.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return Rs.defaultFragmentPrecision},set(t){qr("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Rs.defaultFragmentPrecision=t}}});var Kf=(t=>(t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Kf||{});class V0{constructor(e,r=null,n=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=r,this.priority=n,this.once=i}match(e,r=null){return this.fn===e&&this.context===r}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=e?null:r,this.previous=null,r}}const Ea=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new V0(null,null,1/0),this.deltaMS=1/Ea.targetFPMS,this.elapsedMS=1/Ea.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,r=Kf.NORMAL){return this._addListener(new V0(t,e,r))}addOnce(t,e,r=Kf.NORMAL){return this._addListener(new V0(t,e,r,!0))}_addListener(t){let e=this._head.next,r=this._head;if(!e)t.connect(r);else{for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}return this._startIfPossible(),this}remove(t,e){let r=this._head.next;for(;r;)r.match(t,e)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Ea.targetFPMS;const r=this._head;let n=r.next;for(;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,Ea.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!Ea._shared){const t=Ea._shared=new Ea;t.autoStart=!0,t._protected=!0}return Ea._shared}static get system(){if(!Ea._system){const t=Ea._system=new Ea;t.autoStart=!0,t._protected=!0}return Ea._system}};let da=Ea;da.targetFPMS=.06;Object.defineProperties(Nt,{TARGET_FPMS:{get(){return da.targetFPMS},set(t){qr("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),da.targetFPMS=t}}});class ZN{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,Kf.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?da.shared:new da,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}ZN.extension=Tt.Application;Lt.add(ZN);const QN=[];Lt.handleByList(Tt.Renderer,QN);function X9(t){for(const e of QN)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}var j9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Y9=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const K9=j9,JN=Y9;class eM{constructor(e){this.renderer=e}contextChange(e){let r;if(this.renderer.context.webGLVersion===1){const n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{const n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),r=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}r>=zn.HIGH?this.multisample=zn.HIGH:r>=zn.MEDIUM?this.multisample=zn.MEDIUM:r>=zn.LOW?this.multisample=zn.LOW:this.multisample=zn.NONE}destroy(){}}eM.extension={type:Tt.RendererSystem,name:"_multisample"};Lt.add(eM);class Z9{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class tM{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);r.bindBuffer(e.type,i.buffer)}unbind(e){const{gl:r}=this;r.bindBuffer(e,null)}bindBufferBase(e,r){const{gl:n,CONTEXT_UID:i}=this;if(this.boundBufferBases[r]!==e){const a=e._glBuffers[i]||this.createGLBuffer(e);this.boundBufferBases[r]=e,n.bindBufferBase(n.UNIFORM_BUFFER,r,a.buffer)}}bindBufferRange(e,r,n){const{gl:i,CONTEXT_UID:a}=this;n=n||0;const s=e._glBuffers[a]||this.createGLBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,r||0,s.buffer,n*256,256)}update(e){const{gl:r,CONTEXT_UID:n}=this,i=e._glBuffers[n]||this.createGLBuffer(e);if(e._updateID!==i.updateID)if(i.updateID=e._updateID,r.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength)r.bufferSubData(e.type,0,e.data);else{const a=e.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;i.byteLength=e.data.byteLength,r.bufferData(e.type,e.data,a)}}dispose(e,r){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const n=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),n&&(r||i.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const r=Object.keys(this.managedBuffers);for(let n=0;n<r.length;n++)this.dispose(this.managedBuffers[r[n]],e)}createGLBuffer(e){const{CONTEXT_UID:r,gl:n}=this;return e._glBuffers[r]=new Z9(n.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[r]}}tM.extension={type:Tt.RendererSystem,name:"buffer"};Lt.add(tM);class rM{constructor(e){this.renderer=e}render(e,r){const n=this.renderer;let i,a,s,o;if(r&&(i=r.renderTexture,a=r.clear,s=r.transform,o=r.skipUpdateTransform),this.renderingToScreen=!i,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=s,!n.context.isLost){if(i||(this.lastObjectRendered=e),!o){const l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}n.renderTexture.bind(i),n.batch.currentRenderer.start(),(a??n.background.clearBeforeRender)&&n.renderTexture.clear(),e.render(n),n.batch.currentRenderer.flush(),i&&(r.blit&&n.framebuffer.blit(),i.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}rM.extension={type:Tt.RendererSystem,name:"objectRenderer"};Lt.add(rM);const m1=class extends W9{constructor(t){super(),t=Object.assign({},Nt.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ks({projectionMatrix:new qn},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:m1.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(qr("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha);const r={hello:t.hello,_plugin:m1.__plugins,background:{alpha:t.backgroundAlpha,color:t.background??t.backgroundColor,clearBeforeRender:t.clearBeforeRender},_view:{height:t.height,width:t.width,autoDensity:t.autoDensity,resolution:t.resolution,view:t.view},context:{antialias:t.antialias,context:t.context,powerPreference:t.powerPreference,premultipliedAlpha:t.premultipliedAlpha,preserveDrawingBuffer:t.preserveDrawingBuffer}};this.startup.run(r),this.options=t}static test(t){return t!=null&&t.forceCanvas?!1:VL()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return qr("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return qr("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return qr("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return qr("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){qr("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return qr("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.color}set backgroundAlpha(t){qr("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return qr("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};let yh=m1;yh.extension={type:Tt.Renderer,priority:1};yh.__plugins={};yh.__systems={};Lt.handleByMap(Tt.RendererPlugin,yh.__plugins);Lt.handleByMap(Tt.RendererSystem,yh.__systems);Lt.add(yh);class nM extends Dd{constructor(e,r){const{width:n,height:i}=r||{};super(n,i),this.items=[],this.itemDirtyIds=[];for(let a=0;a<e;a++){const s=new pr;this.items.push(s),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,r){for(let n=0;n<this.length;n++)e[n]&&(e[n].castToBaseTexture?this.addBaseTextureAt(e[n].castToBaseTexture(),n):e[n]instanceof Dd?this.addResourceAt(e[n],n):this.addResourceAt(vN(e[n],r),n))}dispose(){for(let e=0,r=this.length;e<r;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[r].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)}unbind(e){super.unbind(e);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)}load(){if(this._load)return this._load;const r=this.items.map(n=>n.resource).filter(n=>n).map(n=>n.load());return this._load=Promise.all(r).then(()=>{const{realWidth:n,realHeight:i}=this.items[0];return this.resize(n,i),Promise.resolve(this)}),this._load}}class Q9 extends nM{constructor(e,r){const{width:n,height:i}=r||{};let a,s;Array.isArray(e)?(a=e,s=e.length):s=e,super(s,{width:n,height:i}),a&&this.initFromArray(a,r)}addBaseTextureAt(e,r){if(e.resource)this.addResourceAt(e.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Pf.TEXTURE_2D_ARRAY}upload(e,r,n){const{length:i,itemDirtyIds:a,items:s}=this,{gl:o}=e;n.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,i,0,r.format,n.type,null);for(let l=0;l<i;l++){const u=s[l];a[l]<u.dirtyId&&(a[l]=u.dirtyId,u.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,l,u.resource.width,u.resource.height,1,r.format,n.type,u.resource.source))}return!0}}class J9 extends ll{constructor(e){super(e)}static test(e){const{OffscreenCanvas:r}=globalThis;return r&&e instanceof r?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const cd=class extends nM{constructor(t,e){const{width:r,height:n,autoLoad:i,linkBaseTexture:a}=e||{};if(t&&t.length!==cd.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:r,height:n});for(let s=0;s<cd.SIDES;s++)this.items[s].target=Pf.TEXTURE_CUBE_MAP_POSITIVE_X+s;this.linkBaseTexture=a!==!1,t&&this.initFromArray(t,e),i!==!1&&this.load()}bind(t){super.bind(t),t.target=Pf.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=Pf.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,r){const n=this.itemDirtyIds;for(let i=0;i<cd.SIDES;i++){const a=this.items[i];(n[i]<a.dirtyId||r.dirtyId<e.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(t,a,r),n[i]=a.dirtyId):n[i]<-1&&(t.gl.texImage2D(a.target,0,r.internalFormat,e.realWidth,e.realHeight,0,e.format,r.type,null),n[i]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===cd.SIDES}};let iM=cd;iM.SIDES=6;class Nf extends ll{constructor(e,r){var n=(...i)=>{super(...i)};r=r||{},typeof e=="string"?(n(Nf.EMPTY),this.url=e):(n(e),this.url=null),this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,r)=>{if(this.url===null){e(this);return}try{const n=await Nt.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await n.blob();if(this.destroyed)return;const a=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Us.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=a,this.update(),e(this)}catch(n){if(this.destroyed)return;r(n),this.onError.emit(n)}}),this._load)}upload(e,r,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(e,r,n)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return Nf._EMPTY=Nf._EMPTY??Nt.ADAPTER.createCanvas(0,0),Nf._EMPTY}}const $m=class extends ll{constructor(t,e){e=e||{},super(Nt.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),t(this)},$m.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const t=new Image;ll.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,r=t.height;if(!e||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let n=e*this.scale,i=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(n=this._overrideWidth||this._overrideHeight/r*e,i=this._overrideHeight||this._overrideWidth/e*r),n=Math.round(n),i=Math.round(i);const a=this.source;a.width=n,a.height=i,a._pixiId=`canvas_${yc()}`,a.getContext("2d").drawImage(t,0,0,e,r,0,0,n,i),this._resolve(),this._resolve=null}}static getSize(t){const e=$m.SVG_SIZE.exec(t),r={};return e&&(r[e[1]]=Math.round(parseFloat(e[3])),r[e[5]]=Math.round(parseFloat(e[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&$m.SVG_XML.test(t)}};let Cd=$m;Cd.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;Cd.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const v1=class extends ll{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),typeof t=="string"&&(t=[t]);const n=t[0].src||t[0];ll.crossOrigin(r,n,e.crossorigin);for(let i=0;i<t.length;++i){const a=document.createElement("source");let{src:s,mime:o}=t[i];s=s||t[i];const l=s.split("?").shift().toLowerCase(),u=l.slice(l.lastIndexOf(".")+1);o=o||v1.MIME_TYPES[u]||`video/${u}`,a.src=s,a.type=o,r.appendChild(a)}t=r}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){const e=da.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise(e=>{this.valid?e(this):(this._resolve=e,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(da.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(da.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._isConnectedToTicker&&(da.shared.remove(this.update,this),this._isConnectedToTicker=!1);const t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(da.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(da.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t)}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||v1.TYPES.includes(e)}};let Fb=v1;Fb.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];Fb.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};l1.push(Nf,TN,J9,Fb,Cd,kd,iM,Q9);class rv{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?Br.EMPTY:(e=e||new Br(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,r){const{a:n,b:i,c:a,d:s,tx:o,ty:l}=e,u=n*r.x+a*r.y+o,c=i*r.x+s*r.y+l;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(e){let r=this.minX,n=this.minY,i=this.maxX,a=this.maxY,s=e[0],o=e[1];r=s<r?s:r,n=o<n?o:n,i=s>i?s:i,a=o>a?o:a,s=e[2],o=e[3],r=s<r?s:r,n=o<n?o:n,i=s>i?s:i,a=o>a?o:a,s=e[4],o=e[5],r=s<r?s:r,n=o<n?o:n,i=s>i?s:i,a=o>a?o:a,s=e[6],o=e[7],r=s<r?s:r,n=o<n?o:n,i=s>i?s:i,a=o>a?o:a,this.minX=r,this.minY=n,this.maxX=i,this.maxY=a}addFrame(e,r,n,i,a){this.addFrameMatrix(e.worldTransform,r,n,i,a)}addFrameMatrix(e,r,n,i,a){const s=e.a,o=e.b,l=e.c,u=e.d,c=e.tx,f=e.ty;let h=this.minX,p=this.minY,m=this.maxX,v=this.maxY,y=s*r+l*n+c,x=o*r+u*n+f;h=y<h?y:h,p=x<p?x:p,m=y>m?y:m,v=x>v?x:v,y=s*i+l*n+c,x=o*i+u*n+f,h=y<h?y:h,p=x<p?x:p,m=y>m?y:m,v=x>v?x:v,y=s*r+l*a+c,x=o*r+u*a+f,h=y<h?y:h,p=x<p?x:p,m=y>m?y:m,v=x>v?x:v,y=s*i+l*a+c,x=o*i+u*a+f,h=y<h?y:h,p=x<p?x:p,m=y>m?y:m,v=x>v?x:v,this.minX=h,this.minY=p,this.maxX=m,this.maxY=v}addVertexData(e,r,n){let i=this.minX,a=this.minY,s=this.maxX,o=this.maxY;for(let l=r;l<n;l+=2){const u=e[l],c=e[l+1];i=u<i?u:i,a=c<a?c:a,s=u>s?u:s,o=c>o?c:o}this.minX=i,this.minY=a,this.maxX=s,this.maxY=o}addVertices(e,r,n,i){this.addVerticesMatrix(e.worldTransform,r,n,i)}addVerticesMatrix(e,r,n,i,a=0,s=a){const o=e.a,l=e.b,u=e.c,c=e.d,f=e.tx,h=e.ty;let p=this.minX,m=this.minY,v=this.maxX,y=this.maxY;for(let x=n;x<i;x+=2){const S=r[x],b=r[x+1],A=o*S+u*b+f,E=c*b+l*S+h;p=Math.min(p,A-a),v=Math.max(v,A+a),m=Math.min(m,E-s),y=Math.max(y,E+s)}this.minX=p,this.minY=m,this.maxX=v,this.maxY=y}addBounds(e){const r=this.minX,n=this.minY,i=this.maxX,a=this.maxY;this.minX=e.minX<r?e.minX:r,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>a?e.maxY:a}addBoundsMask(e,r){const n=e.minX>r.minX?e.minX:r.minX,i=e.minY>r.minY?e.minY:r.minY,a=e.maxX<r.maxX?e.maxX:r.maxX,s=e.maxY<r.maxY?e.maxY:r.maxY;if(n<=a&&i<=s){const o=this.minX,l=this.minY,u=this.maxX,c=this.maxY;this.minX=n<o?n:o,this.minY=i<l?i:l,this.maxX=a>u?a:u,this.maxY=s>c?s:c}}addBoundsMatrix(e,r){this.addFrameMatrix(r,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,r){const n=e.minX>r.x?e.minX:r.x,i=e.minY>r.y?e.minY:r.y,a=e.maxX<r.x+r.width?e.maxX:r.x+r.width,s=e.maxY<r.y+r.height?e.maxY:r.y+r.height;if(n<=a&&i<=s){const o=this.minX,l=this.minY,u=this.maxX,c=this.maxY;this.minX=n<o?n:o,this.minY=i<l?i:l,this.maxX=a>u?a:u,this.maxY=s>c?s:c}}pad(e=0,r=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=r,this.maxY+=r)}addFramePad(e,r,n,i,a,s){e-=a,r-=s,n+=a,i+=s,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>i?this.maxY:i}}class wn extends Rd{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Ib,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new rv,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const r=Object.keys(e);for(let n=0;n<r.length;++n){const i=r[n];Object.defineProperty(wn.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,r){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new Br),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new Br),e=this._localBoundsRect),this._localBounds||(this._localBounds=new rv);const r=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,a=this._boundsID;this._bounds=this._localBounds;const s=this.getBounds(!1,e);return this.parent=n,this.transform=r,this._bounds=i,this._bounds.updateID+=this._boundsID-a,s}toGlobal(e,r,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,r)}toLocal(e,r,n,i){return r&&(e=r.toGlobal(e,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,r=0,n=1,i=1,a=0,s=0,o=0,l=0,u=0){return this.position.x=e,this.position.y=r,this.scale.x=n||1,this.scale.y=i||1,this.rotation=a,this.skew.x=s,this.skew.y=o,this.pivot.x=l,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new ez),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*K7}set angle(e){this.transform.rotation=e*Z7}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=e,this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}}class ez extends wn{constructor(){super(...arguments),this.sortDirty=null}}wn.prototype.displayObjectUpdateTransform=wn.prototype.updateTransform;const tz=new qn;function rz(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const g1=class extends wn{constructor(){super(),this.children=[],this.sortableChildren=g1.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const r=this.getChildIndex(t),n=this.getChildIndex(e);this.children[r]=e,this.children[n]=t,this.onChildrenChange(r<n?r:n)}getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const r=this.getChildIndex(t);Lf(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],r=this.children.indexOf(e);if(r===-1)return null;e.parent=null,e.transform._parentID=-1,Lf(this.children,r,1),this._boundsID++,this.onChildrenChange(r),e.emit("removed",this),this.emit("childRemoved",e,this,r)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Lf(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const r=t,n=e,i=n-r;let a;if(i>0&&i<=n){a=this.children.splice(r,i);for(let s=0;s<a.length;++s)a[s].parent=null,a[s].transform&&(a[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let s=0;s<a.length;++s)a[s].emit("removed",this),this.emit("childRemoved",a[s],this,s);return a}else if(i===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,r=this.children.length;e<r;++e){const n=this.children[e];n._lastSortedIndex=e,!t&&n.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(rz),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const r=this.children[t];r.visible&&r.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){const r=e._mask.isMaskData?e._mask.maskObject:e._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const r=super.getLocalBounds(t);if(!e)for(let n=0,i=this.children.length;n<i;++n){const a=this.children[n];a.visible&&a.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let r,n;this.cullArea?(r=this.cullArea,n=this.worldTransform):this._render!==g1.prototype._render&&(r=this.getBounds(!0));const i=t.projection.transform;if(i&&(n?(n=tz.copyFrom(n),n.prepend(i)):n=i),r&&e.intersects(r,n))this._render(t);else if(this.cullArea)return;for(let a=0,s=this.children.length;a<s;++a){const o=this.children[a],l=o.cullable;o.cullable=l||!this.cullArea,o.render(t),o.cullable=l}}render(t){var e;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(e=this.filters)!=null&&e.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let r=0,n=this.children.length;r<n;++r)this.children[r].render(t)}}renderAdvanced(t){var i,a,s;const e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let o=0;o<e.length;o++)e[o].enabled&&this._enabledFilters.push(e[o])}const n=e&&((i=this._enabledFilters)==null?void 0:i.length)||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==jn.NONE));if(n&&t.batch.flush(),e&&((a=this._enabledFilters)!=null&&a.length)&&t.filter.push(this,this._enabledFilters),r&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let o=0,l=this.children.length;o<l;++o)this.children[o].render(t)}n&&t.batch.flush(),r&&t.mask.pop(this),e&&((s=this._enabledFilters)!=null&&s.length)&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e=typeof t=="boolean"?t:t==null?void 0:t.children,r=this.removeChildren(0,this.children.length);if(e)for(let n=0;n<r.length;++n)r[n].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;e!==0?this.scale.x=t/e:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;e!==0?this.scale.y=t/e:this.scale.y=1,this._height=t}};let Ca=g1;Ca.defaultSortableChildren=!1;Ca.prototype.containerUpdateTransform=Ca.prototype.updateTransform;Object.defineProperties(Nt,{SORTABLE_CHILDREN:{get(){return Ca.defaultSortableChildren},set(t){qr("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Ca.defaultSortableChildren=t}}});const rd=new zr,nz=new Uint16Array([0,1,2,0,2,3]);class bh extends Ca{constructor(e){super(),this._anchor=new tl(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=Zt.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||kt.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=nz,this.pluginName="batch",this.isSprite=!0,this._roundPixels=Nt.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Tf(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Tf(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const r=this.transform.worldTransform,n=r.a,i=r.b,a=r.c,s=r.d,o=r.tx,l=r.ty,u=this.vertexData,c=e.trim,f=e.orig,h=this._anchor;let p=0,m=0,v=0,y=0;if(c?(m=c.x-h._x*f.width,p=m+c.width,y=c.y-h._y*f.height,v=y+c.height):(m=-h._x*f.width,p=m+f.width,y=-h._y*f.height,v=y+f.height),u[0]=n*m+a*y+o,u[1]=s*y+i*m+l,u[2]=n*p+a*y+o,u[3]=s*y+i*p+l,u[4]=n*p+a*v+o,u[5]=s*v+i*p+l,u[6]=n*m+a*v+o,u[7]=s*v+i*m+l,this._roundPixels){const x=Nt.RESOLUTION;for(let S=0;S<u.length;++S)u[S]=Math.round(u[S]*x)/x}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,r=this.vertexTrimmedData,n=e.orig,i=this._anchor,a=this.transform.worldTransform,s=a.a,o=a.b,l=a.c,u=a.d,c=a.tx,f=a.ty,h=-i._x*n.width,p=h+n.width,m=-i._y*n.height,v=m+n.height;r[0]=s*h+l*m+c,r[1]=u*m+o*h+f,r[2]=s*p+l*m+c,r[3]=u*m+o*p+f,r[4]=s*p+l*v+c,r[5]=u*v+o*p+f,r[6]=s*h+l*v+c,r[7]=u*v+o*h+f}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,r=this._texture.orig;!e||e.width===r.width&&e.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new rv),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Br),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,rd);const r=this._texture.orig.width,n=this._texture.orig.height,i=-r*this.anchor.x;let a=0;return rd.x>=i&&rd.x<i+r&&(a=-n*this.anchor.y,rd.y>=a&&rd.y<a+n)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const n=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!n)}this._texture=null}static from(e,r){const n=e instanceof kt?e:kt.from(e,r);return new bh(n)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const r=Tf(this.scale.x)||1;this.scale.x=r*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const r=Tf(this.scale.y)||1;this.scale.y=r*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tint}set tint(e){this._tint=e,this._tintRGB=(e>>16)+(e&65280)+((e&255)<<16)}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||kt.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const aM=new qn;wn.prototype._cacheAsBitmap=!1;wn.prototype._cacheData=null;wn.prototype._cacheAsBitmapResolution=null;wn.prototype._cacheAsBitmapMultisample=null;class iz{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(wn.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;this._cacheAsBitmap=t;let e;t?(this._cacheData||(this._cacheData=new iz),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});wn.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))};wn.prototype._initCachedDisplayObject=function(e){var h,p;if((h=this._cacheData)!=null&&h.sprite)return;const r=this.alpha;this.alpha=1,e.batch.flush();const n=this.getLocalBounds(null,!0).clone();if((p=this.filters)!=null&&p.length){const m=this.filters[0].padding;n.pad(m)}n.ceil(Nt.RESOLUTION);const i=e.renderTexture.current,a=e.renderTexture.sourceFrame.clone(),s=e.renderTexture.destinationFrame.clone(),o=e.projection.transform,l=cl.create({width:n.width,height:n.height,resolution:this.cacheAsBitmapResolution||e.resolution,multisample:this.cacheAsBitmapMultisample??e.multisample}),u=`cacheAsBitmap_${yc()}`;this._cacheData.textureCacheId=u,pr.addToCache(l.baseTexture,u),kt.addToCache(l,u);const c=this.transform.localTransform.copyTo(aM).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:l,clear:!0,transform:c,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=o,e.renderTexture.bind(i,a,s),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const f=new bh(l);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-(n.x/n.width),f.anchor.y=-(n.y/n.height),f.alpha=r,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=f.containsPoint.bind(f)};wn.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))};wn.prototype._initCachedDisplayObjectCanvas=function(e){var c;if((c=this._cacheData)!=null&&c.sprite)return;const r=this.getLocalBounds(null,!0),n=this.alpha;this.alpha=1;const i=e.canvasContext.activeContext,a=e._projTransform;r.ceil(Nt.RESOLUTION);const s=cl.create({width:r.width,height:r.height}),o=`cacheAsBitmap_${yc()}`;this._cacheData.textureCacheId=o,pr.addToCache(s.baseTexture,o),kt.addToCache(s,o);const l=aM;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=r.x,l.ty-=r.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:s,clear:!0,transform:l,skipUpdateTransform:!1}),e.canvasContext.activeContext=i,e._projTransform=a,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;const u=new bh(s);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(r.x/r.width),u.anchor.y=-(r.y/r.height),u.alpha=n,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)};wn.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};wn.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};wn.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,pr.removeFromCache(this._cacheData.textureCacheId),kt.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};wn.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)};wn.prototype.name=null;Ca.prototype.getChildByName=function(e,r){for(let n=0,i=this.children.length;n<i;n++)if(this.children[n].name===e)return this.children[n];if(r)for(let n=0,i=this.children.length;n<i;n++){const a=this.children[n];if(!a.getChildByName)continue;const s=a.getChildByName(e,!0);if(s)return s}return null};wn.prototype.getGlobalPosition=function(e=new zr,r=!1){return this.parent?this.parent.toGlobal(this.position,e,r):(e.x=this.position.x,e.y=this.position.y),e};var az=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class sz extends Wi{constructor(e=1){super(K9,az,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const oz={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},uz=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function lz(t){const e=oz[t],r=e.length;let n=uz,i="";const a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let s;for(let o=0;o<t;o++){let l=a.replace("%index%",o.toString());s=o,o>=r&&(s=t-o-1),l=l.replace("%value%",e[s].toString()),i+=l,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}const cz=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function fz(t,e){const r=Math.ceil(t/2);let n=cz,i="",a;e?a="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":a="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let s=0;s<t;s++){let o=a.replace("%index%",s.toString());o=o.replace("%sampleIndex%",`${s-(r-1)}.0`),i+=o,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",t.toString()),n}class y1 extends Wi{constructor(e,r=8,n=4,i=Nt.FILTER_RESOLUTION,a=5){const s=fz(a,e),o=lz(a);super(s,o),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=n,this.blur=r}apply(e,r,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/r.width):this.uniforms.strength=1/n.height*(n.height/r.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/r.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,r,n,i);else{const a=e.getFilterTexture(),s=e.renderer;let o=r,l=a;this.state.blend=!1,e.applyFilter(this,o,l,fo.CLEAR);for(let u=1;u<this.passes-1;u++){e.bindAndClear(o,fo.BLIT),this.uniforms.uSampler=l;const c=l;l=o,o=c,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,n,i),e.returnFilterTexture(a)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class hz extends Wi{constructor(e=8,r=4,n=Wi.defaultResolution,i=5){super(),this.blurXFilter=new y1(!0,e,r,n,i),this.blurYFilter=new y1(!1,e,r,n,i),this.resolution=n,this.quality=r,this.blur=e,this.repeatEdgePixels=!1}apply(e,r,n,i){const a=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(a&&s){const o=e.getFilterTexture();this.blurXFilter.apply(e,r,o,fo.CLEAR),this.blurYFilter.apply(e,o,n,i),e.returnFilterTexture(o)}else s?this.blurYFilter.apply(e,r,n,i):this.blurXFilter.apply(e,r,n,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var dz=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class b1 extends Wi{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(JN,dz,e),this.alpha=1}_loadMatrix(e,r=!1){let n=e;r&&(this._multiply(n,this.uniforms.m,e),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(e,r,n){return e[0]=r[0]*n[0]+r[1]*n[5]+r[2]*n[10]+r[3]*n[15],e[1]=r[0]*n[1]+r[1]*n[6]+r[2]*n[11]+r[3]*n[16],e[2]=r[0]*n[2]+r[1]*n[7]+r[2]*n[12]+r[3]*n[17],e[3]=r[0]*n[3]+r[1]*n[8]+r[2]*n[13]+r[3]*n[18],e[4]=r[0]*n[4]+r[1]*n[9]+r[2]*n[14]+r[3]*n[19]+r[4],e[5]=r[5]*n[0]+r[6]*n[5]+r[7]*n[10]+r[8]*n[15],e[6]=r[5]*n[1]+r[6]*n[6]+r[7]*n[11]+r[8]*n[16],e[7]=r[5]*n[2]+r[6]*n[7]+r[7]*n[12]+r[8]*n[17],e[8]=r[5]*n[3]+r[6]*n[8]+r[7]*n[13]+r[8]*n[18],e[9]=r[5]*n[4]+r[6]*n[9]+r[7]*n[14]+r[8]*n[19]+r[9],e[10]=r[10]*n[0]+r[11]*n[5]+r[12]*n[10]+r[13]*n[15],e[11]=r[10]*n[1]+r[11]*n[6]+r[12]*n[11]+r[13]*n[16],e[12]=r[10]*n[2]+r[11]*n[7]+r[12]*n[12]+r[13]*n[17],e[13]=r[10]*n[3]+r[11]*n[8]+r[12]*n[13]+r[13]*n[18],e[14]=r[10]*n[4]+r[11]*n[9]+r[12]*n[14]+r[13]*n[19]+r[14],e[15]=r[15]*n[0]+r[16]*n[5]+r[17]*n[10]+r[18]*n[15],e[16]=r[15]*n[1]+r[16]*n[6]+r[17]*n[11]+r[18]*n[16],e[17]=r[15]*n[2]+r[16]*n[7]+r[17]*n[12]+r[18]*n[17],e[18]=r[15]*n[3]+r[16]*n[8]+r[17]*n[13]+r[18]*n[18],e[19]=r[15]*n[4]+r[16]*n[9]+r[17]*n[14]+r[18]*n[19]+r[19],e}_colorMatrix(e){const r=new Float32Array(e);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(e,r){const n=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}tint(e,r){const n=e>>16&255,i=e>>8&255,a=e&255,s=[n/255,0,0,0,0,0,i/255,0,0,0,0,0,a/255,0,0,0,0,0,1,0];this._loadMatrix(s,r)}greyscale(e,r){const n=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(n,r)}blackAndWhite(e){const r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,e)}hue(e,r){e=(e||0)/180*Math.PI;const n=Math.cos(e),i=Math.sin(e),a=Math.sqrt,s=1/3,o=a(s),l=n+(1-n)*s,u=s*(1-n)-o*i,c=s*(1-n)+o*i,f=s*(1-n)+o*i,h=n+s*(1-n),p=s*(1-n)-o*i,m=s*(1-n)-o*i,v=s*(1-n)+o*i,y=n+s*(1-n),x=[l,u,c,0,0,f,h,p,0,0,m,v,y,0,0,0,0,0,1,0];this._loadMatrix(x,r)}contrast(e,r){const n=(e||0)+1,i=-.5*(n-1),a=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(a,r)}saturate(e=0,r){const n=e*2/3+1,i=(n-1)*-.5,a=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(a,r)}desaturate(){this.saturate(-1)}negative(e){const r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,e)}sepia(e){const r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,e)}technicolor(e){const r=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(r,e)}polaroid(e){const r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,e)}toBGR(e){const r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,e)}kodachrome(e){const r=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,e)}browni(e){const r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,e)}vintage(e){const r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,e)}colorTone(e,r,n,i,a){e=e||.2,r=r||.15,n=n||16770432,i=i||3375104;const s=(n>>16&255)/255,o=(n>>8&255)/255,l=(n&255)/255,u=(i>>16&255)/255,c=(i>>8&255)/255,f=(i&255)/255,h=[.3,.59,.11,0,0,s,o,l,e,0,u,c,f,r,0,s-u,o-c,l-f,0,0];this._loadMatrix(h,a)}night(e,r){e=e||.1;const n=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(n,r)}predator(e,r){const n=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(n,r)}lsd(e){const r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}b1.prototype.grayscale=b1.prototype.greyscale;var pz=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,mz=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class vz extends Wi{constructor(e,r){const n=new qn;e.renderable=!1,super(mz,pz,{mapSampler:e._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=n,r==null&&(r=20),this.scale=new zr(r,r)}apply(e,r,n,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const a=this.maskSprite.worldTransform,s=Math.sqrt(a.a*a.a+a.b*a.b),o=Math.sqrt(a.c*a.c+a.d*a.d);s!==0&&o!==0&&(this.uniforms.rotation[0]=a.a/s,this.uniforms.rotation[1]=a.b/s,this.uniforms.rotation[2]=a.c/o,this.uniforms.rotation[3]=a.d/o),e.applyFilter(this,r,n,i)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var gz=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,yz=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class bz extends Wi{constructor(){super(yz,gz)}}var xz=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class wz extends Wi{constructor(e=.5,r=Math.random()){super(JN,xz,{uNoise:0,uSeed:0}),this.noise=e,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const GA={AlphaFilter:sz,BlurFilter:hz,BlurFilterPass:y1,ColorMatrixFilter:b1,DisplacementFilter:vz,FXAAFilter:bz,NoiseFilter:wz};Object.entries(GA).forEach(([t,e])=>{Object.defineProperty(GA,t,{get(){return qr("7.1.0",`filters.${t} has moved to ${t}`),e}})});class Ld{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Ld.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new zr,this.page=new zr,this.AT_TARGET=1,this.BUBBLING_PHASE=2,this.CAPTURING_PHASE=3,this.NONE=0,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,r,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,r,n,i,a){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class nv extends Ld{constructor(){super(...arguments),this.client=new zr,this.movement=new zr,this.offset=new zr,this.global=new zr,this.screen=new zr}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,r,n,i,a,s,o,l,u,c,f,h,p,m,v){throw new Error("Method not implemented.")}}class Ns extends nv{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class x1 extends nv{constructor(){super(...arguments),this.DOM_DELTA_LINE=0,this.DOM_DELTA_PAGE=1,this.DOM_DELTA_PIXEL=2}}const _z=2048,Az=new zr,X0=new zr;class Ez{constructor(e){this.dispatch=new Rd,this.moveOnAll=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,r){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:r,priority:0}),this.mappingTable[e].sort((n,i)=>n.priority-i.priority)}dispatchEvent(e,r){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,r),this.dispatch.emit(r||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const r=this.mappingTable[e.type];if(r)for(let n=0,i=r.length;n<i;n++)r[n].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,r){const n=this.hitTestRecursive(this.rootTarget,this.rootTarget.interactive,Az.set(e,r),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(e,r){if(!e.target)return;const n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,a=n.length-1;i<a;i++)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,r),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=n.length-2;i>=0;i--)if(e.currentTarget=n[i],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,r,n=this.rootTarget){e.eventPhase=e.BUBBLING_PHASE;const i=n.children;if(i)for(let a=0;a<i.length;a++)this.all(e,r,i[a]);e.currentTarget=n,this.notifyTarget(e,r)}propagationPath(e){const r=[e];for(let n=0;n<_z&&e!==this.rootTarget;n++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(e.parent),e=e.parent}return r.reverse(),r}hitTestRecursive(e,r,n,i,a){if(!e||!e.visible||a(e,n))return null;if(e.interactiveChildren&&e.children){const s=e.children;for(let o=s.length-1;o>=0;o--){const l=s[o],u=this.hitTestRecursive(l,r||l.interactive,n,i,a);if(u){if(u.length>0&&!u[u.length-1].parent)continue;return(u.length>0||e.interactive)&&u.push(e),u}}}return r&&i(e,n)?e.interactive?[e]:[]:null}hitPruneFn(e,r){var n;if(e.hitArea&&(e.worldTransform.applyInverse(r,X0),!e.hitArea.contains(X0.x,X0.y)))return!0;if(e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;if(i&&!((n=i.containsPoint)!=null&&n.call(i,r)))return!0}return!1}hitTestFn(e,r){return e.hitArea?!0:e.containsPoint?e.containsPoint(r):!1}notifyTarget(e,r){var a,s;r=r??e.type;const n=`on${r}`;(s=(a=e.currentTarget)[n])==null||s.call(a,e);const i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${r}capture`:r;this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,r)}mapPointerDown(e){if(!(e instanceof Ns)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const i=r.button===2;this.dispatchEvent(r,i?"rightdown":"mousedown")}const n=this.trackingData(e.pointerId);n.pressTargetsByButton[e.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(e){var o;if(!(e instanceof Ns)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(e),n=r.pointerType==="mouse"||r.pointerType==="pen",i=this.trackingData(e.pointerId),a=this.findMountedTarget(i.overTargets);if(i.overTargets&&a!==r.target){const l=e.type==="mousemove"?"mouseout":"pointerout",u=this.createPointerEvent(e,l,a);if(this.dispatchEvent(u,"pointerout"),n&&this.dispatchEvent(u,"mouseout"),!r.composedPath().includes(a)){const c=this.createPointerEvent(e,"pointerleave",a);for(c.eventPhase=c.AT_TARGET;c.target&&!r.composedPath().includes(c.target);)c.currentTarget=c.target,this.notifyTarget(c),n&&this.notifyTarget(c,"mouseleave"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(u)}if(a!==r.target){const l=e.type==="mousemove"?"mouseover":"pointerover",u=this.clonePointerEvent(r,l);this.dispatchEvent(u,"pointerover"),n&&this.dispatchEvent(u,"mouseover");let c=a==null?void 0:a.parent;for(;c&&c!==this.rootTarget.parent&&c!==r.target;)c=c.parent;if(!c||c===this.rootTarget.parent){const h=this.clonePointerEvent(r,"pointerenter");for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==a&&h.target!==this.rootTarget.parent;)h.currentTarget=h.target,this.notifyTarget(h),n&&this.notifyTarget(h,"mouseenter"),h.target=h.target.parent;this.freeEvent(h)}this.freeEvent(u)}const s=this.moveOnAll?"all":"dispatchEvent";this[s](r,"pointermove"),r.pointerType==="touch"&&this[s](r,"touchmove"),n&&(this[s](r,"mousemove"),this.cursor=(o=r.target)==null?void 0:o.cursor),i.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(e){var s;if(!(e instanceof Ns)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.createPointerEvent(e),i=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(s=n.target)==null?void 0:s.cursor);const a=this.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),i&&this.notifyTarget(a,"mouseenter"),a.target=a.target.parent;r.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(a)}mapPointerOut(e){if(!(e instanceof Ns)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId);if(r.overTargets){const n=e.pointerType==="mouse"||e.pointerType==="pen",i=this.findMountedTarget(r.overTargets),a=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(a),n&&this.dispatchEvent(a,"mouseout");const s=this.createPointerEvent(e,"pointerleave",i);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),n&&this.notifyTarget(s,"mouseleave"),s.target=s.target.parent;r.overTargets=null,this.freeEvent(a),this.freeEvent(s)}this.cursor=null}mapPointerUp(e){if(!(e instanceof Ns)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=performance.now(),n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const o=n.button===2;this.dispatchEvent(n,o?"rightup":"mouseup")}const i=this.trackingData(e.pointerId),a=this.findMountedTarget(i.pressTargetsByButton[e.button]);let s=a;if(a&&!n.composedPath().includes(a)){let o=a;for(;o&&!n.composedPath().includes(o);){if(n.currentTarget=o,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const l=n.button===2;this.notifyTarget(n,l?"rightupoutside":"mouseupoutside")}o=o.parent}delete i.pressTargetsByButton[e.button],s=o}if(s){const o=this.clonePointerEvent(n,"click");o.target=s,o.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:o.target,timeStamp:r});const l=i.clicksByButton[e.button];l.target===o.target&&r-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=o.target,l.timeStamp=r,o.detail=l.clickCount,o.pointerType==="mouse"?this.dispatchEvent(o,"click"):o.pointerType==="touch"&&this.dispatchEvent(o,"tap"),this.dispatchEvent(o,"pointertap"),this.freeEvent(o)}this.freeEvent(n)}mapPointerUpOutside(e){if(!(e instanceof Ns)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(e.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(n){let a=n;for(;a;)i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),a=a.parent;delete r.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof x1)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const r=this.createWheelEvent(e);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(e){if(!e)return null;let r=e[0];for(let n=1;n<e.length&&e[n].parent===r;n++)r=e[n];return r}createPointerEvent(e,r,n){const i=this.allocateEvent(Ns);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=n??this.hitTest(i.global.x,i.global.y),typeof r=="string"&&(i.type=r),i}createWheelEvent(e){const r=this.allocateEvent(x1);return this.copyWheelData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(e,r){const n=this.allocateEvent(Ns);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=r??n.type,n}copyWheelData(e,r){r.deltaMode=e.deltaMode,r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ}copyPointerData(e,r){e instanceof Ns&&r instanceof Ns&&(r.pointerId=e.pointerId,r.width=e.width,r.height=e.height,r.isPrimary=e.isPrimary,r.pointerType=e.pointerType,r.pressure=e.pressure,r.tangentialPressure=e.tangentialPressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY,r.twist=e.twist)}copyMouseData(e,r){e instanceof nv&&r instanceof nv&&(r.altKey=e.altKey,r.button=e.button,r.buttons=e.buttons,r.client.copyFrom(e.client),r.ctrlKey=e.ctrlKey,r.metaKey=e.metaKey,r.movement.copyFrom(e.movement),r.screen.copyFrom(e.screen),r.global.copyFrom(e.global))}copyData(e,r){r.isTrusted=e.isTrusted,r.srcElement=e.srcElement,r.timeStamp=performance.now(),r.type=e.type,r.detail=e.detail,r.view=e.view,r.which=e.which,r.layer.copyFrom(e.layer),r.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const r=this.eventPool.get(e).pop()||new e(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const r=e.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(e)}notifyListeners(e,r){const n=e.currentTarget._events[r];if(n)if("fn"in n)n.fn.call(n.context,e);else for(let i=0,a=n.length;i<a&&!e.propagationImmediatelyStopped;i++)n[i].fn.call(n[i].context,e)}}const Sz=1,Dz={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class sM{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new Ez(null),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Ns(null),this.rootWheelEvent=new x1(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}init(){const{view:e,resolution:r}=this.renderer;this.setTargetElement(e),this.resolution=r}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let r=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(r=!1),this.currentCursor===e)return;this.currentCursor=e;const n=this.cursorStyles[e];if(n)switch(typeof n){case"string":r&&(this.domElement.style.cursor=n);break;case"function":n(e);break;case"object":r&&Object.assign(this.domElement.style,n);break}else r&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}onPointerDown(e){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch")return;const r=this.normalizeToPointerData(e);this.autoPreventDefault&&r[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let n=0,i=r.length;n<i;n++){const a=r[n],s=this.bootstrapEvent(this.rootPointerEvent,a);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch")return;const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const a=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch")return;let r=e.target;e.composedPath&&e.composedPath().length>0&&(r=e.composedPath()[0]);const n=r!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let a=0,s=i.length;a<s;a++){const o=this.bootstrapEvent(this.rootPointerEvent,i[a]);o.type+=n,this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch")return;const r=this.normalizeToPointerData(e);for(let n=0,i=r.length;n<i;n++){const a=this.bootstrapEvent(this.rootPointerEvent,r[n]);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){const r=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(r)}setTargetElement(e){this.removeEvents(),this.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,r,n){let i;this.domElement.parentElement?i=this.domElement.getBoundingClientRect():i={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const a=1/this.resolution;e.x=(r-i.left)*(this.domElement.width/i.width)*a,e.y=(n-i.top)*(this.domElement.height/i.height)*a}normalizeToPointerData(e){const r=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let n=0,i=e.changedTouches.length;n<i;n++){const a=e.changedTouches[n];typeof a.button>"u"&&(a.button=0),typeof a.buttons>"u"&&(a.buttons=1),typeof a.isPrimary>"u"&&(a.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof a.width>"u"&&(a.width=a.radiusX||1),typeof a.height>"u"&&(a.height=a.radiusY||1),typeof a.tiltX>"u"&&(a.tiltX=0),typeof a.tiltY>"u"&&(a.tiltY=0),typeof a.pointerType>"u"&&(a.pointerType="touch"),typeof a.pointerId>"u"&&(a.pointerId=a.identifier||0),typeof a.pressure>"u"&&(a.pressure=a.force||.5),typeof a.twist>"u"&&(a.twist=0),typeof a.tangentialPressure>"u"&&(a.tangentialPressure=0),typeof a.layerX>"u"&&(a.layerX=a.offsetX=a.clientX),typeof a.layerY>"u"&&(a.layerY=a.offsetY=a.clientY),a.isNormalized=!0,a.type=e.type,r.push(a)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const n=e;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=Sz),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,r.push(n)}else r.push(e);return r}normalizeWheelEvent(e){const r=this.rootWheelEvent;return this.transferMouseData(r,e),r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ,r.deltaMode=e.deltaMode,this.mapPositionToPoint(r.screen,e.clientX,e.clientY),r.global.copyFrom(r.screen),r.offset.copyFrom(r.screen),r.nativeEvent=e,r.type=e.type,r}bootstrapEvent(e,r){return e.originalEvent=null,e.nativeEvent=r,e.pointerId=r.pointerId,e.width=r.width,e.height=r.height,e.isPrimary=r.isPrimary,e.pointerType=r.pointerType,e.pressure=r.pressure,e.tangentialPressure=r.tangentialPressure,e.tiltX=r.tiltX,e.tiltY=r.tiltY,e.twist=r.twist,this.transferMouseData(e,r),this.mapPositionToPoint(e.screen,r.clientX,r.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=r.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=Dz[e.type]||e.type),e}transferMouseData(e,r){e.isTrusted=r.isTrusted,e.srcElement=r.srcElement,e.timeStamp=performance.now(),e.type=r.type,e.altKey=r.altKey,e.button=r.button,e.buttons=r.buttons,e.client.x=r.clientX,e.client.y=r.clientY,e.ctrlKey=r.ctrlKey,e.metaKey=r.metaKey,e.movement.x=r.movementX,e.movement.y=r.movementY,e.page.x=r.pageX,e.page.y=r.pageY,e.relatedTarget=null,e.shiftKey=r.shiftKey}}sM.extension={name:"events",type:[Tt.RendererSystem,Tt.CanvasRendererSystem]};Lt.add(sM);const Cz={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,ontouchstart:null,onwheel:null,interactive:!1,interactiveChildren:!0,hitArea:null,addEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof e=="function"?void 0:e;t=n?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.on(t,e,i)},removeEventListener(t,e,r){const n=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof e=="function"?void 0:e;t=n?`${t}capture`:t,e=typeof e=="function"?e:e.handleEvent,this.off(t,e,i)},dispatchEvent(t){if(!(t instanceof Ld))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};wn.mixin(Cz);const Tz={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};wn.mixin(Tz);const Nz=9,Xp=100,Mz=0,Iz=0,qA=2,HA=1,Fz=-1e3,Oz=-1e3,Bz=2;class oM{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(uu.tablet||uu.phone)&&this.createTouchHook();const r=document.createElement("div");r.style.width=`${Xp}px`,r.style.height=`${Xp}px`,r.style.position="absolute",r.style.top=`${Mz}px`,r.style.left=`${Iz}px`,r.style.zIndex=qA.toString(),this.div=r,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${HA}px`,e.style.height=`${HA}px`,e.style.position="absolute",e.style.top=`${Fz}px`,e.style.left=`${Oz}px`,e.style.zIndex=Bz.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.interactive&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const r=e.children;if(r)for(let n=0;n<r.length;n++)this.updateAccessibleObjects(r[n])}update(){const e=performance.now();if(uu.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:r,y:n,width:i,height:a}=this.renderer.view.getBoundingClientRect(),{width:s,height:o,resolution:l}=this.renderer,u=i/s*l,c=a/o*l;let f=this.div;f.style.left=`${r}px`,f.style.top=`${n}px`,f.style.width=`${s}px`,f.style.height=`${o}px`;for(let h=0;h<this.children.length;h++){const p=this.children[h];if(p.renderId!==this.renderId)p._accessibleActive=!1,Lf(this.children,h,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,h--;else{f=p._accessibleDiv;let m=p.hitArea;const v=p.worldTransform;p.hitArea?(f.style.left=`${(v.tx+m.x*v.a)*u}px`,f.style.top=`${(v.ty+m.y*v.d)*c}px`,f.style.width=`${m.width*v.a*u}px`,f.style.height=`${m.height*v.d*c}px`):(m=p.getBounds(),this.capHitArea(m),f.style.left=`${m.x*u}px`,f.style.top=`${m.y*c}px`,f.style.width=`${m.width*u}px`,f.style.height=`${m.height*c}px`,f.title!==p.accessibleTitle&&p.accessibleTitle!==null&&(f.title=p.accessibleTitle),f.getAttribute("aria-label")!==p.accessibleHint&&p.accessibleHint!==null&&f.setAttribute("aria-label",p.accessibleHint)),(p.accessibleTitle!==f.title||p.tabIndex!==f.tabIndex)&&(f.title=p.accessibleTitle,f.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(f))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:r,height:n}=this.renderer;e.x+e.width>r&&(e.width=r-e.x),e.y+e.height>n&&(e.height=n-e.y)}addChild(e){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${Xp}px`,r.style.height=`${Xp}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=qA.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=e.accessiblePointerEvents,r.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?r.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(r.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&r.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(r),e._accessibleActive=!0,e._accessibleDiv=r,r.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,r){const{displayObject:n}=e.target,i=this.renderer.events.rootBoundary,a=Object.assign(new Ld(i),{target:n});i.rootTarget=this.renderer.lastObjectRendered,r.forEach(s=>i.dispatchEvent(a,s))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===Nz&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}oM.extension={name:"accessibility",type:[Tt.RendererPlugin,Tt.CanvasRendererPlugin]};Lt.add(oM);const w1=class{constructor(t){this.stage=new Ca,t=Object.assign({forceCanvas:!1},t),this.renderer=X9(t),w1._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(t,e){const r=w1._plugins.slice(0);r.reverse(),r.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};let Ob=w1;Ob._plugins=[];Lt.handleByList(Tt.Application,Ob._plugins);class uM{static init(e){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,n;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:a}=this._resizeTo;r=i,n=a}this.renderer.resize(r,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}uM.extension=Tt.Application;Lt.add(uM);const WA={loader:Tt.LoadParser,resolver:Tt.ResolveParser,cache:Tt.CacheParser,detection:Tt.DetectionParser};Lt.handle(Tt.Asset,t=>{const e=t.ref;Object.entries(WA).filter(([r])=>!!e[r]).forEach(([r,n])=>Lt.add(Object.assign(e[r],{extension:e[r].extension??n})))},t=>{const e=t.ref;Object.keys(WA).filter(r=>!!e[r]).forEach(r=>Lt.remove(e[r]))});class Rz{constructor(e,r=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(e){e.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<r;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function lM(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function Xv(t,e){const r=t.split("?")[0],n=xi.extname(r).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const du=(t,e)=>(Array.isArray(t)||(t=[t]),e?t.map(r=>typeof r=="string"?e(r):r):t);function cM(t,e,r,n,i){const a=e[r];for(let s=0;s<a.length;s++){const o=a[s];r<e.length-1?cM(t.replace(n[r],o),e,r+1,n,i):i.push(t.replace(n[r],o))}}function Pz(t){const e=/\{(.*?)\}/g,r=t.match(e),n=[];if(r){const i=[];r.forEach(a=>{const s=a.substring(1,a.length-1).split(",");i.push(s)}),cM(t,i,0,r,n)}else n.push(t);return n}const iv=t=>!Array.isArray(t);class $z{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const r=this._cache.get(e);return r||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),r}set(e,r){const n=du(e);let i;for(let o=0;o<this.parsers.length;o++){const l=this.parsers[o];if(l.test(r)){i=l.getCacheableAssets(n,r);break}}i||(i={},n.forEach(o=>{i[o]=r}));const a=Object.keys(i),s={cacheKeys:a,keys:n};if(n.forEach(o=>{this._cacheMap.set(o,s)}),a.forEach(o=>{this._cache.has(o)&&this._cache.get(o)!==r&&console.warn("[Cache] already has key:",o),this._cache.set(o,i[o])}),r instanceof kt){const o=r;n.forEach(l=>{o.baseTexture!==kt.EMPTY.baseTexture&&pr.addToCache(o.baseTexture,l),kt.addToCache(o,l)})}}remove(e){if(this._cacheMap.get(e),!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const r=this._cacheMap.get(e);r.cacheKeys.forEach(i=>{this._cache.delete(i)}),r.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const nd=new $z;class kz{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(e,r){const n={promise:null,parser:null};return n.promise=(async()=>{var a,s;let i=null;for(let o=0;o<this.parsers.length;o++){const l=this.parsers[o];if(l.load&&((a=l.test)!=null&&a.call(l,e,r,this))){i=await l.load(e,r,this),n.parser=l;break}}if(!n.parser)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has being added`),null;for(let o=0;o<this.parsers.length;o++){const l=this.parsers[o];l.parse&&l.parse&&await((s=l.testParse)==null?void 0:s.call(l,i,r,this))&&(i=await l.parse(i,r,this)||i,n.parser=l)}return i})(),n}async load(e,r){let n=0;const i={},a=iv(e),s=du(e,u=>({src:u})),o=s.length,l=s.map(async u=>{const c=xi.toAbsolute(u.src);if(!i[u.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,u)),i[u.src]=await this.promiseCache[c].promise,r&&r(++n/o)}catch(f){throw delete this.promiseCache[c],delete i[u.src],new Error(`[Loader.load] Failed to load ${c}.
${f}`)}});return await Promise.all(l),a?i[s[0].src]:i}async unload(e){const n=du(e,i=>({src:i})).map(async i=>{var o,l;const a=xi.toAbsolute(i.src),s=this.promiseCache[a];if(s){const u=await s.promise;(l=(o=s.parser)==null?void 0:o.unload)==null||l.call(o,u,i,this),delete this.promiseCache[a]}});await Promise.all(n)}get parsers(){return this._parsers}}var _o=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(_o||{});const Lz={extension:{type:Tt.LoadParser,priority:_o.Low},test(t){return xi.extname(t).toLowerCase()===".json"},async load(t){return await(await Nt.ADAPTER.fetch(t)).json()}};Lt.add(Lz);const Uz={extension:{type:Tt.LoadParser,priority:_o.Low},test(t){return xi.extname(t).toLowerCase()===".txt"},async load(t){return await(await Nt.ADAPTER.fetch(t)).text()}};Lt.add(Uz);const zz=["normal","bold","100","200","300","400","500","600","700","800","900"],Gz=[".ttf",".otf",".woff",".woff2"],qz=["font/ttf","font/otf","font/woff","font/woff2"];function Hz(t){const e=xi.extname(t);return xi.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}const Wz={extension:{type:Tt.LoadParser,priority:_o.Low},test(t){return lM(t,qz)||Xv(t,Gz)},async load(t,e){var n,i,a;if(!globalThis.navigator.onLine)throw new Error("[loadWebFont] Cannot load font - navigator is offline");const r=Nt.ADAPTER.getFontFaceSet();if(r){const s=[],o=((n=e.data)==null?void 0:n.family)??Hz(t),l=((a=(i=e.data)==null?void 0:i.weights)==null?void 0:a.filter(c=>zz.includes(c)))??["normal"],u=e.data??{};for(let c=0;c<l.length;c++){const f=l[c],h=new FontFace(o,`url(${encodeURI(t)})`,{...u,weight:f});await h.load(),r.add(h),s.push(h)}return s.length===1?s[0]:s}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>Nt.ADAPTER.getFontFaceSet().delete(e))}};Lt.add(Wz);let VA=0,j0;const Vz="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",Xz={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${Vz}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},jz={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Y0;class Yz{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const r=URL.createObjectURL(new Blob([Xz.code],{type:"application/javascript"})),n=new Worker(r);n.addEventListener("message",i=>{n.terminate(),URL.revokeObjectURL(r),e(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){j0===void 0&&(j0=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<j0&&(Y0||(Y0=URL.createObjectURL(new Blob([jz.code],{type:"application/javascript"}))),this._createdWorkers++,e=new Worker(Y0),e.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,r){await this._initWorkers();const n=new Promise((i,a)=>{this.queue.push({id:e,arguments:r,resolve:i,reject:a})});return this.next(),n}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const r=this.queue.pop(),n=r.id;this.resolveHash[VA]={resolve:r.resolve,reject:r.reject},e.postMessage({data:r.arguments,uuid:VA++,id:n})}}const XA=new Yz;function jv(t,e,r){const n=new kt(t);return n.baseTexture.on("dispose",()=>{delete e.promiseCache[r]}),n}const Kz=[".jpeg",".jpg",".png",".webp",".avif"],Zz=["image/jpeg","image/png","image/webp","image/avif"];async function Qz(t){const e=await Nt.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const r=await e.blob();return await createImageBitmap(r)}const Td={extension:{type:Tt.LoadParser,priority:_o.High},config:{preferWorkers:!0},test(t){return lM(t,Zz)||Xv(t,Kz)},async load(t,e,r){let n=null;globalThis.createImageBitmap?this.config.preferWorkers&&await XA.isImageBitmapSupported()?n=await XA.loadImageBitmap(t):n=await Qz(t):n=await new Promise(a=>{n=new Image,n.crossOrigin="anonymous",n.src=t,n.complete?a(n):n.onload=()=>{a(n)}});const i=new pr(n,{resolution:ol(t),...e.data});return i.resource.src=t,jv(i,r,t)},unload(t){t.destroy(!0)}};Lt.add(Td);const Jz={extension:{type:Tt.LoadParser,priority:_o.High},test(t){return xi.extname(t).toLowerCase()===".svg"},async testParse(t){return Cd.test(t)},async parse(t,e,r){var s,o,l;const n=new Cd(t,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions),i=new pr(n,{resolution:ol(t),...e==null?void 0:e.data});i.resource.src=t;const a=jv(i,r,t);return(l=(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions)!=null&&l.autoLoad||await n.load(),a},async load(t,e){return(await Nt.ADAPTER.fetch(t)).text()},unload:Td.unload};Lt.add(Jz);class eG{constructor(){this._bundleIdConnector="-",this._createBundleAssetId=(e,r)=>`${e}${this._bundleIdConnector}${r}`,this._extractAssetIdFromBundle=(e,r)=>r.replace(`${e}${this._bundleIdConnector}`,""),this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this._preferredOrder=[],this._resolverHash={},this._assetMap={},this._rootPath=null,this._basePath=null,this._manifest=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const r=e;this._defaultSearchParams=Object.keys(r).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(r[n])}`).join("&")}}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(e,r){const n=[];Array.isArray(r)?r.forEach(i=>{if(typeof i.name=="string"){const a=this._createBundleAssetId(e,i.name);n.push(a),this.add([i.name,a],i.srcs)}else{const a=i.name.map(s=>this._createBundleAssetId(e,s));a.forEach(s=>{n.push(s)}),this.add([...i.name,...a],i.srcs)}}):Object.keys(r).forEach(i=>{n.push(this._createBundleAssetId(e,i)),this.add([i,this._createBundleAssetId(e,i)],r[i])}),this._bundles[e]=n}add(e,r,n){const i=du(e);i.forEach(s=>{this._assetMap[s]&&console.warn(`[Resolver] already has key: ${s} overwriting`)}),Array.isArray(r)||(typeof r=="string"?r=Pz(r):r=[r]);const a=r.map(s=>{let o=s;if(typeof s=="string"){let l=!1;for(let u=0;u<this._parsers.length;u++){const c=this._parsers[u];if(c.test(s)){o=c.parse(s),l=!0;break}}l||(o={src:s})}return o.format||(o.format=o.src.split(".").pop()),o.alias||(o.alias=i),(this._basePath||this._rootPath)&&(o.src=xi.toAbsolute(o.src,this._basePath,this._rootPath)),o.src=this._appendDefaultSearchParams(o.src),o.data=o.data??n,o});i.forEach(s=>{this._assetMap[s]=a})}resolveBundle(e){const r=iv(e);e=du(e);const n={};return e.forEach(i=>{const a=this._bundles[i];if(a){const s=this.resolve(a),o={};for(const l in s){const u=s[l];o[this._extractAssetIdFromBundle(i,l)]=u}n[i]=o}}),r?n[e[0]]:n}resolveUrl(e){const r=this.resolve(e);if(typeof e!="string"){const n={};for(const i in r)n[i]=r[i].src;return n}return r.src}resolve(e){const r=iv(e);e=du(e);const n={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let a=this._assetMap[i];const s=this._getPreferredOrder(a),o=a[0];s==null||s.priority.forEach(l=>{s.params[l].forEach(u=>{const c=a.filter(f=>f[l]?f[l]===u:!1);c.length&&(a=c)})}),this._resolverHash[i]=a[0]??o}else{let a=i;(this._basePath||this._rootPath)&&(a=xi.toAbsolute(a,this._basePath,this._rootPath)),a=this._appendDefaultSearchParams(a),this._resolverHash[i]={src:a}}n[i]=this._resolverHash[i]}),r?n[e[0]]:n}_getPreferredOrder(e){for(let r=0;r<e.length;r++){const n=e[0],i=this._preferredOrder.find(a=>a.params.format.includes(n.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const r=/\?/.test(e)?"&":"?";return`${e}${r}${this._defaultSearchParams}`}}class tG{constructor(){this._detections=[],this._initialized=!1,this.resolver=new eG,this.loader=new kz,this.cache=nd,this._backgroundLoader=new Rz(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var a,s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let l=e.manifest;typeof l=="string"&&(l=await this.load(l)),this.resolver.addManifest(l)}const r=((a=e.texturePreference)==null?void 0:a.resolution)??1,n=typeof r=="number"?[r]:r;let i=[];if((s=e.texturePreference)!=null&&s.format){const l=(o=e.texturePreference)==null?void 0:o.format;i=typeof l=="string"?[l]:l;for(const u of this._detections)await u.test()||(i=await u.remove(i))}else for(const l of this._detections)await l.test()&&(i=await l.add(i));this.resolver.prefer({params:{format:i,resolution:n}})}add(e,r,n){this.resolver.add(e,r,n)}async load(e,r){this._initialized||await this.init();const n=iv(e),i=du(e).map(o=>typeof o!="string"?(this.resolver.add(o.src,o),o.src):o),a=this.resolver.resolve(i),s=await this._mapLoadToResolve(a,r);return n?s[i[0]]:s}addBundle(e,r){this.resolver.addBundle(e,r)}async loadBundle(e,r){this._initialized||await this.init();let n=!1;typeof e=="string"&&(n=!0,e=[e]);const i=this.resolver.resolveBundle(e),a={},s=Object.keys(i);let o=0,l=0;const u=()=>{r==null||r(++o/l)},c=s.map(f=>{const h=i[f];return l+=Object.keys(h).length,this._mapLoadToResolve(h,u).then(p=>{a[f]=p})});return await Promise.all(c),n?a[e[0]]:a}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const r=this.resolver.resolveBundle(e);Object.values(r).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return nd.get(e);const r={};for(let n=0;n<e.length;n++)r[n]=nd.get(e[n]);return r}async _mapLoadToResolve(e,r){const n=Object.values(e),i=Object.keys(e);this._backgroundLoader.active=!1;const a=await this.loader.load(n,r);this._backgroundLoader.active=!0;const s={};return n.forEach((o,l)=>{const u=a[o.src],c=[o.src];o.alias&&c.push(...o.alias),s[i[l]]=u,nd.set(c,u)}),s}async unload(e){this._initialized||await this.init();const r=du(e).map(i=>typeof i!="string"?i.src:i),n=this.resolver.resolve(r);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=du(e);const r=this.resolver.resolveBundle(e),n=Object.keys(r).map(i=>this._unloadFromResolved(r[i]));await Promise.all(n)}async _unloadFromResolved(e){const r=Object.values(e);r.forEach(n=>{nd.remove(n.src)}),await this.loader.unload(r)}get detections(){return this._detections}get preferWorkers(){return Td.config.preferWorkers}set preferWorkers(e){Td.config.preferWorkers=e}}const rl=new tG;Lt.handleByList(Tt.LoadParser,rl.loader.parsers).handleByList(Tt.ResolveParser,rl.resolver.parsers).handleByList(Tt.CacheParser,rl.cache.parsers).handleByList(Tt.DetectionParser,rl.detections);const rG={extension:Tt.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof kt),getCacheableAssets:(t,e)=>{const r={};return t.forEach(n=>{e.forEach((i,a)=>{r[n+(a===0?"":a+1)]=i})}),r}};Lt.add(rG);const nG={extension:{type:Tt.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const e=await Nt.ADAPTER.fetch("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=").then(r=>r.blob());return createImageBitmap(e).then(()=>!0,()=>!1)},add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")};Lt.add(nG);const iG={extension:{type:Tt.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const e=await Nt.ADAPTER.fetch("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=").then(r=>r.blob());return createImageBitmap(e).then(()=>!0,()=>!1)},add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};Lt.add(iG);const jA=["png","jpg","jpeg"],aG={extension:{type:Tt.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...jA],remove:async t=>t.filter(e=>!jA.includes(e))};Lt.add(aG);const sG={extension:Tt.ResolveParser,test:Td.test,parse:t=>{var e;return{resolution:parseFloat(((e=Nt.RETINA_PREFIX.exec(t))==null?void 0:e[1])??"1"),format:t.split(".").pop(),src:t}}};Lt.add(sG);var Sa=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t))(Sa||{});const av={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let nu,Sf;function YA(){Sf={s3tc:nu.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:nu.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:nu.getExtension("WEBGL_compressed_texture_etc"),etc1:nu.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:nu.getExtension("WEBGL_compressed_texture_pvrtc")||nu.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:nu.getExtension("WEBGL_compressed_texture_atc"),astc:nu.getExtension("WEBGL_compressed_texture_astc")}}const oG={extension:{type:Tt.DetectionParser,priority:2},test:async()=>{const e=Nt.ADAPTER.createCanvas().getContext("webgl");return e?(nu=e,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{Sf||YA();const e=[];for(const r in Sf)Sf[r]&&e.push(r);return[...e,...t]},remove:async t=>(Sf||YA(),t.filter(e=>!(e in Sf)))};Lt.add(oG);class uG extends kd{constructor(e,r={width:1,height:1,autoLoad:!0}){let n,i;typeof e=="string"?(n=e,i=new Uint8Array):(n=null,i=e),super(i,r),this.origin=n,this.buffer=i?new u1(i):null,this.origin&&r.autoLoad!==!1&&this.load(),i!=null&&i.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}async load(){const n=await(await(await fetch(this.origin)).blob()).arrayBuffer();return this.data=new Uint32Array(n),this.buffer=new u1(n),this.loaded=!0,this.onBlobLoaded(n),this.update(),this}}class mc extends uG{constructor(e,r){super(e,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=mc._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||mc._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,r,n){const i=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let s=0,o=this.levels;s<o;s++){const{levelID:l,levelWidth:u,levelHeight:c,levelBuffer:f}=this._levelBuffers[s];i.compressedTexImage2D(i.TEXTURE_2D,l,this.format,u,c,0,f)}return!0}onBlobLoaded(){this._levelBuffers=mc._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(e,r,n,i,a,s,o){const l=new Array(n);let u=e.byteOffset,c=s,f=o,h=c+i-1&~(i-1),p=f+a-1&~(a-1),m=h*p*av[r];for(let v=0;v<n;v++)l[v]={levelID:v,levelWidth:n>1?c:h,levelHeight:n>1?f:p,levelBuffer:new Uint8Array(e.buffer,u,m)},u+=m,c=c>>1||1,f=f>>1||1,h=c+i-1&~(i-1),p=f+a-1&~(a-1),m=h*p*av[r];return l}}const K0=4,jp=124,lG=32,KA=20,cG=542327876,Yp={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},fG={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Kp={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},hG=1,dG=2,pG=4,mG=64,vG=512,gG=131072,yG=827611204,bG=861165636,xG=894720068,wG=808540228,_G=4,AG={[yG]:Sa.COMPRESSED_RGBA_S3TC_DXT1_EXT,[bG]:Sa.COMPRESSED_RGBA_S3TC_DXT3_EXT,[xG]:Sa.COMPRESSED_RGBA_S3TC_DXT5_EXT},EG={70:Sa.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Sa.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Sa.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Sa.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Sa.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Sa.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Sa.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Sa.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Sa.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function SG(t){const e=new Uint32Array(t);if(e[0]!==cG)throw new Error("Invalid DDS file magic word");const n=new Uint32Array(t,0,jp/Uint32Array.BYTES_PER_ELEMENT),i=n[Yp.HEIGHT],a=n[Yp.WIDTH],s=n[Yp.MIPMAP_COUNT],o=new Uint32Array(t,Yp.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,lG/Uint32Array.BYTES_PER_ELEMENT),l=o[hG];if(l&pG){const u=o[fG.FOURCC];if(u!==wG){const b=AG[u],A=K0+jp,E=new Uint8Array(t,A);return[new mc(E,{format:b,width:a,height:i,levels:s})]}const c=K0+jp,f=new Uint32Array(e.buffer,c,KA/Uint32Array.BYTES_PER_ELEMENT),h=f[Kp.DXGI_FORMAT],p=f[Kp.RESOURCE_DIMENSION],m=f[Kp.MISC_FLAG],v=f[Kp.ARRAY_SIZE],y=EG[h];if(y===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${h}`);if(m===_G)throw new Error("DDSParser does not support cubemap textures");if(p===6)throw new Error("DDSParser does not supported 3D texture data");const x=new Array,S=K0+jp+KA;if(v===1)x.push(new Uint8Array(t,S));else{const b=av[y];let A=0,E=a,_=i;for(let M=0;M<s;M++){const N=Math.max(1,E+3&-4),I=Math.max(1,_+3&-4),F=N*I*b;A+=F,E=E>>>1,_=_>>>1}let T=S;for(let M=0;M<v;M++)x.push(new Uint8Array(t,T,A)),T+=A}return x.map(b=>new mc(b,{format:y,width:a,height:i,levels:s}))}throw l&mG?new Error("DDSParser does not support uncompressed texture data."):l&vG?new Error("DDSParser does not supported YUV uncompressed texture data."):l&gG?new Error("DDSParser does not support single-channel (lumninance) texture data!"):l&dG?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const ZA=[171,75,84,88,32,49,49,187,13,10,26,10],DG=67305985,Ds={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},_1=64,QA={[Ht.UNSIGNED_BYTE]:1,[Ht.UNSIGNED_SHORT]:2,[Ht.INT]:4,[Ht.UNSIGNED_INT]:4,[Ht.FLOAT]:4,[Ht.HALF_FLOAT]:8},CG={[wt.RGBA]:4,[wt.RGB]:3,[wt.RG]:2,[wt.RED]:1,[wt.LUMINANCE]:1,[wt.LUMINANCE_ALPHA]:2,[wt.ALPHA]:1},TG={[Ht.UNSIGNED_SHORT_4_4_4_4]:2,[Ht.UNSIGNED_SHORT_5_5_5_1]:2,[Ht.UNSIGNED_SHORT_5_6_5]:2};function NG(t,e,r=!1){const n=new DataView(e);if(!MG(t,n))return null;const i=n.getUint32(Ds.ENDIANNESS,!0)===DG,a=n.getUint32(Ds.GL_TYPE,i),s=n.getUint32(Ds.GL_FORMAT,i),o=n.getUint32(Ds.GL_INTERNAL_FORMAT,i),l=n.getUint32(Ds.PIXEL_WIDTH,i),u=n.getUint32(Ds.PIXEL_HEIGHT,i)||1,c=n.getUint32(Ds.PIXEL_DEPTH,i)||1,f=n.getUint32(Ds.NUMBER_OF_ARRAY_ELEMENTS,i)||1,h=n.getUint32(Ds.NUMBER_OF_FACES,i),p=n.getUint32(Ds.NUMBER_OF_MIPMAP_LEVELS,i),m=n.getUint32(Ds.BYTES_OF_KEY_VALUE_DATA,i);if(u===0||c!==1)throw new Error("Only 2D textures are supported");if(h!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(f!==1)throw new Error("WebGL does not support array textures");const v=4,y=4,x=l+3&-4,S=u+3&-4,b=new Array(f);let A=l*u;a===0&&(A=x*S);let E;if(a!==0?QA[a]?E=QA[a]*CG[s]:E=TG[a]:E=av[o],E===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const _=r?FG(n,m,i):null;let M=A*E,N=l,I=u,F=x,P=S,U=_1+m;for(let G=0;G<p;G++){const V=n.getUint32(U,i);let $=U+4;for(let j=0;j<f;j++){let k=b[j];k||(k=b[j]=new Array(p)),k[G]={levelID:G,levelWidth:p>1||a!==0?N:F,levelHeight:p>1||a!==0?I:P,levelBuffer:new Uint8Array(e,$,M)},$+=M}U+=V+4,U=U%4!==0?U+4-U%4:U,N=N>>1||1,I=I>>1||1,F=N+v-1&~(v-1),P=I+y-1&~(y-1),M=F*P*E}return a!==0?{uncompressed:b.map(G=>{let V=G[0].levelBuffer,$=!1;return a===Ht.FLOAT?V=new Float32Array(G[0].levelBuffer.buffer,G[0].levelBuffer.byteOffset,G[0].levelBuffer.byteLength/4):a===Ht.UNSIGNED_INT?($=!0,V=new Uint32Array(G[0].levelBuffer.buffer,G[0].levelBuffer.byteOffset,G[0].levelBuffer.byteLength/4)):a===Ht.INT&&($=!0,V=new Int32Array(G[0].levelBuffer.buffer,G[0].levelBuffer.byteOffset,G[0].levelBuffer.byteLength/4)),{resource:new kd(V,{width:G[0].levelWidth,height:G[0].levelHeight}),type:a,format:$?IG(s):s}}),kvData:_}:{compressed:b.map(G=>new mc(null,{format:o,width:l,height:u,levels:p,levelBuffers:G})),kvData:_}}function MG(t,e){for(let r=0;r<ZA.length;r++)if(e.getUint8(r)!==ZA[r])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}function IG(t){switch(t){case wt.RGBA:return wt.RGBA_INTEGER;case wt.RGB:return wt.RGB_INTEGER;case wt.RG:return wt.RG_INTEGER;case wt.RED:return wt.RED_INTEGER;default:return t}}function FG(t,e,r){const n=new Map;let i=0;for(;i<e;){const a=t.getUint32(_1+i,r),s=_1+i+4,o=3-(a+3)%4;if(a===0||a>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<a&&t.getUint8(s+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(t.buffer,s,l)),c=new DataView(t.buffer,s+l+1,a-l-1);n.set(u,c),i+=4+a+o}return n}const OG={extension:{type:Tt.LoadParser,priority:_o.High},test(t){return Xv(t,".dds")},async load(t,e,r){const i=await(await Nt.ADAPTER.fetch(t)).arrayBuffer(),s=SG(i).map(o=>{const l=new pr(o,{mipmap:xo.OFF,alphaMode:Us.NO_PREMULTIPLIED_ALPHA,resolution:ol(t),...e.data});return jv(l,r,t)});return s.length===1?s[0]:s},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};Lt.add(OG);const BG={extension:{type:Tt.LoadParser,priority:_o.High},test(t){return Xv(t,".ktx")},async load(t,e,r){const i=await(await Nt.ADAPTER.fetch(t)).arrayBuffer(),{compressed:a,uncompressed:s,kvData:o}=NG(t,i),l=a??s,u={mipmap:xo.OFF,alphaMode:Us.NO_PREMULTIPLIED_ALPHA,resolution:ol(t),...e.data},c=l.map(f=>{l===s&&Object.assign(u,{type:f.type,format:f.format});const h=new pr(f,u);return h.ktxKeyValueData=o,jv(h,r,t)});return c.length===1?c[0]:c},unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};Lt.add(BG);const RG={extension:Tt.ResolveParser,test:t=>{const r=t.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(r)},parse:t=>{var n,i;if(t.split("?")[0].split(".").pop()==="ktx"){const a=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(a.some(s=>t.endsWith(s)))return{resolution:parseFloat(((n=Nt.RETINA_PREFIX.exec(t))==null?void 0:n[1])??"1"),format:a.find(s=>t.endsWith(s)),src:t}}return{resolution:parseFloat(((i=Nt.RETINA_PREFIX.exec(t))==null?void 0:i[1])??"1"),format:t.split(".").pop(),src:t}}};Lt.add(RG);const JA=new Br,eE=4,A1=class{constructor(t){this.renderer=t}async image(t,e,r){const n=new Image;return n.src=await this.base64(t,e,r),n}async base64(t,e,r){const n=this.canvas(t);if(n.toDataURL!==void 0)return n.toDataURL(e,r);if(n.convertToBlob!==void 0){const i=await n.convertToBlob({type:e,quality:r});return await new Promise(a=>{const s=new FileReader;s.onload=()=>a(s.result),s.readAsDataURL(i)})}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(t,e){const r=this.renderer;let n,i=!1,a,s=!1;t&&(t instanceof cl?a=t:(a=this.renderer.generateTexture(t),s=!0)),a?(n=a.baseTexture.resolution,e=e??a.frame,i=!1,r.renderTexture.bind(a)):(n=r.resolution,e||(e=JA,e.width=r.width,e.height=r.height),i=!0,r.renderTexture.bind(null));const o=Math.round(e.width*n),l=Math.round(e.height*n);let u=new TA(o,l,1);const c=new Uint8Array(eE*o*l),f=r.gl;f.readPixels(Math.round(e.x*n),Math.round(e.y*n),o,l,f.RGBA,f.UNSIGNED_BYTE,c);const h=u.context.getImageData(0,0,o,l);if(A1.arrayPostDivide(c,h.data),u.context.putImageData(h,0,0),i){const p=new TA(u.width,u.height,1);p.context.scale(1,-1),p.context.drawImage(u.canvas,0,-l),u.destroy(),u=p}return s&&a.destroy(!0),u.canvas}pixels(t,e){const r=this.renderer;let n,i,a=!1;t&&(t instanceof cl?i=t:(i=this.renderer.generateTexture(t),a=!0)),i?(n=i.baseTexture.resolution,e=e??i.frame,r.renderTexture.bind(i)):(n=r.resolution,e||(e=JA,e.width=r.width,e.height=r.height),r.renderTexture.bind(null));const s=Math.round(e.width*n),o=Math.round(e.height*n),l=new Uint8Array(eE*s*o),u=r.gl;return u.readPixels(Math.round(e.x*n),Math.round(e.y*n),s,o,u.RGBA,u.UNSIGNED_BYTE,l),a&&i.destroy(!0),A1.arrayPostDivide(l,l),l}destroy(){this.renderer=null}static arrayPostDivide(t,e){for(let r=0;r<t.length;r+=4){const n=e[r+3]=t[r+3];n!==0?(e[r]=Math.round(Math.min(t[r]*255/n,255)),e[r+1]=Math.round(Math.min(t[r+1]*255/n,255)),e[r+2]=Math.round(Math.min(t[r+2]*255/n,255))):(e[r]=t[r],e[r+1]=t[r+1],e[r+2]=t[r+2])}}};let fM=A1;fM.extension={name:"extract",type:Tt.RendererSystem};Lt.add(fM);const sv={build(t){const e=t.points;let r,n,i,a,s,o;if(t.type===gi.CIRC){const m=t.shape;r=m.x,n=m.y,s=o=m.radius,i=a=0}else if(t.type===gi.ELIP){const m=t.shape;r=m.x,n=m.y,s=m.width,o=m.height,i=a=0}else{const m=t.shape,v=m.width/2,y=m.height/2;r=m.x+v,n=m.y+y,s=o=Math.max(0,Math.min(m.radius,Math.min(v,y))),i=v-s,a=y-o}if(!(s>=0&&o>=0&&i>=0&&a>=0)){e.length=0;return}const l=Math.ceil(2.3*Math.sqrt(s+o)),u=l*8+(i?4:0)+(a?4:0);if(e.length=u,u===0)return;if(l===0){e.length=8,e[0]=e[6]=r+i,e[1]=e[3]=n+a,e[2]=e[4]=r-i,e[5]=e[7]=n-a;return}let c=0,f=l*4+(i?2:0)+2,h=f,p=u;{const m=i+s,v=a,y=r+m,x=r-m,S=n+v;if(e[c++]=y,e[c++]=S,e[--f]=S,e[--f]=x,a){const b=n-v;e[h++]=x,e[h++]=b,e[--p]=b,e[--p]=y}}for(let m=1;m<l;m++){const v=Math.PI/2*(m/l),y=i+Math.cos(v)*s,x=a+Math.sin(v)*o,S=r+y,b=r-y,A=n+x,E=n-x;e[c++]=S,e[c++]=A,e[--f]=A,e[--f]=b,e[h++]=b,e[h++]=E,e[--p]=E,e[--p]=S}{const m=i,v=a+o,y=r+m,x=r-m,S=n+v,b=n-v;e[c++]=y,e[c++]=S,e[--p]=b,e[--p]=y,i&&(e[c++]=x,e[c++]=S,e[--p]=b,e[--p]=x)}},triangulate(t,e){const r=t.points,n=e.points,i=e.indices;if(r.length===0)return;let a=n.length/2;const s=a;let o,l;if(t.type!==gi.RREC){const c=t.shape;o=c.x,l=c.y}else{const c=t.shape;o=c.x+c.width/2,l=c.y+c.height/2}const u=t.matrix;n.push(t.matrix?u.a*o+u.c*l+u.tx:o,t.matrix?u.b*o+u.d*l+u.ty:l),a++,n.push(r[0],r[1]);for(let c=2;c<r.length;c+=2)n.push(r[c],r[c+1]),i.push(a++,s,a);i.push(s+1,s,a)}};function tE(t,e=!1){const r=t.length;if(r<6)return;let n=0;for(let i=0,a=t[r-2],s=t[r-1];i<r;i+=2){const o=t[i],l=t[i+1];n+=(o-a)*(l+s),a=o,s=l}if(!e&&n>0||e&&n<=0){const i=r/2;for(let a=i+i%2;a<r;a+=2){const s=r-a-2,o=r-a-1,l=a,u=a+1;[t[s],t[l]]=[t[l],t[s]],[t[o],t[u]]=[t[u],t[o]]}}}const hM={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let r=t.points;const n=t.holes,i=e.points,a=e.indices;if(r.length>=6){tE(r,!1);const s=[];for(let u=0;u<n.length;u++){const c=n[u];tE(c.points,!0),s.push(r.length/2),r=r.concat(c.points)}const o=lk(r,s,2);if(!o)return;const l=i.length/2;for(let u=0;u<o.length;u+=3)a.push(o[u]+l),a.push(o[u+1]+l),a.push(o[u+2]+l);for(let u=0;u<r.length;u++)i.push(r[u])}}},PG={build(t){const e=t.shape,r=e.x,n=e.y,i=e.width,a=e.height,s=t.points;s.length=0,i>=0&&a>=0&&s.push(r,n,r+i,n,r+i,n+a,r,n+a)},triangulate(t,e){const r=t.points,n=e.points;if(r.length===0)return;const i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},$G={build(t){sv.build(t)},triangulate(t,e){sv.triangulate(t,e)}};var Zu=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(Zu||{}),lc=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(lc||{});const Zf={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};class rE{static curveTo(e,r,n,i,a,s){const o=s[s.length-2],u=s[s.length-1]-r,c=o-e,f=i-r,h=n-e,p=Math.abs(u*h-c*f);if(p<1e-8||a===0)return(s[s.length-2]!==e||s[s.length-1]!==r)&&s.push(e,r),null;const m=u*u+c*c,v=f*f+h*h,y=u*f+c*h,x=a*Math.sqrt(m)/p,S=a*Math.sqrt(v)/p,b=x*y/m,A=S*y/v,E=x*h+S*c,_=x*f+S*u,T=c*(S+b),M=u*(S+b),N=h*(x+A),I=f*(x+A),F=Math.atan2(M-_,T-E),P=Math.atan2(I-_,N-E);return{cx:E+e,cy:_+r,radius:a,startAngle:F,endAngle:P,anticlockwise:c*f>h*u}}static arc(e,r,n,i,a,s,o,l,u){const c=o-s,f=Zf._segmentsCount(Math.abs(c)*a,Math.ceil(Math.abs(c)/tv)*40),h=c/(f*2),p=h*2,m=Math.cos(h),v=Math.sin(h),y=f-1,x=y%1/y;for(let S=0;S<=y;++S){const b=S+x*S,A=h+s+p*b,E=Math.cos(A),_=-Math.sin(A);u.push((m*E+v*_)*a+n,(m*-_+v*E)*a+i)}}}class kG{constructor(){this.reset()}begin(e,r,n){this.reset(),this.style=e,this.start=r,this.attribStart=n}end(e,r){this.attribSize=r-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Bb{static curveLength(e,r,n,i,a,s,o,l){let c=0,f=0,h=0,p=0,m=0,v=0,y=0,x=0,S=0,b=0,A=0,E=e,_=r;for(let T=1;T<=10;++T)f=T/10,h=f*f,p=h*f,m=1-f,v=m*m,y=v*m,x=y*e+3*v*f*n+3*m*h*a+p*o,S=y*r+3*v*f*i+3*m*h*s+p*l,b=E-x,A=_-S,E=x,_=S,c+=Math.sqrt(b*b+A*A);return c}static curveTo(e,r,n,i,a,s,o){const l=o[o.length-2],u=o[o.length-1];o.length-=2;const c=Zf._segmentsCount(Bb.curveLength(l,u,e,r,n,i,a,s));let f=0,h=0,p=0,m=0,v=0;o.push(l,u);for(let y=1,x=0;y<=c;++y)x=y/c,f=1-x,h=f*f,p=h*f,m=x*x,v=m*x,o.push(p*l+3*h*x*e+3*f*m*n+v*a,p*u+3*h*x*r+3*f*m*i+v*s)}}function nE(t,e,r,n,i,a,s,o){const l=t-r*i,u=e-n*i,c=t+r*a,f=e+n*a;let h,p;s?(h=n,p=-r):(h=-n,p=r);const m=l+h,v=u+p,y=c+h,x=f+p;return o.push(m,v),o.push(y,x),2}function ec(t,e,r,n,i,a,s,o){const l=r-t,u=n-e;let c=Math.atan2(l,u),f=Math.atan2(i-t,a-e);o&&c<f?c+=Math.PI*2:!o&&c>f&&(f+=Math.PI*2);let h=c;const p=f-c,m=Math.abs(p),v=Math.sqrt(l*l+u*u),y=(15*m*Math.sqrt(v)/Math.PI>>0)+1,x=p/y;if(h+=x,o){s.push(t,e),s.push(r,n);for(let S=1,b=h;S<y;S++,b+=x)s.push(t,e),s.push(t+Math.sin(b)*v,e+Math.cos(b)*v);s.push(t,e),s.push(i,a)}else{s.push(r,n),s.push(t,e);for(let S=1,b=h;S<y;S++,b+=x)s.push(t+Math.sin(b)*v,e+Math.cos(b)*v),s.push(t,e);s.push(i,a),s.push(t,e)}return y*2}function LG(t,e){const r=t.shape;let n=t.points||r.points.slice();const i=e.closePointEps;if(n.length===0)return;const a=t.lineStyle,s=new zr(n[0],n[1]),o=new zr(n[n.length-2],n[n.length-1]),l=r.type!==gi.POLY||r.closeStroke,u=Math.abs(s.x-o.x)<i&&Math.abs(s.y-o.y)<i;if(l){n=n.slice(),u&&(n.pop(),n.pop(),o.set(n[n.length-2],n[n.length-1]));const j=(s.x+o.x)*.5,k=(o.y+s.y)*.5;n.unshift(j,k),n.push(j,k)}const c=e.points,f=n.length/2;let h=n.length;const p=c.length/2,m=a.width/2,v=m*m,y=a.miterLimit*a.miterLimit;let x=n[0],S=n[1],b=n[2],A=n[3],E=0,_=0,T=-(S-A),M=x-b,N=0,I=0,F=Math.sqrt(T*T+M*M);T/=F,M/=F,T*=m,M*=m;const P=a.alignment,U=(1-P)*2,G=P*2;l||(a.cap===lc.ROUND?h+=ec(x-T*(U-G)*.5,S-M*(U-G)*.5,x-T*U,S-M*U,x+T*G,S+M*G,c,!0)+2:a.cap===lc.SQUARE&&(h+=nE(x,S,T,M,U,G,!0,c))),c.push(x-T*U,S-M*U),c.push(x+T*G,S+M*G);for(let j=1;j<f-1;++j){x=n[(j-1)*2],S=n[(j-1)*2+1],b=n[j*2],A=n[j*2+1],E=n[(j+1)*2],_=n[(j+1)*2+1],T=-(S-A),M=x-b,F=Math.sqrt(T*T+M*M),T/=F,M/=F,T*=m,M*=m,N=-(A-_),I=b-E,F=Math.sqrt(N*N+I*I),N/=F,I/=F,N*=m,I*=m;const k=b-x,Z=S-A,z=b-E,me=_-A,fe=k*z+Z*me,ue=Z*z-me*k,le=ue<0;if(Math.abs(ue)<.001*Math.abs(fe)){c.push(b-T*U,A-M*U),c.push(b+T*G,A+M*G),fe>=0&&(a.join===Zu.ROUND?h+=ec(b,A,b-T*U,A-M*U,b-N*U,A-I*U,c,!1)+4:h+=2,c.push(b-N*G,A-I*G),c.push(b+N*U,A+I*U));continue}const ke=(-T+x)*(-M+A)-(-T+b)*(-M+S),Me=(-N+E)*(-I+A)-(-N+b)*(-I+_),Se=(k*Me-z*ke)/ue,oe=(me*ke-Z*Me)/ue,K=(Se-b)*(Se-b)+(oe-A)*(oe-A),de=b+(Se-b)*U,_e=A+(oe-A)*U,be=b-(Se-b)*G,$e=A-(oe-A)*G,Oe=Math.min(k*k+Z*Z,z*z+me*me),Qe=le?U:G,ae=Oe+Qe*Qe*v;K<=ae?a.join===Zu.BEVEL||K/v>y?(le?(c.push(de,_e),c.push(b+T*G,A+M*G),c.push(de,_e),c.push(b+N*G,A+I*G)):(c.push(b-T*U,A-M*U),c.push(be,$e),c.push(b-N*U,A-I*U),c.push(be,$e)),h+=2):a.join===Zu.ROUND?le?(c.push(de,_e),c.push(b+T*G,A+M*G),h+=ec(b,A,b+T*G,A+M*G,b+N*G,A+I*G,c,!0)+4,c.push(de,_e),c.push(b+N*G,A+I*G)):(c.push(b-T*U,A-M*U),c.push(be,$e),h+=ec(b,A,b-T*U,A-M*U,b-N*U,A-I*U,c,!1)+4,c.push(b-N*U,A-I*U),c.push(be,$e)):(c.push(de,_e),c.push(be,$e)):(c.push(b-T*U,A-M*U),c.push(b+T*G,A+M*G),a.join===Zu.ROUND?le?h+=ec(b,A,b+T*G,A+M*G,b+N*G,A+I*G,c,!0)+2:h+=ec(b,A,b-T*U,A-M*U,b-N*U,A-I*U,c,!1)+2:a.join===Zu.MITER&&K/v<=y&&(le?(c.push(be,$e),c.push(be,$e)):(c.push(de,_e),c.push(de,_e)),h+=2),c.push(b-N*U,A-I*U),c.push(b+N*G,A+I*G),h+=2)}x=n[(f-2)*2],S=n[(f-2)*2+1],b=n[(f-1)*2],A=n[(f-1)*2+1],T=-(S-A),M=x-b,F=Math.sqrt(T*T+M*M),T/=F,M/=F,T*=m,M*=m,c.push(b-T*U,A-M*U),c.push(b+T*G,A+M*G),l||(a.cap===lc.ROUND?h+=ec(b-T*(U-G)*.5,A-M*(U-G)*.5,b-T*U,A-M*U,b+T*G,A+M*G,c,!1)+2:a.cap===lc.SQUARE&&(h+=nE(b,A,T,M,U,G,!1,c)));const V=e.indices,$=Zf.epsilon*Zf.epsilon;for(let j=p;j<h+p-2;++j)x=c[j*2],S=c[j*2+1],b=c[(j+1)*2],A=c[(j+1)*2+1],E=c[(j+2)*2],_=c[(j+2)*2+1],!(Math.abs(x*(A-_)+b*(_-S)+E*(S-A))<$)&&V.push(j,j+1,j+2)}function UG(t,e){let r=0;const n=t.shape,i=t.points||n.points,a=n.type!==gi.POLY||n.closeStroke;if(i.length===0)return;const s=e.points,o=e.indices,l=i.length/2,u=s.length/2;let c=u;for(s.push(i[0],i[1]),r=1;r<l;r++)s.push(i[r*2],i[r*2+1]),o.push(c,c+1),c++;a&&o.push(c,u)}function iE(t,e){t.lineStyle.native?UG(t,e):LG(t,e)}class Rb{static curveLength(e,r,n,i,a,s){const o=e-2*n+a,l=r-2*i+s,u=2*n-2*e,c=2*i-2*r,f=4*(o*o+l*l),h=4*(o*u+l*c),p=u*u+c*c,m=2*Math.sqrt(f+h+p),v=Math.sqrt(f),y=2*f*v,x=2*Math.sqrt(p),S=h/v;return(y*m+v*h*(m-x)+(4*p*f-h*h)*Math.log((2*v+S+m)/(S+x)))/(4*y)}static curveTo(e,r,n,i,a){const s=a[a.length-2],o=a[a.length-1],l=Zf._segmentsCount(Rb.curveLength(s,o,e,r,n,i));let u=0,c=0;for(let f=1;f<=l;++f){const h=f/l;u=s+(e-s)*h,c=o+(r-o)*h,a.push(u+(e+(n-e)*h-u)*h,c+(r+(i-r)*h-c)*h)}}}const Z0={[gi.POLY]:hM,[gi.CIRC]:sv,[gi.ELIP]:sv,[gi.RECT]:PG,[gi.RREC]:$G},aE=[],Zp=[];class ov{constructor(e,r=null,n=null,i=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=n,this.fillStyle=r,this.matrix=i,this.type=e.type}clone(){return new ov(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const ff=new zr,dM=class extends gN{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new rv,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Zp.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),aE.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,r=null,n=null){const i=new ov(t,e,r,n);return this.graphicsData.push(i),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const r=new ov(t,null,null,e),n=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=n.lineStyle,n.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let r=0;r<e.length;++r){const n=e[r];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(t,ff):ff.copyFrom(t),n.shape.contains(ff.x,ff.y))){let i=!1;if(n.holes){for(let a=0;a<n.holes.length;a++)if(n.holes[a].shape.contains(ff.x,ff.y)){i=!0;break}}if(!i)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let r=null,n=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],n=r.style);for(let o=this.shapeIndex;o<e.length;o++){this.shapeIndex++;const l=e[o],u=l.fillStyle,c=l.lineStyle;Z0[l.type].build(l),l.matrix&&this.transformPoints(l.points,l.matrix),(u.visible||c.visible)&&this.processHoles(l.holes);for(let h=0;h<2;h++){const p=h===0?u:c;if(!p.visible)continue;const m=p.texture.baseTexture,v=this.indices.length,y=this.points.length/2;m.wrapMode=al.REPEAT,h===0?this.processFill(l):this.processLine(l);const x=this.points.length/2-y;x!==0&&(r&&!this._compareStyles(n,p)&&(r.end(v,y),r=null),r||(r=aE.pop()||new kG,r.begin(p,v,y),this.batches.push(r),n=p),this.addUvs(this.points,t,p.texture,y,x,p.matrix))}}const i=this.indices.length,a=this.points.length/2;if(r&&r.end(i,a),this.batches.length===0){this.batchable=!0;return}const s=a>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&s===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=s?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const r=this.graphicsData[t],n=r.fillStyle,i=r.lineStyle;if(n&&!n.texture.baseTexture.valid||i&&!i.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,r=t.length;e<r;e++){const n=t[e];for(let i=0;i<n.size;i++){const a=n.start+i;this.indicesUint16[a]=this.indicesUint16[a]-n.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<dM.BATCHABLE_SIZE*2}buildDrawCalls(){let t=++pr._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),Zp.push(this.drawCalls[c]);this.drawCalls.length=0;const e=this.colors,r=this.textureIds;let n=Zp.pop();n||(n=new c1,n.texArray=new h1),n.texArray.count=0,n.start=0,n.size=0,n.type=po.TRIANGLES;let i=0,a=null,s=0,o=!1,l=po.TRIANGLES,u=0;this.drawCalls.push(n);for(let c=0;c<this.batches.length;c++){const f=this.batches[c],h=8,p=f.style,m=p.texture.baseTexture;o!==!!p.native&&(o=!!p.native,l=o?po.LINES:po.TRIANGLES,a=null,i=h,t++),a!==m&&(a=m,m._batchEnabled!==t&&(i===h&&(t++,i=0,n.size>0&&(n=Zp.pop(),n||(n=new c1,n.texArray=new h1),this.drawCalls.push(n)),n.start=u,n.size=0,n.texArray.count=0,n.type=l),m.touched=1,m._batchEnabled=t,m._batchLocation=i,m.wrapMode=al.REPEAT,n.texArray.elements[n.texArray.count++]=m,i++)),n.size+=f.size,u+=f.size,s=m._batchLocation,this.addColors(e,p.color,p.alpha,f.attribSize,f.attribStart),this.addTextureIds(r,s,f.attribSize,f.attribStart)}pr._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,r=this.colors,n=this.textureIds,i=new ArrayBuffer(t.length*3*4),a=new Float32Array(i),s=new Uint32Array(i);let o=0;for(let l=0;l<t.length/2;l++)a[o++]=t[l*2],a[o++]=t[l*2+1],a[o++]=e[l*2],a[o++]=e[l*2+1],s[o++]=r[l],a[o++]=n[l];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?hM.triangulate(t,this):Z0[t.type].triangulate(t,this)}processLine(t){iE(t,this);for(let e=0;e<t.holes.length;e++)iE(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const r=t[e];Z0[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let r=0;r<t.length/2;r++){const n=t[r*2],i=t[r*2+1];t[r*2]=e.a*n+e.c*i+e.tx,t[r*2+1]=e.b*n+e.d*i+e.ty}}addColors(t,e,r,n,i=0){const a=(e>>16)+(e&65280)+((e&255)<<16),s=Cb(a,r);t.length=Math.max(t.length,i+n);for(let o=0;o<n;o++)t[i+o]=s}addTextureIds(t,e,r,n=0){t.length=Math.max(t.length,n+r);for(let i=0;i<r;i++)t[n+i]=e}addUvs(t,e,r,n,i,a=null){let s=0;const o=e.length,l=r.frame;for(;s<i;){let c=t[(n+s)*2],f=t[(n+s)*2+1];if(a){const h=a.a*c+a.c*f+a.tx;f=a.b*c+a.d*f+a.ty,c=h}s++,e.push(c/l.width,f/l.height)}const u=r.baseTexture;(l.width<u.width||l.height<u.height)&&this.adjustUvs(e,r,o,i)}adjustUvs(t,e,r,n){const i=e.baseTexture,a=1e-6,s=r+n*2,o=e.frame,l=o.width/i.width,u=o.height/i.height;let c=o.x/o.width,f=o.y/o.height,h=Math.floor(t[r]+a),p=Math.floor(t[r+1]+a);for(let m=r+2;m<s;m+=2)h=Math.min(h,Math.floor(t[m]+a)),p=Math.min(p,Math.floor(t[m+1]+a));c-=h,f-=p;for(let m=r;m<s;m+=2)t[m]=(t[m]+c)*l,t[m+1]=(t[m+1]+f)*u}};let pM=dM;pM.BATCHABLE_SIZE=100;class Yv{constructor(){this.color=16777215,this.alpha=1,this.texture=kt.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new Yv;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=kt.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Pb extends Yv{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=lc.BUTT,this.join=Zu.MITER,this.miterLimit=10}clone(){const e=new Pb;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const zG=new Float32Array(3),Q0={},km=class extends Ca{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Yv,this._lineStyle=new Pb,this._matrix=null,this._holeMode=!1,this.state=xu.for2d(),this._geometry=t||new pM,this._geometry.refCount++,this._transformID=-1,this.tint=16777215,this.blendMode=Zt.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new km(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(t){this._tint=t}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,r=1,n=.5,i=!1){return typeof t=="number"&&(t={width:t,color:e,alpha:r,alignment:n,native:i}),this.lineTextureStyle(t)}lineTextureStyle(t){t=Object.assign({width:0,texture:kt.WHITE,color:t!=null&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:lc.BUTT,join:Zu.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();const e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Uf,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Uf,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const r=this.currentPath.points,n=r[r.length-2],i=r[r.length-1];return(n!==t||i!==e)&&r.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,r,n){this._initCurve();const i=this.currentPath.points;return i.length===0&&this.moveTo(0,0),Rb.curveTo(t,e,r,n,i),this}bezierCurveTo(t,e,r,n,i,a){return this._initCurve(),Bb.curveTo(t,e,r,n,i,a,this.currentPath.points),this}arcTo(t,e,r,n,i){this._initCurve(t,e);const a=this.currentPath.points,s=rE.curveTo(t,e,r,n,i,a);if(s){const{cx:o,cy:l,radius:u,startAngle:c,endAngle:f,anticlockwise:h}=s;this.arc(o,l,u,c,f,h)}return this}arc(t,e,r,n,i,a=!1){if(n===i)return this;if(!a&&i<=n?i+=tv:a&&n<=i&&(n+=tv),i-n===0)return this;const o=t+Math.cos(n)*r,l=e+Math.sin(n)*r,u=this._geometry.closePointEps;let c=this.currentPath?this.currentPath.points:null;if(c){const f=Math.abs(c[c.length-2]-o),h=Math.abs(c[c.length-1]-l);f<u&&h<u||c.push(o,l)}else this.moveTo(o,l),c=this.currentPath.points;return rE.arc(o,l,t,e,r,n,i,a,c),this}beginFill(t=0,e=1){return this.beginTextureFill({texture:kt.WHITE,color:t,alpha:e})}beginTextureFill(t){t=Object.assign({texture:kt.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();const e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,r,n){return this.drawShape(new Br(t,e,r,n))}drawRoundedRect(t,e,r,n,i){return this.drawShape(new Mb(t,e,r,n,i))}drawCircle(t,e,r){return this.drawShape(new Tb(t,e,r))}drawEllipse(t,e,r,n){return this.drawShape(new Nb(t,e,r,n))}drawPolygon(...t){let e,r=!0;const n=t[0];n.points?(r=n.closeStroke,e=n.points):Array.isArray(t[0])?e=t[0]:e=t;const i=new Uf(e);return i.closeStroke=r,this.drawShape(i),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===gi.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(let n=0;n<r;n++){const i=t.batches[n],a=i.style.color,s=new Float32Array(this.vertexData.buffer,i.attribStart*4*2,i.attribSize*2),o=new Float32Array(t.uvsFloat32.buffer,i.attribStart*4*2,i.attribSize*2),l=new Uint16Array(t.indicesUint16.buffer,i.start*2,i.size),u={vertexData:s,blendMode:e,indices:l,uvs:o,_batchRGB:Sd(a),_tintRGB:a,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[n]=u}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,r=this.batches.length;e<r;e++){const n=this.batches[e];n.worldAlpha=this.worldAlpha*n.alpha,t.plugins[this.pluginName].render(n)}}}_renderDirect(t){const e=this._resolveDirectShader(t),r=this._geometry,n=this.tint,i=this.worldAlpha,a=e.uniforms,s=r.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(n>>16&255)/255*i,a.tint[1]=(n>>8&255)/255*i,a.tint[2]=(n&255)/255*i,a.tint[3]=i,t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(let o=0,l=s.length;o<l;o++)this._renderDrawCallDirect(t,r.drawCalls[o])}_renderDrawCallDirect(t,e){const{texArray:r,type:n,size:i,start:a}=e,s=r.count;for(let o=0;o<s;o++)t.texture.bind(r.elements[o],o);t.geometry.draw(n,i,a)}_resolveDirectShader(t){let e=this.shader;const r=this.pluginName;if(!e){if(!Q0[r]){const{maxTextures:n}=t.plugins[r],i=new Int32Array(n);for(let o=0;o<n;o++)i[o]=o;const a={tint:new Float32Array([1,1,1,1]),translationMatrix:new qn,default:ks.from({uSamplers:i},!0)},s=t.plugins[r]._shader.program;Q0[r]=new go(s,a)}e=Q0[r]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:r,maxX:n,maxY:i}=t.bounds;this._bounds.addFrame(this.transform,e,r,n,i)}containsPoint(t){return this.worldTransform.applyInverse(t,km._TEMP_POINT),this._geometry.containsPoint(km._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const t=Sd(this.tint,zG);for(let e=0;e<this.batches.length;e++){const r=this.batches[e],n=r._batchRGB,i=t[0]*n[0]*255,a=t[1]*n[1]*255,s=t[2]*n[2]*255,o=(i<<16)+(a<<8)+(s|0);r._tintRGB=(o>>16)+(o&65280)+((o&255)<<16)}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,r=e.a,n=e.b,i=e.c,a=e.d,s=e.tx,o=e.ty,l=this._geometry.points,u=this.vertexData;let c=0;for(let f=0;f<l.length;f+=2){const h=l[f],p=l[f+1];u[c++]=r*h+i*p+s,u[c++]=a*p+n*h+o}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};let Kv=km;Kv.curves=Zf;Kv._TEMP_POINT=new zr;class GG{constructor(e,r){this.uvBuffer=e,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}}const J0=new zr,sE=new Uf,mM=class extends Ca{constructor(t,e,r,n=po.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=r||xu.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=Nt.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===po.TRIANGLES&&e.length<mM.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;const n=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[n]),t.plugins[n].render(this)}calculateVertices(){const e=this.geometry.buffers[0],r=e.data,n=e._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==r.length&&(this.vertexData=new Float32Array(r.length));const i=this.transform.worldTransform,a=i.a,s=i.b,o=i.c,l=i.d,u=i.tx,c=i.ty,f=this.vertexData;for(let h=0;h<f.length/2;h++){const p=r[h*2],m=r[h*2+1];f[h*2]=a*p+o*m+u,f[h*2+1]=s*p+l*m+c}if(this._roundPixels){const h=Nt.RESOLUTION;for(let p=0;p<f.length;++p)f[p]=Math.round(f[p]*h)/h}this.vertexDirty=n}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new GG(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,J0);const e=this.geometry.getBuffer("aVertexPosition").data,r=sE.points,n=this.geometry.getIndex().data,i=n.length,a=this.drawMode===4?3:1;for(let s=0;s+2<i;s+=a){const o=n[s]*2,l=n[s+1]*2,u=n[s+2]*2;if(r[0]=e[o],r[1]=e[o+1],r[2]=e[l],r[3]=e[l+1],r[4]=e[u],r[5]=e[u+1],sE.contains(J0.x,J0.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let E1=mM;E1.BATCHABLE_SIZE=100;class qG extends ul{constructor(e,r,n){super();const i=new Pn(e),a=new Pn(r,!0),s=new Pn(n,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,Ht.FLOAT).addAttribute("aTextureCoord",a,2,!1,Ht.FLOAT).addIndex(s),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var HG=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,WG=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class oE extends go{constructor(e,r){const n={uSampler:e,alpha:1,uTextureMatrix:qn.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(n,r.uniforms),super(r.program||Rs.from(WG,HG),n),this._colorDirty=!1,this.uvMatrix=new RN(e),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this.tint=r.tint,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this._tint&&(this._tint=e,this._tintRGB=(e>>16)+(e&65280)+((e&255)<<16),this._colorDirty=!0)}get tint(){return this._tint}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture;dN(this._tint,this._alpha,this.uniforms.uColor,e.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class uE{constructor(e,r,n){this.geometry=new ul,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<e.length;++i){let a=e[i];a={attributeName:a.attributeName,size:a.size,uploadFunction:a.uploadFunction,type:a.type||Ht.FLOAT,offset:a.offset},r[i]?this.dynamicProperties.push(a):this.staticProperties.push(a)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let r=0;this.indexBuffer=new Pn(P7(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let s=0;s<this.dynamicProperties.length;++s){const o=this.dynamicProperties[s];o.offset=r,r+=o.size,this.dynamicStride+=o.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new Pn(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let s=0;s<this.staticProperties.length;++s){const o=this.staticProperties[s];o.offset=i,i+=o.size,this.staticStride+=o.size}const a=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(a),this.staticDataUint32=new Uint32Array(a),this.staticBuffer=new Pn(this.staticData,!0,!1);for(let s=0;s<this.dynamicProperties.length;++s){const o=this.dynamicProperties[s];e.addAttribute(o.attributeName,this.dynamicBuffer,0,o.type===Ht.UNSIGNED_BYTE,o.type,this.dynamicStride*4,o.offset*4)}for(let s=0;s<this.staticProperties.length;++s){const o=this.staticProperties[s];e.addAttribute(o.attributeName,this.staticBuffer,0,o.type===Ht.UNSIGNED_BYTE,o.type,this.staticStride*4,o.offset*4)}}uploadDynamic(e,r,n){for(let i=0;i<this.dynamicProperties.length;i++){const a=this.dynamicProperties[i];a.uploadFunction(e,r,n,a.type===Ht.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,a.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,r,n){for(let i=0;i<this.staticProperties.length;i++){const a=this.staticProperties[i];a.uploadFunction(e,r,n,a.type===Ht.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,a.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var VG=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,XG=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class vM extends Vv{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new qn,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Ht.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=go.from(XG,VG,{}),this.state=xu.for2d()}render(e){const r=e.children,n=e._maxSize,i=e._batchSize,a=this.renderer;let s=r.length;if(s===0)return;s>n&&!e.autoResize&&(s=n);let o=e._buffers;o||(o=e._buffers=this.generateBuffers(e));const l=r[0]._texture.baseTexture,u=l.alphaMode>0;this.state.blendMode=hN(e.blendMode,u),a.state.set(this.state);const c=a.gl,f=e.worldTransform.copyTo(this.tempMatrix);f.prepend(a.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=f.toArray(!0),this.shader.uniforms.uColor=R7(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,u),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let h=!1;for(let p=0,m=0;p<s;p+=i,m+=1){let v=s-p;v>i&&(v=i),m>=o.length&&o.push(this._generateOneMoreBuffer(e));const y=o[m];y.uploadDynamic(r,p,v);const x=e._bufferUpdateIDs[m]||0;h=h||y._updateID<x,h&&(y._updateID=e._updateID,y.uploadStatic(r,p,v)),a.geometry.bind(y.geometry),c.drawElements(c.TRIANGLES,v*6,c.UNSIGNED_SHORT,0)}}generateBuffers(e){const r=[],n=e._maxSize,i=e._batchSize,a=e._properties;for(let s=0;s<n;s+=i)r.push(new uE(this.properties,a,i));return r}_generateOneMoreBuffer(e){const r=e._batchSize,n=e._properties;return new uE(this.properties,n,r)}uploadVertices(e,r,n,i,a,s){let o=0,l=0,u=0,c=0;for(let f=0;f<n;++f){const h=e[r+f],p=h._texture,m=h.scale.x,v=h.scale.y,y=p.trim,x=p.orig;y?(l=y.x-h.anchor.x*x.width,o=l+y.width,c=y.y-h.anchor.y*x.height,u=c+y.height):(o=x.width*(1-h.anchor.x),l=x.width*-h.anchor.x,u=x.height*(1-h.anchor.y),c=x.height*-h.anchor.y),i[s]=l*m,i[s+1]=c*v,i[s+a]=o*m,i[s+a+1]=c*v,i[s+a*2]=o*m,i[s+a*2+1]=u*v,i[s+a*3]=l*m,i[s+a*3+1]=u*v,s+=a*4}}uploadPosition(e,r,n,i,a,s){for(let o=0;o<n;o++){const l=e[r+o].position;i[s]=l.x,i[s+1]=l.y,i[s+a]=l.x,i[s+a+1]=l.y,i[s+a*2]=l.x,i[s+a*2+1]=l.y,i[s+a*3]=l.x,i[s+a*3+1]=l.y,s+=a*4}}uploadRotation(e,r,n,i,a,s){for(let o=0;o<n;o++){const l=e[r+o].rotation;i[s]=l,i[s+a]=l,i[s+a*2]=l,i[s+a*3]=l,s+=a*4}}uploadUvs(e,r,n,i,a,s){for(let o=0;o<n;++o){const l=e[r+o]._texture._uvs;l?(i[s]=l.x0,i[s+1]=l.y0,i[s+a]=l.x1,i[s+a+1]=l.y1,i[s+a*2]=l.x2,i[s+a*2+1]=l.y2,i[s+a*3]=l.x3,i[s+a*3+1]=l.y3,s+=a*4):(i[s]=0,i[s+1]=0,i[s+a]=0,i[s+a+1]=0,i[s+a*2]=0,i[s+a*2+1]=0,i[s+a*3]=0,i[s+a*3+1]=0,s+=a*4)}}uploadTint(e,r,n,i,a,s){for(let o=0;o<n;++o){const l=e[r+o],u=l._texture.baseTexture.alphaMode>0,c=l.alpha,f=c<1&&u?Cb(l._tintRGB,c):l._tintRGB+(c*255<<24);i[s]=f,i[s+a]=f,i[s+a*2]=f,i[s+a*3]=f,s+=a*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}vM.extension={name:"particle",type:Tt.RendererPlugin};Lt.add(vM);var Zv=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(Zv||{});const Qp={willReadFrequently:!0},$t=class{static get experimentalLetterSpacingSupported(){let t=$t._experimentalLetterSpacingSupported;if(t!==void 0){const e=Nt.ADAPTER.getCanvasRenderingContext2D().prototype;t=$t._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,r,n,i,a,s,o,l){this.text=t,this.style=e,this.width=r,this.height=n,this.lines=i,this.lineWidths=a,this.lineHeight=s,this.maxLineWidth=o,this.fontProperties=l}static measureText(t,e,r,n=$t._canvas){r=r??e.wordWrap;const i=e.toFontString(),a=$t.measureFont(i);a.fontSize===0&&(a.fontSize=e.fontSize,a.ascent=e.fontSize);const s=n.getContext("2d",Qp);s.font=i;const l=(r?$t.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),u=new Array(l.length);let c=0;for(let m=0;m<l.length;m++){const v=$t._measureText(l[m],e.letterSpacing,s);u[m]=v,c=Math.max(c,v)}let f=c+e.strokeThickness;e.dropShadow&&(f+=e.dropShadowDistance);const h=e.lineHeight||a.fontSize+e.strokeThickness;let p=Math.max(h,a.fontSize+e.strokeThickness*2)+(l.length-1)*(h+e.leading);return e.dropShadow&&(p+=e.dropShadowDistance),new $t(t,e,f,p,l,u,h+e.leading,c,a)}static _measureText(t,e,r){let n=!1;$t.experimentalLetterSpacingSupported&&($t.experimentalLetterSpacing?(r.letterSpacing=`${e}px`,r.textLetterSpacing=`${e}px`,n=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let i=r.measureText(t).width;return i>0&&(n?i-=e:i+=($t.graphemeSegmenter(t).length-1)*e),i}static wordWrap(t,e,r=$t._canvas){const n=r.getContext("2d",Qp);let i=0,a="",s="";const o=Object.create(null),{letterSpacing:l,whiteSpace:u}=e,c=$t.collapseSpaces(u),f=$t.collapseNewlines(u);let h=!c;const p=e.wordWrapWidth+l,m=$t.tokenize(t);for(let v=0;v<m.length;v++){let y=m[v];if($t.isNewline(y)){if(!f){s+=$t.addLine(a),h=!c,a="",i=0;continue}y=" "}if(c){const S=$t.isBreakingSpace(y),b=$t.isBreakingSpace(a[a.length-1]);if(S&&b)continue}const x=$t.getFromCache(y,l,o,n);if(x>p)if(a!==""&&(s+=$t.addLine(a),a="",i=0),$t.canBreakWords(y,e.breakWords)){const S=$t.wordWrapSplit(y);for(let b=0;b<S.length;b++){let A=S[b],E=A,_=1;for(;S[b+_];){const M=S[b+_];if(!$t.canBreakChars(E,M,y,b,e.breakWords))A+=M;else break;E=M,_++}b+=_-1;const T=$t.getFromCache(A,l,o,n);T+i>p&&(s+=$t.addLine(a),h=!1,a="",i=0),a+=A,i+=T}}else{a.length>0&&(s+=$t.addLine(a),a="",i=0);const S=v===m.length-1;s+=$t.addLine(y,!S),h=!1,a="",i=0}else x+i>p&&(h=!1,s+=$t.addLine(a),a="",i=0),(a.length>0||!$t.isBreakingSpace(y)||h)&&(a+=y,i+=x)}return s+=$t.addLine(a,!1),s}static addLine(t,e=!0){return t=$t.trimRight(t),t=e?`${t}
`:t,t}static getFromCache(t,e,r,n){let i=r[t];return typeof i!="number"&&(i=$t._measureText(t,e,n)+e,r[t]=i),i}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const r=t[e];if(!$t.isBreakingSpace(r))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:$t._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:$t._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let r="";if(typeof t!="string")return e;for(let n=0;n<t.length;n++){const i=t[n],a=t[n+1];if($t.isBreakingSpace(i,a)||$t.isNewline(i)){r!==""&&(e.push(r),r=""),e.push(i);continue}r+=i}return r!==""&&e.push(r),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,r,n,i){return!0}static wordWrapSplit(t){return $t.graphemeSegmenter(t)}static measureFont(t){if($t._fonts[t])return $t._fonts[t];const e={ascent:0,descent:0,fontSize:0},r=$t._canvas,n=$t._context;n.font=t;const i=$t.METRICS_STRING+$t.BASELINE_SYMBOL,a=Math.ceil(n.measureText(i).width);let s=Math.ceil(n.measureText($t.BASELINE_SYMBOL).width);const o=Math.ceil($t.HEIGHT_MULTIPLIER*s);if(s=s*$t.BASELINE_MULTIPLIER|0,a===0||o===0)return $t._fonts[t]=e,e;r.width=a,r.height=o,n.fillStyle="#f00",n.fillRect(0,0,a,o),n.font=t,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(i,0,s);const l=n.getImageData(0,0,a,o).data,u=l.length,c=a*4;let f=0,h=0,p=!1;for(f=0;f<s;++f){for(let m=0;m<c;m+=4)if(l[h+m]!==255){p=!0;break}if(!p)h+=c;else break}for(e.ascent=s-f,h=u-c,p=!1,f=o;f>s;--f){for(let m=0;m<c;m+=4)if(l[h+m]!==255){p=!0;break}if(!p)h-=c;else break}return e.descent=f-s,e.fontSize=e.ascent+e.descent,$t._fonts[t]=e,e}static clearMetrics(t=""){t?delete $t._fonts[t]:$t._fonts={}}static get _canvas(){if(!$t.__canvas){let t;try{const e=new OffscreenCanvas(0,0),r=e.getContext("2d",Qp);if(r!=null&&r.measureText)return $t.__canvas=e,e;t=Nt.ADAPTER.createCanvas()}catch{t=Nt.ADAPTER.createCanvas()}t.width=t.height=10,$t.__canvas=t}return $t.__canvas}static get _context(){return $t.__context||($t.__context=$t._canvas.getContext("2d",Qp)),$t.__context}};let mi=$t;mi.METRICS_STRING="|ÉqÅ";mi.BASELINE_SYMBOL="M";mi.BASELINE_MULTIPLIER=1.4;mi.HEIGHT_MULTIPLIER=2;mi.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(r=>r.segment)}return t=>[...t]})();mi.experimentalLetterSpacing=!1;mi._fonts={};mi._newlines=[10,13];mi._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const jG=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],fd=class{constructor(t){this.styleID=0,this.reset(),ty(this,t,t)}clone(){const t={};return ty(t,this,fd.defaultStyle),new fd(t)}reset(){ty(this,fd.defaultStyle,fd.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=ey(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=ey(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){YG(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=ey(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let r=e.length-1;r>=0;r--){let n=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!jG.includes(n)&&(n=`"${n}"`),e[r]=n}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};let bc=fd;bc.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Zv.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function lE(t){return typeof t=="number"?cN(t):(typeof t=="string"&&t.startsWith("0x")&&(t=t.replace("0x","#")),t)}function ey(t){if(Array.isArray(t)){for(let e=0;e<t.length;++e)t[e]=lE(t[e]);return t}else return lE(t)}function YG(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}function ty(t,e,r){for(const n in r)Array.isArray(e[n])?t[n]=e[n].slice():t[n]=e[n]}const KG={texture:!0,children:!1,baseTexture:!0},S1=class extends bh{constructor(t,e,r){let n=!1;r||(r=Nt.ADAPTER.createCanvas(),n=!0),r.width=3,r.height=3;const i=kt.from(r);i.orig=new Br,i.trim=new Br,super(i),this._ownCanvas=n,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=S1.defaultResolution??Nt.RESOLUTION,this._autoResolution=S1.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return mi.experimentalLetterSpacing}static set experimentalLetterSpacing(t){qr("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),mi.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const r=this.context,n=mi.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),i=n.width,a=n.height,s=n.lines,o=n.lineHeight,l=n.lineWidths,u=n.maxLineWidth,c=n.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,i)+e.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+e.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=e.strokeThickness,r.textBaseline=e.textBaseline,r.lineJoin=e.lineJoin,r.miterLimit=e.miterLimit;let f,h;const p=e.dropShadow?2:1;for(let m=0;m<p;++m){const v=e.dropShadow&&m===0,y=v?Math.ceil(Math.max(1,a)+e.padding*2):0,x=y*this._resolution;if(v){r.fillStyle="black",r.strokeStyle="black";const b=e.dropShadowColor,A=Sd(typeof b=="number"?b:Db(b)),E=e.dropShadowBlur*this._resolution,_=e.dropShadowDistance*this._resolution;r.shadowColor=`rgba(${A[0]*255},${A[1]*255},${A[2]*255},${e.dropShadowAlpha})`,r.shadowBlur=E,r.shadowOffsetX=Math.cos(e.dropShadowAngle)*_,r.shadowOffsetY=Math.sin(e.dropShadowAngle)*_+x}else r.fillStyle=this._generateFillStyle(e,s,n),r.strokeStyle=e.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let S=(o-c.fontSize)/2;o-c.fontSize<0&&(S=0);for(let b=0;b<s.length;b++)f=e.strokeThickness/2,h=e.strokeThickness/2+b*o+c.ascent+S,e.align==="right"?f+=u-l[b]:e.align==="center"&&(f+=(u-l[b])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(s[b],f+e.padding,h+e.padding-y,!0),e.fill&&this.drawLetterSpacing(s[b],f+e.padding,h+e.padding-y)}this.updateTexture()}drawLetterSpacing(t,e,r,n=!1){const a=this._style.letterSpacing;let s=!1;if(mi.experimentalLetterSpacingSupported&&(mi.experimentalLetterSpacing?(this.context.letterSpacing=`${a}px`,this.context.textLetterSpacing=`${a}px`,s=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),a===0||s){n?this.context.strokeText(t,e,r):this.context.fillText(t,e,r);return}let o=e;const l=mi.graphemeSegmenter(t);let u=this.context.measureText(t).width,c=0;for(let f=0;f<l.length;++f){const h=l[f];n?this.context.strokeText(h,o,r):this.context.fillText(h,o,r);let p="";for(let m=f+1;m<l.length;++m)p+=l[m];c=this.context.measureText(p).width,o+=u-c+a,u=c}}updateTexture(){const t=this.canvas;if(this._style.trim){const a=L7(t);a.data&&(t.width=a.width,t.height=a.height,this.context.putImageData(a.data,0,0))}const e=this._texture,r=this._style,n=r.trim?0:r.padding,i=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-n,e.trim.y=-n,e.orig.width=e._frame.width-n*2,e.orig.height=e._frame.height-n*2,this._onTextureUpdate(),i.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),this._textureID===-1&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,r){const n=t.fill;if(Array.isArray(n)){if(n.length===1)return n[0]}else return n;let i;const a=t.dropShadow?t.dropShadowDistance:0,s=t.padding||0,o=this.canvas.width/this._resolution-a-s*2,l=this.canvas.height/this._resolution-a-s*2,u=n.slice(),c=t.fillGradientStops.slice();if(!c.length){const f=u.length+1;for(let h=1;h<f;++h)c.push(h/f)}if(u.unshift(n[0]),c.unshift(0),u.push(n[n.length-1]),c.push(1),t.fillGradientType===Zv.LINEAR_VERTICAL){i=this.context.createLinearGradient(o/2,s,o/2,l+s);const f=r.fontProperties.fontSize+t.strokeThickness;for(let h=0;h<e.length;h++){const p=r.lineHeight*(h-1)+f,m=r.lineHeight*h;let v=m;h>0&&p>m&&(v=(m+p)/2);const y=m+f,x=r.lineHeight*(h+1);let S=y;h+1<e.length&&x<y&&(S=(y+x)/2);const b=(S-v)/l;for(let A=0;A<u.length;A++){let E=0;typeof c[A]=="number"?E=c[A]:E=A/u.length;let _=Math.min(1,Math.max(0,v/l+E*b));_=Number(_.toFixed(5)),i.addColorStop(_,u[A])}}}else{i=this.context.createLinearGradient(s,l/2,o+s,l/2);const f=u.length+1;let h=1;for(let p=0;p<u.length;p++){let m;typeof c[p]=="number"?m=c[p]:m=h/f,i.addColorStop(m,u[p]),h++}}return i}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},KG,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=Tf(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=Tf(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},t instanceof bc?this._style=t:this._style=new bc(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};let $b=S1;$b.defaultAutoResolution=!0;class ZG{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function QG(t,e){var n;let r=!1;if((n=t==null?void 0:t._textures)!=null&&n.length){for(let i=0;i<t._textures.length;i++)if(t._textures[i]instanceof kt){const a=t._textures[i].baseTexture;e.includes(a)||(e.push(a),r=!0)}}return r}function JG(t,e){if(t.baseTexture instanceof pr){const r=t.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function eq(t,e){if(t._texture&&t._texture instanceof kt){const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function tq(t,e){return e instanceof $b?(e.updateText(!0),!0):!1}function rq(t,e){if(e instanceof bc){const r=e.toFontString();return mi.measureFont(r),!0}return!1}function nq(t,e){if(t instanceof $b){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function iq(t,e){return t instanceof bc?(e.includes(t)||e.push(t),!0):!1}const gM=class{constructor(t){this.limiter=new ZG(gM.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(nq),this.registerFindHook(iq),this.registerFindHook(QG),this.registerFindHook(JG),this.registerFindHook(eq),this.registerUploadHook(tq),this.registerUploadHook(rq)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,da.system.addOnce(this.tick,this,Kf.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed){for(let r=0,n=this.uploadHooks.length;r<n;r++)if(this.uploadHooks[r](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)da.system.addOnce(this.tick,this,Kf.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,r=t.length;e<r;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Ca)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&da.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let uv=gM;uv.uploadsPerFrame=4;Object.defineProperties(Nt,{UPLOADS_PER_FRAME:{get(){return uv.uploadsPerFrame},set(t){qr("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),uv.uploadsPerFrame=t}}});function yM(t,e){return e instanceof pr?(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0):!1}function aq(t,e){if(!(e instanceof Kv))return!1;const{geometry:r}=e;e.finishPoly(),r.updateBatches();const{batches:n}=r;for(let i=0;i<n.length;i++){const{texture:a}=n[i].style;a&&yM(t,a.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function sq(t,e){return t instanceof Kv?(e.push(t),!0):!1}class bM extends uv{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(sq),this.registerUploadHook(yM),this.registerUploadHook(aq)}}bM.extension={name:"prepare",type:Tt.RendererSystem};Lt.add(bM);var oq=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,uq=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,lq=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,cE=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,cq=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Jp=new qn;class xM extends Vv{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new IN,this.state=xu.for2d()}contextChange(){const e=this.renderer,r={globals:e.globalUniforms};this.simpleShader=go.from(cE,cq,r),this.shader=e.context.webGLVersion>1?go.from(uq,oq,r):go.from(cE,lq,r)}render(e){const r=this.renderer,n=this.quad;let i=n.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);const a=e.uvRespectAnchor?e.anchor.x:0,s=e.uvRespectAnchor?e.anchor.y:0;i=n.uvs,i[0]=i[6]=-a,i[1]=i[3]=-s,i[2]=i[4]=1-a,i[5]=i[7]=1-s,n.invalidate();const o=e._texture,l=o.baseTexture,u=l.alphaMode>0,c=e.tileTransform.localTransform,f=e.uvMatrix;let h=l.isPowerOfTwo&&o.frame.width===l.width&&o.frame.height===l.height;h&&(l._glTextures[r.CONTEXT_UID]?h=l.wrapMode!==al.CLAMP:l.wrapMode===al.CLAMP&&(l.wrapMode=al.REPEAT));const p=h?this.simpleShader:this.shader,m=o.width,v=o.height,y=e._width,x=e._height;Jp.set(c.a*m/y,c.b*m/x,c.c*v/y,c.d*v/x,c.tx/y,c.ty/x),Jp.invert(),h?Jp.prepend(f.mapCoord):(p.uniforms.uMapCoord=f.mapCoord.toArray(!0),p.uniforms.uClampFrame=f.uClampFrame,p.uniforms.uClampOffset=f.uClampOffset),p.uniforms.uTransform=Jp.toArray(!0),p.uniforms.uColor=dN(e.tint,e.worldAlpha,p.uniforms.uColor,u),p.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),p.uniforms.uSampler=o,r.shader.bind(p),r.geometry.bind(n),this.state.blendMode=hN(e.blendMode,u),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}xM.extension={name:"tilingSprite",type:Tt.RendererPlugin};Lt.add(xM);const hd=class{constructor(t,e,r=null){this.linkedSheets=[],this._texture=t instanceof kt?t:null,this.baseTexture=t instanceof pr?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;const n=this.baseTexture.resource;this.resolution=this._updateResolution(r||(n?n.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let r=ol(t,null);return r===null&&(r=parseFloat(e??"1")),r!==1&&this.baseTexture.setResolution(r),r}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=hd.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const r=hd.BATCH_SIZE;for(;e-t<r&&e<this._frameKeys.length;){const n=this._frameKeys[e],i=this._frames[n],a=i.frame;if(a){let s=null,o=null;const l=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,u=new Br(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);i.rotated?s=new Br(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):s=new Br(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(o=new Br(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[n]=new kt(this.baseTexture,s,u,o,i.rotated?2:0,i.anchor),kt.addToCache(this.textures[n],n)}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let r=0;r<t[e].length;r++){const n=t[e][r];this.animations[e].push(this.textures[n])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*hd.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*hd.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let D1=hd;D1.BATCH_SIZE=1e3;const fq=["jpg","png","jpeg","avif","webp"];function wM(t,e,r){const n={};if(t.forEach(i=>{n[i]=e}),Object.keys(e.textures).forEach(i=>{n[i]=e.textures[i]}),!r){const i=xi.dirname(t[0]);e.linkedSheets.forEach((a,s)=>{const o=wM([`${i}/${e.data.meta.related_multi_packs[s]}`],a,!0);Object.assign(n,o)})}return n}const hq={extension:Tt.Asset,cache:{test:t=>t instanceof D1,getCacheableAssets:(t,e)=>wM(t,e,!1)},resolver:{test:t=>{const r=t.split("?")[0].split("."),n=r.pop(),i=r.pop();return n==="json"&&fq.includes(i)},parse:t=>{var r;const e=t.split(".");return{resolution:parseFloat(((r=Nt.RETINA_PREFIX.exec(t))==null?void 0:r[1])??"1"),format:e[e.length-2],src:t}}},loader:{extension:{type:Tt.LoadParser,priority:_o.Normal},async testParse(t,e){return xi.extname(e.src).toLowerCase()===".json"&&!!t.frames},async parse(t,e,r){var u,c;let n=xi.dirname(e.src);n&&n.lastIndexOf("/")!==n.length-1&&(n+="/");const i=n+t.meta.image,s=(await r.load([i]))[i],o=new D1(s.baseTexture,t,e.src);await o.parse();const l=(u=t==null?void 0:t.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(l)){const f=[];for(const p of l){if(typeof p!="string")continue;const m=n+p;(c=e.data)!=null&&c.ignoreMultiPack||f.push(r.load({src:m,data:{ignoreMultiPack:!0}}))}const h=await Promise.all(f);o.linkedSheets=h,h.forEach(p=>{p.linkedSheets=[o].concat(o.linkedSheets.filter(m=>m!==p))})}return o},unload(t){t.destroy(!0)}}};Lt.add(hq);class lv{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Lm{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const r=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const a in r){const s=r[a].match(/^[a-z]+/gm)[0],o=r[a].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const u in o){const c=o[u].split("="),f=c[0],h=c[1].replace(/"/gm,""),p=parseFloat(h),m=isNaN(p)?h:p;l[f]=m}n[s].push(l)}const i=new lv;return n.info.forEach(a=>i.info.push({face:a.face,size:parseInt(a.size,10)})),n.common.forEach(a=>i.common.push({lineHeight:parseInt(a.lineHeight,10)})),n.page.forEach(a=>i.page.push({id:parseInt(a.id,10),file:a.file})),n.char.forEach(a=>i.char.push({id:parseInt(a.id,10),page:parseInt(a.page,10),x:parseInt(a.x,10),y:parseInt(a.y,10),width:parseInt(a.width,10),height:parseInt(a.height,10),xoffset:parseInt(a.xoffset,10),yoffset:parseInt(a.yoffset,10),xadvance:parseInt(a.xadvance,10)})),n.kerning.forEach(a=>i.kerning.push({first:parseInt(a.first,10),second:parseInt(a.second,10),amount:parseInt(a.amount,10)})),n.distanceField.forEach(a=>i.distanceField.push({distanceRange:parseInt(a.distanceRange,10),fieldType:a.fieldType})),i}}class C1{static test(e){const r=e;return"getElementsByTagName"in r&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const r=new lv,n=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),a=e.getElementsByTagName("page"),s=e.getElementsByTagName("char"),o=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let u=0;u<n.length;u++)r.info.push({face:n[u].getAttribute("face"),size:parseInt(n[u].getAttribute("size"),10)});for(let u=0;u<i.length;u++)r.common.push({lineHeight:parseInt(i[u].getAttribute("lineHeight"),10)});for(let u=0;u<a.length;u++)r.page.push({id:parseInt(a[u].getAttribute("id"),10)||0,file:a[u].getAttribute("file")});for(let u=0;u<s.length;u++){const c=s[u];r.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(let u=0;u<o.length;u++)r.kerning.push({first:parseInt(o[u].getAttribute("first"),10),second:parseInt(o[u].getAttribute("second"),10),amount:parseInt(o[u].getAttribute("amount"),10)});for(let u=0;u<l.length;u++)r.distanceField.push({fieldType:l[u].getAttribute("fieldType"),distanceRange:parseInt(l[u].getAttribute("distanceRange"),10)});return r}}class T1{static test(e){return typeof e=="string"&&e.includes("<font>")?C1.test(Nt.ADAPTER.parseXML(e)):!1}static parse(e){return C1.parse(Nt.ADAPTER.parseXML(e))}}const ry=[Lm,C1,T1];function dq(t){for(let e=0;e<ry.length;e++)if(ry[e].test(t))return ry[e];return null}function pq(t,e,r,n,i,a){const s=r.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let o;const l=r.dropShadow?r.dropShadowDistance:0,u=r.padding||0,c=t.width/n-l-u*2,f=t.height/n-l-u*2,h=s.slice(),p=r.fillGradientStops.slice();if(!p.length){const m=h.length+1;for(let v=1;v<m;++v)p.push(v/m)}if(h.unshift(s[0]),p.unshift(0),h.push(s[s.length-1]),p.push(1),r.fillGradientType===Zv.LINEAR_VERTICAL){o=e.createLinearGradient(c/2,u,c/2,f+u);let m=0;const y=(a.fontProperties.fontSize+r.strokeThickness)/f;for(let x=0;x<i.length;x++){const S=a.lineHeight*x;for(let b=0;b<h.length;b++){let A=0;typeof p[b]=="number"?A=p[b]:A=b/h.length;const E=S/f+A*y;let _=Math.max(m,E);_=Math.min(_,1),o.addColorStop(_,h[b]),m=_}}}else{o=e.createLinearGradient(u,f/2,c+u,f/2);const m=h.length+1;let v=1;for(let y=0;y<h.length;y++){let x;typeof p[y]=="number"?x=p[y]:x=v/m,o.addColorStop(x,h[y]),v++}}return o}function mq(t,e,r,n,i,a,s){const o=r.text,l=r.fontProperties;e.translate(n,i),e.scale(a,a);const u=s.strokeThickness/2,c=-(s.strokeThickness/2);if(e.font=s.toFontString(),e.lineWidth=s.strokeThickness,e.textBaseline=s.textBaseline,e.lineJoin=s.lineJoin,e.miterLimit=s.miterLimit,e.fillStyle=pq(t,e,s,a,[o],r),e.strokeStyle=s.stroke,s.dropShadow){const f=s.dropShadowColor,h=Sd(typeof f=="number"?f:Db(f)),p=s.dropShadowBlur*a,m=s.dropShadowDistance*a;e.shadowColor=`rgba(${h[0]*255},${h[1]*255},${h[2]*255},${s.dropShadowAlpha})`,e.shadowBlur=p,e.shadowOffsetX=Math.cos(s.dropShadowAngle)*m,e.shadowOffsetY=Math.sin(s.dropShadowAngle)*m}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;s.stroke&&s.strokeThickness&&e.strokeText(o,u,c+r.lineHeight-l.descent),s.fill&&e.fillText(o,u,c+r.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Um(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function _M(t){return Array.from?Array.from(t):t.split("")}function vq(t){typeof t=="string"&&(t=[t]);const e=[];for(let r=0,n=t.length;r<n;r++){const i=t[r];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const a=i[0].charCodeAt(0),s=i[1].charCodeAt(0);if(s<a)throw new Error("[BitmapFont]: Invalid character range.");for(let o=a,l=s;o<=l;o++)e.push(String.fromCharCode(o))}else e.push(..._M(i))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const Ms=class{constructor(t,e,r){var u;const[n]=t.info,[i]=t.common,[a]=t.page,[s]=t.distanceField,o=ol(a.file),l={};this._ownsTextures=r,this.font=n.face,this.size=n.size,this.lineHeight=i.lineHeight/o,this.chars={},this.pageTextures=l;for(let c=0;c<t.page.length;c++){const{id:f,file:h}=t.page[c];l[f]=e instanceof Array?e[c]:e[h],s!=null&&s.fieldType&&s.fieldType!=="none"&&(l[f].baseTexture.alphaMode=Us.NO_PREMULTIPLIED_ALPHA,l[f].baseTexture.mipmap=xo.OFF)}for(let c=0;c<t.char.length;c++){const{id:f,page:h}=t.char[c];let{x:p,y:m,width:v,height:y,xoffset:x,yoffset:S,xadvance:b}=t.char[c];p/=o,m/=o,v/=o,y/=o,x/=o,S/=o,b/=o;const A=new Br(p+l[h].frame.x/o,m+l[h].frame.y/o,v,y);this.chars[f]={xOffset:x,yOffset:S,xAdvance:b,kerning:{},texture:new kt(l[h].baseTexture,A),page:h}}for(let c=0;c<t.kerning.length;c++){let{first:f,second:h,amount:p}=t.kerning[c];f/=o,h/=o,p/=o,this.chars[h]&&(this.chars[h].kerning[f]=p)}this.distanceFieldRange=s==null?void 0:s.distanceRange,this.distanceFieldType=((u=s==null?void 0:s.fieldType)==null?void 0:u.toLowerCase())??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,r){let n;if(t instanceof lv)n=t;else{const a=dq(t);if(!a)throw new Error("Unrecognized data format for font.");n=a.parse(t)}e instanceof kt&&(e=[e]);const i=new Ms(n,e,r);return Ms.available[i.font]=i,i}static uninstall(t){const e=Ms.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete Ms.available[t]}static from(t,e,r){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:n,padding:i,resolution:a,textureWidth:s,textureHeight:o,...l}=Object.assign({},Ms.defaultOptions,r),u=vq(n),c=e instanceof bc?e:new bc(e),f=s,h=new lv;h.info[0]={face:c.fontFamily,size:c.fontSize},h.common[0]={lineHeight:c.fontSize};let p=0,m=0,v,y,x,S=0;const b=[];for(let E=0;E<u.length;E++){v||(v=Nt.ADAPTER.createCanvas(),v.width=s,v.height=o,y=v.getContext("2d"),x=new pr(v,{resolution:a,...l}),b.push(new kt(x)),h.page.push({id:b.length-1,file:""}));const _=u[E],T=mi.measureText(_,c,!1,v),M=T.width,N=Math.ceil(T.height),I=Math.ceil((c.fontStyle==="italic"?2:1)*M);if(m>=o-N*a){if(m===0)throw new Error(`[BitmapFont] textureHeight ${o}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${_}')`);--E,v=null,y=null,x=null,m=0,p=0,S=0;continue}if(S=Math.max(N+T.fontProperties.descent,S),I*a+p>=f){if(p===0)throw new Error(`[BitmapFont] textureWidth ${s}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${_}')`);--E,m+=S*a,m=Math.ceil(m),p=0,S=0;continue}mq(v,y,T,p,m,a,c);const F=Um(T.text);h.char.push({id:F,page:b.length-1,x:p/a,y:m/a,width:I,height:N,xoffset:0,yoffset:0,xadvance:Math.ceil(M-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0))}),p+=(I+2*i)*a,p=Math.ceil(p)}for(let E=0,_=u.length;E<_;E++){const T=u[E];for(let M=0;M<_;M++){const N=u[M],I=y.measureText(T).width,F=y.measureText(N).width,U=y.measureText(T+N).width-(I+F);U&&h.kerning.push({first:Um(T),second:Um(N),amount:U})}}const A=new Ms(h,b,!0);return Ms.available[t]!==void 0&&Ms.uninstall(t),Ms.available[t]=A,A}};let fa=Ms;fa.ALPHA=[["a","z"],["A","Z"]," "];fa.NUMERIC=[["0","9"]];fa.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];fa.ASCII=[[" ","~"]];fa.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Ms.ALPHANUMERIC};fa.available={};var gq=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`,yq=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const fE=[],hE=[],dE=[],AM=class extends Ca{constructor(t,e={}){super(),this._tint=16777215;const{align:r,tint:n,maxWidth:i,letterSpacing:a,fontName:s,fontSize:o}=Object.assign({},AM.styleDefaults,e);if(!fa.available[s])throw new Error(`Missing BitmapFont "${s}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tint=n,this._font=void 0,this._fontName=s,this._fontSize=o,this.text=t,this._maxWidth=i,this._maxLineHeight=0,this._letterSpacing=a,this._anchor=new tl(()=>{this.dirty=!0},this,0,0),this._roundPixels=Nt.ROUND_PIXELS,this.dirty=!0,this._resolution=Nt.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var I;const t=fa.available[this._fontName],e=this.fontSize,r=e/t.size,n=new zr,i=[],a=[],s=[],o=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",l=_M(o),u=this._maxWidth*t.size/e,c=t.distanceFieldType==="none"?fE:hE;let f=null,h=0,p=0,m=0,v=-1,y=0,x=0,S=0,b=0;for(let F=0;F<l.length;F++){const P=l[F],U=Um(P);if(/(?:\s)/.test(P)&&(v=F,y=h,b++),P==="\r"||P===`
`){a.push(h),s.push(-1),p=Math.max(p,h),++m,++x,n.x=0,n.y+=t.lineHeight,f=null,b=0;continue}const G=t.chars[U];if(!G)continue;f&&G.kerning[f]&&(n.x+=G.kerning[f]);const V=dE.pop()||{texture:kt.EMPTY,line:0,charCode:0,prevSpaces:0,position:new zr};V.texture=G.texture,V.line=m,V.charCode=U,V.position.x=n.x+G.xOffset+this._letterSpacing/2,V.position.y=n.y+G.yOffset,V.prevSpaces=b,i.push(V),h=V.position.x+Math.max(G.xAdvance-G.xOffset,G.texture.orig.width),n.x+=G.xAdvance+this._letterSpacing,S=Math.max(S,G.yOffset+G.texture.height),f=U,v!==-1&&u>0&&n.x>u&&(++x,Lf(i,1+v-x,1+F-v),F=v,v=-1,a.push(y),s.push(i.length>0?i[i.length-1].prevSpaces:0),p=Math.max(p,y),m++,n.x=0,n.y+=t.lineHeight,f=null,b=0)}const A=l[l.length-1];A!=="\r"&&A!==`
`&&(/(?:\s)/.test(A)&&(h=y),a.push(h),p=Math.max(p,h),s.push(-1));const E=[];for(let F=0;F<=m;F++){let P=0;this._align==="right"?P=p-a[F]:this._align==="center"?P=(p-a[F])/2:this._align==="justify"&&(P=s[F]<0?0:(p-a[F])/s[F]),E.push(P)}const _=i.length,T={},M=[],N=this._activePagesMeshData;c.push(...N);for(let F=0;F<_;F++){const P=i[F].texture,U=P.baseTexture.uid;if(!T[U]){let G=c.pop();if(!G){const $=new qG;let j,k;t.distanceFieldType==="none"?(j=new oE(kt.EMPTY),k=Zt.NORMAL):(j=new oE(kt.EMPTY,{program:Rs.from(yq,gq),uniforms:{uFWidth:0}}),k=Zt.NORMAL_NPM);const Z=new E1($,j);Z.blendMode=k,G={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Z,vertices:null,uvs:null,indices:null}}G.index=0,G.indexCount=0,G.vertexCount=0,G.uvsCount=0,G.total=0;const{_textureCache:V}=this;V[U]=V[U]||new kt(P.baseTexture),G.mesh.texture=V[U],G.mesh.tint=this._tint,M.push(G),T[U]=G}T[U].total++}for(let F=0;F<N.length;F++)M.includes(N[F])||this.removeChild(N[F].mesh);for(let F=0;F<M.length;F++)M[F].mesh.parent!==this&&this.addChild(M[F].mesh);this._activePagesMeshData=M;for(const F in T){const P=T[F],U=P.total;if(!(((I=P.indices)==null?void 0:I.length)>6*U)||P.vertices.length<E1.BATCHABLE_SIZE*2)P.vertices=new Float32Array(4*2*U),P.uvs=new Float32Array(4*2*U),P.indices=new Uint16Array(6*U);else{const G=P.total,V=P.vertices;for(let $=G*4*2;$<V.length;$++)V[$]=0}P.mesh.size=6*U}for(let F=0;F<_;F++){const P=i[F];let U=P.position.x+E[P.line]*(this._align==="justify"?P.prevSpaces:1);this._roundPixels&&(U=Math.round(U));const G=U*r,V=P.position.y*r,$=P.texture,j=T[$.baseTexture.uid],k=$.frame,Z=$._uvs,z=j.index++;j.indices[z*6+0]=0+z*4,j.indices[z*6+1]=1+z*4,j.indices[z*6+2]=2+z*4,j.indices[z*6+3]=0+z*4,j.indices[z*6+4]=2+z*4,j.indices[z*6+5]=3+z*4,j.vertices[z*8+0]=G,j.vertices[z*8+1]=V,j.vertices[z*8+2]=G+k.width*r,j.vertices[z*8+3]=V,j.vertices[z*8+4]=G+k.width*r,j.vertices[z*8+5]=V+k.height*r,j.vertices[z*8+6]=G,j.vertices[z*8+7]=V+k.height*r,j.uvs[z*8+0]=Z.x0,j.uvs[z*8+1]=Z.y0,j.uvs[z*8+2]=Z.x1,j.uvs[z*8+3]=Z.y1,j.uvs[z*8+4]=Z.x2,j.uvs[z*8+5]=Z.y2,j.uvs[z*8+6]=Z.x3,j.uvs[z*8+7]=Z.y3}this._textWidth=p*r,this._textHeight=(n.y+t.lineHeight)*r;for(const F in T){const P=T[F];if(this.anchor.x!==0||this.anchor.y!==0){let $=0;const j=this._textWidth*this.anchor.x,k=this._textHeight*this.anchor.y;for(let Z=0;Z<P.total;Z++)P.vertices[$++]-=j,P.vertices[$++]-=k,P.vertices[$++]-=j,P.vertices[$++]-=k,P.vertices[$++]-=j,P.vertices[$++]-=k,P.vertices[$++]-=j,P.vertices[$++]-=k}this._maxLineHeight=S*r;const U=P.mesh.geometry.getBuffer("aVertexPosition"),G=P.mesh.geometry.getBuffer("aTextureCoord"),V=P.mesh.geometry.getIndex();U.data=P.vertices,G.data=P.uvs,V.data=P.indices,U.update(),G.update(),V.update()}for(let F=0;F<i.length;F++)dE.push(i[F]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:r,size:n}=fa.available[this._fontName];if(r!=="none"){const{a:i,b:a,c:s,d:o}=this.worldTransform,l=Math.sqrt(i*i+a*a),u=Math.sqrt(s*s+o*o),c=(Math.abs(l)+Math.abs(u))/2,f=this.fontSize/n,h=t._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=c*e*f*h}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=fa.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tint}set tint(t){if(this._tint!==t){this._tint=t;for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!fa.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??fa.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,n=fa.available[this._fontName].distanceFieldType==="none"?fE:hE;n.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],n.filter(i=>e[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=kt.EMPTY});for(const i in e)e[i].destroy(),delete e[i];this._font=null,this._textureCache=null,super.destroy(t)}};let bq=AM;bq.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const xq=[".xml",".fnt"],wq={extension:{type:Tt.LoadParser,priority:_o.Normal},test(t){return xq.includes(xi.extname(t).toLowerCase())},async testParse(t){return Lm.test(t)||T1.test(t)},async parse(t,e,r){const n=Lm.test(t)?Lm.parse(t):T1.parse(t),{src:i}=e,{page:a}=n,s=[];for(let u=0;u<a.length;++u){const c=a[u].file,f=xi.join(xi.dirname(i),c);s.push(f)}const o=await r.load(s),l=s.map(u=>o[u]);return fa.install(n,l,!0)},async load(t,e){return(await Nt.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};Lt.add(wq);const _q={A:"menlo-bold-0.png",B:"menlo-bold-1.png",C:"menlo-bold-2.png",D:"menlo-bold-3.png",E:"menlo-bold-4.png",F:"menlo-bold-5.png",G:"menlo-bold-6.png",H:"menlo-bold-7.png",I:"menlo-bold-8.png",J:"menlo-bold-9.png",K:"menlo-bold-10.png",L:"menlo-bold-11.png",M:"menlo-bold-12.png",N:"menlo-bold-13.png",O:"menlo-bold-14.png",P:"menlo-bold-15.png",Q:"menlo-bold-16.png",R:"menlo-bold-17.png",S:"menlo-bold-18.png",T:"menlo-bold-19.png",U:"menlo-bold-20.png",V:"menlo-bold-21.png",W:"menlo-bold-22.png",X:"menlo-bold-23.png",Y:"menlo-bold-24.png",Z:"menlo-bold-25.png",a:"menlo-bold-26.png",b:"menlo-bold-27.png",c:"menlo-bold-28.png",d:"menlo-bold-29.png",e:"menlo-bold-30.png",f:"menlo-bold-31.png",g:"menlo-bold-32.png",h:"menlo-bold-33.png",i:"menlo-bold-34.png",j:"menlo-bold-35.png",k:"menlo-bold-36.png",l:"menlo-bold-37.png",m:"menlo-bold-38.png",n:"menlo-bold-39.png",o:"menlo-bold-40.png",p:"menlo-bold-41.png",q:"menlo-bold-42.png",r:"menlo-bold-43.png",s:"menlo-bold-44.png",t:"menlo-bold-45.png",u:"menlo-bold-46.png",v:"menlo-bold-47.png",w:"menlo-bold-48.png",x:"menlo-bold-49.png",y:"menlo-bold-50.png",z:"menlo-bold-51.png",0:"menlo-bold-52.png",1:"menlo-bold-53.png",2:"menlo-bold-54.png",3:"menlo-bold-55.png",4:"menlo-bold-56.png",5:"menlo-bold-57.png",6:"menlo-bold-58.png",7:"menlo-bold-59.png",8:"menlo-bold-60.png",9:"menlo-bold-61.png","!":"menlo-bold-62.png","@":"menlo-bold-63.png","#":"menlo-bold-64.png",$:"menlo-bold-65.png","%":"menlo-bold-66.png","^":"menlo-bold-67.png","&":"menlo-bold-68.png","*":"menlo-bold-69.png","(":"menlo-bold-70.png",")":"menlo-bold-71.png","-":"menlo-bold-72.png",_:"menlo-bold-73.png","=":"menlo-bold-74.png","+":"menlo-bold-75.png",",":"menlo-bold-76.png",".":"menlo-bold-77.png","<":"menlo-bold-78.png",">":"menlo-bold-79.png","/":"menlo-bold-80.png","?":"menlo-bold-81.png",";":"menlo-bold-82.png",":":"menlo-bold-83.png",'"':"menlo-bold-84.png","'":"menlo-bold-85.png","[":"menlo-bold-86.png","]":"menlo-bold-87.png","{":"menlo-bold-88.png","}":"menlo-bold-89.png","\\":"menlo-bold-90.png","|":"menlo-bold-91.png","`":"menlo-bold-92.png","~":"menlo-bold-93.png","•":"menlo-bold-94.png"},Aq={A:"menlo-bold-half-0.png",B:"menlo-bold-half-1.png",C:"menlo-bold-half-2.png",D:"menlo-bold-half-3.png",E:"menlo-bold-half-4.png",F:"menlo-bold-half-5.png",G:"menlo-bold-half-6.png",H:"menlo-bold-half-7.png",I:"menlo-bold-half-8.png",J:"menlo-bold-half-9.png",K:"menlo-bold-half-10.png",L:"menlo-bold-half-11.png",M:"menlo-bold-half-12.png",N:"menlo-bold-half-13.png",O:"menlo-bold-half-14.png",P:"menlo-bold-half-15.png",Q:"menlo-bold-half-16.png",R:"menlo-bold-half-17.png",S:"menlo-bold-half-18.png",T:"menlo-bold-half-19.png",U:"menlo-bold-half-20.png",V:"menlo-bold-half-21.png",W:"menlo-bold-half-22.png",X:"menlo-bold-half-23.png",Y:"menlo-bold-half-24.png",Z:"menlo-bold-half-25.png",a:"menlo-bold-half-26.png",b:"menlo-bold-half-27.png",c:"menlo-bold-half-28.png",d:"menlo-bold-half-29.png",e:"menlo-bold-half-30.png",f:"menlo-bold-half-31.png",g:"menlo-bold-half-32.png",h:"menlo-bold-half-33.png",i:"menlo-bold-half-34.png",j:"menlo-bold-half-35.png",k:"menlo-bold-half-36.png",l:"menlo-bold-half-37.png",m:"menlo-bold-half-38.png",n:"menlo-bold-half-39.png",o:"menlo-bold-half-40.png",p:"menlo-bold-half-41.png",q:"menlo-bold-half-42.png",r:"menlo-bold-half-43.png",s:"menlo-bold-half-44.png",t:"menlo-bold-half-45.png",u:"menlo-bold-half-46.png",v:"menlo-bold-half-47.png",w:"menlo-bold-half-48.png",x:"menlo-bold-half-49.png",y:"menlo-bold-half-50.png",z:"menlo-bold-half-51.png",0:"menlo-bold-half-52.png",1:"menlo-bold-half-53.png",2:"menlo-bold-half-54.png",3:"menlo-bold-half-55.png",4:"menlo-bold-half-56.png",5:"menlo-bold-half-57.png",6:"menlo-bold-half-58.png",7:"menlo-bold-half-59.png",8:"menlo-bold-half-60.png",9:"menlo-bold-half-61.png","!":"menlo-bold-half-62.png","@":"menlo-bold-half-63.png","#":"menlo-bold-half-64.png",$:"menlo-bold-half-65.png","%":"menlo-bold-half-66.png","^":"menlo-bold-half-67.png","&":"menlo-bold-half-68.png","*":"menlo-bold-half-69.png","(":"menlo-bold-half-70.png",")":"menlo-bold-half-71.png","-":"menlo-bold-half-72.png",_:"menlo-bold-half-73.png","=":"menlo-bold-half-74.png","+":"menlo-bold-half-75.png",",":"menlo-bold-half-76.png",".":"menlo-bold-half-77.png","<":"menlo-bold-half-78.png",">":"menlo-bold-half-79.png","/":"menlo-bold-half-80.png","?":"menlo-bold-half-81.png",";":"menlo-bold-half-82.png",":":"menlo-bold-half-83.png",'"':"menlo-bold-half-84.png","'":"menlo-bold-half-85.png","[":"menlo-bold-half-86.png","]":"menlo-bold-half-87.png","{":"menlo-bold-half-88.png","}":"menlo-bold-half-89.png","\\":"menlo-bold-half-90.png","|":"menlo-bold-half-91.png","`":"menlo-bold-half-92.png","~":"menlo-bold-half-93.png","•":"menlo-bold-half-94.png"},Eq={armor:80,club:129,corpse:734,dagger:329,default:866,doorClosed:551,doorOpen:550,fire:504,floor:1,golem:321,grass:4,tallGrass:97,owlbear:421,player:75,potion:580,rat:422,rock:565,shortsword:327,skeleton:322,stairsDown:296,stairsUp:295,wall:842,weapon:425};let EM;const SM={width:100,height:46},Qu=window.innerWidth/SM.width,Sq=(t,e)=>{const r=Math.trunc(t/Qu),n=Math.trunc(e/Qu);return`${r},${n}`},iu={};async function Dq(t){EM=new Ob({view:t,width:window.innerWidth,height:Qu*SM.height,autoDensity:!0,resolution:window.devicePixelRatio||1}),await Cq()}const Cq=async()=>(iu.ascii=await rl.load("/forcecrusher/fonts/menlo-bold.json"),iu.text=await rl.load("/forcecrusher/fonts/menlo-bold-half.json"),iu.tile=await rl.load("/forcecrusher/tile.png"),iu.kenny=await rl.load("/forcecrusher/gfx/kenny-transparent.json"),iu),Tq=t=>iu.ascii.textures[_q[t]],Nq=t=>iu.text.textures[Aq[t]],Mq=()=>iu.tile,Iq=t=>{const r=`monochrome-transparent_packed-${[Eq[t]]}.png`;return iu.kenny.textures[r]},pE={red:16711680,green:65280,purple:6975409,blue:255,yellow:16776960,cyan:65535,magenta:16711935,white:16777215,black:0,gray:8947848},Fq=(t,e=16777215)=>{const r=[],n=[];let i=e;const a=/§(#[0-9a-fA-F]{6}|[a-zA-Z]+|reset)§/g;let s=0,o;for(;o=a.exec(t);){const l=o.index,u=o[1];for(let c=s;c<l;c++)r.push(t[c]),n.push(i);u==="reset"?i=e:u.startsWith("#")?i=parseInt(u.slice(1),16):pE[u.toLowerCase()]&&(i=pE[u.toLowerCase()]),s=a.lastIndex}for(let l=s;l<t.length;l++)r.push(t[l]),n.push(i);return{chars:r,tints:n}};class Oq{constructor(e){_r(this,"x",0);_r(this,"y",0);_r(this,"halfWidth",!1);_r(this,"width");_r(this,"height");_r(this,"layers",[]);_r(this,"sprites",[]);_r(this,"tileSets",[]);_r(this,"tints",[]);_r(this,"alphas",[]);_r(this,"visible",!0);_r(this,"name");_r(this,"_getTexture",e=>{const{tileSet:r,char:n}=e;return r==="ascii"?Tq(n):r==="text"?Nq(n):r==="kenny"?Iq(n):Mq()});_r(this,"_createSprite",e=>{const{char:r,width:n,height:i,layer:a,x:s,y:o,tileSet:l,tint:u=16777215,alpha:c=1}=e,f=this._getTexture({tileSet:l,char:r});let h=new bh(f);h.width=this.halfWidth?n/2:n,h.height=i,h.x=this.halfWidth?s*(n/2):s*n,h.y=o*i,h.tint=u,h.alpha=c,this.sprites[a][o][s]=h,this.layers[a].addChild(h)});_r(this,"updateCell",e=>(Object.keys(e).forEach(r=>{const{char:n,tint:i,alpha:a,tileSet:s,x:o,y:l}=e[r];this.updateSprite({char:n,tint:i,alpha:a,tileSet:s,x:o,y:l,layer:parseInt(r)})}),this));_r(this,"updateSprite",async e=>{const{char:r="",layer:n,x:i,y:a,tileSet:s="text",tint:o,alpha:l}=e;if(a>=this.height||i>=this.width)return this;if(!this.sprites[n]||!this.sprites[n][a]||!this.sprites[n][a][i])return;const u=this.sprites[n][a][i];if(u)return u.texture=this._getTexture({tileSet:s,char:r}),o&&(u.tint=o),typeof l<"u"&&(u.alpha=l),this});_r(this,"updateRows",(e,r=!1)=>(e.forEach((n,i)=>{n.forEach((a,s)=>{this.clearRow(s,i),this.updateRow({...a,layer:s,y:i,parseTags:r})})}),this));_r(this,"updateRowBg",e=>{const{string:r="",layer:n=0,x:i,y:a,tileSet:s,tint:o,alpha:l}=e;return[...r].forEach((c,f)=>this.updateSprite({char:c,layer:n||0,x:i||0+f,y:a||0,tileSet:s||this.tileSets[n],tint:o||this.tints[n],alpha:l||this.alphas[n]})),(s||this.tileSets[n])==="tile"&&Wu.times(this.width,c=>{this.updateSprite({layer:n,x:i||0+c,y:a||0,tileSet:s||this.tileSets[n],tint:o||this.tints[n],alpha:l||this.alphas[n]})}),this});_r(this,"updateRow",e=>{const{string:r="",layer:n=0,x:i=0,y:a=0,tileSet:s,tint:o,alpha:l,colors:u,alphas:c,parseTags:f=!1}=e,h=s||this.tileSets[n];let p=[],m=[];if(f){const v=Fq(r,o??this.tints[n]);p=v.chars,m=v.tints}else p=[...r],m=u??p.map(()=>o??this.tints[n]);return p.forEach((v,y)=>{this.updateSprite({char:v,layer:n,x:i+y,y:a,tileSet:h,tint:m[y],alpha:(c==null?void 0:c[y])??l??this.alphas[n]})}),this});_r(this,"clearRow",(e,r)=>{const n=new Array(this.width+1).join(" ");this.updateRow({string:n,layer:e,y:r});const i=this.tileSets[e],a=["map","odorMap","visionMap"];i==="tile"?this.updateRow({string:n,layer:e,y:r,tileSet:i,tint:0,alpha:a.includes(this.name)?0:1}):this.updateRow({string:n,layer:e,y:r,tileSet:i})});_r(this,"clearView",()=>{let e=0;this.layers.forEach(()=>{Wu.times(this.height,r=>{this.clearRow(e,r)}),e+=1})});_r(this,"show",()=>{this.visible=!0,this.layers.forEach(e=>e.visible=this.visible)});_r(this,"hide",()=>{this.visible=!1,this.layers.forEach(e=>e.visible=this.visible)});return this.width=e.width,this.height=e.height,this.tileSets=e.tileSets,this.tints=e.tints,this.alphas=e.alphas,this.halfWidth=this.tileSets.includes("text"),this.visible=e.visible,this.name=e.name,Wu.times(e.layers,()=>this.layers.push(new Ca)),this.layers.forEach(r=>{const n=this.halfWidth?e.x*(Qu/2):e.x*Qu,i=e.y*Qu;r.x=n,r.y=i,r.interactiveChildren=!1,r.visible=this.visible,EM.stage.addChild(r)}),Wu.times(e.layers,()=>this.sprites.push(Array.from(Array(this.height),()=>Array.from(Array(this.width))))),Wu.times(e.layers,r=>{Wu.times(this.height,n=>{Wu.times(this.width,async i=>{this._createSprite({char:"",width:Qu,height:Qu,layer:r,x:i,y:n,tileSet:e.tileSets[r],tint:e.tints[r],alpha:e.alphas[r]})})})}),this}}const Ir=t=>`${t.x},${t.y}`,fl=t=>{const e=t.split(",").map(r=>parseInt(r,10));return{x:e[0],y:e[1]}},mE=t=>`${t.x},${t.y},${t.z}`,vE=t=>{const e=t.split(",").map(r=>parseInt(r,10));return{x:e[0],y:e[1],z:e[2]}},Bq=(t,e,r)=>{const n=t.x-r.x,i=t.y-r.y;return n*n+i*i<=e*e},Rq=(t,e)=>{const r=e*2+1,n=t.y-e,i=t.y+e,a=t.x-e,s=t.x+e,o=[];for(let l=n;l<=i;l++)for(let u=a;u<=s;u++){const c=Math.ceil(u),f=Math.ceil(l),h={x:c,y:f};Bq(t,e,h)&&o.push(Ir(h))}return{posIds:o,center:Ir(t),diameter:r,top:n,bottom:i,left:a,right:s}},gE=(t,e,r)=>t+r*(e-t),Pq=(t,e,r)=>{const n=gE(t.x,e.x,r),i=gE(t.y,e.y,r);return{x:n,y:i}},$q=(t,e)=>{const r=e.x-t.x,n=e.y-t.y;return Math.max(Math.abs(r),Math.abs(n))},kq=t=>{const e=Math.round(t.x),r=Math.round(t.y);return{x:e,y:r}},Mf=(t,e)=>{let r=[],n=$q(t,e);for(let i=0;i<=n;i++){let a=n===0?0:i/n;r.push(kq(Pq(t,e,a)))}return r},yE=(t,e)=>{const{x:r,y:n,width:i,height:a,hasWalls:s}=t,o={},l=r,u=r+i,c=n,f=n+a;if(s)for(let p=c+1;p<f-1;p++)for(let m=l+1;m<u-1;m++)o[`${m},${p}`]={x:m,y:p,...e};else for(let p=c;p<f;p++)for(let m=l;m<u;m++)o[`${m},${p}`]={x:m,y:p,...e};const h={x:Math.round((l+u)/2),y:Math.round((c+f)/2)};return{x1:l,x2:u,y1:c,y2:f,center:h,hasWalls:s,tiles:o,width:i,height:a}},Lq=(t,e)=>t.x1<=e.x2&&t.x2>=e.x1&&t.y1<=e.y2&&t.y2>=e.y1,Uq=(t,e)=>{const r=Math.pow(e.x-t.x,2),n=Math.pow(e.y-t.y,2);return Math.floor(Math.sqrt(r+n))},Qf=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}],N1=[{x:1,y:-1},{x:1,y:1},{x:-1,y:1},{x:-1,y:-1}];[...Qf,...N1];const Jf=(t,e,r,n)=>{let i=[];e==="cardinal"&&(i=[...Qf]),e==="diagonal"&&(i=[...N1]),e==="all"&&(i=[...Qf,...N1]);const a=[];for(let s of i){let o={x:t.x+s.x,y:t.y+s.y};o.x>=0&&o.x<r.width&&o.y>=0&&o.y<r.height&&a.push(o)}return n?a.map(Ir):a},au=(t,e)=>t.x===e.x&&t.y===e.y,zq=t=>{const e=Wu.sample(Qf),r=t.x+e.x,n=t.y+e.y;return{x:r,y:n}},DM=(t,e)=>{const{x:r,y:n}=t,{x:i,y:a}=e;let s="";return r-i===-1&&n-a===-1&&(s="NW"),r-i===1&&n-a===-1&&(s="NE"),r-i===1&&n-a===1&&(s="SE"),r-i===-1&&n-a===1&&(s="SW"),r-i===1&&n-a===0&&(s="E"),r-i===0&&n-a===-1&&(s="N"),r-i===-1&&n-a===0&&(s="W"),r-i===0&&n-a===1&&(s="S"),r-i===0&&n-a===0&&(s="X"),{dir:s,x:r-i,y:n-a}};function Gq(t,e,r){return{x:t.x+e.x*r,y:t.y+e.y*r}}var CM={exports:{}},kb={};Object.defineProperty(kb,"__esModule",{value:!0});function M1(t,e){e=t.length;for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qq(t){if(Array.isArray(t))return M1(t)}function Hq(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function TM(t,e){if(t){if(typeof t=="string")return M1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M1(t,e)}}function Wq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vq(t){return qq(t)||Hq(t)||TM(t)||Wq()}function Xq(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=TM(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,o;return{s:function(){r=r.call(t)},n:function(){var l=r.next();return a=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function jq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yq(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function NM(t){var e=Yq(t,"string");return typeof e=="symbol"?e:String(e)}function Kq(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,NM(n.key),n)}}function Zq(t,e,r){return e&&Kq(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qq(t,e,r){return e=NM(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Jq=function(){function t(){jq(this,t),Qq(this,"subscribers",new Set)}return Zq(t,[{key:"onSubscribe",get:function(){return this._onSubscribe||(this._onSubscribe=new t),this._onSubscribe}},{key:"onUnsubscribe",get:function(){return this._onUnsubscribe||(this._onUnsubscribe=new t),this._onUnsubscribe}},{key:"subscribe",value:function(r){var n,i=this;return this.subscribers.add(r),(n=this._onSubscribe)===null||n===void 0||n.emit(r),function(){return i.unsubscribe(r)}}},{key:"unsubscribe",value:function(r){var n;this.subscribers.delete(r),(n=this._onUnsubscribe)===null||n===void 0||n.emit(r)}},{key:"clear",value:function(){if(this._onUnsubscribe){var r=Xq(this.subscribers),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;this._onUnsubscribe.emit(i)}}catch(a){r.e(a)}finally{r.f()}}this.subscribers.clear()}},{key:"emit",value:function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.subscribers.forEach(function(a){return a.apply(void 0,n)})}},{key:"emitAsync",value:function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Promise.all(Vq(this.subscribers).map(function(a){return a.apply(void 0,n)}))}}]),t}();kb.Event=Jq;CM.exports=kb;var bE=CM.exports;function xE(t,e){e=t.length;for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function eH(t,e){if(t){if(typeof t=="string")return xE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xE(t,e)}}function tH(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=eH(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,o;return{s:function(){r=r.call(t)},n:function(){var l=r.next();return a=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function rH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nH(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function MM(t){var e=nH(t,"string");return typeof e=="symbol"?e:String(e)}function iH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,MM(n.key),n)}}function aH(t,e,r){return e&&iH(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function em(t,e,r){return e=MM(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var IM;IM=Symbol.iterator;var FM=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];rH(this,t),em(this,"_version",0),em(this,"onEntityAdded",new bE.Event),em(this,"onEntityRemoved",new bE.Event),em(this,"entityPositions",new Map),this._entities=e,this.add=this.add.bind(this),this.remove=this.remove.bind(this);for(var r=0;r<e.length;r++)this.entityPositions.set(e[r],r)}return aH(t,[{key:"version",get:function(){return this._version}},{key:"entities",get:function(){return this._entities}},{key:IM,value:function(){var r=this,n=this._entities.length,i={value:void 0,done:!1};return{next:function(){return i.value=r._entities[--n],i.done=n<0,i}}}},{key:"size",get:function(){return this.entities.length}},{key:"first",get:function(){return this.entities[0]}},{key:"has",value:function(r){return this.entityPositions.has(r)}},{key:"add",value:function(r){return r&&!this.has(r)&&(this.entities.push(r),this.entityPositions.set(r,this.entities.length-1),this._version++,this.onEntityAdded.emit(r)),r}},{key:"remove",value:function(r){if(this.has(r)){this.onEntityRemoved.emit(r);var n=this.entityPositions.get(r);this.entityPositions.delete(r);var i=this.entities[this.entities.length-1];i!==r&&(this.entities[n]=i,this.entityPositions.set(i,n)),this.entities.pop(),this._version++}return r}},{key:"clear",value:function(){var r=tH(this),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;this.remove(i)}}catch(a){r.e(a)}finally{r.f()}}}]),t}(),wE=new WeakMap,_E=0,sH=function(e){var r=wE.get(e);return r!==void 0?r:(wE.set(e,_E),_E++)};function oH(){var t=new Array;function e(i){t.push(i)}function r(){t.length=0}function n(){t.forEach(function(i){return i()}),r()}return e.clear=r,e.flush=n,e}function I1(t,e){e=t.length;for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function uH(t){if(Array.isArray(t))return I1(t)}function lH(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function OM(t,e){if(t){if(typeof t=="string")return I1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I1(t,e)}}function cH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yd(t){return uH(t)||lH(t)||OM(t)||cH()}function xc(t){return xc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xc(t)}function fH(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=xc(t),t!==null););return t}function bd(){return typeof Reflect<"u"&&Reflect.get?bd=Reflect.get.bind():bd=function(e,r,n){var i=fH(e,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?e:n):a.value}},bd.apply(this,arguments)}function F1(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=OM(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,o;return{s:function(){r=r.call(t)},n:function(){var l=r.next();return a=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function hH(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function BM(t){var e=hH(t,"string");return typeof e=="symbol"?e:String(e)}function If(t,e,r){return e=BM(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AE(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ac(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?AE(Object(r),!0).forEach(function(n){If(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):AE(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function RM(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,BM(n.key),n)}}function PM(t,e,r){return e&&dH(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ff(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O1(t,e){return O1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},O1(t,e)}function $M(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O1(t,e)}function pH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mH(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ff(t)}function kM(t){var e=pH();return function(){var n=xc(t),i;if(e){var a=xc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return mH(this,i)}}var LM,vH=function(t){$M(r,t);var e=kM(r);function r(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return RM(this,r),n=e.call(this,i),If(Ff(n),"queries",new Set),If(Ff(n),"entityToId",new Map),If(Ff(n),"idToEntity",new Map),If(Ff(n),"nextId",0),n.onEntityAdded.subscribe(function(a){n.reindex(a)}),n.onEntityRemoved.subscribe(function(a){if(n.queries.forEach(function(o){return o.remove(a)}),n.entityToId.has(a)){var s=n.entityToId.get(a);n.idToEntity.delete(s),n.entityToId.delete(a)}}),n}return PM(r,[{key:"update",value:function(n){function i(a,s,o){return n.apply(this,arguments)}return i.toString=function(){return n.toString()},i}(function(n,i,a){if(typeof i=="function"){var s=i(n);s&&Object.assign(n,s)}else typeof i=="string"?n[i]=a:i&&Object.assign(n,i);return this.reindex(n),n})},{key:"addComponent",value:function(i,a,s){i[a]===void 0&&(i[a]=s,this.reindex(i))}},{key:"removeComponent",value:function(i,a){if(i[a]!==void 0){if(this.has(i)){var s=ac({},i);delete s[a],this.reindex(i,s)}delete i[a]}}},{key:"query",value:function(i){var a=bH(i),s=UM(a),o=F1(this.queries),l;try{for(o.s();!(l=o.n()).done;){var u=l.value;if(u.key===s)return u}}catch(f){o.e(f)}finally{o.f()}var c=new gH(this,a);return this.queries.add(c),c}},{key:"with",value:function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return this.query({with:a,without:[],predicates:[]})}},{key:"without",value:function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return this.query({with:[],without:a,predicates:[]})}},{key:"where",value:function(i){return this.query({with:[],without:[],predicates:[i]})}},{key:"reindex",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(this.has(i)){var s=F1(this.queries),o;try{for(s.s();!(o=s.n()).done;){var l=o.value;l.evaluate(i,a)}}catch(u){s.e(u)}finally{s.f()}}}},{key:"id",value:function(i){if(this.has(i)){if(!this.entityToId.has(i)){var a=this.nextId++;this.entityToId.set(i,a),this.idToEntity.set(a,i)}return this.entityToId.get(i)}}},{key:"entity",value:function(i){return this.idToEntity.get(i)}}]),r}(FM);LM=Symbol.iterator;var gH=function(t){$M(r,t);var e=kM(r);function r(n,i){var a;return RM(this,r),a=e.call(this),If(Ff(a),"_isConnected",!1),a.world=n,a.config=i,a.key=UM(i),a.onEntityAdded.onSubscribe.subscribe(function(){return a.connect()}),a.onEntityRemoved.onSubscribe.subscribe(function(){return a.connect()}),a}return PM(r,[{key:"isConnected",get:function(){return this._isConnected}},{key:"entities",get:function(){return this._isConnected||this.connect(),bd(xc(r.prototype),"entities",this)}},{key:LM,value:function(){return this._isConnected||this.connect(),bd(xc(r.prototype),Symbol.iterator,this).call(this)}},{key:"connect",value:function(){if(!this._isConnected){this._isConnected=!0;var i=F1(this.world),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;this.evaluate(s)}}catch(o){i.e(o)}finally{i.f()}}return this}},{key:"disconnect",value:function(){return this._isConnected=!1,this}},{key:"with",value:function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return this.world.query(ac(ac({},this.config),{},{with:[].concat(yd(this.config.with),a)}))}},{key:"without",value:function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return this.world.query(ac(ac({},this.config),{},{without:[].concat(yd(this.config.without),a)}))}},{key:"where",value:function(i){return this.world.query(ac(ac({},this.config),{},{predicates:[].concat(yd(this.config.predicates),[i])}))}},{key:"want",value:function(i){return this.config.with.every(function(a){return i[a]!==void 0})&&this.config.without.every(function(a){return i[a]===void 0})&&this.config.predicates.every(function(a){return a(i)})}},{key:"evaluate",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(this.isConnected){var s=this.want(a),o=this.has(i);s&&!o?this.add(i):!s&&o&&this.remove(i)}}}]),r}(FM),EE=function(e){return yd(new Set(e.sort().filter(function(r){return!!r&&r!==""})))};function yH(t){return yd(new Set(t))}function bH(t){return{with:EE(t.with),without:EE(t.without),predicates:yH(t.predicates)}}function UM(t){return"".concat(t.with.join(","),":").concat(t.without.join(","),":").concat(t.predicates.map(function(e){return sH(e)}).join(","))}oH();var cc=(t=>(t.PLAYER="PLAYER",t.WORLD="WORLD",t))(cc||{}),At=(t=>(t.GAME="GAME",t.GAME_OVER="GAME_OVER",t.INVENTORY="INVENTORY",t.INSPECT="INSPECT",t.TARGET="TARGET",t.LOG_HISTORY="LOG_HISTORY",t.INTERACT="INTERACT",t.INTERACT_ACTION="INTERACT_ACTION",t.MAKER_MODE="MAKER_MODE",t.MAKER_MODE_PREFAB_SELECT="MAKER_MODE_PREFAB_SELECT",t.SAVING="SAVING",t.LOADING="LOADING",t))(At||{});const zM={cursor:[{x:0,y:0},{x:0,y:0}],fps:0,gameState:"GAME",log:["hello world","your adventure begins anew!"],logActiveIndex:0,inventoryActiveIndex:0,interactKey:"",interactTargets:[],interactActions:"",makerModePrefabSelectIndex:0,eapMap:new Map,odorMap:new Map,soundMap:new Map,visionMap:[],senses:{sight:"",hearing:"",smell:"",taste:"",touch:""},turn:"PLAYER",turnNumber:0,userInput:null,views:{},zoneId:"0,0,0",playerId:"",version:1,cheats:{seeAll:!1,seeOdorMap:!1,seeSoundMap:!1,seeVisionMap:!1}},ln=t=>{t(zM)},gt=()=>zM;var Kr=(t=>(t.Acid="acid",t.Bludgeoning="bludgeoning",t.Cold="cold",t.Fire="fire",t.Force="force",t.Lightning="lightning",t.Necrotic="necrotic",t.Piercing="piercing",t.Poison="poison",t.Psychic="psychic",t.Radiant="radiant",t.Slashing="slashing",t.Thunder="thunder",t))(Kr||{}),qi=(t=>(t.Dirt="dirt",t.Floor="floor",t.Passage="passage",t.Perimeter="perimeter",t.Room="room",t.Wall="wall",t))(qi||{}),Ud=(t=>(t.Beast="beast",t.Humanoid="humanoid",t.Player="player",t.Undead="undead",t))(Ud||{}),ui=(t=>(t[t.Hostile=-2]="Hostile",t[t.Unfriendly=-1]="Unfriendly",t[t.Neutral=0]="Neutral",t[t.Friendly=1]="Friendly",t[t.Allied=2]="Allied",t))(ui||{}),Lb=(t=>(t.Knockback="knockback",t))(Lb||{}),Da=(t=>(t.Closed="closed",t.Open="open",t.Ajar="ajar",t.Jammed="jammed",t.Broken="broken",t.Sealed="sealed",t))(Da||{}),zm=(t=>(t.Sight="sight",t.Hearing="hearing",t.Smell="smell",t.Taste="taste",t.Touch="touch",t))(zm||{}),Qv=(t=>(t.Martial="martial",t.Simple="simple",t))(Qv||{}),kn=(t=>(t.Flesh="flesh",t.Metal="metal",t.Blood="blood",t.Bone="bone",t.Glass="glass",t.Stone="stone",t.Wood="wood",t.Lava="lava",t.Leather="leather",t.Cloth="cloth",t.Paper="paper",t.Oil="oil",t.Plant="plant",t.Water="water",t))(kn||{}),dn=(t=>(t.armor="armor",t.club="club",t.corpse="corpse",t.dagger="dagger",t.default="default",t.doorClosed="doorClosed",t.doorOpen="doorOpen",t.floor="floor",t.fire="fire",t.grass="grass",t.golem="golem",t.owlbear="owlbear",t.player="player",t.potion="potion",t.rat="rat",t.rock="rock",t.shortsword="shortsword",t.skeleton="skeleton",t.stairsDown="stairsDown",t.stairsUp="stairsUp",t.tallGrass="tallGrass",t.wall="wall",t.weapon="weapon",t))(dn||{}),rn=(t=>(t[t.armor=14329120]="armor",t[t.default=65399]="default",t[t.floor=3355443]="floor",t[t.player=16777215]="player",t[t.potion=14358581]="potion",t[t.rat=14047863]="rat",t[t.rock=8355711]="rock",t[t.skeleton=16639396]="skeleton",t[t.stairsDown=14329120]="stairsDown",t[t.stairsUp=14329120]="stairsUp",t[t.steel=10462118]="steel",t[t.wall=8421504]="wall",t[t.weapon=14329120]="weapon",t[t.wood=8736293]="wood",t[t.cloth=14538445]="cloth",t[t.paper=15854034]="paper",t[t.plant=10608464]="plant",t[t.leather=11027200]="leather",t[t.flesh=14047863]="flesh",t[t.bone=16639396]="bone",t[t.metal=10462118]="metal",t[t.stone=8355711]="stone",t[t.glass=12834004]="glass",t[t.oil=14669909]="oil",t[t.lava=16214022]="lava",t[t.water=952268]="water",t[t.blood=7865862]="blood",t[t.fire=16433152]="fire",t[t.ash=6710886]="ash",t))(rn||{});const Ai={id:"",version:1,name:"base"},Ki={...Ai,appearance:{char:dn.default,tint:rn.default,tileSet:"kenny"},position:{x:0,y:0},name:"renderable"},xh={...Ai,layer100:!0,name:"tile"},Jv={...Ai,health:{max:1,current:1},blocking:!0,layer300:!0,name:"being",baseArmorClass:10,averageDamage:0,strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10,vision:{range:10,visible:[]},memory:{memories:new Map},odor:{strength:10}},Ub={...Ai,...Ki,appearance:{char:dn.weapon,tint:rn.steel,tileSet:"kenny"},legendable:!0,layer200:!0,pickUp:!0},xH={...Ki,...Jv,odor:{strength:10},entityKind:Ud.Player,appearance:{char:dn.player,tint:rn.player,tileSet:"kenny"},health:{max:1e3,current:1e3},legendable:!0,name:"player",pc:!0,container:{name:"Haversack",description:"A simple medium sized burlap pouch with a single shoulder strap.",slots:10,contents:[]},baseArmorClass:10,strength:16,dexterity:10,constitution:16,intelligence:8,wisdom:14,charisma:10,activeEffects:[],weaponSlot:{name:"Weapon",contents:[],slots:1},armorSlot:{name:"Armor",contents:[],slots:1},damages:[],immunities:[Kr.Fire],attacks:[{name:"Kick",verb:"kicks",toHit:0,attackType:"melee",damageRoll:"1d1",damageType:Kr.Bludgeoning,natural:!0,knockbackDistance:2}],pathThrough:!0,mass:1,material:kn.Flesh},wH={...Ai,...Ki,...Jv,entityKind:Ud.Beast,ai:!0,appearance:{char:dn.rat,tint:rn.rat,tileSet:"kenny"},legendable:!0,name:"rat",nose:{sensitivity:0,detected:[]},ears:{sensitivity:0,detected:[]},description:"A filthy, disease-ridden rodent with glowing eyes and a hungry squeak.",pathThrough:!0,health:{max:1,current:1},baseArmorClass:10,strength:2,dexterity:11,constitution:9,intelligence:2,wisdom:10,charisma:4,immunities:[],resistances:[],vulnerabilities:[],attacks:[{name:"Bite",verb:"bites",toHit:0,attackType:"melee",damageRoll:"1d1",damageType:Kr.Piercing},{name:"Claw",verb:"claws",toHit:0,attackType:"melee",damageRoll:"1d1",damageType:Kr.Slashing}],damages:[],kickable:{breakable:!0,noiseLevel:2,maxDamageOnKick:2},vision:{range:3,visible:[]},mass:.8,material:kn.Flesh},_H={...Ai,...Ki,...Jv,entityKind:Ud.Humanoid,ai:!0,appearance:{char:dn.golem,tint:rn.lava,tileSet:"kenny"},legendable:!0,name:"lava golem",ears:{sensitivity:3,detected:[]},nose:{sensitivity:0,detected:[]},description:"A humanoid mass of lava, animated by forgotten magic.",pathThrough:!0,health:{max:15,current:15},baseArmorClass:10,strength:10,dexterity:14,constitution:15,intelligence:6,wisdom:8,charisma:5,immunities:[Kr.Fire,Kr.Poison,Kr.Acid],resistances:[Kr.Bludgeoning,Kr.Piercing],vulnerabilities:[Kr.Cold],attacks:[{name:"Lava Punch",verb:"punches",toHit:0,attackType:"melee",damageRoll:"1d6",damageType:Kr.Fire}],damages:[],mass:6,material:kn.Lava},AH={...Ai,...Ki,...Jv,entityKind:Ud.Undead,ai:!0,appearance:{char:dn.skeleton,tint:rn.skeleton,tileSet:"kenny"},legendable:!0,name:"skeleton",ears:{sensitivity:5,detected:[]},nose:{sensitivity:5,detected:[]},description:"A brittle warrior from another age, still fighting long after death forgot it.",pathThrough:!0,health:{max:13,current:13},baseArmorClass:10,strength:10,dexterity:14,constitution:15,intelligence:6,wisdom:8,charisma:5,immunities:[Kr.Poison],resistances:[Kr.Piercing],vulnerabilities:[Kr.Bludgeoning],weaponSlot:{name:"Weapon",contents:[],slots:1},armorSlot:{name:"Armor",contents:[],slots:1},damages:[],container:{name:"Haversack",description:"A simple medium sized burlap pouch with a single shoulder strap.",slots:10,contents:[]},mass:6,material:kn.Bone},EH={...Ai,...Ki,appearance:{char:dn.potion,tint:rn.potion,tileSet:"kenny"},consumable:!0,legendable:!0,name:"Health Potion",description:"A syrupy red liquid in a small glass vile",effects:[{component:"health",delta:10}],layer200:!0,pickUp:!0,mass:.8,material:kn.Glass},SH={...Ai,...Ki,appearance:{char:dn.rock,tint:rn.rock,tileSet:"kenny"},legendable:!0,name:"Rock",description:"A small, jagged stone—barely useful, unless thrown.",layer200:!0,pickUp:!0,kickable:{noiseLevel:3,breakable:!0},mass:1,material:kn.Stone},DH={...Ub,name:"Shortsword",description:"An unadorned steel shortsword. It won’t impress, but it gets the job done.",appearance:{char:dn.shortsword,tint:rn.steel,tileSet:"kenny"},weaponClass:Qv.Martial,attacks:[{name:"Stab",verb:"stabs",toHit:0,attackType:"melee",damageRoll:"1d6+2",damageType:Kr.Piercing,useModifier:!0},{name:"Slash",verb:"slashes",toHit:0,attackType:"melee",damageRoll:"1d6+2",damageType:Kr.Slashing,useModifier:!0},{name:"Bash",verb:"bashes",toHit:0,attackType:"melee",damageRoll:"1d4+2",damageType:Kr.Bludgeoning,useModifier:!0}],mass:1.5,material:kn.Metal},CH={...Ub,name:"Club",description:"A crude bludgeon, little more than a knotted branch.",weaponClass:Qv.Simple,appearance:{char:dn.club,tint:rn.wood,tileSet:"kenny"},attacks:[{name:"Smash",verb:"smashes",toHit:0,attackType:"melee",damageRoll:"1d4",damageType:Kr.Bludgeoning,useModifier:!0,knockbackDistance:2}],mass:2,material:kn.Wood},TH={...Ub,name:"Dagger",description:"A rusted dagger with a chipped edge and a dark past.",appearance:{char:dn.dagger,tint:rn.wood,tileSet:"kenny"},weaponClass:Qv.Simple,attacks:[{name:"Pummel",verb:"pummels",toHit:0,attackType:"melee",damageRoll:"1d4",damageType:Kr.Bludgeoning},{name:"Stab",verb:"stabs",toHit:0,attackType:"melee",damageRoll:"1d4",damageType:Kr.Piercing,useModifier:!0},{name:"Slash",verb:"slashes",toHit:0,attackType:"melee",damageRoll:"1d4",damageType:Kr.Slashing,useModifier:!0}],mass:.8,material:kn.Metal},NH={...Ai,...Ki,appearance:{char:dn.armor,tint:rn.leather,tileSet:"kenny"},legendable:!0,name:"Leather Armor",description:"Basic but reliable, bearing the wear of many fights.",layer200:!0,pickUp:!0,armorClass:11,armorClassMod:"dexterity",mass:2.5,material:kn.Leather},MH={...Ai,...Ki,...xh,appearance:{char:dn.doorClosed,tint:rn.wood,tileSet:"kenny"},name:"door",legendable:!0,description:"A door",layer250:!0,opaque:!0,pathThrough:!0,blocking:!0,door:!0,openable:{state:Da.Closed},kickable:{knockbackDistance:0,immovable:!0,breakable:!0,noiseLevel:100,maxDamageOnKick:2},health:{max:25,current:25},vulnerabilities:[Kr.Bludgeoning,Kr.Force],resistances:[Kr.Piercing],immunities:[Kr.Poison,Kr.Psychic],effectImmunities:[Lb.Knockback],baseArmorClass:1,damages:[],mass:10,material:kn.Wood},IH={...Ai,...Ki,...xh,appearance:{char:dn.stairsDown,tint:rn.stairsDown,tileSet:"kenny"},name:"stairs down",stairsDown:!0,legendable:!0,description:"Stairs leading down",layer250:!0,mass:10,material:kn.Wood},FH={...Ai,...Ki,...xh,appearance:{char:dn.stairsUp,tint:rn.stairsUp,tileSet:"kenny"},name:"stairs up",stairsUp:!0,legendable:!0,description:"Stairs leading up",layer250:!0,mass:10,material:kn.Wood},OH={...Ai,...Ki,...xh,appearance:{char:dn.wall,tint:rn.wall,tileSet:"kenny"},blocking:!0,opaque:!0,name:"wall",kickable:{knockbackDistance:0,immovable:!0,maxDamageOnKick:2,noiseLevel:5},mass:100,material:kn.Stone},BH={...Ai,...Ki,...xh,appearance:{char:dn.floor,tint:rn.floor,tileSet:"kenny"},name:"floor",mass:100,material:kn.Stone},RH={...Ai,...Ki,name:"fluidContainer",layer150:!0,appearance:{char:"",tint:0,tileSet:"kenny"},mass:0,fluidContainer:{fluids:{water:{type:"water",tint:rn.water,viscosity:.23,minFlow:.5,volume:0,maxVolume:10},blood:{type:"blood",tint:rn.blood,viscosity:.18,minFlow:.5,volume:0,maxVolume:10},oil:{type:"oil",tint:rn.oil,viscosity:.15,minFlow:.7,volume:0,maxVolume:10},lava:{type:"lava",tint:rn.lava,viscosity:.01,minFlow:1,volume:0,maxVolume:10}}}},PH={...Ai,...Ki,...xh,appearance:{char:dn.grass,tint:rn.plant,tileSet:"kenny"},name:"grassy",description:"Dry grass",layer125:!0,mass:.4,material:kn.Plant,mutable:{current:"young",mutations:[{next:"young",name:"burnt",chanceToMutate:.01,addComponents:{appearance:{char:dn.grass,tint:rn.ash,tileSet:"kenny"}},removeComponents:["flammable"]},{next:"mature",name:"young",chanceToMutate:25e-5,addComponents:{appearance:{char:dn.grass,tint:rn.plant,tileSet:"kenny"},calculateFlammability:!0},removeComponents:[]},{name:"mature",chanceToMutate:.01,addComponents:{appearance:{char:dn.tallGrass,tint:rn.plant,tileSet:"kenny"},calculateFlammability:!0},removeComponents:[]}]}},eh={player:xH,lavaGolem:_H,rat:wH,skeleton:AH,healthPotion:EH,rock:SH,shortsword:DH,club:CH,dagger:TH,leatherArmor:NH,stairsDown:IH,stairsUp:FH,door:MH,wall:OH,floor:BH,fluidContainer:RH,grass:PH},Un=(t,e={})=>{const r=eh[t],n=Xt.world.add({...Qt.cloneDeep(r),...Qt.cloneDeep(e)});n.position&&vl(Xt.world,n,n.position);const{material:i,mass:a}=n;if(i&&a){const s=Of(i,a);Xt.world.addComponent(n,"flammable",s),s.source&&Xt.world.addComponent(n,"onFire",{age:0,intensity:1,source:!0})}return n};function Of(t,e){const n={blood:{ignition:0,fuel:0,maxIntensity:0,heatTolerance:3,explosive:!1,source:!1},bone:{ignition:.01,fuel:3,maxIntensity:1,heatTolerance:4,explosive:!1,source:!1},cloth:{ignition:.7,fuel:5,maxIntensity:2,heatTolerance:.5,explosive:!1,source:!1},flesh:{ignition:.05,fuel:12,maxIntensity:2,heatTolerance:2,explosive:!1,source:!1},glass:{ignition:0,fuel:0,maxIntensity:0,heatTolerance:3,explosive:!1,source:!1},lava:{ignition:1,fuel:100,maxIntensity:5,heatTolerance:.1,explosive:!1,source:!0},leather:{ignition:.2,fuel:10,maxIntensity:2,heatTolerance:1,explosive:!1,source:!1},metal:{ignition:0,fuel:0,maxIntensity:0,heatTolerance:5,explosive:!1,source:!1},oil:{ignition:.9,fuel:15,maxIntensity:5,heatTolerance:.1,explosive:!0,source:!1},paper:{ignition:.9,fuel:3,maxIntensity:2,heatTolerance:.2,explosive:!1,source:!1},plant:{ignition:.5,fuel:7,maxIntensity:3,heatTolerance:.7,explosive:!1,source:!1},stone:{ignition:0,fuel:0,maxIntensity:0,heatTolerance:5,explosive:!1,source:!1},water:{ignition:0,fuel:0,maxIntensity:0,heatTolerance:3,explosive:!1,source:!1},wood:{ignition:.35,fuel:20,maxIntensity:4,heatTolerance:1,explosive:!1,source:!1}}[t];if(!n||n.fuel===0)return{ignitionChance:0,fuel:{max:0,current:0},maxIntensity:0,heatTolerance:(n==null?void 0:n.heatTolerance)??999,explosive:n.explosive,source:n.source};const i=n.ignition*Math.max(.1,Math.min(2,1/Math.pow(e,.4))),a=Math.floor(n.fuel*(e*.8+.4));return{ignitionChance:i,fuel:{max:a,current:a},maxIntensity:n.maxIntensity+(e>5?1:0),heatTolerance:n.heatTolerance,explosive:n.explosive,source:n.source}}function Zn(){return Zn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Zn.apply(null,arguments)}var GM={relTol:1e-12,absTol:1e-15,matrix:"Matrix",number:"number",numberFallback:"number",precision:64,predictable:!1,randomSeed:null};function Vi(t,e){if(cv(t,e))return t[e];throw typeof t[e]=="function"&&zb(t,e)?new Error('Cannot access method "'+e+'" as a property'):new Error('No access to property "'+e+'"')}function th(t,e,r){if(cv(t,e))return t[e]=r,r;throw new Error('No access to property "'+e+'"')}function cv(t,e){return!kH(t)&&!Array.isArray(t)?!1:Ft(LH,e)?!0:!(e in Object.prototype||e in Function.prototype)}function $H(t,e){if(!zb(t,e))throw new Error('No access to method "'+e+'"');return t[e]}function zb(t,e){return t==null||typeof t[e]!="function"||Ft(t,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(t)?!1:Ft(UH,e)?!0:!(e in Object.prototype||e in Function.prototype)}function kH(t){return typeof t=="object"&&t&&t.constructor===Object}var LH={length:!0,name:!0},UH={toString:!0,valueOf:!0,toLocaleString:!0};class eg{constructor(e){this.wrappedObject=e,this[Symbol.iterator]=this.entries}keys(){return Object.keys(this.wrappedObject).filter(e=>this.has(e)).values()}get(e){return Vi(this.wrappedObject,e)}set(e,r){return th(this.wrappedObject,e,r),this}has(e){return cv(this.wrappedObject,e)&&e in this.wrappedObject}entries(){return HM(this.keys(),e=>[e,this.get(e)])}forEach(e){for(var r of this.keys())e(this.get(r),r,this)}delete(e){cv(this.wrappedObject,e)&&delete this.wrappedObject[e]}clear(){for(var e of this.keys())this.delete(e)}get size(){return Object.keys(this.wrappedObject).length}}class qM{constructor(e,r,n){this.a=e,this.b=r,this.bKeys=n,this[Symbol.iterator]=this.entries}get(e){return this.bKeys.has(e)?this.b.get(e):this.a.get(e)}set(e,r){return this.bKeys.has(e)?this.b.set(e,r):this.a.set(e,r),this}has(e){return this.b.has(e)||this.a.has(e)}keys(){return new Set([...this.a.keys(),...this.b.keys()])[Symbol.iterator]()}entries(){return HM(this.keys(),e=>[e,this.get(e)])}forEach(e){for(var r of this.keys())e(this.get(r),r,this)}delete(e){return this.bKeys.has(e)?this.b.delete(e):this.a.delete(e)}clear(){this.a.clear(),this.b.clear()}get size(){return[...this.keys()].length}}function HM(t,e){return{next:()=>{var r=t.next();return r.done?r:{value:e(r.value),done:!1}}}}function Nd(){return new Map}function Gf(t){if(!t)return Nd();if(VM(t))return t;if(rg(t))return new eg(t);throw new Error("createMap can create maps from objects or Maps")}function zH(t){if(t instanceof eg)return t.wrappedObject;var e={};for(var r of t.keys()){var n=t.get(r);th(e,r,n)}return e}function sr(t){return typeof t=="number"}function or(t){return!t||typeof t!="object"||typeof t.constructor!="function"?!1:t.isBigNumber===!0&&typeof t.constructor.prototype=="object"&&t.constructor.prototype.isBigNumber===!0||typeof t.constructor.isDecimal=="function"&&t.constructor.isDecimal(t)===!0}function xd(t){return typeof t=="bigint"}function pu(t){return t&&typeof t=="object"&&Object.getPrototypeOf(t).isComplex===!0||!1}function zd(t){return t&&typeof t=="object"&&Object.getPrototypeOf(t).isFraction===!0||!1}function es(t){return t&&t.constructor.prototype.isUnit===!0||!1}function Fi(t){return typeof t=="string"}var Jr=Array.isArray;function Gt(t){return t&&t.constructor.prototype.isMatrix===!0||!1}function is(t){return Array.isArray(t)||Gt(t)}function fv(t){return t&&t.isDenseMatrix&&t.constructor.prototype.isMatrix===!0||!1}function fc(t){return t&&t.isSparseMatrix&&t.constructor.prototype.isMatrix===!0||!1}function Gb(t){return t&&t.constructor.prototype.isRange===!0||!1}function tg(t){return t&&t.constructor.prototype.isIndex===!0||!1}function GH(t){return typeof t=="boolean"}function qH(t){return t&&t.constructor.prototype.isResultSet===!0||!1}function WM(t){return t&&t.constructor.prototype.isHelp===!0||!1}function HH(t){return typeof t=="function"}function WH(t){return t instanceof Date}function VH(t){return t instanceof RegExp}function rg(t){return!!(t&&typeof t=="object"&&t.constructor===Object&&!pu(t)&&!zd(t))}function VM(t){return t?t instanceof Map||t instanceof eg||typeof t.set=="function"&&typeof t.get=="function"&&typeof t.keys=="function"&&typeof t.has=="function":!1}function XH(t){return t===null}function jH(t){return t===void 0}function wc(t){return t&&t.isAccessorNode===!0&&t.constructor.prototype.isNode===!0||!1}function Ja(t){return t&&t.isArrayNode===!0&&t.constructor.prototype.isNode===!0||!1}function YH(t){return t&&t.isAssignmentNode===!0&&t.constructor.prototype.isNode===!0||!1}function KH(t){return t&&t.isBlockNode===!0&&t.constructor.prototype.isNode===!0||!1}function ZH(t){return t&&t.isConditionalNode===!0&&t.constructor.prototype.isNode===!0||!1}function Mr(t){return t&&t.isConstantNode===!0&&t.constructor.prototype.isNode===!0||!1}function B1(t){return Mr(t)||Rn(t)&&t.args.length===1&&Mr(t.args[0])&&"-+~".includes(t.op)}function Gd(t){return t&&t.isFunctionAssignmentNode===!0&&t.constructor.prototype.isNode===!0||!1}function hl(t){return t&&t.isFunctionNode===!0&&t.constructor.prototype.isNode===!0||!1}function wh(t){return t&&t.isIndexNode===!0&&t.constructor.prototype.isNode===!0||!1}function Zr(t){return t&&t.isNode===!0&&t.constructor.prototype.isNode===!0||!1}function ng(t){return t&&t.isObjectNode===!0&&t.constructor.prototype.isNode===!0||!1}function Rn(t){return t&&t.isOperatorNode===!0&&t.constructor.prototype.isNode===!0||!1}function gu(t){return t&&t.isParenthesisNode===!0&&t.constructor.prototype.isNode===!0||!1}function QH(t){return t&&t.isRangeNode===!0&&t.constructor.prototype.isNode===!0||!1}function JH(t){return t&&t.isRelationalNode===!0&&t.constructor.prototype.isNode===!0||!1}function fi(t){return t&&t.isSymbolNode===!0&&t.constructor.prototype.isNode===!0||!1}function XM(t){return t&&t.constructor.prototype.isChain===!0||!1}function tn(t){var e=typeof t;return e==="object"?t===null?"null":or(t)?"BigNumber":t.constructor&&t.constructor.name?t.constructor.name:"Object":e}function rr(t){var e=typeof t;if(e==="number"||e==="bigint"||e==="string"||e==="boolean"||t===null||t===void 0)return t;if(typeof t.clone=="function")return t.clone();if(Array.isArray(t))return t.map(function(r){return rr(r)});if(t instanceof Date)return new Date(t.valueOf());if(or(t))return t;if(rg(t))return eW(t,rr);if(e==="function")return t;throw new TypeError("Cannot clone: unknown type of value (value: ".concat(t,")"))}function eW(t,e){var r={};for(var n in t)Ft(t,n)&&(r[n]=e(t[n]));return r}function jM(t,e){for(var r in e)Ft(e,r)&&(t[r]=e[r]);return t}function yu(t,e){var r,n,i;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;n++)if(!yu(t[n],e[n]))return!1;return!0}else{if(typeof t=="function")return t===e;if(t instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(r in t)if(!(r in e)||!yu(t[r],e[r]))return!1;for(r in e)if(!(r in t))return!1;return!0}else return t===e}}function tW(t,e,r){var n=!0,i;Object.defineProperty(t,e,{get:function(){return n&&(i=r(),n=!1),i},set:function(s){i=s,n=!1},configurable:!0,enumerable:!0})}function Ft(t,e){return t&&Object.hasOwnProperty.call(t,e)}function rW(t,e){for(var r={},n=0;n<e.length;n++){var i=e[n],a=t[i];a!==void 0&&(r[i]=a)}return r}var nW=["Matrix","Array"],iW=["number","BigNumber","Fraction"],Ze=function(e){if(e)throw new Error(`The global config is readonly. 
Please create a mathjs instance if you want to change the default configuration. 
Example:

  import { create, all } from 'mathjs';
  const mathjs = create(all);
  mathjs.config({ number: 'BigNumber' });
`);return Object.freeze(GM)};Zn(Ze,GM,{MATRIX_OPTIONS:nW,NUMBER_OPTIONS:iW});function SE(){return!0}function Ka(){return!1}function hf(){}const DE="Argument is not a typed-function.";function YM(){function t(re){return typeof re=="object"&&re!==null&&re.constructor===Object}const e=[{name:"number",test:function(re){return typeof re=="number"}},{name:"string",test:function(re){return typeof re=="string"}},{name:"boolean",test:function(re){return typeof re=="boolean"}},{name:"Function",test:function(re){return typeof re=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(re){return re instanceof Date}},{name:"RegExp",test:function(re){return re instanceof RegExp}},{name:"Object",test:t},{name:"null",test:function(re){return re===null}},{name:"undefined",test:function(re){return re===void 0}}],r={name:"any",test:SE,isAny:!0};let n,i,a=0,s={createCount:0};function o(re){const we=n.get(re);if(we)return we;let Ne='Unknown type "'+re+'"';const Ge=re.toLowerCase();let He;for(He of i)if(He.toLowerCase()===Ge){Ne+='. Did you mean "'+He+'" ?';break}throw new TypeError(Ne)}function l(re){let we=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"any";const Ne=we?o(we).index:i.length,Ge=[];for(let We=0;We<re.length;++We){if(!re[We]||typeof re[We].name!="string"||typeof re[We].test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");const ft=re[We].name;if(n.has(ft))throw new TypeError('Duplicate type name "'+ft+'"');Ge.push(ft),n.set(ft,{name:ft,test:re[We].test,isAny:re[We].isAny,index:Ne+We,conversionsTo:[]})}const He=i.slice(Ne);i=i.slice(0,Ne).concat(Ge).concat(He);for(let We=Ne+Ge.length;We<i.length;++We)n.get(i[We]).index=We}function u(){n=new Map,i=[],a=0,l([r],!1)}u(),l(e);function c(){let re;for(re of i)n.get(re).conversionsTo=[];a=0}function f(re){const we=i.filter(Ne=>{const Ge=n.get(Ne);return!Ge.isAny&&Ge.test(re)});return we.length?we:["any"]}function h(re){return re&&typeof re=="function"&&"_typedFunctionData"in re}function p(re,we,Ne){if(!h(re))throw new TypeError(DE);const Ge=Ne&&Ne.exact,He=Array.isArray(we)?we.join(","):we,We=A(He),ft=y(We);if(!Ge||ft in re.signatures){const tr=re._typedFunctionData.signatureMap.get(ft);if(tr)return tr}const st=We.length;let dt;if(Ge){dt=[];let tr;for(tr in re.signatures)dt.push(re._typedFunctionData.signatureMap.get(tr))}else dt=re._typedFunctionData.signatures;for(let tr=0;tr<st;++tr){const Ot=We[tr],fr=[];let R;for(R of dt){const ge=M(R.params,tr);if(!(!ge||Ot.restParam&&!ge.restParam)){if(!ge.hasAny){const Le=b(ge);if(Ot.types.some(rt=>!Le.has(rt.name)))continue}fr.push(R)}}if(dt=fr,dt.length===0)break}let at;for(at of dt)if(at.params.length<=st)return at;throw new TypeError("Signature not found (signature: "+(re.name||"unnamed")+"("+y(We,", ")+"))")}function m(re,we,Ne){return p(re,we,Ne).implementation}function v(re,we){const Ne=o(we);if(Ne.test(re))return re;const Ge=Ne.conversionsTo;if(Ge.length===0)throw new Error("There are no conversions to "+we+" defined.");for(let He=0;He<Ge.length;He++)if(o(Ge[He].from).test(re))return Ge[He].convert(re);throw new Error("Cannot convert "+re+" to "+we)}function y(re){let we=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",";return re.map(Ne=>Ne.name).join(we)}function x(re){const we=re.indexOf("...")===0,Ge=(we?re.length>3?re.slice(3):"any":re).split("|").map(st=>o(st.trim()));let He=!1,We=we?"...":"";return{types:Ge.map(function(st){return He=st.isAny||He,We+=st.name+"|",{name:st.name,typeIndex:st.index,test:st.test,isAny:st.isAny,conversion:null,conversionIndex:-1}}),name:We.slice(0,-1),hasAny:He,hasConversion:!1,restParam:we}}function S(re){const we=re.types.map(ft=>ft.name),Ne=j(we);let Ge=re.hasAny,He=re.name;const We=Ne.map(function(ft){const st=o(ft.from);return Ge=st.isAny||Ge,He+="|"+ft.from,{name:ft.from,typeIndex:st.index,test:st.test,isAny:st.isAny,conversion:ft,conversionIndex:ft.index}});return{types:re.types.concat(We),name:He,hasAny:Ge,hasConversion:We.length>0,restParam:re.restParam}}function b(re){return re.typeSet||(re.typeSet=new Set,re.types.forEach(we=>re.typeSet.add(we.name))),re.typeSet}function A(re){const we=[];if(typeof re!="string")throw new TypeError("Signatures must be strings");const Ne=re.trim();if(Ne==="")return we;const Ge=Ne.split(",");for(let He=0;He<Ge.length;++He){const We=x(Ge[He].trim());if(We.restParam&&He!==Ge.length-1)throw new SyntaxError('Unexpected rest parameter "'+Ge[He]+'": only allowed for the last parameter');if(We.types.length===0)return null;we.push(We)}return we}function E(re){const we=K(re);return we?we.restParam:!1}function _(re){if(!re||re.types.length===0)return SE;if(re.types.length===1)return o(re.types[0].name).test;if(re.types.length===2){const we=o(re.types[0].name).test,Ne=o(re.types[1].name).test;return function(He){return we(He)||Ne(He)}}else{const we=re.types.map(function(Ne){return o(Ne.name).test});return function(Ge){for(let He=0;He<we.length;He++)if(we[He](Ge))return!0;return!1}}}function T(re){let we,Ne,Ge;if(E(re)){we=oe(re).map(_);const He=we.length,We=_(K(re)),ft=function(st){for(let dt=He;dt<st.length;dt++)if(!We(st[dt]))return!1;return!0};return function(dt){for(let at=0;at<we.length;at++)if(!we[at](dt[at]))return!1;return ft(dt)&&dt.length>=He+1}}else return re.length===0?function(We){return We.length===0}:re.length===1?(Ne=_(re[0]),function(We){return Ne(We[0])&&We.length===1}):re.length===2?(Ne=_(re[0]),Ge=_(re[1]),function(We){return Ne(We[0])&&Ge(We[1])&&We.length===2}):(we=re.map(_),function(We){for(let ft=0;ft<we.length;ft++)if(!we[ft](We[ft]))return!1;return We.length===we.length})}function M(re,we){return we<re.length?re[we]:E(re)?K(re):null}function N(re,we){const Ne=M(re,we);return Ne?b(Ne):new Set}function I(re){return re.conversion===null||re.conversion===void 0}function F(re,we){const Ne=new Set;return re.forEach(Ge=>{const He=N(Ge.params,we);let We;for(We of He)Ne.add(We)}),Ne.has("any")?["any"]:Array.from(Ne)}function P(re,we,Ne){let Ge,He;const We=re||"unnamed";let ft=Ne,st;for(st=0;st<we.length;st++){const Ot=[];if(ft.forEach(fr=>{const R=M(fr.params,st),ge=_(R);(st<fr.params.length||E(fr.params))&&ge(we[st])&&Ot.push(fr)}),Ot.length===0){if(He=F(ft,st),He.length>0){const fr=f(we[st]);return Ge=new TypeError("Unexpected type of argument in function "+We+" (expected: "+He.join(" or ")+", actual: "+fr.join(" | ")+", index: "+st+")"),Ge.data={category:"wrongType",fn:We,index:st,actual:fr,expected:He},Ge}}else ft=Ot}const dt=ft.map(function(Ot){return E(Ot.params)?1/0:Ot.params.length});if(we.length<Math.min.apply(null,dt))return He=F(ft,st),Ge=new TypeError("Too few arguments in function "+We+" (expected: "+He.join(" or ")+", index: "+we.length+")"),Ge.data={category:"tooFewArgs",fn:We,index:we.length,expected:He},Ge;const at=Math.max.apply(null,dt);if(we.length>at)return Ge=new TypeError("Too many arguments in function "+We+" (expected: "+at+", actual: "+we.length+")"),Ge.data={category:"tooManyArgs",fn:We,index:we.length,expectedLength:at},Ge;const tr=[];for(let Ot=0;Ot<we.length;++Ot)tr.push(f(we[Ot]).join("|"));return Ge=new TypeError('Arguments of type "'+tr.join(", ")+'" do not match any of the defined signatures of function '+We+"."),Ge.data={category:"mismatch",actual:tr},Ge}function U(re){let we=i.length+1;for(let Ne=0;Ne<re.types.length;Ne++)I(re.types[Ne])&&(we=Math.min(we,re.types[Ne].typeIndex));return we}function G(re){let we=a+1;for(let Ne=0;Ne<re.types.length;Ne++)I(re.types[Ne])||(we=Math.min(we,re.types[Ne].conversionIndex));return we}function V(re,we){if(re.hasAny){if(!we.hasAny)return 1}else if(we.hasAny)return-1;if(re.restParam){if(!we.restParam)return 1}else if(we.restParam)return-1;if(re.hasConversion){if(!we.hasConversion)return 1}else if(we.hasConversion)return-1;const Ne=U(re)-U(we);if(Ne<0)return-1;if(Ne>0)return 1;const Ge=G(re)-G(we);return Ge<0?-1:Ge>0?1:0}function $(re,we){const Ne=re.params,Ge=we.params,He=K(Ne),We=K(Ge),ft=E(Ne),st=E(Ge);if(ft&&He.hasAny){if(!st||!We.hasAny)return 1}else if(st&&We.hasAny)return-1;let dt=0,at=0,tr;for(tr of Ne)tr.hasAny&&++dt,tr.hasConversion&&++at;let Ot=0,fr=0;for(tr of Ge)tr.hasAny&&++Ot,tr.hasConversion&&++fr;if(dt!==Ot)return dt-Ot;if(ft&&He.hasConversion){if(!st||!We.hasConversion)return 1}else if(st&&We.hasConversion)return-1;if(at!==fr)return at-fr;if(ft){if(!st)return 1}else if(st)return-1;const R=(Ne.length-Ge.length)*(ft?-1:1);if(R!==0)return R;const ge=[];let Le=0;for(let Xe=0;Xe<Ne.length;++Xe){const qt=V(Ne[Xe],Ge[Xe]);ge.push(qt),Le+=qt}if(Le!==0)return Le;let rt;for(rt of ge)if(rt!==0)return rt;return 0}function j(re){if(re.length===0)return[];const we=re.map(o);re.length>1&&we.sort((He,We)=>He.index-We.index);let Ne=we[0].conversionsTo;if(re.length===1)return Ne;Ne=Ne.concat([]);const Ge=new Set(re);for(let He=1;He<we.length;++He){let We;for(We of we[He].conversionsTo)Ge.has(We.from)||(Ne.push(We),Ge.add(We.from))}return Ne}function k(re,we){let Ne=we;if(re.some(He=>He.hasConversion)){const He=E(re),We=re.map(Z);Ne=function(){const st=[],dt=He?arguments.length-1:arguments.length;for(let at=0;at<dt;at++)st[at]=We[at](arguments[at]);return He&&(st[dt]=arguments[dt].map(We[dt])),we.apply(this,st)}}let Ge=Ne;if(E(re)){const He=re.length-1;Ge=function(){return Ne.apply(this,de(arguments,0,He).concat([de(arguments,He)]))}}return Ge}function Z(re){let we,Ne,Ge,He;const We=[],ft=[];switch(re.types.forEach(function(st){st.conversion&&(We.push(o(st.conversion.from).test),ft.push(st.conversion.convert))}),ft.length){case 0:return function(dt){return dt};case 1:return we=We[0],Ge=ft[0],function(dt){return we(dt)?Ge(dt):dt};case 2:return we=We[0],Ne=We[1],Ge=ft[0],He=ft[1],function(dt){return we(dt)?Ge(dt):Ne(dt)?He(dt):dt};default:return function(dt){for(let at=0;at<ft.length;at++)if(We[at](dt))return ft[at](dt);return dt}}}function z(re){function we(Ne,Ge,He){if(Ge<Ne.length){const We=Ne[Ge];let ft=[];if(We.restParam){const st=We.types.filter(I);st.length<We.types.length&&ft.push({types:st,name:"..."+st.map(dt=>dt.name).join("|"),hasAny:st.some(dt=>dt.isAny),hasConversion:!1,restParam:!0}),ft.push(We)}else ft=We.types.map(function(st){return{types:[st],name:st.name,hasAny:st.isAny,hasConversion:st.conversion,restParam:!1}});return be(ft,function(st){return we(Ne,Ge+1,He.concat([st]))})}else return[He]}return we(re,0,[])}function me(re,we){const Ne=Math.max(re.length,we.length);for(let st=0;st<Ne;st++){const dt=N(re,st),at=N(we,st);let tr=!1,Ot;for(Ot of at)if(dt.has(Ot)){tr=!0;break}if(!tr)return!1}const Ge=re.length,He=we.length,We=E(re),ft=E(we);return We?ft?Ge===He:He>=Ge:ft?Ge>=He:Ge===He}function fe(re){return re.map(we=>ce(we)?Qe(we.referToSelf.callback):ae(we)?Oe(we.referTo.references,we.referTo.callback):we)}function ue(re,we,Ne){const Ge=[];let He;for(He of re){let We=Ne[He];if(typeof We!="number")throw new TypeError('No definition for referenced signature "'+He+'"');if(We=we[We],typeof We!="function")return!1;Ge.push(We)}return Ge}function le(re,we,Ne){const Ge=fe(re),He=new Array(Ge.length).fill(!1);let We=!0;for(;We;){We=!1;let ft=!0;for(let st=0;st<Ge.length;++st){if(He[st])continue;const dt=Ge[st];if(ce(dt))Ge[st]=dt.referToSelf.callback(Ne),Ge[st].referToSelf=dt.referToSelf,He[st]=!0,ft=!1;else if(ae(dt)){const at=ue(dt.referTo.references,Ge,we);at?(Ge[st]=dt.referTo.callback.apply(this,at),Ge[st].referTo=dt.referTo,He[st]=!0,ft=!1):We=!0}}if(ft&&We)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return Ge}function ke(re){const we=/\bthis(\(|\.signatures\b)/;Object.keys(re).forEach(Ne=>{const Ge=re[Ne];if(we.test(Ge.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}function Me(re,we){if(s.createCount++,Object.keys(we).length===0)throw new SyntaxError("No signatures provided");s.warnAgainstDeprecatedThis&&ke(we);const Ne=[],Ge=[],He={},We=[];let ft;for(ft in we){if(!Object.prototype.hasOwnProperty.call(we,ft))continue;const ir=A(ft);if(!ir)continue;Ne.forEach(function(ki){if(me(ki,ir))throw new TypeError('Conflicting signatures "'+y(ki)+'" and "'+y(ir)+'".')}),Ne.push(ir);const Tn=Ge.length;Ge.push(we[ft]);const Ra=ir.map(S);let ya;for(ya of z(Ra)){const ki=y(ya);We.push({params:ya,name:ki,fn:Tn}),ya.every(Qs=>!Qs.hasConversion)&&(He[ki]=Tn)}}We.sort($);const st=le(Ge,He,di);let dt;for(dt in He)Object.prototype.hasOwnProperty.call(He,dt)&&(He[dt]=st[He[dt]]);const at=[],tr=new Map;for(dt of We)tr.has(dt.name)||(dt.fn=st[dt.fn],at.push(dt),tr.set(dt.name,dt));const Ot=at[0]&&at[0].params.length<=2&&!E(at[0].params),fr=at[1]&&at[1].params.length<=2&&!E(at[1].params),R=at[2]&&at[2].params.length<=2&&!E(at[2].params),ge=at[3]&&at[3].params.length<=2&&!E(at[3].params),Le=at[4]&&at[4].params.length<=2&&!E(at[4].params),rt=at[5]&&at[5].params.length<=2&&!E(at[5].params),Xe=Ot&&fr&&R&&ge&&Le&&rt;for(let ir=0;ir<at.length;++ir)at[ir].test=T(at[ir].params);const qt=Ot?_(at[0].params[0]):Ka,pn=fr?_(at[1].params[0]):Ka,fs=R?_(at[2].params[0]):Ka,Co=ge?_(at[3].params[0]):Ka,js=Le?_(at[4].params[0]):Ka,Tl=rt?_(at[5].params[0]):Ka,To=Ot?_(at[0].params[1]):Ka,Ia=fr?_(at[1].params[1]):Ka,Fa=R?_(at[2].params[1]):Ka,No=ge?_(at[3].params[1]):Ka,Oa=Le?_(at[4].params[1]):Ka,Xr=rt?_(at[5].params[1]):Ka;for(let ir=0;ir<at.length;++ir)at[ir].implementation=k(at[ir].params,at[ir].fn);const fn=Ot?at[0].implementation:hf,Nl=fr?at[1].implementation:hf,Ys=R?at[2].implementation:hf,Ks=ge?at[3].implementation:hf,Zs=Le?at[4].implementation:hf,Ml=rt?at[5].implementation:hf,ea=Ot?at[0].params.length:-1,Ba=fr?at[1].params.length:-1,hi=R?at[2].params.length:-1,ta=ge?at[3].params.length:-1,Il=Le?at[4].params.length:-1,ra=rt?at[5].params.length:-1,Eu=Xe?6:0,ga=at.length,Su=at.map(ir=>ir.test),Mo=at.map(ir=>ir.implementation),jr=function(){for(let Tn=Eu;Tn<ga;Tn++)if(Su[Tn](arguments))return Mo[Tn].apply(this,arguments);return s.onMismatch(re,arguments,at)};function di(ir,Tn){return arguments.length===ea&&qt(ir)&&To(Tn)?fn.apply(this,arguments):arguments.length===Ba&&pn(ir)&&Ia(Tn)?Nl.apply(this,arguments):arguments.length===hi&&fs(ir)&&Fa(Tn)?Ys.apply(this,arguments):arguments.length===ta&&Co(ir)&&No(Tn)?Ks.apply(this,arguments):arguments.length===Il&&js(ir)&&Oa(Tn)?Zs.apply(this,arguments):arguments.length===ra&&Tl(ir)&&Xr(Tn)?Ml.apply(this,arguments):jr.apply(this,arguments)}try{Object.defineProperty(di,"name",{value:re})}catch{}return di.signatures=He,di._typedFunctionData={signatures:at,signatureMap:tr},di}function Se(re,we,Ne){throw P(re,we,Ne)}function oe(re){return de(re,0,re.length-1)}function K(re){return re[re.length-1]}function de(re,we,Ne){return Array.prototype.slice.call(re,we,Ne)}function _e(re,we){for(let Ne=0;Ne<re.length;Ne++)if(we(re[Ne]))return re[Ne]}function be(re,we){return Array.prototype.concat.apply([],re.map(we))}function $e(){const re=oe(arguments).map(Ne=>y(A(Ne))),we=K(arguments);if(typeof we!="function")throw new TypeError("Callback function expected as last argument");return Oe(re,we)}function Oe(re,we){return{referTo:{references:re,callback:we}}}function Qe(re){if(typeof re!="function")throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:re}}}function ae(re){return re&&typeof re.referTo=="object"&&Array.isArray(re.referTo.references)&&typeof re.referTo.callback=="function"}function ce(re){return re&&typeof re.referToSelf=="object"&&typeof re.referToSelf.callback=="function"}function Ce(re,we){if(!re)return we;if(we&&we!==re){const Ne=new Error("Function names do not match (expected: "+re+", actual: "+we+")");throw Ne.data={actual:we,expected:re},Ne}return re}function Ue(re){let we;for(const Ne in re)Object.prototype.hasOwnProperty.call(re,Ne)&&(h(re[Ne])||typeof re[Ne].signature=="string")&&(we=Ce(we,re[Ne].name));return we}function Ve(re,we){let Ne;for(Ne in we)if(Object.prototype.hasOwnProperty.call(we,Ne)){if(Ne in re&&we[Ne]!==re[Ne]){const Ge=new Error('Signature "'+Ne+'" is defined twice');throw Ge.data={signature:Ne,sourceFunction:we[Ne],destFunction:re[Ne]},Ge}re[Ne]=we[Ne]}}const je=s;s=function(re){const we=typeof re=="string",Ne=we?1:0;let Ge=we?re:"";const He={};for(let We=Ne;We<arguments.length;++We){const ft=arguments[We];let st={},dt;if(typeof ft=="function"?(dt=ft.name,typeof ft.signature=="string"?st[ft.signature]=ft:h(ft)&&(st=ft.signatures)):t(ft)&&(st=ft,we||(dt=Ue(ft))),Object.keys(st).length===0){const at=new TypeError("Argument to 'typed' at index "+We+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw at.data={index:We,argument:ft},at}we||(Ge=Ce(Ge,dt)),Ve(He,st)}return Me(Ge||"",He)},s.create=YM,s.createCount=je.createCount,s.onMismatch=Se,s.throwMismatchError=Se,s.createError=P,s.clear=u,s.clearConversions=c,s.addTypes=l,s._findType=o,s.referTo=$e,s.referToSelf=Qe,s.convert=v,s.findSignature=p,s.find=m,s.isTypedFunction=h,s.warnAgainstDeprecatedThis=!0,s.addType=function(re,we){let Ne="any";we!==!1&&n.has("Object")&&(Ne="Object"),s.addTypes([re],Ne)};function ht(re){if(!re||typeof re.from!="string"||typeof re.to!="string"||typeof re.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(re.to===re.from)throw new SyntaxError('Illegal to define conversion from "'+re.from+'" to itself.')}return s.addConversion=function(re){let we=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{override:!1};ht(re);const Ne=o(re.to),Ge=Ne.conversionsTo.find(He=>He.from===re.from);if(Ge)if(we&&we.override)s.removeConversion({from:Ge.from,to:re.to,convert:Ge.convert});else throw new Error('There is already a conversion from "'+re.from+'" to "'+Ne.name+'"');Ne.conversionsTo.push({from:re.from,convert:re.convert,index:a++})},s.addConversions=function(re,we){re.forEach(Ne=>s.addConversion(Ne,we))},s.removeConversion=function(re){ht(re);const we=o(re.to),Ne=_e(we.conversionsTo,He=>He.from===re.from);if(!Ne)throw new Error("Attempt to remove nonexistent conversion from "+re.from+" to "+re.to);if(Ne.convert!==re.convert)throw new Error("Conversion to remove does not match existing conversion");const Ge=we.conversionsTo.indexOf(Ne);we.conversionsTo.splice(Ge,1)},s.resolve=function(re,we){if(!h(re))throw new TypeError(DE);const Ne=re._typedFunctionData.signatures;for(let Ge=0;Ge<Ne.length;++Ge)if(Ne[Ge].test(we))return Ne[Ge];return null},s}const hv=YM();function ee(t,e,r,n){function i(a){var s=rW(a,e.map(oW));return aW(t,e,a),r(s)}return i.isFactory=!0,i.fn=t,i.dependencies=e.slice().sort(),n&&(i.meta=n),i}function aW(t,e,r){var n=e.filter(a=>!sW(a)).every(a=>r[a]!==void 0);if(!n){var i=e.filter(a=>r[a]===void 0);throw new Error('Cannot create function "'.concat(t,'", ')+"some dependencies are missing: ".concat(i.map(a=>'"'.concat(a,'"')).join(", "),"."))}}function sW(t){return t&&t[0]==="?"}function oW(t){return t&&t[0]==="?"?t.slice(1):t}function Bt(t){return typeof t=="boolean"?!0:isFinite(t)?t===Math.round(t):!1}function bl(t,e){if(e.number==="bigint")try{BigInt(t)}catch{return e.numberFallback}return e.number}var nl=Math.sign||function(t){return t>0?1:t<0?-1:0},uW=Math.log2||function(e){return Math.log(e)/Math.LN2},lW=Math.log10||function(e){return Math.log(e)/Math.LN10},cW=Math.log1p||function(t){return Math.log(t+1)},fW=Math.cbrt||function(e){if(e===0)return e;var r=e<0,n;return r&&(e=-e),isFinite(e)?(n=Math.exp(Math.log(e)/3),n=(e/(n*n)+2*n)/3):n=e,r?-n:n},hW=Math.expm1||function(e){return e>=2e-4||e<=-2e-4?Math.exp(e)-1:e+e*e/2+e*e*e/6};function ny(t,e,r){var n={2:"0b",8:"0o",16:"0x"},i=n[e],a="";if(r){if(r<1)throw new Error("size must be in greater than 0");if(!Bt(r))throw new Error("size must be an integer");if(t>2**(r-1)-1||t<-(2**(r-1)))throw new Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!Bt(t))throw new Error("Value must be an integer");t<0&&(t=t+2**r),a="i".concat(r)}var s="";return t<0&&(t=-t,s="-"),"".concat(s).concat(i).concat(t.toString(e)).concat(a)}function vc(t,e){if(typeof e=="function")return e(t);if(t===1/0)return"Infinity";if(t===-1/0)return"-Infinity";if(isNaN(t))return"NaN";var{notation:r,precision:n,wordSize:i}=KM(e);switch(r){case"fixed":return ZM(t,n);case"exponential":return QM(t,n);case"engineering":return dW(t,n);case"bin":return ny(t,2,i);case"oct":return ny(t,8,i);case"hex":return ny(t,16,i);case"auto":return pW(t,n,e).replace(/((\.\d*?)(0+))($|e)/,function(){var a=arguments[2],s=arguments[4];return a!=="."?a+s:s});default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function KM(t){var e="auto",r,n;if(t!==void 0)if(sr(t))r=t;else if(or(t))r=t.toNumber();else if(rg(t))t.precision!==void 0&&(r=CE(t.precision,()=>{throw new Error('Option "precision" must be a number or BigNumber')})),t.wordSize!==void 0&&(n=CE(t.wordSize,()=>{throw new Error('Option "wordSize" must be a number or BigNumber')})),t.notation&&(e=t.notation);else throw new Error("Unsupported type of options, number, BigNumber, or object expected");return{notation:e,precision:r,wordSize:n}}function qd(t){var e=String(t).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+t);var r=e[1],n=e[2],i=parseFloat(e[4]||"0"),a=n.indexOf(".");i+=a!==-1?a-1:n.length-1;var s=n.replace(".","").replace(/^0*/,function(o){return i-=o.length,""}).replace(/0*$/,"").split("").map(function(o){return parseInt(o)});return s.length===0&&(s.push(0),i++),{sign:r,coefficients:s,exponent:i}}function dW(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=qd(t),n=ig(r,e),i=n.exponent,a=n.coefficients,s=i%3===0?i:i<0?i-3-i%3:i-i%3;if(sr(e))for(;e>a.length||i-s+1>a.length;)a.push(0);else for(var o=Math.abs(i-s)-(a.length-1),l=0;l<o;l++)a.push(0);for(var u=Math.abs(i-s),c=1;u>0;)c++,u--;var f=a.slice(c).join(""),h=sr(e)&&f.length||f.match(/[1-9]/)?"."+f:"",p=a.slice(0,c).join("")+h+"e"+(i>=0?"+":"")+s.toString();return n.sign+p}function ZM(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=qd(t),n=typeof e=="number"?ig(r,r.exponent+1+e):r,i=n.coefficients,a=n.exponent+1,s=a+(e||0);return i.length<s&&(i=i.concat(qf(s-i.length))),a<0&&(i=qf(-a+1).concat(i),a=1),a<i.length&&i.splice(a,0,a===0?"0.":"."),n.sign+i.join("")}function QM(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=qd(t),n=e?ig(r,e):r,i=n.coefficients,a=n.exponent;i.length<e&&(i=i.concat(qf(e-i.length)));var s=i.shift();return n.sign+s+(i.length>0?"."+i.join(""):"")+"e"+(a>=0?"+":"")+a}function pW(t,e,r){if(isNaN(t)||!isFinite(t))return String(t);var n=TE(r==null?void 0:r.lowerExp,-3),i=TE(r==null?void 0:r.upperExp,5),a=qd(t),s=e?ig(a,e):a;if(s.exponent<n||s.exponent>=i)return QM(t,e);var o=s.coefficients,l=s.exponent;o.length<e&&(o=o.concat(qf(e-o.length))),o=o.concat(qf(l-o.length+1+(o.length<e?e-o.length:0))),o=qf(-l).concat(o);var u=l>0?l:0;return u<o.length-1&&o.splice(u+1,0,"."),s.sign+o.join("")}function ig(t,e){for(var r={sign:t.sign,coefficients:t.coefficients,exponent:t.exponent},n=r.coefficients;e<=0;)n.unshift(0),r.exponent++,e++;if(n.length>e){var i=n.splice(e,n.length-e);if(i[0]>=5){var a=e-1;for(n[a]++;n[a]===10;)n.pop(),a===0&&(n.unshift(0),r.exponent++,a++),a--,n[a]++}}return r}function qf(t){for(var e=[],r=0;r<t;r++)e.push(0);return e}function mW(t){return t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}function _i(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e-8,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(r<=0)throw new Error("Relative tolerance must be greater than 0");if(n<0)throw new Error("Absolute tolerance must be at least 0");return isNaN(t)||isNaN(e)?!1:!isFinite(t)||!isFinite(e)?t===e:t===e?!0:Math.abs(t-e)<=Math.max(r*Math.max(Math.abs(t),Math.abs(e)),n)}var vW=Math.acosh||function(t){return Math.log(Math.sqrt(t*t-1)+t)},gW=Math.asinh||function(t){return Math.log(Math.sqrt(t*t+1)+t)},yW=Math.atanh||function(t){return Math.log((1+t)/(1-t))/2},bW=Math.cosh||function(t){return(Math.exp(t)+Math.exp(-t))/2},xW=Math.sinh||function(t){return(Math.exp(t)-Math.exp(-t))/2},wW=Math.tanh||function(t){var e=Math.exp(2*t);return(e-1)/(e+1)};function _W(t,e){var r=!0,n=e>0?!0:e<0?!1:1/e===1/0;return r^n?-t:t}function CE(t,e){if(sr(t))return t;if(or(t))return t.toNumber();e()}function TE(t,e){return sr(t)?t:or(t)?t.toNumber():e}var JM=function(){return JM=hv.create,hv},AW=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],EW=ee("typed",AW,function(e){var{BigNumber:r,Complex:n,DenseMatrix:i,Fraction:a}=e,s=JM();return s.clear(),s.addTypes([{name:"number",test:sr},{name:"Complex",test:pu},{name:"BigNumber",test:or},{name:"bigint",test:xd},{name:"Fraction",test:zd},{name:"Unit",test:es},{name:"identifier",test:o=>Fi&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(o)},{name:"string",test:Fi},{name:"Chain",test:XM},{name:"Array",test:Jr},{name:"Matrix",test:Gt},{name:"DenseMatrix",test:fv},{name:"SparseMatrix",test:fc},{name:"Range",test:Gb},{name:"Index",test:tg},{name:"boolean",test:GH},{name:"ResultSet",test:qH},{name:"Help",test:WM},{name:"function",test:HH},{name:"Date",test:WH},{name:"RegExp",test:VH},{name:"null",test:XH},{name:"undefined",test:jH},{name:"AccessorNode",test:wc},{name:"ArrayNode",test:Ja},{name:"AssignmentNode",test:YH},{name:"BlockNode",test:KH},{name:"ConditionalNode",test:ZH},{name:"ConstantNode",test:Mr},{name:"FunctionNode",test:hl},{name:"FunctionAssignmentNode",test:Gd},{name:"IndexNode",test:wh},{name:"Node",test:Zr},{name:"ObjectNode",test:ng},{name:"OperatorNode",test:Rn},{name:"ParenthesisNode",test:gu},{name:"RangeNode",test:QH},{name:"RelationalNode",test:JH},{name:"SymbolNode",test:fi},{name:"Map",test:VM},{name:"Object",test:rg}]),s.addConversions([{from:"number",to:"BigNumber",convert:function(l){if(r||tm(l),mW(l)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+l+"). Use function bignumber(x) to convert to BigNumber.");return new r(l)}},{from:"number",to:"Complex",convert:function(l){return n||rm(l),new n(l,0)}},{from:"BigNumber",to:"Complex",convert:function(l){return n||rm(l),new n(l.toNumber(),0)}},{from:"bigint",to:"number",convert:function(l){if(l>Number.MAX_SAFE_INTEGER)throw new TypeError("Cannot implicitly convert bigint to number: value exceeds the max safe integer value (value: "+l+")");return Number(l)}},{from:"bigint",to:"BigNumber",convert:function(l){return r||tm(l),new r(l.toString())}},{from:"bigint",to:"Fraction",convert:function(l){return a||nm(l),new a(l)}},{from:"Fraction",to:"BigNumber",convert:function(l){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(l){return n||rm(l),new n(l.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(l){a||nm(l);var u=new a(l);if(u.valueOf()!==l)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+l+"). Use function fraction(x) to convert to Fraction.");return u}},{from:"string",to:"number",convert:function(l){var u=Number(l);if(isNaN(u))throw new Error('Cannot convert "'+l+'" to a number');return u}},{from:"string",to:"BigNumber",convert:function(l){r||tm(l);try{return new r(l)}catch{throw new Error('Cannot convert "'+l+'" to BigNumber')}}},{from:"string",to:"bigint",convert:function(l){try{return BigInt(l)}catch{throw new Error('Cannot convert "'+l+'" to BigInt')}}},{from:"string",to:"Fraction",convert:function(l){a||nm(l);try{return new a(l)}catch{throw new Error('Cannot convert "'+l+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(l){n||rm(l);try{return new n(l)}catch{throw new Error('Cannot convert "'+l+'" to Complex')}}},{from:"boolean",to:"number",convert:function(l){return+l}},{from:"boolean",to:"BigNumber",convert:function(l){return r||tm(l),new r(+l)}},{from:"boolean",to:"bigint",convert:function(l){return BigInt(+l)}},{from:"boolean",to:"Fraction",convert:function(l){return a||nm(l),new a(+l)}},{from:"boolean",to:"string",convert:function(l){return String(l)}},{from:"Array",to:"Matrix",convert:function(l){return i||SW(),new i(l)}},{from:"Matrix",to:"Array",convert:function(l){return l.valueOf()}}]),s.onMismatch=(o,l,u)=>{var c=s.createError(o,l,u);if(["wrongType","mismatch"].includes(c.data.category)&&l.length===1&&is(l[0])&&u.some(h=>!h.params.includes(","))){var f=new TypeError("Function '".concat(o,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(o,")'."));throw f.data=c.data,f}throw c},s.onMismatch=(o,l,u)=>{var c=s.createError(o,l,u);if(["wrongType","mismatch"].includes(c.data.category)&&l.length===1&&is(l[0])&&u.some(h=>!h.params.includes(","))){var f=new TypeError("Function '".concat(o,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(o,")'."));throw f.data=c.data,f}throw c},s});function tm(t){throw new Error("Cannot convert value ".concat(t," into a BigNumber: no class 'BigNumber' provided"))}function rm(t){throw new Error("Cannot convert value ".concat(t," into a Complex number: no class 'Complex' provided"))}function SW(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function nm(t){throw new Error("Cannot convert value ".concat(t," into a Fraction, no class 'Fraction' provided."))}var DW="ResultSet",CW=[],TW=ee(DW,CW,()=>{function t(e){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this.entries=e||[]}return t.prototype.type="ResultSet",t.prototype.isResultSet=!0,t.prototype.valueOf=function(){return this.entries},t.prototype.toString=function(){return"["+this.entries.map(String).join(", ")+"]"},t.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},t.fromJSON=function(e){return new t(e.entries)},t},{isClass:!0});/*!
 *  decimal.js v10.5.0
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var Bf=9e15,xl=1e9,R1="0123456789abcdef",dv="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",pv="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",P1={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Bf,maxE:Bf,crypto:!1},eI,lu,ar=!0,ag="[DecimalError] ",dl=ag+"Invalid argument: ",tI=ag+"Precision limit exceeded",rI=ag+"crypto unavailable",nI="[object Decimal]",Ri=Math.floor,Kn=Math.pow,NW=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,MW=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,IW=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,iI=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ls=1e7,Vt=7,FW=9007199254740991,OW=dv.length-1,$1=pv.length-1,ut={toStringTag:nI};ut.absoluteValue=ut.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),zt(t)};ut.ceil=function(){return zt(new this.constructor(this),this.e+1,2)};ut.clampedTo=ut.clamp=function(t,e){var r,n=this,i=n.constructor;if(t=new i(t),e=new i(e),!t.s||!e.s)return new i(NaN);if(t.gt(e))throw Error(dl+e);return r=n.cmp(t),r<0?t:n.cmp(e)>0?e:new i(n)};ut.comparedTo=ut.cmp=function(t){var e,r,n,i,a=this,s=a.d,o=(t=new a.constructor(t)).d,l=a.s,u=t.s;if(!s||!o)return!l||!u?NaN:l!==u?l:s===o?0:!s^l<0?1:-1;if(!s[0]||!o[0])return s[0]?l:o[0]?-u:0;if(l!==u)return l;if(a.e!==t.e)return a.e>t.e^l<0?1:-1;for(n=s.length,i=o.length,e=0,r=n<i?n:i;e<r;++e)if(s[e]!==o[e])return s[e]>o[e]^l<0?1:-1;return n===i?0:n>i^l<0?1:-1};ut.cosine=ut.cos=function(){var t,e,r=this,n=r.constructor;return r.d?r.d[0]?(t=n.precision,e=n.rounding,n.precision=t+Math.max(r.e,r.sd())+Vt,n.rounding=1,r=BW(n,lI(n,r)),n.precision=t,n.rounding=e,zt(lu==2||lu==3?r.neg():r,t,e,!0)):new n(1):new n(NaN)};ut.cubeRoot=ut.cbrt=function(){var t,e,r,n,i,a,s,o,l,u,c=this,f=c.constructor;if(!c.isFinite()||c.isZero())return new f(c);for(ar=!1,a=c.s*Kn(c.s*c,1/3),!a||Math.abs(a)==1/0?(r=yi(c.d),t=c.e,(a=(t-r.length+1)%3)&&(r+=a==1||a==-2?"0":"00"),a=Kn(r,1/3),t=Ri((t+1)/3)-(t%3==(t<0?-1:2)),a==1/0?r="5e"+t:(r=a.toExponential(),r=r.slice(0,r.indexOf("e")+1)+t),n=new f(r),n.s=c.s):n=new f(a.toString()),s=(t=f.precision)+3;;)if(o=n,l=o.times(o).times(o),u=l.plus(c),n=cn(u.plus(c).times(o),u.plus(l),s+2,1),yi(o.d).slice(0,s)===(r=yi(n.d)).slice(0,s))if(r=r.slice(s-3,s+1),r=="9999"||!i&&r=="4999"){if(!i&&(zt(o,t+1,0),o.times(o).times(o).eq(c))){n=o;break}s+=4,i=1}else{(!+r||!+r.slice(1)&&r.charAt(0)=="5")&&(zt(n,t+1,1),e=!n.times(n).times(n).eq(c));break}return ar=!0,zt(n,t,f.rounding,e)};ut.decimalPlaces=ut.dp=function(){var t,e=this.d,r=NaN;if(e){if(t=e.length-1,r=(t-Ri(this.e/Vt))*Vt,t=e[t],t)for(;t%10==0;t/=10)r--;r<0&&(r=0)}return r};ut.dividedBy=ut.div=function(t){return cn(this,new this.constructor(t))};ut.dividedToIntegerBy=ut.divToInt=function(t){var e=this,r=e.constructor;return zt(cn(e,new r(t),0,1,1),r.precision,r.rounding)};ut.equals=ut.eq=function(t){return this.cmp(t)===0};ut.floor=function(){return zt(new this.constructor(this),this.e+1,3)};ut.greaterThan=ut.gt=function(t){return this.cmp(t)>0};ut.greaterThanOrEqualTo=ut.gte=function(t){var e=this.cmp(t);return e==1||e===0};ut.hyperbolicCosine=ut.cosh=function(){var t,e,r,n,i,a=this,s=a.constructor,o=new s(1);if(!a.isFinite())return new s(a.s?1/0:NaN);if(a.isZero())return o;r=s.precision,n=s.rounding,s.precision=r+Math.max(a.e,a.sd())+4,s.rounding=1,i=a.d.length,i<32?(t=Math.ceil(i/3),e=(1/og(4,t)).toString()):(t=16,e="2.3283064365386962890625e-10"),a=rh(s,1,a.times(e),new s(1),!0);for(var l,u=t,c=new s(8);u--;)l=a.times(a),a=o.minus(l.times(c.minus(l.times(c))));return zt(a,s.precision=r,s.rounding=n,!0)};ut.hyperbolicSine=ut.sinh=function(){var t,e,r,n,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,r=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,n=i.d.length,n<3)i=rh(a,2,i,i,!0);else{t=1.4*Math.sqrt(n),t=t>16?16:t|0,i=i.times(1/og(5,t)),i=rh(a,2,i,i,!0);for(var s,o=new a(5),l=new a(16),u=new a(20);t--;)s=i.times(i),i=i.times(o.plus(s.times(l.times(s).plus(u))))}return a.precision=e,a.rounding=r,zt(i,e,r,!0)};ut.hyperbolicTangent=ut.tanh=function(){var t,e,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+7,n.rounding=1,cn(r.sinh(),r.cosh(),n.precision=t,n.rounding=e)):new n(r.s)};ut.inverseCosine=ut.acos=function(){var t=this,e=t.constructor,r=t.abs().cmp(1),n=e.precision,i=e.rounding;return r!==-1?r===0?t.isNeg()?mo(e,n,i):new e(0):new e(NaN):t.isZero()?mo(e,n+4,i).times(.5):(e.precision=n+6,e.rounding=1,t=new e(1).minus(t).div(t.plus(1)).sqrt().atan(),e.precision=n,e.rounding=i,t.times(2))};ut.inverseHyperbolicCosine=ut.acosh=function(){var t,e,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(t=n.precision,e=n.rounding,n.precision=t+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,ar=!1,r=r.times(r).minus(1).sqrt().plus(r),ar=!0,n.precision=t,n.rounding=e,r.ln()):new n(r)};ut.inverseHyperbolicSine=ut.asinh=function(){var t,e,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,ar=!1,r=r.times(r).plus(1).sqrt().plus(r),ar=!0,n.precision=t,n.rounding=e,r.ln())};ut.inverseHyperbolicTangent=ut.atanh=function(){var t,e,r,n,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=a.precision,e=a.rounding,n=i.sd(),Math.max(n,t)<2*-i.e-1?zt(new a(i),t,e,!0):(a.precision=r=n-i.e,i=cn(i.plus(1),new a(1).minus(i),r+t,1),a.precision=t+4,a.rounding=1,i=i.ln(),a.precision=t,a.rounding=e,i.times(.5))):new a(NaN)};ut.inverseSine=ut.asin=function(){var t,e,r,n,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),r=a.precision,n=a.rounding,e!==-1?e===0?(t=mo(a,r+4,n).times(.5),t.s=i.s,t):new a(NaN):(a.precision=r+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=r,a.rounding=n,i.times(2)))};ut.inverseTangent=ut.atan=function(){var t,e,r,n,i,a,s,o,l,u=this,c=u.constructor,f=c.precision,h=c.rounding;if(u.isFinite()){if(u.isZero())return new c(u);if(u.abs().eq(1)&&f+4<=$1)return s=mo(c,f+4,h).times(.25),s.s=u.s,s}else{if(!u.s)return new c(NaN);if(f+4<=$1)return s=mo(c,f+4,h).times(.5),s.s=u.s,s}for(c.precision=o=f+10,c.rounding=1,r=Math.min(28,o/Vt+2|0),t=r;t;--t)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(ar=!1,e=Math.ceil(o/Vt),n=1,l=u.times(u),s=new c(u),i=u;t!==-1;)if(i=i.times(l),a=s.minus(i.div(n+=2)),i=i.times(l),s=a.plus(i.div(n+=2)),s.d[e]!==void 0)for(t=e;s.d[t]===a.d[t]&&t--;);return r&&(s=s.times(2<<r-1)),ar=!0,zt(s,c.precision=f,c.rounding=h,!0)};ut.isFinite=function(){return!!this.d};ut.isInteger=ut.isInt=function(){return!!this.d&&Ri(this.e/Vt)>this.d.length-2};ut.isNaN=function(){return!this.s};ut.isNegative=ut.isNeg=function(){return this.s<0};ut.isPositive=ut.isPos=function(){return this.s>0};ut.isZero=function(){return!!this.d&&this.d[0]===0};ut.lessThan=ut.lt=function(t){return this.cmp(t)<0};ut.lessThanOrEqualTo=ut.lte=function(t){return this.cmp(t)<1};ut.logarithm=ut.log=function(t){var e,r,n,i,a,s,o,l,u=this,c=u.constructor,f=c.precision,h=c.rounding,p=5;if(t==null)t=new c(10),e=!0;else{if(t=new c(t),r=t.d,t.s<0||!r||!r[0]||t.eq(1))return new c(NaN);e=t.eq(10)}if(r=u.d,u.s<0||!r||!r[0]||u.eq(1))return new c(r&&!r[0]?-1/0:u.s!=1?NaN:r?0:1/0);if(e)if(r.length>1)a=!0;else{for(i=r[0];i%10===0;)i/=10;a=i!==1}if(ar=!1,o=f+p,s=il(u,o),n=e?mv(c,o+10):il(t,o),l=cn(s,n,o,1),Md(l.d,i=f,h))do if(o+=10,s=il(u,o),n=e?mv(c,o+10):il(t,o),l=cn(s,n,o,1),!a){+yi(l.d).slice(i+1,i+15)+1==1e14&&(l=zt(l,f+1,0));break}while(Md(l.d,i+=10,h));return ar=!0,zt(l,f,h)};ut.minus=ut.sub=function(t){var e,r,n,i,a,s,o,l,u,c,f,h,p=this,m=p.constructor;if(t=new m(t),!p.d||!t.d)return!p.s||!t.s?t=new m(NaN):p.d?t.s=-t.s:t=new m(t.d||p.s!==t.s?p:NaN),t;if(p.s!=t.s)return t.s=-t.s,p.plus(t);if(u=p.d,h=t.d,o=m.precision,l=m.rounding,!u[0]||!h[0]){if(h[0])t.s=-t.s;else if(u[0])t=new m(p);else return new m(l===3?-0:0);return ar?zt(t,o,l):t}if(r=Ri(t.e/Vt),c=Ri(p.e/Vt),u=u.slice(),a=c-r,a){for(f=a<0,f?(e=u,a=-a,s=h.length):(e=h,r=c,s=u.length),n=Math.max(Math.ceil(o/Vt),s)+2,a>n&&(a=n,e.length=1),e.reverse(),n=a;n--;)e.push(0);e.reverse()}else{for(n=u.length,s=h.length,f=n<s,f&&(s=n),n=0;n<s;n++)if(u[n]!=h[n]){f=u[n]<h[n];break}a=0}for(f&&(e=u,u=h,h=e,t.s=-t.s),s=u.length,n=h.length-s;n>0;--n)u[s++]=0;for(n=h.length;n>a;){if(u[--n]<h[n]){for(i=n;i&&u[--i]===0;)u[i]=Ls-1;--u[i],u[n]+=Ls}u[n]-=h[n]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--r;return u[0]?(t.d=u,t.e=sg(u,r),ar?zt(t,o,l):t):new m(l===3?-0:0)};ut.modulo=ut.mod=function(t){var e,r=this,n=r.constructor;return t=new n(t),!r.d||!t.s||t.d&&!t.d[0]?new n(NaN):!t.d||r.d&&!r.d[0]?zt(new n(r),n.precision,n.rounding):(ar=!1,n.modulo==9?(e=cn(r,t.abs(),0,3,1),e.s*=t.s):e=cn(r,t,0,n.modulo,1),e=e.times(t),ar=!0,r.minus(e))};ut.naturalExponential=ut.exp=function(){return k1(this)};ut.naturalLogarithm=ut.ln=function(){return il(this)};ut.negated=ut.neg=function(){var t=new this.constructor(this);return t.s=-t.s,zt(t)};ut.plus=ut.add=function(t){var e,r,n,i,a,s,o,l,u,c,f=this,h=f.constructor;if(t=new h(t),!f.d||!t.d)return!f.s||!t.s?t=new h(NaN):f.d||(t=new h(t.d||f.s===t.s?f:NaN)),t;if(f.s!=t.s)return t.s=-t.s,f.minus(t);if(u=f.d,c=t.d,o=h.precision,l=h.rounding,!u[0]||!c[0])return c[0]||(t=new h(f)),ar?zt(t,o,l):t;if(a=Ri(f.e/Vt),n=Ri(t.e/Vt),u=u.slice(),i=a-n,i){for(i<0?(r=u,i=-i,s=c.length):(r=c,n=a,s=u.length),a=Math.ceil(o/Vt),s=a>s?a+1:s+1,i>s&&(i=s,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for(s=u.length,i=c.length,s-i<0&&(i=s,r=c,c=u,u=r),e=0;i;)e=(u[--i]=u[i]+c[i]+e)/Ls|0,u[i]%=Ls;for(e&&(u.unshift(e),++n),s=u.length;u[--s]==0;)u.pop();return t.d=u,t.e=sg(u,n),ar?zt(t,o,l):t};ut.precision=ut.sd=function(t){var e,r=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(dl+t);return r.d?(e=aI(r.d),t&&r.e+1>e&&(e=r.e+1)):e=NaN,e};ut.round=function(){var t=this,e=t.constructor;return zt(new e(t),t.e+1,e.rounding)};ut.sine=ut.sin=function(){var t,e,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+Math.max(r.e,r.sd())+Vt,n.rounding=1,r=PW(n,lI(n,r)),n.precision=t,n.rounding=e,zt(lu>2?r.neg():r,t,e,!0)):new n(NaN)};ut.squareRoot=ut.sqrt=function(){var t,e,r,n,i,a,s=this,o=s.d,l=s.e,u=s.s,c=s.constructor;if(u!==1||!o||!o[0])return new c(!u||u<0&&(!o||o[0])?NaN:o?s:1/0);for(ar=!1,u=Math.sqrt(+s),u==0||u==1/0?(e=yi(o),(e.length+l)%2==0&&(e+="0"),u=Math.sqrt(e),l=Ri((l+1)/2)-(l<0||l%2),u==1/0?e="5e"+l:(e=u.toExponential(),e=e.slice(0,e.indexOf("e")+1)+l),n=new c(e)):n=new c(u.toString()),r=(l=c.precision)+3;;)if(a=n,n=a.plus(cn(s,a,r+2,1)).times(.5),yi(a.d).slice(0,r)===(e=yi(n.d)).slice(0,r))if(e=e.slice(r-3,r+1),e=="9999"||!i&&e=="4999"){if(!i&&(zt(a,l+1,0),a.times(a).eq(s))){n=a;break}r+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(zt(n,l+1,1),t=!n.times(n).eq(s));break}return ar=!0,zt(n,l,c.rounding,t)};ut.tangent=ut.tan=function(){var t,e,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(t=n.precision,e=n.rounding,n.precision=t+10,n.rounding=1,r=r.sin(),r.s=1,r=cn(r,new n(1).minus(r.times(r)).sqrt(),t+10,0),n.precision=t,n.rounding=e,zt(lu==2||lu==4?r.neg():r,t,e,!0)):new n(NaN)};ut.times=ut.mul=function(t){var e,r,n,i,a,s,o,l,u,c=this,f=c.constructor,h=c.d,p=(t=new f(t)).d;if(t.s*=c.s,!h||!h[0]||!p||!p[0])return new f(!t.s||h&&!h[0]&&!p||p&&!p[0]&&!h?NaN:!h||!p?t.s/0:t.s*0);for(r=Ri(c.e/Vt)+Ri(t.e/Vt),l=h.length,u=p.length,l<u&&(a=h,h=p,p=a,s=l,l=u,u=s),a=[],s=l+u,n=s;n--;)a.push(0);for(n=u;--n>=0;){for(e=0,i=l+n;i>n;)o=a[i]+p[n]*h[i-n-1]+e,a[i--]=o%Ls|0,e=o/Ls|0;a[i]=(a[i]+e)%Ls|0}for(;!a[--s];)a.pop();return e?++r:a.shift(),t.d=a,t.e=sg(a,r),ar?zt(t,f.precision,f.rounding):t};ut.toBinary=function(t,e){return qb(this,2,t,e)};ut.toDecimalPlaces=ut.toDP=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(va(t,0,xl),e===void 0?e=n.rounding:va(e,0,8),zt(r,t+r.e+1,e))};ut.toExponential=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=wo(n,!0):(va(t,0,xl),e===void 0?e=i.rounding:va(e,0,8),n=zt(new i(n),t+1,e),r=wo(n,!0,t+1)),n.isNeg()&&!n.isZero()?"-"+r:r};ut.toFixed=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?r=wo(i):(va(t,0,xl),e===void 0?e=a.rounding:va(e,0,8),n=zt(new a(i),t+i.e+1,e),r=wo(n,!1,t+n.e+1)),i.isNeg()&&!i.isZero()?"-"+r:r};ut.toFraction=function(t){var e,r,n,i,a,s,o,l,u,c,f,h,p=this,m=p.d,v=p.constructor;if(!m)return new v(p);if(u=r=new v(1),n=l=new v(0),e=new v(n),a=e.e=aI(m)-p.e-1,s=a%Vt,e.d[0]=Kn(10,s<0?Vt+s:s),t==null)t=a>0?e:u;else{if(o=new v(t),!o.isInt()||o.lt(u))throw Error(dl+o);t=o.gt(e)?a>0?e:u:o}for(ar=!1,o=new v(yi(m)),c=v.precision,v.precision=a=m.length*Vt*2;f=cn(o,e,0,1,1),i=r.plus(f.times(n)),i.cmp(t)!=1;)r=n,n=i,i=u,u=l.plus(f.times(i)),l=i,i=e,e=o.minus(f.times(i)),o=i;return i=cn(t.minus(r),n,0,1,1),l=l.plus(i.times(u)),r=r.plus(i.times(n)),l.s=u.s=p.s,h=cn(u,n,a,1).minus(p).abs().cmp(cn(l,r,a,1).minus(p).abs())<1?[u,n]:[l,r],v.precision=c,ar=!0,h};ut.toHexadecimal=ut.toHex=function(t,e){return qb(this,16,t,e)};ut.toNearest=function(t,e){var r=this,n=r.constructor;if(r=new n(r),t==null){if(!r.d)return r;t=new n(1),e=n.rounding}else{if(t=new n(t),e===void 0?e=n.rounding:va(e,0,8),!r.d)return t.s?r:t;if(!t.d)return t.s&&(t.s=r.s),t}return t.d[0]?(ar=!1,r=cn(r,t,0,e,1).times(t),ar=!0,zt(r)):(t.s=r.s,r=t),r};ut.toNumber=function(){return+this};ut.toOctal=function(t,e){return qb(this,8,t,e)};ut.toPower=ut.pow=function(t){var e,r,n,i,a,s,o=this,l=o.constructor,u=+(t=new l(t));if(!o.d||!t.d||!o.d[0]||!t.d[0])return new l(Kn(+o,u));if(o=new l(o),o.eq(1))return o;if(n=l.precision,a=l.rounding,t.eq(1))return zt(o,n,a);if(e=Ri(t.e/Vt),e>=t.d.length-1&&(r=u<0?-u:u)<=FW)return i=sI(l,o,r,n),t.s<0?new l(1).div(i):zt(i,n,a);if(s=o.s,s<0){if(e<t.d.length-1)return new l(NaN);if(t.d[e]&1||(s=1),o.e==0&&o.d[0]==1&&o.d.length==1)return o.s=s,o}return r=Kn(+o,u),e=r==0||!isFinite(r)?Ri(u*(Math.log("0."+yi(o.d))/Math.LN10+o.e+1)):new l(r+"").e,e>l.maxE+1||e<l.minE-1?new l(e>0?s/0:0):(ar=!1,l.rounding=o.s=1,r=Math.min(12,(e+"").length),i=k1(t.times(il(o,n+r)),n),i.d&&(i=zt(i,n+5,1),Md(i.d,n,a)&&(e=n+10,i=zt(k1(t.times(il(o,e+r)),e),e+5,1),+yi(i.d).slice(n+1,n+15)+1==1e14&&(i=zt(i,n+1,0)))),i.s=s,ar=!0,l.rounding=a,zt(i,n,a))};ut.toPrecision=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=wo(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(va(t,1,xl),e===void 0?e=i.rounding:va(e,0,8),n=zt(new i(n),t,e),r=wo(n,t<=n.e||n.e<=i.toExpNeg,t)),n.isNeg()&&!n.isZero()?"-"+r:r};ut.toSignificantDigits=ut.toSD=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(va(t,1,xl),e===void 0?e=n.rounding:va(e,0,8)),zt(new n(r),t,e)};ut.toString=function(){var t=this,e=t.constructor,r=wo(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+r:r};ut.truncated=ut.trunc=function(){return zt(new this.constructor(this),this.e+1,1)};ut.valueOf=ut.toJSON=function(){var t=this,e=t.constructor,r=wo(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+r:r};function yi(t){var e,r,n,i=t.length-1,a="",s=t[0];if(i>0){for(a+=s,e=1;e<i;e++)n=t[e]+"",r=Vt-n.length,r&&(a+=Yu(r)),a+=n;s=t[e],n=s+"",r=Vt-n.length,r&&(a+=Yu(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}function va(t,e,r){if(t!==~~t||t<e||t>r)throw Error(dl+t)}function Md(t,e,r,n){var i,a,s,o;for(a=t[0];a>=10;a/=10)--e;return--e<0?(e+=Vt,i=0):(i=Math.ceil((e+1)/Vt),e%=Vt),a=Kn(10,Vt-e),o=t[i]%a|0,n==null?e<3?(e==0?o=o/100|0:e==1&&(o=o/10|0),s=r<4&&o==99999||r>3&&o==49999||o==5e4||o==0):s=(r<4&&o+1==a||r>3&&o+1==a/2)&&(t[i+1]/a/100|0)==Kn(10,e-2)-1||(o==a/2||o==0)&&(t[i+1]/a/100|0)==0:e<4?(e==0?o=o/1e3|0:e==1?o=o/100|0:e==2&&(o=o/10|0),s=(n||r<4)&&o==9999||!n&&r>3&&o==4999):s=((n||r<4)&&o+1==a||!n&&r>3&&o+1==a/2)&&(t[i+1]/a/1e3|0)==Kn(10,e-3)-1,s}function Gm(t,e,r){for(var n,i=[0],a,s=0,o=t.length;s<o;){for(a=i.length;a--;)i[a]*=e;for(i[0]+=R1.indexOf(t.charAt(s++)),n=0;n<i.length;n++)i[n]>r-1&&(i[n+1]===void 0&&(i[n+1]=0),i[n+1]+=i[n]/r|0,i[n]%=r)}return i.reverse()}function BW(t,e){var r,n,i;if(e.isZero())return e;n=e.d.length,n<32?(r=Math.ceil(n/3),i=(1/og(4,r)).toString()):(r=16,i="2.3283064365386962890625e-10"),t.precision+=r,e=rh(t,1,e.times(i),new t(1));for(var a=r;a--;){var s=e.times(e);e=s.times(s).minus(s).times(8).plus(1)}return t.precision-=r,e}var cn=function(){function t(n,i,a){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*i+o,n[l]=s%a|0,o=s/a|0;return o&&n.unshift(o),n}function e(n,i,a,s){var o,l;if(a!=s)l=a>s?1:-1;else for(o=l=0;o<a;o++)if(n[o]!=i[o]){l=n[o]>i[o]?1:-1;break}return l}function r(n,i,a,s){for(var o=0;a--;)n[a]-=o,o=n[a]<i[a]?1:0,n[a]=o*s+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,s,o,l){var u,c,f,h,p,m,v,y,x,S,b,A,E,_,T,M,N,I,F,P,U=n.constructor,G=n.s==i.s?1:-1,V=n.d,$=i.d;if(!V||!V[0]||!$||!$[0])return new U(!n.s||!i.s||(V?$&&V[0]==$[0]:!$)?NaN:V&&V[0]==0||!$?G*0:G/0);for(l?(p=1,c=n.e-i.e):(l=Ls,p=Vt,c=Ri(n.e/p)-Ri(i.e/p)),F=$.length,N=V.length,x=new U(G),S=x.d=[],f=0;$[f]==(V[f]||0);f++);if($[f]>(V[f]||0)&&c--,a==null?(_=a=U.precision,s=U.rounding):o?_=a+(n.e-i.e)+1:_=a,_<0)S.push(1),m=!0;else{if(_=_/p+2|0,f=0,F==1){for(h=0,$=$[0],_++;(f<N||h)&&_--;f++)T=h*l+(V[f]||0),S[f]=T/$|0,h=T%$|0;m=h||f<N}else{for(h=l/($[0]+1)|0,h>1&&($=t($,h,l),V=t(V,h,l),F=$.length,N=V.length),M=F,b=V.slice(0,F),A=b.length;A<F;)b[A++]=0;P=$.slice(),P.unshift(0),I=$[0],$[1]>=l/2&&++I;do h=0,u=e($,b,F,A),u<0?(E=b[0],F!=A&&(E=E*l+(b[1]||0)),h=E/I|0,h>1?(h>=l&&(h=l-1),v=t($,h,l),y=v.length,A=b.length,u=e(v,b,y,A),u==1&&(h--,r(v,F<y?P:$,y,l))):(h==0&&(u=h=1),v=$.slice()),y=v.length,y<A&&v.unshift(0),r(b,v,A,l),u==-1&&(A=b.length,u=e($,b,F,A),u<1&&(h++,r(b,F<A?P:$,A,l))),A=b.length):u===0&&(h++,b=[0]),S[f++]=h,u&&b[0]?b[A++]=V[M]||0:(b=[V[M]],A=1);while((M++<N||b[0]!==void 0)&&_--);m=b[0]!==void 0}S[0]||S.shift()}if(p==1)x.e=c,eI=m;else{for(f=1,h=S[0];h>=10;h/=10)f++;x.e=f+c*p-1,zt(x,o?a+x.e+1:a,s,m)}return x}}();function zt(t,e,r,n){var i,a,s,o,l,u,c,f,h,p=t.constructor;e:if(e!=null){if(f=t.d,!f)return t;for(i=1,o=f[0];o>=10;o/=10)i++;if(a=e-i,a<0)a+=Vt,s=e,c=f[h=0],l=c/Kn(10,i-s-1)%10|0;else if(h=Math.ceil((a+1)/Vt),o=f.length,h>=o)if(n){for(;o++<=h;)f.push(0);c=l=0,i=1,a%=Vt,s=a-Vt+1}else break e;else{for(c=o=f[h],i=1;o>=10;o/=10)i++;a%=Vt,s=a-Vt+i,l=s<0?0:c/Kn(10,i-s-1)%10|0}if(n=n||e<0||f[h+1]!==void 0||(s<0?c:c%Kn(10,i-s-1)),u=r<4?(l||n)&&(r==0||r==(t.s<0?3:2)):l>5||l==5&&(r==4||n||r==6&&(a>0?s>0?c/Kn(10,i-s):0:f[h-1])%10&1||r==(t.s<0?8:7)),e<1||!f[0])return f.length=0,u?(e-=t.e+1,f[0]=Kn(10,(Vt-e%Vt)%Vt),t.e=-e||0):f[0]=t.e=0,t;if(a==0?(f.length=h,o=1,h--):(f.length=h+1,o=Kn(10,Vt-a),f[h]=s>0?(c/Kn(10,i-s)%Kn(10,s)|0)*o:0),u)for(;;)if(h==0){for(a=1,s=f[0];s>=10;s/=10)a++;for(s=f[0]+=o,o=1;s>=10;s/=10)o++;a!=o&&(t.e++,f[0]==Ls&&(f[0]=1));break}else{if(f[h]+=o,f[h]!=Ls)break;f[h--]=0,o=1}for(a=f.length;f[--a]===0;)f.pop()}return ar&&(t.e>p.maxE?(t.d=null,t.e=NaN):t.e<p.minE&&(t.e=0,t.d=[0])),t}function wo(t,e,r){if(!t.isFinite())return uI(t);var n,i=t.e,a=yi(t.d),s=a.length;return e?(r&&(n=r-s)>0?a=a.charAt(0)+"."+a.slice(1)+Yu(n):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(t.e<0?"e":"e+")+t.e):i<0?(a="0."+Yu(-i-1)+a,r&&(n=r-s)>0&&(a+=Yu(n))):i>=s?(a+=Yu(i+1-s),r&&(n=r-i-1)>0&&(a=a+"."+Yu(n))):((n=i+1)<s&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(a+="."),a+=Yu(n))),a}function sg(t,e){var r=t[0];for(e*=Vt;r>=10;r/=10)e++;return e}function mv(t,e,r){if(e>OW)throw ar=!0,r&&(t.precision=r),Error(tI);return zt(new t(dv),e,1,!0)}function mo(t,e,r){if(e>$1)throw Error(tI);return zt(new t(pv),e,r,!0)}function aI(t){var e=t.length-1,r=e*Vt+1;if(e=t[e],e){for(;e%10==0;e/=10)r--;for(e=t[0];e>=10;e/=10)r++}return r}function Yu(t){for(var e="";t--;)e+="0";return e}function sI(t,e,r,n){var i,a=new t(1),s=Math.ceil(n/Vt+4);for(ar=!1;;){if(r%2&&(a=a.times(e),ME(a.d,s)&&(i=!0)),r=Ri(r/2),r===0){r=a.d.length-1,i&&a.d[r]===0&&++a.d[r];break}e=e.times(e),ME(e.d,s)}return ar=!0,a}function NE(t){return t.d[t.d.length-1]&1}function oI(t,e,r){for(var n,i,a=new t(e[0]),s=0;++s<e.length;){if(i=new t(e[s]),!i.s){a=i;break}n=a.cmp(i),(n===r||n===0&&a.s===r)&&(a=i)}return a}function k1(t,e){var r,n,i,a,s,o,l,u=0,c=0,f=0,h=t.constructor,p=h.rounding,m=h.precision;if(!t.d||!t.d[0]||t.e>17)return new h(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(e==null?(ar=!1,l=m):l=e,o=new h(.03125);t.e>-2;)t=t.times(o),f+=5;for(n=Math.log(Kn(2,f))/Math.LN10*2+5|0,l+=n,r=a=s=new h(1),h.precision=l;;){if(a=zt(a.times(t),l,1),r=r.times(++c),o=s.plus(cn(a,r,l,1)),yi(o.d).slice(0,l)===yi(s.d).slice(0,l)){for(i=f;i--;)s=zt(s.times(s),l,1);if(e==null)if(u<3&&Md(s.d,l-n,p,u))h.precision=l+=10,r=a=o=new h(1),c=0,u++;else return zt(s,h.precision=m,p,ar=!0);else return h.precision=m,s}s=o}}function il(t,e){var r,n,i,a,s,o,l,u,c,f,h,p=1,m=10,v=t,y=v.d,x=v.constructor,S=x.rounding,b=x.precision;if(v.s<0||!y||!y[0]||!v.e&&y[0]==1&&y.length==1)return new x(y&&!y[0]?-1/0:v.s!=1?NaN:y?0:v);if(e==null?(ar=!1,c=b):c=e,x.precision=c+=m,r=yi(y),n=r.charAt(0),Math.abs(a=v.e)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)v=v.times(t),r=yi(v.d),n=r.charAt(0),p++;a=v.e,n>1?(v=new x("0."+r),a++):v=new x(n+"."+r.slice(1))}else return u=mv(x,c+2,b).times(a+""),v=il(new x(n+"."+r.slice(1)),c-m).plus(u),x.precision=b,e==null?zt(v,b,S,ar=!0):v;for(f=v,l=s=v=cn(v.minus(1),v.plus(1),c,1),h=zt(v.times(v),c,1),i=3;;){if(s=zt(s.times(h),c,1),u=l.plus(cn(s,new x(i),c,1)),yi(u.d).slice(0,c)===yi(l.d).slice(0,c))if(l=l.times(2),a!==0&&(l=l.plus(mv(x,c+2,b).times(a+""))),l=cn(l,new x(p),c,1),e==null)if(Md(l.d,c-m,S,o))x.precision=c+=m,u=s=v=cn(f.minus(1),f.plus(1),c,1),h=zt(v.times(v),c,1),i=o=1;else return zt(l,x.precision=b,S,ar=!0);else return x.precision=b,l;l=u,i+=2}}function uI(t){return String(t.s*t.s/0)}function qm(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;n++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(n,i),e){if(i-=n,t.e=r=r-n-1,t.d=[],n=(r+1)%Vt,r<0&&(n+=Vt),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=Vt;n<i;)t.d.push(+e.slice(n,n+=Vt));e=e.slice(n),n=Vt-e.length}else n-=i;for(;n--;)e+="0";t.d.push(+e),ar&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function RW(t,e){var r,n,i,a,s,o,l,u,c;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),iI.test(e))return qm(t,e)}else if(e==="Infinity"||e==="NaN")return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(MW.test(e))r=16,e=e.toLowerCase();else if(NW.test(e))r=2;else if(IW.test(e))r=8;else throw Error(dl+e);for(a=e.search(/p/i),a>0?(l=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),s=a>=0,n=t.constructor,s&&(e=e.replace(".",""),o=e.length,a=o-a,i=sI(n,new n(r),a,a*2)),u=Gm(e,r,Ls),c=u.length-1,a=c;u[a]===0;--a)u.pop();return a<0?new n(t.s*0):(t.e=sg(u,c),t.d=u,ar=!1,s&&(t=cn(t,i,o*4)),l&&(t=t.times(Math.abs(l)<54?Kn(2,l):pl.pow(2,l))),ar=!0,t)}function PW(t,e){var r,n=e.d.length;if(n<3)return e.isZero()?e:rh(t,2,e,e);r=1.4*Math.sqrt(n),r=r>16?16:r|0,e=e.times(1/og(5,r)),e=rh(t,2,e,e);for(var i,a=new t(5),s=new t(16),o=new t(20);r--;)i=e.times(e),e=e.times(a.plus(i.times(s.times(i).minus(o))));return e}function rh(t,e,r,n,i){var a,s,o,l,u=t.precision,c=Math.ceil(u/Vt);for(ar=!1,l=r.times(r),o=new t(n);;){if(s=cn(o.times(l),new t(e++*e++),u,1),o=i?n.plus(s):n.minus(s),n=cn(s.times(l),new t(e++*e++),u,1),s=o.plus(n),s.d[c]!==void 0){for(a=c;s.d[a]===o.d[a]&&a--;);if(a==-1)break}a=o,o=n,n=s,s=a}return ar=!0,s.d.length=c+1,s}function og(t,e){for(var r=t;--e;)r*=t;return r}function lI(t,e){var r,n=e.s<0,i=mo(t,t.precision,1),a=i.times(.5);if(e=e.abs(),e.lte(a))return lu=n?4:1,e;if(r=e.divToInt(i),r.isZero())lu=n?3:2;else{if(e=e.minus(r.times(i)),e.lte(a))return lu=NE(r)?n?2:3:n?4:1,e;lu=NE(r)?n?1:4:n?3:2}return e.minus(i).abs()}function qb(t,e,r,n){var i,a,s,o,l,u,c,f,h,p=t.constructor,m=r!==void 0;if(m?(va(r,1,xl),n===void 0?n=p.rounding:va(n,0,8)):(r=p.precision,n=p.rounding),!t.isFinite())c=uI(t);else{for(c=wo(t),s=c.indexOf("."),m?(i=2,e==16?r=r*4-3:e==8&&(r=r*3-2)):i=e,s>=0&&(c=c.replace(".",""),h=new p(1),h.e=c.length-s,h.d=Gm(wo(h),10,i),h.e=h.d.length),f=Gm(c,10,i),a=l=f.length;f[--l]==0;)f.pop();if(!f[0])c=m?"0p+0":"0";else{if(s<0?a--:(t=new p(t),t.d=f,t.e=a,t=cn(t,h,r,n,0,i),f=t.d,a=t.e,u=eI),s=f[r],o=i/2,u=u||f[r+1]!==void 0,u=n<4?(s!==void 0||u)&&(n===0||n===(t.s<0?3:2)):s>o||s===o&&(n===4||u||n===6&&f[r-1]&1||n===(t.s<0?8:7)),f.length=r,u)for(;++f[--r]>i-1;)f[r]=0,r||(++a,f.unshift(1));for(l=f.length;!f[l-1];--l);for(s=0,c="";s<l;s++)c+=R1.charAt(f[s]);if(m){if(l>1)if(e==16||e==8){for(s=e==16?4:3,--l;l%s;l++)c+="0";for(f=Gm(c,i,e),l=f.length;!f[l-1];--l);for(s=1,c="1.";s<l;s++)c+=R1.charAt(f[s])}else c=c.charAt(0)+"."+c.slice(1);c=c+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)c="0"+c;c="0."+c}else if(++a>l)for(a-=l;a--;)c+="0";else a<l&&(c=c.slice(0,a)+"."+c.slice(a))}c=(e==16?"0x":e==2?"0b":e==8?"0o":"")+c}return t.s<0?"-"+c:c}function ME(t,e){if(t.length>e)return t.length=e,!0}function $W(t){return new this(t).abs()}function kW(t){return new this(t).acos()}function LW(t){return new this(t).acosh()}function UW(t,e){return new this(t).plus(e)}function zW(t){return new this(t).asin()}function GW(t){return new this(t).asinh()}function qW(t){return new this(t).atan()}function HW(t){return new this(t).atanh()}function WW(t,e){t=new this(t),e=new this(e);var r,n=this.precision,i=this.rounding,a=n+4;return!t.s||!e.s?r=new this(NaN):!t.d&&!e.d?(r=mo(this,a,1).times(e.s>0?.25:.75),r.s=t.s):!e.d||t.isZero()?(r=e.s<0?mo(this,n,i):new this(0),r.s=t.s):!t.d||e.isZero()?(r=mo(this,a,1).times(.5),r.s=t.s):e.s<0?(this.precision=a,this.rounding=1,r=this.atan(cn(t,e,a,1)),e=mo(this,a,1),this.precision=n,this.rounding=i,r=t.s<0?r.minus(e):r.plus(e)):r=this.atan(cn(t,e,a,1)),r}function VW(t){return new this(t).cbrt()}function XW(t){return zt(t=new this(t),t.e+1,2)}function jW(t,e,r){return new this(t).clamp(e,r)}function YW(t){if(!t||typeof t!="object")throw Error(ag+"Object expected");var e,r,n,i=t.defaults===!0,a=["precision",1,xl,"rounding",0,8,"toExpNeg",-Bf,0,"toExpPos",0,Bf,"maxE",0,Bf,"minE",-Bf,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(r=a[e],i&&(this[r]=P1[r]),(n=t[r])!==void 0)if(Ri(n)===n&&n>=a[e+1]&&n<=a[e+2])this[r]=n;else throw Error(dl+r+": "+n);if(r="crypto",i&&(this[r]=P1[r]),(n=t[r])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[r]=!0;else throw Error(rI);else this[r]=!1;else throw Error(dl+r+": "+n);return this}function KW(t){return new this(t).cos()}function ZW(t){return new this(t).cosh()}function cI(t){var e,r,n;function i(a){var s,o,l,u=this;if(!(u instanceof i))return new i(a);if(u.constructor=i,IE(a)){u.s=a.s,ar?!a.d||a.e>i.maxE?(u.e=NaN,u.d=null):a.e<i.minE?(u.e=0,u.d=[0]):(u.e=a.e,u.d=a.d.slice()):(u.e=a.e,u.d=a.d?a.d.slice():a.d);return}if(l=typeof a,l==="number"){if(a===0){u.s=1/a<0?-1:1,u.e=0,u.d=[0];return}if(a<0?(a=-a,u.s=-1):u.s=1,a===~~a&&a<1e7){for(s=0,o=a;o>=10;o/=10)s++;ar?s>i.maxE?(u.e=NaN,u.d=null):s<i.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[a]):(u.e=s,u.d=[a]);return}if(a*0!==0){a||(u.s=NaN),u.e=NaN,u.d=null;return}return qm(u,a.toString())}if(l==="string")return(o=a.charCodeAt(0))===45?(a=a.slice(1),u.s=-1):(o===43&&(a=a.slice(1)),u.s=1),iI.test(a)?qm(u,a):RW(u,a);if(l==="bigint")return a<0?(a=-a,u.s=-1):u.s=1,qm(u,a.toString());throw Error(dl+a)}if(i.prototype=ut,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=YW,i.clone=cI,i.isDecimal=IE,i.abs=$W,i.acos=kW,i.acosh=LW,i.add=UW,i.asin=zW,i.asinh=GW,i.atan=qW,i.atanh=HW,i.atan2=WW,i.cbrt=VW,i.ceil=XW,i.clamp=jW,i.cos=KW,i.cosh=ZW,i.div=QW,i.exp=JW,i.floor=eV,i.hypot=tV,i.ln=rV,i.log=nV,i.log10=aV,i.log2=iV,i.max=sV,i.min=oV,i.mod=uV,i.mul=lV,i.pow=cV,i.random=fV,i.round=hV,i.sign=dV,i.sin=pV,i.sinh=mV,i.sqrt=vV,i.sub=gV,i.sum=yV,i.tan=bV,i.tanh=xV,i.trunc=wV,t===void 0&&(t={}),t&&t.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return i.config(t),i}function QW(t,e){return new this(t).div(e)}function JW(t){return new this(t).exp()}function eV(t){return zt(t=new this(t),t.e+1,3)}function tV(){var t,e,r=new this(0);for(ar=!1,t=0;t<arguments.length;)if(e=new this(arguments[t++]),e.d)r.d&&(r=r.plus(e.times(e)));else{if(e.s)return ar=!0,new this(1/0);r=e}return ar=!0,r.sqrt()}function IE(t){return t instanceof pl||t&&t.toStringTag===nI||!1}function rV(t){return new this(t).ln()}function nV(t,e){return new this(t).log(e)}function iV(t){return new this(t).log(2)}function aV(t){return new this(t).log(10)}function sV(){return oI(this,arguments,-1)}function oV(){return oI(this,arguments,1)}function uV(t,e){return new this(t).mod(e)}function lV(t,e){return new this(t).mul(e)}function cV(t,e){return new this(t).pow(e)}function fV(t){var e,r,n,i,a=0,s=new this(1),o=[];if(t===void 0?t=this.precision:va(t,1,xl),n=Math.ceil(t/Vt),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(n));a<n;)i=e[a],i>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:o[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(n*=4);a<n;)i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,a):(o.push(i%1e7),a+=4);a=n/4}else throw Error(rI);else for(;a<n;)o[a++]=Math.random()*1e7|0;for(n=o[--a],t%=Vt,n&&t&&(i=Kn(10,Vt-t),o[a]=(n/i|0)*i);o[a]===0;a--)o.pop();if(a<0)r=0,o=[0];else{for(r=-1;o[0]===0;r-=Vt)o.shift();for(n=1,i=o[0];i>=10;i/=10)n++;n<Vt&&(r-=Vt-n)}return s.e=r,s.d=o,s}function hV(t){return zt(t=new this(t),t.e+1,this.rounding)}function dV(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function pV(t){return new this(t).sin()}function mV(t){return new this(t).sinh()}function vV(t){return new this(t).sqrt()}function gV(t,e){return new this(t).sub(e)}function yV(){var t=0,e=arguments,r=new this(e[t]);for(ar=!1;r.s&&++t<e.length;)r=r.plus(e[t]);return ar=!0,zt(r,this.precision,this.rounding)}function bV(t){return new this(t).tan()}function xV(t){return new this(t).tanh()}function wV(t){return zt(t=new this(t),t.e+1,1)}ut[Symbol.for("nodejs.util.inspect.custom")]=ut.toString;ut[Symbol.toStringTag]="Decimal";var pl=ut.constructor=cI(P1);dv=new pl(dv);pv=new pl(pv);var _V="BigNumber",AV=["?on","config"],EV=ee(_V,AV,t=>{var{on:e,config:r}=t,n=pl.clone({precision:r.precision,modulo:pl.EUCLID});return n.prototype=Object.create(n.prototype),n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(i){return new n(i.value)},e&&e("config",function(i,a){i.precision!==a.precision&&n.config({precision:i.precision})}),n},{isClass:!0});const Ii=Math.cosh||function(t){return Math.abs(t)<1e-9?1-t:(Math.exp(t)+Math.exp(-t))*.5},Za=Math.sinh||function(t){return Math.abs(t)<1e-9?t:(Math.exp(t)-Math.exp(-t))*.5},SV=function(t){const e=Math.PI/4;if(-e>t||t>e)return Math.cos(t)-1;const r=t*t;return r*(r*(r*(r*(r*(r*(r*(r/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},iy=function(t,e){return t=Math.abs(t),e=Math.abs(e),t<e&&([t,e]=[e,t]),t<1e8?Math.sqrt(t*t+e*e):(e/=t,t*Math.sqrt(1+e*e))},df=function(){throw SyntaxError("Invalid Param")};function ay(t,e){const r=Math.abs(t),n=Math.abs(e);return t===0?Math.log(n):e===0?Math.log(r):r<3e3&&n<3e3?Math.log(t*t+e*e)*.5:(t=t*.5,e=e*.5,.5*Math.log(t*t+e*e)+Math.LN2)}const DV={re:0,im:0},sc=function(t,e){const r=DV;if(t==null)r.re=r.im=0;else if(e!==void 0)r.re=t,r.im=e;else switch(typeof t){case"object":if("im"in t&&"re"in t)r.re=t.re,r.im=t.im;else if("abs"in t&&"arg"in t){if(!isFinite(t.abs)&&isFinite(t.arg))return Ke.INFINITY;r.re=t.abs*Math.cos(t.arg),r.im=t.abs*Math.sin(t.arg)}else if("r"in t&&"phi"in t){if(!isFinite(t.r)&&isFinite(t.phi))return Ke.INFINITY;r.re=t.r*Math.cos(t.phi),r.im=t.r*Math.sin(t.phi)}else t.length===2?(r.re=t[0],r.im=t[1]):df();break;case"string":r.im=r.re=0;const n=t.replace(/_/g,"").match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g);let i=1,a=0;n===null&&df();for(let s=0;s<n.length;s++){const o=n[s];o===" "||o==="	"||o===`
`||(o==="+"?i++:o==="-"?a++:o==="i"||o==="I"?(i+a===0&&df(),n[s+1]!==" "&&!isNaN(n[s+1])?(r.im+=parseFloat((a%2?"-":"")+n[s+1]),s++):r.im+=parseFloat((a%2?"-":"")+"1"),i=a=0):((i+a===0||isNaN(o))&&df(),n[s+1]==="i"||n[s+1]==="I"?(r.im+=parseFloat((a%2?"-":"")+o),s++):r.re+=parseFloat((a%2?"-":"")+o),i=a=0))}i+a>0&&df();break;case"number":r.im=0,r.re=t;break;default:df()}return isNaN(r.re)||isNaN(r.im),r};function Ke(t,e){if(!(this instanceof Ke))return new Ke(t,e);const r=sc(t,e);this.re=r.re,this.im=r.im}Ke.prototype={re:0,im:0,sign:function(){const t=iy(this.re,this.im);return new Ke(this.re/t,this.im/t)},add:function(t,e){const r=sc(t,e),n=this.isInfinite(),i=!(isFinite(r.re)&&isFinite(r.im));return n||i?n&&i?Ke.NAN:Ke.INFINITY:new Ke(this.re+r.re,this.im+r.im)},sub:function(t,e){const r=sc(t,e),n=this.isInfinite(),i=!(isFinite(r.re)&&isFinite(r.im));return n||i?n&&i?Ke.NAN:Ke.INFINITY:new Ke(this.re-r.re,this.im-r.im)},mul:function(t,e){const r=sc(t,e),n=this.isInfinite(),i=!(isFinite(r.re)&&isFinite(r.im)),a=this.re===0&&this.im===0,s=r.re===0&&r.im===0;return n&&s||i&&a?Ke.NAN:n||i?Ke.INFINITY:r.im===0&&this.im===0?new Ke(this.re*r.re,0):new Ke(this.re*r.re-this.im*r.im,this.re*r.im+this.im*r.re)},div:function(t,e){const r=sc(t,e),n=this.isInfinite(),i=!(isFinite(r.re)&&isFinite(r.im)),a=this.re===0&&this.im===0,s=r.re===0&&r.im===0;if(a&&s||n&&i)return Ke.NAN;if(s||n)return Ke.INFINITY;if(a||i)return Ke.ZERO;if(r.im===0)return new Ke(this.re/r.re,this.im/r.re);if(Math.abs(r.re)<Math.abs(r.im)){const o=r.re/r.im,l=r.re*o+r.im;return new Ke((this.re*o+this.im)/l,(this.im*o-this.re)/l)}else{const o=r.im/r.re,l=r.im*o+r.re;return new Ke((this.re+this.im*o)/l,(this.im-this.re*o)/l)}},pow:function(t,e){const r=sc(t,e),n=this.re===0&&this.im===0;if(r.re===0&&r.im===0)return Ke.ONE;if(r.im===0){if(this.im===0&&this.re>0)return new Ke(Math.pow(this.re,r.re),0);if(this.re===0)switch((r.re%4+4)%4){case 0:return new Ke(Math.pow(this.im,r.re),0);case 1:return new Ke(0,Math.pow(this.im,r.re));case 2:return new Ke(-Math.pow(this.im,r.re),0);case 3:return new Ke(0,-Math.pow(this.im,r.re))}}if(n&&r.re>0)return Ke.ZERO;const a=Math.atan2(this.im,this.re),s=ay(this.re,this.im);let o=Math.exp(r.re*s-r.im*a),l=r.im*s+r.re*a;return new Ke(o*Math.cos(l),o*Math.sin(l))},sqrt:function(){const t=this.re,e=this.im;if(e===0)return t>=0?new Ke(Math.sqrt(t),0):new Ke(0,Math.sqrt(-t));const r=iy(t,e);let n=Math.sqrt(.5*(r+Math.abs(t))),i=Math.abs(e)/(2*n);return t>=0?new Ke(n,e<0?-i:i):new Ke(i,e<0?-n:n)},exp:function(){const t=Math.exp(this.re);return this.im===0?new Ke(t,0):new Ke(t*Math.cos(this.im),t*Math.sin(this.im))},expm1:function(){const t=this.re,e=this.im;return new Ke(Math.expm1(t)*Math.cos(e)+SV(e),Math.exp(t)*Math.sin(e))},log:function(){const t=this.re,e=this.im;return e===0&&t>0?new Ke(Math.log(t),0):new Ke(ay(t,e),Math.atan2(e,t))},abs:function(){return iy(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){const t=this.re,e=this.im;return new Ke(Math.sin(t)*Ii(e),Math.cos(t)*Za(e))},cos:function(){const t=this.re,e=this.im;return new Ke(Math.cos(t)*Ii(e),-Math.sin(t)*Za(e))},tan:function(){const t=2*this.re,e=2*this.im,r=Math.cos(t)+Ii(e);return new Ke(Math.sin(t)/r,Za(e)/r)},cot:function(){const t=2*this.re,e=2*this.im,r=Math.cos(t)-Ii(e);return new Ke(-Math.sin(t)/r,Za(e)/r)},sec:function(){const t=this.re,e=this.im,r=.5*Ii(2*e)+.5*Math.cos(2*t);return new Ke(Math.cos(t)*Ii(e)/r,Math.sin(t)*Za(e)/r)},csc:function(){const t=this.re,e=this.im,r=.5*Ii(2*e)-.5*Math.cos(2*t);return new Ke(Math.sin(t)*Ii(e)/r,-Math.cos(t)*Za(e)/r)},asin:function(){const t=this.re,e=this.im,r=new Ke(e*e-t*t+1,-2*t*e).sqrt(),n=new Ke(r.re-e,r.im+t).log();return new Ke(n.im,-n.re)},acos:function(){const t=this.re,e=this.im,r=new Ke(e*e-t*t+1,-2*t*e).sqrt(),n=new Ke(r.re-e,r.im+t).log();return new Ke(Math.PI/2-n.im,n.re)},atan:function(){const t=this.re,e=this.im;if(t===0){if(e===1)return new Ke(0,1/0);if(e===-1)return new Ke(0,-1/0)}const r=t*t+(1-e)*(1-e),n=new Ke((1-e*e-t*t)/r,-2*t/r).log();return new Ke(-.5*n.im,.5*n.re)},acot:function(){const t=this.re,e=this.im;if(e===0)return new Ke(Math.atan2(1,t),0);const r=t*t+e*e;return r!==0?new Ke(t/r,-e/r).atan():new Ke(t!==0?t/0:0,e!==0?-e/0:0).atan()},asec:function(){const t=this.re,e=this.im;if(t===0&&e===0)return new Ke(0,1/0);const r=t*t+e*e;return r!==0?new Ke(t/r,-e/r).acos():new Ke(t!==0?t/0:0,e!==0?-e/0:0).acos()},acsc:function(){const t=this.re,e=this.im;if(t===0&&e===0)return new Ke(Math.PI/2,1/0);const r=t*t+e*e;return r!==0?new Ke(t/r,-e/r).asin():new Ke(t!==0?t/0:0,e!==0?-e/0:0).asin()},sinh:function(){const t=this.re,e=this.im;return new Ke(Za(t)*Math.cos(e),Ii(t)*Math.sin(e))},cosh:function(){const t=this.re,e=this.im;return new Ke(Ii(t)*Math.cos(e),Za(t)*Math.sin(e))},tanh:function(){const t=2*this.re,e=2*this.im,r=Ii(t)+Math.cos(e);return new Ke(Za(t)/r,Math.sin(e)/r)},coth:function(){const t=2*this.re,e=2*this.im,r=Ii(t)-Math.cos(e);return new Ke(Za(t)/r,-Math.sin(e)/r)},csch:function(){const t=this.re,e=this.im,r=Math.cos(2*e)-Ii(2*t);return new Ke(-2*Za(t)*Math.cos(e)/r,2*Ii(t)*Math.sin(e)/r)},sech:function(){const t=this.re,e=this.im,r=Math.cos(2*e)+Ii(2*t);return new Ke(2*Ii(t)*Math.cos(e)/r,-2*Za(t)*Math.sin(e)/r)},asinh:function(){let t=this.im;this.im=-this.re,this.re=t;const e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){const t=this.acos();if(t.im<=0){const e=t.re;t.re=-t.im,t.im=e}else{const e=t.im;t.im=-t.re,t.re=e}return t},atanh:function(){const t=this.re,e=this.im,r=t>1&&e===0,n=1-t,i=1+t,a=n*n+e*e,s=a!==0?new Ke((i*n-e*e)/a,(e*n+i*e)/a):new Ke(t!==-1?t/0:0,e!==0?e/0:0),o=s.re;return s.re=ay(s.re,s.im)/2,s.im=Math.atan2(s.im,o)/2,r&&(s.im=-s.im),s},acoth:function(){const t=this.re,e=this.im;if(t===0&&e===0)return new Ke(0,Math.PI/2);const r=t*t+e*e;return r!==0?new Ke(t/r,-e/r).atanh():new Ke(t!==0?t/0:0,e!==0?-e/0:0).atanh()},acsch:function(){const t=this.re,e=this.im;if(e===0)return new Ke(t!==0?Math.log(t+Math.sqrt(t*t+1)):1/0,0);const r=t*t+e*e;return r!==0?new Ke(t/r,-e/r).asinh():new Ke(t!==0?t/0:0,e!==0?-e/0:0).asinh()},asech:function(){const t=this.re,e=this.im;if(this.isZero())return Ke.INFINITY;const r=t*t+e*e;return r!==0?new Ke(t/r,-e/r).acosh():new Ke(t!==0?t/0:0,e!==0?-e/0:0).acosh()},inverse:function(){if(this.isZero())return Ke.INFINITY;if(this.isInfinite())return Ke.ZERO;const t=this.re,e=this.im,r=t*t+e*e;return new Ke(t/r,-e/r)},conjugate:function(){return new Ke(this.re,-this.im)},neg:function(){return new Ke(-this.re,-this.im)},ceil:function(t){return t=Math.pow(10,t||0),new Ke(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new Ke(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new Ke(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,e){const r=sc(t,e);return Math.abs(r.re-this.re)<=Ke.EPSILON&&Math.abs(r.im-this.im)<=Ke.EPSILON},clone:function(){return new Ke(this.re,this.im)},toString:function(){let t=this.re,e=this.im,r="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(t)<Ke.EPSILON&&(t=0),Math.abs(e)<Ke.EPSILON&&(e=0),e===0?r+t:(t!==0?(r+=t,r+=" ",e<0?(e=-e,r+="-"):r+="+",r+=" "):e<0&&(e=-e,r+="-"),e!==1&&(r+=e),r+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!this.isFinite()}};Ke.ZERO=new Ke(0,0);Ke.ONE=new Ke(1,0);Ke.I=new Ke(0,1);Ke.PI=new Ke(Math.PI,0);Ke.E=new Ke(Math.E,0);Ke.INFINITY=new Ke(1/0,1/0);Ke.NAN=new Ke(NaN,NaN);Ke.EPSILON=1e-15;var CV="Complex",TV=[],NV=ee(CV,TV,()=>(Object.defineProperty(Ke,"name",{value:"Complex"}),Ke.prototype.constructor=Ke,Ke.prototype.type="Complex",Ke.prototype.isComplex=!0,Ke.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Ke.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Ke.prototype.format=function(t){var e="",r=this.im,n=this.re,i=vc(this.re,t),a=vc(this.im,t),s=sr(t)?t:t?t.precision:null;if(s!==null){var o=Math.pow(10,-s);Math.abs(n/r)<o&&(n=0),Math.abs(r/n)<o&&(r=0)}return r===0?e=i:n===0?r===1?e="i":r===-1?e="-i":e=a+"i":r<0?r===-1?e=i+" - i":e=i+" - "+a.substring(1)+"i":r===1?e=i+" + i":e=i+" + "+a+"i",e},Ke.fromPolar=function(t){switch(arguments.length){case 1:{var e=arguments[0];if(typeof e=="object")return Ke(e);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var r=arguments[0],n=arguments[1];if(sr(r)){if(es(n)&&n.hasBase("ANGLE")&&(n=n.toNumber("rad")),sr(n))return new Ke({r,phi:n});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Ke.prototype.valueOf=Ke.prototype.toString,Ke.fromJSON=function(t){return new Ke(t)},Ke.compare=function(t,e){return t.re>e.re?1:t.re<e.re?-1:t.im>e.im?1:t.im<e.im?-1:0},Ke),{isClass:!0});typeof BigInt>"u"&&(BigInt=function(t){if(isNaN(t))throw new Error("");return t});const Ut=BigInt(0),gr=BigInt(1),Id=BigInt(2),L1=BigInt(5),ha=BigInt(10),MV=2e3,St={s:gr,n:Ut,d:gr};function tu(t,e){try{t=BigInt(t)}catch{throw Vu()}return t*e}function Cs(t){return typeof t=="bigint"?t:Math.floor(t)}function mn(t,e){if(e===Ut)throw Hb();const r=Object.create(Qa.prototype);r.s=t<Ut?-gr:gr,t=t<Ut?-t:t;const n=uc(t,e);return r.n=t/n,r.d=e/n,r}function pf(t){const e={};let r=t,n=Id,i=L1-gr;for(;i<=r;){for(;r%n===Ut;)r/=n,e[n]=(e[n]||Ut)+gr;i+=gr+Id*n++}return r!==t?r>1&&(e[r]=(e[r]||Ut)+gr):e[t]=(e[t]||Ut)+gr,e}const li=function(t,e){let r=Ut,n=gr,i=gr;if(t!=null)if(e!==void 0){if(typeof t=="bigint")r=t;else{if(isNaN(t))throw Vu();if(t%1!==0)throw FE();r=BigInt(t)}if(typeof e=="bigint")n=e;else{if(isNaN(e))throw Vu();if(e%1!==0)throw FE();n=BigInt(e)}i=r*n}else if(typeof t=="object"){if("d"in t&&"n"in t)r=BigInt(t.n),n=BigInt(t.d),"s"in t&&(r*=BigInt(t.s));else if(0 in t)r=BigInt(t[0]),1 in t&&(n=BigInt(t[1]));else if(typeof t=="bigint")r=t;else throw Vu();i=r*n}else if(typeof t=="number"){if(isNaN(t))throw Vu();if(t<0&&(i=-gr,t=-t),t%1===0)r=BigInt(t);else{let a=1,s=0,o=1,l=1,u=1,c=1e7;for(t>=1&&(a=10**Math.floor(1+Math.log10(t)),t/=a);o<=c&&u<=c;){let f=(s+l)/(o+u);if(t===f){o+u<=c?(r=s+l,n=o+u):u>o?(r=l,n=u):(r=s,n=o);break}else t>f?(s+=l,o+=u):(l+=s,u+=o),o>c?(r=l,n=u):(r=s,n=o)}r=BigInt(r)*BigInt(a),n=BigInt(n)}}else if(typeof t=="string"){let a=0,s=Ut,o=Ut,l=Ut,u=gr,c=gr,f=t.replace(/_/g,"").match(/\d+|./g);if(f===null)throw Vu();if(f[a]==="-"?(i=-gr,a++):f[a]==="+"&&a++,f.length===a+1?o=tu(f[a++],i):f[a+1]==="."||f[a]==="."?(f[a]!=="."&&(s=tu(f[a++],i)),a++,(a+1===f.length||f[a+1]==="("&&f[a+3]===")"||f[a+1]==="'"&&f[a+3]==="'")&&(o=tu(f[a],i),u=ha**BigInt(f[a].length),a++),(f[a]==="("&&f[a+2]===")"||f[a]==="'"&&f[a+2]==="'")&&(l=tu(f[a+1],i),c=ha**BigInt(f[a+1].length)-gr,a+=3)):f[a+1]==="/"||f[a+1]===":"?(o=tu(f[a],i),u=tu(f[a+2],gr),a+=3):f[a+3]==="/"&&f[a+1]===" "&&(s=tu(f[a],i),o=tu(f[a+2],i),u=tu(f[a+4],gr),a+=5),f.length<=a)n=u*c,i=r=l+n*s+c*o;else throw Vu()}else if(typeof t=="bigint")r=t,i=t,n=gr;else throw Vu();if(n===Ut)throw Hb();St.s=i<Ut?-gr:gr,St.n=r<Ut?-r:r,St.d=n<Ut?-n:n};function IV(t,e,r){let n=gr;for(;e>Ut;t=t*t%r,e>>=gr)e&gr&&(n=n*t%r);return n}function FV(t,e){for(;e%Id===Ut;e/=Id);for(;e%L1===Ut;e/=L1);if(e===gr)return Ut;let r=ha%e,n=1;for(;r!==gr;n++)if(r=r*ha%e,n>MV)return Ut;return BigInt(n)}function OV(t,e,r){let n=gr,i=IV(ha,r,e);for(let a=0;a<300;a++){if(n===i)return BigInt(a);n=n*ha%e,i=i*ha%e}return 0}function uc(t,e){if(!t)return e;if(!e)return t;for(;;){if(t%=e,!t)return e;if(e%=t,!e)return t}}function Qa(t,e){if(li(t,e),this instanceof Qa)t=uc(St.d,St.n),this.s=St.s,this.n=St.n/t,this.d=St.d/t;else return mn(St.s*St.n,St.d)}var Hb=function(){return new Error("Division by Zero")},Vu=function(){return new Error("Invalid argument")},FE=function(){return new Error("Parameters must be integer")};Qa.prototype={s:gr,n:Ut,d:gr,abs:function(){return mn(this.n,this.d)},neg:function(){return mn(-this.s*this.n,this.d)},add:function(t,e){return li(t,e),mn(this.s*this.n*St.d+St.s*this.d*St.n,this.d*St.d)},sub:function(t,e){return li(t,e),mn(this.s*this.n*St.d-St.s*this.d*St.n,this.d*St.d)},mul:function(t,e){return li(t,e),mn(this.s*St.s*this.n*St.n,this.d*St.d)},div:function(t,e){return li(t,e),mn(this.s*St.s*this.n*St.d,this.d*St.n)},clone:function(){return mn(this.s*this.n,this.d)},mod:function(t,e){if(t===void 0)return mn(this.s*this.n%this.d,gr);if(li(t,e),Ut===St.n*this.d)throw Hb();return mn(this.s*(St.d*this.n)%(St.n*this.d),St.d*this.d)},gcd:function(t,e){return li(t,e),mn(uc(St.n,this.n)*uc(St.d,this.d),St.d*this.d)},lcm:function(t,e){return li(t,e),St.n===Ut&&this.n===Ut?mn(Ut,gr):mn(St.n*this.n,uc(St.n,this.n)*uc(St.d,this.d))},inverse:function(){return mn(this.s*this.d,this.n)},pow:function(t,e){if(li(t,e),St.d===gr)return St.s<Ut?mn((this.s*this.d)**St.n,this.n**St.n):mn((this.s*this.n)**St.n,this.d**St.n);if(this.s<Ut)return null;let r=pf(this.n),n=pf(this.d),i=gr,a=gr;for(let s in r)if(s!=="1"){if(s==="0"){i=Ut;break}if(r[s]*=St.n,r[s]%St.d===Ut)r[s]/=St.d;else return null;i*=BigInt(s)**r[s]}for(let s in n)if(s!=="1"){if(n[s]*=St.n,n[s]%St.d===Ut)n[s]/=St.d;else return null;a*=BigInt(s)**n[s]}return St.s<Ut?mn(a,i):mn(i,a)},log:function(t,e){if(li(t,e),this.s<=Ut||St.s<=Ut)return null;const r={},n=pf(St.n),i=pf(St.d),a=pf(this.n),s=pf(this.d);for(const u in i)n[u]=(n[u]||Ut)-i[u];for(const u in s)a[u]=(a[u]||Ut)-s[u];for(const u in n)u!=="1"&&(r[u]=!0);for(const u in a)u!=="1"&&(r[u]=!0);let o=null,l=null;for(const u in r){const c=n[u]||Ut,f=a[u]||Ut;if(c===Ut){if(f!==Ut)return null;continue}let h=f,p=c;const m=uc(h,p);if(h/=m,p/=m,o===null&&l===null)o=h,l=p;else if(h*l!==o*p)return null}return o!==null&&l!==null?mn(o,l):null},equals:function(t,e){return li(t,e),this.s*this.n*St.d===St.s*St.n*this.d},lt:function(t,e){return li(t,e),this.s*this.n*St.d<St.s*St.n*this.d},lte:function(t,e){return li(t,e),this.s*this.n*St.d<=St.s*St.n*this.d},gt:function(t,e){return li(t,e),this.s*this.n*St.d>St.s*St.n*this.d},gte:function(t,e){return li(t,e),this.s*this.n*St.d>=St.s*St.n*this.d},compare:function(t,e){li(t,e);let r=this.s*this.n*St.d-St.s*St.n*this.d;return(Ut<r)-(r<Ut)},ceil:function(t){return t=ha**BigInt(t||0),mn(Cs(this.s*t*this.n/this.d)+(t*this.n%this.d>Ut&&this.s>=Ut?gr:Ut),t)},floor:function(t){return t=ha**BigInt(t||0),mn(Cs(this.s*t*this.n/this.d)-(t*this.n%this.d>Ut&&this.s<Ut?gr:Ut),t)},round:function(t){return t=ha**BigInt(t||0),mn(Cs(this.s*t*this.n/this.d)+this.s*((this.s>=Ut?gr:Ut)+Id*(t*this.n%this.d)>this.d?gr:Ut),t)},roundTo:function(t,e){li(t,e);const r=this.n*St.d,n=this.d*St.n,i=r%n;let a=Cs(r/n);return i+i>=n&&a++,mn(this.s*a*St.n,St.d)},divisible:function(t,e){return li(t,e),!(!(St.n*this.d)||this.n*St.d%(St.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(t){let e=this.n,r=this.d;t=t||15;let n=FV(e,r),i=OV(e,r,n),a=this.s<Ut?"-":"";if(a+=Cs(e/r),e%=r,e*=ha,e&&(a+="."),n){for(let s=i;s--;)a+=Cs(e/r),e%=r,e*=ha;a+="(";for(let s=n;s--;)a+=Cs(e/r),e%=r,e*=ha;a+=")"}else for(let s=t;e&&s--;)a+=Cs(e/r),e%=r,e*=ha;return a},toFraction:function(t){let e=this.n,r=this.d,n=this.s<Ut?"-":"";if(r===gr)n+=e;else{let i=Cs(e/r);t&&i>Ut&&(n+=i,n+=" ",e%=r),n+=e,n+="/",n+=r}return n},toLatex:function(t){let e=this.n,r=this.d,n=this.s<Ut?"-":"";if(r===gr)n+=e;else{let i=Cs(e/r);t&&i>Ut&&(n+=i,e%=r),n+="\\frac{",n+=e,n+="}{",n+=r,n+="}"}return n},toContinued:function(){let t=this.n,e=this.d,r=[];do{r.push(Cs(t/e));let n=t%e;t=e,e=n}while(t!==gr);return r},simplify:function(t){const e=BigInt(1/(t||.001)|0),r=this.abs(),n=r.toContinued();for(let i=1;i<n.length;i++){let a=mn(n[i-1],gr);for(let o=i-2;o>=0;o--)a=a.inverse().add(n[o]);let s=a.sub(r);if(s.n*e<s.d)return a.mul(this.s)}return this}};var BV="Fraction",RV=[],PV=ee(BV,RV,()=>(Object.defineProperty(Qa,"name",{value:"Fraction"}),Qa.prototype.constructor=Qa,Qa.prototype.type="Fraction",Qa.prototype.isFraction=!0,Qa.prototype.toJSON=function(){return{mathjs:"Fraction",n:String(this.s*this.n),d:String(this.d)}},Qa.fromJSON=function(t){return new Qa(t)},Qa),{isClass:!0}),$V="Range",kV=[],LV=ee($V,kV,()=>{function t(e,r,n){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");var i=e!=null,a=r!=null,s=n!=null;if(i){if(or(e))e=e.toNumber();else if(typeof e!="number"&&!xd(e))throw new TypeError("Parameter start must be a number or bigint")}if(a){if(or(r))r=r.toNumber();else if(typeof r!="number"&&!xd(r))throw new TypeError("Parameter end must be a number or bigint")}if(s){if(or(n))n=n.toNumber();else if(typeof n!="number"&&!xd(n))throw new TypeError("Parameter step must be a number or bigint")}this.start=i?parseFloat(e):0,this.end=a?parseFloat(r):0,this.step=s?parseFloat(n):1}return t.prototype.type="Range",t.prototype.isRange=!0,t.parse=function(e){if(typeof e!="string")return null;var r=e.split(":"),n=r.map(function(a){return parseFloat(a)}),i=n.some(function(a){return isNaN(a)});if(i)return null;switch(n.length){case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[2],n[1]);default:return null}},t.prototype.clone=function(){return new t(this.start,this.end,this.step)},t.prototype.size=function(){var e=0,r=this.start,n=this.step,i=this.end,a=i-r;return nl(n)===nl(a)?e=Math.ceil(a/n):a===0&&(e=0),isNaN(e)&&(e=0),[e]},t.prototype.min=function(){var e=this.size()[0];if(e>0)return this.step>0?this.start:this.start+(e-1)*this.step},t.prototype.max=function(){var e=this.size()[0];if(e>0)return this.step>0?this.start+(e-1)*this.step:this.start},t.prototype.forEach=function(e){var r=this.start,n=this.step,i=this.end,a=0;if(n>0)for(;r<i;)e(r,[a],this),r+=n,a++;else if(n<0)for(;r>i;)e(r,[a],this),r+=n,a++},t.prototype.map=function(e){var r=[];return this.forEach(function(n,i,a){r[i[0]]=e(n,i,a)}),r},t.prototype.toArray=function(){var e=[];return this.forEach(function(r,n){e[n[0]]=r}),e},t.prototype.valueOf=function(){return this.toArray()},t.prototype.format=function(e){var r=vc(this.start,e);return this.step!==1&&(r+=":"+vc(this.step,e)),r+=":"+vc(this.end,e),r},t.prototype.toString=function(){return this.format()},t.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},t.fromJSON=function(e){return new t(e.start,e.end,e.step)},t},{isClass:!0}),UV="Matrix",zV=[],GV=ee(UV,zV,()=>{function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator")}return t.prototype.type="Matrix",t.prototype.isMatrix=!0,t.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},t.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},t.prototype.create=function(e,r){throw new Error("Cannot invoke create on a Matrix interface")},t.prototype.subset=function(e,r,n){throw new Error("Cannot invoke subset on a Matrix interface")},t.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},t.prototype.set=function(e,r,n){throw new Error("Cannot invoke set on a Matrix interface")},t.prototype.resize=function(e,r){throw new Error("Cannot invoke resize on a Matrix interface")},t.prototype.reshape=function(e,r){throw new Error("Cannot invoke reshape on a Matrix interface")},t.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},t.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},t.prototype.map=function(e,r){throw new Error("Cannot invoke map on a Matrix interface")},t.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},t.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},t.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},t.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},t.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},t.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},t},{isClass:!0});function sy(t,e,r){var n=t.constructor,i=new n(2),a="";if(r){if(r<1)throw new Error("size must be in greater than 0");if(!Bt(r))throw new Error("size must be an integer");if(t.greaterThan(i.pow(r-1).sub(1))||t.lessThan(i.pow(r-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!t.isInteger())throw new Error("Value must be an integer");t.lessThan(0)&&(t=t.add(i.pow(r))),a="i".concat(r)}switch(e){case 2:return"".concat(t.toBinary()).concat(a);case 8:return"".concat(t.toOctal()).concat(a);case 16:return"".concat(t.toHexadecimal()).concat(a);default:throw new Error("Base ".concat(e," not supported "))}}function qV(t,e){if(typeof e=="function")return e(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var{notation:r,precision:n,wordSize:i}=KM(e);switch(r){case"fixed":return WV(t,n);case"exponential":return OE(t,n);case"engineering":return HV(t,n);case"bin":return sy(t,2,i);case"oct":return sy(t,8,i);case"hex":return sy(t,16,i);case"auto":{var a=BE(e==null?void 0:e.lowerExp,-3),s=BE(e==null?void 0:e.upperExp,5);if(t.isZero())return"0";var o,l=t.toSignificantDigits(n),u=l.e;return u>=a&&u<s?o=l.toFixed():o=OE(t,n),o.replace(/((\.\d*?)(0+))($|e)/,function(){var c=arguments[2],f=arguments[4];return c!=="."?c+f:f})}default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function HV(t,e){var r=t.e,n=r%3===0?r:r<0?r-3-r%3:r-r%3,i=t.mul(Math.pow(10,-n)),a=i.toPrecision(e);if(a.includes("e")){var s=t.constructor;a=new s(a).toFixed()}return a+"e"+(r>=0?"+":"")+n.toString()}function OE(t,e){return e!==void 0?t.toExponential(e-1):t.toExponential()}function WV(t,e){return t.toFixed(e)}function BE(t,e){return sr(t)?t:or(t)?t.toNumber():e}function VV(t,e){var r=t.length-e.length,n=t.length;return t.substring(r,n)===e}function yr(t,e){var r=XV(t,e);return e&&typeof e=="object"&&"truncate"in e&&r.length>e.truncate?r.substring(0,e.truncate-3)+"...":r}function XV(t,e){if(typeof t=="number")return vc(t,e);if(or(t))return qV(t,e);if(jV(t))return!e||e.fraction!=="decimal"?"".concat(t.s*t.n,"/").concat(t.d):t.toString();if(Array.isArray(t))return fI(t,e);if(Fi(t))return Rf(t);if(typeof t=="function")return t.syntax?String(t.syntax):"function";if(t&&typeof t=="object"){if(typeof t.format=="function")return t.format(e);if(t&&t.toString(e)!=={}.toString())return t.toString(e);var r=Object.keys(t).map(n=>Rf(n)+": "+yr(t[n],e));return"{"+r.join(", ")+"}"}return String(t)}function Rf(t){for(var e=String(t),r="",n=0;n<e.length;){var i=e.charAt(n);r+=i in RE?RE[i]:i,n++}return'"'+r+'"'}var RE={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"};function ts(t){var e=String(t);return e=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e}function fI(t,e){if(Array.isArray(t)){for(var r="[",n=t.length,i=0;i<n;i++)i!==0&&(r+=", "),r+=fI(t[i],e);return r+="]",r}else return yr(t,e)}function jV(t){return t&&typeof t=="object"&&typeof t.s=="bigint"&&typeof t.n=="bigint"&&typeof t.d=="bigint"||!1}function U1(t,e){if(!Fi(t))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+tn(t)+", index: 0)");if(!Fi(e))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+tn(e)+", index: 1)");return t===e?0:t>e?1:-1}function br(t,e,r){if(!(this instanceof br))throw new SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=r,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=new Error().stack}br.prototype=new RangeError;br.prototype.constructor=RangeError;br.prototype.name="DimensionError";br.prototype.isDimensionError=!0;function zs(t,e,r){if(!(this instanceof zs))throw new SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=r),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}zs.prototype=new RangeError;zs.prototype.constructor=RangeError;zs.prototype.name="IndexError";zs.prototype.isIndexError=!0;function er(t){for(var e=[];Array.isArray(t);)e.push(t.length),t=t[0];return e}function hI(t,e,r){var n,i=t.length;if(i!==e[r])throw new br(i,e[r]);if(r<e.length-1){var a=r+1;for(n=0;n<i;n++){var s=t[n];if(!Array.isArray(s))throw new br(e.length-1,e.length,"<");hI(t[n],e,a)}}else for(n=0;n<i;n++)if(Array.isArray(t[n]))throw new br(e.length+1,e.length,">")}function PE(t,e){var r=e.length===0;if(r){if(Array.isArray(t))throw new br(t.length,0)}else hI(t,e,0)}function vv(t,e){var r=t.isMatrix?t._size:er(t),n=e._sourceSize;n.forEach((i,a)=>{if(i!==null&&i!==r[a])throw new br(i,r[a])})}function sn(t,e){if(t!==void 0){if(!sr(t)||!Bt(t))throw new TypeError("Index must be an integer (value: "+t+")");if(t<0||typeof e=="number"&&t>=e)throw new zs(t,e)}}function nh(t){for(var e=0;e<t._dimensions.length;++e){var r=t._dimensions[e];if(r._data&&Jr(r._data)){if(r._size[0]===0)return!0}else if(r.isRange){if(r.start===r.end)return!0}else if(Fi(r)&&r.length===0)return!0}return!1}function ih(t,e,r){if(!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new Error("Resizing to scalar is not supported");e.forEach(function(i){if(!sr(i)||!Bt(i)||i<0)throw new TypeError("Invalid size, must contain positive integers (size: "+yr(e)+")")}),(sr(t)||or(t))&&(t=[t]);var n=r!==void 0?r:0;return z1(t,e,0,n),t}function z1(t,e,r,n){var i,a,s=t.length,o=e[r],l=Math.min(s,o);if(t.length=o,r<e.length-1){var u=r+1;for(i=0;i<l;i++)a=t[i],Array.isArray(a)||(a=[a],t[i]=a),z1(a,e,u,n);for(i=l;i<o;i++)a=[],t[i]=a,z1(a,e,u,n)}else{for(i=0;i<l;i++)for(;Array.isArray(t[i]);)t[i]=t[i][0];for(i=l;i<o;i++)t[i]=n}}function Wb(t,e){var r=Lr(t,!0),n=r.length;if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new br(0,n,"!=");e=Vb(e,n);var i=dI(e);if(n!==i)throw new br(i,n,"!=");try{return YV(r,e)}catch(a){throw a instanceof br?new br(i,n,"!="):a}}function Vb(t,e){var r=dI(t),n=t.slice(),i=-1,a=t.indexOf(i),s=t.indexOf(i,a+1)>=0;if(s)throw new Error("More than one wildcard in sizes");var o=a>=0,l=e%r===0;if(o)if(l)n[a]=-e/r;else throw new Error("Could not replace wildcard, since "+e+" is no multiple of "+-r);return n}function dI(t){return t.reduce((e,r)=>e*r,1)}function YV(t,e){for(var r=t,n,i=e.length-1;i>0;i--){var a=e[i];n=[];for(var s=r.length/a,o=0;o<s;o++)n.push(r.slice(o*a,(o+1)*a));r=n}return r}function gv(t,e){for(var r=er(t);Array.isArray(t)&&t.length===1;)t=t[0],r.shift();for(var n=r.length;r[n-1]===1;)n--;return n<r.length&&(t=pI(t,n,0),r.length=n),t}function pI(t,e,r){var n,i;if(r<e){var a=r+1;for(n=0,i=t.length;n<i;n++)t[n]=pI(t[n],e,a)}else for(;Array.isArray(t);)t=t[0];return t}function mI(t,e,r,n){var i=n||er(t);if(r)for(var a=0;a<r;a++)t=[t],i.unshift(1);for(t=vI(t,e,0);i.length<e;)i.push(1);return t}function vI(t,e,r){var n,i;if(Array.isArray(t)){var a=r+1;for(n=0,i=t.length;n<i;n++)t[n]=vI(t[n],e,a)}else for(var s=r;s<e;s++)t=[t];return t}function Lr(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!Array.isArray(t))return t;if(typeof e!="boolean")throw new TypeError("Boolean expected for second argument of flatten");var r=[];return e?i(t):n(t),r;function n(a){for(var s=0;s<a.length;s++){var o=a[s];Array.isArray(o)?n(o):r.push(o)}}function i(a){if(Array.isArray(a[0]))for(var s=0;s<a.length;s++)i(a[s]);else for(var o=0;o<a.length;o++)r.push(a[o])}}function sl(t,e){return Array.prototype.map.call(t,e)}function gI(t,e){Array.prototype.forEach.call(t,e)}function $E(t,e){if(er(t).length!==1)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(t,e)}function kE(t,e){if(er(t).length!==1)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(t,r=>e.test(r))}function LE(t,e){return Array.prototype.join.call(t,e)}function ah(t){if(!Array.isArray(t))throw new TypeError("Array input expected");if(t.length===0)return t;var e=[],r=0;e[0]={value:t[0],identifier:0};for(var n=1;n<t.length;n++)t[n]===t[n-1]?r++:r=0,e.push({value:t[n],identifier:r});return e}function yv(t){if(!Array.isArray(t))throw new TypeError("Array input expected");if(t.length===0)return t;for(var e=[],r=0;r<t.length;r++)e.push(t[r].value);return e}function ug(t,e){for(var r,n=0,i=0;i<t.length;i++){var a=t[i],s=Array.isArray(a);if(i===0&&s&&(n=a.length),s&&a.length!==n)return;var o=s?ug(a,e):e(a);if(r===void 0)r=o;else if(r!==o)return"mixed"}return r}function yI(t,e,r,n){if(n<r){if(t.length!==e.length)throw new br(t.length,e.length);for(var i=[],a=0;a<t.length;a++)i[a]=yI(t[a],e[a],r,n+1);return i}else return t.concat(e)}function bI(){var t=Array.prototype.slice.call(arguments,0,-1),e=Array.prototype.slice.call(arguments,-1);if(t.length===1)return t[0];if(t.length>1)return t.slice(1).reduce(function(r,n){return yI(r,n,e,0)},t[0]);throw new Error("Wrong number of arguments in function concat")}function Xb(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=e.map(h=>h.length),i=Math.max(...n),a=new Array(i).fill(null),s=0;s<e.length;s++)for(var o=e[s],l=n[s],u=0;u<l;u++){var c=i-l+u;o[u]>a[c]&&(a[c]=o[u])}for(var f=0;f<e.length;f++)xI(e[f],a);return a}function xI(t,e){for(var r=e.length,n=t.length,i=0;i<n;i++){var a=r-n+i;if(t[i]<e[a]&&t[i]>1||t[i]>e[a])throw new Error("shape mismatch: mismatch is found in arg with shape (".concat(t,") not possible to broadcast dimension ").concat(n," with size ").concat(t[i]," to size ").concat(e[a]))}}function hc(t,e){var r=er(t);if(yu(r,e))return t;xI(r,e);var n=Xb(r,e),i=n.length,a=[...Array(i-r.length).fill(1),...r],s=ZV(t);r.length<i&&(s=Wb(s,a),r=er(s));for(var o=0;o<i;o++)r[o]<n[o]&&(s=KV(s,n[o],o),r=er(s));return s}function KV(t,e,r){return bI(...Array(e).fill(t),r)}function jb(t,e){if(!Array.isArray(t))throw new Error("Array expected");var r=er(t);if(e.length!==r.length)throw new br(e.length,r.length);for(var n=0;n<e.length;n++)sn(e[n],r[n]);return e.reduce((i,a)=>i[a],t)}function G1(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(t.length===0)return[];if(r)return a(t);var n=[];return i(t,0);function i(s,o){if(Array.isArray(s)){for(var l=s.length,u=Array(l),c=0;c<l;c++)n[o]=c,u[c]=i(s[c],o+1);return u}else return e(s,n.slice(0,o),t)}function a(s){if(Array.isArray(s)){for(var o=s.length,l=Array(o),u=0;u<o;u++)l[u]=a(s[u]);return l}else return e(s)}}function wI(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(t.length===0)return;if(r){a(t);return}var n=[];i(t,0);function i(s,o){if(Array.isArray(s))for(var l=s.length,u=0;u<l;u++)n[o]=u,i(s[u],o+1);else e(s,n.slice(0,o),t)}function a(s){if(Array.isArray(s))for(var o=s.length,l=0;l<o;l++)a(s[l]);else e(s)}}function ZV(t){return Zn([],t)}function _c(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(hv.isTypedFunction(t)){var i;if(n)i=1;else{var a=(e.isMatrix?e.size():er(e)).map(()=>0),s=e.isMatrix?e.get(a):jb(e,a);i=eX(t,s,a,e)}var o;if(e.isMatrix&&e.dataType!=="mixed"&&e.dataType!==void 0){var l=QV(t,i);o=l!==void 0?l:t}else o=t;return i>=1&&i<=3?{isUnary:i===1,fn:function(){for(var c=arguments.length,f=new Array(c),h=0;h<c;h++)f[h]=arguments[h];return UE(o,f.slice(0,i),r,t.name)}}:{isUnary:!1,fn:function(){for(var c=arguments.length,f=new Array(c),h=0;h<c;h++)f[h]=arguments[h];return UE(o,f,r,t.name)}}}return n===void 0?{isUnary:JV(t),fn:t}:{isUnary:n,fn:t}}function QV(t,e){var r=[];if(Object.entries(t.signatures).forEach(n=>{var[i,a]=n;i.split(",").length===e&&r.push(a)}),r.length===1)return r[0]}function JV(t){if(t.length!==1)return!1;var e=t.toString();if(/arguments/.test(e))return!1;var r=e.match(/\(.*?\)/);return!/\.\.\./.test(r)}function eX(t,e,r,n){for(var i=[e,r,n],a=3;a>0;a--){var s=i.slice(0,a);if(hv.resolve(t,s)!==null)return a}}function UE(t,e,r,n){try{return t(...e)}catch(i){tX(i,e,r,n)}}function tX(t,e,r,n){var i;if(t instanceof TypeError&&((i=t.data)===null||i===void 0?void 0:i.category)==="wrongType"){var a=[];throw a.push("value: ".concat(tn(e[0]))),e.length>=2&&a.push("index: ".concat(tn(e[1]))),e.length>=3&&a.push("array: ".concat(tn(e[2]))),new TypeError("Function ".concat(r," cannot apply callback arguments ")+"".concat(n,"(").concat(a.join(", "),") at index ").concat(JSON.stringify(e[1])))}else throw new TypeError("Function ".concat(r," cannot apply callback arguments ")+"to function ".concat(n,": ").concat(t.message))}var rX="DenseMatrix",nX=["Matrix"],iX=ee(rX,nX,t=>{var{Matrix:e}=t;function r(c,f){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(f&&!Fi(f))throw new Error("Invalid datatype: "+f);if(Gt(c))c.type==="DenseMatrix"?(this._data=rr(c._data),this._size=rr(c._size),this._datatype=f||c._datatype):(this._data=c.toArray(),this._size=c.size(),this._datatype=f||c._datatype);else if(c&&Jr(c.data)&&Jr(c.size))this._data=c.data,this._size=c.size,PE(this._data,this._size),this._datatype=f||c.datatype;else if(Jr(c))this._data=u(c),this._size=er(this._data),PE(this._data,this._size),this._datatype=f;else{if(c)throw new TypeError("Unsupported type of data ("+tn(c)+")");this._data=[],this._size=[0],this._datatype=f}}r.prototype=new e,r.prototype.createDenseMatrix=function(c,f){return new r(c,f)},Object.defineProperty(r,"name",{value:"DenseMatrix"}),r.prototype.constructor=r,r.prototype.type="DenseMatrix",r.prototype.isDenseMatrix=!0,r.prototype.getDataType=function(){return ug(this._data,tn)},r.prototype.storage=function(){return"dense"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(c,f){return new r(c,f)},r.prototype.subset=function(c,f,h){switch(arguments.length){case 1:return n(this,c);case 2:case 3:return a(this,c,f,h);default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.get=function(c){return jb(this._data,c)},r.prototype.set=function(c,f,h){if(!Jr(c))throw new TypeError("Array expected");if(c.length<this._size.length)throw new br(c.length,this._size.length,"<");var p,m,v,y=c.map(function(S){return S+1});l(this,y,h);var x=this._data;for(p=0,m=c.length-1;p<m;p++)v=c[p],sn(v,x.length),x=x[v];return v=c[c.length-1],sn(v,x.length),x[v]=f,this};function n(c,f){if(!tg(f))throw new TypeError("Invalid index");var h=f.isScalar();if(h)return c.get(f.min());var p=f.size();if(p.length!==c._size.length)throw new br(p.length,c._size.length);for(var m=f.min(),v=f.max(),y=0,x=c._size.length;y<x;y++)sn(m[y],c._size[y]),sn(v[y],c._size[y]);var S=new r([]),b=i(c._data,f);return S._size=b.size,S._datatype=c._datatype,S._data=b.data,S}function i(c,f){var h=f.size().length-1,p=Array(h);return{data:m(c),size:p};function m(v){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,x=f.dimension(y);return p[y]=x.size()[0],y<h?x.map(S=>(sn(S,v.length),m(v[S],y+1))).valueOf():x.map(S=>(sn(S,v.length),v[S])).valueOf()}}function a(c,f,h,p){if(!f||f.isIndex!==!0)throw new TypeError("Invalid index");var m=f.size(),v=f.isScalar(),y;if(Gt(h)?(y=h.size(),h=h.valueOf()):y=er(h),v){if(y.length!==0)throw new TypeError("Scalar expected");c.set(f.min(),h,p)}else{if(!yu(y,m))try{y.length===0?h=hc([h],m):h=hc(h,m),y=er(h)}catch{}if(m.length<c._size.length)throw new br(m.length,c._size.length,"<");if(y.length<m.length){for(var x=0,S=0;m[x]===1&&y[x]===1;)x++;for(;m[x]===1;)S++,x++;h=mI(h,m.length,S,y)}if(!yu(m,y))throw new br(m,y,">");var b=f.max().map(function(A){return A+1});l(c,b,p),s(c._data,f,h)}return c}function s(c,f,h){var p=f.size().length-1;m(c,h);function m(v,y){var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,S=f.dimension(x);x<p?S.forEach((b,A)=>{sn(b,v.length),m(v[b],y[A[0]],x+1)}):S.forEach((b,A)=>{sn(b,v.length),v[b]=y[A[0]]})}}r.prototype.resize=function(c,f,h){if(!is(c))throw new TypeError("Array or Matrix expected");var p=c.valueOf().map(v=>Array.isArray(v)&&v.length===1?v[0]:v),m=h?this.clone():this;return o(m,p,f)};function o(c,f,h){if(f.length===0){for(var p=c._data;Jr(p);)p=p[0];return p}return c._size=f.slice(0),c._data=ih(c._data,c._size,h),c}r.prototype.reshape=function(c,f){var h=f?this.clone():this;h._data=Wb(h._data,c);var p=h._size.reduce((m,v)=>m*v);return h._size=Vb(c,p),h};function l(c,f,h){for(var p=c._size.slice(0),m=!1;p.length<f.length;)p.push(0),m=!0;for(var v=0,y=f.length;v<y;v++)f[v]>p[v]&&(p[v]=f[v],m=!0);m&&o(c,p,h)}r.prototype.clone=function(){var c=new r({data:rr(this._data),size:rr(this._size),datatype:this._datatype});return c},r.prototype.size=function(){return this._size.slice(0)},r.prototype.map=function(c){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=this,p=h._size.length-1;if(p<0)return h.clone();var m=_c(c,h,"map",f),v=m.fn,y=h.create(void 0,h._datatype);if(y._size=h._size,f||m.isUnary)return y._data=_(h._data),y;if(p===0){for(var x=h.valueOf(),S=Array(x.length),b=0;b<x.length;b++)S[b]=v(x[b],[b],h);return y._data=S,y}var A=[];return y._data=E(h._data),y;function E(T){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,N=Array(T.length);if(M<p)for(var I=0;I<T.length;I++)A[M]=I,N[I]=E(T[I],M+1);else for(var F=0;F<T.length;F++)A[M]=F,N[F]=v(T[F],A.slice(),h);return N}function _(T){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,N=Array(T.length);if(M<p)for(var I=0;I<T.length;I++)N[I]=_(T[I],M+1);else for(var F=0;F<T.length;F++)N[F]=v(T[F]);return N}},r.prototype.forEach=function(c){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=this,p=h._size.length-1;if(p<0)return;var m=_c(c,h,"map",f),v=m.fn;if(f||m.isUnary){b(h._data);return}if(p===0){for(var y=0;y<h._data.length;y++)v(h._data[y],[y],h);return}var x=[];S(h._data);function S(A){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(E<p)for(var _=0;_<A.length;_++)x[E]=_,S(A[_],E+1);else for(var T=0;T<A.length;T++)x[E]=T,v(A[T],x.slice(),h)}function b(A){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(E<p)for(var _=0;_<A.length;_++)b(A[_],E+1);else for(var T=0;T<A.length;T++)v(A[T])}},r.prototype[Symbol.iterator]=function*(){var c=this._size.length-1;if(!(c<0)){if(c===0){for(var f=0;f<this._data.length;f++)yield{value:this._data[f],index:[f]};return}var h=[],p=function*(v,y){if(y<c)for(var x=0;x<v.length;x++)h[y]=x,yield*p(v[x],y+1);else for(var S=0;S<v.length;S++)h[y]=S,yield{value:v[S],index:h.slice()}};yield*p(this._data,0)}},r.prototype.rows=function(){var c=[],f=this.size();if(f.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");var h=this._data;for(var p of h)c.push(new r([p],this._datatype));return c},r.prototype.columns=function(){var c=this,f=[],h=this.size();if(h.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var p=this._data,m=function(x){var S=p.map(b=>[b[x]]);f.push(new r(S,c._datatype))},v=0;v<h[1];v++)m(v);return f},r.prototype.toArray=function(){return rr(this._data)},r.prototype.valueOf=function(){return this._data},r.prototype.format=function(c){return yr(this._data,c)},r.prototype.toString=function(){return yr(this._data)},r.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(c){if(c){if(or(c)&&(c=c.toNumber()),!sr(c)||!Bt(c))throw new TypeError("The parameter k must be an integer number")}else c=0;for(var f=c>0?c:0,h=c<0?-c:0,p=this._size[0],m=this._size[1],v=Math.min(p-h,m-f),y=[],x=0;x<v;x++)y[x]=this._data[x+h][x+f];return new r({data:y,size:[v],datatype:this._datatype})},r.diagonal=function(c,f,h,p){if(!Jr(c))throw new TypeError("Array expected, size parameter");if(c.length!==2)throw new Error("Only two dimensions matrix are supported");if(c=c.map(function(T){if(or(T)&&(T=T.toNumber()),!sr(T)||!Bt(T)||T<1)throw new Error("Size values must be positive integers");return T}),h){if(or(h)&&(h=h.toNumber()),!sr(h)||!Bt(h))throw new TypeError("The parameter k must be an integer number")}else h=0;var m=h>0?h:0,v=h<0?-h:0,y=c[0],x=c[1],S=Math.min(y-v,x-m),b;if(Jr(f)){if(f.length!==S)throw new Error("Invalid value array length");b=function(M){return f[M]}}else if(Gt(f)){var A=f.size();if(A.length!==1||A[0]!==S)throw new Error("Invalid matrix length");b=function(M){return f.get([M])}}else b=function(){return f};p||(p=or(b(0))?b(0).mul(0):0);var E=[];if(c.length>0){E=ih(E,c,p);for(var _=0;_<S;_++)E[_+v][_+m]=b(_)}return new r({data:E,size:[y,x]})},r.fromJSON=function(c){return new r(c)},r.prototype.swapRows=function(c,f){if(!sr(c)||!Bt(c)||!sr(f)||!Bt(f))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return sn(c,this._size[0]),sn(f,this._size[0]),r._swapRows(c,f,this._data),this},r._swapRows=function(c,f,h){var p=h[c];h[c]=h[f],h[f]=p};function u(c){return Gt(c)?u(c.valueOf()):Jr(c)?c.map(u):c}return r},{isClass:!0}),zE="clone",aX=["typed"],sX=ee(zE,aX,t=>{var{typed:e}=t;return e(zE,{any:rr})});function _I(t){var e=t.length,r=t[0].length,n,i,a=[];for(i=0;i<r;i++){var s=[];for(n=0;n<e;n++)s.push(t[n][i]);a.push(s)}return a}function _h(t){for(var e=0;e<t.length;e++)if(is(t[e]))return!0;return!1}function ml(t,e){Gt(t)?t.forEach(r=>e(r),!1,!0):wI(t,e,!0)}function ur(t,e,r){if(!r)return Gt(t)?t.map(i=>e(i),!1,!0):G1(t,e,!0);var n=i=>i===0?i:e(i);return Gt(t)?t.map(i=>n(i),!1,!0):G1(t,n,!0)}function lg(t,e,r){var n=Array.isArray(t)?er(t):t.size();if(e<0||e>=n.length)throw new zs(e,n.length);return Gt(t)?t.create(bv(t.valueOf(),e,r),t.datatype()):bv(t,e,r)}function bv(t,e,r){var n,i,a,s;if(e<=0)if(Array.isArray(t[0])){for(s=_I(t),i=[],n=0;n<s.length;n++)i[n]=bv(s[n],e-1,r);return i}else{for(a=t[0],n=1;n<t.length;n++)a=r(a,t[n]);return a}else{for(i=[],n=0;n<t.length;n++)i[n]=bv(t[n],e-1,r);return i}}function GE(t,e,r,n,i,a,s,o,l,u,c){var f=t._values,h=t._index,p=t._ptr,m,v,y,x;if(n)for(v=p[e],y=p[e+1],m=v;m<y;m++)x=h[m],r[x]!==a?(r[x]=a,s.push(x),n[x]=f[m]):(n[x]=o(n[x],f[m]),i[x]=a);else for(v=p[e],y=p[e+1],m=v;m<y;m++)x=h[m],r[x]!==a?(r[x]=a,s.push(x)):i[x]=a}var qE="isInteger",oX=["typed"],uX=ee(qE,oX,t=>{var{typed:e}=t;return e(qE,{number:Bt,BigNumber:function(n){return n.isInt()},bigint:function(n){return!0},Fraction:function(n){return n.d===1n},"Array | Matrix":e.referToSelf(r=>n=>ur(n,r))})}),Gs="number",Ah="number, number";function AI(t){return Math.abs(t)}AI.signature=Gs;function EI(t,e){return t+e}EI.signature=Ah;function SI(t,e){return t-e}SI.signature=Ah;function DI(t,e){return t*e}DI.signature=Ah;function CI(t){return-t}CI.signature=Gs;function TI(t){return t}TI.signature=Gs;function dd(t){return fW(t)}dd.signature=Gs;function NI(t){return t*t*t}NI.signature=Gs;function MI(t){return Math.exp(t)}MI.signature=Gs;function II(t){return hW(t)}II.signature=Gs;function FI(t,e){if(!Bt(t)||!Bt(e))throw new Error("Parameters in function lcm must be integer numbers");if(t===0||e===0)return 0;for(var r,n=t*e;e!==0;)r=e,e=t%r,t=r;return Math.abs(n/t)}FI.signature=Ah;function HE(t,e){return e?Math.log(t)/Math.log(e):Math.log(t)}function xv(t){return lW(t)}xv.signature=Gs;function q1(t){return uW(t)}q1.signature=Gs;function WE(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,r=e<0;if(r&&(e=-e),e===0)throw new Error("Root must be non-zero");if(t<0&&Math.abs(e)%2!==1)throw new Error("Root must be odd when a is negative.");if(t===0)return r?1/0:0;if(!isFinite(t))return r?0:t;var n=Math.pow(Math.abs(t),1/e);return n=t<0?-n:n,r?1/n:n}function H1(t){return nl(t)}H1.signature=Gs;function OI(t){return t*t}OI.signature=Gs;function BI(t,e){var r,n,i,a=0,s=1,o=1,l=0;if(!Bt(t)||!Bt(e))throw new Error("Parameters in function xgcd must be integer numbers");for(;e;)n=Math.floor(t/e),i=t-n*e,r=a,a=s-n*a,s=r,r=o,o=l-n*o,l=r,t=e,e=i;var u;return t<0?u=[-t,-s,-l]:u=[t,t?s:0,l],u}BI.signature=Ah;function RI(t,e){return t*t<1&&e===1/0||t*t>1&&e===-1/0?0:Math.pow(t,e)}RI.signature=Ah;function id(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!Bt(e)||e<0||e>15)throw new Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(ZM(t,e))}var lX="number",Eh="number, number";function PI(t,e){if(!Bt(t)||!Bt(e))throw new Error("Integers expected in function bitAnd");return t&e}PI.signature=Eh;function $I(t){if(!Bt(t))throw new Error("Integer expected in function bitNot");return~t}$I.signature=lX;function kI(t,e){if(!Bt(t)||!Bt(e))throw new Error("Integers expected in function bitOr");return t|e}kI.signature=Eh;function LI(t,e){if(!Bt(t)||!Bt(e))throw new Error("Integers expected in function bitXor");return t^e}LI.signature=Eh;function UI(t,e){if(!Bt(t)||!Bt(e))throw new Error("Integers expected in function leftShift");return t<<e}UI.signature=Eh;function zI(t,e){if(!Bt(t)||!Bt(e))throw new Error("Integers expected in function rightArithShift");return t>>e}zI.signature=Eh;function GI(t,e){if(!Bt(t)||!Bt(e))throw new Error("Integers expected in function rightLogShift");return t>>>e}GI.signature=Eh;function cu(t,e){if(e<t)return 1;if(e===t)return e;var r=e+t>>1;return cu(t,r)*cu(r+1,e)}function qI(t,e){if(!Bt(t)||t<0)throw new TypeError("Positive integer value expected in function combinations");if(!Bt(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(e>t)throw new TypeError("k must be less than or equal to n");for(var r=t-e,n=1,i=e<r?r+1:e+1,a=2,s=e<r?e:r,o=i;o<=t;++o)for(n*=o;a<=s&&n%a===0;)n/=a,++a;return a<=s&&(n/=cu(a,s)),n}qI.signature="number, number";var cX=Math.PI,fX=2*Math.PI,hX=Math.E,dX=1.618033988749895,pX="number",Yb="number, number";function HI(t){return!t}HI.signature=pX;function W1(t,e){return!!(t||e)}W1.signature=Yb;function V1(t,e){return!!t!=!!e}V1.signature=Yb;function X1(t,e){return!!(t&&e)}X1.signature=Yb;function wv(t){var e;if(Bt(t))return t<=0?isFinite(t)?1/0:NaN:t>171?1/0:cu(1,t-1);if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*wv(1-t));if(t>=171.35)return 1/0;if(t>85){var r=t*t,n=r*t,i=n*t,a=i*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*r)-139/(51840*n)-571/(2488320*i)+163879/(209018880*a)+5246819/(75246796800*a*t))}--t,e=Hf[0];for(var s=1;s<Hf.length;++s)e+=Hf[s]/(t+s);var o=t+WI+.5;return Math.sqrt(2*Math.PI)*Math.pow(o,t+.5)*Math.exp(-o)*e}wv.signature="number";var WI=4.7421875,Hf=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],VI=.9189385332046728,mX=5,vX=7,VE=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];function _v(t){if(t<0)return NaN;if(t===0)return 1/0;if(!isFinite(t))return t;if(t<.5)return Math.log(Math.PI/Math.sin(Math.PI*t))-_v(1-t);t=t-1;for(var e=t+mX+.5,r=VE[0],n=vX-1;n>=1;n--)r+=VE[n]/(t+n);return VI+(t+.5)*Math.log(e)-e+Math.log(r)}_v.signature="number";var Pi="number";function XI(t){return vW(t)}XI.signature=Pi;function jI(t){return Math.atan(1/t)}jI.signature=Pi;function YI(t){return isFinite(t)?(Math.log((t+1)/t)+Math.log(t/(t-1)))/2:0}YI.signature=Pi;function KI(t){return Math.asin(1/t)}KI.signature=Pi;function ZI(t){var e=1/t;return Math.log(e+Math.sqrt(e*e+1))}ZI.signature=Pi;function QI(t){return Math.acos(1/t)}QI.signature=Pi;function JI(t){var e=1/t,r=Math.sqrt(e*e-1);return Math.log(r+e)}JI.signature=Pi;function eF(t){return gW(t)}eF.signature=Pi;function tF(t){return yW(t)}tF.signature=Pi;function rF(t){return 1/Math.tan(t)}rF.signature=Pi;function nF(t){var e=Math.exp(2*t);return(e+1)/(e-1)}nF.signature=Pi;function iF(t){return 1/Math.sin(t)}iF.signature=Pi;function aF(t){return t===0?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(t)-Math.exp(-t)))*nl(t)}aF.signature=Pi;function sF(t){return 1/Math.cos(t)}sF.signature=Pi;function oF(t){return 2/(Math.exp(t)+Math.exp(-t))}oF.signature=Pi;function uF(t){return xW(t)}uF.signature=Pi;var Kb="number";function lF(t){return t<0}lF.signature=Kb;function cF(t){return t>0}cF.signature=Kb;function fF(t){return Number.isNaN(t)}fF.signature=Kb;function as(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e-9,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(r<=0)throw new Error("Relative tolerance must be greater than 0");if(n<0)throw new Error("Absolute tolerance must be at least 0");return t.isNaN()||e.isNaN()?!1:!t.isFinite()||!e.isFinite()?t.eq(e):t.eq(e)?!0:t.minus(e).abs().lte(t.constructor.max(t.constructor.max(t.abs(),e.abs()).mul(r),n))}var XE="isNegative",gX=["typed","config"],yX=ee(XE,gX,t=>{var{typed:e,config:r}=t;return e(XE,{number:n=>_i(n,0,r.relTol,r.absTol)?!1:lF(n),BigNumber:n=>as(n,new n.constructor(0),r.relTol,r.absTol)?!1:n.isNeg()&&!n.isZero()&&!n.isNaN(),bigint:n=>n<0n,Fraction:n=>n.s<0n,Unit:e.referToSelf(n=>i=>e.find(n,i.valueType())(i.value)),"Array | Matrix":e.referToSelf(n=>i=>ur(i,n))})}),jE="isNumeric",bX=["typed"],xX=ee(jE,bX,t=>{var{typed:e}=t;return e(jE,{"number | BigNumber | bigint | Fraction | boolean":()=>!0,"Complex | Unit | string | null | undefined | Node":()=>!1,"Array | Matrix":e.referToSelf(r=>n=>ur(n,r))})}),YE="hasNumericValue",wX=["typed","isNumeric"],_X=ee(YE,wX,t=>{var{typed:e,isNumeric:r}=t;return e(YE,{boolean:()=>!0,string:function(i){return i.trim().length>0&&!isNaN(Number(i))},any:function(i){return r(i)}})}),KE="isPositive",AX=["typed","config"],EX=ee(KE,AX,t=>{var{typed:e,config:r}=t;return e(KE,{number:n=>_i(n,0,r.relTol,r.absTol)?!1:cF(n),BigNumber:n=>as(n,new n.constructor(0),r.relTol,r.absTol)?!1:!n.isNeg()&&!n.isZero()&&!n.isNaN(),bigint:n=>n>0n,Fraction:n=>n.s>0n&&n.n>0n,Unit:e.referToSelf(n=>i=>e.find(n,i.valueType())(i.value)),"Array | Matrix":e.referToSelf(n=>i=>ur(i,n))})}),ZE="isZero",SX=["typed","equalScalar"],DX=ee(ZE,SX,t=>{var{typed:e,equalScalar:r}=t;return e(ZE,{"number | BigNumber | Complex | Fraction":n=>r(n,0),bigint:n=>n===0n,Unit:e.referToSelf(n=>i=>e.find(n,i.valueType())(i.value)),"Array | Matrix":e.referToSelf(n=>i=>ur(i,n))})}),QE="isNaN",CX=["typed"],TX=ee(QE,CX,t=>{var{typed:e}=t;return e(QE,{number:fF,BigNumber:function(n){return n.isNaN()},bigint:function(n){return!1},Fraction:function(n){return!1},Complex:function(n){return n.isNaN()},Unit:function(n){return Number.isNaN(n.value)},"Array | Matrix":e.referToSelf(r=>n=>ur(n,r))})}),JE="typeOf",NX=["typed"],MX=ee(JE,NX,t=>{var{typed:e}=t;return e(JE,{any:tn})});function IX(t,e,r,n){return _i(t.re,e.re,r,n)&&_i(t.im,e.im,r,n)}var Sh=ee("compareUnits",["typed"],t=>{var{typed:e}=t;return{"Unit, Unit":e.referToSelf(r=>(n,i)=>{if(!n.equalBase(i))throw new Error("Cannot compare units with different base");return e.find(r,[n.valueType(),i.valueType()])(n.value,i.value)})}}),Av="equalScalar",FX=["typed","config"],OX=ee(Av,FX,t=>{var{typed:e,config:r}=t,n=Sh({typed:e});return e(Av,{"boolean, boolean":function(a,s){return a===s},"number, number":function(a,s){return _i(a,s,r.relTol,r.absTol)},"BigNumber, BigNumber":function(a,s){return a.eq(s)||as(a,s,r.relTol,r.absTol)},"bigint, bigint":function(a,s){return a===s},"Fraction, Fraction":function(a,s){return a.equals(s)},"Complex, Complex":function(a,s){return IX(a,s,r.relTol,r.absTol)}},n)});ee(Av,["typed","config"],t=>{var{typed:e,config:r}=t;return e(Av,{"number, number":function(i,a){return _i(i,a,r.relTol,r.absTol)}})});var BX="SparseMatrix",RX=["typed","equalScalar","Matrix"],PX=ee(BX,RX,t=>{var{typed:e,equalScalar:r,Matrix:n}=t;function i(v,y){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(y&&!Fi(y))throw new Error("Invalid datatype: "+y);if(Gt(v))a(this,v,y);else if(v&&Jr(v.index)&&Jr(v.ptr)&&Jr(v.size))this._values=v.values,this._index=v.index,this._ptr=v.ptr,this._size=v.size,this._datatype=y||v.datatype;else if(Jr(v))s(this,v,y);else{if(v)throw new TypeError("Unsupported type of data ("+tn(v)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=y}}function a(v,y,x){y.type==="SparseMatrix"?(v._values=y._values?rr(y._values):void 0,v._index=rr(y._index),v._ptr=rr(y._ptr),v._size=rr(y._size),v._datatype=x||y._datatype):s(v,y.valueOf(),x||y._datatype)}function s(v,y,x){v._values=[],v._index=[],v._ptr=[],v._datatype=x;var S=y.length,b=0,A=r,E=0;if(Fi(x)&&(A=e.find(r,[x,x])||r,E=e.convert(0,x)),S>0){var _=0;do{v._ptr.push(v._index.length);for(var T=0;T<S;T++){var M=y[T];if(Jr(M)){if(_===0&&b<M.length&&(b=M.length),_<M.length){var N=M[_];A(N,E)||(v._values.push(N),v._index.push(T))}}else _===0&&b<1&&(b=1),A(M,E)||(v._values.push(M),v._index.push(T))}_++}while(_<b)}v._ptr.push(v._index.length),v._size=[S,b]}i.prototype=new n,i.prototype.createSparseMatrix=function(v,y){return new i(v,y)},Object.defineProperty(i,"name",{value:"SparseMatrix"}),i.prototype.constructor=i,i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return ug(this._values,tn)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(v,y){return new i(v,y)},i.prototype.density=function(){var v=this._size[0],y=this._size[1];return v!==0&&y!==0?this._index.length/(v*y):0},i.prototype.subset=function(v,y,x){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return o(this,v);case 2:case 3:return l(this,v,y,x);default:throw new SyntaxError("Wrong number of arguments")}};function o(v,y){if(!tg(y))throw new TypeError("Invalid index");var x=y.isScalar();if(x)return v.get(y.min());var S=y.size();if(S.length!==v._size.length)throw new br(S.length,v._size.length);var b,A,E,_,T=y.min(),M=y.max();for(b=0,A=v._size.length;b<A;b++)sn(T[b],v._size[b]),sn(M[b],v._size[b]);var N=v._values,I=v._index,F=v._ptr,P=y.dimension(0),U=y.dimension(1),G=[],V=[];P.forEach(function(Z,z){V[Z]=z[0],G[Z]=!0});var $=N?[]:void 0,j=[],k=[];return U.forEach(function(Z){for(k.push(j.length),E=F[Z],_=F[Z+1];E<_;E++)b=I[E],G[b]===!0&&(j.push(V[b]),$&&$.push(N[E]))}),k.push(j.length),new i({values:$,index:j,ptr:k,size:S,datatype:v._datatype})}function l(v,y,x,S){if(!y||y.isIndex!==!0)throw new TypeError("Invalid index");var b=y.size(),A=y.isScalar(),E;if(Gt(x)?(E=x.size(),x=x.toArray()):E=er(x),A){if(E.length!==0)throw new TypeError("Scalar expected");v.set(y.min(),x,S)}else{if(b.length!==1&&b.length!==2)throw new br(b.length,v._size.length,"<");if(E.length<b.length){for(var _=0,T=0;b[_]===1&&E[_]===1;)_++;for(;b[_]===1;)T++,_++;x=mI(x,b.length,T,E)}if(!yu(b,E))throw new br(b,E,">");if(b.length===1){var M=y.dimension(0);M.forEach(function(F,P){sn(F),v.set([F,0],x[P[0]],S)})}else{var N=y.dimension(0),I=y.dimension(1);N.forEach(function(F,P){sn(F),I.forEach(function(U,G){sn(U),v.set([F,U],x[P[0]][G[0]],S)})})}}return v}i.prototype.get=function(v){if(!Jr(v))throw new TypeError("Array expected");if(v.length!==this._size.length)throw new br(v.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var y=v[0],x=v[1];sn(y,this._size[0]),sn(x,this._size[1]);var S=u(y,this._ptr[x],this._ptr[x+1],this._index);return S<this._ptr[x+1]&&this._index[S]===y?this._values[S]:0},i.prototype.set=function(v,y,x){if(!Jr(v))throw new TypeError("Array expected");if(v.length!==this._size.length)throw new br(v.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var S=v[0],b=v[1],A=this._size[0],E=this._size[1],_=r,T=0;Fi(this._datatype)&&(_=e.find(r,[this._datatype,this._datatype])||r,T=e.convert(0,this._datatype)),(S>A-1||b>E-1)&&(h(this,Math.max(S+1,A),Math.max(b+1,E),x),A=this._size[0],E=this._size[1]),sn(S,A),sn(b,E);var M=u(S,this._ptr[b],this._ptr[b+1],this._index);return M<this._ptr[b+1]&&this._index[M]===S?_(y,T)?c(M,b,this._values,this._index,this._ptr):this._values[M]=y:_(y,T)||f(M,S,b,y,this._values,this._index,this._ptr),this};function u(v,y,x,S){if(x-y===0)return x;for(var b=y;b<x;b++)if(S[b]===v)return b;return y}function c(v,y,x,S,b){x.splice(v,1),S.splice(v,1);for(var A=y+1;A<b.length;A++)b[A]--}function f(v,y,x,S,b,A,E){b.splice(v,0,S),A.splice(v,0,y);for(var _=x+1;_<E.length;_++)E[_]++}i.prototype.resize=function(v,y,x){if(!is(v))throw new TypeError("Array or Matrix expected");var S=v.valueOf().map(A=>Array.isArray(A)&&A.length===1?A[0]:A);if(S.length!==2)throw new Error("Only two dimensions matrix are supported");S.forEach(function(A){if(!sr(A)||!Bt(A)||A<0)throw new TypeError("Invalid size, must contain positive integers (size: "+yr(S)+")")});var b=x?this.clone():this;return h(b,S[0],S[1],y)};function h(v,y,x,S){var b=S||0,A=r,E=0;Fi(v._datatype)&&(A=e.find(r,[v._datatype,v._datatype])||r,E=e.convert(0,v._datatype),b=e.convert(b,v._datatype));var _=!A(b,E),T=v._size[0],M=v._size[1],N,I,F;if(x>M){for(I=M;I<x;I++)if(v._ptr[I]=v._values.length,_)for(N=0;N<T;N++)v._values.push(b),v._index.push(N);v._ptr[x]=v._values.length}else x<M&&(v._ptr.splice(x+1,M-x),v._values.splice(v._ptr[x],v._values.length),v._index.splice(v._ptr[x],v._index.length));if(M=x,y>T){if(_){var P=0;for(I=0;I<M;I++){v._ptr[I]=v._ptr[I]+P,F=v._ptr[I+1]+P;var U=0;for(N=T;N<y;N++,U++)v._values.splice(F+U,0,b),v._index.splice(F+U,0,N),P++}v._ptr[M]=v._values.length}}else if(y<T){var G=0;for(I=0;I<M;I++){v._ptr[I]=v._ptr[I]-G;var V=v._ptr[I],$=v._ptr[I+1]-G;for(F=V;F<$;F++)N=v._index[F],N>y-1&&(v._values.splice(F,1),v._index.splice(F,1),G++)}v._ptr[I]=v._values.length}return v._size[0]=y,v._size[1]=x,v}i.prototype.reshape=function(v,y){if(!Jr(v))throw new TypeError("Array expected");if(v.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");v.forEach(function(Z){if(!sr(Z)||!Bt(Z)||Z<=-2||Z===0)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+yr(v)+")")});var x=this._size[0]*this._size[1];v=Vb(v,x);var S=v[0]*v[1];if(x!==S)throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var b=y?this.clone():this;if(this._size[0]===v[0]&&this._size[1]===v[1])return b;for(var A=[],E=0;E<b._ptr.length;E++)for(var _=0;_<b._ptr[E+1]-b._ptr[E];_++)A.push(E);for(var T=b._values.slice(),M=b._index.slice(),N=0;N<b._index.length;N++){var I=M[N],F=A[N],P=I*b._size[1]+F;A[N]=P%v[1],M[N]=Math.floor(P/v[1])}b._values.length=0,b._index.length=0,b._ptr.length=v[1]+1,b._size=v.slice();for(var U=0;U<b._ptr.length;U++)b._ptr[U]=0;for(var G=0;G<T.length;G++){var V=M[G],$=A[G],j=T[G],k=u(V,b._ptr[$],b._ptr[$+1],b._index);f(k,V,$,j,b._values,b._index,b._ptr)}return b},i.prototype.clone=function(){var v=new i({values:this._values?rr(this._values):void 0,index:rr(this._index),ptr:rr(this._ptr),size:rr(this._size),datatype:this._datatype});return v},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(v,y){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var x=this,S=this._size[0],b=this._size[1],A=_c(v,x,"map"),E=function(T,M,N){return A.fn(T,[M,N],x)};return p(this,0,S-1,0,b-1,E,y)};function p(v,y,x,S,b,A,E){var _=[],T=[],M=[],N=r,I=0;Fi(v._datatype)&&(N=e.find(r,[v._datatype,v._datatype])||r,I=e.convert(0,v._datatype));for(var F=function(ue,le,ke){var Me=A(ue,le,ke);N(Me,I)||(_.push(Me),T.push(le))},P=S;P<=b;P++){M.push(_.length);var U=v._ptr[P],G=v._ptr[P+1];if(E)for(var V=U;V<G;V++){var $=v._index[V];$>=y&&$<=x&&F(v._values[V],$-y,P-S)}else{for(var j={},k=U;k<G;k++){var Z=v._index[k];j[Z]=v._values[k]}for(var z=y;z<=x;z++){var me=z in j?j[z]:0;F(me,z-y,P-S)}}}return M.push(_.length),new i({values:_,index:T,ptr:M,size:[x-y+1,b-S+1]})}i.prototype.forEach=function(v,y){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var x=this,S=this._size[0],b=this._size[1],A=_c(v,x,"forEach"),E=0;E<b;E++){var _=this._ptr[E],T=this._ptr[E+1];if(y)for(var M=_;M<T;M++){var N=this._index[M];A.fn(this._values[M],[N,E],x)}else{for(var I={},F=_;F<T;F++){var P=this._index[F];I[P]=this._values[F]}for(var U=0;U<S;U++){var G=U in I?I[U]:0;A.fn(G,[U,E],x)}}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var v=this._size[1],y=0;y<v;y++)for(var x=this._ptr[y],S=this._ptr[y+1],b=x;b<S;b++){var A=this._index[b];yield{value:this._values[b],index:[A,y]}}},i.prototype.toArray=function(){return m(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return m(this._values,this._index,this._ptr,this._size,!1)};function m(v,y,x,S,b){var A=S[0],E=S[1],_=[],T,M;for(T=0;T<A;T++)for(_[T]=[],M=0;M<E;M++)_[T][M]=0;for(M=0;M<E;M++)for(var N=x[M],I=x[M+1],F=N;F<I;F++)T=y[F],_[T][M]=v?b?rr(v[F]):v[F]:1;return _}return i.prototype.format=function(v){for(var y=this._size[0],x=this._size[1],S=this.density(),b="Sparse Matrix ["+yr(y,v)+" x "+yr(x,v)+"] density: "+yr(S,v)+`
`,A=0;A<x;A++)for(var E=this._ptr[A],_=this._ptr[A+1],T=E;T<_;T++){var M=this._index[T];b+=`
    (`+yr(M,v)+", "+yr(A,v)+") ==> "+(this._values?yr(this._values[T],v):"X")}return b},i.prototype.toString=function(){return yr(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(v){if(v){if(or(v)&&(v=v.toNumber()),!sr(v)||!Bt(v))throw new TypeError("The parameter k must be an integer number")}else v=0;var y=v>0?v:0,x=v<0?-v:0,S=this._size[0],b=this._size[1],A=Math.min(S-x,b-y),E=[],_=[],T=[];T[0]=0;for(var M=y;M<b&&E.length<A;M++)for(var N=this._ptr[M],I=this._ptr[M+1],F=N;F<I;F++){var P=this._index[F];if(P===M-y+x){E.push(this._values[F]),_[E.length-1]=P-x;break}}return T.push(E.length),new i({values:E,index:_,ptr:T,size:[A,1]})},i.fromJSON=function(v){return new i(v)},i.diagonal=function(v,y,x,S,b){if(!Jr(v))throw new TypeError("Array expected, size parameter");if(v.length!==2)throw new Error("Only two dimensions matrix are supported");if(v=v.map(function(Z){if(or(Z)&&(Z=Z.toNumber()),!sr(Z)||!Bt(Z)||Z<1)throw new Error("Size values must be positive integers");return Z}),x){if(or(x)&&(x=x.toNumber()),!sr(x)||!Bt(x))throw new TypeError("The parameter k must be an integer number")}else x=0;var A=r,E=0;Fi(b)&&(A=e.find(r,[b,b])||r,E=e.convert(0,b));var _=x>0?x:0,T=x<0?-x:0,M=v[0],N=v[1],I=Math.min(M-T,N-_),F;if(Jr(y)){if(y.length!==I)throw new Error("Invalid value array length");F=function(z){return y[z]}}else if(Gt(y)){var P=y.size();if(P.length!==1||P[0]!==I)throw new Error("Invalid matrix length");F=function(z){return y.get([z])}}else F=function(){return y};for(var U=[],G=[],V=[],$=0;$<N;$++){V.push(U.length);var j=$-_;if(j>=0&&j<I){var k=F(j);A(k,E)||(G.push(j+T),U.push(k))}}return V.push(U.length),new i({values:U,index:G,ptr:V,size:[M,N]})},i.prototype.swapRows=function(v,y){if(!sr(v)||!Bt(v)||!sr(y)||!Bt(y))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return sn(v,this._size[0]),sn(y,this._size[0]),i._swapRows(v,y,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(v,y,x,S,b){for(var A=S[v],E=S[v+1],_=A;_<E;_++)b(x[_],y[_])},i._swapRows=function(v,y,x,S,b,A){for(var E=0;E<x;E++){var _=A[E],T=A[E+1],M=u(v,_,T,b),N=u(y,_,T,b);if(M<T&&N<T&&b[M]===v&&b[N]===y){if(S){var I=S[M];S[M]=S[N],S[N]=I}continue}if(M<T&&b[M]===v&&(N>=T||b[N]!==y)){var F=S?S[M]:void 0;b.splice(N,0,y),S&&S.splice(N,0,F),b.splice(N<=M?M+1:M,1),S&&S.splice(N<=M?M+1:M,1);continue}if(N<T&&b[N]===y&&(M>=T||b[M]!==v)){var P=S?S[N]:void 0;b.splice(M,0,v),S&&S.splice(M,0,P),b.splice(M<=N?N+1:N,1),S&&S.splice(M<=N?N+1:N,1)}}},i},{isClass:!0}),$X="number",kX=["typed"];function LX(t){var e=t.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);if(e){var r={"0b":2,"0o":8,"0x":16}[e[1]],n=e[2],i=e[3];return{input:t,radix:r,integerPart:n,fractionalPart:i}}else return null}function UX(t){for(var e=parseInt(t.integerPart,t.radix),r=0,n=0;n<t.fractionalPart.length;n++){var i=parseInt(t.fractionalPart[n],t.radix);r+=i/Math.pow(t.radix,n+1)}var a=e+r;if(isNaN(a))throw new SyntaxError('String "'+t.input+'" is not a valid number');return a}var zX=ee($X,kX,t=>{var{typed:e}=t,r=e("number",{"":function(){return 0},number:function(i){return i},string:function(i){if(i==="NaN")return NaN;var a=LX(i);if(a)return UX(a);var s=0,o=i.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);o&&(s=Number(o[2]),i=o[1]);var l=Number(i);if(isNaN(l))throw new SyntaxError('String "'+i+'" is not a valid number');if(o){if(l>2**s-1)throw new SyntaxError('String "'.concat(i,'" is out of range'));l>=2**(s-1)&&(l=l-2**s)}return l},BigNumber:function(i){return i.toNumber()},bigint:function(i){return Number(i)},Fraction:function(i){return i.valueOf()},Unit:e.referToSelf(n=>i=>{var a=i.clone();return a.value=n(i.value),a}),null:function(i){return 0},"Unit, string | Unit":function(i,a){return i.toNumber(a)},"Array | Matrix":e.referToSelf(n=>i=>ur(i,n))});return r.fromJSON=function(n){return parseFloat(n.value)},r}),GX="bigint",qX=["typed"],HX=ee(GX,qX,t=>{var{typed:e}=t,r=e("bigint",{"":function(){return 0n},bigint:function(i){return i},number:function(i){return BigInt(i.toFixed())},BigNumber:function(i){return BigInt(i.round().toString())},Fraction:function(i){return BigInt(i.valueOf().toFixed())},"string | boolean":function(i){return BigInt(i)},null:function(i){return 0n},"Array | Matrix":e.referToSelf(n=>i=>ur(i,n))});return r.fromJSON=function(n){return BigInt(n.value)},r}),eS="string",WX=["typed"],VX=ee(eS,WX,t=>{var{typed:e}=t;return e(eS,{"":function(){return""},number:vc,null:function(n){return"null"},boolean:function(n){return n+""},string:function(n){return n},"Array | Matrix":e.referToSelf(r=>n=>ur(n,r)),any:function(n){return String(n)}})}),tS="boolean",XX=["typed"],jX=ee(tS,XX,t=>{var{typed:e}=t;return e(tS,{"":function(){return!1},boolean:function(n){return n},number:function(n){return!!n},null:function(n){return!1},BigNumber:function(n){return!n.isZero()},string:function(n){var i=n.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;var a=Number(n);if(n!==""&&!isNaN(a))return!!a;throw new Error('Cannot convert "'+n+'" to a boolean')},"Array | Matrix":e.referToSelf(r=>n=>ur(n,r))})}),YX="bignumber",KX=["typed","BigNumber"],ZX=ee(YX,KX,t=>{var{typed:e,BigNumber:r}=t;return e("bignumber",{"":function(){return new r(0)},number:function(i){return new r(i+"")},string:function(i){var a=i.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(a){var s=a[2],o=r(a[1]),l=new r(2).pow(Number(s));if(o.gt(l.sub(1)))throw new SyntaxError('String "'.concat(i,'" is out of range'));var u=new r(2).pow(Number(s)-1);return o.gte(u)?o.sub(l):o}return new r(i)},BigNumber:function(i){return i},bigint:function(i){return new r(i.toString())},Unit:e.referToSelf(n=>i=>{var a=i.clone();return a.value=n(i.value),a}),Fraction:function(i){return new r(String(i.n)).div(String(i.d)).times(String(i.s))},null:function(i){return new r(0)},"Array | Matrix":e.referToSelf(n=>i=>ur(i,n))})}),QX="complex",JX=["typed","Complex"],ej=ee(QX,JX,t=>{var{typed:e,Complex:r}=t;return e("complex",{"":function(){return r.ZERO},number:function(i){return new r(i,0)},"number, number":function(i,a){return new r(i,a)},"BigNumber, BigNumber":function(i,a){return new r(i.toNumber(),a.toNumber())},Fraction:function(i){return new r(i.valueOf(),0)},Complex:function(i){return i.clone()},string:function(i){return r(i)},null:function(i){return r(0)},Object:function(i){if("re"in i&&"im"in i)return new r(i.re,i.im);if("r"in i&&"phi"in i||"abs"in i&&"arg"in i)return new r(i);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":e.referToSelf(n=>i=>ur(i,n))})}),tj="fraction",rj=["typed","Fraction"],nj=ee(tj,rj,t=>{var{typed:e,Fraction:r}=t;return e("fraction",{number:function(i){if(!isFinite(i)||isNaN(i))throw new Error(i+" cannot be represented as a fraction");return new r(i)},string:function(i){return new r(i)},"number, number":function(i,a){return new r(i,a)},"bigint, bigint":function(i,a){return new r(i,a)},null:function(i){return new r(0)},BigNumber:function(i){return new r(i.toString())},bigint:function(i){return new r(i.toString())},Fraction:function(i){return i},Unit:e.referToSelf(n=>i=>{var a=i.clone();return a.value=n(i.value),a}),Object:function(i){return new r(i)},"Array | Matrix":e.referToSelf(n=>i=>ur(i,n))})}),rS="matrix",ij=["typed","Matrix","DenseMatrix","SparseMatrix"],aj=ee(rS,ij,t=>{var{typed:e,Matrix:r,DenseMatrix:n,SparseMatrix:i}=t;return e(rS,{"":function(){return a([])},string:function(o){return a([],o)},"string, string":function(o,l){return a([],o,l)},Array:function(o){return a(o)},Matrix:function(o){return a(o,o.storage())},"Array | Matrix, string":a,"Array | Matrix, string, string":a});function a(s,o,l){if(o==="dense"||o==="default"||o===void 0)return new n(s,l);if(o==="sparse")return new i(s,l);throw new TypeError("Unknown matrix type "+JSON.stringify(o)+".")}}),nS="matrixFromFunction",sj=["typed","matrix","isZero"],oj=ee(nS,sj,t=>{var{typed:e,matrix:r,isZero:n}=t;return e(nS,{"Array | Matrix, function, string, string":function(s,o,l,u){return i(s,o,l,u)},"Array | Matrix, function, string":function(s,o,l){return i(s,o,l)},"Matrix, function":function(s,o){return i(s,o,"dense")},"Array, function":function(s,o){return i(s,o,"dense").toArray()},"Array | Matrix, string, function":function(s,o,l){return i(s,l,o)},"Array | Matrix, string, string, function":function(s,o,l,u){return i(s,u,o,l)}});function i(a,s,o,l){var u;return l!==void 0?u=r(o,l):u=r(o),u.resize(a),u.forEach(function(c,f){var h=s(f);n(h)||u.set(f,h)}),u}}),iS="matrixFromRows",uj=["typed","matrix","flatten","size"],lj=ee(iS,uj,t=>{var{typed:e,matrix:r,flatten:n,size:i}=t;return e(iS,{"...Array":function(l){return a(l)},"...Matrix":function(l){return r(a(l.map(u=>u.toArray())))}});function a(o){if(o.length===0)throw new TypeError("At least one row is needed to construct a matrix.");var l=s(o[0]),u=[];for(var c of o){var f=s(c);if(f!==l)throw new TypeError("The vectors had different length: "+(l|0)+" ≠ "+(f|0));u.push(n(c))}return u}function s(o){var l=i(o);if(l.length===1)return l[0];if(l.length===2){if(l[0]===1)return l[1];if(l[1]===1)return l[0];throw new TypeError("At least one of the arguments is not a vector.")}else throw new TypeError("Only one- or two-dimensional vectors are supported.")}}),aS="matrixFromColumns",cj=["typed","matrix","flatten","size"],fj=ee(aS,cj,t=>{var{typed:e,matrix:r,flatten:n,size:i}=t;return e(aS,{"...Array":function(l){return a(l)},"...Matrix":function(l){return r(a(l.map(u=>u.toArray())))}});function a(o){if(o.length===0)throw new TypeError("At least one column is needed to construct a matrix.");for(var l=s(o[0]),u=[],c=0;c<l;c++)u[c]=[];for(var f of o){var h=s(f);if(h!==l)throw new TypeError("The vectors had different length: "+(l|0)+" ≠ "+(h|0));for(var p=n(f),m=0;m<l;m++)u[m].push(p[m])}return u}function s(o){var l=i(o);if(l.length===1)return l[0];if(l.length===2){if(l[0]===1)return l[1];if(l[1]===1)return l[0];throw new TypeError("At least one of the arguments is not a vector.")}else throw new TypeError("Only one- or two-dimensional vectors are supported.")}}),sS="splitUnit",hj=["typed"],dj=ee(sS,hj,t=>{var{typed:e}=t;return e(sS,{"Unit, Array":function(n,i){return n.splitUnit(i)}})}),oS="unaryMinus",pj=["typed"],mj=ee(oS,pj,t=>{var{typed:e}=t;return e(oS,{number:CI,"Complex | BigNumber | Fraction":r=>r.neg(),bigint:r=>-r,Unit:e.referToSelf(r=>n=>{var i=n.clone();return i.value=e.find(r,i.valueType())(n.value),i}),"Array | Matrix":e.referToSelf(r=>n=>ur(n,r,!0))})}),uS="unaryPlus",vj=["typed","config","numeric"],gj=ee(uS,vj,t=>{var{typed:e,config:r,numeric:n}=t;return e(uS,{number:TI,Complex:function(a){return a},BigNumber:function(a){return a},bigint:function(a){return a},Fraction:function(a){return a},Unit:function(a){return a.clone()},"Array | Matrix":e.referToSelf(i=>a=>ur(a,i,!0)),boolean:function(a){return n(a?1:0,r.number)},string:function(a){return n(a,bl(a,r))}})}),lS="abs",yj=["typed"],bj=ee(lS,yj,t=>{var{typed:e}=t;return e(lS,{number:AI,"Complex | BigNumber | Fraction | Unit":r=>r.abs(),bigint:r=>r<0n?-r:r,"Array | Matrix":e.referToSelf(r=>n=>ur(n,r,!0))})}),cS="mapSlices",xj=["typed","isInteger"],j1=ee(cS,xj,t=>{var{typed:e,isInteger:r}=t;return e(cS,{"Array | Matrix, number | BigNumber, function":function(i,a,s){if(!r(a))throw new TypeError("Integer number expected for dimension");var o=Array.isArray(i)?er(i):i.size();if(a<0||a>=o.length)throw new zs(a,o.length);return Gt(i)?i.create(Ev(i.valueOf(),a,s),i.datatype()):Ev(i,a,s)}})},{formerly:"apply"});function Ev(t,e,r){var n,i,a;if(e<=0)if(Array.isArray(t[0])){for(a=wj(t),i=[],n=0;n<a.length;n++)i[n]=Ev(a[n],e-1,r);return i}else return r(t);else{for(i=[],n=0;n<t.length;n++)i[n]=Ev(t[n],e-1,r);return i}}function wj(t){var e=t.length,r=t[0].length,n,i,a=[];for(i=0;i<r;i++){var s=[];for(n=0;n<e;n++)s.push(t[n][i]);a.push(s)}return a}var fS="addScalar",_j=["typed"],Aj=ee(fS,_j,t=>{var{typed:e}=t;return e(fS,{"number, number":EI,"Complex, Complex":function(n,i){return n.add(i)},"BigNumber, BigNumber":function(n,i){return n.plus(i)},"bigint, bigint":function(n,i){return n+i},"Fraction, Fraction":function(n,i){return n.add(i)},"Unit, Unit":e.referToSelf(r=>(n,i)=>{if(n.value===null||n.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(i.value===null||i.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!n.equalBase(i))throw new Error("Units do not match");var a=n.clone();return a.value=e.find(r,[a.valueType(),i.valueType()])(a.value,i.value),a.fixPrefix=!1,a})})}),hS="subtractScalar",Ej=["typed"],Sj=ee(hS,Ej,t=>{var{typed:e}=t;return e(hS,{"number, number":SI,"Complex, Complex":function(n,i){return n.sub(i)},"BigNumber, BigNumber":function(n,i){return n.minus(i)},"bigint, bigint":function(n,i){return n-i},"Fraction, Fraction":function(n,i){return n.sub(i)},"Unit, Unit":e.referToSelf(r=>(n,i)=>{if(n.value===null||n.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(i.value===null||i.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!n.equalBase(i))throw new Error("Units do not match");var a=n.clone();return a.value=e.find(r,[a.valueType(),i.valueType()])(a.value,i.value),a.fixPrefix=!1,a})})}),dS="cbrt",Dj=["config","typed","isNegative","unaryMinus","matrix","Complex","BigNumber","Fraction"],Cj=ee(dS,Dj,t=>{var{config:e,typed:r,isNegative:n,unaryMinus:i,matrix:a,Complex:s,BigNumber:o,Fraction:l}=t;return r(dS,{number:dd,Complex:u,"Complex, boolean":u,BigNumber:function(h){return h.cbrt()},Unit:c});function u(f,h){var p=f.arg()/3,m=f.abs(),v=new s(dd(m),0).mul(new s(0,p).exp());if(h){var y=[v,new s(dd(m),0).mul(new s(0,p+Math.PI*2/3).exp()),new s(dd(m),0).mul(new s(0,p-Math.PI*2/3).exp())];return e.matrix==="Array"?y:a(y)}else return v}function c(f){if(f.value&&pu(f.value)){var h=f.clone();return h.value=1,h=h.pow(1/3),h.value=u(f.value),h}else{var p=n(f.value);p&&(f.value=i(f.value));var m;or(f.value)?m=new o(1).div(3):zd(f.value)?m=new l(1,3):m=1/3;var v=f.pow(m);return p&&(v.value=i(v.value)),v}}}),Tj="matAlgo11xS0s",Nj=["typed","equalScalar"],Ei=ee(Tj,Nj,t=>{var{typed:e,equalScalar:r}=t;return function(i,a,s,o){var l=i._values,u=i._index,c=i._ptr,f=i._size,h=i._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p=f[0],m=f[1],v,y=r,x=0,S=s;typeof h=="string"&&(v=h,y=e.find(r,[v,v]),x=e.convert(0,v),a=e.convert(a,v),S=e.find(s,[v,v]));for(var b=[],A=[],E=[],_=0;_<m;_++){E[_]=A.length;for(var T=c[_],M=c[_+1],N=T;N<M;N++){var I=u[N],F=o?S(a,l[N]):S(l[N],a);y(F,x)||(A.push(I),b.push(F))}}return E[m]=A.length,i.createSparseMatrix({values:b,index:A,ptr:E,size:[p,m],datatype:v})}}),Mj="matAlgo12xSfs",Ij=["typed","DenseMatrix"],Jn=ee(Mj,Ij,t=>{var{typed:e,DenseMatrix:r}=t;return function(i,a,s,o){var l=i._values,u=i._index,c=i._ptr,f=i._size,h=i._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p=f[0],m=f[1],v,y=s;typeof h=="string"&&(v=h,a=e.convert(a,v),y=e.find(s,[v,v]));for(var x=[],S=[],b=[],A=0;A<m;A++){for(var E=A+1,_=c[A],T=c[A+1],M=_;M<T;M++){var N=u[M];S[N]=l[M],b[N]=E}for(var I=0;I<p;I++)A===0&&(x[I]=[]),b[I]===E?x[I][A]=o?y(a,S[I]):y(S[I],a):x[I][A]=o?y(a,0):y(0,a)}return new r({data:x,size:[p,m],datatype:v})}}),Fj="matAlgo14xDs",Oj=["typed"],qs=ee(Fj,Oj,t=>{var{typed:e}=t;return function(i,a,s,o){var l=i._data,u=i._size,c=i._datatype,f,h=s;typeof c=="string"&&(f=c,a=e.convert(a,f),h=e.find(s,[f,f]));var p=u.length>0?r(h,0,u,u[0],l,a,o):[];return i.createDenseMatrix({data:p,size:rr(u),datatype:f})};function r(n,i,a,s,o,l,u){var c=[];if(i===a.length-1)for(var f=0;f<s;f++)c[f]=u?n(l,o[f]):n(o[f],l);else for(var h=0;h<s;h++)c[h]=r(n,i+1,a,a[i+1],o[h],l,u);return c}}),Y1="ceil",Bj=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],Rj=new pl(10),Pj=ee(Y1,["typed","config","round"],t=>{var{typed:e,config:r,round:n}=t;function i(a){var s=Math.ceil(a),o=n(a);return s===o?s:_i(a,o,r.relTol,r.absTol)&&!_i(a,s,r.relTol,r.absTol)?o:s}return e(Y1,{number:i,"number, number":function(s,o){if(!Bt(o))throw new RangeError("number of decimals in function ceil must be an integer");if(o<0||o>15)throw new RangeError("number of decimals in ceil number must be in range 0-15");var l=10**o;return i(s*l)/l}})}),$j=ee(Y1,Bj,t=>{var{typed:e,config:r,round:n,matrix:i,equalScalar:a,zeros:s,DenseMatrix:o}=t,l=Ei({typed:e,equalScalar:a}),u=Jn({typed:e,DenseMatrix:o}),c=qs({typed:e}),f=Pj({typed:e,config:r,round:n});function h(p){var m=(x,S)=>as(x,S,r.relTol,r.absTol),v=p.ceil(),y=n(p);return v.eq(y)?v:m(p,y)&&!m(p,v)?y:v}return e("ceil",{number:f.signatures.number,"number,number":f.signatures["number,number"],Complex:function(m){return m.ceil()},"Complex, number":function(m,v){return m.ceil(v)},"Complex, BigNumber":function(m,v){return m.ceil(v.toNumber())},BigNumber:h,"BigNumber, BigNumber":function(m,v){var y=Rj.pow(v);return h(m.mul(y)).div(y)},bigint:p=>p,"bigint, number":(p,m)=>p,"bigint, BigNumber":(p,m)=>p,Fraction:function(m){return m.ceil()},"Fraction, number":function(m,v){return m.ceil(v)},"Fraction, BigNumber":function(m,v){return m.ceil(v.toNumber())},"Unit, number, Unit":e.referToSelf(p=>function(m,v,y){var x=m.toNumeric(y);return y.multiply(p(x,v))}),"Unit, BigNumber, Unit":e.referToSelf(p=>(m,v,y)=>p(m,v.toNumber(),y)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(p=>(m,v,y)=>ur(m,x=>p(x,v,y),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(p=>(m,v)=>p(m,0,v)),"Array | Matrix":e.referToSelf(p=>m=>ur(m,p,!0)),"Array, number | BigNumber":e.referToSelf(p=>(m,v)=>ur(m,y=>p(y,v),!0)),"SparseMatrix, number | BigNumber":e.referToSelf(p=>(m,v)=>l(m,v,p,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(p=>(m,v)=>c(m,v,p,!1)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(p=>(m,v)=>c(i(v),m,p,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(p=>(m,v)=>a(m,0)?s(v.size(),v.storage()):v.storage()==="dense"?c(v,m,p,!0):u(v,m,p,!0))})}),pS="cube",kj=["typed"],Lj=ee(pS,kj,t=>{var{typed:e}=t;return e(pS,{number:NI,Complex:function(n){return n.mul(n).mul(n)},BigNumber:function(n){return n.times(n).times(n)},bigint:function(n){return n*n*n},Fraction:function(n){return n.pow(3)},Unit:function(n){return n.pow(3)}})}),mS="exp",Uj=["typed"],zj=ee(mS,Uj,t=>{var{typed:e}=t;return e(mS,{number:MI,Complex:function(n){return n.exp()},BigNumber:function(n){return n.exp()}})}),vS="expm1",Gj=["typed","Complex"],qj=ee(vS,Gj,t=>{var{typed:e,Complex:r}=t;return e(vS,{number:II,Complex:function(i){var a=Math.exp(i.re);return new r(a*Math.cos(i.im)-1,a*Math.sin(i.im))},BigNumber:function(i){return i.exp().minus(1)}})}),K1="fix",Hj=["typed","Complex","matrix","ceil","floor","equalScalar","zeros","DenseMatrix"],Wj=ee(K1,["typed","ceil","floor"],t=>{var{typed:e,ceil:r,floor:n}=t;return e(K1,{number:function(a){return a>0?n(a):r(a)},"number, number":function(a,s){return a>0?n(a,s):r(a,s)}})}),Vj=ee(K1,Hj,t=>{var{typed:e,Complex:r,matrix:n,ceil:i,floor:a,equalScalar:s,zeros:o,DenseMatrix:l}=t,u=Jn({typed:e,DenseMatrix:l}),c=qs({typed:e}),f=Wj({typed:e,ceil:i,floor:a});return e("fix",{number:f.signatures.number,"number, number | BigNumber":f.signatures["number,number"],Complex:function(p){return new r(p.re>0?Math.floor(p.re):Math.ceil(p.re),p.im>0?Math.floor(p.im):Math.ceil(p.im))},"Complex, number":function(p,m){return new r(p.re>0?a(p.re,m):i(p.re,m),p.im>0?a(p.im,m):i(p.im,m))},"Complex, BigNumber":function(p,m){var v=m.toNumber();return new r(p.re>0?a(p.re,v):i(p.re,v),p.im>0?a(p.im,v):i(p.im,v))},BigNumber:function(p){return p.isNegative()?i(p):a(p)},"BigNumber, number | BigNumber":function(p,m){return p.isNegative()?i(p,m):a(p,m)},bigint:h=>h,"bigint, number":(h,p)=>h,"bigint, BigNumber":(h,p)=>h,Fraction:function(p){return p.s<0n?p.ceil():p.floor()},"Fraction, number | BigNumber":function(p,m){return p.s<0n?i(p,m):a(p,m)},"Unit, number, Unit":e.referToSelf(h=>function(p,m,v){var y=p.toNumeric(v);return v.multiply(h(y,m))}),"Unit, BigNumber, Unit":e.referToSelf(h=>(p,m,v)=>h(p,m.toNumber(),v)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(h=>(p,m,v)=>ur(p,y=>h(y,m,v),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(h=>(p,m)=>h(p,0,m)),"Array | Matrix":e.referToSelf(h=>p=>ur(p,h,!0)),"Array | Matrix, number | BigNumber":e.referToSelf(h=>(p,m)=>ur(p,v=>h(v,m),!0)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(h=>(p,m)=>c(n(m),p,h,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(h=>(p,m)=>s(p,0)?o(m.size(),m.storage()):m.storage()==="dense"?c(m,p,h,!0):u(m,p,h,!0))})}),Z1="floor",Xj=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],jj=new pl(10),Yj=ee(Z1,["typed","config","round"],t=>{var{typed:e,config:r,round:n}=t;function i(a){var s=Math.floor(a),o=n(a);return s===o?s:_i(a,o,r.relTol,r.absTol)&&!_i(a,s,r.relTol,r.absTol)?o:s}return e(Z1,{number:i,"number, number":function(s,o){if(!Bt(o))throw new RangeError("number of decimals in function floor must be an integer");if(o<0||o>15)throw new RangeError("number of decimals in floor number must be in range 0 - 15");var l=10**o;return i(s*l)/l}})}),hF=ee(Z1,Xj,t=>{var{typed:e,config:r,round:n,matrix:i,equalScalar:a,zeros:s,DenseMatrix:o}=t,l=Ei({typed:e,equalScalar:a}),u=Jn({typed:e,DenseMatrix:o}),c=qs({typed:e}),f=Yj({typed:e,config:r,round:n});function h(p){var m=(x,S)=>as(x,S,r.relTol,r.absTol),v=p.floor(),y=n(p);return v.eq(y)?v:m(p,y)&&!m(p,v)?y:v}return e("floor",{number:f.signatures.number,"number,number":f.signatures["number,number"],Complex:function(m){return m.floor()},"Complex, number":function(m,v){return m.floor(v)},"Complex, BigNumber":function(m,v){return m.floor(v.toNumber())},BigNumber:h,"BigNumber, BigNumber":function(m,v){var y=jj.pow(v);return h(m.mul(y)).div(y)},bigint:p=>p,"bigint, number":(p,m)=>p,"bigint, BigNumber":(p,m)=>p,Fraction:function(m){return m.floor()},"Fraction, number":function(m,v){return m.floor(v)},"Fraction, BigNumber":function(m,v){return m.floor(v.toNumber())},"Unit, number, Unit":e.referToSelf(p=>function(m,v,y){var x=m.toNumeric(y);return y.multiply(p(x,v))}),"Unit, BigNumber, Unit":e.referToSelf(p=>(m,v,y)=>p(m,v.toNumber(),y)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(p=>(m,v,y)=>ur(m,x=>p(x,v,y),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(p=>(m,v)=>p(m,0,v)),"Array | Matrix":e.referToSelf(p=>m=>ur(m,p,!0)),"Array, number | BigNumber":e.referToSelf(p=>(m,v)=>ur(m,y=>p(y,v),!0)),"SparseMatrix, number | BigNumber":e.referToSelf(p=>(m,v)=>l(m,v,p,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(p=>(m,v)=>c(m,v,p,!1)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(p=>(m,v)=>c(i(v),m,p,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(p=>(m,v)=>a(m,0)?s(v.size(),v.storage()):v.storage()==="dense"?c(v,m,p,!0):u(v,m,p,!0))})}),Kj="matAlgo02xDS0",Zj=["typed","equalScalar"],Hs=ee(Kj,Zj,t=>{var{typed:e,equalScalar:r}=t;return function(i,a,s,o){var l=i._data,u=i._size,c=i._datatype||i.getDataType(),f=a._values,h=a._index,p=a._ptr,m=a._size,v=a._datatype||a._data===void 0?a._datatype:a.getDataType();if(u.length!==m.length)throw new br(u.length,m.length);if(u[0]!==m[0]||u[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+m+")");if(!f)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var y=u[0],x=u[1],S,b=r,A=0,E=s;typeof c=="string"&&c===v&&c!=="mixed"&&(S=c,b=e.find(r,[S,S]),A=e.convert(0,S),E=e.find(s,[S,S]));for(var _=[],T=[],M=[],N=0;N<x;N++){M[N]=T.length;for(var I=p[N],F=p[N+1],P=I;P<F;P++){var U=h[P],G=o?E(f[P],l[U][N]):E(l[U][N],f[P]);b(G,A)||(T.push(U),_.push(G))}}return M[x]=T.length,a.createSparseMatrix({values:_,index:T,ptr:M,size:[y,x],datatype:c===i._datatype&&v===a._datatype?S:void 0})}}),Qj="matAlgo03xDSf",Jj=["typed"],Zi=ee(Qj,Jj,t=>{var{typed:e}=t;return function(n,i,a,s){var o=n._data,l=n._size,u=n._datatype||n.getDataType(),c=i._values,f=i._index,h=i._ptr,p=i._size,m=i._datatype||i._data===void 0?i._datatype:i.getDataType();if(l.length!==p.length)throw new br(l.length,p.length);if(l[0]!==p[0]||l[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+p+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var v=l[0],y=l[1],x,S=0,b=a;typeof u=="string"&&u===m&&u!=="mixed"&&(x=u,S=e.convert(0,x),b=e.find(a,[x,x]));for(var A=[],E=0;E<v;E++)A[E]=[];for(var _=[],T=[],M=0;M<y;M++){for(var N=M+1,I=h[M],F=h[M+1],P=I;P<F;P++){var U=f[P];_[U]=s?b(c[P],o[U][M]):b(o[U][M],c[P]),T[U]=N}for(var G=0;G<v;G++)T[G]===N?A[G][M]=_[G]:A[G][M]=s?b(S,o[G][M]):b(o[G][M],S)}return n.createDenseMatrix({data:A,size:[v,y],datatype:u===n._datatype&&m===i._datatype?x:void 0})}}),eY="matAlgo05xSfSf",tY=["typed","equalScalar"],cg=ee(eY,tY,t=>{var{typed:e,equalScalar:r}=t;return function(i,a,s){var o=i._values,l=i._index,u=i._ptr,c=i._size,f=i._datatype||i._data===void 0?i._datatype:i.getDataType(),h=a._values,p=a._index,m=a._ptr,v=a._size,y=a._datatype||a._data===void 0?a._datatype:a.getDataType();if(c.length!==v.length)throw new br(c.length,v.length);if(c[0]!==v[0]||c[1]!==v[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+v+")");var x=c[0],S=c[1],b,A=r,E=0,_=s;typeof f=="string"&&f===y&&f!=="mixed"&&(b=f,A=e.find(r,[b,b]),E=e.convert(0,b),_=e.find(s,[b,b]));var T=o&&h?[]:void 0,M=[],N=[],I=T?[]:void 0,F=T?[]:void 0,P=[],U=[],G,V,$,j;for(V=0;V<S;V++){N[V]=M.length;var k=V+1;for($=u[V],j=u[V+1];$<j;$++)G=l[$],M.push(G),P[G]=k,I&&(I[G]=o[$]);for($=m[V],j=m[V+1];$<j;$++)G=p[$],P[G]!==k&&M.push(G),U[G]=k,F&&(F[G]=h[$]);if(T)for($=N[V];$<M.length;){G=M[$];var Z=P[G],z=U[G];if(Z===k||z===k){var me=Z===k?I[G]:E,fe=z===k?F[G]:E,ue=_(me,fe);A(ue,E)?M.splice($,1):(T.push(ue),$++)}}}return N[S]=M.length,i.createSparseMatrix({values:T,index:M,ptr:N,size:[x,S],datatype:f===i._datatype&&y===a._datatype?b:void 0})}}),rY="matAlgo13xDD",nY=["typed"],iY=ee(rY,nY,t=>{var{typed:e}=t;return function(i,a,s){var o=i._data,l=i._size,u=i._datatype,c=a._data,f=a._size,h=a._datatype,p=[];if(l.length!==f.length)throw new br(l.length,f.length);for(var m=0;m<l.length;m++){if(l[m]!==f[m])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");p[m]=l[m]}var v,y=s;typeof u=="string"&&u===h&&(v=u,y=e.find(s,[v,v]));var x=p.length>0?r(y,0,p,p[0],o,c):[];return i.createDenseMatrix({data:x,size:p,datatype:v})};function r(n,i,a,s,o,l){var u=[];if(i===a.length-1)for(var c=0;c<s;c++)u[c]=n(o[c],l[c]);else for(var f=0;f<s;f++)u[f]=r(n,i+1,a,a[i+1],o[f],l[f]);return u}});function oi(t,e){if(yu(t.size(),e.size()))return[t,e];var r=Xb(t.size(),e.size());return[t,e].map(n=>aY(n,r))}function aY(t,e){return yu(t.size(),e)?t:t.create(hc(t.valueOf(),e),t.datatype())}var sY="matrixAlgorithmSuite",oY=["typed","matrix"],on=ee(sY,oY,t=>{var{typed:e,matrix:r}=t,n=iY({typed:e}),i=qs({typed:e});return function(s){var o=s.elop,l=s.SD||s.DS,u;o?(u={"DenseMatrix, DenseMatrix":(p,m)=>n(...oi(p,m),o),"Array, Array":(p,m)=>n(...oi(r(p),r(m)),o).valueOf(),"Array, DenseMatrix":(p,m)=>n(...oi(r(p),m),o),"DenseMatrix, Array":(p,m)=>n(...oi(p,r(m)),o)},s.SS&&(u["SparseMatrix, SparseMatrix"]=(p,m)=>s.SS(...oi(p,m),o,!1)),s.DS&&(u["DenseMatrix, SparseMatrix"]=(p,m)=>s.DS(...oi(p,m),o,!1),u["Array, SparseMatrix"]=(p,m)=>s.DS(...oi(r(p),m),o,!1)),l&&(u["SparseMatrix, DenseMatrix"]=(p,m)=>l(...oi(m,p),o,!0),u["SparseMatrix, Array"]=(p,m)=>l(...oi(r(m),p),o,!0))):(u={"DenseMatrix, DenseMatrix":e.referToSelf(p=>(m,v)=>n(...oi(m,v),p)),"Array, Array":e.referToSelf(p=>(m,v)=>n(...oi(r(m),r(v)),p).valueOf()),"Array, DenseMatrix":e.referToSelf(p=>(m,v)=>n(...oi(r(m),v),p)),"DenseMatrix, Array":e.referToSelf(p=>(m,v)=>n(...oi(m,r(v)),p))},s.SS&&(u["SparseMatrix, SparseMatrix"]=e.referToSelf(p=>(m,v)=>s.SS(...oi(m,v),p,!1))),s.DS&&(u["DenseMatrix, SparseMatrix"]=e.referToSelf(p=>(m,v)=>s.DS(...oi(m,v),p,!1)),u["Array, SparseMatrix"]=e.referToSelf(p=>(m,v)=>s.DS(...oi(r(m),v),p,!1))),l&&(u["SparseMatrix, DenseMatrix"]=e.referToSelf(p=>(m,v)=>l(...oi(v,m),p,!0)),u["SparseMatrix, Array"]=e.referToSelf(p=>(m,v)=>l(...oi(r(v),m),p,!0))));var c=s.scalar||"any",f=s.Ds||s.Ss;f&&(o?(u["DenseMatrix,"+c]=(p,m)=>i(p,m,o,!1),u[c+", DenseMatrix"]=(p,m)=>i(m,p,o,!0),u["Array,"+c]=(p,m)=>i(r(p),m,o,!1).valueOf(),u[c+", Array"]=(p,m)=>i(r(m),p,o,!0).valueOf()):(u["DenseMatrix,"+c]=e.referToSelf(p=>(m,v)=>i(m,v,p,!1)),u[c+", DenseMatrix"]=e.referToSelf(p=>(m,v)=>i(v,m,p,!0)),u["Array,"+c]=e.referToSelf(p=>(m,v)=>i(r(m),v,p,!1).valueOf()),u[c+", Array"]=e.referToSelf(p=>(m,v)=>i(r(v),m,p,!0).valueOf())));var h=s.sS!==void 0?s.sS:s.Ss;return o?(s.Ss&&(u["SparseMatrix,"+c]=(p,m)=>s.Ss(p,m,o,!1)),h&&(u[c+", SparseMatrix"]=(p,m)=>h(m,p,o,!0))):(s.Ss&&(u["SparseMatrix,"+c]=e.referToSelf(p=>(m,v)=>s.Ss(m,v,p,!1))),h&&(u[c+", SparseMatrix"]=e.referToSelf(p=>(m,v)=>h(v,m,p,!0)))),o&&o.signatures&&jM(u,o.signatures),u}}),gS="mod",uY=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix","concat"],dF=ee(gS,uY,t=>{var{typed:e,config:r,round:n,matrix:i,equalScalar:a,zeros:s,DenseMatrix:o,concat:l}=t,u=hF({typed:e,config:r,round:n,matrix:i,equalScalar:a,zeros:s,DenseMatrix:o}),c=Hs({typed:e,equalScalar:a}),f=Zi({typed:e}),h=cg({typed:e,equalScalar:a}),p=Ei({typed:e,equalScalar:a}),m=Jn({typed:e,DenseMatrix:o}),v=on({typed:e,matrix:i,concat:l});return e(gS,{"number, number":y,"BigNumber, BigNumber":function(S,b){return b.isZero()?S:S.sub(b.mul(u(S.div(b))))},"bigint, bigint":function(S,b){if(b===0n)return S;if(S<0){var A=S%b;return A===0n?A:A+b}return S%b},"Fraction, Fraction":function(S,b){return b.equals(0)?S:S.sub(b.mul(u(S.div(b))))}},v({SS:h,DS:f,SD:c,Ss:p,sS:m}));function y(x,S){return S===0?x:x-S*u(x/S)}}),lY="matAlgo01xDSid",cY=["typed"],wl=ee(lY,cY,t=>{var{typed:e}=t;return function(n,i,a,s){var o=n._data,l=n._size,u=n._datatype||n.getDataType(),c=i._values,f=i._index,h=i._ptr,p=i._size,m=i._datatype||i._data===void 0?i._datatype:i.getDataType();if(l.length!==p.length)throw new br(l.length,p.length);if(l[0]!==p[0]||l[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+p+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var v=l[0],y=l[1],x=typeof u=="string"&&u!=="mixed"&&u===m?u:void 0,S=x?e.find(a,[x,x]):a,b,A,E=[];for(b=0;b<v;b++)E[b]=[];var _=[],T=[];for(A=0;A<y;A++){for(var M=A+1,N=h[A],I=h[A+1],F=N;F<I;F++)b=f[F],_[b]=s?S(c[F],o[b][A]):S(o[b][A],c[F]),T[b]=M;for(b=0;b<v;b++)T[b]===M?E[b][A]=_[b]:E[b][A]=o[b][A]}return n.createDenseMatrix({data:E,size:[v,y],datatype:u===n._datatype&&m===i._datatype?x:void 0})}}),fY="matAlgo04xSidSid",hY=["typed","equalScalar"],Zb=ee(fY,hY,t=>{var{typed:e,equalScalar:r}=t;return function(i,a,s){var o=i._values,l=i._index,u=i._ptr,c=i._size,f=i._datatype||i._data===void 0?i._datatype:i.getDataType(),h=a._values,p=a._index,m=a._ptr,v=a._size,y=a._datatype||a._data===void 0?a._datatype:a.getDataType();if(c.length!==v.length)throw new br(c.length,v.length);if(c[0]!==v[0]||c[1]!==v[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+v+")");var x=c[0],S=c[1],b,A=r,E=0,_=s;typeof f=="string"&&f===y&&f!=="mixed"&&(b=f,A=e.find(r,[b,b]),E=e.convert(0,b),_=e.find(s,[b,b]));var T=o&&h?[]:void 0,M=[],N=[],I=o&&h?[]:void 0,F=o&&h?[]:void 0,P=[],U=[],G,V,$,j,k;for(V=0;V<S;V++){N[V]=M.length;var Z=V+1;for(j=u[V],k=u[V+1],$=j;$<k;$++)G=l[$],M.push(G),P[G]=Z,I&&(I[G]=o[$]);for(j=m[V],k=m[V+1],$=j;$<k;$++)if(G=p[$],P[G]===Z){if(I){var z=_(I[G],h[$]);A(z,E)?P[G]=null:I[G]=z}}else M.push(G),U[G]=Z,F&&(F[G]=h[$]);if(I&&F)for($=N[V];$<M.length;)G=M[$],P[G]===Z?(T[$]=I[G],$++):U[G]===Z?(T[$]=F[G],$++):M.splice($,1)}return N[S]=M.length,i.createSparseMatrix({values:T,index:M,ptr:N,size:[x,S],datatype:f===i._datatype&&y===a._datatype?b:void 0})}}),dY="matAlgo10xSids",pY=["typed","DenseMatrix"],Dc=ee(dY,pY,t=>{var{typed:e,DenseMatrix:r}=t;return function(i,a,s,o){var l=i._values,u=i._index,c=i._ptr,f=i._size,h=i._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p=f[0],m=f[1],v,y=s;typeof h=="string"&&(v=h,a=e.convert(a,v),y=e.find(s,[v,v]));for(var x=[],S=[],b=[],A=0;A<m;A++){for(var E=A+1,_=c[A],T=c[A+1],M=_;M<T;M++){var N=u[M];S[N]=l[M],b[N]=E}for(var I=0;I<p;I++)A===0&&(x[I]=[]),b[I]===E?x[I][A]=o?y(a,S[I]):y(S[I],a):x[I][A]=a}return new r({data:x,size:[p,m],datatype:v})}});function Cc(t,e,r,n){if(!(this instanceof Cc))throw new SyntaxError("Constructor must be called with the new operator");this.fn=t,this.count=e,this.min=r,this.max=n,this.message="Wrong number of arguments in function "+t+" ("+e+" provided, "+r+(n!=null?"-"+n:"")+" expected)",this.stack=new Error().stack}Cc.prototype=new Error;Cc.prototype.constructor=Error;Cc.prototype.name="ArgumentsError";Cc.prototype.isArgumentsError=!0;var yS="gcd",mY=["typed","config","round","matrix","equalScalar","zeros","BigNumber","DenseMatrix","concat"],oy="number | BigNumber | Fraction | Matrix | Array",vY="".concat(oy,", ").concat(oy,", ...").concat(oy);function bS(t){return!t.some(e=>Array.isArray(e))}var gY=ee(yS,mY,t=>{var{typed:e,matrix:r,config:n,round:i,equalScalar:a,zeros:s,BigNumber:o,DenseMatrix:l,concat:u}=t,c=dF({typed:e,config:n,round:i,matrix:r,equalScalar:a,zeros:s,DenseMatrix:l,concat:u}),f=wl({typed:e}),h=Zb({typed:e,equalScalar:a}),p=Dc({typed:e,DenseMatrix:l}),m=on({typed:e,matrix:r,concat:u});return e(yS,{"number, number":v,"BigNumber, BigNumber":y,"Fraction, Fraction":(x,S)=>x.gcd(S)},m({SS:h,DS:f,Ss:p}),{[vY]:e.referToSelf(x=>(S,b,A)=>{for(var E=x(S,b),_=0;_<A.length;_++)E=x(E,A[_]);return E}),Array:e.referToSelf(x=>S=>{if(S.length===1&&Array.isArray(S[0])&&bS(S[0]))return x(...S[0]);if(bS(S))return x(...S);throw new Cc("gcd() supports only 1d matrices!")}),Matrix:e.referToSelf(x=>S=>x(S.toArray()))});function v(x,S){if(!Bt(x)||!Bt(S))throw new Error("Parameters in function gcd must be integer numbers");for(var b;S!==0;)b=c(x,S),x=S,S=b;return x<0?-x:x}function y(x,S){if(!x.isInt()||!S.isInt())throw new Error("Parameters in function gcd must be integer numbers");for(var b=new o(0);!S.isZero();){var A=c(x,S);x=S,S=A}return x.lt(b)?x.neg():x}}),yY="matAlgo06xS0S0",bY=["typed","equalScalar"],fg=ee(yY,bY,t=>{var{typed:e,equalScalar:r}=t;return function(i,a,s){var o=i._values,l=i._size,u=i._datatype||i._data===void 0?i._datatype:i.getDataType(),c=a._values,f=a._size,h=a._datatype||a._data===void 0?a._datatype:a.getDataType();if(l.length!==f.length)throw new br(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");var p=l[0],m=l[1],v,y=r,x=0,S=s;typeof u=="string"&&u===h&&u!=="mixed"&&(v=u,y=e.find(r,[v,v]),x=e.convert(0,v),S=e.find(s,[v,v]));for(var b=o&&c?[]:void 0,A=[],E=[],_=b?[]:void 0,T=[],M=[],N=0;N<m;N++){E[N]=A.length;var I=N+1;if(GE(i,N,T,_,M,I,A,S),GE(a,N,T,_,M,I,A,S),_)for(var F=E[N];F<A.length;){var P=A[F];if(M[P]===I){var U=_[P];y(U,x)?A.splice(F,1):(b.push(U),F++)}else A.splice(F,1)}else for(var G=E[N];G<A.length;){var V=A[G];M[V]!==I?A.splice(G,1):G++}}return E[m]=A.length,i.createSparseMatrix({values:b,index:A,ptr:E,size:[p,m],datatype:u===i._datatype&&h===a._datatype?v:void 0})}}),xS="lcm",xY=["typed","matrix","equalScalar","concat"],wY=ee(xS,xY,t=>{var{typed:e,matrix:r,equalScalar:n,concat:i}=t,a=Hs({typed:e,equalScalar:n}),s=fg({typed:e,equalScalar:n}),o=Ei({typed:e,equalScalar:n}),l=on({typed:e,matrix:r,concat:i}),u="number | BigNumber | Fraction | Matrix | Array",c={};return c["".concat(u,", ").concat(u,", ...").concat(u)]=e.referToSelf(h=>(p,m,v)=>{for(var y=h(p,m),x=0;x<v.length;x++)y=h(y,v[x]);return y}),e(xS,{"number, number":FI,"BigNumber, BigNumber":f,"Fraction, Fraction":(h,p)=>h.lcm(p)},l({SS:s,DS:a,Ss:o}),c);function f(h,p){if(!h.isInt()||!p.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(h.isZero())return h;if(p.isZero())return p;for(var m=h.times(p);!p.isZero();){var v=p;p=h.mod(v),h=v}return m.div(h).abs()}});function Qb(t,e,r,n){return function(i){if(i>0||r.predictable){if(i<=0)return NaN;var a=i.toString(16),s=a.substring(0,15);return t*(a.length-s.length)+e(+("0x"+s))}return n(i.toNumber())}}var wS="log10",_Y=["typed","config","Complex"],AY=xv(16),EY=ee(wS,_Y,t=>{var{typed:e,config:r,Complex:n}=t;function i(s){return s.log().div(Math.LN10)}function a(s){return i(new n(s,0))}return e(wS,{number:function(o){return o>=0||r.predictable?xv(o):a(o)},bigint:Qb(AY,xv,r,a),Complex:i,BigNumber:function(o){return!o.isNegative()||r.predictable?o.log():a(o.toNumber())},"Array | Matrix":e.referToSelf(s=>o=>ur(o,s))})}),_S="log2",SY=["typed","config","Complex"],DY=ee(_S,SY,t=>{var{typed:e,config:r,Complex:n}=t;function i(s){return a(new n(s,0))}return e(_S,{number:function(o){return o>=0||r.predictable?q1(o):i(o)},bigint:Qb(4,q1,r,i),Complex:a,BigNumber:function(o){return!o.isNegative()||r.predictable?o.log(2):i(o.toNumber())},"Array | Matrix":e.referToSelf(s=>o=>ur(o,s))});function a(s){var o=Math.sqrt(s.re*s.re+s.im*s.im);return new n(Math.log2?Math.log2(o):Math.log(o)/Math.LN2,Math.atan2(s.im,s.re)/Math.LN2)}}),CY="multiplyScalar",TY=["typed"],NY=ee(CY,TY,t=>{var{typed:e}=t;return e("multiplyScalar",{"number, number":DI,"Complex, Complex":function(n,i){return n.mul(i)},"BigNumber, BigNumber":function(n,i){return n.times(i)},"bigint, bigint":function(n,i){return n*i},"Fraction, Fraction":function(n,i){return n.mul(i)},"number | Fraction | BigNumber | Complex, Unit":(r,n)=>n.multiply(r),"Unit, number | Fraction | BigNumber | Complex | Unit":(r,n)=>r.multiply(n)})}),AS="multiply",MY=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],IY=ee(AS,MY,t=>{var{typed:e,matrix:r,addScalar:n,multiplyScalar:i,equalScalar:a,dot:s}=t,o=Ei({typed:e,equalScalar:a}),l=qs({typed:e});function u(E,_){switch(E.length){case 1:switch(_.length){case 1:if(E[0]!==_[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(E[0]!==_[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+E[0]+") must match Matrix rows ("+_[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+_.length+" dimensions)")}break;case 2:switch(_.length){case 1:if(E[1]!==_[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+E[1]+") must match Vector length ("+_[0]+")");break;case 2:if(E[1]!==_[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+E[1]+") must match Matrix B rows ("+_[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+_.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+E.length+" dimensions)")}}function c(E,_,T){if(T===0)throw new Error("Cannot multiply two empty vectors");return s(E,_)}function f(E,_){if(_.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return h(E,_)}function h(E,_){var T=E._data,M=E._size,N=E._datatype||E.getDataType(),I=_._data,F=_._size,P=_._datatype||_.getDataType(),U=M[0],G=F[1],V,$=n,j=i;N&&P&&N===P&&typeof N=="string"&&N!=="mixed"&&(V=N,$=e.find(n,[V,V]),j=e.find(i,[V,V]));for(var k=[],Z=0;Z<G;Z++){for(var z=j(T[0],I[0][Z]),me=1;me<U;me++)z=$(z,j(T[me],I[me][Z]));k[Z]=z}return E.createDenseMatrix({data:k,size:[G],datatype:N===E._datatype&&P===_._datatype?V:void 0})}var p=e("_multiplyMatrixVector",{"DenseMatrix, any":v,"SparseMatrix, any":S}),m=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":y,"DenseMatrix, SparseMatrix":x,"SparseMatrix, DenseMatrix":b,"SparseMatrix, SparseMatrix":A});function v(E,_){var T=E._data,M=E._size,N=E._datatype||E.getDataType(),I=_._data,F=_._datatype||_.getDataType(),P=M[0],U=M[1],G,V=n,$=i;N&&F&&N===F&&typeof N=="string"&&N!=="mixed"&&(G=N,V=e.find(n,[G,G]),$=e.find(i,[G,G]));for(var j=[],k=0;k<P;k++){for(var Z=T[k],z=$(Z[0],I[0]),me=1;me<U;me++)z=V(z,$(Z[me],I[me]));j[k]=z}return E.createDenseMatrix({data:j,size:[P],datatype:N===E._datatype&&F===_._datatype?G:void 0})}function y(E,_){var T=E._data,M=E._size,N=E._datatype||E.getDataType(),I=_._data,F=_._size,P=_._datatype||_.getDataType(),U=M[0],G=M[1],V=F[1],$,j=n,k=i;N&&P&&N===P&&typeof N=="string"&&N!=="mixed"&&N!=="mixed"&&($=N,j=e.find(n,[$,$]),k=e.find(i,[$,$]));for(var Z=[],z=0;z<U;z++){var me=T[z];Z[z]=[];for(var fe=0;fe<V;fe++){for(var ue=k(me[0],I[0][fe]),le=1;le<G;le++)ue=j(ue,k(me[le],I[le][fe]));Z[z][fe]=ue}}return E.createDenseMatrix({data:Z,size:[U,V],datatype:N===E._datatype&&P===_._datatype?$:void 0})}function x(E,_){var T=E._data,M=E._size,N=E._datatype||E.getDataType(),I=_._values,F=_._index,P=_._ptr,U=_._size,G=_._datatype||_._data===void 0?_._datatype:_.getDataType();if(!I)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var V=M[0],$=U[1],j,k=n,Z=i,z=a,me=0;N&&G&&N===G&&typeof N=="string"&&N!=="mixed"&&(j=N,k=e.find(n,[j,j]),Z=e.find(i,[j,j]),z=e.find(a,[j,j]),me=e.convert(0,j));for(var fe=[],ue=[],le=[],ke=_.createSparseMatrix({values:fe,index:ue,ptr:le,size:[V,$],datatype:N===E._datatype&&G===_._datatype?j:void 0}),Me=0;Me<$;Me++){le[Me]=ue.length;var Se=P[Me],oe=P[Me+1];if(oe>Se)for(var K=0,de=0;de<V;de++){for(var _e=de+1,be=void 0,$e=Se;$e<oe;$e++){var Oe=F[$e];K!==_e?(be=Z(T[de][Oe],I[$e]),K=_e):be=k(be,Z(T[de][Oe],I[$e]))}K===_e&&!z(be,me)&&(ue.push(de),fe.push(be))}}return le[$]=ue.length,ke}function S(E,_){var T=E._values,M=E._index,N=E._ptr,I=E._datatype||E._data===void 0?E._datatype:E.getDataType();if(!T)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var F=_._data,P=_._datatype||_.getDataType(),U=E._size[0],G=_._size[0],V=[],$=[],j=[],k,Z=n,z=i,me=a,fe=0;I&&P&&I===P&&typeof I=="string"&&I!=="mixed"&&(k=I,Z=e.find(n,[k,k]),z=e.find(i,[k,k]),me=e.find(a,[k,k]),fe=e.convert(0,k));var ue=[],le=[];j[0]=0;for(var ke=0;ke<G;ke++){var Me=F[ke];if(!me(Me,fe))for(var Se=N[ke],oe=N[ke+1],K=Se;K<oe;K++){var de=M[K];le[de]?ue[de]=Z(ue[de],z(Me,T[K])):(le[de]=!0,$.push(de),ue[de]=z(Me,T[K]))}}for(var _e=$.length,be=0;be<_e;be++){var $e=$[be];V[be]=ue[$e]}return j[1]=$.length,E.createSparseMatrix({values:V,index:$,ptr:j,size:[U,1],datatype:I===E._datatype&&P===_._datatype?k:void 0})}function b(E,_){var T=E._values,M=E._index,N=E._ptr,I=E._datatype||E._data===void 0?E._datatype:E.getDataType();if(!T)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var F=_._data,P=_._datatype||_.getDataType(),U=E._size[0],G=_._size[0],V=_._size[1],$,j=n,k=i,Z=a,z=0;I&&P&&I===P&&typeof I=="string"&&I!=="mixed"&&($=I,j=e.find(n,[$,$]),k=e.find(i,[$,$]),Z=e.find(a,[$,$]),z=e.convert(0,$));for(var me=[],fe=[],ue=[],le=E.createSparseMatrix({values:me,index:fe,ptr:ue,size:[U,V],datatype:I===E._datatype&&P===_._datatype?$:void 0}),ke=[],Me=[],Se=0;Se<V;Se++){ue[Se]=fe.length;for(var oe=Se+1,K=0;K<G;K++){var de=F[K][Se];if(!Z(de,z))for(var _e=N[K],be=N[K+1],$e=_e;$e<be;$e++){var Oe=M[$e];Me[Oe]!==oe?(Me[Oe]=oe,fe.push(Oe),ke[Oe]=k(de,T[$e])):ke[Oe]=j(ke[Oe],k(de,T[$e]))}}for(var Qe=ue[Se],ae=fe.length,ce=Qe;ce<ae;ce++){var Ce=fe[ce];me[ce]=ke[Ce]}}return ue[V]=fe.length,le}function A(E,_){var T=E._values,M=E._index,N=E._ptr,I=E._datatype||E._data===void 0?E._datatype:E.getDataType(),F=_._values,P=_._index,U=_._ptr,G=_._datatype||_._data===void 0?_._datatype:_.getDataType(),V=E._size[0],$=_._size[1],j=T&&F,k,Z=n,z=i;I&&G&&I===G&&typeof I=="string"&&I!=="mixed"&&(k=I,Z=e.find(n,[k,k]),z=e.find(i,[k,k]));for(var me=j?[]:void 0,fe=[],ue=[],le=E.createSparseMatrix({values:me,index:fe,ptr:ue,size:[V,$],datatype:I===E._datatype&&G===_._datatype?k:void 0}),ke=j?[]:void 0,Me=[],Se,oe,K,de,_e,be,$e,Oe,Qe=0;Qe<$;Qe++){ue[Qe]=fe.length;var ae=Qe+1;for(_e=U[Qe],be=U[Qe+1],de=_e;de<be;de++)if(Oe=P[de],j)for(oe=N[Oe],K=N[Oe+1],Se=oe;Se<K;Se++)$e=M[Se],Me[$e]!==ae?(Me[$e]=ae,fe.push($e),ke[$e]=z(F[de],T[Se])):ke[$e]=Z(ke[$e],z(F[de],T[Se]));else for(oe=N[Oe],K=N[Oe+1],Se=oe;Se<K;Se++)$e=M[Se],Me[$e]!==ae&&(Me[$e]=ae,fe.push($e));if(j)for(var ce=ue[Qe],Ce=fe.length,Ue=ce;Ue<Ce;Ue++){var Ve=fe[Ue];me[Ue]=ke[Ve]}}return ue[$]=fe.length,le}return e(AS,i,{"Array, Array":e.referTo("Matrix, Matrix",E=>(_,T)=>{u(er(_),er(T));var M=E(r(_),r(T));return Gt(M)?M.valueOf():M}),"Matrix, Matrix":function(_,T){var M=_.size(),N=T.size();return u(M,N),M.length===1?N.length===1?c(_,T,M[0]):f(_,T):N.length===1?p(_,T):m(_,T)},"Matrix, Array":e.referTo("Matrix,Matrix",E=>(_,T)=>E(_,r(T))),"Array, Matrix":e.referToSelf(E=>(_,T)=>E(r(_,T.storage()),T)),"SparseMatrix, any":function(_,T){return o(_,T,i,!1)},"DenseMatrix, any":function(_,T){return l(_,T,i,!1)},"any, SparseMatrix":function(_,T){return o(T,_,i,!0)},"any, DenseMatrix":function(_,T){return l(T,_,i,!0)},"Array, any":function(_,T){return l(r(_),T,i,!1).valueOf()},"any, Array":function(_,T){return l(r(T),_,i,!0).valueOf()},"any, any":i,"any, any, ...any":e.referToSelf(E=>(_,T,M)=>{for(var N=E(_,T),I=0;I<M.length;I++)N=E(N,M[I]);return N})})}),ES="nthRoot",FY=["typed","matrix","equalScalar","BigNumber","concat"],OY=ee(ES,FY,t=>{var{typed:e,matrix:r,equalScalar:n,BigNumber:i,concat:a}=t,s=wl({typed:e}),o=Hs({typed:e,equalScalar:n}),l=fg({typed:e,equalScalar:n}),u=Ei({typed:e,equalScalar:n}),c=on({typed:e,matrix:r,concat:a});function f(){throw new Error("Complex number not supported in function nthRoot. Use nthRoots instead.")}return e(ES,{number:WE,"number, number":WE,BigNumber:p=>h(p,new i(2)),"BigNumber, BigNumber":h,Complex:f,"Complex, number":f,Array:e.referTo("DenseMatrix,number",p=>m=>p(r(m),2).valueOf()),DenseMatrix:e.referTo("DenseMatrix,number",p=>m=>p(m,2)),SparseMatrix:e.referTo("SparseMatrix,number",p=>m=>p(m,2)),"SparseMatrix, SparseMatrix":e.referToSelf(p=>(m,v)=>{if(v.density()===1)return l(m,v,p);throw new Error("Root must be non-zero")}),"DenseMatrix, SparseMatrix":e.referToSelf(p=>(m,v)=>{if(v.density()===1)return s(m,v,p,!1);throw new Error("Root must be non-zero")}),"Array, SparseMatrix":e.referTo("DenseMatrix,SparseMatrix",p=>(m,v)=>p(r(m),v)),"number | BigNumber, SparseMatrix":e.referToSelf(p=>(m,v)=>{if(v.density()===1)return u(v,m,p,!0);throw new Error("Root must be non-zero")})},c({scalar:"number | BigNumber",SD:o,Ss:u,sS:!1}));function h(p,m){var v=i.precision,y=i.clone({precision:v+2}),x=new i(0),S=new y(1),b=m.isNegative();if(b&&(m=m.neg()),m.isZero())throw new Error("Root must be non-zero");if(p.isNegative()&&!m.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(p.isZero())return b?new y(1/0):0;if(!p.isFinite())return b?x:p;var A=p.abs().pow(S.div(m));return A=p.isNeg()?A.neg():A,new i((b?S.div(A):A).toPrecision(v))}}),SS="sign",BY=["typed","BigNumber","Fraction","complex"],RY=ee(SS,BY,t=>{var{typed:e,BigNumber:r,complex:n,Fraction:i}=t;return e(SS,{number:H1,Complex:function(s){return s.im===0?n(H1(s.re)):s.sign()},BigNumber:function(s){return new r(s.cmp(0))},bigint:function(s){return s>0n?1n:s<0n?-1n:0n},Fraction:function(s){return new i(s.s)},"Array | Matrix":e.referToSelf(a=>s=>ur(s,a,!0)),Unit:e.referToSelf(a=>s=>{if(!s._isDerived()&&s.units[0].unit.offset!==0)throw new TypeError("sign is ambiguous for units with offset");return e.find(a,s.valueType())(s.value)})})}),PY="sqrt",$Y=["config","typed","Complex"],kY=ee(PY,$Y,t=>{var{config:e,typed:r,Complex:n}=t;return r("sqrt",{number:i,Complex:function(s){return s.sqrt()},BigNumber:function(s){return!s.isNegative()||e.predictable?s.sqrt():i(s.toNumber())},Unit:function(s){return s.pow(.5)}});function i(a){return isNaN(a)?NaN:a>=0||e.predictable?Math.sqrt(a):new n(a,0).sqrt()}}),DS="square",LY=["typed"],UY=ee(DS,LY,t=>{var{typed:e}=t;return e(DS,{number:OI,Complex:function(n){return n.mul(n)},BigNumber:function(n){return n.times(n)},bigint:function(n){return n*n},Fraction:function(n){return n.mul(n)},Unit:function(n){return n.pow(2)}})}),CS="subtract",zY=["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],GY=ee(CS,zY,t=>{var{typed:e,matrix:r,equalScalar:n,subtractScalar:i,unaryMinus:a,DenseMatrix:s,concat:o}=t,l=wl({typed:e}),u=Zi({typed:e}),c=cg({typed:e,equalScalar:n}),f=Dc({typed:e,DenseMatrix:s}),h=Jn({typed:e,DenseMatrix:s}),p=on({typed:e,matrix:r,concat:o});return e(CS,{"any, any":i},p({elop:i,SS:c,DS:l,SD:u,Ss:h,sS:f}))}),TS="xgcd",qY=["typed","config","matrix","BigNumber"],HY=ee(TS,qY,t=>{var{typed:e,config:r,matrix:n,BigNumber:i}=t;return e(TS,{"number, number":function(o,l){var u=BI(o,l);return r.matrix==="Array"?u:n(u)},"BigNumber, BigNumber":a});function a(s,o){var l,u,c,f=new i(0),h=new i(1),p=f,m=h,v=h,y=f;if(!s.isInt()||!o.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!o.isZero();)u=s.div(o).floor(),c=s.mod(o),l=p,p=m.minus(u.times(p)),m=l,l=v,v=y.minus(u.times(v)),y=l,s=o,o=c;var x;return s.lt(f)?x=[s.neg(),m.neg(),y.neg()]:x=[s,s.isZero()?0:m,y],r.matrix==="Array"?x:n(x)}}),NS="invmod",WY=["typed","config","BigNumber","xgcd","equal","smaller","mod","add","isInteger"],VY=ee(NS,WY,t=>{var{typed:e,config:r,BigNumber:n,xgcd:i,equal:a,smaller:s,mod:o,add:l,isInteger:u}=t;return e(NS,{"number, number":c,"BigNumber, BigNumber":c});function c(f,h){if(!u(f)||!u(h))throw new Error("Parameters in function invmod must be integer numbers");if(f=o(f,h),a(h,0))throw new Error("Divisor must be non zero");var p=i(f,h);p=p.valueOf();var[m,v]=p;return a(m,n(1))?(v=o(v,h),s(v,n(0))&&(v=l(v,h)),v):NaN}}),XY="matAlgo09xS0Sf",jY=["typed","equalScalar"],pF=ee(XY,jY,t=>{var{typed:e,equalScalar:r}=t;return function(i,a,s){var o=i._values,l=i._index,u=i._ptr,c=i._size,f=i._datatype||i._data===void 0?i._datatype:i.getDataType(),h=a._values,p=a._index,m=a._ptr,v=a._size,y=a._datatype||a._data===void 0?a._datatype:a.getDataType();if(c.length!==v.length)throw new br(c.length,v.length);if(c[0]!==v[0]||c[1]!==v[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+v+")");var x=c[0],S=c[1],b,A=r,E=0,_=s;typeof f=="string"&&f===y&&f!=="mixed"&&(b=f,A=e.find(r,[b,b]),E=e.convert(0,b),_=e.find(s,[b,b]));var T=o&&h?[]:void 0,M=[],N=[],I=T?[]:void 0,F=[],P,U,G,V,$;for(U=0;U<S;U++){N[U]=M.length;var j=U+1;if(I)for(V=m[U],$=m[U+1],G=V;G<$;G++)P=p[G],F[P]=j,I[P]=h[G];for(V=u[U],$=u[U+1],G=V;G<$;G++)if(P=l[G],I){var k=F[P]===j?I[P]:E,Z=_(o[G],k);A(Z,E)||(M.push(P),T.push(Z))}else M.push(P)}return N[S]=M.length,i.createSparseMatrix({values:T,index:M,ptr:N,size:[x,S],datatype:f===i._datatype&&y===a._datatype?b:void 0})}}),MS="dotMultiply",YY=["typed","matrix","equalScalar","multiplyScalar","concat"],KY=ee(MS,YY,t=>{var{typed:e,matrix:r,equalScalar:n,multiplyScalar:i,concat:a}=t,s=Hs({typed:e,equalScalar:n}),o=pF({typed:e,equalScalar:n}),l=Ei({typed:e,equalScalar:n}),u=on({typed:e,matrix:r,concat:a});return e(MS,u({elop:i,SS:o,DS:s,Ss:l}))});function ZY(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitAnd");var r=t.constructor;if(t.isNaN()||e.isNaN())return new r(NaN);if(t.isZero()||e.eq(-1)||t.eq(e))return t;if(e.isZero()||t.eq(-1))return e;if(!t.isFinite()||!e.isFinite()){if(!t.isFinite()&&!e.isFinite())return t.isNegative()===e.isNegative()?t:new r(0);if(!t.isFinite())return e.isNegative()?t:t.isNegative()?new r(0):e;if(!e.isFinite())return t.isNegative()?e:e.isNegative()?new r(0):t}return Jb(t,e,function(n,i){return n&i})}function Fd(t){if(t.isFinite()&&!t.isInteger())throw new Error("Integer expected in function bitNot");var e=t.constructor,r=e.precision;e.config({precision:1e9});var n=t.plus(new e(1));return n.s=-n.s||null,e.config({precision:r}),n}function QY(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitOr");var r=t.constructor;if(t.isNaN()||e.isNaN())return new r(NaN);var n=new r(-1);return t.isZero()||e.eq(n)||t.eq(e)?e:e.isZero()||t.eq(n)?t:!t.isFinite()||!e.isFinite()?!t.isFinite()&&!t.isNegative()&&e.isNegative()||t.isNegative()&&!e.isNegative()&&!e.isFinite()?n:t.isNegative()&&e.isNegative()?t.isFinite()?t:e:t.isFinite()?e:t:Jb(t,e,function(i,a){return i|a})}function Jb(t,e,r){var n=t.constructor,i,a,s=+(t.s<0),o=+(e.s<0);if(s){i=im(Fd(t));for(var l=0;l<i.length;++l)i[l]^=1}else i=im(t);if(o){a=im(Fd(e));for(var u=0;u<a.length;++u)a[u]^=1}else a=im(e);var c,f,h;i.length<=a.length?(c=i,f=a,h=s):(c=a,f=i,h=o);var p=c.length,m=f.length,v=r(s,o)^1,y=new n(v^1),x=new n(1),S=new n(2),b=n.precision;for(n.config({precision:1e9});p>0;)r(c[--p],f[--m])===v&&(y=y.plus(x)),x=x.times(S);for(;m>0;)r(h,f[--m])===v&&(y=y.plus(x)),x=x.times(S);return n.config({precision:b}),v===0&&(y.s=-y.s),y}function im(t){for(var e=t.d,r=e[0]+"",n=1;n<e.length;++n){for(var i=e[n]+"",a=7-i.length;a--;)i="0"+i;r+=i}for(var s=r.length;r.charAt(s)==="0";)s--;var o=t.e,l=r.slice(0,s+1||1),u=l.length;if(o>0)if(++o>u)for(o-=u;o--;)l+="0";else o<u&&(l=l.slice(0,o)+"."+l.slice(o));for(var c=[0],f=0;f<l.length;){for(var h=c.length;h--;)c[h]*=10;c[0]+=parseInt(l.charAt(f++));for(var p=0;p<c.length;++p)c[p]>1&&((c[p+1]===null||c[p+1]===void 0)&&(c[p+1]=0),c[p+1]+=c[p]>>1,c[p]&=1)}return c.reverse()}function JY(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitXor");var r=t.constructor;if(t.isNaN()||e.isNaN())return new r(NaN);if(t.isZero())return e;if(e.isZero())return t;if(t.eq(e))return new r(0);var n=new r(-1);return t.eq(n)?Fd(e):e.eq(n)?Fd(t):!t.isFinite()||!e.isFinite()?!t.isFinite()&&!e.isFinite()?n:new r(t.isNegative()===e.isNegative()?1/0:-1/0):Jb(t,e,function(i,a){return i^a})}function eK(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function leftShift");var r=t.constructor;return t.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new r(NaN):t.isZero()||e.isZero()?t:!t.isFinite()&&!e.isFinite()?new r(NaN):e.lt(55)?t.times(Math.pow(2,e.toNumber())+""):t.times(new r(2).pow(e))}function tK(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function rightArithShift");var r=t.constructor;return t.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new r(NaN):t.isZero()||e.isZero()?t:e.isFinite()?e.lt(55)?t.div(Math.pow(2,e.toNumber())+"").floor():t.div(new r(2).pow(e)).floor():t.isNegative()?new r(-1):t.isFinite()?new r(0):new r(NaN)}var IS="bitAnd",rK=["typed","matrix","equalScalar","concat"],mF=ee(IS,rK,t=>{var{typed:e,matrix:r,equalScalar:n,concat:i}=t,a=Hs({typed:e,equalScalar:n}),s=fg({typed:e,equalScalar:n}),o=Ei({typed:e,equalScalar:n}),l=on({typed:e,matrix:r,concat:i});return e(IS,{"number, number":PI,"BigNumber, BigNumber":ZY,"bigint, bigint":(u,c)=>u&c},l({SS:s,DS:a,Ss:o}))}),FS="bitNot",nK=["typed"],iK=ee(FS,nK,t=>{var{typed:e}=t;return e(FS,{number:$I,BigNumber:Fd,bigint:r=>~r,"Array | Matrix":e.referToSelf(r=>n=>ur(n,r))})}),OS="bitOr",aK=["typed","matrix","equalScalar","DenseMatrix","concat"],vF=ee(OS,aK,t=>{var{typed:e,matrix:r,equalScalar:n,DenseMatrix:i,concat:a}=t,s=wl({typed:e}),o=Zb({typed:e,equalScalar:n}),l=Dc({typed:e,DenseMatrix:i}),u=on({typed:e,matrix:r,concat:a});return e(OS,{"number, number":kI,"BigNumber, BigNumber":QY,"bigint, bigint":(c,f)=>c|f},u({SS:o,DS:s,Ss:l}))}),sK="matAlgo07xSSf",oK=["typed","SparseMatrix"],Ao=ee(sK,oK,t=>{var{typed:e,SparseMatrix:r}=t;return function(a,s,o){var l=a._size,u=a._datatype||a._data===void 0?a._datatype:a.getDataType(),c=s._size,f=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(l.length!==c.length)throw new br(l.length,c.length);if(l[0]!==c[0]||l[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+c+")");var h=l[0],p=l[1],m,v=0,y=o;typeof u=="string"&&u===f&&u!=="mixed"&&(m=u,v=e.convert(0,m),y=e.find(o,[m,m]));for(var x=[],S=[],b=new Array(p+1).fill(0),A=[],E=[],_=[],T=[],M=0;M<p;M++){var N=M+1,I=0;n(a,M,_,A,N),n(s,M,T,E,N);for(var F=0;F<h;F++){var P=_[F]===N?A[F]:v,U=T[F]===N?E[F]:v,G=y(P,U);G!==0&&G!==!1&&(S.push(F),x.push(G),I++)}b[M+1]=b[M]+I}return new r({values:x,index:S,ptr:b,size:[h,p],datatype:u===a._datatype&&f===s._datatype?m:void 0})};function n(i,a,s,o,l){for(var u=i._values,c=i._index,f=i._ptr,h=f[a],p=f[a+1];h<p;h++){var m=c[h];s[m]=l,o[m]=u[h]}}}),BS="bitXor",uK=["typed","matrix","DenseMatrix","concat","SparseMatrix"],lK=ee(BS,uK,t=>{var{typed:e,matrix:r,DenseMatrix:n,concat:i,SparseMatrix:a}=t,s=Zi({typed:e}),o=Ao({typed:e,SparseMatrix:a}),l=Jn({typed:e,DenseMatrix:n}),u=on({typed:e,matrix:r,concat:i});return e(BS,{"number, number":LI,"BigNumber, BigNumber":JY,"bigint, bigint":(c,f)=>c^f},u({SS:o,DS:s,Ss:l}))}),RS="arg",cK=["typed"],fK=ee(RS,cK,t=>{var{typed:e}=t;return e(RS,{number:function(n){return Math.atan2(0,n)},BigNumber:function(n){return n.constructor.atan2(0,n)},Complex:function(n){return n.arg()},"Array | Matrix":e.referToSelf(r=>n=>ur(n,r))})}),PS="conj",hK=["typed"],dK=ee(PS,hK,t=>{var{typed:e}=t;return e(PS,{"number | BigNumber | Fraction":r=>r,Complex:r=>r.conjugate(),Unit:e.referToSelf(r=>n=>new n.constructor(r(n.toNumeric()),n.formatUnits())),"Array | Matrix":e.referToSelf(r=>n=>ur(n,r))})}),$S="im",pK=["typed"],mK=ee($S,pK,t=>{var{typed:e}=t;return e($S,{number:()=>0,"BigNumber | Fraction":r=>r.mul(0),Complex:r=>r.im,"Array | Matrix":e.referToSelf(r=>n=>ur(n,r))})}),kS="re",vK=["typed"],gK=ee(kS,vK,t=>{var{typed:e}=t;return e(kS,{"number | BigNumber | Fraction":r=>r,Complex:r=>r.re,"Array | Matrix":e.referToSelf(r=>n=>ur(n,r))})}),LS="not",yK=["typed"],bK=ee(LS,yK,t=>{var{typed:e}=t;return e(LS,{"null | undefined":()=>!0,number:HI,Complex:function(n){return n.re===0&&n.im===0},BigNumber:function(n){return n.isZero()||n.isNaN()},bigint:r=>!r,Unit:e.referToSelf(r=>n=>e.find(r,n.valueType())(n.value)),"Array | Matrix":e.referToSelf(r=>n=>ur(n,r))})}),US="or",xK=["typed","matrix","equalScalar","DenseMatrix","concat"],gF=ee(US,xK,t=>{var{typed:e,matrix:r,equalScalar:n,DenseMatrix:i,concat:a}=t,s=Zi({typed:e}),o=cg({typed:e,equalScalar:n}),l=Jn({typed:e,DenseMatrix:i}),u=on({typed:e,matrix:r,concat:a});return e(US,{"number, number":W1,"Complex, Complex":function(f,h){return f.re!==0||f.im!==0||h.re!==0||h.im!==0},"BigNumber, BigNumber":function(f,h){return!f.isZero()&&!f.isNaN()||!h.isZero()&&!h.isNaN()},"bigint, bigint":W1,"Unit, Unit":e.referToSelf(c=>(f,h)=>c(f.value||0,h.value||0))},u({SS:o,DS:s,Ss:l}))}),zS="xor",wK=["typed","matrix","DenseMatrix","concat","SparseMatrix"],_K=ee(zS,wK,t=>{var{typed:e,matrix:r,DenseMatrix:n,concat:i,SparseMatrix:a}=t,s=Zi({typed:e}),o=Ao({typed:e,SparseMatrix:a}),l=Jn({typed:e,DenseMatrix:n}),u=on({typed:e,matrix:r,concat:i});return e(zS,{"number, number":V1,"Complex, Complex":function(f,h){return(f.re!==0||f.im!==0)!=(h.re!==0||h.im!==0)},"bigint, bigint":V1,"BigNumber, BigNumber":function(f,h){return(!f.isZero()&&!f.isNaN())!=(!h.isZero()&&!h.isNaN())},"Unit, Unit":e.referToSelf(c=>(f,h)=>c(f.value||0,h.value||0))},u({SS:o,DS:s,Ss:l}))}),GS="concat",AK=["typed","matrix","isInteger"],yF=ee(GS,AK,t=>{var{typed:e,matrix:r,isInteger:n}=t;return e(GS,{"...Array | Matrix | number | BigNumber":function(a){var s,o=a.length,l=-1,u,c=!1,f=[];for(s=0;s<o;s++){var h=a[s];if(Gt(h)&&(c=!0),sr(h)||or(h)){if(s!==o-1)throw new Error("Dimension must be specified as last argument");if(u=l,l=h.valueOf(),!n(l))throw new TypeError("Integer number expected for dimension");if(l<0||s>0&&l>u)throw new zs(l,u+1)}else{var p=rr(h).valueOf(),m=er(p);if(f[s]=p,u=l,l=m.length-1,s>0&&l!==u)throw new br(u+1,l+1)}}if(f.length===0)throw new SyntaxError("At least one matrix expected");for(var v=f.shift();f.length;)v=bI(v,f.shift(),l);return c?r(v):v},"...string":function(a){return a.join("")}})}),qS="column",EK=["typed","Index","matrix","range"],bF=ee(qS,EK,t=>{var{typed:e,Index:r,matrix:n,range:i}=t;return e(qS,{"Matrix, number":a,"Array, number":function(o,l){return a(n(rr(o)),l).valueOf()}});function a(s,o){if(s.size().length!==2)throw new Error("Only two dimensional matrix is supported");sn(o,s.size()[1]);var l=i(0,s.size()[0]),u=new r(l,o),c=s.subset(u);return Gt(c)?c:n([[c]])}}),HS="count",SK=["typed","size","prod"],DK=ee(HS,SK,t=>{var{typed:e,size:r,prod:n}=t;return e(HS,{string:function(a){return a.length},"Matrix | Array":function(a){return n(r(a))}})}),WS="cross",CK=["typed","matrix","subtract","multiply"],TK=ee(WS,CK,t=>{var{typed:e,matrix:r,subtract:n,multiply:i}=t;return e(WS,{"Matrix, Matrix":function(o,l){return r(a(o.toArray(),l.toArray()))},"Matrix, Array":function(o,l){return r(a(o.toArray(),l))},"Array, Matrix":function(o,l){return r(a(o,l.toArray()))},"Array, Array":a});function a(s,o){var l=Math.max(er(s).length,er(o).length);s=gv(s),o=gv(o);var u=er(s),c=er(o);if(u.length!==1||c.length!==1||u[0]!==3||c[0]!==3)throw new RangeError("Vectors with length 3 expected (Size A = ["+u.join(", ")+"], B = ["+c.join(", ")+"])");var f=[n(i(s[1],o[2]),i(s[2],o[1])),n(i(s[2],o[0]),i(s[0],o[2])),n(i(s[0],o[1]),i(s[1],o[0]))];return l>1?[f]:f}}),VS="diag",NK=["typed","matrix","DenseMatrix","SparseMatrix"],MK=ee(VS,NK,t=>{var{typed:e,matrix:r,DenseMatrix:n,SparseMatrix:i}=t;return e(VS,{Array:function(u){return a(u,0,er(u),null)},"Array, number":function(u,c){return a(u,c,er(u),null)},"Array, BigNumber":function(u,c){return a(u,c.toNumber(),er(u),null)},"Array, string":function(u,c){return a(u,0,er(u),c)},"Array, number, string":function(u,c,f){return a(u,c,er(u),f)},"Array, BigNumber, string":function(u,c,f){return a(u,c.toNumber(),er(u),f)},Matrix:function(u){return a(u,0,u.size(),u.storage())},"Matrix, number":function(u,c){return a(u,c,u.size(),u.storage())},"Matrix, BigNumber":function(u,c){return a(u,c.toNumber(),u.size(),u.storage())},"Matrix, string":function(u,c){return a(u,0,u.size(),c)},"Matrix, number, string":function(u,c,f){return a(u,c,u.size(),f)},"Matrix, BigNumber, string":function(u,c,f){return a(u,c.toNumber(),u.size(),f)}});function a(l,u,c,f){if(!Bt(u))throw new TypeError("Second parameter in function diag must be an integer");var h=u>0?u:0,p=u<0?-u:0;switch(c.length){case 1:return s(l,u,f,c[0],p,h);case 2:return o(l,u,f,c,p,h)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function s(l,u,c,f,h,p){var m=[f+h,f+p];if(c&&c!=="sparse"&&c!=="dense")throw new TypeError("Unknown matrix type ".concat(c,'"'));var v=c==="sparse"?i.diagonal(m,l,u):n.diagonal(m,l,u);return c!==null?v:v.valueOf()}function o(l,u,c,f,h,p){if(Gt(l)){var m=l.diagonal(u);return c!==null?c!==m.storage()?r(m,c):m:m.valueOf()}for(var v=Math.min(f[0]-h,f[1]-p),y=[],x=0;x<v;x++)y[x]=l[x+h][x+p];return c!==null?r(y):y}}),IK="filter",FK=["typed"],xF=ee(IK,FK,t=>{var{typed:e}=t;return e("filter",{"Array, function":XS,"Matrix, function":function(n,i){return n.create(XS(n.valueOf(),i),n.datatype())},"Array, RegExp":kE,"Matrix, RegExp":function(n,i){return n.create(kE(n.valueOf(),i),n.datatype())}})});function XS(t,e){var r=_c(e,t,"filter");return r.isUnary?$E(t,r.fn):$E(t,function(n,i,a){return r.fn(n,[i],a)})}var jS="flatten",OK=["typed"],BK=ee(jS,OK,t=>{var{typed:e}=t;return e(jS,{Array:function(n){return Lr(n)},Matrix:function(n){return n.create(Lr(n.valueOf(),!0),n.datatype())}})}),Q1="forEach",RK=["typed"],wF=ee(Q1,RK,t=>{var{typed:e}=t;return e(Q1,{"Array, function":PK,"Matrix, function":function(n,i){n.forEach(i)}})});function PK(t,e){var r=_c(e,t,Q1);wI(t,r.fn,r.isUnary)}var YS="getMatrixDataType",$K=["typed"],kK=ee(YS,$K,t=>{var{typed:e}=t;return e(YS,{Array:function(n){return ug(n,tn)},Matrix:function(n){return n.getDataType()}})}),KS="identity",LK=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],UK=ee(KS,LK,t=>{var{typed:e,config:r,matrix:n,BigNumber:i,DenseMatrix:a,SparseMatrix:s}=t;return e(KS,{"":function(){return r.matrix==="Matrix"?n([]):[]},string:function(c){return n(c)},"number | BigNumber":function(c){return l(c,c,r.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, string":function(c,f){return l(c,c,f)},"number | BigNumber, number | BigNumber":function(c,f){return l(c,f,r.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(c,f,h){return l(c,f,h)},Array:function(c){return o(c)},"Array, string":function(c,f){return o(c,f)},Matrix:function(c){return o(c.valueOf(),c.storage())},"Matrix, string":function(c,f){return o(c.valueOf(),f)}});function o(u,c){switch(u.length){case 0:return c?n(c):[];case 1:return l(u[0],u[0],c);case 2:return l(u[0],u[1],c);default:throw new Error("Vector containing two values expected")}}function l(u,c,f){var h=or(u)||or(c)?i:null;if(or(u)&&(u=u.toNumber()),or(c)&&(c=c.toNumber()),!Bt(u)||u<1)throw new Error("Parameters in function identity must be positive integers");if(!Bt(c)||c<1)throw new Error("Parameters in function identity must be positive integers");var p=h?new i(1):1,m=h?new h(0):0,v=[u,c];if(f){if(f==="sparse")return s.diagonal(v,p,0,m);if(f==="dense")return a.diagonal(v,p,0,m);throw new TypeError('Unknown matrix type "'.concat(f,'"'))}for(var y=ih([],v,m),x=u<c?u:c,S=0;S<x;S++)y[S][S]=p;return y}}),ZS="kron",zK=["typed","matrix","multiplyScalar"],GK=ee(ZS,zK,t=>{var{typed:e,matrix:r,multiplyScalar:n}=t;return e(ZS,{"Matrix, Matrix":function(s,o){return r(i(s.toArray(),o.toArray()))},"Matrix, Array":function(s,o){return r(i(s.toArray(),o))},"Array, Matrix":function(s,o){return r(i(s,o.toArray()))},"Array, Array":i});function i(a,s){if(er(a).length===1&&(a=[a]),er(s).length===1&&(s=[s]),er(a).length>2||er(s).length>2)throw new RangeError("Vectors with dimensions greater then 2 are not supported expected (Size x = "+JSON.stringify(a.length)+", y = "+JSON.stringify(s.length)+")");var o=[],l=[];return a.map(function(u){return s.map(function(c){return l=[],o.push(l),u.map(function(f){return c.map(function(h){return l.push(n(f,h))})})})})&&o}}),uy="map",qK=["typed"],_F=ee(uy,qK,t=>{var{typed:e}=t;return e(uy,{"Array, function":n,"Matrix, function":function(a,s){return a.map(s)},"Array|Matrix, Array|Matrix, ...Array|Matrix|function":(i,a,s)=>r([i,a,...s.slice(0,s.length-1)],s[s.length-1])});function r(i,a){if(typeof a!="function")throw new Error("Last argument must be a callback function");var s=i[0].isMatrix,o=Xb(...i.map(A=>A.isMatrix?A.size():er(A))),l=s?(A,E)=>A.get(E):jb,u=s?i.map(A=>A.isMatrix?A.create(hc(A.toArray(),o),A.datatype()):i[0].create(hc(A.valueOf(),o))):i.map(A=>A.isMatrix?hc(A.toArray(),o):hc(A,o)),c;if(e.isTypedFunction(a)){var f=o.map(()=>0),h=u.map(A=>l(A,f)),p=b(a,h,f,u);c=x(p)}else{var m=i.length,v=S(a,m);c=x(v)}var y=(A,E)=>c([A,...u.slice(1).map(_=>l(_,E))],E);if(s)return u[0].map(y);return n(u[0],y);function x(A){switch(A){case 0:return E=>a(...E);case 1:return(E,_)=>a(...E,_);case 2:return(E,_)=>a(...E,_,...u)}}function S(A,E){return A.length>E+1?2:A.length===E+1?1:0}function b(A,E,_,T){return e.resolve(A,[...E,_,...T])!==null?2:e.resolve(A,[...E,_])!==null?1:(e.resolve(A,E)!==null,0)}}function n(i,a){var s=_c(a,i,uy);return G1(i,s.fn,s.isUnary)}}),QS="diff",HK=["typed","matrix","subtract","number"],AF=ee(QS,HK,t=>{var{typed:e,matrix:r,subtract:n,number:i}=t;return e(QS,{"Array | Matrix":function(c){return Gt(c)?r(s(c.toArray())):s(c)},"Array | Matrix, number":function(c,f){if(!Bt(f))throw new RangeError("Dimension must be a whole number");return Gt(c)?r(a(c.toArray(),f)):a(c,f)},"Array, BigNumber":e.referTo("Array,number",u=>(c,f)=>u(c,i(f))),"Matrix, BigNumber":e.referTo("Matrix,number",u=>(c,f)=>u(c,i(f)))});function a(u,c){if(Gt(u)&&(u=u.toArray()),!Array.isArray(u))throw RangeError("Array/Matrix does not have that many dimensions");if(c>0){var f=[];return u.forEach(h=>{f.push(a(h,c-1))}),f}else{if(c===0)return s(u);throw RangeError("Cannot have negative dimension")}}function s(u){for(var c=[],f=u.length,h=1;h<f;h++)c.push(o(u[h-1],u[h]));return c}function o(u,c){Gt(u)&&(u=u.toArray()),Gt(c)&&(c=c.toArray());var f=Array.isArray(u),h=Array.isArray(c);if(f&&h)return l(u,c);if(!f&&!h)return n(c,u);throw TypeError("Cannot calculate difference between 1 array and 1 non-array")}function l(u,c){if(u.length!==c.length)throw RangeError("Not all sub-arrays have the same length");for(var f=[],h=u.length,p=0;p<h;p++)f.push(o(u[p],c[p]));return f}}),WK="ones",VK=["typed","config","matrix","BigNumber"],XK=ee(WK,VK,t=>{var{typed:e,config:r,matrix:n,BigNumber:i}=t;return e("ones",{"":function(){return r.matrix==="Array"?a([]):a([],"default")},"...number | BigNumber | string":function(u){var c=u[u.length-1];if(typeof c=="string"){var f=u.pop();return a(u,f)}else return r.matrix==="Array"?a(u):a(u,"default")},Array:a,Matrix:function(u){var c=u.storage();return a(u.valueOf(),c)},"Array | Matrix, string":function(u,c){return a(u.valueOf(),c)}});function a(l,u){var c=s(l),f=c?new i(1):1;if(o(l),u){var h=n(u);return l.length>0?h.resize(l,f):h}else{var p=[];return l.length>0?ih(p,l,f):p}}function s(l){var u=!1;return l.forEach(function(c,f,h){or(c)&&(u=!0,h[f]=c.toNumber())}),u}function o(l){l.forEach(function(u){if(typeof u!="number"||!Bt(u)||u<0)throw new Error("Parameters in function ones must be positive integers")})}});function ex(){throw new Error('No "bignumber" implementation available')}function EF(){throw new Error('No "fraction" implementation available')}function SF(){throw new Error('No "matrix" implementation available')}var JS="range",jK=["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],DF=ee(JS,jK,t=>{var{typed:e,config:r,matrix:n,bignumber:i,smaller:a,smallerEq:s,larger:o,largerEq:l,add:u,isPositive:c}=t;return e(JS,{string:h,"string, boolean":h,number:function(y){throw new TypeError("Too few arguments to function range(): ".concat(y))},boolean:function(y){throw new TypeError("Unexpected type of argument 1 to function range(): ".concat(y,", number|bigint|BigNumber|Fraction"))},"number, number":function(y,x){return f(p(y,x,1,!1))},"number, number, number":function(y,x,S){return f(p(y,x,S,!1))},"number, number, boolean":function(y,x,S){return f(p(y,x,1,S))},"number, number, number, boolean":function(y,x,S,b){return f(p(y,x,S,b))},"bigint, bigint|number":function(y,x){return f(p(y,x,1n,!1))},"number, bigint":function(y,x){return f(p(BigInt(y),x,1n,!1))},"bigint, bigint|number, bigint|number":function(y,x,S){return f(p(y,x,BigInt(S),!1))},"number, bigint, bigint|number":function(y,x,S){return f(p(BigInt(y),x,BigInt(S),!1))},"bigint, bigint|number, boolean":function(y,x,S){return f(p(y,x,1n,S))},"number, bigint, boolean":function(y,x,S){return f(p(BigInt(y),x,1n,S))},"bigint, bigint|number, bigint|number, boolean":function(y,x,S,b){return f(p(y,x,BigInt(S),b))},"number, bigint, bigint|number, boolean":function(y,x,S,b){return f(p(BigInt(y),x,BigInt(S),b))},"BigNumber, BigNumber":function(y,x){var S=y.constructor;return f(p(y,x,new S(1),!1))},"BigNumber, BigNumber, BigNumber":function(y,x,S){return f(p(y,x,S,!1))},"BigNumber, BigNumber, boolean":function(y,x,S){var b=y.constructor;return f(p(y,x,new b(1),S))},"BigNumber, BigNumber, BigNumber, boolean":function(y,x,S,b){return f(p(y,x,S,b))},"Fraction, Fraction":function(y,x){return f(p(y,x,1,!1))},"Fraction, Fraction, Fraction":function(y,x,S){return f(p(y,x,S,!1))},"Fraction, Fraction, boolean":function(y,x,S){return f(p(y,x,1,S))},"Fraction, Fraction, Fraction, boolean":function(y,x,S,b){return f(p(y,x,S,b))},"Unit, Unit, Unit":function(y,x,S){return f(p(y,x,S,!1))},"Unit, Unit, Unit, boolean":function(y,x,S,b){return f(p(y,x,S,b))}});function f(v){return r.matrix==="Matrix"?n?n(v):SF():v}function h(v,y){var x=m(v);if(!x)throw new SyntaxError('String "'+v+'" is no valid range');return r.number==="BigNumber"?(i===void 0&&ex(),f(p(i(x.start),i(x.end),i(x.step)))):f(p(x.start,x.end,x.step,y))}function p(v,y,x,S){for(var b=[],A=c(x)?S?s:a:S?l:o,E=v;A(E,y);)b.push(E),E=u(E,x);return b}function m(v){var y=v.split(":"),x=y.map(function(b){return Number(b)}),S=x.some(function(b){return isNaN(b)});if(S)return null;switch(x.length){case 2:return{start:x[0],end:x[1],step:1};case 3:return{start:x[0],end:x[2],step:x[1]};default:return null}}}),eD="reshape",YK=["typed","isInteger","matrix"],KK=ee(eD,YK,t=>{var{typed:e,isInteger:r}=t;return e(eD,{"Matrix, Array":function(i,a){return i.reshape(a,!0)},"Array, Array":function(i,a){return a.forEach(function(s){if(!r(s))throw new TypeError("Invalid size for dimension: "+s)}),Wb(i,a)}})}),ZK="resize",QK=["config","matrix"],JK=ee(ZK,QK,t=>{var{config:e,matrix:r}=t;return function(a,s,o){if(arguments.length!==2&&arguments.length!==3)throw new Cc("resize",arguments.length,2,3);if(Gt(s)&&(s=s.valueOf()),or(s[0])&&(s=s.map(function(c){return or(c)?c.toNumber():c})),Gt(a))return a.resize(s,o,!0);if(typeof a=="string")return n(a,s,o);var l=Array.isArray(a)?!1:e.matrix!=="Array";if(s.length===0){for(;Array.isArray(a);)a=a[0];return rr(a)}else{Array.isArray(a)||(a=[a]),a=rr(a);var u=ih(a,s,o);return l?r(u):u}};function n(i,a,s){if(s!==void 0){if(typeof s!="string"||s.length!==1)throw new TypeError("Single character expected as defaultValue")}else s=" ";if(a.length!==1)throw new br(a.length,1);var o=a[0];if(typeof o!="number"||!Bt(o))throw new TypeError("Invalid size, must contain positive integers (size: "+yr(a)+")");if(i.length>o)return i.substring(0,o);if(i.length<o){for(var l=i,u=0,c=o-i.length;u<c;u++)l+=s;return l}else return i}}),tD="rotate",eZ=["typed","multiply","rotationMatrix"],tZ=ee(tD,eZ,t=>{var{typed:e,multiply:r,rotationMatrix:n}=t;return e(tD,{"Array , number | BigNumber | Complex | Unit":function(s,o){i(s,2);var l=r(n(o),s);return l.toArray()},"Matrix , number | BigNumber | Complex | Unit":function(s,o){return i(s,2),r(n(o),s)},"Array, number | BigNumber | Complex | Unit, Array | Matrix":function(s,o,l){i(s,3);var u=r(n(o,l),s);return u},"Matrix, number | BigNumber | Complex | Unit, Array | Matrix":function(s,o,l){return i(s,3),r(n(o,l),s)}});function i(a,s){var o=Array.isArray(a)?er(a):a.size();if(o.length>2)throw new RangeError("Vector must be of dimensions 1x".concat(s));if(o.length===2&&o[1]!==1)throw new RangeError("Vector must be of dimensions 1x".concat(s));if(o[0]!==s)throw new RangeError("Vector must be of dimensions 1x".concat(s))}}),rD="rotationMatrix",rZ=["typed","config","multiplyScalar","addScalar","unaryMinus","norm","matrix","BigNumber","DenseMatrix","SparseMatrix","cos","sin"],nZ=ee(rD,rZ,t=>{var{typed:e,config:r,multiplyScalar:n,addScalar:i,unaryMinus:a,norm:s,BigNumber:o,matrix:l,DenseMatrix:u,SparseMatrix:c,cos:f,sin:h}=t;return e(rD,{"":function(){return r.matrix==="Matrix"?l([]):[]},string:function(b){return l(b)},"number | BigNumber | Complex | Unit":function(b){return p(b,r.matrix==="Matrix"?"dense":void 0)},"number | BigNumber | Complex | Unit, string":function(b,A){return p(b,A)},"number | BigNumber | Complex | Unit, Array":function(b,A){var E=l(A);return m(E),x(b,E,void 0)},"number | BigNumber | Complex | Unit, Matrix":function(b,A){m(A);var E=A.storage()||(r.matrix==="Matrix"?"dense":void 0);return x(b,A,E)},"number | BigNumber | Complex | Unit, Array, string":function(b,A,E){var _=l(A);return m(_),x(b,_,E)},"number | BigNumber | Complex | Unit, Matrix, string":function(b,A,E){return m(A),x(b,A,E)}});function p(S,b){var A=or(S),E=A?new o(-1):-1,_=f(S),T=h(S),M=[[_,n(E,T)],[T,_]];return y(M,b)}function m(S){var b=S.size();if(b.length<1||b[0]!==3)throw new RangeError("Vector must be of dimensions 1x3")}function v(S){return S.reduce((b,A)=>n(b,A))}function y(S,b){if(b){if(b==="sparse")return new c(S);if(b==="dense")return new u(S);throw new TypeError('Unknown matrix type "'.concat(b,'"'))}return S}function x(S,b,A){var E=s(b);if(E===0)throw new RangeError("Rotation around zero vector");var _=or(S)?o:null,T=_?new _(1):1,M=_?new _(-1):-1,N=_?new _(b.get([0])/E):b.get([0])/E,I=_?new _(b.get([1])/E):b.get([1])/E,F=_?new _(b.get([2])/E):b.get([2])/E,P=f(S),U=i(T,a(P)),G=h(S),V=i(P,v([N,N,U])),$=i(v([N,I,U]),v([M,F,G])),j=i(v([N,F,U]),v([I,G])),k=i(v([N,I,U]),v([F,G])),Z=i(P,v([I,I,U])),z=i(v([I,F,U]),v([M,N,G])),me=i(v([N,F,U]),v([M,I,G])),fe=i(v([I,F,U]),v([N,G])),ue=i(P,v([F,F,U])),le=[[V,$,j],[k,Z,z],[me,fe,ue]];return y(le,A)}}),nD="row",iZ=["typed","Index","matrix","range"],CF=ee(nD,iZ,t=>{var{typed:e,Index:r,matrix:n,range:i}=t;return e(nD,{"Matrix, number":a,"Array, number":function(o,l){return a(n(rr(o)),l).valueOf()}});function a(s,o){if(s.size().length!==2)throw new Error("Only two dimensional matrix is supported");sn(o,s.size()[0]);var l=i(0,s.size()[1]),u=new r(o,l),c=s.subset(u);return Gt(c)?c:n([[c]])}}),iD="size",aZ=["typed","config","?matrix"],sZ=ee(iD,aZ,t=>{var{typed:e,config:r,matrix:n}=t;return e(iD,{Matrix:function(a){return a.create(a.size(),"number")},Array:er,string:function(a){return r.matrix==="Array"?[a.length]:n([a.length],"dense","number")},"number | Complex | BigNumber | Unit | boolean | null":function(a){return r.matrix==="Array"?[]:n?n([],"dense","number"):SF()}})}),aD="squeeze",oZ=["typed"],uZ=ee(aD,oZ,t=>{var{typed:e}=t;return e(aD,{Array:function(n){return gv(rr(n))},Matrix:function(n){var i=gv(n.toArray());return Array.isArray(i)?n.create(i,n.datatype()):i},any:function(n){return rr(n)}})}),sD="subset",lZ=["typed","matrix","zeros","add"],TF=ee(sD,lZ,t=>{var{typed:e,matrix:r,zeros:n,add:i}=t;return e(sD,{"Matrix, Index":function(o,l){return nh(l)?r():(vv(o,l),o.subset(l))},"Array, Index":e.referTo("Matrix, Index",function(s){return function(o,l){var u=s(r(o),l);return l.isScalar()?u:u.valueOf()}}),"Object, Index":fZ,"string, Index":cZ,"Matrix, Index, any, any":function(o,l,u,c){return nh(l)?o:(vv(o,l),o.clone().subset(l,a(u,l),c))},"Array, Index, any, any":e.referTo("Matrix, Index, any, any",function(s){return function(o,l,u,c){var f=s(r(o),l,u,c);return f.isMatrix?f.valueOf():f}}),"Array, Index, any":e.referTo("Matrix, Index, any, any",function(s){return function(o,l,u){return s(r(o),l,u,void 0).valueOf()}}),"Matrix, Index, any":e.referTo("Matrix, Index, any, any",function(s){return function(o,l,u){return s(o,l,u,void 0)}}),"string, Index, string":oD,"string, Index, string, string":oD,"Object, Index, any":hZ});function a(s,o){if(typeof s=="string")throw new Error("can't boradcast a string");if(o._isScalar)return s;var l=o.size();if(l.every(u=>u>0))try{return i(s,n(l))}catch{return s}else return s}});function cZ(t,e){if(!tg(e))throw new TypeError("Index expected");if(nh(e))return"";if(vv(Array.from(t),e),e.size().length!==1)throw new br(e.size().length,1);var r=t.length;sn(e.min()[0],r),sn(e.max()[0],r);var n=e.dimension(0),i="";return n.forEach(function(a){i+=t.charAt(a)}),i}function oD(t,e,r,n){if(!e||e.isIndex!==!0)throw new TypeError("Index expected");if(nh(e))return t;if(vv(Array.from(t),e),e.size().length!==1)throw new br(e.size().length,1);if(n!==void 0){if(typeof n!="string"||n.length!==1)throw new TypeError("Single character expected as defaultValue")}else n=" ";var i=e.dimension(0),a=i.size()[0];if(a!==r.length)throw new br(i.size()[0],r.length);var s=t.length;sn(e.min()[0]),sn(e.max()[0]);for(var o=[],l=0;l<s;l++)o[l]=t.charAt(l);if(i.forEach(function(f,h){o[f]=r.charAt(h[0])}),o.length>s)for(var u=s-1,c=o.length;u<c;u++)o[u]||(o[u]=n);return o.join("")}function fZ(t,e){if(!nh(e)){if(e.size().length!==1)throw new br(e.size(),1);var r=e.dimension(0);if(typeof r!="string")throw new TypeError("String expected as index to retrieve an object property");return Vi(t,r)}}function hZ(t,e,r){if(nh(e))return t;if(e.size().length!==1)throw new br(e.size(),1);var n=e.dimension(0);if(typeof n!="string")throw new TypeError("String expected as index to retrieve an object property");var i=rr(t);return th(i,n,r),i}var uD="transpose",dZ=["typed","matrix"],pZ=ee(uD,dZ,t=>{var{typed:e,matrix:r}=t;return e(uD,{Array:s=>n(r(s)).valueOf(),Matrix:n,any:rr});function n(s){var o=s.size(),l;switch(o.length){case 1:l=s.clone();break;case 2:{var u=o[0],c=o[1];if(c===0)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+yr(o)+")");switch(s.storage()){case"dense":l=i(s,u,c);break;case"sparse":l=a(s,u,c);break}}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+yr(o)+")")}return l}function i(s,o,l){for(var u=s._data,c=[],f,h=0;h<l;h++){f=c[h]=[];for(var p=0;p<o;p++)f[p]=rr(u[p][h])}return s.createDenseMatrix({data:c,size:[l,o],datatype:s._datatype})}function a(s,o,l){for(var u=s._values,c=s._index,f=s._ptr,h=u?[]:void 0,p=[],m=[],v=[],y=0;y<o;y++)v[y]=0;var x,S,b;for(x=0,S=c.length;x<S;x++)v[c[x]]++;for(var A=0,E=0;E<o;E++)m.push(A),A+=v[E],v[E]=m[E];for(m.push(A),b=0;b<l;b++)for(var _=f[b],T=f[b+1],M=_;M<T;M++){var N=v[c[M]]++;p[N]=b,u&&(h[N]=rr(u[M]))}return s.createSparseMatrix({values:h,index:p,ptr:m,size:[l,o],datatype:s._datatype})}}),lD="ctranspose",mZ=["typed","transpose","conj"],vZ=ee(lD,mZ,t=>{var{typed:e,transpose:r,conj:n}=t;return e(lD,{any:function(a){return n(r(a))}})}),cD="zeros",gZ=["typed","config","matrix","BigNumber"],yZ=ee(cD,gZ,t=>{var{typed:e,config:r,matrix:n,BigNumber:i}=t;return e(cD,{"":function(){return r.matrix==="Array"?a([]):a([],"default")},"...number | BigNumber | string":function(u){var c=u[u.length-1];if(typeof c=="string"){var f=u.pop();return a(u,f)}else return r.matrix==="Array"?a(u):a(u,"default")},Array:a,Matrix:function(u){var c=u.storage();return a(u.valueOf(),c)},"Array | Matrix, string":function(u,c){return a(u.valueOf(),c)}});function a(l,u){var c=s(l),f=c?new i(0):0;if(o(l),u){var h=n(u);return l.length>0?h.resize(l,f):h}else{var p=[];return l.length>0?ih(p,l,f):p}}function s(l){var u=!1;return l.forEach(function(c,f,h){or(c)&&(u=!0,h[f]=c.toNumber())}),u}function o(l){l.forEach(function(u){if(typeof u!="number"||!Bt(u)||u<0)throw new Error("Parameters in function zeros must be positive integers")})}}),fD="fft",bZ=["typed","matrix","addScalar","multiplyScalar","divideScalar","exp","tau","i","dotDivide","conj","pow","ceil","log2"],xZ=ee(fD,bZ,t=>{var{typed:e,matrix:r,addScalar:n,multiplyScalar:i,divideScalar:a,exp:s,tau:o,i:l,dotDivide:u,conj:c,pow:f,ceil:h,log2:p}=t;return e(fD,{Array:m,Matrix:function(b){return b.create(m(b.valueOf()),b.datatype())}});function m(S){var b=er(S);return b.length===1?x(S,b[0]):v(S.map(A=>m(A,b.slice(1))),0)}function v(S,b){var A=er(S);if(b!==0)return new Array(A[0]).fill(0).map((_,T)=>v(S[T],b-1));if(A.length===1)return x(S);function E(_){var T=er(_);return new Array(T[1]).fill(0).map((M,N)=>new Array(T[0]).fill(0).map((I,F)=>_[F][N]))}return E(v(E(S),1))}function y(S){for(var b=S.length,A=s(a(i(-1,i(l,o)),b)),E=[],_=1-b;_<b;_++)E.push(f(A,a(f(_,2),2)));for(var T=f(2,h(p(b+b-1))),M=[...new Array(b).fill(0).map(($,j)=>i(S[j],E[b-1+j])),...new Array(T-b).fill(0)],N=[...new Array(b+b-1).fill(0).map(($,j)=>a(1,E[j])),...new Array(T-(b+b-1)).fill(0)],I=x(M),F=x(N),P=new Array(T).fill(0).map(($,j)=>i(I[j],F[j])),U=u(c(m(c(P))),T),G=[],V=b-1;V<b+b-1;V++)G.push(i(U[V],E[V]));return G}function x(S){var b=S.length;if(b===1)return[S[0]];if(b%2===0){for(var A=[...x(S.filter((M,N)=>N%2===0)),...x(S.filter((M,N)=>N%2===1))],E=0;E<b/2;E++){var _=A[E],T=i(A[E+b/2],s(i(i(o,l),a(-E,b))));A[E]=n(_,T),A[E+b/2]=n(_,i(-1,T))}return A}else return y(S)}}),hD="ifft",wZ=["typed","fft","dotDivide","conj"],_Z=ee(hD,wZ,t=>{var{typed:e,fft:r,dotDivide:n,conj:i}=t;return e(hD,{"Array | Matrix":function(s){var o=Gt(s)?s.size():er(s);return n(i(r(i(s))),o.reduce((l,u)=>l*u,1))}})});function Od(t){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Od(t)}function AZ(t,e){if(Od(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Od(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function EZ(t){var e=AZ(t,"string");return Od(e)=="symbol"?e:e+""}function Gn(t,e,r){return(e=EZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function SZ(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dD(Object(r),!0).forEach(function(n){Gn(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var DZ="solveODE",CZ=["typed","add","subtract","multiply","divide","max","map","abs","isPositive","isNegative","larger","smaller","matrix","bignumber","unaryMinus"],TZ=ee(DZ,CZ,t=>{var{typed:e,add:r,subtract:n,multiply:i,divide:a,max:s,map:o,abs:l,isPositive:u,isNegative:c,larger:f,smaller:h,matrix:p,bignumber:m,unaryMinus:v}=t;function y(M){return function(N,I,F,P){var U=!(I.length===2&&(I.every(_)||I.every(es)));if(U)throw new Error('"tspan" must be an Array of two numeric values or two units [tStart, tEnd]');var G=I[0],V=I[1],$=f(V,G),j=P.firstStep;if(j!==void 0&&!u(j))throw new Error('"firstStep" must be positive');var k=P.maxStep;if(k!==void 0&&!u(k))throw new Error('"maxStep" must be positive');var Z=P.minStep;if(Z&&c(Z))throw new Error('"minStep" must be positive or zero');var z=[G,V,j,Z,k].filter(re=>re!==void 0);if(!(z.every(_)||z.every(es)))throw new Error('Inconsistent type of "t" dependant variables');for(var me=1,fe=P.tol?P.tol:1e-4,ue=P.minDelta?P.minDelta:.2,le=P.maxDelta?P.maxDelta:5,ke=P.maxIter?P.maxIter:1e4,Me=[G,V,...F,k,Z].some(or),[Se,oe,K,de]=Me?[m(M.a),m(M.c),m(M.b),m(M.bp)]:[M.a,M.c,M.b,M.bp],_e=j?$?j:v(j):a(n(V,G),me),be=[G],$e=[F],Oe=n(K,de),Qe=0,ae=0,ce=A($),Ce=E($);ce(be[Qe],V);){var Ue=[];_e=Ce(be[Qe],V,_e),Ue.push(N(be[Qe],$e[Qe]));for(var Ve=1;Ve<oe.length;++Ve)Ue.push(N(r(be[Qe],i(oe[Ve],_e)),r($e[Qe],i(_e,Se[Ve],Ue))));var je=s(l(o(i(Oe,Ue),re=>es(re)?re.value:re)));je<fe&&fe/je>1/4&&(be.push(r(be[Qe],_e)),$e.push(r($e[Qe],i(_e,K,Ue))),Qe++);var ht=.84*(fe/je)**(1/5);if(h(ht,ue)?ht=ue:f(ht,le)&&(ht=le),ht=Me?m(ht):ht,_e=i(_e,ht),k&&f(l(_e),k)?_e=$?k:v(k):Z&&h(l(_e),Z)&&(_e=$?Z:v(Z)),ae++,ae>ke)throw new Error("Maximum number of iterations reached, try changing options")}return{t:be,y:$e}}}function x(M,N,I,F){var P=[[],[.5],[0,.75],[.2222222222222222,.3333333333333333,.4444444444444444]],U=[null,1/2,3/4,1],G=[2/9,1/3,4/9,0],V=[7/24,1/4,1/3,1/8],$={a:P,c:U,b:G,bp:V};return y($)(M,N,I,F)}function S(M,N,I,F){var P=[[],[.2],[.075,.225],[.9777777777777777,-3.7333333333333334,3.5555555555555554],[2.9525986892242035,-11.595793324188385,9.822892851699436,-.2908093278463649],[2.8462752525252526,-10.757575757575758,8.906422717743473,.2784090909090909,-.2735313036020583],[.09114583333333333,0,.44923629829290207,.6510416666666666,-.322376179245283,.13095238095238096]],U=[null,1/5,3/10,4/5,8/9,1,1],G=[35/384,0,500/1113,125/192,-2187/6784,11/84,0],V=[5179/57600,0,7571/16695,393/640,-92097/339200,187/2100,1/40],$={a:P,c:U,b:G,bp:V};return y($)(M,N,I,F)}function b(M,N,I,F){var P=F.method?F.method:"RK45",U={RK23:x,RK45:S};if(P.toUpperCase()in U){var G=SZ({},F);return delete G.method,U[P.toUpperCase()](M,N,I,G)}else{var V=Object.keys(U).map(j=>'"'.concat(j,'"')),$="".concat(V.slice(0,-1).join(", ")," and ").concat(V.slice(-1));throw new Error('Unavailable method "'.concat(P,'". Available methods are ').concat($))}}function A(M){return M?h:f}function E(M){var N=M?f:h;return function(I,F,P){var U=r(I,P);return N(U,F)?n(F,I):P}}function _(M){return or(M)||sr(M)}function T(M,N,I,F){var P=b(M,N.toArray(),I.toArray(),F);return{t:p(P.t),y:p(P.y)}}return e("solveODE",{"function, Array, Array, Object":b,"function, Matrix, Matrix, Object":T,"function, Array, Array":(M,N,I)=>b(M,N,I,{}),"function, Matrix, Matrix":(M,N,I)=>T(M,N,I,{}),"function, Array, number | BigNumber | Unit":(M,N,I)=>{var F=b(M,N,[I],{});return{t:F.t,y:F.y.map(P=>P[0])}},"function, Matrix, number | BigNumber | Unit":(M,N,I)=>{var F=b(M,N.toArray(),[I],{});return{t:p(F.t),y:p(F.y.map(P=>P[0]))}},"function, Array, number | BigNumber | Unit, Object":(M,N,I,F)=>{var P=b(M,N,[I],F);return{t:P.t,y:P.y.map(U=>U[0])}},"function, Matrix, number | BigNumber | Unit, Object":(M,N,I,F)=>{var P=b(M,N.toArray(),[I],F);return{t:p(P.t),y:p(P.y.map(U=>U[0]))}}})}),NZ="erf",MZ=["typed"],IZ=ee(NZ,MZ,t=>{var{typed:e}=t;return e("name",{number:function(s){var o=Math.abs(s);return o>=BZ?nl(s):o<=FZ?nl(s)*r(o):o<=4?nl(s)*(1-n(o)):nl(s)*(1-i(o))},"Array | Matrix":e.referToSelf(a=>s=>ur(s,a))});function r(a){var s=a*a,o=ru[0][4]*s,l=s,u;for(u=0;u<3;u+=1)o=(o+ru[0][u])*s,l=(l+mf[0][u])*s;return a*(o+ru[0][3])/(l+mf[0][3])}function n(a){var s=ru[1][8]*a,o=a,l;for(l=0;l<7;l+=1)s=(s+ru[1][l])*a,o=(o+mf[1][l])*a;var u=(s+ru[1][7])/(o+mf[1][7]),c=parseInt(a*16)/16,f=(a-c)*(a+c);return Math.exp(-c*c)*Math.exp(-f)*u}function i(a){var s=1/(a*a),o=ru[2][5]*s,l=s,u;for(u=0;u<4;u+=1)o=(o+ru[2][u])*s,l=(l+mf[2][u])*s;var c=s*(o+ru[2][4])/(l+mf[2][4]);c=(OZ-c)/a,s=parseInt(a*16)/16;var f=(a-s)*(a+s);return Math.exp(-s*s)*Math.exp(-f)*c}}),FZ=.46875,OZ=.5641895835477563,ru=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,21531153547440383e-24],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],mf=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],BZ=Math.pow(2,53),pD="zeta",RZ=["typed","config","multiply","pow","divide","factorial","equal","smallerEq","isNegative","gamma","sin","subtract","add","?Complex","?BigNumber","pi"],PZ=ee(pD,RZ,t=>{var{typed:e,config:r,multiply:n,pow:i,divide:a,factorial:s,equal:o,smallerEq:l,isNegative:u,gamma:c,sin:f,subtract:h,add:p,Complex:m,BigNumber:v,pi:y}=t;return e(pD,{number:_=>x(_,T=>T,()=>20),BigNumber:_=>x(_,T=>new v(T),()=>Math.abs(Math.log10(r.relTol))),Complex:S});function x(_,T,M){return o(_,0)?T(-.5):o(_,1)?T(NaN):isFinite(_)?b(_,T,M,N=>N):u(_)?T(NaN):T(1)}function S(_){return _.re===0&&_.im===0?new m(-.5):_.re===1?new m(NaN,NaN):_.re===1/0&&_.im===0?new m(1):_.im===1/0||_.re===-1/0?new m(NaN,NaN):b(_,T=>T,T=>Math.round(1.3*15+.9*Math.abs(T.im)),T=>T.re)}function b(_,T,M,N){var I=M(_);if(N(_)>-(I-1)/2)return E(_,T(I),T);var F=n(i(2,_),i(T(y),h(_,1)));return F=n(F,f(n(a(T(y),2),_))),F=n(F,c(h(1,_))),n(F,b(h(1,_),T,M,N))}function A(_,T){for(var M=_,N=_;l(N,T);N=p(N,1)){var I=a(n(s(p(T,h(N,1))),i(4,N)),n(s(h(T,N)),s(n(2,N))));M=p(M,I)}return n(T,M)}function E(_,T,M){for(var N=a(1,n(A(M(0),T),h(1,i(2,h(1,_))))),I=M(0),F=M(1);l(F,T);F=p(F,1))I=p(I,a(n((-1)**(F-1),A(F,T)),i(F,_)));return n(N,I)}}),mD="mode",$Z=["typed","isNaN","isNumeric"],kZ=ee(mD,$Z,t=>{var{typed:e,isNaN:r,isNumeric:n}=t;return e(mD,{"Array | Matrix":i,"...":function(s){return i(s)}});function i(a){a=Lr(a.valueOf());var s=a.length;if(s===0)throw new Error("Cannot calculate mode of an empty array");for(var o={},l=[],u=0,c=0;c<a.length;c++){var f=a[c];if(n(f)&&r(f))throw new Error("Cannot calculate mode of an array containing NaN values");f in o||(o[f]=0),o[f]++,o[f]===u?l.push(f):o[f]>u&&(u=o[f],l=[f])}return l}});function Yi(t,e,r){var n;return String(t).includes("Unexpected type")?(n=arguments.length>2?" (type: "+tn(r)+", value: "+JSON.stringify(r)+")":" (type: "+t.data.actual+")",new TypeError("Cannot calculate "+e+", unexpected type of argument"+n)):String(t).includes("complex numbers")?(n=arguments.length>2?" (type: "+tn(r)+", value: "+JSON.stringify(r)+")":"",new TypeError("Cannot calculate "+e+", no ordering relation is defined for complex numbers"+n)):t}var vD="prod",LZ=["typed","config","multiplyScalar","numeric"],UZ=ee(vD,LZ,t=>{var{typed:e,config:r,multiplyScalar:n,numeric:i}=t;return e(vD,{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(o,l){throw new Error("prod(A, dim) is not yet supported")},"...":function(o){return a(o)}});function a(s){var o;if(ml(s,function(l){try{o=o===void 0?l:n(o,l)}catch(u){throw Yi(u,"prod",l)}}),typeof o=="string"&&(o=i(o,bl(o,r))),o===void 0)throw new Error("Cannot calculate prod of an empty array");return o}}),gD="format",zZ=["typed"],GZ=ee(gD,zZ,t=>{var{typed:e}=t;return e(gD,{any:yr,"any, Object | function | number | BigNumber":yr})}),yD="bin",qZ=["typed","format"],HZ=ee(yD,qZ,t=>{var{typed:e,format:r}=t;return e(yD,{"number | BigNumber":function(i){return r(i,{notation:"bin"})},"number | BigNumber, number | BigNumber":function(i,a){return r(i,{notation:"bin",wordSize:a})}})}),bD="oct",WZ=["typed","format"],VZ=ee(bD,WZ,t=>{var{typed:e,format:r}=t;return e(bD,{"number | BigNumber":function(i){return r(i,{notation:"oct"})},"number | BigNumber, number | BigNumber":function(i,a){return r(i,{notation:"oct",wordSize:a})}})}),xD="hex",XZ=["typed","format"],jZ=ee(xD,XZ,t=>{var{typed:e,format:r}=t;return e(xD,{"number | BigNumber":function(i){return r(i,{notation:"hex"})},"number | BigNumber, number | BigNumber":function(i,a){return r(i,{notation:"hex",wordSize:a})}})}),NF=/\$([\w.]+)/g,wD="print",YZ=["typed"],MF=ee(wD,YZ,t=>{var{typed:e}=t;return e(wD,{"string, Object | Array":_D,"string, Object | Array, number | Object":_D})});function _D(t,e,r){return t.replace(NF,function(n,i){var a=i.split("."),s=e[a.shift()];for(s!==void 0&&s.isMatrix&&(s=s.toArray());a.length&&s!==void 0;){var o=a.shift();s=o?s[o]:s+"."}return s!==void 0?Fi(s)?s:yr(s,r):n})}var AD="to",KZ=["typed","matrix","concat"],ZZ=ee(AD,KZ,t=>{var{typed:e,matrix:r,concat:n}=t,i=on({typed:e,matrix:r,concat:n});return e(AD,{"Unit, Unit | string":(a,s)=>a.to(s)},i({Ds:!0}))}),ED="isPrime",QZ=["typed"],JZ=ee(ED,QZ,t=>{var{typed:e}=t;return e(ED,{number:function(n){if(n<=3)return n>1;if(n%2===0||n%3===0)return!1;for(var i=5;i*i<=n;i+=6)if(n%i===0||n%(i+2)===0)return!1;return!0},bigint:function(n){if(n<=3n)return n>1n;if(n%2n===0n||n%3n===0n)return!1;for(var i=5n;i*i<=n;i+=6n)if(n%i===0n||n%(i+2n)===0n)return!1;return!0},BigNumber:function(n){if(n.lte(3))return n.gt(1);if(n.mod(2).eq(0)||n.mod(3).eq(0))return!1;if(n.lt(Math.pow(2,32))){for(var i=n.toNumber(),a=5;a*a<=i;a+=6)if(i%a===0||i%(a+2)===0)return!1;return!0}function s(S,b,A){for(var E=1;!b.eq(0);)b.mod(2).eq(0)?(b=b.div(2),S=S.mul(S).mod(A)):(b=b.sub(1),E=S.mul(E).mod(A));return E}var o=n.constructor.clone({precision:n.toFixed(0).length*2});n=new o(n);for(var l=0,u=n.sub(1);u.mod(2).eq(0);)u=u.div(2),l+=1;var c=null;if(n.lt("3317044064679887385961981"))c=[2,3,5,7,11,13,17,19,23,29,31,37,41].filter(S=>S<n);else{var f=Math.min(n.toNumber()-2,Math.floor(2*Math.pow(n.toFixed(0).length*Math.log(10),2)));c=[];for(var h=2;h<=f;h+=1)c.push(f)}for(var p=0;p<c.length;p+=1){var m=c[p],v=s(n.sub(n).add(m),u,n);if(!v.eq(1)){for(var y=0,x=v;!x.eq(n.sub(1));y+=1,x=x.mul(x).mod(n))if(y===l-1)return!1}}return!0},"Array | Matrix":e.referToSelf(r=>n=>ur(n,r))})}),eQ="numeric",tQ=["number","?bignumber","?fraction"],rQ=ee(eQ,tQ,t=>{var{number:e,bignumber:r,fraction:n}=t,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},a={number:s=>e(s),BigNumber:r?s=>r(s):ex,bigint:s=>BigInt(s),Fraction:n?s=>n(s):EF};return function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"number",u=arguments.length>2?arguments[2]:void 0;if(u!==void 0)throw new SyntaxError("numeric() takes one or two arguments");var c=tn(o);if(!(c in i))throw new TypeError("Cannot convert "+o+' of type "'+c+'"; valid input types are '+Object.keys(i).join(", "));if(!(l in a))throw new TypeError("Cannot convert "+o+' to type "'+l+'"; valid output types are '+Object.keys(a).join(", "));return l===c?o:a[l](o)}}),SD="divideScalar",nQ=["typed","numeric"],iQ=ee(SD,nQ,t=>{var{typed:e,numeric:r}=t;return e(SD,{"number, number":function(i,a){return i/a},"Complex, Complex":function(i,a){return i.div(a)},"BigNumber, BigNumber":function(i,a){return i.div(a)},"bigint, bigint":function(i,a){return i/a},"Fraction, Fraction":function(i,a){return i.div(a)},"Unit, number | Complex | Fraction | BigNumber | Unit":(n,i)=>n.divide(i),"number | Fraction | Complex | BigNumber, Unit":(n,i)=>i.divideInto(n)})}),DD="pow",aQ=["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],sQ=ee(DD,aQ,t=>{var{typed:e,config:r,identity:n,multiply:i,matrix:a,inv:s,number:o,fraction:l,Complex:u}=t;return e(DD,{"number, number":c,"Complex, Complex":function(m,v){return m.pow(v)},"BigNumber, BigNumber":function(m,v){return v.isInteger()||m>=0||r.predictable?m.pow(v):new u(m.toNumber(),0).pow(v.toNumber(),0)},"bigint, bigint":(p,m)=>p**m,"Fraction, Fraction":function(m,v){var y=m.pow(v);if(y!=null)return y;if(r.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return c(m.valueOf(),v.valueOf())},"Array, number":f,"Array, BigNumber":function(m,v){return f(m,v.toNumber())},"Matrix, number":h,"Matrix, BigNumber":function(m,v){return h(m,v.toNumber())},"Unit, number | BigNumber":function(m,v){return m.pow(v)}});function c(p,m){if(r.predictable&&!Bt(m)&&p<0)try{var v=l(m),y=o(v);if((m===y||Math.abs((m-y)/m)<1e-14)&&v.d%2n===1n)return(v.n%2n===0n?1:-1)*Math.pow(-p,m)}catch{}return r.predictable&&(p<-1&&m===1/0||p>-1&&p<0&&m===-1/0)?NaN:Bt(m)||p>=0||r.predictable?RI(p,m):p*p<1&&m===1/0||p*p>1&&m===-1/0?0:new u(p,0).pow(m,0)}function f(p,m){if(!Bt(m))throw new TypeError("For A^b, b must be an integer (value is "+m+")");var v=er(p);if(v.length!==2)throw new Error("For A^b, A must be 2 dimensional (A has "+v.length+" dimensions)");if(v[0]!==v[1])throw new Error("For A^b, A must be square (size is "+v[0]+"x"+v[1]+")");if(m<0)try{return f(s(p),-m)}catch(S){throw S.message==="Cannot calculate inverse, determinant is zero"?new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+m+")"):S}for(var y=n(v[0]).valueOf(),x=p;m>=1;)(m&1)===1&&(y=i(x,y)),m>>=1,x=i(x,x);return y}function h(p,m){return a(f(p.valueOf(),m))}}),vf="Number of decimals in function round must be an integer",CD="round",oQ=["typed","config","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],uQ=ee(CD,oQ,t=>{var{typed:e,config:r,matrix:n,equalScalar:i,zeros:a,BigNumber:s,DenseMatrix:o}=t,l=Ei({typed:e,equalScalar:i}),u=Jn({typed:e,DenseMatrix:o}),c=qs({typed:e});function f(h){return Math.abs(qd(h).exponent)}return e(CD,{number:function(p){var m=id(p,f(r.relTol)),v=_i(p,m,r.relTol,r.absTol)?m:p;return id(v)},"number, number":function(p,m){var v=f(r.relTol);if(m>=v)return id(p,m);var y=id(p,v),x=_i(p,y,r.relTol,r.absTol)?y:p;return id(x,m)},"number, BigNumber":function(p,m){if(!m.isInteger())throw new TypeError(vf);return new s(p).toDecimalPlaces(m.toNumber())},Complex:function(p){return p.round()},"Complex, number":function(p,m){if(m%1)throw new TypeError(vf);return p.round(m)},"Complex, BigNumber":function(p,m){if(!m.isInteger())throw new TypeError(vf);var v=m.toNumber();return p.round(v)},BigNumber:function(p){var m=new s(p).toDecimalPlaces(f(r.relTol)),v=as(p,m,r.relTol,r.absTol)?m:p;return v.toDecimalPlaces(0)},"BigNumber, BigNumber":function(p,m){if(!m.isInteger())throw new TypeError(vf);var v=f(r.relTol);if(m>=v)return p.toDecimalPlaces(m.toNumber());var y=p.toDecimalPlaces(v),x=as(p,y,r.relTol,r.absTol)?y:p;return x.toDecimalPlaces(m.toNumber())},bigint:h=>h,"bigint, number":(h,p)=>h,"bigint, BigNumber":(h,p)=>h,Fraction:function(p){return p.round()},"Fraction, number":function(p,m){if(m%1)throw new TypeError(vf);return p.round(m)},"Fraction, BigNumber":function(p,m){if(!m.isInteger())throw new TypeError(vf);return p.round(m.toNumber())},"Unit, number, Unit":e.referToSelf(h=>function(p,m,v){var y=p.toNumeric(v);return v.multiply(h(y,m))}),"Unit, BigNumber, Unit":e.referToSelf(h=>(p,m,v)=>h(p,m.toNumber(),v)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(h=>(p,m,v)=>ur(p,y=>h(y,m,v),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(h=>(p,m)=>h(p,0,m)),"Array | Matrix":e.referToSelf(h=>p=>ur(p,h,!0)),"SparseMatrix, number | BigNumber":e.referToSelf(h=>(p,m)=>l(p,m,h,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(h=>(p,m)=>c(p,m,h,!1)),"Array, number | BigNumber":e.referToSelf(h=>(p,m)=>c(n(p),m,h,!1).valueOf()),"number | Complex | BigNumber | Fraction, SparseMatrix":e.referToSelf(h=>(p,m)=>i(p,0)?a(m.size(),m.storage()):u(m,p,h,!0)),"number | Complex | BigNumber | Fraction, DenseMatrix":e.referToSelf(h=>(p,m)=>i(p,0)?a(m.size(),m.storage()):c(m,p,h,!0)),"number | Complex | BigNumber | Fraction, Array":e.referToSelf(h=>(p,m)=>c(n(m),p,h,!0).valueOf())})}),TD="log",lQ=["config","typed","typeOf","divideScalar","Complex"],cQ=Math.log(16),fQ=ee(TD,lQ,t=>{var{typed:e,typeOf:r,config:n,divideScalar:i,Complex:a}=t;function s(l){return l.log()}function o(l){return s(new a(l,0))}return e(TD,{number:function(u){return u>=0||n.predictable?HE(u):o(u)},bigint:Qb(cQ,HE,n,o),Complex:s,BigNumber:function(u){return!u.isNegative()||n.predictable?u.ln():o(u.toNumber())},"any, any":e.referToSelf(l=>(u,c)=>{if(r(u)==="Fraction"&&r(c)==="Fraction"){var f=u.log(c);if(f!==null)return f}return i(l(u),l(c))})})}),ND="log1p",hQ=["typed","config","divideScalar","log","Complex"],dQ=ee(ND,hQ,t=>{var{typed:e,config:r,divideScalar:n,log:i,Complex:a}=t;return e(ND,{number:function(l){return l>=-1||r.predictable?cW(l):s(new a(l,0))},Complex:s,BigNumber:function(l){var u=l.plus(1);return!u.isNegative()||r.predictable?u.ln():s(new a(l.toNumber(),0))},"Array | Matrix":e.referToSelf(o=>l=>ur(l,o)),"any, any":e.referToSelf(o=>(l,u)=>n(o(l),i(u)))});function s(o){var l=o.re+1;return new a(Math.log(Math.sqrt(l*l+o.im*o.im)),Math.atan2(o.im,l))}}),MD="nthRoots",pQ=["config","typed","divideScalar","Complex"],mQ=ee(MD,pQ,t=>{var{typed:e,config:r,divideScalar:n,Complex:i}=t,a=[function(l){return new i(l,0)},function(l){return new i(0,l)},function(l){return new i(-l,0)},function(l){return new i(0,-l)}];function s(o,l){if(l<0)throw new Error("Root must be greater than zero");if(l===0)throw new Error("Root must be non-zero");if(l%1!==0)throw new Error("Root must be an integer");if(o===0||o.abs()===0)return[new i(0,0)];var u=typeof o=="number",c;(u||o.re===0||o.im===0)&&(u?c=2*+(o<0):o.im===0?c=2*+(o.re<0):c=2*+(o.im<0)+1);for(var f=o.arg(),h=o.abs(),p=[],m=Math.pow(h,1/l),v=0;v<l;v++){var y=(c+4*v)/l;if(y===Math.round(y)){p.push(a[y%4](m));continue}p.push(new i({r:m,phi:(f+2*Math.PI*v)/l}))}return p}return e(MD,{Complex:function(l){return s(l,2)},"Complex, number":s})}),ID="dotPow",vQ=["typed","equalScalar","matrix","pow","DenseMatrix","concat","SparseMatrix"],gQ=ee(ID,vQ,t=>{var{typed:e,equalScalar:r,matrix:n,pow:i,DenseMatrix:a,concat:s,SparseMatrix:o}=t,l=Zi({typed:e}),u=Ao({typed:e,SparseMatrix:o}),c=Ei({typed:e,equalScalar:r}),f=Jn({typed:e,DenseMatrix:a}),h=on({typed:e,matrix:n,concat:s}),p={};for(var m in i.signatures)Object.prototype.hasOwnProperty.call(i.signatures,m)&&!m.includes("Matrix")&&!m.includes("Array")&&(p[m]=i.signatures[m]);var v=e(p);return e(ID,h({elop:v,SS:u,DS:l,Ss:c,sS:f}))}),FD="dotDivide",yQ=["typed","matrix","equalScalar","divideScalar","DenseMatrix","concat","SparseMatrix"],bQ=ee(FD,yQ,t=>{var{typed:e,matrix:r,equalScalar:n,divideScalar:i,DenseMatrix:a,concat:s,SparseMatrix:o}=t,l=Hs({typed:e,equalScalar:n}),u=Zi({typed:e}),c=Ao({typed:e,SparseMatrix:o}),f=Ei({typed:e,equalScalar:n}),h=Jn({typed:e,DenseMatrix:a}),p=on({typed:e,matrix:r,concat:s});return e(FD,p({elop:i,SS:c,DS:u,SD:l,Ss:f,sS:h}))});function Hd(t){var{DenseMatrix:e}=t;return function(n,i,a){var s=n.size();if(s.length!==2)throw new RangeError("Matrix must be two dimensional (size: "+yr(s)+")");var o=s[0],l=s[1];if(o!==l)throw new RangeError("Matrix must be square (size: "+yr(s)+")");var u=[];if(Gt(i)){var c=i.size(),f=i._data;if(c.length===1){if(c[0]!==o)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var h=0;h<o;h++)u[h]=[f[h]];return new e({data:u,size:[o,1],datatype:i._datatype})}if(c.length===2){if(c[0]!==o||c[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(fv(i)){if(a){u=[];for(var p=0;p<o;p++)u[p]=[f[p][0]];return new e({data:u,size:[o,1],datatype:i._datatype})}return i}if(fc(i)){for(var m=0;m<o;m++)u[m]=[0];for(var v=i._values,y=i._index,x=i._ptr,S=x[1],b=x[0];b<S;b++){var A=y[b];u[A][0]=v[b]}return new e({data:u,size:[o,1],datatype:i._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(Jr(i)){var E=er(i);if(E.length===1){if(E[0]!==o)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var _=0;_<o;_++)u[_]=[i[_]];return new e({data:u,size:[o,1]})}if(E.length===2){if(E[0]!==o||E[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var T=0;T<o;T++)u[T]=[i[T][0]];return new e({data:u,size:[o,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var OD="lsolve",xQ=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],wQ=ee(OD,xQ,t=>{var{typed:e,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:s,DenseMatrix:o}=t,l=Hd({DenseMatrix:o});return e(OD,{"SparseMatrix, Array | Matrix":function(h,p){return c(h,p)},"DenseMatrix, Array | Matrix":function(h,p){return u(h,p)},"Array, Array | Matrix":function(h,p){var m=r(h),v=u(m,p);return v.valueOf()}});function u(f,h){h=l(f,h,!0);for(var p=h._data,m=f._size[0],v=f._size[1],y=[],x=f._data,S=0;S<v;S++){var b=p[S][0]||0,A=void 0;if(s(b,0))A=0;else{var E=x[S][S];if(s(E,0))throw new Error("Linear system cannot be solved since matrix is singular");A=n(b,E);for(var _=S+1;_<m;_++)p[_]=[a(p[_][0]||0,i(A,x[_][S]))]}y[S]=[A]}return new o({data:y,size:[m,1]})}function c(f,h){h=l(f,h,!0);for(var p=h._data,m=f._size[0],v=f._size[1],y=f._values,x=f._index,S=f._ptr,b=[],A=0;A<v;A++){var E=p[A][0]||0;if(s(E,0))b[A]=[0];else{for(var _=0,T=[],M=[],N=S[A],I=S[A+1],F=N;F<I;F++){var P=x[F];P===A?_=y[F]:P>A&&(T.push(y[F]),M.push(P))}if(s(_,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var U=n(E,_),G=0,V=M.length;G<V;G++){var $=M[G];p[$]=[a(p[$][0]||0,i(U,T[G]))]}b[A]=[U]}}return new o({data:b,size:[m,1]})}}),BD="usolve",_Q=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],AQ=ee(BD,_Q,t=>{var{typed:e,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:s,DenseMatrix:o}=t,l=Hd({DenseMatrix:o});return e(BD,{"SparseMatrix, Array | Matrix":function(h,p){return c(h,p)},"DenseMatrix, Array | Matrix":function(h,p){return u(h,p)},"Array, Array | Matrix":function(h,p){var m=r(h),v=u(m,p);return v.valueOf()}});function u(f,h){h=l(f,h,!0);for(var p=h._data,m=f._size[0],v=f._size[1],y=[],x=f._data,S=v-1;S>=0;S--){var b=p[S][0]||0,A=void 0;if(s(b,0))A=0;else{var E=x[S][S];if(s(E,0))throw new Error("Linear system cannot be solved since matrix is singular");A=n(b,E);for(var _=S-1;_>=0;_--)p[_]=[a(p[_][0]||0,i(A,x[_][S]))]}y[S]=[A]}return new o({data:y,size:[m,1]})}function c(f,h){h=l(f,h,!0);for(var p=h._data,m=f._size[0],v=f._size[1],y=f._values,x=f._index,S=f._ptr,b=[],A=v-1;A>=0;A--){var E=p[A][0]||0;if(s(E,0))b[A]=[0];else{for(var _=0,T=[],M=[],N=S[A],I=S[A+1],F=I-1;F>=N;F--){var P=x[F];P===A?_=y[F]:P<A&&(T.push(y[F]),M.push(P))}if(s(_,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var U=n(E,_),G=0,V=M.length;G<V;G++){var $=M[G];p[$]=[a(p[$][0],i(U,T[G]))]}b[A]=[U]}}return new o({data:b,size:[m,1]})}}),RD="lsolveAll",EQ=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],SQ=ee(RD,EQ,t=>{var{typed:e,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:s,DenseMatrix:o}=t,l=Hd({DenseMatrix:o});return e(RD,{"SparseMatrix, Array | Matrix":function(h,p){return c(h,p)},"DenseMatrix, Array | Matrix":function(h,p){return u(h,p)},"Array, Array | Matrix":function(h,p){var m=r(h),v=u(m,p);return v.map(y=>y.valueOf())}});function u(f,h){for(var p=[l(f,h,!0)._data.map(M=>M[0])],m=f._data,v=f._size[0],y=f._size[1],x=0;x<y;x++)for(var S=p.length,b=0;b<S;b++){var A=p[b];if(s(m[x][x],0))if(s(A[x],0)){if(b===0){var _=[...A];_[x]=1;for(var T=x+1;T<y;T++)_[T]=a(_[T],m[T][x]);p.push(_)}}else{if(b===0)return[];p.splice(b,1),b-=1,S-=1}else{A[x]=n(A[x],m[x][x]);for(var E=x+1;E<y;E++)A[E]=a(A[E],i(A[x],m[E][x]))}}return p.map(M=>new o({data:M.map(N=>[N]),size:[v,1]}))}function c(f,h){for(var p=[l(f,h,!0)._data.map(me=>me[0])],m=f._size[0],v=f._size[1],y=f._values,x=f._index,S=f._ptr,b=0;b<v;b++)for(var A=p.length,E=0;E<A;E++){for(var _=p[E],T=[],M=[],N=S[b],I=S[b+1],F=0,P=N;P<I;P++){var U=x[P];U===b?F=y[P]:U>b&&(T.push(y[P]),M.push(U))}if(s(F,0))if(s(_[b],0)){if(E===0){var j=[..._];j[b]=1;for(var k=0,Z=M.length;k<Z;k++){var z=M[k];j[z]=a(j[z],T[k])}p.push(j)}}else{if(E===0)return[];p.splice(E,1),E-=1,A-=1}else{_[b]=n(_[b],F);for(var G=0,V=M.length;G<V;G++){var $=M[G];_[$]=a(_[$],i(_[b],T[G]))}}}return p.map(me=>new o({data:me.map(fe=>[fe]),size:[m,1]}))}}),PD="usolveAll",DQ=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],CQ=ee(PD,DQ,t=>{var{typed:e,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:s,DenseMatrix:o}=t,l=Hd({DenseMatrix:o});return e(PD,{"SparseMatrix, Array | Matrix":function(h,p){return c(h,p)},"DenseMatrix, Array | Matrix":function(h,p){return u(h,p)},"Array, Array | Matrix":function(h,p){var m=r(h),v=u(m,p);return v.map(y=>y.valueOf())}});function u(f,h){for(var p=[l(f,h,!0)._data.map(M=>M[0])],m=f._data,v=f._size[0],y=f._size[1],x=y-1;x>=0;x--)for(var S=p.length,b=0;b<S;b++){var A=p[b];if(s(m[x][x],0))if(s(A[x],0)){if(b===0){var _=[...A];_[x]=1;for(var T=x-1;T>=0;T--)_[T]=a(_[T],m[T][x]);p.push(_)}}else{if(b===0)return[];p.splice(b,1),b-=1,S-=1}else{A[x]=n(A[x],m[x][x]);for(var E=x-1;E>=0;E--)A[E]=a(A[E],i(A[x],m[E][x]))}}return p.map(M=>new o({data:M.map(N=>[N]),size:[v,1]}))}function c(f,h){for(var p=[l(f,h,!0)._data.map(me=>me[0])],m=f._size[0],v=f._size[1],y=f._values,x=f._index,S=f._ptr,b=v-1;b>=0;b--)for(var A=p.length,E=0;E<A;E++){for(var _=p[E],T=[],M=[],N=S[b],I=S[b+1],F=0,P=I-1;P>=N;P--){var U=x[P];U===b?F=y[P]:U<b&&(T.push(y[P]),M.push(U))}if(s(F,0))if(s(_[b],0)){if(E===0){var j=[..._];j[b]=1;for(var k=0,Z=M.length;k<Z;k++){var z=M[k];j[z]=a(j[z],T[k])}p.push(j)}}else{if(E===0)return[];p.splice(E,1),E-=1,A-=1}else{_[b]=n(_[b],F);for(var G=0,V=M.length;G<V;G++){var $=M[G];_[$]=a(_[$],i(_[b],T[G]))}}}return p.map(me=>new o({data:me.map(fe=>[fe]),size:[m,1]}))}}),TQ="matAlgo08xS0Sid",NQ=["typed","equalScalar"],tx=ee(TQ,NQ,t=>{var{typed:e,equalScalar:r}=t;return function(i,a,s){var o=i._values,l=i._index,u=i._ptr,c=i._size,f=i._datatype||i._data===void 0?i._datatype:i.getDataType(),h=a._values,p=a._index,m=a._ptr,v=a._size,y=a._datatype||a._data===void 0?a._datatype:a.getDataType();if(c.length!==v.length)throw new br(c.length,v.length);if(c[0]!==v[0]||c[1]!==v[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+v+")");if(!o||!h)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var x=c[0],S=c[1],b,A=r,E=0,_=s;typeof f=="string"&&f===y&&f!=="mixed"&&(b=f,A=e.find(r,[b,b]),E=e.convert(0,b),_=e.find(s,[b,b]));for(var T=[],M=[],N=[],I=[],F=[],P,U,G,V,$=0;$<S;$++){N[$]=M.length;var j=$+1;for(U=u[$],G=u[$+1],P=U;P<G;P++)V=l[P],F[V]=j,I[V]=o[P],M.push(V);for(U=m[$],G=m[$+1],P=U;P<G;P++)V=p[P],F[V]===j&&(I[V]=_(I[V],h[P]));for(P=N[$];P<M.length;){V=M[P];var k=I[V];A(k,E)?M.splice(P,1):(T.push(k),P++)}}return N[S]=M.length,i.createSparseMatrix({values:T,index:M,ptr:N,size:[x,S],datatype:f===i._datatype&&y===a._datatype?b:void 0})}}),rx=ee("useMatrixForArrayScalar",["typed","matrix"],t=>{var{typed:e,matrix:r}=t;return{"Array, number":e.referTo("DenseMatrix, number",n=>(i,a)=>n(r(i),a).valueOf()),"Array, BigNumber":e.referTo("DenseMatrix, BigNumber",n=>(i,a)=>n(r(i),a).valueOf()),"number, Array":e.referTo("number, DenseMatrix",n=>(i,a)=>n(i,r(a)).valueOf()),"BigNumber, Array":e.referTo("BigNumber, DenseMatrix",n=>(i,a)=>n(i,r(a)).valueOf())}}),$D="leftShift",MQ=["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],IQ=ee($D,MQ,t=>{var{typed:e,matrix:r,equalScalar:n,zeros:i,DenseMatrix:a,concat:s}=t,o=wl({typed:e}),l=Hs({typed:e,equalScalar:n}),u=tx({typed:e,equalScalar:n}),c=Dc({typed:e,DenseMatrix:a}),f=Ei({typed:e,equalScalar:n}),h=qs({typed:e}),p=on({typed:e,matrix:r,concat:s}),m=rx({typed:e,matrix:r});return e($D,{"number, number":UI,"BigNumber, BigNumber":eK,"bigint, bigint":(v,y)=>v<<y,"SparseMatrix, number | BigNumber":e.referToSelf(v=>(y,x)=>n(x,0)?y.clone():f(y,x,v,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(v=>(y,x)=>n(x,0)?y.clone():h(y,x,v,!1)),"number | BigNumber, SparseMatrix":e.referToSelf(v=>(y,x)=>n(y,0)?i(x.size(),x.storage()):c(x,y,v,!0)),"number | BigNumber, DenseMatrix":e.referToSelf(v=>(y,x)=>n(y,0)?i(x.size(),x.storage()):h(x,y,v,!0))},m,p({SS:u,DS:o,SD:l}))}),kD="rightArithShift",FQ=["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],OQ=ee(kD,FQ,t=>{var{typed:e,matrix:r,equalScalar:n,zeros:i,DenseMatrix:a,concat:s}=t,o=wl({typed:e}),l=Hs({typed:e,equalScalar:n}),u=tx({typed:e,equalScalar:n}),c=Dc({typed:e,DenseMatrix:a}),f=Ei({typed:e,equalScalar:n}),h=qs({typed:e}),p=on({typed:e,matrix:r,concat:s}),m=rx({typed:e,matrix:r});return e(kD,{"number, number":zI,"BigNumber, BigNumber":tK,"bigint, bigint":(v,y)=>v>>y,"SparseMatrix, number | BigNumber":e.referToSelf(v=>(y,x)=>n(x,0)?y.clone():f(y,x,v,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(v=>(y,x)=>n(x,0)?y.clone():h(y,x,v,!1)),"number | BigNumber, SparseMatrix":e.referToSelf(v=>(y,x)=>n(y,0)?i(x.size(),x.storage()):c(x,y,v,!0)),"number | BigNumber, DenseMatrix":e.referToSelf(v=>(y,x)=>n(y,0)?i(x.size(),x.storage()):h(x,y,v,!0))},m,p({SS:u,DS:o,SD:l}))}),LD="rightLogShift",BQ=["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],RQ=ee(LD,BQ,t=>{var{typed:e,matrix:r,equalScalar:n,zeros:i,DenseMatrix:a,concat:s}=t,o=wl({typed:e}),l=Hs({typed:e,equalScalar:n}),u=tx({typed:e,equalScalar:n}),c=Dc({typed:e,DenseMatrix:a}),f=Ei({typed:e,equalScalar:n}),h=qs({typed:e}),p=on({typed:e,matrix:r,concat:s}),m=rx({typed:e,matrix:r});return e(LD,{"number, number":GI,"SparseMatrix, number | BigNumber":e.referToSelf(v=>(y,x)=>n(x,0)?y.clone():f(y,x,v,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(v=>(y,x)=>n(x,0)?y.clone():h(y,x,v,!1)),"number | BigNumber, SparseMatrix":e.referToSelf(v=>(y,x)=>n(y,0)?i(x.size(),x.storage()):c(x,y,v,!0)),"number | BigNumber, DenseMatrix":e.referToSelf(v=>(y,x)=>n(y,0)?i(x.size(),x.storage()):h(x,y,v,!0))},m,p({SS:u,DS:o,SD:l}))}),UD="and",PQ=["typed","matrix","equalScalar","zeros","not","concat"],IF=ee(UD,PQ,t=>{var{typed:e,matrix:r,equalScalar:n,zeros:i,not:a,concat:s}=t,o=Hs({typed:e,equalScalar:n}),l=fg({typed:e,equalScalar:n}),u=Ei({typed:e,equalScalar:n}),c=qs({typed:e}),f=on({typed:e,matrix:r,concat:s});return e(UD,{"number, number":X1,"Complex, Complex":function(p,m){return(p.re!==0||p.im!==0)&&(m.re!==0||m.im!==0)},"BigNumber, BigNumber":function(p,m){return!p.isZero()&&!m.isZero()&&!p.isNaN()&&!m.isNaN()},"bigint, bigint":X1,"Unit, Unit":e.referToSelf(h=>(p,m)=>h(p.value||0,m.value||0)),"SparseMatrix, any":e.referToSelf(h=>(p,m)=>a(m)?i(p.size(),p.storage()):u(p,m,h,!1)),"DenseMatrix, any":e.referToSelf(h=>(p,m)=>a(m)?i(p.size(),p.storage()):c(p,m,h,!1)),"any, SparseMatrix":e.referToSelf(h=>(p,m)=>a(p)?i(p.size(),p.storage()):u(m,p,h,!0)),"any, DenseMatrix":e.referToSelf(h=>(p,m)=>a(p)?i(p.size(),p.storage()):c(m,p,h,!0)),"Array, any":e.referToSelf(h=>(p,m)=>h(r(p),m).valueOf()),"any, Array":e.referToSelf(h=>(p,m)=>h(p,r(m)).valueOf())},f({SS:l,DS:o}))}),Sv="compare",$Q=["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix","concat"],kQ=ee(Sv,$Q,t=>{var{typed:e,config:r,equalScalar:n,matrix:i,BigNumber:a,Fraction:s,DenseMatrix:o,concat:l}=t,u=Zi({typed:e}),c=cg({typed:e,equalScalar:n}),f=Jn({typed:e,DenseMatrix:o}),h=on({typed:e,matrix:i,concat:l}),p=Sh({typed:e});return e(Sv,LQ({typed:e,config:r}),{"boolean, boolean":function(v,y){return v===y?0:v>y?1:-1},"BigNumber, BigNumber":function(v,y){return as(v,y,r.relTol,r.absTol)?new a(0):new a(v.cmp(y))},"bigint, bigint":function(v,y){return v===y?0n:v>y?1n:-1n},"Fraction, Fraction":function(v,y){return new s(v.compare(y))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},p,h({SS:c,DS:u,Ss:f}))}),LQ=ee(Sv,["typed","config"],t=>{var{typed:e,config:r}=t;return e(Sv,{"number, number":function(i,a){return _i(i,a,r.relTol,r.absTol)?0:i>a?1:-1}})}),UQ=function t(e,r){var n=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,i=/(^[ ]*|[ ]*$)/g,a=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,s=/^0x[0-9a-f]+$/i,o=/^0/,l=function(b){return t.insensitive&&(""+b).toLowerCase()||""+b},u=l(e).replace(i,"")||"",c=l(r).replace(i,"")||"",f=u.replace(n,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),h=c.replace(n,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=parseInt(u.match(s),16)||f.length!==1&&u.match(a)&&Date.parse(u),m=parseInt(c.match(s),16)||p&&c.match(a)&&Date.parse(c)||null,v,y;if(m){if(p<m)return-1;if(p>m)return 1}for(var x=0,S=Math.max(f.length,h.length);x<S;x++){if(v=!(f[x]||"").match(o)&&parseFloat(f[x])||f[x]||0,y=!(h[x]||"").match(o)&&parseFloat(h[x])||h[x]||0,isNaN(v)!==isNaN(y))return isNaN(v)?1:-1;if(typeof v!=typeof y&&(v+="",y+=""),v<y)return-1;if(v>y)return 1}return 0};const gf=gl(UQ);var zD="compareNatural",zQ=["typed","compare"],GQ=ee(zD,zQ,t=>{var{typed:e,compare:r}=t,n=r.signatures["boolean,boolean"];return e(zD,{"any, any":i});function i(l,u){var c=tn(l),f=tn(u),h;if((c==="number"||c==="BigNumber"||c==="Fraction")&&(f==="number"||f==="BigNumber"||f==="Fraction"))return h=r(l,u),h.toString()!=="0"?h>0?1:-1:gf(c,f);var p=["Array","DenseMatrix","SparseMatrix"];if(p.includes(c)||p.includes(f))return h=a(i,l,u),h!==0?h:gf(c,f);if(c!==f)return gf(c,f);if(c==="Complex")return qQ(l,u);if(c==="Unit")return l.equalBase(u)?i(l.value,u.value):s(i,l.formatUnits(),u.formatUnits());if(c==="boolean")return n(l,u);if(c==="string")return gf(l,u);if(c==="Object")return o(i,l,u);if(c==="null"||c==="undefined")return 0;throw new TypeError('Unsupported type of value "'+c+'"')}function a(l,u,c){return fc(u)&&fc(c)?s(l,u.toJSON().values,c.toJSON().values):fc(u)?a(l,u.toArray(),c):fc(c)?a(l,u,c.toArray()):fv(u)?a(l,u.toJSON().data,c):fv(c)?a(l,u,c.toJSON().data):Array.isArray(u)?Array.isArray(c)?s(l,u,c):a(l,u,[c]):a(l,[u],c)}function s(l,u,c){for(var f=0,h=Math.min(u.length,c.length);f<h;f++){var p=l(u[f],c[f]);if(p!==0)return p}return u.length>c.length?1:u.length<c.length?-1:0}function o(l,u,c){var f=Object.keys(u),h=Object.keys(c);f.sort(gf),h.sort(gf);var p=s(l,f,h);if(p!==0)return p;for(var m=0;m<f.length;m++){var v=l(u[f[m]],c[h[m]]);if(v!==0)return v}return 0}});function qQ(t,e){return t.re>e.re?1:t.re<e.re?-1:t.im>e.im?1:t.im<e.im?-1:0}var GD="compareText",HQ=["typed","matrix","concat"];U1.signature="any, any";var WQ=ee(GD,HQ,t=>{var{typed:e,matrix:r,concat:n}=t,i=on({typed:e,matrix:r,concat:n});return e(GD,U1,i({elop:U1,Ds:!0}))}),Dv="equal",VQ=["typed","matrix","equalScalar","DenseMatrix","concat","SparseMatrix"],XQ=ee(Dv,VQ,t=>{var{typed:e,matrix:r,equalScalar:n,DenseMatrix:i,concat:a,SparseMatrix:s}=t,o=Zi({typed:e}),l=Ao({typed:e,SparseMatrix:s}),u=Jn({typed:e,DenseMatrix:i}),c=on({typed:e,matrix:r,concat:a});return e(Dv,jQ({typed:e,equalScalar:n}),c({elop:n,SS:l,DS:o,Ss:u}))}),jQ=ee(Dv,["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return e(Dv,{"any, any":function(i,a){return i===null?a===null:a===null?i===null:i===void 0?a===void 0:a===void 0?i===void 0:r(i,a)}})}),qD="equalText",YQ=["typed","compareText","isZero"],KQ=ee(qD,YQ,t=>{var{typed:e,compareText:r,isZero:n}=t;return e(qD,{"any, any":function(a,s){return n(r(a,s))}})}),Cv="smaller",ZQ=["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],QQ=ee(Cv,ZQ,t=>{var{typed:e,config:r,bignumber:n,matrix:i,DenseMatrix:a,concat:s,SparseMatrix:o}=t,l=Zi({typed:e}),u=Ao({typed:e,SparseMatrix:o}),c=Jn({typed:e,DenseMatrix:a}),f=on({typed:e,matrix:i,concat:s}),h=Sh({typed:e});function p(m,v){return m.lt(v)&&!as(m,v,r.relTol,r.absTol)}return e(Cv,JQ({typed:e,config:r}),{"boolean, boolean":(m,v)=>m<v,"BigNumber, BigNumber":p,"bigint, bigint":(m,v)=>m<v,"Fraction, Fraction":(m,v)=>m.compare(v)===-1,"Fraction, BigNumber":function(v,y){return p(n(v),y)},"BigNumber, Fraction":function(v,y){return p(v,n(y))},"Complex, Complex":function(v,y){throw new TypeError("No ordering relation is defined for complex numbers")}},h,f({SS:u,DS:l,Ss:c}))}),JQ=ee(Cv,["typed","config"],t=>{var{typed:e,config:r}=t;return e(Cv,{"number, number":function(i,a){return i<a&&!_i(i,a,r.relTol,r.absTol)}})}),Tv="smallerEq",eJ=["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],tJ=ee(Tv,eJ,t=>{var{typed:e,config:r,matrix:n,DenseMatrix:i,concat:a,SparseMatrix:s}=t,o=Zi({typed:e}),l=Ao({typed:e,SparseMatrix:s}),u=Jn({typed:e,DenseMatrix:i}),c=on({typed:e,matrix:n,concat:a}),f=Sh({typed:e});return e(Tv,rJ({typed:e,config:r}),{"boolean, boolean":(h,p)=>h<=p,"BigNumber, BigNumber":function(p,m){return p.lte(m)||as(p,m,r.relTol,r.absTol)},"bigint, bigint":(h,p)=>h<=p,"Fraction, Fraction":(h,p)=>h.compare(p)!==1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},f,c({SS:l,DS:o,Ss:u}))}),rJ=ee(Tv,["typed","config"],t=>{var{typed:e,config:r}=t;return e(Tv,{"number, number":function(i,a){return i<=a||_i(i,a,r.relTol,r.absTol)}})}),Nv="larger",nJ=["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],iJ=ee(Nv,nJ,t=>{var{typed:e,config:r,bignumber:n,matrix:i,DenseMatrix:a,concat:s,SparseMatrix:o}=t,l=Zi({typed:e}),u=Ao({typed:e,SparseMatrix:o}),c=Jn({typed:e,DenseMatrix:a}),f=on({typed:e,matrix:i,concat:s}),h=Sh({typed:e});function p(m,v){return m.gt(v)&&!as(m,v,r.relTol,r.absTol)}return e(Nv,aJ({typed:e,config:r}),{"boolean, boolean":(m,v)=>m>v,"BigNumber, BigNumber":p,"bigint, bigint":(m,v)=>m>v,"Fraction, Fraction":(m,v)=>m.compare(v)===1,"Fraction, BigNumber":function(v,y){return p(n(v),y)},"BigNumber, Fraction":function(v,y){return p(v,n(y))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},h,f({SS:u,DS:l,Ss:c}))}),aJ=ee(Nv,["typed","config"],t=>{var{typed:e,config:r}=t;return e(Nv,{"number, number":function(i,a){return i>a&&!_i(i,a,r.relTol,r.absTol)}})}),Mv="largerEq",sJ=["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],oJ=ee(Mv,sJ,t=>{var{typed:e,config:r,matrix:n,DenseMatrix:i,concat:a,SparseMatrix:s}=t,o=Zi({typed:e}),l=Ao({typed:e,SparseMatrix:s}),u=Jn({typed:e,DenseMatrix:i}),c=on({typed:e,matrix:n,concat:a}),f=Sh({typed:e});return e(Mv,uJ({typed:e,config:r}),{"boolean, boolean":(h,p)=>h>=p,"BigNumber, BigNumber":function(p,m){return p.gte(m)||as(p,m,r.relTol,r.absTol)},"bigint, bigint":function(p,m){return p>=m},"Fraction, Fraction":(h,p)=>h.compare(p)!==-1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},f,c({SS:l,DS:o,Ss:u}))}),uJ=ee(Mv,["typed","config"],t=>{var{typed:e,config:r}=t;return e(Mv,{"number, number":function(i,a){return i>=a||_i(i,a,r.relTol,r.absTol)}})}),HD="deepEqual",lJ=["typed","equal"],cJ=ee(HD,lJ,t=>{var{typed:e,equal:r}=t;return e(HD,{"any, any":function(a,s){return n(a.valueOf(),s.valueOf())}});function n(i,a){if(Array.isArray(i))if(Array.isArray(a)){var s=i.length;if(s!==a.length)return!1;for(var o=0;o<s;o++)if(!n(i[o],a[o]))return!1;return!0}else return!1;else return Array.isArray(a)?!1:r(i,a)}}),Iv="unequal",fJ=["typed","config","equalScalar","matrix","DenseMatrix","concat","SparseMatrix"],hJ=ee(Iv,fJ,t=>{var{typed:e,config:r,equalScalar:n,matrix:i,DenseMatrix:a,concat:s,SparseMatrix:o}=t,l=Zi({typed:e}),u=Ao({typed:e,SparseMatrix:o}),c=Jn({typed:e,DenseMatrix:a}),f=on({typed:e,matrix:i,concat:s});return e(Iv,dJ({typed:e,equalScalar:n}),f({elop:h,SS:u,DS:l,Ss:c}));function h(p,m){return!n(p,m)}}),dJ=ee(Iv,["typed","equalScalar"],t=>{var{typed:e,equalScalar:r}=t;return e(Iv,{"any, any":function(i,a){return i===null?a!==null:a===null?i!==null:i===void 0?a!==void 0:a===void 0?i!==void 0:!r(i,a)}})}),WD="partitionSelect",pJ=["typed","isNumeric","isNaN","compare"],mJ=ee(WD,pJ,t=>{var{typed:e,isNumeric:r,isNaN:n,compare:i}=t,a=i,s=(u,c)=>-i(u,c);return e(WD,{"Array | Matrix, number":function(c,f){return o(c,f,a)},"Array | Matrix, number, string":function(c,f,h){if(h==="asc")return o(c,f,a);if(h==="desc")return o(c,f,s);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":o});function o(u,c,f){if(!Bt(c)||c<0)throw new Error("k must be a non-negative integer");if(Gt(u)){var h=u.size();if(h.length>1)throw new Error("Only one dimensional matrices supported");return l(u.valueOf(),c,f)}if(Array.isArray(u))return l(u,c,f)}function l(u,c,f){if(c>=u.length)throw new Error("k out of bounds");for(var h=0;h<u.length;h++)if(r(u[h])&&n(u[h]))return u[h];for(var p=0,m=u.length-1;p<m;){for(var v=p,y=m,x=u[Math.floor(Math.random()*(m-p+1))+p];v<y;)if(f(u[v],x)>=0){var S=u[y];u[y]=u[v],u[v]=S,--y}else++v;f(u[v],x)>0&&--v,c<=v?m=v:p=v+1}return u[c]}}),VD="sort",vJ=["typed","matrix","compare","compareNatural"],gJ=ee(VD,vJ,t=>{var{typed:e,matrix:r,compare:n,compareNatural:i}=t,a=n,s=(c,f)=>-n(c,f);return e(VD,{Array:function(f){return l(f),f.sort(a)},Matrix:function(f){return u(f),r(f.toArray().sort(a),f.storage())},"Array, function":function(f,h){return l(f),f.sort(h)},"Matrix, function":function(f,h){return u(f),r(f.toArray().sort(h),f.storage())},"Array, string":function(f,h){return l(f),f.sort(o(h))},"Matrix, string":function(f,h){return u(f),r(f.toArray().sort(o(h)),f.storage())}});function o(c){if(c==="asc")return a;if(c==="desc")return s;if(c==="natural")return i;throw new Error('String "asc", "desc", or "natural" expected')}function l(c){if(er(c).length!==1)throw new Error("One dimensional array expected")}function u(c){if(c.size().length!==1)throw new Error("One dimensional matrix expected")}}),XD="max",yJ=["typed","config","numeric","larger","isNaN"],FF=ee(XD,yJ,t=>{var{typed:e,config:r,numeric:n,larger:i,isNaN:a}=t;return e(XD,{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(u,c){return lg(u,c.valueOf(),s)},"...":function(u){if(_h(u))throw new TypeError("Scalar values expected in function max");return o(u)}});function s(l,u){try{return i(l,u)?l:u}catch(c){throw Yi(c,"max",u)}}function o(l){var u;if(ml(l,function(c){try{(a(c)||u===void 0||i(c,u))&&(u=c)}catch(f){throw Yi(f,"max",c)}}),u===void 0)throw new Error("Cannot calculate max of an empty array");return typeof u=="string"&&(u=n(u,bl(u,r))),u}}),jD="min",bJ=["typed","config","numeric","smaller","isNaN"],OF=ee(jD,bJ,t=>{var{typed:e,config:r,numeric:n,smaller:i,isNaN:a}=t;return e(jD,{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(u,c){return lg(u,c.valueOf(),s)},"...":function(u){if(_h(u))throw new TypeError("Scalar values expected in function min");return o(u)}});function s(l,u){try{return i(l,u)?l:u}catch(c){throw Yi(c,"min",u)}}function o(l){var u;if(ml(l,function(c){try{(a(c)||u===void 0||i(c,u))&&(u=c)}catch(f){throw Yi(f,"min",c)}}),u===void 0)throw new Error("Cannot calculate min of an empty array");return typeof u=="string"&&(u=n(u,bl(u,r))),u}}),xJ="ImmutableDenseMatrix",wJ=["smaller","DenseMatrix"],_J=ee(xJ,wJ,t=>{var{smaller:e,DenseMatrix:r}=t;function n(i,a){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(a&&!Fi(a))throw new Error("Invalid datatype: "+a);if(Gt(i)||Jr(i)){var s=new r(i,a);this._data=s._data,this._size=s._size,this._datatype=s._datatype,this._min=null,this._max=null}else if(i&&Jr(i.data)&&Jr(i.size))this._data=i.data,this._size=i.size,this._datatype=i.datatype,this._min=typeof i.min<"u"?i.min:null,this._max=typeof i.max<"u"?i.max:null;else{if(i)throw new TypeError("Unsupported type of data ("+tn(i)+")");this._data=[],this._size=[0],this._datatype=a,this._min=null,this._max=null}}return n.prototype=new r,n.prototype.type="ImmutableDenseMatrix",n.prototype.isImmutableDenseMatrix=!0,n.prototype.subset=function(i){switch(arguments.length){case 1:{var a=r.prototype.subset.call(this,i);return Gt(a)?new n({data:a._data,size:a._size,datatype:a._datatype}):a}case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},n.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},n.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},n.prototype.clone=function(){return new n({data:rr(this._data),size:rr(this._size),datatype:this._datatype})},n.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.fromJSON=function(i){return new n(i)},n.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},n.prototype.min=function(){if(this._min===null){var i=null;this.forEach(function(a){(i===null||e(a,i))&&(i=a)}),this._min=i!==null?i:void 0}return this._min},n.prototype.max=function(){if(this._max===null){var i=null;this.forEach(function(a){(i===null||e(i,a))&&(i=a)}),this._max=i!==null?i:void 0}return this._max},n},{isClass:!0}),AJ="Index",EJ=["ImmutableDenseMatrix","getMatrixDataType"],SJ=ee(AJ,EJ,t=>{var{ImmutableDenseMatrix:e,getMatrixDataType:r}=t;function n(a){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var s=0,o=arguments.length;s<o;s++){var l=arguments[s],u=Jr(l),c=Gt(l),f=typeof l,h=null;if(Gb(l))this._dimensions.push(l),this._isScalar=!1;else if(u||c){var p=void 0;r(l)==="boolean"?(u&&(p=i(YD(l).valueOf())),c&&(p=i(YD(l._data).valueOf())),h=l.valueOf().length):p=i(l.valueOf()),this._dimensions.push(p);var m=p.size();(m.length!==1||m[0]!==1||h!==null)&&(this._isScalar=!1)}else if(f==="number")this._dimensions.push(i([l]));else if(f==="bigint")this._dimensions.push(i([Number(l)]));else if(f==="string")this._dimensions.push(l);else throw new TypeError("Dimension must be an Array, Matrix, number, bigint, string, or Range");this._sourceSize.push(h)}}n.prototype.type="Index",n.prototype.isIndex=!0;function i(a){for(var s=0,o=a.length;s<o;s++)if(typeof a[s]!="number"||!Bt(a[s]))throw new TypeError("Index parameters must be positive integer numbers");return new e(a)}return n.prototype.clone=function(){var a=new n;return a._dimensions=rr(this._dimensions),a._isScalar=this._isScalar,a._sourceSize=this._sourceSize,a},n.create=function(a){var s=new n;return n.apply(s,a),s},n.prototype.size=function(){for(var a=[],s=0,o=this._dimensions.length;s<o;s++){var l=this._dimensions[s];a[s]=typeof l=="string"?1:l.size()[0]}return a},n.prototype.max=function(){for(var a=[],s=0,o=this._dimensions.length;s<o;s++){var l=this._dimensions[s];a[s]=typeof l=="string"?l:l.max()}return a},n.prototype.min=function(){for(var a=[],s=0,o=this._dimensions.length;s<o;s++){var l=this._dimensions[s];a[s]=typeof l=="string"?l:l.min()}return a},n.prototype.forEach=function(a){for(var s=0,o=this._dimensions.length;s<o;s++)a(this._dimensions[s],s,this)},n.prototype.dimension=function(a){return typeof a!="number"?null:this._dimensions[a]||null},n.prototype.isObjectProperty=function(){return this._dimensions.length===1&&typeof this._dimensions[0]=="string"},n.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},n.prototype.isScalar=function(){return this._isScalar},n.prototype.toArray=function(){for(var a=[],s=0,o=this._dimensions.length;s<o;s++){var l=this._dimensions[s];a.push(typeof l=="string"?l:l.toArray())}return a},n.prototype.valueOf=n.prototype.toArray,n.prototype.toString=function(){for(var a=[],s=0,o=this._dimensions.length;s<o;s++){var l=this._dimensions[s];typeof l=="string"?a.push(JSON.stringify(l)):a.push(l.toString())}return"["+a.join(", ")+"]"},n.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},n.fromJSON=function(a){return n.create(a.dimensions)},n},{isClass:!0});function YD(t){var e=[];return t.forEach((r,n)=>{r&&e.push(n)}),e}var DJ="FibonacciHeap",CJ=["smaller","larger"],TJ=ee(DJ,CJ,t=>{var{smaller:e,larger:r}=t,n=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(c,f){var h={key:c,value:f,degree:0};if(this._minimum){var p=this._minimum;h.left=p,h.right=p.right,p.right=h,h.right.left=h,e(c,p.key)&&(this._minimum=h)}else h.left=h,h.right=h,this._minimum=h;return this._size++,h},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return this._size===0},i.prototype.extractMinimum=function(){var c=this._minimum;if(c===null)return c;for(var f=this._minimum,h=c.degree,p=c.child;h>0;){var m=p.right;p.left.right=p.right,p.right.left=p.left,p.left=f,p.right=f.right,f.right=p,p.right.left=p,p.parent=null,p=m,h--}return c.left.right=c.right,c.right.left=c.left,c===c.right?f=null:(f=c.right,f=u(f,this._size)),this._size--,this._minimum=f,c},i.prototype.remove=function(c){this._minimum=a(this._minimum,c,-1),this.extractMinimum()};function a(c,f,h){f.key=h;var p=f.parent;return p&&e(f.key,p.key)&&(s(c,f,p),o(c,p)),e(f.key,c.key)&&(c=f),c}function s(c,f,h){f.left.right=f.right,f.right.left=f.left,h.degree--,h.child===f&&(h.child=f.right),h.degree===0&&(h.child=null),f.left=c,f.right=c.right,c.right=f,f.right.left=f,f.parent=null,f.mark=!1}function o(c,f){var h=f.parent;h&&(f.mark?(s(c,f,h),o(h)):f.mark=!0)}var l=function(f,h){f.left.right=f.right,f.right.left=f.left,f.parent=h,h.child?(f.left=h.child,f.right=h.child.right,h.child.right=f,f.right.left=f):(h.child=f,f.right=f,f.left=f),h.degree++,f.mark=!1};function u(c,f){var h=Math.floor(Math.log(f)*n)+1,p=new Array(h),m=0,v=c;if(v)for(m++,v=v.right;v!==c;)m++,v=v.right;for(var y;m>0;){for(var x=v.degree,S=v.right;y=p[x],!!y;){if(r(v.key,y.key)){var b=y;y=v,v=b}l(y,v),p[x]=null,x++}p[x]=v,v=S,m--}c=null;for(var A=0;A<h;A++)y=p[A],y&&(c?(y.left.right=y.right,y.right.left=y.left,y.left=c,y.right=c.right,c.right=y,y.right.left=y,e(y.key,c.key)&&(c=y)):c=y);return c}return i},{isClass:!0}),NJ="Spa",MJ=["addScalar","equalScalar","FibonacciHeap"],IJ=ee(NJ,MJ,t=>{var{addScalar:e,equalScalar:r,FibonacciHeap:n}=t;function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new n}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(a,s){if(this._values[a])this._values[a].value=s;else{var o=this._heap.insert(a,s);this._values[a]=o}},i.prototype.get=function(a){var s=this._values[a];return s?s.value:0},i.prototype.accumulate=function(a,s){var o=this._values[a];o?o.value=e(o.value,s):(o=this._heap.insert(a,s),this._values[a]=o)},i.prototype.forEach=function(a,s,o){var l=this._heap,u=this._values,c=[],f=l.extractMinimum();for(f&&c.push(f);f&&f.key<=s;)f.key>=a&&(r(f.value,0)||o(f.key,f.value,this)),f=l.extractMinimum(),f&&c.push(f);for(var h=0;h<c.length;h++){var p=c[h];f=l.insert(p.key,p.value),u[f.key]=f}},i.prototype.swap=function(a,s){var o=this._values[a],l=this._values[s];if(!o&&l)o=this._heap.insert(a,l.value),this._heap.remove(l),this._values[a]=o,this._values[s]=void 0;else if(o&&!l)l=this._heap.insert(s,o.value),this._heap.remove(o),this._values[s]=l,this._values[a]=void 0;else if(o&&l){var u=o.value;o.value=l.value,l.value=u}},i},{isClass:!0});function FJ(t){var e=0,r=1,n=Object.create(null),i=Object.create(null),a=0,s=function(l){var u=i[l];if(u&&(delete n[u],delete i[l],--e,r===u)){if(!e){a=0,r=1;return}for(;!Object.prototype.hasOwnProperty.call(n,++r););}};return t=Math.abs(t),{hit:function(l){var u=i[l],c=++a;if(n[c]=l,i[l]=c,!u)return++e,e<=t?void 0:(l=n[r],s(l),l);if(delete n[u],r===u)for(;!Object.prototype.hasOwnProperty.call(n,++r););},delete:s,clear:function(){e=a=0,r=1,n=Object.create(null),i=Object.create(null)}}}function Wd(t){var{hasher:e,limit:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return r=r??Number.POSITIVE_INFINITY,e=e??JSON.stringify,function n(){typeof n.cache!="object"&&(n.cache={values:new Map,lru:FJ(r||Number.POSITIVE_INFINITY)});for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var s=e(i);if(n.cache.values.has(s))return n.cache.lru.hit(s),n.cache.values.get(s);var o=t.apply(t,i);return n.cache.values.set(s,o),n.cache.values.delete(n.cache.lru.hit(s)),o}}var OJ=Wd(function(t){return new t(1).exp()},{hasher:hg}),BJ=Wd(function(t){return new t(1).plus(new t(5).sqrt()).div(2)},{hasher:hg}),nx=Wd(function(t){return t.acos(-1)},{hasher:hg}),RJ=Wd(function(t){return nx(t).times(2)},{hasher:hg});function hg(t){return t[0].precision}function KD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ly(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?KD(Object(r),!0).forEach(function(n){Gn(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):KD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var PJ="Unit",$J=["?on","config","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","number","Complex","BigNumber","Fraction"],kJ=ee(PJ,$J,t=>{var{on:e,config:r,addScalar:n,subtractScalar:i,multiplyScalar:a,divideScalar:s,pow:o,abs:l,fix:u,round:c,equal:f,isNumeric:h,format:p,number:m,Complex:v,BigNumber:y,Fraction:x}=t,S=m;function b(ae,ce){if(!(this instanceof b))throw new Error("Constructor must be called with the new operator");if(!(ae==null||h(ae)||pu(ae)))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(this.fixPrefix=!1,this.skipAutomaticSimplification=!0,ce===void 0)this.units=[],this.dimensions=Z.map(Ue=>0);else if(typeof ce=="string"){var Ce=b.parse(ce);this.units=Ce.units,this.dimensions=Ce.dimensions}else if(es(ce)&&ce.value===null)this.fixPrefix=ce.fixPrefix,this.skipAutomaticSimplification=ce.skipAutomaticSimplification,this.dimensions=ce.dimensions.slice(0),this.units=ce.units.map(Ue=>Zn({},Ue));else throw new TypeError("Second parameter in Unit constructor must be a string or valueless Unit");this.value=this._normalize(ae)}Object.defineProperty(b,"name",{value:"Unit"}),b.prototype.constructor=b,b.prototype.type="Unit",b.prototype.isUnit=!0;var A,E,_;function T(){for(;_===" "||_==="	";)I()}function M(ae){return ae>="0"&&ae<="9"||ae==="."}function N(ae){return ae>="0"&&ae<="9"}function I(){E++,_=A.charAt(E)}function F(ae){E=ae,_=A.charAt(E)}function P(){var ae="",ce=E;if(_==="+"?I():_==="-"&&(ae+=_,I()),!M(_))return F(ce),null;if(_==="."){if(ae+=_,I(),!N(_))return F(ce),null}else{for(;N(_);)ae+=_,I();_==="."&&(ae+=_,I())}for(;N(_);)ae+=_,I();if(_==="E"||_==="e"){var Ce="",Ue=E;if(Ce+=_,I(),(_==="+"||_==="-")&&(Ce+=_,I()),!N(_))return F(Ue),ae;for(ae=ae+Ce;N(_);)ae+=_,I()}return ae}function U(){for(var ae="";N(_)||b.isValidAlpha(_);)ae+=_,I();var ce=ae.charAt(0);return b.isValidAlpha(ce)?ae:null}function G(ae){return _===ae?(I(),ae):null}b.parse=function(ae,ce){if(ce=ce||{},A=ae,E=-1,_="",typeof A!="string")throw new TypeError("Invalid argument in Unit.parse, string expected");var Ce=new b;Ce.units=[];var Ue=1,Ve=!1;I(),T();var je=P(),ht=null;if(je){if(r.number==="BigNumber")ht=new y(je);else if(r.number==="Fraction")try{ht=new x(je)}catch{ht=parseFloat(je)}else ht=parseFloat(je);T(),G("*")?(Ue=1,Ve=!0):G("/")&&(Ue=-1,Ve=!0)}for(var re=[],we=1;;){for(T();_==="(";)re.push(Ue),we*=Ue,Ue=1,I(),T();var Ne=void 0;if(_){var Ge=_;if(Ne=U(),Ne===null)throw new SyntaxError('Unexpected "'+Ge+'" in "'+A+'" at index '+E.toString())}else break;var He=V(Ne);if(He===null)throw new SyntaxError('Unit "'+Ne+'" not found.');var We=Ue*we;if(T(),G("^")){T();var ft=P();if(ft===null)throw new SyntaxError('In "'+ae+'", "^" must be followed by a floating-point number');We*=ft}Ce.units.push({unit:He.unit,prefix:He.prefix,power:We});for(var st=0;st<Z.length;st++)Ce.dimensions[st]+=(He.unit.dimensions[st]||0)*We;for(T();_===")";){if(re.length===0)throw new SyntaxError('Unmatched ")" in "'+A+'" at index '+E.toString());we/=re.pop(),I(),T()}if(Ve=!1,G("*")?(Ue=1,Ve=!0):G("/")?(Ue=-1,Ve=!0):Ue=1,He.unit.base){var dt=He.unit.base.key;Se.auto[dt]={unit:He.unit,prefix:He.prefix}}}if(T(),_)throw new SyntaxError('Could not parse: "'+ae+'"');if(Ve)throw new SyntaxError('Trailing characters: "'+ae+'"');if(re.length!==0)throw new SyntaxError('Unmatched "(" in "'+A+'"');if(Ce.units.length===0&&!ce.allowNoUnits)throw new SyntaxError('"'+ae+'" contains no units');return Ce.value=ht!==void 0?Ce._normalize(ht):null,Ce},b.prototype.clone=function(){var ae=new b;ae.fixPrefix=this.fixPrefix,ae.skipAutomaticSimplification=this.skipAutomaticSimplification,ae.value=rr(this.value),ae.dimensions=this.dimensions.slice(0),ae.units=[];for(var ce=0;ce<this.units.length;ce++){ae.units[ce]={};for(var Ce in this.units[ce])Ft(this.units[ce],Ce)&&(ae.units[ce][Ce]=this.units[ce][Ce])}return ae},b.prototype.valueType=function(){return tn(this.value)},b.prototype._isDerived=function(){return this.units.length===0?!1:this.units.length>1||Math.abs(this.units[0].power-1)>1e-15},b.prototype._normalize=function(ae){if(ae==null||this.units.length===0)return ae;for(var ce=ae,Ce=b._getNumberConverter(tn(ae)),Ue=0;Ue<this.units.length;Ue++){var Ve=Ce(this.units[Ue].unit.value),je=Ce(this.units[Ue].prefix.value),ht=Ce(this.units[Ue].power);ce=a(ce,o(a(Ve,je),ht))}return ce},b.prototype._denormalize=function(ae,ce){if(ae==null||this.units.length===0)return ae;for(var Ce=ae,Ue=b._getNumberConverter(tn(ae)),Ve=0;Ve<this.units.length;Ve++){var je=Ue(this.units[Ve].unit.value),ht=Ue(this.units[Ve].prefix.value),re=Ue(this.units[Ve].power);Ce=s(Ce,o(a(je,ht),re))}return Ce};var V=Wd(ae=>{if(Ft(le,ae)){var ce=le[ae],Ce=ce.prefixes[""];return{unit:ce,prefix:Ce}}for(var Ue in le)if(Ft(le,Ue)&&VV(ae,Ue)){var Ve=le[Ue],je=ae.length-Ue.length,ht=ae.substring(0,je),re=Ft(Ve.prefixes,ht)?Ve.prefixes[ht]:void 0;if(re!==void 0)return{unit:Ve,prefix:re}}return null},{hasher:ae=>ae[0],limit:100});b.isValuelessUnit=function(ae){return V(ae)!==null},b.prototype.hasBase=function(ae){if(typeof ae=="string"&&(ae=z[ae]),!ae)return!1;for(var ce=0;ce<Z.length;ce++)if(Math.abs((this.dimensions[ce]||0)-(ae.dimensions[ce]||0))>1e-12)return!1;return!0},b.prototype.equalBase=function(ae){for(var ce=0;ce<Z.length;ce++)if(Math.abs((this.dimensions[ce]||0)-(ae.dimensions[ce]||0))>1e-12)return!1;return!0},b.prototype.equals=function(ae){return this.equalBase(ae)&&f(this.value,ae.value)},b.prototype.multiply=function(ae){for(var ce=this.clone(),Ce=es(ae)?ae:new b(ae),Ue=0;Ue<Z.length;Ue++)ce.dimensions[Ue]=(this.dimensions[Ue]||0)+(Ce.dimensions[Ue]||0);for(var Ve=0;Ve<Ce.units.length;Ve++){var je=ly({},Ce.units[Ve]);ce.units.push(je)}if(this.value!==null||Ce.value!==null){var ht=this.value===null?this._normalize(j(Ce.value)):this.value,re=Ce.value===null?Ce._normalize(j(this.value)):Ce.value;ce.value=a(ht,re)}else ce.value=null;return es(ae)&&(ce.skipAutomaticSimplification=!1),$(ce)},b.prototype.divideInto=function(ae){return new b(ae).divide(this)},b.prototype.divide=function(ae){for(var ce=this.clone(),Ce=es(ae)?ae:new b(ae),Ue=0;Ue<Z.length;Ue++)ce.dimensions[Ue]=(this.dimensions[Ue]||0)-(Ce.dimensions[Ue]||0);for(var Ve=0;Ve<Ce.units.length;Ve++){var je=ly(ly({},Ce.units[Ve]),{},{power:-Ce.units[Ve].power});ce.units.push(je)}if(this.value!==null||Ce.value!==null){var ht=this.value===null?this._normalize(j(Ce.value)):this.value,re=Ce.value===null?Ce._normalize(j(this.value)):Ce.value;ce.value=s(ht,re)}else ce.value=null;return es(ae)&&(ce.skipAutomaticSimplification=!1),$(ce)},b.prototype.pow=function(ae){for(var ce=this.clone(),Ce=0;Ce<Z.length;Ce++)ce.dimensions[Ce]=(this.dimensions[Ce]||0)*ae;for(var Ue=0;Ue<ce.units.length;Ue++)ce.units[Ue].power*=ae;return ce.value!==null?ce.value=o(ce.value,ae):ce.value=null,ce.skipAutomaticSimplification=!1,$(ce)};function $(ae){return ae.equalBase(z.NONE)&&ae.value!==null&&!r.predictable?ae.value:ae}function j(ae){var ce=b._getNumberConverter(tn(ae));return ce(1)}b.prototype.abs=function(){var ae=this.clone();if(ae.value!==null)if(ae._isDerived()||ae.units.length===0||ae.units[0].unit.offset===0)ae.value=l(ae.value);else{var ce=ae._numberConverter(),Ce=ce(ae.units[0].unit.value),Ue=ce(ae.units[0].unit.offset),Ve=a(Ce,Ue);ae.value=i(l(n(ae.value,Ve)),Ve)}for(var je in ae.units)(ae.units[je].unit.name==="VA"||ae.units[je].unit.name==="VAR")&&(ae.units[je].unit=le.W);return ae},b.prototype.to=function(ae){var ce=this.value===null?this._normalize(1):this.value,Ce;if(typeof ae=="string")Ce=b.parse(ae);else if(es(ae))Ce=ae.clone();else throw new Error("String or Unit expected as parameter");if(!this.equalBase(Ce))throw new Error("Units do not match ('".concat(Ce.toString(),"' != '").concat(this.toString(),"')"));if(Ce.value!==null)throw new Error("Cannot convert to a unit with a value");if(this.value===null||this._isDerived()||this.units.length===0||Ce.units.length===0||this.units[0].unit.offset===Ce.units[0].unit.offset)Ce.value=rr(ce);else{var Ue=b._getNumberConverter(tn(ce)),Ve=this.units[0].unit.value,je=this.units[0].unit.offset,ht=a(Ve,je),re=Ce.units[0].unit.value,we=Ce.units[0].unit.offset,Ne=a(re,we);Ce.value=n(ce,Ue(i(ht,Ne)))}return Ce.fixPrefix=!0,Ce.skipAutomaticSimplification=!0,Ce},b.prototype.toNumber=function(ae){return S(this.toNumeric(ae))},b.prototype.toNumeric=function(ae){var ce;return ae?ce=this.to(ae):ce=this.clone(),ce._isDerived()||ce.units.length===0?ce._denormalize(ce.value):ce._denormalize(ce.value,ce.units[0].prefix.value)},b.prototype.toString=function(){return this.format()},b.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.units.length>0?this.formatUnits():null,fixPrefix:this.fixPrefix}},b.fromJSON=function(ae){var ce,Ce=new b(ae.value,(ce=ae.unit)!==null&&ce!==void 0?ce:void 0);return Ce.fixPrefix=ae.fixPrefix||!1,Ce},b.prototype.valueOf=b.prototype.toString,b.prototype.simplify=function(){var ae=this.clone(),ce=[],Ce;for(var Ue in oe)if(Ft(oe,Ue)&&ae.hasBase(z[Ue])){Ce=Ue;break}if(Ce==="NONE")ae.units=[];else{var Ve;if(Ce&&Ft(oe,Ce)&&(Ve=oe[Ce]),Ve)ae.units=[{unit:Ve.unit,prefix:Ve.prefix,power:1}];else{for(var je=!1,ht=0;ht<Z.length;ht++){var re=Z[ht];Math.abs(ae.dimensions[ht]||0)>1e-12&&(Ft(oe,re)?ce.push({unit:oe[re].unit,prefix:oe[re].prefix,power:ae.dimensions[ht]||0}):je=!0)}ce.length<ae.units.length&&!je&&(ae.units=ce)}}return ae},b.prototype.toSI=function(){for(var ae=this.clone(),ce=[],Ce=0;Ce<Z.length;Ce++){var Ue=Z[Ce];if(Math.abs(ae.dimensions[Ce]||0)>1e-12)if(Ft(Se.si,Ue))ce.push({unit:Se.si[Ue].unit,prefix:Se.si[Ue].prefix,power:ae.dimensions[Ce]||0});else throw new Error("Cannot express custom unit "+Ue+" in SI units")}return ae.units=ce,ae.fixPrefix=!0,ae.skipAutomaticSimplification=!0,this.value!==null?(ae.value=null,this.to(ae)):ae},b.prototype.formatUnits=function(){for(var ae="",ce="",Ce=0,Ue=0,Ve=0;Ve<this.units.length;Ve++)this.units[Ve].power>0?(Ce++,ae+=" "+this.units[Ve].prefix.name+this.units[Ve].unit.name,Math.abs(this.units[Ve].power-1)>1e-15&&(ae+="^"+this.units[Ve].power)):this.units[Ve].power<0&&Ue++;if(Ue>0)for(var je=0;je<this.units.length;je++)this.units[je].power<0&&(Ce>0?(ce+=" "+this.units[je].prefix.name+this.units[je].unit.name,Math.abs(this.units[je].power+1)>1e-15&&(ce+="^"+-this.units[je].power)):(ce+=" "+this.units[je].prefix.name+this.units[je].unit.name,ce+="^"+this.units[je].power));ae=ae.substr(1),ce=ce.substr(1),Ce>1&&Ue>0&&(ae="("+ae+")"),Ue>1&&Ce>0&&(ce="("+ce+")");var ht=ae;return Ce>0&&Ue>0&&(ht+=" / "),ht+=ce,ht},b.prototype.format=function(ae){var ce=this.skipAutomaticSimplification||this.value===null?this.clone():this.simplify(),Ce=!1;typeof ce.value<"u"&&ce.value!==null&&pu(ce.value)&&(Ce=Math.abs(ce.value.re)<1e-14);for(var Ue in ce.units)Ft(ce.units,Ue)&&ce.units[Ue].unit&&(ce.units[Ue].unit.name==="VA"&&Ce?ce.units[Ue].unit=le.VAR:ce.units[Ue].unit.name==="VAR"&&!Ce&&(ce.units[Ue].unit=le.VA));ce.units.length===1&&!ce.fixPrefix&&Math.abs(ce.units[0].power-Math.round(ce.units[0].power))<1e-14&&(ce.units[0].prefix=ce._bestPrefix());var Ve=ce._denormalize(ce.value),je=ce.value!==null?p(Ve,ae||{}):"",ht=ce.formatUnits();return ce.value&&pu(ce.value)&&(je="("+je+")"),ht.length>0&&je.length>0&&(je+=" "),je+=ht,je},b.prototype._bestPrefix=function(){if(this.units.length!==1)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var ae=this.value!==null?l(this.value):0,ce=l(this.units[0].unit.value),Ce=this.units[0].prefix;if(ae===0)return Ce;var Ue=this.units[0].power,Ve=Math.log(ae/Math.pow(Ce.value*ce,Ue))/Math.LN10-1.2;if(Ve>-2.200001&&Ve<1.800001)return Ce;Ve=Math.abs(Ve);var je=this.units[0].unit.prefixes;for(var ht in je)if(Ft(je,ht)){var re=je[ht];if(re.scientific){var we=Math.abs(Math.log(ae/Math.pow(re.value*ce,Ue))/Math.LN10-1.2);(we<Ve||we===Ve&&re.name.length<Ce.name.length)&&(Ce=re,Ve=we)}}return Ce},b.prototype.splitUnit=function(ae){for(var ce=this.clone(),Ce=[],Ue=0;Ue<ae.length&&(ce=ce.to(ae[Ue]),Ue!==ae.length-1);Ue++){var Ve=ce.toNumeric(),je=c(Ve),ht=void 0,re=f(je,Ve);re?ht=je:ht=u(ce.toNumeric());var we=new b(ht,ae[Ue].toString());Ce.push(we),ce=i(ce,we)}for(var Ne=0,Ge=0;Ge<Ce.length;Ge++)Ne=n(Ne,Ce[Ge].value);return f(Ne,this.value)&&(ce.value=0),Ce.push(ce),Ce};var k={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},R:{name:"R",value:1e27,scientific:!0},Q:{name:"Q",value:1e30,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0},r:{name:"r",value:1e-27,scientific:!0},q:{name:"q",value:1e-30,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},ronna:{name:"ronna",value:1e27,scientific:!0},quetta:{name:"quetta",value:1e30,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0},ronto:{name:"ronto",value:1e-27,scientific:!0},quecto:{name:"quecto",value:1e-30,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},R:{name:"R",value:1e54,scientific:!0},Q:{name:"Q",value:1e60,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0},r:{name:"r",value:1e-54,scientific:!0},q:{name:"q",value:1e-60,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},R:{name:"R",value:1e81,scientific:!0},Q:{name:"Q",value:1e90,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0},r:{name:"r",value:1e-81,scientific:!0},q:{name:"q",value:1e-90,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};k.SHORTLONG=Zn({},k.SHORT,k.LONG),k.BINARY_SHORT=Zn({},k.BINARY_SHORT_SI,k.BINARY_SHORT_IEC),k.BINARY_LONG=Zn({},k.BINARY_LONG_SI,k.BINARY_LONG_IEC);var Z=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],z={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var me in z)Ft(z,me)&&(z[me].key=me);var fe={},ue={name:"",base:fe,value:1,offset:0,dimensions:Z.map(ae=>0)},le={meter:{name:"meter",base:z.LENGTH,prefixes:k.LONG,value:1,offset:0},inch:{name:"inch",base:z.LENGTH,prefixes:k.NONE,value:.0254,offset:0},foot:{name:"foot",base:z.LENGTH,prefixes:k.NONE,value:.3048,offset:0},yard:{name:"yard",base:z.LENGTH,prefixes:k.NONE,value:.9144,offset:0},mile:{name:"mile",base:z.LENGTH,prefixes:k.NONE,value:1609.344,offset:0},link:{name:"link",base:z.LENGTH,prefixes:k.NONE,value:.201168,offset:0},rod:{name:"rod",base:z.LENGTH,prefixes:k.NONE,value:5.0292,offset:0},chain:{name:"chain",base:z.LENGTH,prefixes:k.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:z.LENGTH,prefixes:k.NONE,value:1e-10,offset:0},m:{name:"m",base:z.LENGTH,prefixes:k.SHORT,value:1,offset:0},in:{name:"in",base:z.LENGTH,prefixes:k.NONE,value:.0254,offset:0},ft:{name:"ft",base:z.LENGTH,prefixes:k.NONE,value:.3048,offset:0},yd:{name:"yd",base:z.LENGTH,prefixes:k.NONE,value:.9144,offset:0},mi:{name:"mi",base:z.LENGTH,prefixes:k.NONE,value:1609.344,offset:0},li:{name:"li",base:z.LENGTH,prefixes:k.NONE,value:.201168,offset:0},rd:{name:"rd",base:z.LENGTH,prefixes:k.NONE,value:5.02921,offset:0},ch:{name:"ch",base:z.LENGTH,prefixes:k.NONE,value:20.1168,offset:0},mil:{name:"mil",base:z.LENGTH,prefixes:k.NONE,value:254e-7,offset:0},m2:{name:"m2",base:z.SURFACE,prefixes:k.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:z.SURFACE,prefixes:k.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:z.SURFACE,prefixes:k.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:z.SURFACE,prefixes:k.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:z.SURFACE,prefixes:k.NONE,value:2589988110336e-6,offset:0},sqrd:{name:"sqrd",base:z.SURFACE,prefixes:k.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:z.SURFACE,prefixes:k.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:z.SURFACE,prefixes:k.NONE,value:64516e-14,offset:0},acre:{name:"acre",base:z.SURFACE,prefixes:k.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:z.SURFACE,prefixes:k.NONE,value:1e4,offset:0},m3:{name:"m3",base:z.VOLUME,prefixes:k.CUBIC,value:1,offset:0},L:{name:"L",base:z.VOLUME,prefixes:k.SHORT,value:.001,offset:0},l:{name:"l",base:z.VOLUME,prefixes:k.SHORT,value:.001,offset:0},litre:{name:"litre",base:z.VOLUME,prefixes:k.LONG,value:.001,offset:0},cuin:{name:"cuin",base:z.VOLUME,prefixes:k.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:z.VOLUME,prefixes:k.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:z.VOLUME,prefixes:k.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:z.VOLUME,prefixes:k.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:z.VOLUME,prefixes:k.NONE,value:15e-6,offset:0},drop:{name:"drop",base:z.VOLUME,prefixes:k.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:z.VOLUME,prefixes:k.NONE,value:5e-8,offset:0},minim:{name:"minim",base:z.VOLUME,prefixes:k.NONE,value:61611519921875e-21,offset:0},fluiddram:{name:"fluiddram",base:z.VOLUME,prefixes:k.NONE,value:36966911953125e-19,offset:0},fluidounce:{name:"fluidounce",base:z.VOLUME,prefixes:k.NONE,value:295735295625e-16,offset:0},gill:{name:"gill",base:z.VOLUME,prefixes:k.NONE,value:.00011829411825,offset:0},cc:{name:"cc",base:z.VOLUME,prefixes:k.NONE,value:1e-6,offset:0},cup:{name:"cup",base:z.VOLUME,prefixes:k.NONE,value:.0002365882365,offset:0},pint:{name:"pint",base:z.VOLUME,prefixes:k.NONE,value:.000473176473,offset:0},quart:{name:"quart",base:z.VOLUME,prefixes:k.NONE,value:.000946352946,offset:0},gallon:{name:"gallon",base:z.VOLUME,prefixes:k.NONE,value:.003785411784,offset:0},beerbarrel:{name:"beerbarrel",base:z.VOLUME,prefixes:k.NONE,value:.117347765304,offset:0},oilbarrel:{name:"oilbarrel",base:z.VOLUME,prefixes:k.NONE,value:.158987294928,offset:0},hogshead:{name:"hogshead",base:z.VOLUME,prefixes:k.NONE,value:.238480942392,offset:0},g:{name:"g",base:z.MASS,prefixes:k.SHORT,value:.001,offset:0},gram:{name:"gram",base:z.MASS,prefixes:k.LONG,value:.001,offset:0},ton:{name:"ton",base:z.MASS,prefixes:k.SHORT,value:907.18474,offset:0},t:{name:"t",base:z.MASS,prefixes:k.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:z.MASS,prefixes:k.LONG,value:1e3,offset:0},grain:{name:"grain",base:z.MASS,prefixes:k.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:z.MASS,prefixes:k.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:z.MASS,prefixes:k.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:z.MASS,prefixes:k.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:z.MASS,prefixes:k.NONE,value:45.359237,offset:0},stick:{name:"stick",base:z.MASS,prefixes:k.NONE,value:.115,offset:0},stone:{name:"stone",base:z.MASS,prefixes:k.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:z.MASS,prefixes:k.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:z.MASS,prefixes:k.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:z.MASS,prefixes:k.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:z.MASS,prefixes:k.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:z.MASS,prefixes:k.NONE,value:45.359237,offset:0},s:{name:"s",base:z.TIME,prefixes:k.SHORT,value:1,offset:0},min:{name:"min",base:z.TIME,prefixes:k.NONE,value:60,offset:0},h:{name:"h",base:z.TIME,prefixes:k.NONE,value:3600,offset:0},second:{name:"second",base:z.TIME,prefixes:k.LONG,value:1,offset:0},sec:{name:"sec",base:z.TIME,prefixes:k.LONG,value:1,offset:0},minute:{name:"minute",base:z.TIME,prefixes:k.NONE,value:60,offset:0},hour:{name:"hour",base:z.TIME,prefixes:k.NONE,value:3600,offset:0},day:{name:"day",base:z.TIME,prefixes:k.NONE,value:86400,offset:0},week:{name:"week",base:z.TIME,prefixes:k.NONE,value:7*86400,offset:0},month:{name:"month",base:z.TIME,prefixes:k.NONE,value:2629800,offset:0},year:{name:"year",base:z.TIME,prefixes:k.NONE,value:31557600,offset:0},decade:{name:"decade",base:z.TIME,prefixes:k.NONE,value:315576e3,offset:0},century:{name:"century",base:z.TIME,prefixes:k.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:z.TIME,prefixes:k.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:z.FREQUENCY,prefixes:k.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:z.FREQUENCY,prefixes:k.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:z.ANGLE,prefixes:k.SHORT,value:1,offset:0},radian:{name:"radian",base:z.ANGLE,prefixes:k.LONG,value:1,offset:0},deg:{name:"deg",base:z.ANGLE,prefixes:k.SHORT,value:null,offset:0},degree:{name:"degree",base:z.ANGLE,prefixes:k.LONG,value:null,offset:0},grad:{name:"grad",base:z.ANGLE,prefixes:k.SHORT,value:null,offset:0},gradian:{name:"gradian",base:z.ANGLE,prefixes:k.LONG,value:null,offset:0},cycle:{name:"cycle",base:z.ANGLE,prefixes:k.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:z.ANGLE,prefixes:k.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:z.ANGLE,prefixes:k.NONE,value:null,offset:0},A:{name:"A",base:z.CURRENT,prefixes:k.SHORT,value:1,offset:0},ampere:{name:"ampere",base:z.CURRENT,prefixes:k.LONG,value:1,offset:0},K:{name:"K",base:z.TEMPERATURE,prefixes:k.SHORT,value:1,offset:0},degC:{name:"degC",base:z.TEMPERATURE,prefixes:k.SHORT,value:1,offset:273.15},degF:{name:"degF",base:z.TEMPERATURE,prefixes:k.SHORT,value:new x(5,9),offset:459.67},degR:{name:"degR",base:z.TEMPERATURE,prefixes:k.SHORT,value:new x(5,9),offset:0},kelvin:{name:"kelvin",base:z.TEMPERATURE,prefixes:k.LONG,value:1,offset:0},celsius:{name:"celsius",base:z.TEMPERATURE,prefixes:k.LONG,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:z.TEMPERATURE,prefixes:k.LONG,value:new x(5,9),offset:459.67},rankine:{name:"rankine",base:z.TEMPERATURE,prefixes:k.LONG,value:new x(5,9),offset:0},mol:{name:"mol",base:z.AMOUNT_OF_SUBSTANCE,prefixes:k.SHORT,value:1,offset:0},mole:{name:"mole",base:z.AMOUNT_OF_SUBSTANCE,prefixes:k.LONG,value:1,offset:0},cd:{name:"cd",base:z.LUMINOUS_INTENSITY,prefixes:k.SHORT,value:1,offset:0},candela:{name:"candela",base:z.LUMINOUS_INTENSITY,prefixes:k.LONG,value:1,offset:0},N:{name:"N",base:z.FORCE,prefixes:k.SHORT,value:1,offset:0},newton:{name:"newton",base:z.FORCE,prefixes:k.LONG,value:1,offset:0},dyn:{name:"dyn",base:z.FORCE,prefixes:k.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:z.FORCE,prefixes:k.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:z.FORCE,prefixes:k.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:z.FORCE,prefixes:k.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:z.FORCE,prefixes:k.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:z.FORCE,prefixes:k.NONE,value:9.80665,offset:0},J:{name:"J",base:z.ENERGY,prefixes:k.SHORT,value:1,offset:0},joule:{name:"joule",base:z.ENERGY,prefixes:k.LONG,value:1,offset:0},erg:{name:"erg",base:z.ENERGY,prefixes:k.SHORTLONG,value:1e-7,offset:0},Wh:{name:"Wh",base:z.ENERGY,prefixes:k.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:z.ENERGY,prefixes:k.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:z.ENERGY,prefixes:k.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:z.ENERGY,prefixes:k.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:z.POWER,prefixes:k.SHORT,value:1,offset:0},watt:{name:"watt",base:z.POWER,prefixes:k.LONG,value:1,offset:0},hp:{name:"hp",base:z.POWER,prefixes:k.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:z.POWER,prefixes:k.SHORT,value:v.I,offset:0},VA:{name:"VA",base:z.POWER,prefixes:k.SHORT,value:1,offset:0},Pa:{name:"Pa",base:z.PRESSURE,prefixes:k.SHORT,value:1,offset:0},psi:{name:"psi",base:z.PRESSURE,prefixes:k.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:z.PRESSURE,prefixes:k.NONE,value:101325,offset:0},bar:{name:"bar",base:z.PRESSURE,prefixes:k.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:z.PRESSURE,prefixes:k.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:z.PRESSURE,prefixes:k.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:z.PRESSURE,prefixes:k.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:z.PRESSURE,prefixes:k.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:z.ELECTRIC_CHARGE,prefixes:k.LONG,value:1,offset:0},C:{name:"C",base:z.ELECTRIC_CHARGE,prefixes:k.SHORT,value:1,offset:0},farad:{name:"farad",base:z.ELECTRIC_CAPACITANCE,prefixes:k.LONG,value:1,offset:0},F:{name:"F",base:z.ELECTRIC_CAPACITANCE,prefixes:k.SHORT,value:1,offset:0},volt:{name:"volt",base:z.ELECTRIC_POTENTIAL,prefixes:k.LONG,value:1,offset:0},V:{name:"V",base:z.ELECTRIC_POTENTIAL,prefixes:k.SHORT,value:1,offset:0},ohm:{name:"ohm",base:z.ELECTRIC_RESISTANCE,prefixes:k.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:z.ELECTRIC_INDUCTANCE,prefixes:k.LONG,value:1,offset:0},H:{name:"H",base:z.ELECTRIC_INDUCTANCE,prefixes:k.SHORT,value:1,offset:0},siemens:{name:"siemens",base:z.ELECTRIC_CONDUCTANCE,prefixes:k.LONG,value:1,offset:0},S:{name:"S",base:z.ELECTRIC_CONDUCTANCE,prefixes:k.SHORT,value:1,offset:0},weber:{name:"weber",base:z.MAGNETIC_FLUX,prefixes:k.LONG,value:1,offset:0},Wb:{name:"Wb",base:z.MAGNETIC_FLUX,prefixes:k.SHORT,value:1,offset:0},tesla:{name:"tesla",base:z.MAGNETIC_FLUX_DENSITY,prefixes:k.LONG,value:1,offset:0},T:{name:"T",base:z.MAGNETIC_FLUX_DENSITY,prefixes:k.SHORT,value:1,offset:0},b:{name:"b",base:z.BIT,prefixes:k.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:z.BIT,prefixes:k.BINARY_LONG,value:1,offset:0},B:{name:"B",base:z.BIT,prefixes:k.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:z.BIT,prefixes:k.BINARY_LONG,value:8,offset:0}},ke={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fldr:"fluiddram",fluiddrams:"fluiddram",floz:"fluidounce",fluidounces:"fluidounce",gi:"gill",gills:"gill",cp:"cup",cups:"cup",pt:"pint",pints:"pint",qt:"quart",quarts:"quart",gal:"gallon",gallons:"gallon",bbl:"beerbarrel",beerbarrels:"beerbarrel",obl:"oilbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",amps:"ampere",amp:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function Me(ae){if(ae.number==="BigNumber"){var ce=nx(y);le.rad.value=new y(1),le.deg.value=ce.div(180),le.grad.value=ce.div(200),le.cycle.value=ce.times(2),le.arcsec.value=ce.div(648e3),le.arcmin.value=ce.div(10800)}else le.rad.value=1,le.deg.value=Math.PI/180,le.grad.value=Math.PI/200,le.cycle.value=Math.PI*2,le.arcsec.value=Math.PI/648e3,le.arcmin.value=Math.PI/10800;le.radian.value=le.rad.value,le.degree.value=le.deg.value,le.gradian.value=le.grad.value}Me(r),e&&e("config",function(ae,ce){ae.number!==ce.number&&Me(ae)});var Se={si:{NONE:{unit:ue,prefix:k.NONE[""]},LENGTH:{unit:le.m,prefix:k.SHORT[""]},MASS:{unit:le.g,prefix:k.SHORT.k},TIME:{unit:le.s,prefix:k.SHORT[""]},CURRENT:{unit:le.A,prefix:k.SHORT[""]},TEMPERATURE:{unit:le.K,prefix:k.SHORT[""]},LUMINOUS_INTENSITY:{unit:le.cd,prefix:k.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:le.mol,prefix:k.SHORT[""]},ANGLE:{unit:le.rad,prefix:k.SHORT[""]},BIT:{unit:le.bits,prefix:k.SHORT[""]},FORCE:{unit:le.N,prefix:k.SHORT[""]},ENERGY:{unit:le.J,prefix:k.SHORT[""]},POWER:{unit:le.W,prefix:k.SHORT[""]},PRESSURE:{unit:le.Pa,prefix:k.SHORT[""]},ELECTRIC_CHARGE:{unit:le.C,prefix:k.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:le.F,prefix:k.SHORT[""]},ELECTRIC_POTENTIAL:{unit:le.V,prefix:k.SHORT[""]},ELECTRIC_RESISTANCE:{unit:le.ohm,prefix:k.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:le.H,prefix:k.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:le.S,prefix:k.SHORT[""]},MAGNETIC_FLUX:{unit:le.Wb,prefix:k.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:le.T,prefix:k.SHORT[""]},FREQUENCY:{unit:le.Hz,prefix:k.SHORT[""]}}};Se.cgs=JSON.parse(JSON.stringify(Se.si)),Se.cgs.LENGTH={unit:le.m,prefix:k.SHORT.c},Se.cgs.MASS={unit:le.g,prefix:k.SHORT[""]},Se.cgs.FORCE={unit:le.dyn,prefix:k.SHORT[""]},Se.cgs.ENERGY={unit:le.erg,prefix:k.NONE[""]},Se.us=JSON.parse(JSON.stringify(Se.si)),Se.us.LENGTH={unit:le.ft,prefix:k.NONE[""]},Se.us.MASS={unit:le.lbm,prefix:k.NONE[""]},Se.us.TEMPERATURE={unit:le.degF,prefix:k.NONE[""]},Se.us.FORCE={unit:le.lbf,prefix:k.NONE[""]},Se.us.ENERGY={unit:le.BTU,prefix:k.BTU[""]},Se.us.POWER={unit:le.hp,prefix:k.NONE[""]},Se.us.PRESSURE={unit:le.psi,prefix:k.NONE[""]},Se.auto=JSON.parse(JSON.stringify(Se.si));var oe=Se.auto;b.setUnitSystem=function(ae){if(Ft(Se,ae))oe=Se[ae];else throw new Error("Unit system "+ae+" does not exist. Choices are: "+Object.keys(Se).join(", "))},b.getUnitSystem=function(){for(var ae in Se)if(Ft(Se,ae)&&Se[ae]===oe)return ae},b.typeConverters={BigNumber:function(ce){return ce!=null&&ce.isFraction?new y(String(ce.n)).div(String(ce.d)).times(String(ce.s)):new y(ce+"")},Fraction:function(ce){return new x(ce)},Complex:function(ce){return ce},number:function(ce){return ce!=null&&ce.isFraction?m(ce):ce}},b.prototype._numberConverter=function(){var ae=b.typeConverters[this.valueType()];if(ae)return ae;throw new TypeError('Unsupported Unit value type "'+this.valueType()+'"')},b._getNumberConverter=function(ae){if(!b.typeConverters[ae])throw new TypeError('Unsupported type "'+ae+'"');return b.typeConverters[ae]};for(var K in le)if(Ft(le,K)){var de=le[K];de.dimensions=de.base.dimensions}for(var _e in ke)if(Ft(ke,_e)){var be=le[ke[_e]],$e={};for(var Oe in be)Ft(be,Oe)&&($e[Oe]=be[Oe]);$e.name=_e,le[_e]=$e}b.isValidAlpha=function(ce){return/^[a-zA-Z]$/.test(ce)};function Qe(ae){for(var ce=0;ce<ae.length;ce++){if(_=ae.charAt(ce),ce===0&&!b.isValidAlpha(_))throw new Error('Invalid unit name (must begin with alpha character): "'+ae+'"');if(ce>0&&!(b.isValidAlpha(_)||N(_)))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+ae+'"')}}return b.createUnit=function(ae,ce){if(typeof ae!="object")throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(ce&&ce.override){for(var Ce in ae)if(Ft(ae,Ce)&&b.deleteUnit(Ce),ae[Ce].aliases)for(var Ue=0;Ue<ae[Ce].aliases.length;Ue++)b.deleteUnit(ae[Ce].aliases[Ue])}var Ve;for(var je in ae)Ft(ae,je)&&(Ve=b.createUnitSingle(je,ae[je]));return Ve},b.createUnitSingle=function(ae,ce){if((typeof ce>"u"||ce===null)&&(ce={}),typeof ae!="string")throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(Ft(le,ae))throw new Error('Cannot create unit "'+ae+'": a unit with that name already exists');Qe(ae);var Ce=null,Ue=[],Ve=0,je,ht,re;if(ce&&ce.type==="Unit")Ce=ce.clone();else if(typeof ce=="string")ce!==""&&(je=ce);else if(typeof ce=="object")je=ce.definition,ht=ce.prefixes,Ve=ce.offset,re=ce.baseName,ce.aliases&&(Ue=ce.aliases.valueOf());else throw new TypeError('Cannot create unit "'+ae+'" from "'+ce.toString()+'": expecting "string" or "Unit" or "Object"');if(Ue){for(var we=0;we<Ue.length;we++)if(Ft(le,Ue[we]))throw new Error('Cannot create alias "'+Ue[we]+'": a unit with that name already exists')}if(je&&typeof je=="string"&&!Ce)try{Ce=b.parse(je,{allowNoUnits:!0})}catch(Le){throw Le.message='Could not create unit "'+ae+'" from "'+je+'": '+Le.message,Le}else je&&je.type==="Unit"&&(Ce=je.clone());Ue=Ue||[],Ve=Ve||0,ht&&ht.toUpperCase?ht=k[ht.toUpperCase()]||k.NONE:ht=k.NONE;var Ne={};if(Ce){Ne={name:ae,value:Ce.value,dimensions:Ce.dimensions.slice(0),prefixes:ht,offset:Ve};var ft=!1;for(var st in z)if(Ft(z,st)){for(var dt=!0,at=0;at<Z.length;at++)if(Math.abs((Ne.dimensions[at]||0)-(z[st].dimensions[at]||0))>1e-12){dt=!1;break}if(dt){ft=!0,Ne.base=z[st];break}}if(!ft){re=re||ae+"_STUFF";var tr={dimensions:Ce.dimensions.slice(0)};tr.key=re,z[re]=tr,oe[re]={unit:Ne,prefix:k.NONE[""]},Ne.base=z[re]}}else{if(re=re||ae+"_STUFF",Z.indexOf(re)>=0)throw new Error('Cannot create new base unit "'+ae+'": a base unit with that name already exists (and cannot be overridden)');Z.push(re);for(var Ge in z)Ft(z,Ge)&&(z[Ge].dimensions[Z.length-1]=0);for(var He={dimensions:[]},We=0;We<Z.length;We++)He.dimensions[We]=0;He.dimensions[Z.length-1]=1,He.key=re,z[re]=He,Ne={name:ae,value:1,dimensions:z[re].dimensions.slice(0),prefixes:ht,offset:Ve,base:z[re]},oe[re]={unit:Ne,prefix:k.NONE[""]}}b.UNITS[ae]=Ne;for(var Ot=0;Ot<Ue.length;Ot++){var fr=Ue[Ot],R={};for(var ge in Ne)Ft(Ne,ge)&&(R[ge]=Ne[ge]);R.name=fr,b.UNITS[fr]=R}return delete V.cache,new b(null,ae)},b.deleteUnit=function(ae){delete b.UNITS[ae],delete V.cache},b.PREFIXES=k,b.BASE_DIMENSIONS=Z,b.BASE_UNITS=z,b.UNIT_SYSTEMS=Se,b.UNITS=le,b},{isClass:!0}),ZD="unit",LJ=["typed","Unit"],UJ=ee(ZD,LJ,t=>{var{typed:e,Unit:r}=t;return e(ZD,{Unit:function(i){return i.clone()},string:function(i){return r.isValuelessUnit(i)?new r(null,i):r.parse(i,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string | Unit":function(i,a){return new r(i,a)},"number | BigNumber | Fraction":function(i){return new r(i)},"Array | Matrix":e.referToSelf(n=>i=>ur(i,n))})}),QD="sparse",zJ=["typed","SparseMatrix"],GJ=ee(QD,zJ,t=>{var{typed:e,SparseMatrix:r}=t;return e(QD,{"":function(){return new r([])},string:function(i){return new r([],i)},"Array | Matrix":function(i){return new r(i)},"Array | Matrix, string":function(i,a){return new r(i,a)}})}),JD="createUnit",qJ=["typed","Unit"],HJ=ee(JD,qJ,t=>{var{typed:e,Unit:r}=t;return e(JD,{"Object, Object":function(i,a){return r.createUnit(i,a)},Object:function(i){return r.createUnit(i,{})},"string, Unit | string | Object, Object":function(i,a,s){var o={};return o[i]=a,r.createUnit(o,s)},"string, Unit | string | Object":function(i,a){var s={};return s[i]=a,r.createUnit(s,{})},string:function(i){var a={};return a[i]={},r.createUnit(a,{})}})}),eC="acos",WJ=["typed","config","Complex"],VJ=ee(eC,WJ,t=>{var{typed:e,config:r,Complex:n}=t;return e(eC,{number:function(a){return a>=-1&&a<=1||r.predictable?Math.acos(a):new n(a,0).acos()},Complex:function(a){return a.acos()},BigNumber:function(a){return a.acos()}})}),tC="acosh",XJ=["typed","config","Complex"],jJ=ee(tC,XJ,t=>{var{typed:e,config:r,Complex:n}=t;return e(tC,{number:function(a){return a>=1||r.predictable?XI(a):a<=-1?new n(Math.log(Math.sqrt(a*a-1)-a),Math.PI):new n(a,0).acosh()},Complex:function(a){return a.acosh()},BigNumber:function(a){return a.acosh()}})}),rC="acot",YJ=["typed","BigNumber"],KJ=ee(rC,YJ,t=>{var{typed:e,BigNumber:r}=t;return e(rC,{number:jI,Complex:function(i){return i.acot()},BigNumber:function(i){return new r(1).div(i).atan()}})}),nC="acoth",ZJ=["typed","config","Complex","BigNumber"],QJ=ee(nC,ZJ,t=>{var{typed:e,config:r,Complex:n,BigNumber:i}=t;return e(nC,{number:function(s){return s>=1||s<=-1||r.predictable?YI(s):new n(s,0).acoth()},Complex:function(s){return s.acoth()},BigNumber:function(s){return new i(1).div(s).atanh()}})}),iC="acsc",JJ=["typed","config","Complex","BigNumber"],eee=ee(iC,JJ,t=>{var{typed:e,config:r,Complex:n,BigNumber:i}=t;return e(iC,{number:function(s){return s<=-1||s>=1||r.predictable?KI(s):new n(s,0).acsc()},Complex:function(s){return s.acsc()},BigNumber:function(s){return new i(1).div(s).asin()}})}),aC="acsch",tee=["typed","BigNumber"],ree=ee(aC,tee,t=>{var{typed:e,BigNumber:r}=t;return e(aC,{number:ZI,Complex:function(i){return i.acsch()},BigNumber:function(i){return new r(1).div(i).asinh()}})}),sC="asec",nee=["typed","config","Complex","BigNumber"],iee=ee(sC,nee,t=>{var{typed:e,config:r,Complex:n,BigNumber:i}=t;return e(sC,{number:function(s){return s<=-1||s>=1||r.predictable?QI(s):new n(s,0).asec()},Complex:function(s){return s.asec()},BigNumber:function(s){return new i(1).div(s).acos()}})}),oC="asech",aee=["typed","config","Complex","BigNumber"],see=ee(oC,aee,t=>{var{typed:e,config:r,Complex:n,BigNumber:i}=t;return e(oC,{number:function(s){if(s<=1&&s>=-1||r.predictable){var o=1/s;if(o>0||r.predictable)return JI(s);var l=Math.sqrt(o*o-1);return new n(Math.log(l-o),Math.PI)}return new n(s,0).asech()},Complex:function(s){return s.asech()},BigNumber:function(s){return new i(1).div(s).acosh()}})}),uC="asin",oee=["typed","config","Complex"],uee=ee(uC,oee,t=>{var{typed:e,config:r,Complex:n}=t;return e(uC,{number:function(a){return a>=-1&&a<=1||r.predictable?Math.asin(a):new n(a,0).asin()},Complex:function(a){return a.asin()},BigNumber:function(a){return a.asin()}})}),lee="asinh",cee=["typed"],fee=ee(lee,cee,t=>{var{typed:e}=t;return e("asinh",{number:eF,Complex:function(n){return n.asinh()},BigNumber:function(n){return n.asinh()}})}),hee="atan",dee=["typed"],pee=ee(hee,dee,t=>{var{typed:e}=t;return e("atan",{number:function(n){return Math.atan(n)},Complex:function(n){return n.atan()},BigNumber:function(n){return n.atan()}})}),lC="atan2",mee=["typed","matrix","equalScalar","BigNumber","DenseMatrix","concat"],vee=ee(lC,mee,t=>{var{typed:e,matrix:r,equalScalar:n,BigNumber:i,DenseMatrix:a,concat:s}=t,o=Hs({typed:e,equalScalar:n}),l=Zi({typed:e}),u=pF({typed:e,equalScalar:n}),c=Ei({typed:e,equalScalar:n}),f=Jn({typed:e,DenseMatrix:a}),h=on({typed:e,matrix:r,concat:s});return e(lC,{"number, number":Math.atan2,"BigNumber, BigNumber":(p,m)=>i.atan2(p,m)},h({scalar:"number | BigNumber",SS:u,DS:l,SD:o,Ss:c,sS:f}))}),cC="atanh",gee=["typed","config","Complex"],yee=ee(cC,gee,t=>{var{typed:e,config:r,Complex:n}=t;return e(cC,{number:function(a){return a<=1&&a>=-1||r.predictable?tF(a):new n(a,0).atanh()},Complex:function(a){return a.atanh()},BigNumber:function(a){return a.atanh()}})}),Dh=ee("trigUnit",["typed"],t=>{var{typed:e}=t;return{Unit:e.referToSelf(r=>n=>{if(!n.hasBase(n.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return e.find(r,n.valueType())(n.value)})}}),fC="cos",bee=["typed"],xee=ee(fC,bee,t=>{var{typed:e}=t,r=Dh({typed:e});return e(fC,{number:Math.cos,"Complex | BigNumber":n=>n.cos()},r)}),hC="cosh",wee=["typed"],_ee=ee(hC,wee,t=>{var{typed:e}=t;return e(hC,{number:bW,"Complex | BigNumber":r=>r.cosh()})}),dC="cot",Aee=["typed","BigNumber"],Eee=ee(dC,Aee,t=>{var{typed:e,BigNumber:r}=t,n=Dh({typed:e});return e(dC,{number:rF,Complex:i=>i.cot(),BigNumber:i=>new r(1).div(i.tan())},n)}),pC="coth",See=["typed","BigNumber"],Dee=ee(pC,See,t=>{var{typed:e,BigNumber:r}=t;return e(pC,{number:nF,Complex:n=>n.coth(),BigNumber:n=>new r(1).div(n.tanh())})}),mC="csc",Cee=["typed","BigNumber"],Tee=ee(mC,Cee,t=>{var{typed:e,BigNumber:r}=t,n=Dh({typed:e});return e(mC,{number:iF,Complex:i=>i.csc(),BigNumber:i=>new r(1).div(i.sin())},n)}),vC="csch",Nee=["typed","BigNumber"],Mee=ee(vC,Nee,t=>{var{typed:e,BigNumber:r}=t;return e(vC,{number:aF,Complex:n=>n.csch(),BigNumber:n=>new r(1).div(n.sinh())})}),gC="sec",Iee=["typed","BigNumber"],Fee=ee(gC,Iee,t=>{var{typed:e,BigNumber:r}=t,n=Dh({typed:e});return e(gC,{number:sF,Complex:i=>i.sec(),BigNumber:i=>new r(1).div(i.cos())},n)}),yC="sech",Oee=["typed","BigNumber"],Bee=ee(yC,Oee,t=>{var{typed:e,BigNumber:r}=t;return e(yC,{number:oF,Complex:n=>n.sech(),BigNumber:n=>new r(1).div(n.cosh())})}),bC="sin",Ree=["typed"],Pee=ee(bC,Ree,t=>{var{typed:e}=t,r=Dh({typed:e});return e(bC,{number:Math.sin,"Complex | BigNumber":n=>n.sin()},r)}),xC="sinh",$ee=["typed"],kee=ee(xC,$ee,t=>{var{typed:e}=t;return e(xC,{number:uF,"Complex | BigNumber":r=>r.sinh()})}),wC="tan",Lee=["typed"],Uee=ee(wC,Lee,t=>{var{typed:e}=t,r=Dh({typed:e});return e(wC,{number:Math.tan,"Complex | BigNumber":n=>n.tan()},r)}),zee="tanh",Gee=["typed"],qee=ee(zee,Gee,t=>{var{typed:e}=t;return e("tanh",{number:wW,"Complex | BigNumber":r=>r.tanh()})}),_C="setCartesian",Hee=["typed","size","subset","compareNatural","Index","DenseMatrix"],Wee=ee(_C,Hee,t=>{var{typed:e,size:r,subset:n,compareNatural:i,Index:a,DenseMatrix:s}=t;return e(_C,{"Array | Matrix, Array | Matrix":function(l,u){var c=[];if(n(r(l),new a(0))!==0&&n(r(u),new a(0))!==0){var f=Lr(Array.isArray(l)?l:l.toArray()).sort(i),h=Lr(Array.isArray(u)?u:u.toArray()).sort(i);c=[];for(var p=0;p<f.length;p++)for(var m=0;m<h.length;m++)c.push([f[p],h[m]])}return Array.isArray(l)&&Array.isArray(u)?c:new s(c)}})}),AC="setDifference",Vee=["typed","size","subset","compareNatural","Index","DenseMatrix"],Xee=ee(AC,Vee,t=>{var{typed:e,size:r,subset:n,compareNatural:i,Index:a,DenseMatrix:s}=t;return e(AC,{"Array | Matrix, Array | Matrix":function(l,u){var c;if(n(r(l),new a(0))===0)c=[];else{if(n(r(u),new a(0))===0)return Lr(l.toArray());var f=ah(Lr(Array.isArray(l)?l:l.toArray()).sort(i)),h=ah(Lr(Array.isArray(u)?u:u.toArray()).sort(i));c=[];for(var p,m=0;m<f.length;m++){p=!1;for(var v=0;v<h.length;v++)if(i(f[m].value,h[v].value)===0&&f[m].identifier===h[v].identifier){p=!0;break}p||c.push(f[m])}}return Array.isArray(l)&&Array.isArray(u)?yv(c):new s(yv(c))}})}),EC="setDistinct",jee=["typed","size","subset","compareNatural","Index","DenseMatrix"],Yee=ee(EC,jee,t=>{var{typed:e,size:r,subset:n,compareNatural:i,Index:a,DenseMatrix:s}=t;return e(EC,{"Array | Matrix":function(l){var u;if(n(r(l),new a(0))===0)u=[];else{var c=Lr(Array.isArray(l)?l:l.toArray()).sort(i);u=[],u.push(c[0]);for(var f=1;f<c.length;f++)i(c[f],c[f-1])!==0&&u.push(c[f])}return Array.isArray(l)?u:new s(u)}})}),SC="setIntersect",Kee=["typed","size","subset","compareNatural","Index","DenseMatrix"],Zee=ee(SC,Kee,t=>{var{typed:e,size:r,subset:n,compareNatural:i,Index:a,DenseMatrix:s}=t;return e(SC,{"Array | Matrix, Array | Matrix":function(l,u){var c;if(n(r(l),new a(0))===0||n(r(u),new a(0))===0)c=[];else{var f=ah(Lr(Array.isArray(l)?l:l.toArray()).sort(i)),h=ah(Lr(Array.isArray(u)?u:u.toArray()).sort(i));c=[];for(var p=0;p<f.length;p++)for(var m=0;m<h.length;m++)if(i(f[p].value,h[m].value)===0&&f[p].identifier===h[m].identifier){c.push(f[p]);break}}return Array.isArray(l)&&Array.isArray(u)?yv(c):new s(yv(c))}})}),DC="setIsSubset",Qee=["typed","size","subset","compareNatural","Index"],Jee=ee(DC,Qee,t=>{var{typed:e,size:r,subset:n,compareNatural:i,Index:a}=t;return e(DC,{"Array | Matrix, Array | Matrix":function(o,l){if(n(r(o),new a(0))===0)return!0;if(n(r(l),new a(0))===0)return!1;for(var u=ah(Lr(Array.isArray(o)?o:o.toArray()).sort(i)),c=ah(Lr(Array.isArray(l)?l:l.toArray()).sort(i)),f,h=0;h<u.length;h++){f=!1;for(var p=0;p<c.length;p++)if(i(u[h].value,c[p].value)===0&&u[h].identifier===c[p].identifier){f=!0;break}if(f===!1)return!1}return!0}})}),CC="setMultiplicity",ete=["typed","size","subset","compareNatural","Index"],tte=ee(CC,ete,t=>{var{typed:e,size:r,subset:n,compareNatural:i,Index:a}=t;return e(CC,{"number | BigNumber | Fraction | Complex, Array | Matrix":function(o,l){if(n(r(l),new a(0))===0)return 0;for(var u=Lr(Array.isArray(l)?l:l.toArray()),c=0,f=0;f<u.length;f++)i(u[f],o)===0&&c++;return c}})}),TC="setPowerset",rte=["typed","size","subset","compareNatural","Index"],nte=ee(TC,rte,t=>{var{typed:e,size:r,subset:n,compareNatural:i,Index:a}=t;return e(TC,{"Array | Matrix":function(u){if(n(r(u),new a(0))===0)return[];for(var c=Lr(Array.isArray(u)?u:u.toArray()).sort(i),f=[],h=0;h.toString(2).length<=c.length;)f.push(s(c,h.toString(2).split("").reverse())),h++;return o(f)}});function s(l,u){for(var c=[],f=0;f<u.length;f++)u[f]==="1"&&c.push(l[f]);return c}function o(l){for(var u=[],c=l.length-1;c>0;c--)for(var f=0;f<c;f++)l[f].length>l[f+1].length&&(u=l[f],l[f]=l[f+1],l[f+1]=u);return l}}),NC="setSize",ite=["typed","compareNatural"],ate=ee(NC,ite,t=>{var{typed:e,compareNatural:r}=t;return e(NC,{"Array | Matrix":function(i){return Array.isArray(i)?Lr(i).length:Lr(i.toArray()).length},"Array | Matrix, boolean":function(i,a){if(a===!1||i.length===0)return Array.isArray(i)?Lr(i).length:Lr(i.toArray()).length;for(var s=Lr(Array.isArray(i)?i:i.toArray()).sort(r),o=1,l=1;l<s.length;l++)r(s[l],s[l-1])!==0&&o++;return o}})}),MC="setSymDifference",ste=["typed","size","concat","subset","setDifference","Index"],ote=ee(MC,ste,t=>{var{typed:e,size:r,concat:n,subset:i,setDifference:a,Index:s}=t;return e(MC,{"Array | Matrix, Array | Matrix":function(l,u){if(i(r(l),new s(0))===0)return Lr(u);if(i(r(u),new s(0))===0)return Lr(l);var c=Lr(l),f=Lr(u);return n(a(c,f),a(f,c))}})}),IC="setUnion",ute=["typed","size","concat","subset","setIntersect","setSymDifference","Index"],lte=ee(IC,ute,t=>{var{typed:e,size:r,concat:n,subset:i,setIntersect:a,setSymDifference:s,Index:o}=t;return e(IC,{"Array | Matrix, Array | Matrix":function(u,c){if(i(r(u),new o(0))===0)return Lr(c);if(i(r(c),new o(0))===0)return Lr(u);var f=Lr(u),h=Lr(c);return n(s(f,h),a(f,h))}})}),FC="add",cte=["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],fte=ee(FC,cte,t=>{var{typed:e,matrix:r,addScalar:n,equalScalar:i,DenseMatrix:a,SparseMatrix:s,concat:o}=t,l=wl({typed:e}),u=Zb({typed:e,equalScalar:i}),c=Dc({typed:e,DenseMatrix:a}),f=on({typed:e,matrix:r,concat:o});return e(FC,{"any, any":n,"any, any, ...any":e.referToSelf(h=>(p,m,v)=>{for(var y=h(p,m),x=0;x<v.length;x++)y=h(y,v[x]);return y})},f({elop:n,DS:l,SS:u,Ss:c}))}),OC="hypot",hte=["typed","abs","addScalar","divideScalar","multiplyScalar","sqrt","smaller","isPositive"],dte=ee(OC,hte,t=>{var{typed:e,abs:r,addScalar:n,divideScalar:i,multiplyScalar:a,sqrt:s,smaller:o,isPositive:l}=t;return e(OC,{"... number | BigNumber":u,Array:u,Matrix:c=>u(Lr(c.toArray(),!0))});function u(c){for(var f=0,h=0,p=0;p<c.length;p++){if(pu(c[p]))throw new TypeError("Unexpected type of argument to hypot");var m=r(c[p]);o(h,m)?(f=a(f,a(i(h,m),i(h,m))),f=n(f,1),h=m):f=n(f,l(m)?a(i(m,h),i(m,h)):m)}return a(h,s(f))}}),BC="norm",pte=["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],mte=ee(BC,pte,t=>{var{typed:e,abs:r,add:n,pow:i,conj:a,sqrt:s,multiply:o,equalScalar:l,larger:u,smaller:c,matrix:f,ctranspose:h,eigs:p}=t;return e(BC,{number:Math.abs,Complex:function(M){return M.abs()},BigNumber:function(M){return M.abs()},boolean:function(M){return Math.abs(M)},Array:function(M){return _(f(M),2)},Matrix:function(M){return _(M,2)},"Array, number | BigNumber | string":function(M,N){return _(f(M),N)},"Matrix, number | BigNumber | string":function(M,N){return _(M,N)}});function m(T){var M=0;return T.forEach(function(N){var I=r(N);u(I,M)&&(M=I)},!0),M}function v(T){var M;return T.forEach(function(N){var I=r(N);(!M||c(I,M))&&(M=I)},!0),M||0}function y(T,M){if(M===Number.POSITIVE_INFINITY||M==="inf")return m(T);if(M===Number.NEGATIVE_INFINITY||M==="-inf")return v(T);if(M==="fro")return _(T,2);if(typeof M=="number"&&!isNaN(M)){if(!l(M,0)){var N=0;return T.forEach(function(I){N=n(i(r(I),M),N)},!0),i(N,1/M)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}function x(T){var M=0;return T.forEach(function(N,I){M=n(M,o(N,a(N)))}),r(s(M))}function S(T){var M=[],N=0;return T.forEach(function(I,F){var P=F[1],U=n(M[P]||0,r(I));u(U,N)&&(N=U),M[P]=U},!0),N}function b(T){var M=T.size();if(M[0]!==M[1])throw new RangeError("Invalid matrix dimensions");var N=h(T),I=o(N,T),F=p(I).values.toArray(),P=F[F.length-1];return r(s(P))}function A(T){var M=[],N=0;return T.forEach(function(I,F){var P=F[0],U=n(M[P]||0,r(I));u(U,N)&&(N=U),M[P]=U},!0),N}function E(T,M){if(M===1)return S(T);if(M===Number.POSITIVE_INFINITY||M==="inf")return A(T);if(M==="fro")return x(T);if(M===2)return b(T);throw new Error("Unsupported parameter value "+M)}function _(T,M){var N=T.size();if(N.length===1)return y(T,M);if(N.length===2){if(N[0]&&N[1])return E(T,M);throw new RangeError("Invalid matrix dimensions")}}}),RC="dot",vte=["typed","addScalar","multiplyScalar","conj","size"],gte=ee(RC,vte,t=>{var{typed:e,addScalar:r,multiplyScalar:n,conj:i,size:a}=t;return e(RC,{"Array | DenseMatrix, Array | DenseMatrix":o,"SparseMatrix, SparseMatrix":l});function s(c,f){var h=u(c),p=u(f),m,v;if(h.length===1)m=h[0];else if(h.length===2&&h[1]===1)m=h[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+h.join(", ")+")");if(p.length===1)v=p[0];else if(p.length===2&&p[1]===1)v=p[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+p.join(", ")+")");if(m!==v)throw new RangeError("Vectors must have equal length ("+m+" != "+v+")");if(m===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return m}function o(c,f){var h=s(c,f),p=Gt(c)?c._data:c,m=Gt(c)?c._datatype||c.getDataType():void 0,v=Gt(f)?f._data:f,y=Gt(f)?f._datatype||f.getDataType():void 0,x=u(c).length===2,S=u(f).length===2,b=r,A=n;if(m&&y&&m===y&&typeof m=="string"&&m!=="mixed"){var E=m;b=e.find(r,[E,E]),A=e.find(n,[E,E])}if(!x&&!S){for(var _=A(i(p[0]),v[0]),T=1;T<h;T++)_=b(_,A(i(p[T]),v[T]));return _}if(!x&&S){for(var M=A(i(p[0]),v[0][0]),N=1;N<h;N++)M=b(M,A(i(p[N]),v[N][0]));return M}if(x&&!S){for(var I=A(i(p[0][0]),v[0]),F=1;F<h;F++)I=b(I,A(i(p[F][0]),v[F]));return I}if(x&&S){for(var P=A(i(p[0][0]),v[0][0]),U=1;U<h;U++)P=b(P,A(i(p[U][0]),v[U][0]));return P}}function l(c,f){s(c,f);for(var h=c._index,p=c._values,m=f._index,v=f._values,y=0,x=r,S=n,b=0,A=0;b<h.length&&A<m.length;){var E=h[b],_=m[A];if(E<_){b++;continue}if(E>_){A++;continue}E===_&&(y=x(y,S(p[b],v[A])),b++,A++)}return y}function u(c){return Gt(c)?c.size():a(c)}}),yte="trace",bte=["typed","matrix","add"],xte=ee(yte,bte,t=>{var{typed:e,matrix:r,add:n}=t;return e("trace",{Array:function(o){return i(r(o))},SparseMatrix:a,DenseMatrix:i,any:rr});function i(s){var o=s._size,l=s._data;switch(o.length){case 1:if(o[0]===1)return rr(l[0]);throw new RangeError("Matrix must be square (size: "+yr(o)+")");case 2:{var u=o[0],c=o[1];if(u===c){for(var f=0,h=0;h<u;h++)f=n(f,l[h][h]);return f}else throw new RangeError("Matrix must be square (size: "+yr(o)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+yr(o)+")")}}function a(s){var o=s._values,l=s._index,u=s._ptr,c=s._size,f=c[0],h=c[1];if(f===h){var p=0;if(o.length>0)for(var m=0;m<h;m++)for(var v=u[m],y=u[m+1],x=v;x<y;x++){var S=l[x];if(S===m){p=n(p,o[x]);break}if(S>m)break}return p}throw new RangeError("Matrix must be square (size: "+yr(c)+")")}}),PC="index",wte=["typed","Index"],_te=ee(PC,wte,t=>{var{typed:e,Index:r}=t;return e(PC,{"...number | string | BigNumber | Range | Array | Matrix":function(i){var a=i.map(function(o){return or(o)?o.toNumber():Jr(o)||Gt(o)?o.map(function(l){return or(l)?l.toNumber():l}):o}),s=new r;return r.apply(s,a),s}})}),BF=new Set(["end"]),Ate="Node",Ete=["mathWithTransform"],Ste=ee(Ate,Ete,t=>{var{mathWithTransform:e}=t;function r(i){for(var a of[...BF])if(i.has(a))throw new Error('Scope contains an illegal symbol, "'+a+'" is a reserved keyword')}class n{get type(){return"Node"}get isNode(){return!0}evaluate(a){return this.compile().evaluate(a)}compile(){var a=this._compile(e,{}),s={},o=null;function l(u){var c=Gf(u);return r(c),a(c,s,o)}return{evaluate:l}}_compile(a,s){throw new Error("Method _compile must be implemented by type "+this.type)}forEach(a){throw new Error("Cannot run forEach on a Node interface")}map(a){throw new Error("Cannot run map on a Node interface")}_ifNode(a){if(!Zr(a))throw new TypeError("Callback function must return a Node");return a}traverse(a){a(this,null,null);function s(o,l){o.forEach(function(u,c,f){l(u,c,f),s(u,l)})}s(this,a)}transform(a){function s(o,l,u){var c=a(o,l,u);return c!==o?c:o.map(s)}return s(this,null,null)}filter(a){var s=[];return this.traverse(function(o,l,u){a(o,l,u)&&s.push(o)}),s}clone(){throw new Error("Cannot clone a Node interface")}cloneDeep(){return this.map(function(a){return a.cloneDeep()})}equals(a){return a?this.type===a.type&&yu(this,a):!1}toString(a){var s=this._getCustomString(a);return typeof s<"u"?s:this._toString(a)}_toString(){throw new Error("_toString not implemented for "+this.type)}toJSON(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)}toHTML(a){var s=this._getCustomString(a);return typeof s<"u"?s:this._toHTML(a)}_toHTML(){throw new Error("_toHTML not implemented for "+this.type)}toTex(a){var s=this._getCustomString(a);return typeof s<"u"?s:this._toTex(a)}_toTex(a){throw new Error("_toTex not implemented for "+this.type)}_getCustomString(a){if(a&&typeof a=="object")switch(typeof a.handler){case"object":case"undefined":return;case"function":return a.handler(this,a);default:throw new TypeError("Object or function expected as callback")}}getIdentifier(){return this.type}getContent(){return this}}return n},{isClass:!0,isNode:!0});function Qi(t){return t&&t.isIndexError?new zs(t.index+1,t.min+1,t.max!==void 0?t.max+1:void 0):t}function RF(t){var{subset:e}=t;return function(n,i){try{if(Array.isArray(n))return e(n,i);if(n&&typeof n.subset=="function")return n.subset(i);if(typeof n=="string")return e(n,i);if(typeof n=="object"){if(!i.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return Vi(n,i.getObjectProperty())}else throw new TypeError("Cannot apply index: unsupported type of object")}catch(a){throw Qi(a)}}}var am="AccessorNode",Dte=["subset","Node"],Cte=ee(am,Dte,t=>{var{subset:e,Node:r}=t,n=RF({subset:e});function i(s){return!(wc(s)||Ja(s)||Mr(s)||hl(s)||ng(s)||gu(s)||fi(s))}class a extends r{constructor(o,l){if(super(),!Zr(o))throw new TypeError('Node expected for parameter "object"');if(!wh(l))throw new TypeError('IndexNode expected for parameter "index"');this.object=o,this.index=l}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return am}get isAccessorNode(){return!0}_compile(o,l){var u=this.object._compile(o,l),c=this.index._compile(o,l);if(this.index.isObjectProperty()){var f=this.index.getObjectProperty();return function(p,m,v){return Vi(u(p,m,v),f)}}else return function(p,m,v){var y=u(p,m,v),x=c(p,m,y);return n(y,x)}}forEach(o){o(this.object,"object",this),o(this.index,"index",this)}map(o){return new a(this._ifNode(o(this.object,"object",this)),this._ifNode(o(this.index,"index",this)))}clone(){return new a(this.object,this.index)}_toString(o){var l=this.object.toString(o);return i(this.object)&&(l="("+l+")"),l+this.index.toString(o)}_toHTML(o){var l=this.object.toHTML(o);return i(this.object)&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+this.index.toHTML(o)}_toTex(o){var l=this.object.toTex(o);return i(this.object)&&(l="\\left(' + object + '\\right)"),l+this.index.toTex(o)}toJSON(){return{mathjs:am,object:this.object,index:this.index}}static fromJSON(o){return new a(o.object,o.index)}}return Gn(a,"name",am),a},{isClass:!0,isNode:!0}),sm="ArrayNode",Tte=["Node"],Nte=ee(sm,Tte,t=>{var{Node:e}=t;class r extends e{constructor(i){if(super(),this.items=i||[],!Array.isArray(this.items)||!this.items.every(Zr))throw new TypeError("Array containing Nodes expected")}get type(){return sm}get isArrayNode(){return!0}_compile(i,a){var s=sl(this.items,function(u){return u._compile(i,a)}),o=i.config.matrix!=="Array";if(o){var l=i.matrix;return function(c,f,h){return l(sl(s,function(p){return p(c,f,h)}))}}else return function(c,f,h){return sl(s,function(p){return p(c,f,h)})}}forEach(i){for(var a=0;a<this.items.length;a++){var s=this.items[a];i(s,"items["+a+"]",this)}}map(i){for(var a=[],s=0;s<this.items.length;s++)a[s]=this._ifNode(i(this.items[s],"items["+s+"]",this));return new r(a)}clone(){return new r(this.items.slice(0))}_toString(i){var a=this.items.map(function(s){return s.toString(i)});return"["+a.join(", ")+"]"}toJSON(){return{mathjs:sm,items:this.items}}static fromJSON(i){return new r(i.items)}_toHTML(i){var a=this.items.map(function(s){return s.toHTML(i)});return'<span class="math-parenthesis math-square-parenthesis">[</span>'+a.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(i){function a(s,o){var l=s.some(Ja)&&!s.every(Ja),u=o||l,c=u?"&":"\\\\",f=s.map(function(h){return h.items?a(h.items,!o):h.toTex(i)}).join(c);return l||!u||u&&!o?"\\begin{bmatrix}"+f+"\\end{bmatrix}":f}return a(this.items,!1)}}return Gn(r,"name",sm),r},{isClass:!0,isNode:!0});function Mte(t){var{subset:e,matrix:r}=t;return function(i,a,s){try{if(Array.isArray(i)){var o=r(i).subset(a,s).valueOf();return o.forEach((l,u)=>{i[u]=l}),i}else{if(i&&typeof i.subset=="function")return i.subset(a,s);if(typeof i=="string")return e(i,a,s);if(typeof i=="object"){if(!a.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return th(i,a.getObjectProperty(),s),i}else throw new TypeError("Cannot apply index: unsupported type of object")}}catch(l){throw Qi(l)}}}var Bs=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{op:"or",associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{op:"xor",associativity:"left",associativeWith:[]}},{"OperatorNode:and":{op:"and",associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{op:"|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{op:"^|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{op:"&",associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{op:"==",associativity:"left",associativeWith:[]},"OperatorNode:unequal":{op:"!=",associativity:"left",associativeWith:[]},"OperatorNode:smaller":{op:"<",associativity:"left",associativeWith:[]},"OperatorNode:larger":{op:">",associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{op:"<=",associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{op:">=",associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{op:"<<",associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{op:">>",associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{op:">>>",associativity:"left",associativeWith:[]}},{"OperatorNode:to":{op:"to",associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{op:"+",associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{op:"-",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{op:"*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{op:"/",associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{op:".*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{op:"./",associativity:"left",associativeWith:[]},"OperatorNode:mod":{op:"mod",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]}},{"OperatorNode:unaryPlus":{op:"+",associativity:"right"},"OperatorNode:unaryMinus":{op:"-",associativity:"right"},"OperatorNode:bitNot":{op:"~",associativity:"right"},"OperatorNode:not":{op:"not",associativity:"right"}},{"OperatorNode:pow":{op:"^",associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{op:".^",associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{op:"!",associativity:"left"}},{"OperatorNode:ctranspose":{op:"'",associativity:"left"}}];function om(t,e){if(!e||e!=="auto")return t;for(var r=t;gu(r);)r=r.content;return r}function en(t,e,r,n){var i=t;e!=="keep"&&(i=t.getContent());for(var a=i.getIdentifier(),s=null,o=0;o<Bs.length;o++)if(a in Bs[o]){s=o;break}if(a==="OperatorNode:multiply"&&i.implicit&&r!=="show"){var l=om(i.args[0],e);!(Mr(l)&&n&&n.getIdentifier()==="OperatorNode:divide"&&B1(om(n.args[0],e)))&&!(l.getIdentifier()==="OperatorNode:divide"&&B1(om(l.args[0],e))&&Mr(om(l.args[1])))&&(s+=1)}return s}function ad(t,e){var r=t;e!=="keep"&&(r=t.getContent());var n=r.getIdentifier(),i=en(r,e);if(i===null)return null;var a=Bs[i][n];if(Ft(a,"associativity")){if(a.associativity==="left")return"left";if(a.associativity==="right")return"right";throw Error("'"+n+"' has the invalid associativity '"+a.associativity+"'.")}return null}function cy(t,e,r){var n=r!=="keep"?t.getContent():t,i=r!=="keep"?t.getContent():e,a=n.getIdentifier(),s=i.getIdentifier(),o=en(n,r);if(o===null)return null;var l=Bs[o][a];if(Ft(l,"associativeWith")&&l.associativeWith instanceof Array){for(var u=0;u<l.associativeWith.length;u++)if(l.associativeWith[u]===s)return!0;return!1}return null}function Ite(t){var e="OperatorNode:"+t;for(var r of Bs)if(e in r)return r[e].op;return null}var um="AssignmentNode",Fte=["subset","?matrix","Node"],Ote=ee(um,Fte,t=>{var{subset:e,matrix:r,Node:n}=t,i=RF({subset:e}),a=Mte({subset:e,matrix:r});function s(l,u,c){u||(u="keep");var f=en(l,u,c),h=en(l.value,u,c);return u==="all"||h!==null&&h<=f}class o extends n{constructor(u,c,f){if(super(),this.object=u,this.index=f?c:null,this.value=f||c,!fi(u)&&!wc(u))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(fi(u)&&u.name==="end")throw new Error('Cannot assign to symbol "end"');if(this.index&&!wh(this.index))throw new TypeError('IndexNode expected as "index"');if(!Zr(this.value))throw new TypeError('Node expected as "value"')}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return um}get isAssignmentNode(){return!0}_compile(u,c){var f=this.object._compile(u,c),h=this.index?this.index._compile(u,c):null,p=this.value._compile(u,c),m=this.object.name;if(this.index)if(this.index.isObjectProperty()){var v=this.index.getObjectProperty();return function(A,E,_){var T=f(A,E,_),M=p(A,E,_);return th(T,v,M),M}}else{if(fi(this.object))return function(A,E,_){var T=f(A,E,_),M=p(A,E,_),N=h(A,E,T);return A.set(m,a(T,N,M)),M};var y=this.object.object._compile(u,c);if(this.object.index.isObjectProperty()){var x=this.object.index.getObjectProperty();return function(A,E,_){var T=y(A,E,_),M=Vi(T,x),N=h(A,E,M),I=p(A,E,_);return th(T,x,a(M,N,I)),I}}else{var S=this.object.index._compile(u,c);return function(A,E,_){var T=y(A,E,_),M=S(A,E,T),N=i(T,M),I=h(A,E,N),F=p(A,E,_);return a(T,M,a(N,I,F)),F}}}else{if(!fi(this.object))throw new TypeError("SymbolNode expected as object");return function(A,E,_){var T=p(A,E,_);return A.set(m,T),T}}}forEach(u){u(this.object,"object",this),this.index&&u(this.index,"index",this),u(this.value,"value",this)}map(u){var c=this._ifNode(u(this.object,"object",this)),f=this.index?this._ifNode(u(this.index,"index",this)):null,h=this._ifNode(u(this.value,"value",this));return new o(c,f,h)}clone(){return new o(this.object,this.index,this.value)}_toString(u){var c=this.object.toString(u),f=this.index?this.index.toString(u):"",h=this.value.toString(u);return s(this,u&&u.parenthesis,u&&u.implicit)&&(h="("+h+")"),c+f+" = "+h}toJSON(){return{mathjs:um,object:this.object,index:this.index,value:this.value}}static fromJSON(u){return new o(u.object,u.index,u.value)}_toHTML(u){var c=this.object.toHTML(u),f=this.index?this.index.toHTML(u):"",h=this.value.toHTML(u);return s(this,u&&u.parenthesis,u&&u.implicit)&&(h='<span class="math-paranthesis math-round-parenthesis">(</span>'+h+'<span class="math-paranthesis math-round-parenthesis">)</span>'),c+f+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+h}_toTex(u){var c=this.object.toTex(u),f=this.index?this.index.toTex(u):"",h=this.value.toTex(u);return s(this,u&&u.parenthesis,u&&u.implicit)&&(h="\\left(".concat(h,"\\right)")),c+f+"="+h}}return Gn(o,"name",um),o},{isClass:!0,isNode:!0}),lm="BlockNode",Bte=["ResultSet","Node"],Rte=ee(lm,Bte,t=>{var{ResultSet:e,Node:r}=t;class n extends r{constructor(a){if(super(),!Array.isArray(a))throw new Error("Array expected");this.blocks=a.map(function(s){var o=s&&s.node,l=s&&s.visible!==void 0?s.visible:!0;if(!Zr(o))throw new TypeError('Property "node" must be a Node');if(typeof l!="boolean")throw new TypeError('Property "visible" must be a boolean');return{node:o,visible:l}})}get type(){return lm}get isBlockNode(){return!0}_compile(a,s){var o=sl(this.blocks,function(l){return{evaluate:l.node._compile(a,s),visible:l.visible}});return function(u,c,f){var h=[];return gI(o,function(m){var v=m.evaluate(u,c,f);m.visible&&h.push(v)}),new e(h)}}forEach(a){for(var s=0;s<this.blocks.length;s++)a(this.blocks[s].node,"blocks["+s+"].node",this)}map(a){for(var s=[],o=0;o<this.blocks.length;o++){var l=this.blocks[o],u=this._ifNode(a(l.node,"blocks["+o+"].node",this));s[o]={node:u,visible:l.visible}}return new n(s)}clone(){var a=this.blocks.map(function(s){return{node:s.node,visible:s.visible}});return new n(a)}_toString(a){return this.blocks.map(function(s){return s.node.toString(a)+(s.visible?"":";")}).join(`
`)}toJSON(){return{mathjs:lm,blocks:this.blocks}}static fromJSON(a){return new n(a.blocks)}_toHTML(a){return this.blocks.map(function(s){return s.node.toHTML(a)+(s.visible?"":'<span class="math-separator">;</span>')}).join('<span class="math-separator"><br /></span>')}_toTex(a){return this.blocks.map(function(s){return s.node.toTex(a)+(s.visible?"":";")}).join(`\\;\\;
`)}}return Gn(n,"name",lm),n},{isClass:!0,isNode:!0}),cm="ConditionalNode",Pte=["Node"],$te=ee(cm,Pte,t=>{var{Node:e}=t;function r(i){if(typeof i=="number"||typeof i=="boolean"||typeof i=="string")return!!i;if(i){if(or(i))return!i.isZero();if(pu(i))return!!(i.re||i.im);if(es(i))return!!i.value}if(i==null)return!1;throw new TypeError('Unsupported type of condition "'+tn(i)+'"')}class n extends e{constructor(a,s,o){if(super(),!Zr(a))throw new TypeError("Parameter condition must be a Node");if(!Zr(s))throw new TypeError("Parameter trueExpr must be a Node");if(!Zr(o))throw new TypeError("Parameter falseExpr must be a Node");this.condition=a,this.trueExpr=s,this.falseExpr=o}get type(){return cm}get isConditionalNode(){return!0}_compile(a,s){var o=this.condition._compile(a,s),l=this.trueExpr._compile(a,s),u=this.falseExpr._compile(a,s);return function(f,h,p){return r(o(f,h,p))?l(f,h,p):u(f,h,p)}}forEach(a){a(this.condition,"condition",this),a(this.trueExpr,"trueExpr",this),a(this.falseExpr,"falseExpr",this)}map(a){return new n(this._ifNode(a(this.condition,"condition",this)),this._ifNode(a(this.trueExpr,"trueExpr",this)),this._ifNode(a(this.falseExpr,"falseExpr",this)))}clone(){return new n(this.condition,this.trueExpr,this.falseExpr)}_toString(a){var s=a&&a.parenthesis?a.parenthesis:"keep",o=en(this,s,a&&a.implicit),l=this.condition.toString(a),u=en(this.condition,s,a&&a.implicit);(s==="all"||this.condition.type==="OperatorNode"||u!==null&&u<=o)&&(l="("+l+")");var c=this.trueExpr.toString(a),f=en(this.trueExpr,s,a&&a.implicit);(s==="all"||this.trueExpr.type==="OperatorNode"||f!==null&&f<=o)&&(c="("+c+")");var h=this.falseExpr.toString(a),p=en(this.falseExpr,s,a&&a.implicit);return(s==="all"||this.falseExpr.type==="OperatorNode"||p!==null&&p<=o)&&(h="("+h+")"),l+" ? "+c+" : "+h}toJSON(){return{mathjs:cm,condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}}static fromJSON(a){return new n(a.condition,a.trueExpr,a.falseExpr)}_toHTML(a){var s=a&&a.parenthesis?a.parenthesis:"keep",o=en(this,s,a&&a.implicit),l=this.condition.toHTML(a),u=en(this.condition,s,a&&a.implicit);(s==="all"||this.condition.type==="OperatorNode"||u!==null&&u<=o)&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>');var c=this.trueExpr.toHTML(a),f=en(this.trueExpr,s,a&&a.implicit);(s==="all"||this.trueExpr.type==="OperatorNode"||f!==null&&f<=o)&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>');var h=this.falseExpr.toHTML(a),p=en(this.falseExpr,s,a&&a.implicit);return(s==="all"||this.falseExpr.type==="OperatorNode"||p!==null&&p<=o)&&(h='<span class="math-parenthesis math-round-parenthesis">(</span>'+h+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+'<span class="math-operator math-conditional-operator">?</span>'+c+'<span class="math-operator math-conditional-operator">:</span>'+h}_toTex(a){return"\\begin{cases} {"+this.trueExpr.toTex(a)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(a)+"}\\\\{"+this.falseExpr.toTex(a)+"}, &\\quad{\\text{otherwise}}\\end{cases}"}}return Gn(n,"name",cm),n},{isClass:!0,isNode:!0}),J1=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},kte={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},Lte={"–":"\\--","—":"\\---"," ":"~","	":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},Ute=function(e,r){return J1({},e,r)},zte=function(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.preserveFormatting,n=r===void 0?!1:r,i=e.escapeMapFn,a=i===void 0?Ute:i,s=String(t),o="",l=a(J1({},kte),n?J1({},Lte):{}),u=Object.keys(l),c=function(){var h=!1;u.forEach(function(p,m){h||s.length>=p.length&&s.slice(0,p.length)===p&&(o+=l[u[m]],s=s.slice(p.length,s.length),h=!0)}),h||(o+=s.slice(0,1),s=s.slice(1,s.length))};s;)c();return o};const Gte=gl(zte);var eb={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},$r={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},$C={abs:{1:"\\left|${args[0]}\\right|"},add:{2:"\\left(${args[0]}".concat($r.add,"${args[1]}\\right)")},cbrt:{1:"\\sqrt[3]{${args[0]}}"},ceil:{1:"\\left\\lceil${args[0]}\\right\\rceil"},cube:{1:"\\left(${args[0]}\\right)^3"},divide:{2:"\\frac{${args[0]}}{${args[1]}}"},dotDivide:{2:"\\left(${args[0]}".concat($r.dotDivide,"${args[1]}\\right)")},dotMultiply:{2:"\\left(${args[0]}".concat($r.dotMultiply,"${args[1]}\\right)")},dotPow:{2:"\\left(${args[0]}".concat($r.dotPow,"${args[1]}\\right)")},exp:{1:"\\exp\\left(${args[0]}\\right)"},expm1:"\\left(e".concat($r.pow,"{${args[0]}}-1\\right)"),fix:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},floor:{1:"\\left\\lfloor${args[0]}\\right\\rfloor"},fraction:{2:"\\frac{${args[0]}}{${args[1]}}"},gcd:"\\gcd\\left(${args}\\right)",hypot:"\\hypot\\left(${args}\\right)",log:{1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},log10:{1:"\\log_{10}\\left(${args[0]}\\right)"},log1p:{1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},log2:"\\log_{2}\\left(${args[0]}\\right)",mod:{2:"\\left(${args[0]}".concat($r.mod,"${args[1]}\\right)")},multiply:{2:"\\left(${args[0]}".concat($r.multiply,"${args[1]}\\right)")},norm:{1:"\\left\\|${args[0]}\\right\\|",2:void 0},nthRoot:{2:"\\sqrt[${args[1]}]{${args[0]}}"},nthRoots:{2:"\\{y : y^${args[1]} = {${args[0]}}\\}"},pow:{2:"\\left(${args[0]}\\right)".concat($r.pow,"{${args[1]}}")},round:{1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},sign:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},sqrt:{1:"\\sqrt{${args[0]}}"},square:{1:"\\left(${args[0]}\\right)^2"},subtract:{2:"\\left(${args[0]}".concat($r.subtract,"${args[1]}\\right)")},unaryMinus:{1:"".concat($r.unaryMinus,"\\left(${args[0]}\\right)")},unaryPlus:{1:"".concat($r.unaryPlus,"\\left(${args[0]}\\right)")},bitAnd:{2:"\\left(${args[0]}".concat($r.bitAnd,"${args[1]}\\right)")},bitNot:{1:$r.bitNot+"\\left(${args[0]}\\right)"},bitOr:{2:"\\left(${args[0]}".concat($r.bitOr,"${args[1]}\\right)")},bitXor:{2:"\\left(${args[0]}".concat($r.bitXor,"${args[1]}\\right)")},leftShift:{2:"\\left(${args[0]}".concat($r.leftShift,"${args[1]}\\right)")},rightArithShift:{2:"\\left(${args[0]}".concat($r.rightArithShift,"${args[1]}\\right)")},rightLogShift:{2:"\\left(${args[0]}".concat($r.rightLogShift,"${args[1]}\\right)")},bellNumbers:{1:"\\mathrm{B}_{${args[0]}}"},catalan:{1:"\\mathrm{C}_{${args[0]}}"},stirlingS2:{2:"\\mathrm{S}\\left(${args}\\right)"},arg:{1:"\\arg\\left(${args[0]}\\right)"},conj:{1:"\\left(${args[0]}\\right)^*"},im:{1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},re:{1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},and:{2:"\\left(${args[0]}".concat($r.and,"${args[1]}\\right)")},not:{1:$r.not+"\\left(${args[0]}\\right)"},or:{2:"\\left(${args[0]}".concat($r.or,"${args[1]}\\right)")},xor:{2:"\\left(${args[0]}".concat($r.xor,"${args[1]}\\right)")},cross:{2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},ctranspose:{1:"\\left(${args[0]}\\right)".concat($r.ctranspose)},det:{1:"\\det\\left(${args[0]}\\right)"},dot:{2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},expm:{1:"\\exp\\left(${args[0]}\\right)"},inv:{1:"\\left(${args[0]}\\right)^{-1}"},pinv:{1:"\\left(${args[0]}\\right)^{+}"},sqrtm:{1:"{${args[0]}}".concat($r.pow,"{\\frac{1}{2}}")},trace:{1:"\\mathrm{tr}\\left(${args[0]}\\right)"},transpose:{1:"\\left(${args[0]}\\right)".concat($r.transpose)},combinations:{2:"\\binom{${args[0]}}{${args[1]}}"},combinationsWithRep:{2:"\\left(\\!\\!{\\binom{${args[0]}}{${args[1]}}}\\!\\!\\right)"},factorial:{1:"\\left(${args[0]}\\right)".concat($r.factorial)},gamma:{1:"\\Gamma\\left(${args[0]}\\right)"},lgamma:{1:"\\ln\\Gamma\\left(${args[0]}\\right)"},equal:{2:"\\left(${args[0]}".concat($r.equal,"${args[1]}\\right)")},larger:{2:"\\left(${args[0]}".concat($r.larger,"${args[1]}\\right)")},largerEq:{2:"\\left(${args[0]}".concat($r.largerEq,"${args[1]}\\right)")},smaller:{2:"\\left(${args[0]}".concat($r.smaller,"${args[1]}\\right)")},smallerEq:{2:"\\left(${args[0]}".concat($r.smallerEq,"${args[1]}\\right)")},unequal:{2:"\\left(${args[0]}".concat($r.unequal,"${args[1]}\\right)")},erf:{1:"erf\\left(${args[0]}\\right)"},max:"\\max\\left(${args}\\right)",min:"\\min\\left(${args}\\right)",variance:"\\mathrm{Var}\\left(${args}\\right)",acos:{1:"\\cos^{-1}\\left(${args[0]}\\right)"},acosh:{1:"\\cosh^{-1}\\left(${args[0]}\\right)"},acot:{1:"\\cot^{-1}\\left(${args[0]}\\right)"},acoth:{1:"\\coth^{-1}\\left(${args[0]}\\right)"},acsc:{1:"\\csc^{-1}\\left(${args[0]}\\right)"},acsch:{1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},asec:{1:"\\sec^{-1}\\left(${args[0]}\\right)"},asech:{1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},asin:{1:"\\sin^{-1}\\left(${args[0]}\\right)"},asinh:{1:"\\sinh^{-1}\\left(${args[0]}\\right)"},atan:{1:"\\tan^{-1}\\left(${args[0]}\\right)"},atan2:{2:"\\mathrm{atan2}\\left(${args}\\right)"},atanh:{1:"\\tanh^{-1}\\left(${args[0]}\\right)"},cos:{1:"\\cos\\left(${args[0]}\\right)"},cosh:{1:"\\cosh\\left(${args[0]}\\right)"},cot:{1:"\\cot\\left(${args[0]}\\right)"},coth:{1:"\\coth\\left(${args[0]}\\right)"},csc:{1:"\\csc\\left(${args[0]}\\right)"},csch:{1:"\\mathrm{csch}\\left(${args[0]}\\right)"},sec:{1:"\\sec\\left(${args[0]}\\right)"},sech:{1:"\\mathrm{sech}\\left(${args[0]}\\right)"},sin:{1:"\\sin\\left(${args[0]}\\right)"},sinh:{1:"\\sinh\\left(${args[0]}\\right)"},tan:{1:"\\tan\\left(${args[0]}\\right)"},tanh:{1:"\\tanh\\left(${args[0]}\\right)"},to:{2:"\\left(${args[0]}".concat($r.to,"${args[1]}\\right)")},numeric:function(e,r){return e.args[0].toTex()},number:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},string:{0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},bignumber:{0:"0",1:"\\left(${args[0]}\\right)"},bigint:{0:"0",1:"\\left(${args[0]}\\right)"},complex:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+".concat(eb.i,"\\cdot\\left(${args[1]}\\right)\\right)")},matrix:{0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},sparse:{0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},unit:{1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"}},qte="\\mathrm{${name}}\\left(${args}\\right)",kC={deg:"^\\circ"};function tb(t){return Gte(t,{preserveFormatting:!0})}function PF(t,e){return e=typeof e>"u"?!1:e,e?Ft(kC,t)?kC[t]:"\\mathrm{"+tb(t)+"}":Ft(eb,t)?eb[t]:tb(t)}var fm="ConstantNode",Hte=["Node"],Wte=ee(fm,Hte,t=>{var{Node:e}=t;class r extends e{constructor(i){super(),this.value=i}get type(){return fm}get isConstantNode(){return!0}_compile(i,a){var s=this.value;return function(){return s}}forEach(i){}map(i){return this.clone()}clone(){return new r(this.value)}_toString(i){return yr(this.value,i)}_toHTML(i){var a=this._toString(i);switch(tn(this.value)){case"number":case"bigint":case"BigNumber":case"Fraction":return'<span class="math-number">'+a+"</span>";case"string":return'<span class="math-string">'+a+"</span>";case"boolean":return'<span class="math-boolean">'+a+"</span>";case"null":return'<span class="math-null-symbol">'+a+"</span>";case"undefined":return'<span class="math-undefined">'+a+"</span>";default:return'<span class="math-symbol">'+a+"</span>"}}toJSON(){return{mathjs:fm,value:this.value}}static fromJSON(i){return new r(i.value)}_toTex(i){var a=this._toString(i),s=tn(this.value);switch(s){case"string":return"\\mathtt{"+tb(a)+"}";case"number":case"BigNumber":{var o=s==="BigNumber"?this.value.isFinite():isFinite(this.value);if(!o)return this.value.valueOf()<0?"-\\infty":"\\infty";var l=a.toLowerCase().indexOf("e");return l!==-1?a.substring(0,l)+"\\cdot10^{"+a.substring(l+1)+"}":a}case"bigint":return a.toString();case"Fraction":return this.value.toLatex();default:return a}}}return Gn(r,"name",fm),r},{isClass:!0,isNode:!0}),hm="FunctionAssignmentNode",Vte=["typed","Node"],Xte=ee(hm,Vte,t=>{var{typed:e,Node:r}=t;function n(a,s,o){var l=en(a,s,o),u=en(a.expr,s,o);return s==="all"||u!==null&&u<=l}class i extends r{constructor(s,o,l){if(super(),typeof s!="string")throw new TypeError('String expected for parameter "name"');if(!Array.isArray(o))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!Zr(l))throw new TypeError('Node expected for parameter "expr"');if(BF.has(s))throw new Error('Illegal function name, "'+s+'" is a reserved keyword');var u=new Set;for(var c of o){var f=typeof c=="string"?c:c.name;if(u.has(f))throw new Error('Duplicate parameter name "'.concat(f,'"'));u.add(f)}this.name=s,this.params=o.map(function(h){return h&&h.name||h}),this.types=o.map(function(h){return h&&h.type||"any"}),this.expr=l}get type(){return hm}get isFunctionAssignmentNode(){return!0}_compile(s,o){var l=Object.create(o);gI(this.params,function(m){l[m]=!0});var u=this.expr._compile(s,l),c=this.name,f=this.params,h=LE(this.types,","),p=c+"("+LE(this.params,", ")+")";return function(v,y,x){var S={};S[h]=function(){for(var A=Object.create(y),E=0;E<f.length;E++)A[f[E]]=arguments[E];return u(v,A,x)};var b=e(c,S);return b.syntax=p,v.set(c,b),b}}forEach(s){s(this.expr,"expr",this)}map(s){var o=this._ifNode(s(this.expr,"expr",this));return new i(this.name,this.params.slice(0),o)}clone(){return new i(this.name,this.params.slice(0),this.expr)}_toString(s){var o=s&&s.parenthesis?s.parenthesis:"keep",l=this.expr.toString(s);return n(this,o,s&&s.implicit)&&(l="("+l+")"),this.name+"("+this.params.join(", ")+") = "+l}toJSON(){var s=this.types;return{mathjs:hm,name:this.name,params:this.params.map(function(o,l){return{name:o,type:s[l]}}),expr:this.expr}}static fromJSON(s){return new i(s.name,s.params,s.expr)}_toHTML(s){for(var o=s&&s.parenthesis?s.parenthesis:"keep",l=[],u=0;u<this.params.length;u++)l.push('<span class="math-symbol math-parameter">'+ts(this.params[u])+"</span>");var c=this.expr.toHTML(s);return n(this,o,s&&s.implicit)&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+ts(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+l.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+c}_toTex(s){var o=s&&s.parenthesis?s.parenthesis:"keep",l=this.expr.toTex(s);return n(this,o,s&&s.implicit)&&(l="\\left(".concat(l,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(PF).join(",")+"\\right)="+l}}return Gn(i,"name",hm),i},{isClass:!0,isNode:!0}),dm="IndexNode",jte=["Node","size"],Yte=ee(dm,jte,t=>{var{Node:e,size:r}=t;class n extends e{constructor(a,s){if(super(),this.dimensions=a,this.dotNotation=s||!1,!Array.isArray(a)||!a.every(Zr))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties")}get type(){return dm}get isIndexNode(){return!0}_compile(a,s){var o=sl(this.dimensions,function(u,c){var f=u.filter(m=>m.isSymbolNode&&m.name==="end").length>0;if(f){var h=Object.create(s);h.end=!0;var p=u._compile(a,h);return function(v,y,x){if(!Gt(x)&&!Jr(x)&&!Fi(x))throw new TypeError('Cannot resolve "end": context must be a Matrix, Array, or string but is '+tn(x));var S=r(x).valueOf(),b=Object.create(y);return b.end=S[c],p(v,b,x)}}else return u._compile(a,s)}),l=Vi(a,"index");return function(c,f,h){var p=sl(o,function(m){return m(c,f,h)});return l(...p)}}forEach(a){for(var s=0;s<this.dimensions.length;s++)a(this.dimensions[s],"dimensions["+s+"]",this)}map(a){for(var s=[],o=0;o<this.dimensions.length;o++)s[o]=this._ifNode(a(this.dimensions[o],"dimensions["+o+"]",this));return new n(s,this.dotNotation)}clone(){return new n(this.dimensions.slice(0),this.dotNotation)}isObjectProperty(){return this.dimensions.length===1&&Mr(this.dimensions[0])&&typeof this.dimensions[0].value=="string"}getObjectProperty(){return this.isObjectProperty()?this.dimensions[0].value:null}_toString(a){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"}toJSON(){return{mathjs:dm,dimensions:this.dimensions,dotNotation:this.dotNotation}}static fromJSON(a){return new n(a.dimensions,a.dotNotation)}_toHTML(a){for(var s=[],o=0;o<this.dimensions.length;o++)s[o]=this.dimensions[o].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+ts(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+s.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(a){var s=this.dimensions.map(function(o){return o.toTex(a)});return this.dotNotation?"."+this.getObjectProperty():"_{"+s.join(",")+"}"}}return Gn(n,"name",dm),n},{isClass:!0,isNode:!0}),pm="ObjectNode",Kte=["Node"],Zte=ee(pm,Kte,t=>{var{Node:e}=t;class r extends e{constructor(i){if(super(),this.properties=i||{},i&&(typeof i!="object"||!Object.keys(i).every(function(a){return Zr(i[a])})))throw new TypeError("Object containing Nodes expected")}get type(){return pm}get isObjectNode(){return!0}_compile(i,a){var s={};for(var o in this.properties)if(Ft(this.properties,o)){var l=Rf(o),u=JSON.parse(l),c=Vi(this.properties,o);s[u]=c._compile(i,a)}return function(h,p,m){var v={};for(var y in s)Ft(s,y)&&(v[y]=s[y](h,p,m));return v}}forEach(i){for(var a in this.properties)Ft(this.properties,a)&&i(this.properties[a],"properties["+Rf(a)+"]",this)}map(i){var a={};for(var s in this.properties)Ft(this.properties,s)&&(a[s]=this._ifNode(i(this.properties[s],"properties["+Rf(s)+"]",this)));return new r(a)}clone(){var i={};for(var a in this.properties)Ft(this.properties,a)&&(i[a]=this.properties[a]);return new r(i)}_toString(i){var a=[];for(var s in this.properties)Ft(this.properties,s)&&a.push(Rf(s)+": "+this.properties[s].toString(i));return"{"+a.join(", ")+"}"}toJSON(){return{mathjs:pm,properties:this.properties}}static fromJSON(i){return new r(i.properties)}_toHTML(i){var a=[];for(var s in this.properties)Ft(this.properties,s)&&a.push('<span class="math-symbol math-property">'+ts(s)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[s].toHTML(i));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+a.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'}_toTex(i){var a=[];for(var s in this.properties)Ft(this.properties,s)&&a.push("\\mathbf{"+s+":} & "+this.properties[s].toTex(i)+"\\\\");var o="\\left\\{\\begin{array}{ll}"+a.join(`
`)+"\\end{array}\\right\\}";return o}}return Gn(r,"name",pm),r},{isClass:!0,isNode:!0});function pd(t,e){return new qM(t,new eg(e),new Set(Object.keys(e)))}var mm="OperatorNode",Qte=["Node"],Jte=ee(mm,Qte,t=>{var{Node:e}=t;function r(a,s){var o=a;if(s==="auto")for(;gu(o);)o=o.content;return Mr(o)?!0:Rn(o)?r(o.args[0],s):!1}function n(a,s,o,l,u){var c=en(a,s,o),f=ad(a,s);if(s==="all"||l.length>2&&a.getIdentifier()!=="OperatorNode:add"&&a.getIdentifier()!=="OperatorNode:multiply")return l.map(function(I){switch(I.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}});var h;switch(l.length){case 0:h=[];break;case 1:{var p=en(l[0],s,o,a);if(u&&p!==null){var m,v;if(s==="keep"?(m=l[0].getIdentifier(),v=a.getIdentifier()):(m=l[0].getContent().getIdentifier(),v=a.getContent().getIdentifier()),Bs[c][v].latexLeftParens===!1){h=[!1];break}if(Bs[p][m].latexParens===!1){h=[!1];break}}if(p===null){h=[!1];break}if(p<=c){h=[!0];break}h=[!1]}break;case 2:{var y,x=en(l[0],s,o,a),S=cy(a,l[0],s);x===null?y=!1:x===c&&f==="right"&&!S||x<c?y=!0:y=!1;var b,A=en(l[1],s,o,a),E=cy(a,l[1],s);if(A===null?b=!1:A===c&&f==="left"&&!E||A<c?b=!0:b=!1,u){var _,T,M;s==="keep"?(_=a.getIdentifier(),T=a.args[0].getIdentifier(),M=a.args[1].getIdentifier()):(_=a.getContent().getIdentifier(),T=a.args[0].getContent().getIdentifier(),M=a.args[1].getContent().getIdentifier()),x!==null&&(Bs[c][_].latexLeftParens===!1&&(y=!1),Bs[x][T].latexParens===!1&&(y=!1)),A!==null&&(Bs[c][_].latexRightParens===!1&&(b=!1),Bs[A][M].latexParens===!1&&(b=!1))}h=[y,b]}break;default:(a.getIdentifier()==="OperatorNode:add"||a.getIdentifier()==="OperatorNode:multiply")&&(h=l.map(function(I){var F=en(I,s,o,a),P=cy(a,I,s),U=ad(I,s);return F===null?!1:c===F&&f===U&&!P?!0:F<c}));break}if(l.length>=2&&a.getIdentifier()==="OperatorNode:multiply"&&a.implicit&&s!=="all"&&o==="hide")for(var N=1;N<h.length;++N)r(l[N],s)&&!h[N-1]&&(s!=="keep"||!gu(l[N-1]))&&(h[N]=!0);return h}class i extends e{constructor(s,o,l,u,c){if(super(),typeof s!="string")throw new TypeError('string expected for parameter "op"');if(typeof o!="string")throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(l)||!l.every(Zr))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=u===!0,this.isPercentage=c===!0,this.op=s,this.fn=o,this.args=l||[]}get type(){return mm}get isOperatorNode(){return!0}_compile(s,o){if(typeof this.fn!="string"||!zb(s,this.fn))throw s[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var l=Vi(s,this.fn),u=sl(this.args,function(m){return m._compile(s,o)});if(typeof l=="function"&&l.rawArgs===!0){var c=this.args;return function(v,y,x){return l(c,s,pd(v,y))}}else if(u.length===1){var f=u[0];return function(v,y,x){return l(f(v,y,x))}}else if(u.length===2){var h=u[0],p=u[1];return function(v,y,x){return l(h(v,y,x),p(v,y,x))}}else return function(v,y,x){return l.apply(null,sl(u,function(S){return S(v,y,x)}))}}forEach(s){for(var o=0;o<this.args.length;o++)s(this.args[o],"args["+o+"]",this)}map(s){for(var o=[],l=0;l<this.args.length;l++)o[l]=this._ifNode(s(this.args[l],"args["+l+"]",this));return new i(this.op,this.fn,o,this.implicit,this.isPercentage)}clone(){return new i(this.op,this.fn,this.args.slice(0),this.implicit,this.isPercentage)}isUnary(){return this.args.length===1}isBinary(){return this.args.length===2}_toString(s){var o=s&&s.parenthesis?s.parenthesis:"keep",l=s&&s.implicit?s.implicit:"hide",u=this.args,c=n(this,o,l,u,!1);if(u.length===1){var f=ad(this,o),h=u[0].toString(s);c[0]&&(h="("+h+")");var p=/[a-zA-Z]+/.test(this.op);return f==="right"?this.op+(p?" ":"")+h:f==="left"?h+(p?" ":"")+this.op:h+this.op}else if(u.length===2){var m=u[0].toString(s),v=u[1].toString(s);return c[0]&&(m="("+m+")"),c[1]&&(v="("+v+")"),this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&l==="hide"?m+" "+v:m+" "+this.op+" "+v}else if(u.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var y=u.map(function(x,S){return x=x.toString(s),c[S]&&(x="("+x+")"),x});return this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&l==="hide"?y.join(" "):y.join(" "+this.op+" ")}else return this.fn+"("+this.args.join(", ")+")"}toJSON(){return{mathjs:mm,op:this.op,fn:this.fn,args:this.args,implicit:this.implicit,isPercentage:this.isPercentage}}static fromJSON(s){return new i(s.op,s.fn,s.args,s.implicit,s.isPercentage)}_toHTML(s){var o=s&&s.parenthesis?s.parenthesis:"keep",l=s&&s.implicit?s.implicit:"hide",u=this.args,c=n(this,o,l,u,!1);if(u.length===1){var f=ad(this,o),h=u[0].toHTML(s);return c[0]&&(h='<span class="math-parenthesis math-round-parenthesis">(</span>'+h+'<span class="math-parenthesis math-round-parenthesis">)</span>'),f==="right"?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+ts(this.op)+"</span>"+h:h+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+ts(this.op)+"</span>"}else if(u.length===2){var p=u[0].toHTML(s),m=u[1].toHTML(s);return c[0]&&(p='<span class="math-parenthesis math-round-parenthesis">(</span>'+p+'<span class="math-parenthesis math-round-parenthesis">)</span>'),c[1]&&(m='<span class="math-parenthesis math-round-parenthesis">(</span>'+m+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&l==="hide"?p+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+m:p+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+ts(this.op)+"</span>"+m}else{var v=u.map(function(y,x){return y=y.toHTML(s),c[x]&&(y='<span class="math-parenthesis math-round-parenthesis">(</span>'+y+'<span class="math-parenthesis math-round-parenthesis">)</span>'),y});return u.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")?this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&l==="hide"?v.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):v.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+ts(this.op)+"</span>"):'<span class="math-function">'+ts(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+v.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}}_toTex(s){var o=s&&s.parenthesis?s.parenthesis:"keep",l=s&&s.implicit?s.implicit:"hide",u=this.args,c=n(this,o,l,u,!0),f=$r[this.fn];if(f=typeof f>"u"?this.op:f,u.length===1){var h=ad(this,o),p=u[0].toTex(s);return c[0]&&(p="\\left(".concat(p,"\\right)")),h==="right"?f+p:p+f}else if(u.length===2){var m=u[0],v=m.toTex(s);c[0]&&(v="\\left(".concat(v,"\\right)"));var y=u[1],x=y.toTex(s);c[1]&&(x="\\left(".concat(x,"\\right)"));var S;switch(o==="keep"?S=m.getIdentifier():S=m.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return f+"{"+v+"}{"+x+"}";case"OperatorNode:pow":switch(v="{"+v+"}",x="{"+x+"}",S){case"ConditionalNode":case"OperatorNode:divide":v="\\left(".concat(v,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&l==="hide")return v+"~"+x}return v+f+x}else if(u.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var b=u.map(function(A,E){return A=A.toTex(s),c[E]&&(A="\\left(".concat(A,"\\right)")),A});return this.getIdentifier()==="OperatorNode:multiply"&&this.implicit&&l==="hide"?b.join("~"):b.join(f)}else return"\\mathrm{"+this.fn+"}\\left("+u.map(function(A){return A.toTex(s)}).join(",")+"\\right)"}getIdentifier(){return this.type+":"+this.fn}}return Gn(i,"name",mm),i},{isClass:!0,isNode:!0}),vm="ParenthesisNode",ere=["Node"],tre=ee(vm,ere,t=>{var{Node:e}=t;class r extends e{constructor(i){if(super(),!Zr(i))throw new TypeError('Node expected for parameter "content"');this.content=i}get type(){return vm}get isParenthesisNode(){return!0}_compile(i,a){return this.content._compile(i,a)}getContent(){return this.content.getContent()}forEach(i){i(this.content,"content",this)}map(i){var a=i(this.content,"content",this);return new r(a)}clone(){return new r(this.content)}_toString(i){return!i||i&&!i.parenthesis||i&&i.parenthesis==="keep"?"("+this.content.toString(i)+")":this.content.toString(i)}toJSON(){return{mathjs:vm,content:this.content}}static fromJSON(i){return new r(i.content)}_toHTML(i){return!i||i&&!i.parenthesis||i&&i.parenthesis==="keep"?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(i)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(i)}_toTex(i){return!i||i&&!i.parenthesis||i&&i.parenthesis==="keep"?"\\left(".concat(this.content.toTex(i),"\\right)"):this.content.toTex(i)}}return Gn(r,"name",vm),r},{isClass:!0,isNode:!0}),gm="RangeNode",rre=["Node"],nre=ee(gm,rre,t=>{var{Node:e}=t;function r(i,a,s){var o=en(i,a,s),l={},u=en(i.start,a,s);if(l.start=u!==null&&u<=o||a==="all",i.step){var c=en(i.step,a,s);l.step=c!==null&&c<=o||a==="all"}var f=en(i.end,a,s);return l.end=f!==null&&f<=o||a==="all",l}class n extends e{constructor(a,s,o){if(super(),!Zr(a))throw new TypeError("Node expected");if(!Zr(s))throw new TypeError("Node expected");if(o&&!Zr(o))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=a,this.end=s,this.step=o||null}get type(){return gm}get isRangeNode(){return!0}needsEnd(){var a=this.filter(function(s){return fi(s)&&s.name==="end"});return a.length>0}_compile(a,s){var o=a.range,l=this.start._compile(a,s),u=this.end._compile(a,s);if(this.step){var c=this.step._compile(a,s);return function(h,p,m){return o(l(h,p,m),u(h,p,m),c(h,p,m))}}else return function(h,p,m){return o(l(h,p,m),u(h,p,m))}}forEach(a){a(this.start,"start",this),a(this.end,"end",this),this.step&&a(this.step,"step",this)}map(a){return new n(this._ifNode(a(this.start,"start",this)),this._ifNode(a(this.end,"end",this)),this.step&&this._ifNode(a(this.step,"step",this)))}clone(){return new n(this.start,this.end,this.step&&this.step)}_toString(a){var s=a&&a.parenthesis?a.parenthesis:"keep",o=r(this,s,a&&a.implicit),l,u=this.start.toString(a);if(o.start&&(u="("+u+")"),l=u,this.step){var c=this.step.toString(a);o.step&&(c="("+c+")"),l+=":"+c}var f=this.end.toString(a);return o.end&&(f="("+f+")"),l+=":"+f,l}toJSON(){return{mathjs:gm,start:this.start,end:this.end,step:this.step}}static fromJSON(a){return new n(a.start,a.end,a.step)}_toHTML(a){var s=a&&a.parenthesis?a.parenthesis:"keep",o=r(this,s,a&&a.implicit),l,u=this.start.toHTML(a);if(o.start&&(u='<span class="math-parenthesis math-round-parenthesis">(</span>'+u+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l=u,this.step){var c=this.step.toHTML(a);o.step&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+='<span class="math-operator math-range-operator">:</span>'+c}var f=this.end.toHTML(a);return o.end&&(f='<span class="math-parenthesis math-round-parenthesis">(</span>'+f+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+='<span class="math-operator math-range-operator">:</span>'+f,l}_toTex(a){var s=a&&a.parenthesis?a.parenthesis:"keep",o=r(this,s,a&&a.implicit),l=this.start.toTex(a);if(o.start&&(l="\\left(".concat(l,"\\right)")),this.step){var u=this.step.toTex(a);o.step&&(u="\\left(".concat(u,"\\right)")),l+=":"+u}var c=this.end.toTex(a);return o.end&&(c="\\left(".concat(c,"\\right)")),l+=":"+c,l}}return Gn(n,"name",gm),n},{isClass:!0,isNode:!0}),ym="RelationalNode",ire=["Node"],are=ee(ym,ire,t=>{var{Node:e}=t,r={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="};class n extends e{constructor(a,s){if(super(),!Array.isArray(a))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(s))throw new TypeError("Parameter params must be an array");if(a.length!==s.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");this.conditionals=a,this.params=s}get type(){return ym}get isRelationalNode(){return!0}_compile(a,s){var o=this,l=this.params.map(u=>u._compile(a,s));return function(c,f,h){for(var p,m=l[0](c,f,h),v=0;v<o.conditionals.length;v++){p=m,m=l[v+1](c,f,h);var y=Vi(a,o.conditionals[v]);if(!y(p,m))return!1}return!0}}forEach(a){this.params.forEach((s,o)=>a(s,"params["+o+"]",this),this)}map(a){return new n(this.conditionals.slice(),this.params.map((s,o)=>this._ifNode(a(s,"params["+o+"]",this)),this))}clone(){return new n(this.conditionals,this.params)}_toString(a){for(var s=a&&a.parenthesis?a.parenthesis:"keep",o=en(this,s,a&&a.implicit),l=this.params.map(function(f,h){var p=en(f,s,a&&a.implicit);return s==="all"||p!==null&&p<=o?"("+f.toString(a)+")":f.toString(a)}),u=l[0],c=0;c<this.conditionals.length;c++)u+=" "+r[this.conditionals[c]],u+=" "+l[c+1];return u}toJSON(){return{mathjs:ym,conditionals:this.conditionals,params:this.params}}static fromJSON(a){return new n(a.conditionals,a.params)}_toHTML(a){for(var s=a&&a.parenthesis?a.parenthesis:"keep",o=en(this,s,a&&a.implicit),l=this.params.map(function(f,h){var p=en(f,s,a&&a.implicit);return s==="all"||p!==null&&p<=o?'<span class="math-parenthesis math-round-parenthesis">(</span>'+f.toHTML(a)+'<span class="math-parenthesis math-round-parenthesis">)</span>':f.toHTML(a)}),u=l[0],c=0;c<this.conditionals.length;c++)u+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+ts(r[this.conditionals[c]])+"</span>"+l[c+1];return u}_toTex(a){for(var s=a&&a.parenthesis?a.parenthesis:"keep",o=en(this,s,a&&a.implicit),l=this.params.map(function(f,h){var p=en(f,s,a&&a.implicit);return s==="all"||p!==null&&p<=o?"\\left("+f.toTex(a)+"\right)":f.toTex(a)}),u=l[0],c=0;c<this.conditionals.length;c++)u+=$r[this.conditionals[c]]+l[c+1];return u}}return Gn(n,"name",ym),n},{isClass:!0,isNode:!0}),sre="SymbolNode",ore=["math","?Unit","Node"],ure=ee(sre,ore,t=>{var{math:e,Unit:r,Node:n}=t;function i(s){return r?r.isValuelessUnit(s):!1}class a extends n{constructor(o){if(super(),typeof o!="string")throw new TypeError('String expected for parameter "name"');this.name=o}get type(){return"SymbolNode"}get isSymbolNode(){return!0}_compile(o,l){var u=this.name;if(l[u]===!0)return function(f,h,p){return Vi(h,u)};if(u in o)return function(f,h,p){return f.has(u)?f.get(u):Vi(o,u)};var c=i(u);return function(f,h,p){return f.has(u)?f.get(u):c?new r(null,u):a.onUndefinedSymbol(u)}}forEach(o){}map(o){return this.clone()}static onUndefinedSymbol(o){throw new Error("Undefined symbol "+o)}clone(){return new a(this.name)}_toString(o){return this.name}_toHTML(o){var l=ts(this.name);return l==="true"||l==="false"?'<span class="math-symbol math-boolean">'+l+"</span>":l==="i"?'<span class="math-symbol math-imaginary-symbol">'+l+"</span>":l==="Infinity"?'<span class="math-symbol math-infinity-symbol">'+l+"</span>":l==="NaN"?'<span class="math-symbol math-nan-symbol">'+l+"</span>":l==="null"?'<span class="math-symbol math-null-symbol">'+l+"</span>":l==="undefined"?'<span class="math-symbol math-undefined-symbol">'+l+"</span>":'<span class="math-symbol">'+l+"</span>"}toJSON(){return{mathjs:"SymbolNode",name:this.name}}static fromJSON(o){return new a(o.name)}_toTex(o){var l=!1;typeof e[this.name]>"u"&&i(this.name)&&(l=!0);var u=PF(this.name,l);return u[0]==="\\"?u:" "+u}}return a},{isClass:!0,isNode:!0}),bm="FunctionNode",lre=["math","Node","SymbolNode"],cre=ee(bm,lre,t=>{var e,{math:r,Node:n,SymbolNode:i}=t,a=l=>yr(l,{truncate:78});function s(l,u,c){for(var f="",h=/\$(?:\{([a-z_][a-z_0-9]*)(?:\[([0-9]+)\])?\}|\$)/gi,p=0,m;(m=h.exec(l))!==null;)if(f+=l.substring(p,m.index),p=m.index,m[0]==="$$")f+="$",p++;else{p+=m[0].length;var v=u[m[1]];if(!v)throw new ReferenceError("Template: Property "+m[1]+" does not exist.");if(m[2]===void 0)switch(typeof v){case"string":f+=v;break;case"object":if(Zr(v))f+=v.toTex(c);else if(Array.isArray(v))f+=v.map(function(y,x){if(Zr(y))return y.toTex(c);throw new TypeError("Template: "+m[1]+"["+x+"] is not a Node.")}).join(",");else throw new TypeError("Template: "+m[1]+" has to be a Node, String or array of Nodes");break;default:throw new TypeError("Template: "+m[1]+" has to be a Node, String or array of Nodes")}else if(Zr(v[m[2]]&&v[m[2]]))f+=v[m[2]].toTex(c);else throw new TypeError("Template: "+m[1]+"["+m[2]+"] is not a Node.")}return f+=l.slice(p),f}class o extends n{constructor(u,c){if(super(),typeof u=="string"&&(u=new i(u)),!Zr(u))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(c)||!c.every(Zr))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=u,this.args=c||[]}get name(){return this.fn.name||""}get type(){return bm}get isFunctionNode(){return!0}_compile(u,c){var f=this.args.map(M=>M._compile(u,c));if(fi(this.fn)){var h=this.fn.name;if(c[h]){var x=this.args;return function(N,I,F){var P=Vi(I,h);if(typeof P!="function")throw new TypeError("Argument '".concat(h,"' was not a function; received: ").concat(a(P)));if(P.rawArgs)return P(x,u,pd(N,I));var U=f.map(G=>G(N,I,F));return P.apply(P,U)}}else{var p=h in u?Vi(u,h):void 0,m=typeof p=="function"&&p.rawArgs===!0,v=M=>{var N;if(M.has(h))N=M.get(h);else if(h in u)N=Vi(u,h);else return o.onUndefinedFunction(h);if(typeof N=="function")return N;throw new TypeError("'".concat(h,`' is not a function; its value is:
  `).concat(a(N)))};if(m){var y=this.args;return function(N,I,F){var P=v(N);if(P.rawArgs===!0)return P(y,u,pd(N,I));var U=f.map(G=>G(N,I,F));return P(...U)}}else switch(f.length){case 0:return function(N,I,F){var P=v(N);return P()};case 1:return function(N,I,F){var P=v(N),U=f[0];return P(U(N,I,F))};case 2:return function(N,I,F){var P=v(N),U=f[0],G=f[1];return P(U(N,I,F),G(N,I,F))};default:return function(N,I,F){var P=v(N),U=f.map(G=>G(N,I,F));return P(...U)}}}}else if(wc(this.fn)&&wh(this.fn.index)&&this.fn.index.isObjectProperty()){var S=this.fn.object._compile(u,c),b=this.fn.index.getObjectProperty(),A=this.args;return function(N,I,F){var P=S(N,I,F),U=$H(P,b);if(U!=null&&U.rawArgs)return U(A,u,pd(N,I));var G=f.map(V=>V(N,I,F));return U.apply(P,G)}}else{var E=this.fn.toString(),_=this.fn._compile(u,c),T=this.args;return function(N,I,F){var P=_(N,I,F);if(typeof P!="function")throw new TypeError("Expression '".concat(E,"' did not evaluate to a function; value is:")+`
  `.concat(a(P)));if(P.rawArgs)return P(T,u,pd(N,I));var U=f.map(G=>G(N,I,F));return P.apply(P,U)}}}forEach(u){u(this.fn,"fn",this);for(var c=0;c<this.args.length;c++)u(this.args[c],"args["+c+"]",this)}map(u){for(var c=this._ifNode(u(this.fn,"fn",this)),f=[],h=0;h<this.args.length;h++)f[h]=this._ifNode(u(this.args[h],"args["+h+"]",this));return new o(c,f)}clone(){return new o(this.fn,this.args.slice(0))}toString(u){var c,f=this.fn.toString(u);return u&&typeof u.handler=="object"&&Ft(u.handler,f)&&(c=u.handler[f](this,u)),typeof c<"u"?c:super.toString(u)}_toString(u){var c=this.args.map(function(h){return h.toString(u)}),f=Gd(this.fn)?"("+this.fn.toString(u)+")":this.fn.toString(u);return f+"("+c.join(", ")+")"}toJSON(){return{mathjs:bm,fn:this.fn,args:this.args}}_toHTML(u){var c=this.args.map(function(f){return f.toHTML(u)});return'<span class="math-function">'+ts(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+c.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}toTex(u){var c;return u&&typeof u.handler=="object"&&Ft(u.handler,this.name)&&(c=u.handler[this.name](this,u)),typeof c<"u"?c:super.toTex(u)}_toTex(u){var c=this.args.map(function(p){return p.toTex(u)}),f;$C[this.name]&&(f=$C[this.name]),r[this.name]&&(typeof r[this.name].toTex=="function"||typeof r[this.name].toTex=="object"||typeof r[this.name].toTex=="string")&&(f=r[this.name].toTex);var h;switch(typeof f){case"function":h=f(this,u);break;case"string":h=s(f,this,u);break;case"object":switch(typeof f[c.length]){case"function":h=f[c.length](this,u);break;case"string":h=s(f[c.length],this,u);break}}return typeof h<"u"?h:s(qte,this,u)}getIdentifier(){return this.type+":"+this.name}}return e=o,Gn(o,"name",bm),Gn(o,"onUndefinedFunction",function(l){throw new Error("Undefined function "+l)}),Gn(o,"fromJSON",function(l){return new e(l.fn,l.args)}),o},{isClass:!0,isNode:!0}),LC="parse",fre=["typed","numeric","config","AccessorNode","ArrayNode","AssignmentNode","BlockNode","ConditionalNode","ConstantNode","FunctionAssignmentNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","RangeNode","RelationalNode","SymbolNode"],hre=ee(LC,fre,t=>{var{typed:e,numeric:r,config:n,AccessorNode:i,ArrayNode:a,AssignmentNode:s,BlockNode:o,ConditionalNode:l,ConstantNode:u,FunctionAssignmentNode:c,FunctionNode:f,IndexNode:h,ObjectNode:p,OperatorNode:m,ParenthesisNode:v,RangeNode:y,RelationalNode:x,SymbolNode:S}=t,b=e(LC,{string:function(ge){return me(ge,{})},"Array | Matrix":function(ge){return A(ge,{})},"string, Object":function(ge,Le){var rt=Le.nodes!==void 0?Le.nodes:{};return me(ge,rt)},"Array | Matrix, Object":A});function A(R){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Le=ge.nodes!==void 0?ge.nodes:{};return ur(R,function(rt){if(typeof rt!="string")throw new TypeError("String expected");return me(rt,Le)})}var E={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},_={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},T={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},M={true:!0,false:!1,null:null,undefined:void 0},N=["NaN","Infinity"],I={'"':'"',"'":"'","\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function F(){return{extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:E.NULL,nestingLevel:0,conditionalLevel:null}}function P(R,ge){return R.expression.substr(R.index,ge)}function U(R){return P(R,1)}function G(R){R.index++}function V(R){return R.expression.charAt(R.index-1)}function $(R){return R.expression.charAt(R.index+1)}function j(R){for(R.tokenType=E.NULL,R.token="",R.comment="";;){if(U(R)==="#")for(;U(R)!==`
`&&U(R)!=="";)R.comment+=U(R),G(R);if(b.isWhitespace(U(R),R.nestingLevel))G(R);else break}if(U(R)===""){R.tokenType=E.DELIMITER;return}if(U(R)===`
`&&!R.nestingLevel){R.tokenType=E.DELIMITER,R.token=U(R),G(R);return}var ge=U(R),Le=P(R,2),rt=P(R,3);if(rt.length===3&&_[rt]){R.tokenType=E.DELIMITER,R.token=rt,G(R),G(R),G(R);return}if(Le.length===2&&_[Le]){R.tokenType=E.DELIMITER,R.token=Le,G(R),G(R);return}if(_[ge]){R.tokenType=E.DELIMITER,R.token=ge,G(R);return}if(b.isDigitDot(ge)){R.tokenType=E.NUMBER;var Xe=P(R,2);if(Xe==="0b"||Xe==="0o"||Xe==="0x"){for(R.token+=U(R),G(R),R.token+=U(R),G(R);b.isHexDigit(U(R));)R.token+=U(R),G(R);if(U(R)===".")for(R.token+=".",G(R);b.isHexDigit(U(R));)R.token+=U(R),G(R);else if(U(R)==="i")for(R.token+="i",G(R);b.isDigit(U(R));)R.token+=U(R),G(R);return}if(U(R)==="."){if(R.token+=U(R),G(R),!b.isDigit(U(R))){R.tokenType=E.DELIMITER;return}}else{for(;b.isDigit(U(R));)R.token+=U(R),G(R);b.isDecimalMark(U(R),$(R))&&(R.token+=U(R),G(R))}for(;b.isDigit(U(R));)R.token+=U(R),G(R);if(U(R)==="E"||U(R)==="e"){if(b.isDigit($(R))||$(R)==="-"||$(R)==="+"){if(R.token+=U(R),G(R),(U(R)==="+"||U(R)==="-")&&(R.token+=U(R),G(R)),!b.isDigit(U(R)))throw Ot(R,'Digit expected, got "'+U(R)+'"');for(;b.isDigit(U(R));)R.token+=U(R),G(R);if(b.isDecimalMark(U(R),$(R)))throw Ot(R,'Digit expected, got "'+U(R)+'"')}else if(b.isDecimalMark($(R),R.expression.charAt(R.index+2)))throw G(R),Ot(R,'Digit expected, got "'+U(R)+'"')}return}if(b.isAlpha(U(R),V(R),$(R))){for(;b.isAlpha(U(R),V(R),$(R))||b.isDigit(U(R));)R.token+=U(R),G(R);Ft(T,R.token)?R.tokenType=E.DELIMITER:R.tokenType=E.SYMBOL;return}for(R.tokenType=E.UNKNOWN;U(R)!=="";)R.token+=U(R),G(R);throw Ot(R,'Syntax error in part "'+R.token+'"')}function k(R){do j(R);while(R.token===`
`)}function Z(R){R.nestingLevel++}function z(R){R.nestingLevel--}b.isAlpha=function(ge,Le,rt){return b.isValidLatinOrGreek(ge)||b.isValidMathSymbol(ge,rt)||b.isValidMathSymbol(Le,ge)},b.isValidLatinOrGreek=function(ge){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(ge)},b.isValidMathSymbol=function(ge,Le){return/^[\uD835]$/.test(ge)&&/^[\uDC00-\uDFFF]$/.test(Le)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(Le)},b.isWhitespace=function(ge,Le){return ge===" "||ge==="	"||ge===`
`&&Le>0},b.isDecimalMark=function(ge,Le){return ge==="."&&Le!=="/"&&Le!=="*"&&Le!=="^"},b.isDigitDot=function(ge){return ge>="0"&&ge<="9"||ge==="."},b.isDigit=function(ge){return ge>="0"&&ge<="9"},b.isHexDigit=function(ge){return ge>="0"&&ge<="9"||ge>="a"&&ge<="f"||ge>="A"&&ge<="F"};function me(R,ge){var Le=F();Zn(Le,{expression:R,extraNodes:ge}),j(Le);var rt=fe(Le);if(Le.token!=="")throw Le.tokenType===E.DELIMITER?fr(Le,"Unexpected operator "+Le.token):Ot(Le,'Unexpected part "'+Le.token+'"');return rt}function fe(R){var ge,Le=[],rt;for(R.token!==""&&R.token!==`
`&&R.token!==";"&&(ge=ue(R),R.comment&&(ge.comment=R.comment));R.token===`
`||R.token===";";)Le.length===0&&ge&&(rt=R.token!==";",Le.push({node:ge,visible:rt})),j(R),R.token!==`
`&&R.token!==";"&&R.token!==""&&(ge=ue(R),R.comment&&(ge.comment=R.comment),rt=R.token!==";",Le.push({node:ge,visible:rt}));return Le.length>0?new o(Le):(ge||(ge=new u(void 0),R.comment&&(ge.comment=R.comment)),ge)}function ue(R){var ge,Le,rt,Xe,qt=le(R);if(R.token==="="){if(fi(qt))return ge=qt.name,k(R),rt=ue(R),new s(new S(ge),rt);if(wc(qt))return k(R),rt=ue(R),new s(qt.object,qt.index,rt);if(hl(qt)&&fi(qt.fn)&&(Xe=!0,Le=[],ge=qt.name,qt.args.forEach(function(pn,fs){fi(pn)?Le[fs]=pn.name:Xe=!1}),Xe))return k(R),rt=ue(R),new c(ge,Le,rt);throw Ot(R,"Invalid left hand side of assignment operator =")}return qt}function le(R){for(var ge=ke(R);R.token==="?";){var Le=R.conditionalLevel;R.conditionalLevel=R.nestingLevel,k(R);var rt=ge,Xe=ue(R);if(R.token!==":")throw Ot(R,"False part of conditional expression expected");R.conditionalLevel=null,k(R);var qt=ue(R);ge=new l(rt,Xe,qt),R.conditionalLevel=Le}return ge}function ke(R){for(var ge=Me(R);R.token==="or";)k(R),ge=new m("or","or",[ge,Me(R)]);return ge}function Me(R){for(var ge=Se(R);R.token==="xor";)k(R),ge=new m("xor","xor",[ge,Se(R)]);return ge}function Se(R){for(var ge=oe(R);R.token==="and";)k(R),ge=new m("and","and",[ge,oe(R)]);return ge}function oe(R){for(var ge=K(R);R.token==="|";)k(R),ge=new m("|","bitOr",[ge,K(R)]);return ge}function K(R){for(var ge=de(R);R.token==="^|";)k(R),ge=new m("^|","bitXor",[ge,de(R)]);return ge}function de(R){for(var ge=_e(R);R.token==="&";)k(R),ge=new m("&","bitAnd",[ge,_e(R)]);return ge}function _e(R){for(var ge=[be(R)],Le=[],rt={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};Ft(rt,R.token);){var Xe={name:R.token,fn:rt[R.token]};Le.push(Xe),k(R),ge.push(be(R))}return ge.length===1?ge[0]:ge.length===2?new m(Le[0].name,Le[0].fn,ge):new x(Le.map(qt=>qt.fn),ge)}function be(R){var ge,Le,rt,Xe;ge=$e(R);for(var qt={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};Ft(qt,R.token);)Le=R.token,rt=qt[Le],k(R),Xe=[ge,$e(R)],ge=new m(Le,rt,Xe);return ge}function $e(R){var ge,Le,rt,Xe;ge=Oe(R);for(var qt={to:"to",in:"to"};Ft(qt,R.token);)Le=R.token,rt=qt[Le],k(R),Le==="in"&&"])},;".includes(R.token)?ge=new m("*","multiply",[ge,new S("in")],!0):(Xe=[ge,Oe(R)],ge=new m(Le,rt,Xe));return ge}function Oe(R){var ge,Le=[];if(R.token===":"?ge=new u(1):ge=Qe(R),R.token===":"&&R.conditionalLevel!==R.nestingLevel){for(Le.push(ge);R.token===":"&&Le.length<3;)k(R),R.token===")"||R.token==="]"||R.token===","||R.token===""?Le.push(new S("end")):Le.push(Qe(R));Le.length===3?ge=new y(Le[0],Le[2],Le[1]):ge=new y(Le[0],Le[1])}return ge}function Qe(R){var ge,Le,rt,Xe;ge=ae(R);for(var qt={"+":"add","-":"subtract"};Ft(qt,R.token);){Le=R.token,rt=qt[Le],k(R);var pn=ae(R);pn.isPercentage?Xe=[ge,new m("*","multiply",[ge,pn])]:Xe=[ge,pn],ge=new m(Le,rt,Xe)}return ge}function ae(R){var ge,Le,rt,Xe;ge=ce(R),Le=ge;for(var qt={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};Ft(qt,R.token);)if(rt=R.token,Xe=qt[rt],k(R),rt==="%"&&R.tokenType===E.DELIMITER&&R.token!=="(")if(R.token!==""&&qt[R.token]){var pn=new m("/","divide",[ge,new u(100)],!1,!0);rt=R.token,Xe=qt[rt],k(R),Le=ce(R),ge=new m(rt,Xe,[pn,Le])}else ge=new m("/","divide",[ge,new u(100)],!1,!0);else Le=ce(R),ge=new m(rt,Xe,[ge,Le]);return ge}function ce(R){var ge,Le;for(ge=Ce(R),Le=ge;R.tokenType===E.SYMBOL||R.token==="in"&&Mr(ge)||R.token==="in"&&Rn(ge)&&ge.fn==="unaryMinus"&&Mr(ge.args[0])||R.tokenType===E.NUMBER&&!Mr(Le)&&(!Rn(Le)||Le.op==="!")||R.token==="(";)Le=Ce(R),ge=new m("*","multiply",[ge,Le],!0);return ge}function Ce(R){for(var ge=Ue(R),Le=ge,rt=[];R.token==="/"&&B1(Le);)if(rt.push(Zn({},R)),k(R),R.tokenType===E.NUMBER)if(rt.push(Zn({},R)),k(R),R.tokenType===E.SYMBOL||R.token==="("||R.token==="in")Zn(R,rt.pop()),rt.pop(),Le=Ue(R),ge=new m("/","divide",[ge,Le]);else{rt.pop(),Zn(R,rt.pop());break}else{Zn(R,rt.pop());break}return ge}function Ue(R){var ge,Le,rt,Xe={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return Ft(Xe,R.token)?(rt=Xe[R.token],ge=R.token,k(R),Le=[Ue(R)],new m(ge,rt,Le)):Ve(R)}function Ve(R){var ge,Le,rt,Xe;return ge=je(R),(R.token==="^"||R.token===".^")&&(Le=R.token,rt=Le==="^"?"pow":"dotPow",k(R),Xe=[ge,Ue(R)],ge=new m(Le,rt,Xe)),ge}function je(R){var ge,Le,rt,Xe;ge=ht(R);for(var qt={"!":"factorial","'":"ctranspose"};Ft(qt,R.token);)Le=R.token,rt=qt[Le],j(R),Xe=[ge],ge=new m(Le,rt,Xe),ge=we(R,ge);return ge}function ht(R){var ge=[];if(R.tokenType===E.SYMBOL&&Ft(R.extraNodes,R.token)){var Le=R.extraNodes[R.token];if(j(R),R.token==="("){if(ge=[],Z(R),j(R),R.token!==")")for(ge.push(ue(R));R.token===",";)j(R),ge.push(ue(R));if(R.token!==")")throw Ot(R,"Parenthesis ) expected");z(R),j(R)}return new Le(ge)}return re(R)}function re(R){var ge,Le;return R.tokenType===E.SYMBOL||R.tokenType===E.DELIMITER&&R.token in T?(Le=R.token,j(R),Ft(M,Le)?ge=new u(M[Le]):N.includes(Le)?ge=new u(r(Le,"number")):ge=new S(Le),ge=we(R,ge),ge):Ne(R)}function we(R,ge,Le){for(var rt;(R.token==="("||R.token==="["||R.token===".")&&!Le;)if(rt=[],R.token==="(")if(fi(ge)||wc(ge)){if(Z(R),j(R),R.token!==")")for(rt.push(ue(R));R.token===",";)j(R),rt.push(ue(R));if(R.token!==")")throw Ot(R,"Parenthesis ) expected");z(R),j(R),ge=new f(ge,rt)}else return ge;else if(R.token==="["){if(Z(R),j(R),R.token!=="]")for(rt.push(ue(R));R.token===",";)j(R),rt.push(ue(R));if(R.token!=="]")throw Ot(R,"Parenthesis ] expected");z(R),j(R),ge=new i(ge,new h(rt))}else{j(R);var Xe=R.tokenType===E.SYMBOL||R.tokenType===E.DELIMITER&&R.token in T;if(!Xe)throw Ot(R,"Property name expected after dot");rt.push(new u(R.token)),j(R);var qt=!0;ge=new i(ge,new h(rt,qt))}return ge}function Ne(R){var ge,Le;return R.token==='"'||R.token==="'"?(Le=Ge(R,R.token),ge=new u(Le),ge=we(R,ge),ge):He(R)}function Ge(R,ge){for(var Le="";U(R)!==""&&U(R)!==ge;)if(U(R)==="\\"){G(R);var rt=U(R),Xe=I[rt];if(Xe!==void 0)Le+=Xe,R.index+=1;else if(rt==="u"){var qt=R.expression.slice(R.index+1,R.index+5);if(/^[0-9A-Fa-f]{4}$/.test(qt))Le+=String.fromCharCode(parseInt(qt,16)),R.index+=5;else throw Ot(R,"Invalid unicode character \\u".concat(qt))}else throw Ot(R,"Bad escape character \\".concat(rt))}else Le+=U(R),G(R);if(j(R),R.token!==ge)throw Ot(R,"End of string ".concat(ge," expected"));return j(R),Le}function He(R){var ge,Le,rt,Xe;if(R.token==="["){if(Z(R),j(R),R.token!=="]"){var qt=We(R);if(R.token===";"){for(rt=1,Le=[qt];R.token===";";)j(R),R.token!=="]"&&(Le[rt]=We(R),rt++);if(R.token!=="]")throw Ot(R,"End of matrix ] expected");z(R),j(R),Xe=Le[0].items.length;for(var pn=1;pn<rt;pn++)if(Le[pn].items.length!==Xe)throw fr(R,"Column dimensions mismatch ("+Le[pn].items.length+" !== "+Xe+")");ge=new a(Le)}else{if(R.token!=="]")throw Ot(R,"End of matrix ] expected");z(R),j(R),ge=qt}}else z(R),j(R),ge=new a([]);return we(R,ge)}return ft(R)}function We(R){for(var ge=[ue(R)],Le=1;R.token===",";)j(R),R.token!=="]"&&R.token!==";"&&(ge[Le]=ue(R),Le++);return new a(ge)}function ft(R){if(R.token==="{"){Z(R);var ge,Le={};do if(j(R),R.token!=="}"){if(R.token==='"'||R.token==="'")ge=Ge(R,R.token);else if(R.tokenType===E.SYMBOL||R.tokenType===E.DELIMITER&&R.token in T)ge=R.token,j(R);else throw Ot(R,"Symbol or string expected as object key");if(R.token!==":")throw Ot(R,"Colon : expected after object key");j(R),Le[ge]=ue(R)}while(R.token===",");if(R.token!=="}")throw Ot(R,"Comma , or bracket } expected after object value");z(R),j(R);var rt=new p(Le);return rt=we(R,rt),rt}return st(R)}function st(R){var ge;if(R.tokenType===E.NUMBER){ge=R.token,j(R);var Le=bl(ge,n),rt=r(ge,Le);return new u(rt)}return dt(R)}function dt(R){var ge;if(R.token==="("){if(Z(R),j(R),ge=ue(R),R.token!==")")throw Ot(R,"Parenthesis ) expected");return z(R),j(R),ge=new v(ge),ge=we(R,ge),ge}return at(R)}function at(R){throw R.token===""?Ot(R,"Unexpected end of expression"):Ot(R,"Value expected")}function tr(R){return R.index-R.token.length+1}function Ot(R,ge){var Le=tr(R),rt=new SyntaxError(ge+" (char "+Le+")");return rt.char=Le,rt}function fr(R,ge){var Le=tr(R),rt=new SyntaxError(ge+" (char "+Le+")");return rt.char=Le,rt}return e.addConversion({from:"string",to:"Node",convert:b}),b}),UC="compile",dre=["typed","parse"],pre=ee(UC,dre,t=>{var{typed:e,parse:r}=t;return e(UC,{string:function(i){return r(i).compile()},"Array | Matrix":function(i){return ur(i,function(a){return r(a).compile()})}})}),zC="evaluate",mre=["typed","parse"],vre=ee(zC,mre,t=>{var{typed:e,parse:r}=t;return e(zC,{string:function(i){var a=Nd();return r(i).compile().evaluate(a)},"string, Map | Object":function(i,a){return r(i).compile().evaluate(a)},"Array | Matrix":function(i){var a=Nd();return ur(i,function(s){return r(s).compile().evaluate(a)})},"Array | Matrix, Map | Object":function(i,a){return ur(i,function(s){return r(s).compile().evaluate(a)})}})}),gre="Parser",yre=["evaluate","parse"],bre=ee(gre,yre,t=>{var{evaluate:e,parse:r}=t;function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");Object.defineProperty(this,"scope",{value:Nd(),writable:!1})}n.prototype.type="Parser",n.prototype.isParser=!0,n.prototype.evaluate=function(a){return e(a,this.scope)},n.prototype.get=function(a){if(this.scope.has(a))return this.scope.get(a)},n.prototype.getAll=function(){return zH(this.scope)},n.prototype.getAllAsMap=function(){return this.scope};function i(a){if(a.length===0)return!1;for(var s=0;s<a.length;s++){var o=a.charAt(s-1),l=a.charAt(s),u=a.charAt(s+1),c=r.isAlpha(l,o,u)||s>0&&r.isDigit(l);if(!c)return!1}return!0}return n.prototype.set=function(a,s){if(!i(a))throw new Error("Invalid variable name: '".concat(a,"'. Variable names must follow the specified rules."));return this.scope.set(a,s),s},n.prototype.remove=function(a){this.scope.delete(a)},n.prototype.clear=function(){this.scope.clear()},n},{isClass:!0}),GC="parser",xre=["typed","Parser"],wre=ee(GC,xre,t=>{var{typed:e,Parser:r}=t;return e(GC,{"":function(){return new r}})}),qC="lup",_re=["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],Are=ee(qC,_re,t=>{var{typed:e,matrix:r,abs:n,addScalar:i,divideScalar:a,multiplyScalar:s,subtractScalar:o,larger:l,equalScalar:u,unaryMinus:c,DenseMatrix:f,SparseMatrix:h,Spa:p}=t;return e(qC,{DenseMatrix:function(x){return m(x)},SparseMatrix:function(x){return v(x)},Array:function(x){var S=r(x),b=m(S);return{L:b.L.valueOf(),U:b.U.valueOf(),p:b.p}}});function m(y){var x=y._size[0],S=y._size[1],b=Math.min(x,S),A=rr(y._data),E=[],_=[x,b],T=[],M=[b,S],N,I,F,P=[];for(N=0;N<x;N++)P[N]=N;for(I=0;I<S;I++){if(I>0)for(N=0;N<x;N++){var U=Math.min(N,I),G=0;for(F=0;F<U;F++)G=i(G,s(A[N][F],A[F][I]));A[N][I]=o(A[N][I],G)}var V=I,$=0,j=0;for(N=I;N<x;N++){var k=A[N][I],Z=n(k);l(Z,$)&&(V=N,$=Z,j=k)}if(I!==V&&(P[I]=[P[V],P[V]=P[I]][0],f._swapRows(I,V,A)),I<x)for(N=I+1;N<x;N++){var z=A[N][I];u(z,0)||(A[N][I]=a(A[N][I],j))}}for(I=0;I<S;I++)for(N=0;N<x;N++){if(I===0&&(N<S&&(T[N]=[]),E[N]=[]),N<I){N<S&&(T[N][I]=A[N][I]),I<x&&(E[N][I]=0);continue}if(N===I){N<S&&(T[N][I]=A[N][I]),I<x&&(E[N][I]=1);continue}N<S&&(T[N][I]=0),I<x&&(E[N][I]=A[N][I])}var me=new f({data:E,size:_}),fe=new f({data:T,size:M}),ue=[];for(N=0,b=P.length;N<b;N++)ue[P[N]]=N;return{L:me,U:fe,p:ue,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}function v(y){var x=y._size[0],S=y._size[1],b=Math.min(x,S),A=y._values,E=y._index,_=y._ptr,T=[],M=[],N=[],I=[x,b],F=[],P=[],U=[],G=[b,S],V,$,j,k=[],Z=[];for(V=0;V<x;V++)k[V]=V,Z[V]=V;var z=function(ue,le){var ke=Z[ue],Me=Z[le];k[ke]=le,k[Me]=ue,Z[ue]=Me,Z[le]=ke},me=function(){var ue=new p;$<x&&(N.push(T.length),T.push(1),M.push($)),U.push(F.length);var le=_[$],ke=_[$+1];for(j=le;j<ke;j++)V=E[j],ue.set(k[V],A[j]);$>0&&ue.forEach(0,$-1,function(K,de){h._forEachRow(K,T,M,N,function(_e,be){_e>K&&ue.accumulate(_e,c(s(be,de)))})});var Me=$,Se=ue.get($),oe=n(Se);ue.forEach($+1,x-1,function(K,de){var _e=n(de);l(_e,oe)&&(Me=K,oe=_e,Se=de)}),$!==Me&&(h._swapRows($,Me,I[1],T,M,N),h._swapRows($,Me,G[1],F,P,U),ue.swap($,Me),z($,Me)),ue.forEach(0,x-1,function(K,de){K<=$?(F.push(de),P.push(K)):(de=a(de,Se),u(de,0)||(T.push(de),M.push(K)))})};for($=0;$<S;$++)me();return U.push(F.length),N.push(T.length),{L:new h({values:T,index:M,ptr:N,size:I}),U:new h({values:F,index:P,ptr:U,size:G}),p:k,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}}),HC="qr",Ere=["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],Sre=ee(HC,Ere,t=>{var{typed:e,matrix:r,zeros:n,identity:i,isZero:a,equal:s,sign:o,sqrt:l,conj:u,unaryMinus:c,addScalar:f,divideScalar:h,multiplyScalar:p,subtractScalar:m,complex:v}=t;return Zn(e(HC,{DenseMatrix:function(A){return x(A)},SparseMatrix:function(A){return S()},Array:function(A){var E=r(A),_=x(E);return{Q:_.Q.valueOf(),R:_.R.valueOf()}}}),{_denseQRimpl:y});function y(b){var A=b._size[0],E=b._size[1],_=i([A],"dense"),T=_._data,M=b.clone(),N=M._data,I,F,P,U=n([A],"");for(P=0;P<Math.min(E,A);++P){var G=N[P][P],V=c(s(G,0)?1:o(G)),$=u(V),j=0;for(I=P;I<A;I++)j=f(j,p(N[I][P],u(N[I][P])));var k=p(V,l(j));if(!a(k)){var Z=m(G,k);for(U[P]=1,I=P+1;I<A;I++)U[I]=h(N[I][P],Z);var z=c(u(h(Z,k))),me=void 0;for(F=P;F<E;F++){for(me=0,I=P;I<A;I++)me=f(me,p(u(U[I]),N[I][F]));for(me=p(me,z),I=P;I<A;I++)N[I][F]=p(m(N[I][F],p(U[I],me)),$)}for(I=0;I<A;I++){for(me=0,F=P;F<A;F++)me=f(me,p(T[I][F],U[F]));for(me=p(me,z),F=P;F<A;++F)T[I][F]=h(m(T[I][F],p(me,u(U[F]))),$)}}}return{Q:_,R:M,toString:function(){return"Q: "+this.Q.toString()+`
R: `+this.R.toString()}}}function x(b){var A=y(b),E=A.R._data;if(b._data.length>0)for(var _=E[0][0].type==="Complex"?v(0):0,T=0;T<E.length;++T)for(var M=0;M<T&&M<(E[0]||[]).length;++M)E[T][M]=_;return A}function S(b){throw new Error("qr not implemented for sparse matrices yet")}});function Dre(t,e,r,n){t._values;for(var i=t._index,a=t._ptr,s=t._size,o=t._datatype,l=s[0],u=s[1],c=null,f=[],h=[],p=0,m=0;m<u;m++){h[m]=p;for(var v=r?r[m]:m,y=a[v],x=a[v+1],S=y;S<x;S++){var b=i[S];f[p]=b,p++}}return h[u]=p,t.createSparseMatrix({values:c,index:f,ptr:h,size:[l,u],datatype:o})}function $F(t,e,r,n,i,a,s){var o=0;for(r[s]=t;o>=0;){var l=r[s+o],u=r[n+l];u===-1?(o--,a[e++]=l):(r[n+l]=r[i+u],++o,r[s+o]=u)}return e}function Cre(t,e){if(!t)return null;var r=0,n,i=[],a=[],s=0,o=e,l=2*e;for(n=0;n<e;n++)a[s+n]=-1;for(n=e-1;n>=0;n--)t[n]!==-1&&(a[o+n]=a[s+t[n]],a[s+t[n]]=n);for(n=0;n<e;n++)t[n]===-1&&(r=$F(n,r,a,s,o,i,l));return i}function Tre(t,e){if(!t)return null;var r=t._index,n=t._ptr,i=t._size,a=i[0],s=i[1],o=[],l=[],u=0,c=s,f,h;for(f=0;f<a;f++)l[c+f]=-1;for(var p=0;p<s;p++){o[p]=-1,l[u+p]=-1;for(var m=n[p],v=n[p+1],y=m;y<v;y++){var x=r[y];for(f=l[c+x];f!==-1&&f<p;f=h)h=l[u+f],l[u+f]=p,h===-1&&(o[f]=p);l[c+x]=p}}return o}function Nre(t,e,r){for(var n=t._values,i=t._index,a=t._ptr,s=t._size,o=s[1],l=0,u=0;u<o;u++){var c=a[u];for(a[u]=l;c<a[u+1];c++)e(i[c],u,n?n[c]:1,r)&&(i[l]=i[c],n&&(n[l]=n[c]),l++)}return a[o]=l,i.splice(l,i.length-l),n&&n.splice(l,n.length-l),l}function Ku(t){return-t-2}var Mre="csAmd",Ire=["add","multiply","transpose"],Fre=ee(Mre,Ire,t=>{var{add:e,multiply:r,transpose:n}=t;return function(c,f){if(!f||c<=0||c>3)return null;var h=f._size,p=h[0],m=h[1],v=0,y=Math.max(16,10*Math.sqrt(m));y=Math.min(m-2,y);var x=i(c,f,p,m,y);Nre(x,l,null);for(var S=x._index,b=x._ptr,A=b[m],E=[],_=[],T=0,M=m+1,N=2*(m+1),I=3*(m+1),F=4*(m+1),P=5*(m+1),U=6*(m+1),G=7*(m+1),V=E,$=a(m,b,_,T,I,V,N,G,M,U,F,P),j=s(m,b,_,P,F,U,y,M,I,V,N),k=0,Z,z,me,fe,ue,le,ke,Me,Se,oe,K,de,_e,be,$e,Oe;j<m;){for(me=-1;k<m&&(me=_[I+k])===-1;k++);_[N+me]!==-1&&(V[_[N+me]]=-1),_[I+k]=_[N+me];var Qe=_[F+me],ae=_[M+me];j+=ae;var ce=0;_[M+me]=-ae;var Ce=b[me],Ue=Qe===0?Ce:A,Ve=Ue;for(fe=1;fe<=Qe+1;fe++){for(fe>Qe?(le=me,ke=Ce,Me=_[T+me]-Qe):(le=S[Ce++],ke=b[le],Me=_[T+le]),ue=1;ue<=Me;ue++)Z=S[ke++],!((Se=_[M+Z])<=0)&&(ce+=Se,_[M+Z]=-Se,S[Ve++]=Z,_[N+Z]!==-1&&(V[_[N+Z]]=V[Z]),V[Z]!==-1?_[N+V[Z]]=_[N+Z]:_[I+_[P+Z]]=_[N+Z]);le!==me&&(b[le]=Ku(me),_[U+le]=0)}for(Qe!==0&&(A=Ve),_[P+me]=ce,b[me]=Ue,_[T+me]=Ve-Ue,_[F+me]=-2,$=o($,v,_,U,m),oe=Ue;oe<Ve;oe++)if(Z=S[oe],!((K=_[F+Z])<=0)){Se=-_[M+Z];var je=$-Se;for(Ce=b[Z],de=b[Z]+K-1;Ce<=de;Ce++)le=S[Ce],_[U+le]>=$?_[U+le]-=Se:_[U+le]!==0&&(_[U+le]=_[P+le]+je)}for(oe=Ue;oe<Ve;oe++){for(Z=S[oe],de=b[Z],_e=de+_[F+Z]-1,be=de,$e=0,Oe=0,Ce=de;Ce<=_e;Ce++)if(le=S[Ce],_[U+le]!==0){var ht=_[U+le]-$;ht>0?(Oe+=ht,S[be++]=le,$e+=le):(b[le]=Ku(me),_[U+le]=0)}_[F+Z]=be-de+1;var re=be,we=de+_[T+Z];for(Ce=_e+1;Ce<we;Ce++){z=S[Ce];var Ne=_[M+z];Ne<=0||(Oe+=Ne,S[be++]=z,$e+=z)}Oe===0?(b[Z]=Ku(me),Se=-_[M+Z],ce-=Se,ae+=Se,j+=Se,_[M+Z]=0,_[F+Z]=-1):(_[P+Z]=Math.min(_[P+Z],Oe),S[be]=S[re],S[re]=S[de],S[de]=me,_[T+Z]=be-de+1,$e=($e<0?-$e:$e)%m,_[N+Z]=_[G+$e],_[G+$e]=Z,V[Z]=$e)}for(_[P+me]=ce,v=Math.max(v,ce),$=o($+v,v,_,U,m),oe=Ue;oe<Ve;oe++)if(Z=S[oe],!(_[M+Z]>=0))for($e=V[Z],Z=_[G+$e],_[G+$e]=-1;Z!==-1&&_[N+Z]!==-1;Z=_[N+Z],$++){for(Me=_[T+Z],K=_[F+Z],Ce=b[Z]+1;Ce<=b[Z]+Me-1;Ce++)_[U+S[Ce]]=$;var Ge=Z;for(z=_[N+Z];z!==-1;){var He=_[T+z]===Me&&_[F+z]===K;for(Ce=b[z]+1;He&&Ce<=b[z]+Me-1;Ce++)_[U+S[Ce]]!==$&&(He=0);He?(b[z]=Ku(Z),_[M+Z]+=_[M+z],_[M+z]=0,_[F+z]=-1,z=_[N+z],_[N+Ge]=z):(Ge=z,z=_[N+z])}}for(Ce=Ue,oe=Ue;oe<Ve;oe++)Z=S[oe],!((Se=-_[M+Z])<=0)&&(_[M+Z]=Se,Oe=_[P+Z]+ce-Se,Oe=Math.min(Oe,m-j-Se),_[I+Oe]!==-1&&(V[_[I+Oe]]=Z),_[N+Z]=_[I+Oe],V[Z]=-1,_[I+Oe]=Z,k=Math.min(k,Oe),_[P+Z]=Oe,S[Ce++]=Z);_[M+me]=ae,(_[T+me]=Ce-Ue)===0&&(b[me]=-1,_[U+me]=0),Qe!==0&&(A=Ce)}for(Z=0;Z<m;Z++)b[Z]=Ku(b[Z]);for(z=0;z<=m;z++)_[I+z]=-1;for(z=m;z>=0;z--)_[M+z]>0||(_[N+z]=_[I+b[z]],_[I+b[z]]=z);for(le=m;le>=0;le--)_[M+le]<=0||b[le]!==-1&&(_[N+le]=_[I+b[le]],_[I+b[le]]=le);for(me=0,Z=0;Z<=m;Z++)b[Z]===-1&&(me=$F(Z,me,_,I,N,E,U));return E.splice(E.length-1,1),E};function i(u,c,f,h,p){var m=n(c);if(u===1&&h===f)return e(c,m);if(u===2){for(var v=m._index,y=m._ptr,x=0,S=0;S<f;S++){var b=y[S];if(y[S]=x,!(y[S+1]-b>p))for(var A=y[S+1];b<A;b++)v[x++]=v[b]}return y[f]=x,c=n(m),r(m,c)}return r(m,c)}function a(u,c,f,h,p,m,v,y,x,S,b,A){for(var E=0;E<u;E++)f[h+E]=c[E+1]-c[E];f[h+u]=0;for(var _=0;_<=u;_++)f[p+_]=-1,m[_]=-1,f[v+_]=-1,f[y+_]=-1,f[x+_]=1,f[S+_]=1,f[b+_]=0,f[A+_]=f[h+_];var T=o(0,0,f,S,u);return f[b+u]=-2,c[u]=-1,f[S+u]=0,T}function s(u,c,f,h,p,m,v,y,x,S,b){for(var A=0,E=0;E<u;E++){var _=f[h+E];if(_===0)f[p+E]=-2,A++,c[E]=-1,f[m+E]=0;else if(_>v)f[y+E]=0,f[p+E]=-1,A++,c[E]=Ku(u),f[y+u]++;else{var T=f[x+_];T!==-1&&(S[T]=E),f[b+E]=f[x+_],f[x+_]=E}}return A}function o(u,c,f,h,p){if(u<2||u+c<0){for(var m=0;m<p;m++)f[h+m]!==0&&(f[h+m]=1);u=2}return u}function l(u,c){return u!==c}});function Ore(t,e,r,n,i,a,s){var o,l,u=0,c;if(t<=e||r[n+e]<=r[i+t])return-1;r[i+t]=r[n+e];var f=r[a+t];if(r[a+t]=e,f===-1)u=1,c=t;else{for(u=2,c=f;c!==r[s+c];c=r[s+c]);for(o=f;o!==c;o=l)l=r[s+o],r[s+o]=c}return{jleaf:u,q:c}}var Bre="csCounts",Rre=["transpose"],Pre=ee(Bre,Rre,t=>{var{transpose:e}=t;return function(r,n,i,a){if(!r||!n||!i)return null;var s=r._size,o=s[0],l=s[1],u,c,f,h,p,m,v,y=4*l+(a?l+o+1:0),x=[],S=0,b=l,A=2*l,E=3*l,_=4*l,T=5*l+1;for(f=0;f<y;f++)x[f]=-1;var M=[],N=e(r),I=N._index,F=N._ptr;for(f=0;f<l;f++)for(c=i[f],M[c]=x[E+c]===-1?1:0;c!==-1&&x[E+c]===-1;c=n[c])x[E+c]=f;if(a){for(f=0;f<l;f++)x[i[f]]=f;for(u=0;u<o;u++){for(f=l,m=F[u],v=F[u+1],p=m;p<v;p++)f=Math.min(f,x[I[p]]);x[T+u]=x[_+f],x[_+f]=u}}for(u=0;u<l;u++)x[S+u]=u;for(f=0;f<l;f++){for(c=i[f],n[c]!==-1&&M[n[c]]--,h=a?x[_+f]:c;h!==-1;h=a?x[T+h]:-1)for(p=F[h];p<F[h+1];p++){u=I[p];var P=Ore(u,c,x,E,b,A,S);P.jleaf>=1&&M[c]++,P.jleaf===2&&M[P.q]--}n[c]!==-1&&(x[S+c]=n[c])}for(c=0;c<l;c++)n[c]!==-1&&(M[n[c]]+=M[c]);return M}}),$re="csSqr",kre=["add","multiply","transpose"],Lre=ee($re,kre,t=>{var{add:e,multiply:r,transpose:n}=t,i=Fre({add:e,multiply:r,transpose:n}),a=Pre({transpose:n});return function(l,u,c){var f=u._ptr,h=u._size,p=h[1],m,v={};if(v.q=i(l,u),l&&!v.q)return null;if(c){var y=l?Dre(u,null,v.q):u;v.parent=Tre(y);var x=Cre(v.parent,p);if(v.cp=a(y,v.parent,x,1),y&&v.parent&&v.cp&&s(y,v))for(v.unz=0,m=0;m<p;m++)v.unz+=v.cp[m]}else v.unz=4*f[p]+p,v.lnz=v.unz;return v};function s(o,l){var u=o._ptr,c=o._index,f=o._size,h=f[0],p=f[1];l.pinv=[],l.leftmost=[];var m=l.parent,v=l.pinv,y=l.leftmost,x=[],S=0,b=h,A=h+p,E=h+2*p,_,T,M,N,I;for(T=0;T<p;T++)x[b+T]=-1,x[A+T]=-1,x[E+T]=0;for(_=0;_<h;_++)y[_]=-1;for(T=p-1;T>=0;T--)for(N=u[T],I=u[T+1],M=N;M<I;M++)y[c[M]]=T;for(_=h-1;_>=0;_--)v[_]=-1,T=y[_],T!==-1&&(x[E+T]++===0&&(x[A+T]=_),x[S+_]=x[b+T],x[b+T]=_);for(l.lnz=0,l.m2=h,T=0;T<p;T++)if(_=x[b+T],l.lnz++,_<0&&(_=l.m2++),v[_]=T,!(--E[T]<=0)){l.lnz+=x[E+T];var F=m[T];F!==-1&&(x[E+F]===0&&(x[A+F]=x[A+T]),x[S+x[A+T]]=x[b+F],x[b+F]=x[S+_],x[E+F]+=x[E+T])}for(_=0;_<h;_++)v[_]<0&&(v[_]=T++);return!0}});function rb(t,e){return t[e]<0}function kF(t,e){t[e]=Ku(t[e])}function WC(t){return t<0?Ku(t):t}function Ure(t,e,r,n,i){var a=e._index,s=e._ptr,o=e._size,l=o[1],u,c,f,h=0;for(n[0]=t;h>=0;){t=n[h];var p=i?i[t]:t;rb(s,t)||(kF(s,t),n[l+h]=p<0?0:WC(s[p]));var m=1;for(c=n[l+h],f=p<0?0:WC(s[p+1]);c<f;c++)if(u=a[c],!rb(s,u)){n[l+h]=c,n[++h]=u,m=0;break}m&&(h--,n[--r]=t)}return r}function zre(t,e,r,n,i){var a=t._ptr,s=t._size,o=e._index,l=e._ptr,u=s[1],c,f,h,p=u;for(f=l[r],h=l[r+1],c=f;c<h;c++){var m=o[c];rb(a,m)||(p=Ure(m,t,p,n,i))}for(c=p;c<u;c++)kF(a,n[c]);return p}var Gre="csSpsolve",qre=["divideScalar","multiply","subtract"],Hre=ee(Gre,qre,t=>{var{divideScalar:e,multiply:r,subtract:n}=t;return function(a,s,o,l,u,c,f){var h=a._values,p=a._index,m=a._ptr,v=a._size,y=v[1],x=s._values,S=s._index,b=s._ptr,A,E,_,T,M=zre(a,s,o,l,c);for(A=M;A<y;A++)u[l[A]]=0;for(E=b[o],_=b[o+1],A=E;A<_;A++)u[S[A]]=x[A];for(var N=M;N<y;N++){var I=l[N],F=c?c[I]:I;if(!(F<0))for(E=m[F],_=m[F+1],u[I]=e(u[I],h[f?E:_-1]),A=f?E+1:E,T=f?_:_-1;A<T;A++){var P=p[A];u[P]=n(u[P],r(h[A],u[I]))}}return M}}),Wre="csLu",Vre=["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],Xre=ee(Wre,Vre,t=>{var{abs:e,divideScalar:r,multiply:n,subtract:i,larger:a,largerEq:s,SparseMatrix:o}=t,l=Hre({divideScalar:r,multiply:n,subtract:i});return function(c,f,h){if(!c)return null;var p=c._size,m=p[1],v,y=100,x=100;f&&(v=f.q,y=f.lnz||y,x=f.unz||x);var S=[],b=[],A=[],E=new o({values:S,index:b,ptr:A,size:[m,m]}),_=[],T=[],M=[],N=new o({values:_,index:T,ptr:M,size:[m,m]}),I=[],F,P,U=[],G=[];for(F=0;F<m;F++)U[F]=0,I[F]=-1,A[F+1]=0;y=0,x=0;for(var V=0;V<m;V++){A[V]=y,M[V]=x;var $=v?v[V]:V,j=l(E,c,$,G,U,I,1),k=-1,Z=-1;for(P=j;P<m;P++)if(F=G[P],I[F]<0){var z=e(U[F]);a(z,Z)&&(Z=z,k=F)}else T[x]=I[F],_[x++]=U[F];if(k===-1||Z<=0)return null;I[$]<0&&s(e(U[$]),n(Z,h))&&(k=$);var me=U[k];for(T[x]=V,_[x++]=me,I[k]=V,b[y]=k,S[y++]=1,P=j;P<m;P++)F=G[P],I[F]<0&&(b[y]=F,S[y++]=r(U[F],me)),U[F]=0}for(A[m]=y,M[m]=x,P=0;P<y;P++)b[P]=I[b[P]];return S.splice(y,S.length-y),b.splice(y,b.length-y),_.splice(x,_.length-x),T.splice(x,T.length-x),{L:E,U:N,pinv:I}}}),VC="slu",jre=["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],Yre=ee(VC,jre,t=>{var{typed:e,abs:r,add:n,multiply:i,transpose:a,divideScalar:s,subtract:o,larger:l,largerEq:u,SparseMatrix:c}=t,f=Lre({add:n,multiply:i,transpose:a}),h=Xre({abs:r,divideScalar:s,multiply:i,subtract:o,larger:l,largerEq:u,SparseMatrix:c});return e(VC,{"SparseMatrix, number, number":function(m,v,y){if(!Bt(v)||v<0||v>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(y<0||y>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var x=f(v,m,!1),S=h(m,x,y);return{L:S.L,U:S.U,p:S.pinv,q:x.q,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
p: `+this.p.toString()+(this.q?`
q: `+this.q.toString():"")+`
`}}}})});function XC(t,e){var r,n=e.length,i=[];if(t)for(r=0;r<n;r++)i[t[r]]=e[r];else for(r=0;r<n;r++)i[r]=e[r];return i}var jC="lusolve",Kre=["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],Zre=ee(jC,Kre,t=>{var{typed:e,matrix:r,lup:n,slu:i,usolve:a,lsolve:s,DenseMatrix:o}=t,l=Hd({DenseMatrix:o});return e(jC,{"Array, Array | Matrix":function(h,p){h=r(h);var m=n(h),v=c(m.L,m.U,m.p,null,p);return v.valueOf()},"DenseMatrix, Array | Matrix":function(h,p){var m=n(h);return c(m.L,m.U,m.p,null,p)},"SparseMatrix, Array | Matrix":function(h,p){var m=n(h);return c(m.L,m.U,m.p,null,p)},"SparseMatrix, Array | Matrix, number, number":function(h,p,m,v){var y=i(h,m,v);return c(y.L,y.U,y.p,y.q,p)},"Object, Array | Matrix":function(h,p){return c(h.L,h.U,h.p,h.q,p)}});function u(f){if(Gt(f))return f;if(Jr(f))return r(f);throw new TypeError("Invalid Matrix LU decomposition")}function c(f,h,p,m,v){f=u(f),h=u(h),p&&(v=l(f,v,!0),v._data=XC(p,v._data));var y=s(f,v),x=a(h,y);return m&&(x._data=XC(m,x._data)),x}}),YC="polynomialRoot",Qre=["typed","isZero","equalScalar","add","subtract","multiply","divide","sqrt","unaryMinus","cbrt","typeOf","im","re"],Jre=ee(YC,Qre,t=>{var{typed:e,isZero:r,equalScalar:n,add:i,subtract:a,multiply:s,divide:o,sqrt:l,unaryMinus:u,cbrt:c,typeOf:f,im:h,re:p}=t;return e(YC,{"number|Complex, ...number|Complex":(m,v)=>{for(var y=[m,...v];y.length>0&&r(y[y.length-1]);)y.pop();if(y.length<2)throw new RangeError("Polynomial [".concat(m,", ").concat(v,"] must have a non-zero non-constant coefficient"));switch(y.length){case 2:return[u(o(y[0],y[1]))];case 3:{var[x,S,b]=y,A=s(2,b),E=s(S,S),_=s(4,b,x);if(n(E,_))return[o(u(S),A)];var T=l(a(E,_));return[o(a(T,S),A),o(a(u(T),S),A)]}case 4:{var[M,N,I,F]=y,P=u(s(3,F)),U=s(I,I),G=s(3,F,N),V=i(s(2,I,I,I),s(27,F,F,M)),$=s(9,F,I,N);if(n(U,G)&&n(V,$))return[o(I,P)];var j=a(U,G),k=a(V,$),Z=i(s(18,F,I,N,M),s(I,I,N,N)),z=i(s(4,I,I,I,M),s(4,F,N,N,N),s(27,F,F,M,M));if(n(Z,z))return[o(a(s(4,F,I,N),i(s(9,F,F,M),s(I,I,I))),s(F,j)),o(a(s(9,F,M),s(I,N)),s(2,j))];var me;n(U,G)?me=k:me=o(i(k,l(a(s(k,k),s(4,j,j,j)))),2);var fe=!0,ue=c(me,fe).toArray().map(le=>o(i(I,le,o(j,le)),P));return ue.map(le=>f(le)==="Complex"&&n(p(le),p(le)+h(le))?p(le):le)}default:throw new RangeError("only implemented for cubic or lower-order polynomials, not ".concat(y))}}})}),ene="Help",tne=["evaluate"],rne=ee(ene,tne,t=>{var{evaluate:e}=t;function r(n){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(!n)throw new Error('Argument "doc" missing');this.doc=n}return r.prototype.type="Help",r.prototype.isHelp=!0,r.prototype.toString=function(){var n=this.doc||{},i=`
`;if(n.name&&(i+="Name: "+n.name+`

`),n.category&&(i+="Category: "+n.category+`

`),n.description&&(i+=`Description:
    `+n.description+`

`),n.syntax&&(i+=`Syntax:
    `+n.syntax.join(`
    `)+`

`),n.examples){i+=`Examples:
`;for(var a=!1,s=e("config()"),o={config:f=>(a=!0,e("config(newConfig)",{newConfig:f}))},l=0;l<n.examples.length;l++){var u=n.examples[l];i+="    "+u+`
`;var c=void 0;try{c=e(u,o)}catch(f){c=f}c!==void 0&&!WM(c)&&(i+="        "+yr(c,{precision:14})+`
`)}i+=`
`,a&&e("config(originalConfig)",{originalConfig:s})}return n.mayThrow&&n.mayThrow.length&&(i+="Throws: "+n.mayThrow.join(", ")+`

`),n.seealso&&n.seealso.length&&(i+="See also: "+n.seealso.join(", ")+`
`),i},r.prototype.toJSON=function(){var n=rr(this.doc);return n.mathjs="Help",n},r.fromJSON=function(n){var i={};return Object.keys(n).filter(a=>a!=="mathjs").forEach(a=>{i[a]=n[a]}),new r(i)},r.prototype.valueOf=r.prototype.toString,r},{isClass:!0}),nne="Chain",ine=["?on","math","typed"],ane=ee(nne,ine,t=>{var{on:e,math:r,typed:n}=t;function i(u){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");XM(u)?this.value=u.value:this.value=u}i.prototype.type="Chain",i.prototype.isChain=!0,i.prototype.done=function(){return this.value},i.prototype.valueOf=function(){return this.value},i.prototype.toString=function(){return yr(this.value)},i.prototype.toJSON=function(){return{mathjs:"Chain",value:this.value}},i.fromJSON=function(u){return new i(u.value)};function a(u,c){typeof c=="function"&&(i.prototype[u]=o(c))}function s(u,c){tW(i.prototype,u,function(){var h=c();if(typeof h=="function")return o(h)})}function o(u){return function(){if(arguments.length===0)return new i(u(this.value));for(var c=[this.value],f=0;f<arguments.length;f++)c[f+1]=arguments[f];if(n.isTypedFunction(u)){var h=n.resolve(u,c);if(h.params.length===1)throw new Error("chain function "+u.name+" cannot match rest parameter between chain value and additional arguments.");return new i(h.implementation.apply(u,c))}return new i(u.apply(u,c))}}i.createProxy=function(u,c){if(typeof u=="string")a(u,c);else{var f=function(m){Ft(u,m)&&l[m]===void 0&&s(m,()=>u[m])};for(var h in u)f(h)}};var l={expression:!0,docs:!0,type:!0,classes:!0,json:!0,error:!0,isChain:!0};return i.createProxy(r),e&&e("import",function(u,c,f){f||s(u,c)}),i},{isClass:!0}),KC={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]},sne={name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]},one={name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]},une={name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]},lne={name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]},cne={name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]},fne={name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]},hne={name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]},dne={name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]},pne={name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]},mne={name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["phi"],seealso:[]},ZC={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]},vne={name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]},gne={name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]},yne={name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]},bne={name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]},xne={name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]},wne={name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","bigint","complex","fraction","index","matrix","string","unit"]},_ne={name:"bigint",category:"Construction",syntax:["bigint(x)"],description:"Create a bigint, an integer with an arbitrary number of digits, from a number or string.",examples:["123123123123123123 # a large number will lose digits",'bigint("123123123123123123")','bignumber(["1", "3", "5"])'],seealso:["boolean","bignumber","number","complex","fraction","index","matrix","string","unit"]},Ane={name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]},Ene={name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]},Sne={name:"createUnit",category:"Construction",syntax:["createUnit(definitions)","createUnit(name, definition)"],description:"Create a user-defined unit and register it with the Unit type.",examples:['createUnit("foo")','createUnit("knot", {definition: "0.514444444 m/s", aliases: ["knots", "kt", "kts"]})','createUnit("mph", "1 mile/hour")'],seealso:["unit","splitUnit"]},Dne={name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(matrix)","fraction(num,den)","fraction({n: num, d: den})"],description:"Create a fraction from a number or from integer numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)","fraction({n: 333, d: 53})","fraction([sqrt(9), sqrt(10), sqrt(11)])"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]},Cne={name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[1:2, 1:2] = 1","B = [1, 2, 3]","B[B>1 and B<3]"],seealso:["bignumber","boolean","complex","matrix","number","range","string","unit"]},Tne={name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]},Nne={name:"number",category:"Construction",syntax:["x","number(x)","number(unit, valuelessUnit)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number(unit("52cm"), "m")'],seealso:["bignumber","bigint","boolean","complex","fraction","index","matrix","string","unit"]},Mne={name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]},Ine={name:"splitUnit",category:"Construction",syntax:["splitUnit(unit: Unit, parts: Unit[])"],description:"Split a unit in an array of units whose sum is equal to the original unit.",examples:['splitUnit(1 m, ["feet", "inch"])'],seealso:["unit","createUnit"]},Fne={name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]},One={name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]},Bne={name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]},Rne={name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]},Pne={name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number": f(x)=x+x, "string": f(x)=concat(x,x) })',"double(2)",'double("hello")'],seealso:[]},$ne={name:"derivative",category:"Algebra",syntax:["derivative(expr, variable)","derivative(expr, variable, {simplify: boolean})"],description:"Takes the derivative of an expression expressed in parser Nodes. The derivative will be taken over the supplied variable in the second parameter. If there are multiple variables in the expression, it will return a partial derivative.",examples:['derivative("2x^3", "x")','derivative("2x^3", "x", {simplify: false})','derivative("2x^2 + 3x + 4", "x")','derivative("sin(2x)", "x")','f = parse("x^2 + x")','x = parse("x")',"df = derivative(f, x)","df.evaluate({x: 3})"],seealso:["simplify","parse","evaluate"]},kne={name:"leafCount",category:"Algebra",syntax:["leafCount(expr)"],description:"Computes the number of leaves in the parse tree of the given expression",examples:['leafCount("e^(i*pi)-1")','leafCount(parse("{a: 22/7, b: 10^(1/2)}"))'],seealso:["simplify"]},Lne={name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Finds one solution of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolveAll","lup","lusolve","usolve","matrix","sparse"]},Une={name:"lsolveAll",category:"Algebra",syntax:["x=lsolveAll(L, b)"],description:"Finds all solutions of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolve","lup","lusolve","usolve","matrix","sparse"]},zne={name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu","qr"]},Gne={name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]},qne={name:"polynomialRoot",category:"Algebra",syntax:["x=polynomialRoot(-6, 3)","x=polynomialRoot(4, -4, 1)","x=polynomialRoot(-8, 12, -6, 1)"],description:"Finds the roots of a univariate polynomial given by its coefficients starting from constant, linear, and so on, increasing in degree.",examples:["a = polynomialRoot(-6, 11, -6, 1)"],seealso:["cbrt","sqrt"]},Hne={name:"qr",category:"Algebra",syntax:["qr(A)"],description:"Calculates the Matrix QR decomposition. Matrix `A` is decomposed in two matrices (`Q`, `R`) where `Q` is an orthogonal matrix and `R` is an upper triangular matrix.",examples:["qr([[1, -1,  4], [1,  4, -2], [1,  4,  2], [1,  -1, 0]])"],seealso:["lup","slu","matrix"]},Wne={name:"rationalize",category:"Algebra",syntax:["rationalize(expr)","rationalize(expr, scope)","rationalize(expr, scope, detailed)"],description:"Transform a rationalizable expression in a rational fraction. If rational fraction is one variable polynomial then converts the numerator and denominator in canonical form, with decreasing exponents, returning the coefficients of numerator.",examples:['rationalize("2x/y - y/(x+1)")','rationalize("2x/y - y/(x+1)", true)'],seealso:["simplify"]},Vne={name:"resolve",category:"Algebra",syntax:["resolve(node, scope)"],description:"Recursively substitute variables in an expression tree.",examples:['resolve(parse("1 + x"), { x: 7 })','resolve(parse("size(text)"), { text: "Hello World" })','resolve(parse("x + y"), { x: parse("3z") })','resolve(parse("3x"), { x: parse("y+z"), z: parse("w^y") })'],seealso:["simplify","evaluate"],mayThrow:["ReferenceError"]},Xne={name:"simplify",category:"Algebra",syntax:["simplify(expr)","simplify(expr, rules)"],description:"Simplify an expression tree.",examples:['simplify("3 + 2 / 4")','simplify("2x + x")','f = parse("x * (x + 2 + x)")',"simplified = simplify(f)","simplified.evaluate({x: 2})"],seealso:["simplifyCore","derivative","evaluate","parse","rationalize","resolve"]},jne={name:"simplifyConstant",category:"Algebra",syntax:["simplifyConstant(expr)","simplifyConstant(expr, options)"],description:"Replace constant subexpressions of node with their values.",examples:['simplifyConstant("(3-3)*x")','simplifyConstant(parse("z-cos(tau/8)"))'],seealso:["simplify","simplifyCore","evaluate"]},Yne={name:"simplifyCore",category:"Algebra",syntax:["simplifyCore(node)"],description:"Perform simple one-pass simplifications on an expression tree.",examples:['simplifyCore(parse("0*x"))','simplifyCore(parse("(x+0)*2"))'],seealso:["simplify","simplifyConstant","evaluate"]},Kne={name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup","qr"]},Zne={name:"symbolicEqual",category:"Algebra",syntax:["symbolicEqual(expr1, expr2)","symbolicEqual(expr1, expr2, options)"],description:"Returns true if the difference of the expressions simplifies to 0",examples:['symbolicEqual("x*y","y*x")','symbolicEqual("abs(x^2)", "x^2")','symbolicEqual("abs(x)", "x", {context: {abs: {trivial: true}}})'],seealso:["simplify","evaluate"]},Qne={name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds one solution of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolveAll","lup","lusolve","lsolve","matrix","sparse"]},Jne={name:"usolveAll",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds all solutions of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolve","lup","lusolve","lsolve","matrix","sparse"]},eie={name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]},tie={name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]},rie={name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]},nie={name:"ceil",category:"Arithmetic",syntax:["ceil(x)","ceil(x, n)","ceil(unit, valuelessUnit)","ceil(unit, n, valuelessUnit)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)","ceil(3.241cm, cm)","ceil(3.241cm, 2, cm)"],seealso:["floor","fix","round"]},iie={name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]},aie={name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]},sie={name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]},oie={name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]},uie={name:"dotPow",category:"Operators",syntax:["x .^ y","dotPow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]},lie={name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["expm","expm1","pow","log"]},cie={name:"expm",category:"Arithmetic",syntax:["exp(x)"],description:"Compute the matrix exponential, expm(A) = e^A. The matrix must be square. Not to be confused with exp(a), which performs element-wise exponentiation.",examples:["expm([[0,2],[0,0]])"],seealso:["exp"]},fie={name:"expm1",category:"Arithmetic",syntax:["expm1(x)"],description:"Calculate the value of subtracting 1 from the exponential value.",examples:["expm1(2)","pow(e, 2) - 1","log(expm1(2) + 1)"],seealso:["exp","pow","log"]},hie={name:"fix",category:"Arithmetic",syntax:["fix(x)","fix(x, n)","fix(unit, valuelessUnit)","fix(unit, n, valuelessUnit)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)","fix(3.241cm, cm)","fix(3.241cm, 2, cm)"],seealso:["ceil","floor","round"]},die={name:"floor",category:"Arithmetic",syntax:["floor(x)","floor(x, n)","floor(unit, valuelessUnit)","floor(unit, n, valuelessUnit)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)","floor(3.241cm, cm)","floor(3.241cm, 2, cm)"],seealso:["ceil","fix","round"]},pie={name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]},mie={name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenuse of a list with values.",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]},vie={name:"invmod",category:"Arithmetic",syntax:["invmod(a, b)"],description:"Calculate the (modular) multiplicative inverse of a modulo b. Solution to the equation ax ≣ 1 (mod b)",examples:["invmod(8, 12)","invmod(7, 13)","invmod(15151, 15122)"],seealso:["gcd","xgcd"]},gie={name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]},yie={name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log1p","log2","log10"]},bie={name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]},xie={name:"log1p",category:"Arithmetic",syntax:["log1p(x)","log1p(x, base)"],description:"Calculate the logarithm of a `value+1`",examples:["log1p(2.5)","exp(log1p(1.4))","pow(10, 4)","log1p(9999, 10)","log1p(9999) / log(10)"],seealso:["exp","log","log2","log10"]},wie={name:"log2",category:"Arithmetic",syntax:["log2(x)"],description:"Calculate the 2-base of a value. This is the same as calculating `log(x, 2)`.",examples:["log2(0.03125)","log2(16)","log2(16) / log2(2)","pow(2, 4)"],seealso:["exp","log1p","log","log10"]},_ie={name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]},Aie={name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]},Eie={name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i)","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)",'norm([[1, 2], [3, 4]], "inf")','norm([[1, 2], [3, 4]], "fro")']},Sie={name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["nthRoots","pow","sqrt"]},Die={name:"nthRoots",category:"Arithmetic",syntax:["nthRoots(A)","nthRoots(A, root)"],description:'Calculate the nth roots of a value. An nth root of a positive real number A, is a positive real solution of the equation "x^root = A". This function returns an array of complex values.',examples:["nthRoots(1)","nthRoots(1, 3)"],seealso:["sqrt","pow","nthRoot"]},Cie={name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3","2*2*2","1 + e ^ (pi * i)","pow([[1, 2], [4, 3]], 2)","pow([[1, 2], [4, 3]], -1)"],seealso:["multiply","nthRoot","nthRoots","sqrt"]},Tie={name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)","round(unit, valuelessUnit)","round(unit, n, valuelessUnit)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)","round(3.241cm, 2, cm)","round([3.2, 3.8, -4.7])"],seealso:["ceil","floor","fix"]},Nie={name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>0, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]},Mie={name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","sqrtm","multiply","nthRoot","nthRoots","pow"]},Iie={name:"sqrtm",category:"Arithmetic",syntax:["sqrtm(x)"],description:"Calculate the principal square root of a square matrix. The principal square root matrix `X` of another matrix `A` is such that `X * X = A`.",examples:["sqrtm([[33, 24], [48, 57]])"],seealso:["sqrt","abs","square","multiply"]},Fie={name:"sylvester",category:"Algebra",syntax:["sylvester(A,B,C)"],description:"Solves the real-valued Sylvester equation AX+XB=C for X",examples:["sylvester([[-1, -2], [1, 1]], [[-2, 1], [-1, 2]], [[-3, 2], [3, 0]])","A = [[-1, -2], [1, 1]]; B = [[2, -1], [1, -2]]; C = [[-3, 2], [3, 0]]","sylvester(A, B, C)"],seealso:["schur","lyap"]},Oie={name:"schur",category:"Algebra",syntax:["schur(A)"],description:"Performs a real Schur decomposition of the real matrix A = UTU'",examples:["schur([[1, 0], [-4, 3]])","A = [[1, 0], [-4, 3]]","schur(A)"],seealso:["lyap","sylvester"]},Bie={name:"lyap",category:"Algebra",syntax:["lyap(A,Q)"],description:"Solves the Continuous-time Lyapunov equation AP+PA'+Q=0 for P",examples:["lyap([[-2, 0], [1, -4]], [[3, 1], [1, 3]])","A = [[-2, 0], [1, -4]]","Q = [[3, 1], [1, 3]]","lyap(A,Q)"],seealso:["schur","sylvester"]},Rie={name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]},Pie={name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]},$ie={name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]},kie={name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]},Lie={name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values. The result is an array [d, x, y] with 3 entries, where d is the greatest common divisor, and d = x * a + y * b.",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]},Uie={name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},zie={name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},Gie={name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]},qie={name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]},Hie={name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]},Wie={name:"rightArithShift",category:"Bitwise",syntax:["x >> y","rightArithShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]},Vie={name:"rightLogShift",category:"Bitwise",syntax:["x >>> y","rightLogShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]},Xie={name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]},jie={name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]},Yie={name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]},Kie={name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]},Zie={name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]},Qie={name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]},Jie={name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]},eae={name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]},tae={name:"evaluate",category:"Expression",syntax:["evaluate(expression)","evaluate(expression, scope)","evaluate([expr1, expr2, expr3, ...])","evaluate([expr1, expr2, expr3, ...], scope)"],description:"Evaluate an expression or an array with expressions.",examples:['evaluate("2 + 3")','evaluate("sqrt(16)")','evaluate("2 inch to cm")','evaluate("sin(x * pi)", { "x": 1/2 })','evaluate(["width=2", "height=4","width*height"])'],seealso:["parser","parse","compile"]},rae={name:"parser",category:"Expression",syntax:["parser()"],description:"Create a parser object that keeps a context of variables and their values, allowing the evaluation of expressions in that context.",examples:["myParser = parser()",'myParser.evaluate("sqrt(3^2 + 4^2)")','myParser.set("x", 3)','myParser.evaluate("y = x + 3")','myParser.evaluate(["y = x + 3", "y = y + 1"])','myParser.get("y")'],seealso:["evaluate","parse","compile"]},nae={name:"parse",category:"Expression",syntax:["parse(expr)","parse(expr, options)","parse([expr1, expr2, expr3, ...])","parse([expr1, expr2, expr3, ...], options)"],description:"Parse an expression. Returns a node tree, which can be evaluated by invoking node.evaluate() or transformed into a functional object via node.compile().",examples:['node1 = parse("sqrt(3^2 + 4^2)")',"node1.evaluate()","code1 = node1.compile()","code1.evaluate()","scope = {a: 3, b: 4}",'node2 = parse("a * b")',"node2.evaluate(scope)","code2 = node2.compile()","code2.evaluate(scope)"],seealso:["parser","evaluate","compile"]},iae={name:"compile",category:"Expression",syntax:["compile(expr) ","compile([expr1, expr2, expr3, ...])"],description:"Parse and compile an expression. Returns a an object with a function evaluate([scope]) to evaluate the compiled expression.",examples:['code1 = compile("sqrt(3^2 + 4^2)")',"code1.evaluate() ",'code2 = compile("a * b")',"code2.evaluate({a: 3, b: 4})"],seealso:["parser","parse","evaluate"]},aae={name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]},sae={name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2]])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]},oae={name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]},uae={name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]},lae={name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]},cae={name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]},fae={name:"xor",category:"Logical",syntax:["x xor y","xor(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 xor 4"],seealso:["not","and","or"]},hae={name:"mapSlices",category:"Matrix",syntax:["mapSlices(A, dim, callback)"],description:"Generate a matrix one dimension less than A by applying callback to each slice of A along dimension dim.",examples:["A = [[1, 2], [3, 4]]","mapSlices(A, 1, sum)","mapSlices(A, 2, prod)"],seealso:["map","forEach"]},dae={name:"column",category:"Matrix",syntax:["column(x, index)"],description:"Return a column from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","column(A, 1)","column(A, 2)"],seealso:["row","matrixFromColumns"]},pae={name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},mae={name:"count",category:"Matrix",syntax:["count(x)"],description:"Count the number of elements of a matrix, array or string.",examples:["a = [1, 2; 3, 4; 5, 6]","count(a)","size(a)",'count("hello world")'],seealso:["size"]},vae={name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]},gae={name:"ctranspose",category:"Matrix",syntax:["x'","ctranspose(x)"],description:"Complex Conjugate and Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","ctranspose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},yae={name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},bae={name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},xae={name:"diff",category:"Matrix",syntax:["diff(arr)","diff(arr, dim)"],description:["Create a new matrix or array with the difference of the passed matrix or array.","Dim parameter is optional and used to indicate the dimension of the array/matrix to apply the difference","If no dimension parameter is passed it is assumed as dimension 0","Dimension is zero-based in javascript and one-based in the parser","Arrays must be 'rectangular' meaning arrays like [1, 2]","If something is passed as a matrix it will be returned as a matrix but other than that all matrices are converted to arrays"],examples:["A = [1, 2, 4, 7, 0]","diff(A)","diff(A, 1)","B = [[1, 2], [3, 4]]","diff(B)","diff(B, 1)","diff(B, 2)","diff(B, bignumber(2))","diff([[1, 2], matrix([3, 4])], 2)"],seealso:["subtract","partitionSelect"]},wae={name:"dot",category:"Matrix",syntax:["dot(A, B)","A * B"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]},_ae={name:"eigs",category:"Matrix",syntax:["eigs(x)"],description:"Calculate the eigenvalues and optionally eigenvectors of a square matrix",examples:["eigs([[5, 2.3], [2.3, 1]])","eigs([[1, 2, 3], [4, 5, 6], [7, 8, 9]], { precision: 1e-6, eigenvectors: false })"],seealso:["inv"]},Aae={name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]},Eae={name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]},Sae={name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["numberOfPets = {}","addPet(n) = numberOfPets[n] = (numberOfPets[n] ? numberOfPets[n]:0 ) + 1;",'forEach(["Dog","Cat","Cat"], addPet)',"numberOfPets"],seealso:["map","sort","filter"]},Dae={name:"getMatrixDataType",category:"Matrix",syntax:["getMatrixDataType(x)"],description:'Find the data type of all elements in a matrix or array, for example "number" if all items are a number and "Complex" if all values are complex numbers. If a matrix contains more than one data type, it will return "mixed".',examples:["getMatrixDataType([1, 2, 3])","getMatrixDataType([[5 cm], [2 inch]])",'getMatrixDataType([1, "text"])',"getMatrixDataType([1, bignumber(4)])"],seealso:["matrix","sparse","typeOf"]},Cae={name:"identity",category:"Matrix",syntax:["identity(n)","identity(m, n)","identity([m, n])"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["identity(3)","identity(3, 5)","a = [1, 2, 3; 4, 5, 6]","identity(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},Tae={name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","identity","ones","range","size","squeeze","subset","trace","transpose","zeros"]},Nae={name:"pinv",category:"Matrix",syntax:["pinv(x)"],description:"Calculate the Moore–Penrose inverse of a matrix",examples:["pinv([1, 2; 3, 4])","pinv([[1, 0], [0, 1], [0, 1]])","pinv(4)"],seealso:["inv"]},Mae={name:"kron",category:"Matrix",syntax:["kron(x, y)"],description:"Calculates the Kronecker product of 2 matrices or vectors.",examples:["kron([[1, 0], [0, 1]], [[1, 2], [3, 4]])","kron([1,1], [2,3,4])"],seealso:["multiply","dot","cross"]},Iae={name:"map",category:"Matrix",syntax:["map(x, callback)","map(x, y, ..., callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array or the matrices/arrays.",examples:["map([1, 2, 3], square)","map([1, 2], [3, 4], f(a,b) = a + b)"],seealso:["filter","forEach"]},Fae={name:"matrixFromColumns",category:"Matrix",syntax:["matrixFromColumns(...arr)","matrixFromColumns(row1, row2)","matrixFromColumns(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual columns.",examples:["matrixFromColumns([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromRows","matrixFromFunction","zeros"]},Oae={name:"matrixFromFunction",category:"Matrix",syntax:["matrixFromFunction(size, fn)","matrixFromFunction(size, fn, format)","matrixFromFunction(size, fn, format, datatype)","matrixFromFunction(size, format, fn)","matrixFromFunction(size, format, datatype, fn)"],description:"Create a matrix by evaluating a generating function at each index.",examples:["f(I) = I[1] - I[2]","matrixFromFunction([3,3], f)","g(I) = I[1] - I[2] == 1 ? 4 : 0",'matrixFromFunction([100, 100], "sparse", g)',"matrixFromFunction([5], random)"],seealso:["matrix","matrixFromRows","matrixFromColumns","zeros"]},Bae={name:"matrixFromRows",category:"Matrix",syntax:["matrixFromRows(...arr)","matrixFromRows(row1, row2)","matrixFromRows(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual rows.",examples:["matrixFromRows([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromColumns","matrixFromFunction","zeros"]},Rae={name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","identity","inv","range","size","squeeze","subset","trace","transpose","zeros"]},Pae={name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1, compareText)',"arr = [5, 2, 1]","partitionSelect(arr, 0) # returns 1, arr is now: [1, 2, 5]","arr","partitionSelect(arr, 1, 'desc') # returns 2, arr is now: [5, 2, 1]","arr"],seealso:["sort"]},$ae={name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"range(1m, 1m, 3m)","a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","identity","inv","ones","size","squeeze","subset","trace","transpose","zeros"]},kae={name:"reshape",category:"Matrix",syntax:["reshape(x, sizes)"],description:"Reshape a multi dimensional array to fit the specified dimensions.",examples:["reshape([1, 2, 3, 4, 5, 6], [2, 3])","reshape([[1, 2], [3, 4]], [1, 4])","reshape([[1, 2], [3, 4]], [4])","reshape([1, 2, 3, 4], [-1, 2])"],seealso:["size","squeeze","resize"]},Lae={name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze","reshape"]},Uae={name:"rotate",category:"Matrix",syntax:["rotate(w, theta)","rotate(w, theta, v)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotate([1, 0], pi / 2)",'rotate(matrix([1, 0]), unit("35deg"))','rotate([1, 0, 0], unit("90deg"), [0, 0, 1])','rotate(matrix([1, 0, 0]), unit("90deg"), matrix([0, 0, 1]))'],seealso:["matrix","rotationMatrix"]},zae={name:"rotationMatrix",category:"Matrix",syntax:["rotationMatrix(theta)","rotationMatrix(theta, v)","rotationMatrix(theta, v, format)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotationMatrix(pi / 2)",'rotationMatrix(unit("45deg"), [0, 0, 1])','rotationMatrix(1, matrix([0, 0, 1]), "sparse")'],seealso:["cos","sin"]},Gae={name:"row",category:"Matrix",syntax:["row(x, index)"],description:"Return a row from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","row(A, 1)","row(A, 2)"],seealso:["column","matrixFromRows"]},qae={name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","count","det","diag","identity","inv","ones","range","squeeze","subset","trace","transpose","zeros"]},Hae={name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc", "desc", "natural", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"], "natural")',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)','sort(["10", "1", "2"], "natural")'],seealso:["map","filter","forEach"]},Wae={name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","identity","inv","ones","range","size","subset","trace","transpose","zeros"]},Vae={name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of the entries of a matrix or characters of a string. Indexes are one-based. There should be one index specification for each dimension of the target. Each specification can be a single index, a list of indices, or a range in colon notation `l:u`. In a range, both the lower bound l and upper bound u are included; and if a bound is omitted it defaults to the most extreme valid value. The cartesian product of the indices specified in each dimension determines the target of the operation.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]","f[[1,2], [1,3]] = [9, 10; 11, 12]","f"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","trace","transpose","zeros"]},Xae={name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","transpose","zeros"]},jae={name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},Yae={name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose"]},Kae={name:"fft",category:"Matrix",syntax:["fft(x)"],description:"Calculate N-dimensional Fourier transform",examples:["fft([[1, 0], [1, 0]])"],seealso:["ifft"]},Zae={name:"ifft",category:"Matrix",syntax:["ifft(x)"],description:"Calculate N-dimensional inverse Fourier transform",examples:["ifft([[2, 2], [0, 0]])"],seealso:["fft"]},Qae={name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["combinationsWithRep","permutations","factorial"]},Jae={name:"combinationsWithRep",category:"Probability",syntax:["combinationsWithRep(n, k)"],description:"Compute the number of combinations of n items taken k at a time with replacements.",examples:["combinationsWithRep(7, 5)"],seealso:["combinations","permutations","factorial"]},ese={name:"factorial",category:"Probability",syntax:["n!","factorial(n)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","combinationsWithRep","permutations","gamma"]},tse={name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]},rse={name:"lgamma",category:"Probability",syntax:["lgamma(n)"],description:"Logarithm of the gamma function for real, positive numbers and complex numbers, using Lanczos approximation for numbers and Stirling series for complex numbers.",examples:["lgamma(4)","lgamma(1/2)","lgamma(i)","lgamma(complex(1.1, 2))"],seealso:["gamma"]},nse={name:"kldivergence",category:"Probability",syntax:["kldivergence(x, y)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]},ise={name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai > 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]},ase={name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","combinationsWithRep","factorial"]},sse={name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]},ose={name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]},use={name:"randomInt",category:"Probability",syntax:["randomInt(max)","randomInt(min, max)","randomInt(size)","randomInt(size, max)","randomInt(size, min, max)"],description:"Return a random integer number",examples:["randomInt(10, 20)","randomInt([2, 3], 10)"],seealso:["pickRandom","random"]},lse={name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compareNatural","compareText"]},cse={name:"compareNatural",category:"Relational",syntax:["compareNatural(x, y)"],description:"Compare two values of any type in a deterministic, natural way. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compareNatural(2, 3)","compareNatural(3, 2)","compareNatural(2, 2)","compareNatural(5cm, 40mm)",'compareNatural("2", "10")',"compareNatural(2 + 3i, 2 + 4i)","compareNatural([1, 2, 4], [1, 2, 3])","compareNatural([1, 5], [1, 2, 3])","compareNatural([1, 2], [1, 2])","compareNatural({a: 2}, {a: 4})"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare","compareText"]},fse={name:"compareText",category:"Relational",syntax:["compareText(x, y)"],description:"Compare two strings lexically. Comparison is case sensitive. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:['compareText("B", "A")','compareText("A", "B")','compareText("A", "A")','compareText("2", "10")','compare("2", "10")',"compare(2, 10)",'compareNatural("2", "10")','compareText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural"]},hse={name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["deepEqual([1,3,4], [1,3,4])","deepEqual([1,3,4], [1,3])"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]},dse={name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual","equalText"]},pse={name:"equalText",category:"Relational",syntax:["equalText(x, y)"],description:"Check equality of two strings. Comparison is case sensitive. Returns true if the values are equal, and false if not.",examples:['equalText("Hello", "Hello")','equalText("a", "A")','equal("2e3", "2000")','equalText("2e3", "2000")','equalText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural","compareText","equal"]},mse={name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not. Comparing a value with NaN returns false.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]},vse={name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 >= 1+1","2 > 1+1","a = 3.2","b = 6-2.8","(a >= b)"],seealso:["equal","unequal","smallerEq","smaller","compare"]},gse={name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not. Comparing a value with NaN returns false.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]},yse={name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 <= 1+1","2 < 1+1","a = 3.2","b = 6-2.8","(a <= b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]},bse={name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]},xse={name:"setCartesian",category:"Set",syntax:["setCartesian(set1, set2)"],description:"Create the cartesian product of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays and the values will be sorted in ascending order before the operation.",examples:["setCartesian([1, 2], [3, 4])"],seealso:["setUnion","setIntersect","setDifference","setPowerset"]},wse={name:"setDifference",category:"Set",syntax:["setDifference(set1, set2)"],description:"Create the difference of two (multi)sets: every element of set1, that is not the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setDifference([1, 2, 3, 4], [3, 4, 5, 6])","setDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setSymDifference"]},_se={name:"setDistinct",category:"Set",syntax:["setDistinct(set)"],description:"Collect the distinct elements of a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setDistinct([1, 1, 1, 2, 2, 3])"],seealso:["setMultiplicity"]},Ase={name:"setIntersect",category:"Set",syntax:["setIntersect(set1, set2)"],description:"Create the intersection of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIntersect([1, 2, 3, 4], [3, 4, 5, 6])","setIntersect([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setDifference"]},Ese={name:"setIsSubset",category:"Set",syntax:["setIsSubset(set1, set2)"],description:"Check whether a (multi)set is a subset of another (multi)set: every element of set1 is the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIsSubset([1, 2], [3, 4, 5, 6])","setIsSubset([3, 4], [3, 4, 5, 6])"],seealso:["setUnion","setIntersect","setDifference"]},Sse={name:"setMultiplicity",category:"Set",syntax:["setMultiplicity(element, set)"],description:"Count the multiplicity of an element in a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setMultiplicity(1, [1, 2, 2, 4])","setMultiplicity(2, [1, 2, 2, 4])"],seealso:["setDistinct","setSize"]},Dse={name:"setPowerset",category:"Set",syntax:["setPowerset(set)"],description:"Create the powerset of a (multi)set: the powerset contains very possible subsets of a (multi)set. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setPowerset([1, 2, 3])"],seealso:["setCartesian"]},Cse={name:"setSize",category:"Set",syntax:["setSize(set)","setSize(set, unique)"],description:'Count the number of elements of a (multi)set. When the second parameter "unique" is true, count only the unique values. A multi-dimension array will be converted to a single-dimension array before the operation.',examples:["setSize([1, 2, 2, 4])","setSize([1, 2, 2, 4], true)"],seealso:["setUnion","setIntersect","setDifference"]},Tse={name:"setSymDifference",category:"Set",syntax:["setSymDifference(set1, set2)"],description:"Create the symmetric difference of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setSymDifference([1, 2, 3, 4], [3, 4, 5, 6])","setSymDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setDifference"]},Nse={name:"setUnion",category:"Set",syntax:["setUnion(set1, set2)"],description:"Create the union of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setUnion([1, 2, 3, 4], [3, 4, 5, 6])","setUnion([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setIntersect","setDifference"]},Mse={name:"zpk2tf",category:"Signal",syntax:["zpk2tf(z, p, k)"],description:"Compute the transfer function of a zero-pole-gain model.",examples:["zpk2tf([1, 2], [-1, -2], 1)","zpk2tf([1, 2], [-1, -2])","zpk2tf([1 - 3i, 2 + 2i], [-1, -2])"],seealso:[]},Ise={name:"freqz",category:"Signal",syntax:["freqz(b, a)","freqz(b, a, w)"],description:"Calculates the frequency response of a filter given its numerator and denominator coefficients.",examples:["freqz([1, 2], [1, 2, 3])","freqz([1, 2], [1, 2, 3], [0, 1])","freqz([1, 2], [1, 2, 3], 512)"],seealso:[]},Fse={name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]},Ose={name:"zeta",category:"Special",syntax:["zeta(s)"],description:"Compute the Riemann Zeta Function using an infinite series and Riemann's Functional Equation for the entire complex plane",examples:["zeta(0.2)","zeta(-0.5)","zeta(4)"],seealso:[]},Bse={name:"mad",category:"Statistics",syntax:["mad(a, b, c, ...)","mad(A)"],description:"Compute the median absolute deviation of a matrix or a list with values. The median absolute deviation is defined as the median of the absolute deviations from the median.",examples:["mad(10, 20, 30)","mad([1, 2, 3])"],seealso:["mean","median","std","abs"]},Rse={name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dimension)"],description:"Compute the maximum value of a list of values. If any NaN values are found, the function yields the last NaN in the input.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","variance"]},Pse={name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dimension)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","variance"]},$se={name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","variance","quantileSeq"]},kse={name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dimension)"],description:"Compute the minimum value of a list of values. If any NaN values are found, the function yields the last NaN in the input.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","variance"]},Lse={name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(2, 1, 4, 3, 1)","mode([1, 2.7, 3.2, 4, 2.7])","mode(1, 4, 6, 1, 6)"],seealso:["max","mean","min","median","prod","std","sum","variance"]},Use={name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","variance"]},zse={name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:`Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probability are: Number, BigNumber. 

In case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.`,examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","variance"]},Gse={name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, dimension)","std(A, normalization)","std(A, dimension, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(variance(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","prod","sum","variance"]},qse={name:"cumsum",category:"Statistics",syntax:["cumsum(a, b, c, ...)","cumsum(A)"],description:"Compute the cumulative sum of all values.",examples:["cumsum(2, 3, 4, 1)","cumsum([2, 3, 4, 1])","cumsum([1, 2; 3, 4])","cumsum([1, 2; 3, 4], 1)","cumsum([1, 2; 3, 4], 2)"],seealso:["max","mean","median","min","prod","std","sum","variance"]},Hse={name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)","sum(A, dimension)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","variance"]},Wse={name:"variance",category:"Statistics",syntax:["variance(a, b, c, ...)","variance(A)","variance(A, dimension)","variance(A, normalization)","variance(A, dimension, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["variance(2, 4, 6)","variance([2, 4, 6, 8])",'variance([2, 4, 6, 8], "uncorrected")','variance([2, 4, 6, 8], "biased")',"variance([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]},Vse={name:"corr",category:"Statistics",syntax:["corr(A,B)"],description:"Compute the correlation coefficient of a two list with values, For matrices, the matrix correlation coefficient is calculated.",examples:["corr([2, 4, 6, 8],[1, 2, 3, 6])","corr(matrix([[1, 2.2, 3, 4.8, 5], [1, 2, 3, 4, 5]]), matrix([[4, 5.3, 6.6, 7, 8], [1, 2, 3, 4, 5]]))"],seealso:["max","mean","min","median","min","prod","std","sum"]},Xse={name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]},jse={name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]},Yse={name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]},Kse={name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the inverse hyperbolic tangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(2)","acoth(0.5)"],seealso:["acsch","asech"]},Zse={name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(2)","acsc(csc(0.5))","acsc(0.5)"],seealso:["csc","asin","asec"]},Qse={name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the inverse hyperbolic cosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]},Jse={name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]},eoe={name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]},toe={name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(0.5))"],seealso:["sin","acos","atan"]},roe={name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]},noe={name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(0.5))"],seealso:["tan","acos","asin"]},ioe={name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]},aoe={name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]},soe={name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]},ooe={name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]},uoe={name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]},loe={name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]},coe={name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]},foe={name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]},hoe={name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]},doe={name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]},poe={name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]},moe={name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]},voe={name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]},goe={name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]},yoe={name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]},boe={name:"bin",category:"Utils",syntax:["bin(value)"],description:"Format a number as binary",examples:["bin(2)"],seealso:["oct","hex"]},xoe={name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables, and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]},woe={name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]},_oe={name:"hasNumericValue",category:"Utils",syntax:["hasNumericValue(x)"],description:"Test whether a value is an numeric value. In case of a string, true is returned if the string contains a numeric value.",examples:["hasNumericValue(2)",'hasNumericValue("2")','isNumeric("2")',"hasNumericValue(0)","hasNumericValue(bignumber(500))","hasNumericValue(fraction(0.125))","hasNumericValue(2 + 3i)",'hasNumericValue([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","isNumeric"]},Aoe={name:"hex",category:"Utils",syntax:["hex(value)"],description:"Format a number as hexadecimal",examples:["hex(240)"],seealso:["bin","oct"]},Eoe={name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]},Soe={name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]},Doe={name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]},Coe={name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)",'isNumeric("2")','hasNumericValue("2")',"isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))","isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","hasNumericValue"]},Toe={name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},Noe={name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},Moe={name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]},Ioe={name:"numeric",category:"Utils",syntax:["numeric(x)"],description:"Convert a numeric input to a specific numeric type: number, BigNumber, bigint, or Fraction.",examples:['numeric("4")','numeric("4", "number")','numeric("4", "bigint")','numeric("4", "BigNumber")','numeric("4", "Fraction")','numeric(4, "Fraction")','numeric(fraction(2, 5), "number")'],seealso:["number","bigint","fraction","bignumber","string","format"]},Foe={name:"oct",category:"Utils",syntax:["oct(value)"],description:"Format a number as octal",examples:["oct(56)"],seealso:["bin","hex"]},Ooe={name:"print",category:"Utils",syntax:["print(template, values)","print(template, values, precision)"],description:"Interpolate values into a string template.",examples:['print("Lucy is $age years old", {age: 5})','print("The value of pi is $pi", {pi: pi}, 3)','print("Hello, $user.name!", {user: {name: "John"}})','print("Values: $1, $2, $3", [6, 9, 4])'],seealso:["format"]},Boe={name:"typeOf",category:"Utils",syntax:["typeOf(x)"],description:"Get the type of a variable.",examples:["typeOf(3.5)","typeOf(2 - 4i)","typeOf(45 deg)",'typeOf("hello world")'],seealso:["getMatrixDataType"]},Roe={name:"solveODE",category:"Numeric",syntax:["solveODE(func, tspan, y0)","solveODE(func, tspan, y0, options)"],description:"Numerical Integration of Ordinary Differential Equations.",examples:["f(t,y) = y","tspan = [0, 4]","solveODE(f, tspan, 1)","solveODE(f, tspan, [1, 2])",'solveODE(f, tspan, 1, { method:"RK23", maxStep:0.1 })'],seealso:["derivative","simplifyCore"]},Poe={bignumber:wne,bigint:_ne,boolean:Ane,complex:Ene,createUnit:Sne,fraction:Dne,index:Cne,matrix:Tne,number:Nne,sparse:Mne,splitUnit:Ine,string:Fne,unit:One,e:KC,E:KC,false:sne,i:one,Infinity:une,LN2:cne,LN10:lne,LOG2E:hne,LOG10E:fne,NaN:dne,null:pne,pi:ZC,PI:ZC,phi:mne,SQRT1_2:vne,SQRT2:gne,tau:yne,true:bne,version:xne,speedOfLight:{description:"Speed of light in vacuum",examples:["speedOfLight"]},gravitationConstant:{description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},planckConstant:{description:"Planck constant",examples:["planckConstant"]},reducedPlanckConstant:{description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},magneticConstant:{description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},electricConstant:{description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},vacuumImpedance:{description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},coulomb:{description:"Coulomb's constant. Deprecated in favor of coulombConstant",examples:["coulombConstant"]},coulombConstant:{description:"Coulomb's constant",examples:["coulombConstant"]},elementaryCharge:{description:"Elementary charge",examples:["elementaryCharge"]},bohrMagneton:{description:"Bohr magneton",examples:["bohrMagneton"]},conductanceQuantum:{description:"Conductance quantum",examples:["conductanceQuantum"]},inverseConductanceQuantum:{description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},magneticFluxQuantum:{description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},nuclearMagneton:{description:"Nuclear magneton",examples:["nuclearMagneton"]},klitzing:{description:"Von Klitzing constant",examples:["klitzing"]},bohrRadius:{description:"Bohr radius",examples:["bohrRadius"]},classicalElectronRadius:{description:"Classical electron radius",examples:["classicalElectronRadius"]},electronMass:{description:"Electron mass",examples:["electronMass"]},fermiCoupling:{description:"Fermi coupling constant",examples:["fermiCoupling"]},fineStructure:{description:"Fine-structure constant",examples:["fineStructure"]},hartreeEnergy:{description:"Hartree energy",examples:["hartreeEnergy"]},protonMass:{description:"Proton mass",examples:["protonMass"]},deuteronMass:{description:"Deuteron Mass",examples:["deuteronMass"]},neutronMass:{description:"Neutron mass",examples:["neutronMass"]},quantumOfCirculation:{description:"Quantum of circulation",examples:["quantumOfCirculation"]},rydberg:{description:"Rydberg constant",examples:["rydberg"]},thomsonCrossSection:{description:"Thomson cross section",examples:["thomsonCrossSection"]},weakMixingAngle:{description:"Weak mixing angle",examples:["weakMixingAngle"]},efimovFactor:{description:"Efimov factor",examples:["efimovFactor"]},atomicMass:{description:"Atomic mass constant",examples:["atomicMass"]},avogadro:{description:"Avogadro's number",examples:["avogadro"]},boltzmann:{description:"Boltzmann constant",examples:["boltzmann"]},faraday:{description:"Faraday constant",examples:["faraday"]},firstRadiation:{description:"First radiation constant",examples:["firstRadiation"]},loschmidt:{description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},gasConstant:{description:"Gas constant",examples:["gasConstant"]},molarPlanckConstant:{description:"Molar Planck constant",examples:["molarPlanckConstant"]},molarVolume:{description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},sackurTetrode:{description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},secondRadiation:{description:"Second radiation constant",examples:["secondRadiation"]},stefanBoltzmann:{description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},wienDisplacement:{description:"Wien displacement law constant",examples:["wienDisplacement"]},molarMass:{description:"Molar mass constant",examples:["molarMass"]},molarMassC12:{description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},gravity:{description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},planckLength:{description:"Planck length",examples:["planckLength"]},planckMass:{description:"Planck mass",examples:["planckMass"]},planckTime:{description:"Planck time",examples:["planckTime"]},planckCharge:{description:"Planck charge",examples:["planckCharge"]},planckTemperature:{description:"Planck temperature",examples:["planckTemperature"]},derivative:$ne,lsolve:Lne,lsolveAll:Une,lup:zne,lusolve:Gne,leafCount:kne,polynomialRoot:qne,resolve:Vne,simplify:Xne,simplifyConstant:jne,simplifyCore:Yne,symbolicEqual:Zne,rationalize:Wne,slu:Kne,usolve:Qne,usolveAll:Jne,qr:Hne,abs:eie,add:tie,cbrt:rie,ceil:nie,cube:iie,divide:aie,dotDivide:sie,dotMultiply:oie,dotPow:uie,exp:lie,expm:cie,expm1:fie,fix:hie,floor:die,gcd:pie,hypot:mie,lcm:gie,log:yie,log2:wie,log1p:xie,log10:bie,mod:_ie,multiply:Aie,norm:Eie,nthRoot:Sie,nthRoots:Die,pow:Cie,round:Tie,sign:Nie,sqrt:Mie,sqrtm:Iie,square:Rie,subtract:Pie,unaryMinus:$ie,unaryPlus:kie,xgcd:Lie,invmod:vie,bitAnd:Uie,bitNot:zie,bitOr:Gie,bitXor:qie,leftShift:Hie,rightArithShift:Wie,rightLogShift:Vie,bellNumbers:Xie,catalan:jie,composition:Yie,stirlingS2:Kie,config:Bne,import:Rne,typed:Pne,arg:Zie,conj:Qie,re:eae,im:Jie,evaluate:tae,help:aae,parse:nae,parser:rae,compile:iae,distance:sae,intersect:oae,and:uae,not:lae,or:cae,xor:fae,mapSlices:hae,concat:pae,count:mae,cross:vae,column:dae,ctranspose:gae,det:yae,diag:bae,diff:xae,dot:wae,getMatrixDataType:Dae,identity:Cae,filter:Aae,flatten:Eae,forEach:Sae,inv:Tae,pinv:Nae,eigs:_ae,kron:Mae,matrixFromFunction:Oae,matrixFromRows:Bae,matrixFromColumns:Fae,map:Iae,ones:Rae,partitionSelect:Pae,range:$ae,resize:Lae,reshape:kae,rotate:Uae,rotationMatrix:zae,row:Gae,size:qae,sort:Hae,squeeze:Wae,subset:Vae,trace:Xae,transpose:jae,zeros:Yae,fft:Kae,ifft:Zae,sylvester:Fie,schur:Oie,lyap:Bie,solveODE:Roe,combinations:Qae,combinationsWithRep:Jae,factorial:ese,gamma:tse,kldivergence:nse,lgamma:rse,multinomial:ise,permutations:ase,pickRandom:sse,random:ose,randomInt:use,compare:lse,compareNatural:cse,compareText:fse,deepEqual:hse,equal:dse,equalText:pse,larger:mse,largerEq:vse,smaller:gse,smallerEq:yse,unequal:bse,setCartesian:xse,setDifference:wse,setDistinct:_se,setIntersect:Ase,setIsSubset:Ese,setMultiplicity:Sse,setPowerset:Dse,setSize:Cse,setSymDifference:Tse,setUnion:Nse,zpk2tf:Mse,freqz:Ise,erf:Fse,zeta:Ose,cumsum:qse,mad:Bse,max:Rse,mean:Pse,median:$se,min:kse,mode:Lse,prod:Use,quantileSeq:zse,std:Gse,sum:Hse,variance:Wse,corr:Vse,acos:Xse,acosh:jse,acot:Yse,acoth:Kse,acsc:Zse,acsch:Qse,asec:Jse,asech:eoe,asin:toe,asinh:roe,atan:noe,atanh:aoe,atan2:ioe,cos:soe,cosh:ooe,cot:uoe,coth:loe,csc:coe,csch:foe,sec:hoe,sech:doe,sin:poe,sinh:moe,tan:voe,tanh:goe,to:yoe,clone:xoe,format:woe,bin:boe,oct:Foe,hex:Aoe,isNaN:Soe,isInteger:Eoe,isNegative:Doe,isNumeric:Coe,hasNumericValue:_oe,isPositive:Toe,isPrime:Noe,isZero:Moe,print:Ooe,typeOf:Boe,numeric:Ioe},QC="help",$oe=["typed","mathWithTransform","Help"],koe=ee(QC,$oe,t=>{var{typed:e,mathWithTransform:r,Help:n}=t;return e(QC,{any:function(a){var s,o=a;if(typeof a!="string"){for(s in r)if(Ft(r,s)&&a===r[s]){o=s;break}}var l=Vi(Poe,o);if(!l){var u=typeof o=="function"?o.name:o;throw new Error('No documentation found on "'+u+'"')}return new n(l)}})}),JC="chain",Loe=["typed","Chain"],Uoe=ee(JC,Loe,t=>{var{typed:e,Chain:r}=t;return e(JC,{"":function(){return new r},any:function(i){return new r(i)}})}),eT="det",zoe=["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],Goe=ee(eT,zoe,t=>{var{typed:e,matrix:r,subtractScalar:n,multiply:i,divideScalar:a,isZero:s,unaryMinus:o}=t;return e(eT,{any:function(c){return rr(c)},"Array | Matrix":function(c){var f;switch(Gt(c)?f=c.size():Array.isArray(c)?(c=r(c),f=c.size()):f=[],f.length){case 0:return rr(c);case 1:if(f[0]===1)return rr(c.valueOf()[0]);if(f[0]===0)return 1;throw new RangeError("Matrix must be square (size: "+yr(f)+")");case 2:{var h=f[0],p=f[1];if(h===p)return l(c.clone().valueOf(),h);if(p===0)return 1;throw new RangeError("Matrix must be square (size: "+yr(f)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+yr(f)+")")}}});function l(u,c,f){if(c===1)return rr(u[0][0]);if(c===2)return n(i(u[0][0],u[1][1]),i(u[1][0],u[0][1]));for(var h=!1,p=new Array(c).fill(0).map((T,M)=>M),m=0;m<c;m++){var v=p[m];if(s(u[v][m])){var y=void 0;for(y=m+1;y<c;y++)if(!s(u[p[y]][m])){v=p[y],p[y]=p[m],p[m]=v,h=!h;break}if(y===c)return u[v][m]}for(var x=u[v][m],S=m===0?1:u[p[m-1]][m-1],b=m+1;b<c;b++)for(var A=p[b],E=m+1;E<c;E++)u[A][E]=a(n(i(u[A][E],x),i(u[A][m],u[v][E])),S)}var _=u[p[c-1]][c-1];return h?o(_):_}}),tT="inv",qoe=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],Hoe=ee(tT,qoe,t=>{var{typed:e,matrix:r,divideScalar:n,addScalar:i,multiply:a,unaryMinus:s,det:o,identity:l,abs:u}=t;return e(tT,{"Array | Matrix":function(h){var p=Gt(h)?h.size():er(h);switch(p.length){case 1:if(p[0]===1)return Gt(h)?r([n(1,h.valueOf()[0])]):[n(1,h[0])];throw new RangeError("Matrix must be square (size: "+yr(p)+")");case 2:{var m=p[0],v=p[1];if(m===v)return Gt(h)?r(c(h.valueOf(),m,v),h.storage()):c(h,m,v);throw new RangeError("Matrix must be square (size: "+yr(p)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+yr(p)+")")}},any:function(h){return n(1,h)}});function c(f,h,p){var m,v,y,x,S;if(h===1){if(x=f[0][0],x===0)throw Error("Cannot calculate inverse, determinant is zero");return[[n(1,x)]]}else if(h===2){var b=o(f);if(b===0)throw Error("Cannot calculate inverse, determinant is zero");return[[n(f[1][1],b),n(s(f[0][1]),b)],[n(s(f[1][0]),b),n(f[0][0],b)]]}else{var A=f.concat();for(m=0;m<h;m++)A[m]=A[m].concat();for(var E=l(h).valueOf(),_=0;_<p;_++){var T=u(A[_][_]),M=_;for(m=_+1;m<h;)u(A[m][_])>T&&(T=u(A[m][_]),M=m),m++;if(T===0)throw Error("Cannot calculate inverse, determinant is zero");m=M,m!==_&&(S=A[_],A[_]=A[m],A[m]=S,S=E[_],E[_]=E[m],E[m]=S);var N=A[_],I=E[_];for(m=0;m<h;m++){var F=A[m],P=E[m];if(m!==_){if(F[_]!==0){for(y=n(s(F[_]),N[_]),v=_;v<p;v++)F[v]=i(F[v],a(y,N[v]));for(v=0;v<p;v++)P[v]=i(P[v],a(y,I[v]))}}else{for(y=N[_],v=_;v<p;v++)F[v]=n(F[v],y);for(v=0;v<p;v++)P[v]=n(P[v],y)}}}return E}}}),rT="pinv",Woe=["typed","matrix","inv","deepEqual","equal","dotDivide","dot","ctranspose","divideScalar","multiply","add","Complex"],Voe=ee(rT,Woe,t=>{var{typed:e,matrix:r,inv:n,deepEqual:i,equal:a,dotDivide:s,dot:o,ctranspose:l,divideScalar:u,multiply:c,add:f,Complex:h}=t;return e(rT,{"Array | Matrix":function(b){var A=Gt(b)?b.size():er(b);switch(A.length){case 1:return x(b)?l(b):A[0]===1?n(b):s(l(b),o(b,b));case 2:{if(x(b))return l(b);var E=A[0],_=A[1];if(E===_)try{return n(b)}catch(T){if(!(T instanceof Error&&T.message.match(/Cannot calculate inverse, determinant is zero/)))throw T}return Gt(b)?r(p(b.valueOf(),E,_),b.storage()):p(b,E,_)}default:throw new RangeError("Matrix must be two dimensional (size: "+yr(A)+")")}},any:function(b){return a(b,0)?rr(b):u(1,b)}});function p(S,b,A){var{C:E,F:_}=v(S,b,A),T=c(n(c(l(E),E)),l(E)),M=c(l(_),n(c(_,l(_))));return c(M,T)}function m(S,b,A){for(var E=rr(S),_=0,T=0;T<b;T++){if(A<=_)return E;for(var M=T;y(E[M][_]);)if(M++,b===M&&(M=T,_++,A===_))return E;[E[M],E[T]]=[E[T],E[M]];for(var N=E[T][_],I=0;I<A;I++)E[T][I]=s(E[T][I],N);for(var F=0;F<b;F++)if(F!==T){N=E[F][_];for(var P=0;P<A;P++)E[F][P]=f(E[F][P],c(-1,c(N,E[T][P])))}_++}return E}function v(S,b,A){var E=m(S,b,A),_=S.map((M,N)=>M.filter((I,F)=>F<b&&!y(o(E[F],E[F])))),T=E.filter((M,N)=>!y(o(E[N],E[N])));return{C:_,F:T}}function y(S){return a(f(S,h(1,1)),f(0,h(1,1)))}function x(S){return i(f(S,h(1,1)),f(c(S,0),h(1,1)))}});function Xoe(t){var{addScalar:e,subtract:r,flatten:n,multiply:i,multiplyScalar:a,divideScalar:s,sqrt:o,abs:l,bignumber:u,diag:c,size:f,reshape:h,inv:p,qr:m,usolve:v,usolveAll:y,equal:x,complex:S,larger:b,smaller:A,matrixFromColumns:E,dot:_}=t;function T(fe,ue,le,ke){var Me=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,Se=M(fe,ue,le,ke,Me);N(fe,ue,le,ke,Me,Se);var{values:oe,C:K}=I(fe,ue,le,ke,Me);if(Me){var de=F(fe,ue,K,Se,oe,le,ke);return{values:oe,eigenvectors:de}}return{values:oe}}function M(fe,ue,le,ke,Me){var Se=ke==="BigNumber",oe=ke==="Complex",K=Se?u(0):0,de=Se?u(1):oe?S(1):1,_e=Se?u(1):1,be=Se?u(10):2,$e=a(be,be),Oe;Me&&(Oe=Array(ue).fill(de));for(var Qe=!1;!Qe;){Qe=!0;for(var ae=0;ae<ue;ae++){for(var ce=K,Ce=K,Ue=0;Ue<ue;Ue++)ae!==Ue&&(ce=e(ce,l(fe[Ue][ae])),Ce=e(Ce,l(fe[ae][Ue])));if(!x(ce,0)&&!x(Ce,0)){for(var Ve=_e,je=ce,ht=s(Ce,be),re=a(Ce,be);A(je,ht);)je=a(je,$e),Ve=a(Ve,be);for(;b(je,re);)je=s(je,$e),Ve=s(Ve,be);var we=A(s(e(je,Ce),Ve),a(e(ce,Ce),.95));if(we){Qe=!1;for(var Ne=s(1,Ve),Ge=0;Ge<ue;Ge++)ae!==Ge&&(fe[ae][Ge]=a(fe[ae][Ge],Ne),fe[Ge][ae]=a(fe[Ge][ae],Ve));Me&&(Oe[ae]=a(Oe[ae],Ne))}}}}return Me?c(Oe):null}function N(fe,ue,le,ke,Me,Se){var oe=ke==="BigNumber",K=ke==="Complex",de=oe?u(0):K?S(0):0;oe&&(le=u(le));for(var _e=0;_e<ue-2;_e++){for(var be=0,$e=de,Oe=_e+1;Oe<ue;Oe++){var Qe=fe[Oe][_e];A(l($e),l(Qe))&&($e=Qe,be=Oe)}if(!A(l($e),le)){if(be!==_e+1){var ae=fe[be];fe[be]=fe[_e+1],fe[_e+1]=ae;for(var ce=0;ce<ue;ce++){var Ce=fe[ce][be];fe[ce][be]=fe[ce][_e+1],fe[ce][_e+1]=Ce}if(Me){var Ue=Se[be];Se[be]=Se[_e+1],Se[_e+1]=Ue}}for(var Ve=_e+2;Ve<ue;Ve++){var je=s(fe[Ve][_e],$e);if(je!==0){for(var ht=0;ht<ue;ht++)fe[Ve][ht]=r(fe[Ve][ht],a(je,fe[_e+1][ht]));for(var re=0;re<ue;re++)fe[re][_e+1]=e(fe[re][_e+1],a(je,fe[re][Ve]));if(Me)for(var we=0;we<ue;we++)Se[Ve][we]=r(Se[Ve][we],a(je,Se[_e+1][we]))}}}}return Se}function I(fe,ue,le,ke,Me){var Se=ke==="BigNumber",oe=ke==="Complex",K=Se?u(1):oe?S(1):1;Se&&(le=u(le));for(var de=rr(fe),_e=[],be=ue,$e=[],Oe=Me?c(Array(ue).fill(K)):void 0,Qe=Me?c(Array(be).fill(K)):void 0,ae=0;ae<=100;){ae+=1;for(var ce=de[be-1][be-1],Ce=0;Ce<be;Ce++)de[Ce][Ce]=r(de[Ce][Ce],ce);var{Q:Ue,R:Ve}=m(de);de=i(Ve,Ue);for(var je=0;je<be;je++)de[je][je]=e(de[je][je],ce);if(Me&&(Qe=i(Qe,Ue)),be===1||A(l(de[be-1][be-2]),le)){ae=0,_e.push(de[be-1][be-1]),Me&&($e.unshift([[1]]),G(Qe,ue),Oe=i(Oe,Qe),be>1&&(Qe=c(Array(be-1).fill(K)))),be-=1,de.pop();for(var ht=0;ht<be;ht++)de[ht].pop()}else if(be===2||A(l(de[be-2][be-3]),le)){ae=0;var re=P(de[be-2][be-2],de[be-2][be-1],de[be-1][be-2],de[be-1][be-1]);_e.push(...re),Me&&($e.unshift(U(de[be-2][be-2],de[be-2][be-1],de[be-1][be-2],de[be-1][be-1],re[0],re[1],le,ke)),G(Qe,ue),Oe=i(Oe,Qe),be>2&&(Qe=c(Array(be-2).fill(K)))),be-=2,de.pop(),de.pop();for(var we=0;we<be;we++)de[we].pop(),de[we].pop()}if(be===0)break}if(_e.sort((He,We)=>+r(l(He),l(We))),ae>100){var Ne=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+_e.join(", "));throw Ne.values=_e,Ne.vectors=[],Ne}var Ge=Me?i(Oe,V($e,ue)):void 0;return{values:_e,C:Ge}}function F(fe,ue,le,ke,Me,Se,oe){var K=p(le),de=i(K,fe,le),_e=oe==="BigNumber",be=oe==="Complex",$e=_e?u(0):be?S(0):0,Oe=_e?u(1):be?S(1):1,Qe=[],ae=[];for(var ce of Me){var Ce=$(Qe,ce,x);Ce===-1?(Qe.push(ce),ae.push(1)):ae[Ce]+=1}for(var Ue=[],Ve=Qe.length,je=Array(ue).fill($e),ht=c(Array(ue).fill(Oe)),re=function(){var Ge=Qe[we],He=r(de,i(Ge,ht)),We=y(He,je);for(We.shift();We.length<ae[we];){var ft=j(He,ue,We,Se,oe);if(ft===null)break;We.push(ft)}var st=i(p(ke),le);We=We.map(dt=>i(st,dt)),Ue.push(...We.map(dt=>({value:Ge,vector:n(dt)})))},we=0;we<Ve;we++)re();return Ue}function P(fe,ue,le,ke){var Me=e(fe,ke),Se=r(a(fe,ke),a(ue,le)),oe=a(Me,.5),K=a(o(r(a(Me,Me),a(4,Se))),.5);return[e(oe,K),r(oe,K)]}function U(fe,ue,le,ke,Me,Se,oe,K){var de=K==="BigNumber",_e=K==="Complex",be=de?u(0):_e?S(0):0,$e=de?u(1):_e?S(1):1;if(A(l(le),oe))return[[$e,be],[be,$e]];if(b(l(r(Me,Se)),oe))return[[r(Me,ke),r(Se,ke)],[le,le]];var Oe=r(fe,Me),Qe=r(ke,Me);return A(l(ue),oe)&&A(l(Qe),oe)?[[Oe,$e],[le,be]]:[[ue,be],[Qe,$e]]}function G(fe,ue){for(var le=0;le<fe.length;le++)fe[le].push(...Array(ue-fe[le].length).fill(0));for(var ke=fe.length;ke<ue;ke++)fe.push(Array(ue).fill(0)),fe[ke][ke]=1;return fe}function V(fe,ue){for(var le=[],ke=0;ke<ue;ke++)le[ke]=Array(ue).fill(0);var Me=0;for(var Se of fe){for(var oe=Se.length,K=0;K<oe;K++)for(var de=0;de<oe;de++)le[Me+K][Me+de]=Se[K][de];Me+=oe}return le}function $(fe,ue,le){for(var ke=0;ke<fe.length;ke++)if(le(fe[ke],ue))return ke;return-1}function j(fe,ue,le,ke,Me){for(var Se=Me==="BigNumber"?u(1e3):1e3,oe,K=0;K<5;++K){oe=k(ue,le,Me);try{oe=v(fe,oe)}catch{continue}if(b(z(oe),Se))break}if(K>=5)return null;for(K=0;;){var de=v(fe,oe);if(A(z(Z(oe,[de])),ke))break;if(++K>=10)return null;oe=me(de)}return oe}function k(fe,ue,le){var ke=le==="BigNumber",Me=le==="Complex",Se=Array(fe).fill(0).map(oe=>2*Math.random()-1);return ke&&(Se=Se.map(oe=>u(oe))),Me&&(Se=Se.map(oe=>S(oe))),Se=Z(Se,ue),me(Se,le)}function Z(fe,ue){var le=f(fe);for(var ke of ue)ke=h(ke,le),fe=r(fe,i(s(_(ke,fe),_(ke,ke)),ke));return fe}function z(fe){return l(o(_(fe,fe)))}function me(fe,ue){var le=ue==="BigNumber",ke=ue==="Complex",Me=le?u(1):ke?S(1):1;return i(s(Me,z(fe)),fe)}return T}function joe(t){var{config:e,addScalar:r,subtract:n,abs:i,atan:a,cos:s,sin:o,multiplyScalar:l,inv:u,bignumber:c,multiply:f,add:h}=t;function p(N,I){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.relTol,P=arguments.length>3?arguments[3]:void 0,U=arguments.length>4?arguments[4]:void 0;if(P==="number")return m(N,F,U);if(P==="BigNumber")return v(N,F,U);throw TypeError("Unsupported data type: "+P)}function m(N,I,F){var P=N.length,U=Math.abs(I/P),G,V;if(F){V=new Array(P);for(var $=0;$<P;$++)V[$]=Array(P).fill(0),V[$][$]=1}for(var j=_(N);Math.abs(j[1])>=Math.abs(U);){var k=j[0][0],Z=j[0][1];G=y(N[k][k],N[Z][Z],N[k][Z]),N=E(N,G,k,Z),F&&(V=S(V,G,k,Z)),j=_(N)}for(var z=Array(P).fill(0),me=0;me<P;me++)z[me]=N[me][me];return M(rr(z),V,F)}function v(N,I,F){var P=N.length,U=i(I/P),G,V;if(F){V=new Array(P);for(var $=0;$<P;$++)V[$]=Array(P).fill(0),V[$][$]=1}for(var j=T(N);i(j[1])>=i(U);){var k=j[0][0],Z=j[0][1];G=x(N[k][k],N[Z][Z],N[k][Z]),N=A(N,G,k,Z),F&&(V=b(V,G,k,Z)),j=T(N)}for(var z=Array(P).fill(0),me=0;me<P;me++)z[me]=N[me][me];return M(rr(z),V,F)}function y(N,I,F){var P=I-N;return Math.abs(P)<=e.relTol?Math.PI/4:.5*Math.atan(2*F/(I-N))}function x(N,I,F){var P=n(I,N);return i(P)<=e.relTol?c(-1).acos().div(4):l(.5,a(f(2,F,u(P))))}function S(N,I,F,P){for(var U=N.length,G=Math.cos(I),V=Math.sin(I),$=Array(U).fill(0),j=Array(U).fill(0),k=0;k<U;k++)$[k]=G*N[k][F]-V*N[k][P],j[k]=V*N[k][F]+G*N[k][P];for(var Z=0;Z<U;Z++)N[Z][F]=$[Z],N[Z][P]=j[Z];return N}function b(N,I,F,P){for(var U=N.length,G=s(I),V=o(I),$=Array(U).fill(c(0)),j=Array(U).fill(c(0)),k=0;k<U;k++)$[k]=n(l(G,N[k][F]),l(V,N[k][P])),j[k]=r(l(V,N[k][F]),l(G,N[k][P]));for(var Z=0;Z<U;Z++)N[Z][F]=$[Z],N[Z][P]=j[Z];return N}function A(N,I,F,P){for(var U=N.length,G=c(s(I)),V=c(o(I)),$=l(G,G),j=l(V,V),k=Array(U).fill(c(0)),Z=Array(U).fill(c(0)),z=f(c(2),G,V,N[F][P]),me=r(n(l($,N[F][F]),z),l(j,N[P][P])),fe=h(l(j,N[F][F]),z,l($,N[P][P])),ue=0;ue<U;ue++)k[ue]=n(l(G,N[F][ue]),l(V,N[P][ue])),Z[ue]=r(l(V,N[F][ue]),l(G,N[P][ue]));N[F][F]=me,N[P][P]=fe,N[F][P]=c(0),N[P][F]=c(0);for(var le=0;le<U;le++)le!==F&&le!==P&&(N[F][le]=k[le],N[le][F]=k[le],N[P][le]=Z[le],N[le][P]=Z[le]);return N}function E(N,I,F,P){for(var U=N.length,G=Math.cos(I),V=Math.sin(I),$=G*G,j=V*V,k=Array(U).fill(0),Z=Array(U).fill(0),z=$*N[F][F]-2*G*V*N[F][P]+j*N[P][P],me=j*N[F][F]+2*G*V*N[F][P]+$*N[P][P],fe=0;fe<U;fe++)k[fe]=G*N[F][fe]-V*N[P][fe],Z[fe]=V*N[F][fe]+G*N[P][fe];N[F][F]=z,N[P][P]=me,N[F][P]=0,N[P][F]=0;for(var ue=0;ue<U;ue++)ue!==F&&ue!==P&&(N[F][ue]=k[ue],N[ue][F]=k[ue],N[P][ue]=Z[ue],N[ue][P]=Z[ue]);return N}function _(N){for(var I=N.length,F=0,P=[0,1],U=0;U<I;U++)for(var G=U+1;G<I;G++)Math.abs(F)<Math.abs(N[U][G])&&(F=Math.abs(N[U][G]),P=[U,G]);return[P,F]}function T(N){for(var I=N.length,F=0,P=[0,1],U=0;U<I;U++)for(var G=U+1;G<I;G++)i(F)<i(N[U][G])&&(F=i(N[U][G]),P=[U,G]);return[P,F]}function M(N,I,F){var P=N.length,U=Array(P),G;if(F){G=Array(P);for(var V=0;V<P;V++)G[V]=Array(P)}for(var $=0;$<P;$++){for(var j=0,k=N[0],Z=0;Z<N.length;Z++)i(N[Z])<i(k)&&(j=Z,k=N[j]);if(U[$]=N.splice(j,1)[0],F)for(var z=0;z<P;z++)G[$][z]=I[z][j],I[z].splice(j,1)}if(!F)return{values:U};var me=G.map((fe,ue)=>({value:U[ue],vector:fe}));return{values:U,eigenvectors:me}}return p}var Yoe="eigs",Koe=["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],Zoe=ee(Yoe,Koe,t=>{var{config:e,typed:r,matrix:n,addScalar:i,subtract:a,equal:s,abs:o,atan:l,cos:u,sin:c,multiplyScalar:f,divideScalar:h,inv:p,bignumber:m,multiply:v,add:y,larger:x,column:S,flatten:b,number:A,complex:E,sqrt:_,diag:T,size:M,reshape:N,qr:I,usolve:F,usolveAll:P,im:U,re:G,smaller:V,matrixFromColumns:$,dot:j}=t,k=joe({config:e,addScalar:i,subtract:a,column:S,flatten:b,equal:s,abs:o,atan:l,cos:u,sin:c,multiplyScalar:f,inv:p,bignumber:m,complex:E,multiply:v,add:y}),Z=Xoe({config:e,addScalar:i,subtract:a,multiply:v,multiplyScalar:f,flatten:b,divideScalar:h,sqrt:_,abs:o,bignumber:m,diag:T,size:M,reshape:N,qr:I,inv:p,usolve:F,usolveAll:P,equal:s,complex:E,larger:x,smaller:V,matrixFromColumns:$,dot:j});return r("eigs",{Array:function(Se){return z(n(Se))},"Array, number|BigNumber":function(Se,oe){return z(n(Se),{precision:oe})},"Array, Object"(Me,Se){return z(n(Me),Se)},Matrix:function(Se){return z(Se,{matricize:!0})},"Matrix, number|BigNumber":function(Se,oe){return z(Se,{precision:oe,matricize:!0})},"Matrix, Object":function(Se,oe){var K={matricize:!0};return Zn(K,oe),z(Se,K)}});function z(Me){var Se,oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},K="eigenvectors"in oe?oe.eigenvectors:!0,de=(Se=oe.precision)!==null&&Se!==void 0?Se:e.relTol,_e=me(Me,de,K);return oe.matricize&&(_e.values=n(_e.values),K&&(_e.eigenvectors=_e.eigenvectors.map(be=>{var{value:$e,vector:Oe}=be;return{value:$e,vector:n(Oe)}}))),K&&Object.defineProperty(_e,"vectors",{enumerable:!1,get:()=>{throw new Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),_e}function me(Me,Se,oe){var K=Me.toArray(),de=Me.size();if(de.length!==2||de[0]!==de[1])throw new RangeError("Matrix must be square (size: ".concat(yr(de),")"));var _e=de[0];if(ue(K,_e,Se)&&(le(K,_e),fe(K,_e,Se))){var be=ke(Me,K,_e);return k(K,_e,Se,be,oe)}var $e=ke(Me,K,_e);return Z(K,_e,Se,$e,oe)}function fe(Me,Se,oe){for(var K=0;K<Se;K++)for(var de=K;de<Se;de++)if(x(m(o(a(Me[K][de],Me[de][K]))),oe))return!1;return!0}function ue(Me,Se,oe){for(var K=0;K<Se;K++)for(var de=0;de<Se;de++)if(x(m(o(U(Me[K][de]))),oe))return!1;return!0}function le(Me,Se){for(var oe=0;oe<Se;oe++)for(var K=0;K<Se;K++)Me[oe][K]=G(Me[oe][K])}function ke(Me,Se,oe){var K=Me.datatype();if(K==="number"||K==="BigNumber"||K==="Complex")return K;for(var de=!1,_e=!1,be=!1,$e=0;$e<oe;$e++)for(var Oe=0;Oe<oe;Oe++){var Qe=Se[$e][Oe];if(sr(Qe)||zd(Qe))de=!0;else if(or(Qe))_e=!0;else if(pu(Qe))be=!0;else throw TypeError("Unsupported type in Matrix: "+tn(Qe))}if(_e&&be&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),be){for(var ae=0;ae<oe;ae++)for(var ce=0;ce<oe;ce++)Se[ae][ce]=E(Se[ae][ce]);return"Complex"}if(_e){for(var Ce=0;Ce<oe;Ce++)for(var Ue=0;Ue<oe;Ue++)Se[Ce][Ue]=m(Se[Ce][Ue]);return"BigNumber"}if(de){for(var Ve=0;Ve<oe;Ve++)for(var je=0;je<oe;je++)Se[Ve][je]=A(Se[Ve][je]);return"number"}else throw TypeError("Matrix contains unsupported types only.")}}),nT="expm",Qoe=["typed","abs","add","identity","inv","multiply"],Joe=ee(nT,Qoe,t=>{var{typed:e,abs:r,add:n,identity:i,inv:a,multiply:s}=t;return e(nT,{Matrix:function(f){var h=f.size();if(h.length!==2||h[0]!==h[1])throw new RangeError("Matrix must be square (size: "+yr(h)+")");for(var p=h[0],m=1e-15,v=o(f),y=l(v,m),x=y.q,S=y.j,b=s(f,Math.pow(2,-S)),A=i(p),E=i(p),_=1,T=b,M=-1,N=1;N<=x;N++)N>1&&(T=s(T,b),M=-M),_=_*(x-N+1)/((2*x-N+1)*N),A=n(A,s(_,T)),E=n(E,s(_*M,T));for(var I=s(a(E),A),F=0;F<S;F++)I=s(I,I);return fc(f)?f.createSparseMatrix(I):I}});function o(c){for(var f=c.size()[0],h=0,p=0;p<f;p++){for(var m=0,v=0;v<f;v++)m+=r(c.get([p,v]));h=Math.max(m,h)}return h}function l(c,f){for(var h=30,p=0;p<h;p++)for(var m=0;m<=p;m++){var v=p-m;if(u(c,m,v)<f)return{q:m,j:v}}throw new Error("Could not find acceptable parameters to compute the matrix exponential (try increasing maxSearchSize in expm.js)")}function u(c,f,h){for(var p=1,m=2;m<=f;m++)p*=m;for(var v=p,y=f+1;y<=2*f;y++)v*=y;var x=v*(2*f+1);return 8*Math.pow(c/Math.pow(2,h),2*f)*p*p/(v*x)}}),iT="sqrtm",eue=["typed","abs","add","multiply","map","sqrt","subtract","inv","size","max","identity"],tue=ee(iT,eue,t=>{var{typed:e,abs:r,add:n,multiply:i,map:a,sqrt:s,subtract:o,inv:l,size:u,max:c,identity:f}=t,h=1e3,p=1e-6;function m(v){var y,x=0,S=v,b=f(u(v));do{var A=S;if(S=i(.5,n(A,l(b))),b=i(.5,n(b,l(A))),y=c(r(o(S,A))),y>p&&++x>h)throw new Error("computing square root of matrix: iterative method could not converge")}while(y>p);return S}return e(iT,{"Array | Matrix":function(y){var x=Gt(y)?y.size():er(y);switch(x.length){case 1:if(x[0]===1)return a(y,s);throw new RangeError("Matrix must be square (size: "+yr(x)+")");case 2:{var S=x[0],b=x[1];if(S===b)return m(y);throw new RangeError("Matrix must be square (size: "+yr(x)+")")}default:throw new RangeError("Matrix must be at most two dimensional (size: "+yr(x)+")")}}})}),aT="sylvester",rue=["typed","schur","matrixFromColumns","matrix","multiply","range","concat","transpose","index","subset","add","subtract","identity","lusolve","abs"],nue=ee(aT,rue,t=>{var{typed:e,schur:r,matrixFromColumns:n,matrix:i,multiply:a,range:s,concat:o,transpose:l,index:u,subset:c,add:f,subtract:h,identity:p,lusolve:m,abs:v}=t;return e(aT,{"Matrix, Matrix, Matrix":y,"Array, Matrix, Matrix":function(S,b,A){return y(i(S),b,A)},"Array, Array, Matrix":function(S,b,A){return y(i(S),i(b),A)},"Array, Matrix, Array":function(S,b,A){return y(i(S),b,i(A))},"Matrix, Array, Matrix":function(S,b,A){return y(S,i(b),A)},"Matrix, Array, Array":function(S,b,A){return y(S,i(b),i(A))},"Matrix, Matrix, Array":function(S,b,A){return y(S,b,i(A))},"Array, Array, Array":function(S,b,A){return y(i(S),i(b),i(A)).toArray()}});function y(x,S,b){for(var A=S.size()[0],E=x.size()[0],_=r(x),T=_.T,M=_.U,N=r(a(-1,S)),I=N.T,F=N.U,P=a(a(l(M),b),F),U=s(0,E),G=[],V=(be,$e)=>o(be,$e,1),$=(be,$e)=>o(be,$e,0),j=0;j<A;j++)if(j<A-1&&v(c(I,u(j+1,j)))>1e-5){for(var k=$(c(P,u(U,j)),c(P,u(U,j+1))),Z=0;Z<j;Z++)k=f(k,$(a(G[Z],c(I,u(Z,j))),a(G[Z],c(I,u(Z,j+1)))));var z=a(p(E),a(-1,c(I,u(j,j)))),me=a(p(E),a(-1,c(I,u(j+1,j)))),fe=a(p(E),a(-1,c(I,u(j,j+1)))),ue=a(p(E),a(-1,c(I,u(j+1,j+1)))),le=$(V(f(T,z),me),V(fe,f(T,ue))),ke=m(le,k);G[j]=ke.subset(u(s(0,E),0)),G[j+1]=ke.subset(u(s(E,2*E),0)),j++}else{for(var Me=c(P,u(U,j)),Se=0;Se<j;Se++)Me=f(Me,a(G[Se],c(I,u(Se,j))));var oe=c(I,u(j,j)),K=h(T,a(oe,p(E)));G[j]=m(K,Me)}var de=i(n(...G)),_e=a(M,a(de,l(F)));return _e}}),sT="schur",iue=["typed","matrix","identity","multiply","qr","norm","subtract"],aue=ee(sT,iue,t=>{var{typed:e,matrix:r,identity:n,multiply:i,qr:a,norm:s,subtract:o}=t;return e(sT,{Array:function(c){var f=l(r(c));return{U:f.U.valueOf(),T:f.T.valueOf()}},Matrix:function(c){return l(c)}});function l(u){var c=u.size()[0],f=u,h=n(c),p=0,m;do{m=f;var v=a(f),y=v.Q,x=v.R;if(f=i(x,y),h=i(h,y),p++>100)break}while(s(o(f,m))>1e-4);return{U:h,T:f}}}),oT="lyap",sue=["typed","matrix","sylvester","multiply","transpose"],oue=ee(oT,sue,t=>{var{typed:e,matrix:r,sylvester:n,multiply:i,transpose:a}=t;return e(oT,{"Matrix, Matrix":function(o,l){return n(o,a(o),i(-1,l))},"Array, Matrix":function(o,l){return n(r(o),a(r(o)),i(-1,l))},"Matrix, Array":function(o,l){return n(o,a(r(o)),r(i(-1,l)))},"Array, Array":function(o,l){return n(r(o),a(r(o)),r(i(-1,l))).toArray()}})}),uue="divide",lue=["typed","matrix","multiply","equalScalar","divideScalar","inv"],cue=ee(uue,lue,t=>{var{typed:e,matrix:r,multiply:n,equalScalar:i,divideScalar:a,inv:s}=t,o=Ei({typed:e,equalScalar:i}),l=qs({typed:e});return e("divide",jM({"Array | Matrix, Array | Matrix":function(c,f){return n(c,s(f))},"DenseMatrix, any":function(c,f){return l(c,f,a,!1)},"SparseMatrix, any":function(c,f){return o(c,f,a,!1)},"Array, any":function(c,f){return l(r(c),f,a,!1).valueOf()},"any, Array | Matrix":function(c,f){return n(c,s(f))}},a.signatures))}),uT="distance",fue=["typed","addScalar","subtractScalar","divideScalar","multiplyScalar","deepEqual","sqrt","abs"],hue=ee(uT,fue,t=>{var{typed:e,addScalar:r,subtractScalar:n,multiplyScalar:i,divideScalar:a,deepEqual:s,sqrt:o,abs:l}=t;return e(uT,{"Array, Array, Array":function(E,_,T){if(E.length===2&&_.length===2&&T.length===2){if(!c(E))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!c(_))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!c(T))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(s(_,T))throw new TypeError("LinePoint1 should not be same with LinePoint2");var M=n(T[1],_[1]),N=n(_[0],T[0]),I=n(i(T[0],_[1]),i(_[0],T[1]));return y(E[0],E[1],M,N,I)}else throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(E,_,T){if(Object.keys(E).length===2&&Object.keys(_).length===2&&Object.keys(T).length===2){if(!c(E))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!c(_))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers or BigNumbers");if(!c(T))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers or BigNumbers");if(s(m(_),m(T)))throw new TypeError("LinePoint1 should not be same with LinePoint2");if("pointX"in E&&"pointY"in E&&"lineOnePtX"in _&&"lineOnePtY"in _&&"lineTwoPtX"in T&&"lineTwoPtY"in T){var M=n(T.lineTwoPtY,_.lineOnePtY),N=n(_.lineOnePtX,T.lineTwoPtX),I=n(i(T.lineTwoPtX,_.lineOnePtY),i(_.lineOnePtX,T.lineTwoPtY));return y(E.pointX,E.pointY,M,N,I)}else throw new TypeError("Key names do not match")}else throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(E,_){if(E.length===2&&_.length===3){if(!c(E))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!f(_))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return y(E[0],E[1],_[0],_[1],_[2])}else if(E.length===3&&_.length===6){if(!f(E))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!p(_))throw new TypeError("Array with 6 numbers or BigNumbers expected for second argument");return x(E[0],E[1],E[2],_[0],_[1],_[2],_[3],_[4],_[5])}else if(E.length===_.length&&E.length>0){if(!h(E))throw new TypeError("All values of an array should be numbers or BigNumbers");if(!h(_))throw new TypeError("All values of an array should be numbers or BigNumbers");return S(E,_)}else throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(E,_){if(Object.keys(E).length===2&&Object.keys(_).length===3){if(!c(E))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!f(_))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers or BigNumbers");if("pointX"in E&&"pointY"in E&&"xCoeffLine"in _&&"yCoeffLine"in _&&"constant"in _)return y(E.pointX,E.pointY,_.xCoeffLine,_.yCoeffLine,_.constant);throw new TypeError("Key names do not match")}else if(Object.keys(E).length===3&&Object.keys(_).length===6){if(!f(E))throw new TypeError("Values of pointX, pointY and pointZ should be numbers or BigNumbers");if(!p(_))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers or BigNumbers");if("pointX"in E&&"pointY"in E&&"x0"in _&&"y0"in _&&"z0"in _&&"a"in _&&"b"in _&&"c"in _)return x(E.pointX,E.pointY,E.pointZ,_.x0,_.y0,_.z0,_.a,_.b,_.c);throw new TypeError("Key names do not match")}else if(Object.keys(E).length===2&&Object.keys(_).length===2){if(!c(E))throw new TypeError("Values of pointOneX and pointOneY should be numbers or BigNumbers");if(!c(_))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers or BigNumbers");if("pointOneX"in E&&"pointOneY"in E&&"pointTwoX"in _&&"pointTwoY"in _)return S([E.pointOneX,E.pointOneY],[_.pointTwoX,_.pointTwoY]);throw new TypeError("Key names do not match")}else if(Object.keys(E).length===3&&Object.keys(_).length===3){if(!f(E))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers or BigNumbers");if(!f(_))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers or BigNumbers");if("pointOneX"in E&&"pointOneY"in E&&"pointOneZ"in E&&"pointTwoX"in _&&"pointTwoY"in _&&"pointTwoZ"in _)return S([E.pointOneX,E.pointOneY,E.pointOneZ],[_.pointTwoX,_.pointTwoY,_.pointTwoZ]);throw new TypeError("Key names do not match")}else throw new TypeError("Invalid Arguments: Try again")},Array:function(E){if(!v(E))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return b(E)}});function u(A){return typeof A=="number"||or(A)}function c(A){return A.constructor!==Array&&(A=m(A)),u(A[0])&&u(A[1])}function f(A){return A.constructor!==Array&&(A=m(A)),u(A[0])&&u(A[1])&&u(A[2])}function h(A){return Array.isArray(A)||(A=m(A)),A.every(u)}function p(A){return A.constructor!==Array&&(A=m(A)),u(A[0])&&u(A[1])&&u(A[2])&&u(A[3])&&u(A[4])&&u(A[5])}function m(A){for(var E=Object.keys(A),_=[],T=0;T<E.length;T++)_.push(A[E[T]]);return _}function v(A){if(A[0].length===2&&u(A[0][0])&&u(A[0][1])){if(A.some(E=>E.length!==2||!u(E[0])||!u(E[1])))return!1}else if(A[0].length===3&&u(A[0][0])&&u(A[0][1])&&u(A[0][2])){if(A.some(E=>E.length!==3||!u(E[0])||!u(E[1])||!u(E[2])))return!1}else return!1;return!0}function y(A,E,_,T,M){var N=l(r(r(i(_,A),i(T,E)),M)),I=o(r(i(_,_),i(T,T)));return a(N,I)}function x(A,E,_,T,M,N,I,F,P){var U=[n(i(n(M,E),P),i(n(N,_),F)),n(i(n(N,_),I),i(n(T,A),P)),n(i(n(T,A),F),i(n(M,E),I))];U=o(r(r(i(U[0],U[0]),i(U[1],U[1])),i(U[2],U[2])));var G=o(r(r(i(I,I),i(F,F)),i(P,P)));return a(U,G)}function S(A,E){for(var _=A.length,T=0,M=0,N=0;N<_;N++)M=n(A[N],E[N]),T=r(i(M,M),T);return o(T)}function b(A){for(var E=[],_=[],T=[],M=0;M<A.length-1;M++)for(var N=M+1;N<A.length;N++)A[0].length===2?(_=[A[M][0],A[M][1]],T=[A[N][0],A[N][1]]):A[0].length===3&&(_=[A[M][0],A[M][1],A[M][2]],T=[A[N][0],A[N][1],A[N][2]]),E.push(S(_,T));return E}}),due="intersect",pue=["typed","config","abs","add","addScalar","matrix","multiply","multiplyScalar","divideScalar","subtract","smaller","equalScalar","flatten","isZero","isNumeric"],mue=ee(due,pue,t=>{var{typed:e,config:r,abs:n,add:i,addScalar:a,matrix:s,multiply:o,multiplyScalar:l,divideScalar:u,subtract:c,smaller:f,equalScalar:h,flatten:p,isZero:m,isNumeric:v}=t;return e("intersect",{"Array, Array, Array":y,"Array, Array, Array, Array":x,"Matrix, Matrix, Matrix":function(F,P,U){var G=y(F.valueOf(),P.valueOf(),U.valueOf());return G===null?null:s(G)},"Matrix, Matrix, Matrix, Matrix":function(F,P,U,G){var V=x(F.valueOf(),P.valueOf(),U.valueOf(),G.valueOf());return V===null?null:s(V)}});function y(I,F,P){if(I=S(I),F=S(F),P=S(P),!A(I))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!A(F))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!E(P))throw new TypeError("Array with 4 numbers expected as third argument");return N(I[0],I[1],I[2],F[0],F[1],F[2],P[0],P[1],P[2],P[3])}function x(I,F,P,U){if(I=S(I),F=S(F),P=S(P),U=S(U),I.length===2){if(!b(I))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!b(F))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!b(P))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(!b(U))throw new TypeError("Array with 2 numbers or BigNumbers expected for fourth argument");return _(I,F,P,U)}else if(I.length===3){if(!A(I))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!A(F))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!A(P))throw new TypeError("Array with 3 numbers or BigNumbers expected for third argument");if(!A(U))throw new TypeError("Array with 3 numbers or BigNumbers expected for fourth argument");return M(I[0],I[1],I[2],F[0],F[1],F[2],P[0],P[1],P[2],U[0],U[1],U[2])}else throw new TypeError("Arrays with two or thee dimensional points expected")}function S(I){return I.length===1?I[0]:I.length>1&&Array.isArray(I[0])&&I.every(F=>Array.isArray(F)&&F.length===1)?p(I):I}function b(I){return I.length===2&&v(I[0])&&v(I[1])}function A(I){return I.length===3&&v(I[0])&&v(I[1])&&v(I[2])}function E(I){return I.length===4&&v(I[0])&&v(I[1])&&v(I[2])&&v(I[3])}function _(I,F,P,U){var G=I,V=P,$=c(G,F),j=c(V,U),k=c(l($[0],j[1]),l(j[0],$[1]));if(m(k)||f(n(k),r.relTol))return null;var Z=l(j[0],G[1]),z=l(j[1],G[0]),me=l(j[0],V[1]),fe=l(j[1],V[0]),ue=u(a(c(c(Z,z),me),fe),k);return i(o($,ue),G)}function T(I,F,P,U,G,V,$,j,k,Z,z,me){var fe=l(c(I,F),c(P,U)),ue=l(c(G,V),c($,j)),le=l(c(k,Z),c(z,me));return a(a(fe,ue),le)}function M(I,F,P,U,G,V,$,j,k,Z,z,me){var fe=T(I,$,Z,$,F,j,z,j,P,k,me,k),ue=T(Z,$,U,I,z,j,G,F,me,k,V,P),le=T(I,$,U,I,F,j,G,F,P,k,V,P),ke=T(Z,$,Z,$,z,j,z,j,me,k,me,k),Me=T(U,I,U,I,G,F,G,F,V,P,V,P),Se=c(l(fe,ue),l(le,ke)),oe=c(l(Me,ke),l(ue,ue));if(m(oe))return null;var K=u(Se,oe),de=u(a(fe,l(K,ue)),ke),_e=a(I,l(K,c(U,I))),be=a(F,l(K,c(G,F))),$e=a(P,l(K,c(V,P))),Oe=a($,l(de,c(Z,$))),Qe=a(j,l(de,c(z,j))),ae=a(k,l(de,c(me,k)));return h(_e,Oe)&&h(be,Qe)&&h($e,ae)?[_e,be,$e]:null}function N(I,F,P,U,G,V,$,j,k,Z){var z=l(I,$),me=l(U,$),fe=l(F,j),ue=l(G,j),le=l(P,k),ke=l(V,k),Me=c(c(c(Z,z),fe),le),Se=c(c(c(a(a(me,ue),ke),z),fe),le),oe=u(Me,Se),K=a(I,l(oe,c(U,I))),de=a(F,l(oe,c(G,F))),_e=a(P,l(oe,c(V,P)));return[K,de,_e]}}),lT="sum",vue=["typed","config","add","numeric"],LF=ee(lT,vue,t=>{var{typed:e,config:r,add:n,numeric:i}=t;return e(lT,{"Array | Matrix":a,"Array | Matrix, number | BigNumber":s,"...":function(l){if(_h(l))throw new TypeError("Scalar values expected in function sum");return a(l)}});function a(o){var l;return ml(o,function(u){try{l=l===void 0?u:n(l,u)}catch(c){throw Yi(c,"sum",u)}}),l===void 0&&(l=i(0,r.number)),typeof l=="string"&&(l=i(l,bl(l,r))),l}function s(o,l){try{var u=lg(o,l,n);return u}catch(c){throw Yi(c,"sum")}}}),xm="cumsum",gue=["typed","add","unaryPlus"],UF=ee(xm,gue,t=>{var{typed:e,add:r,unaryPlus:n}=t;return e(xm,{Array:i,Matrix:function(u){return u.create(i(u.valueOf(),u.datatype()))},"Array, number | BigNumber":s,"Matrix, number | BigNumber":function(u,c){return u.create(s(u.valueOf(),c),u.datatype())},"...":function(u){if(_h(u))throw new TypeError("All values expected to be scalar in function cumsum");return i(u)}});function i(l){try{return a(l)}catch(u){throw Yi(u,xm)}}function a(l){if(l.length===0)return[];for(var u=[n(l[0])],c=1;c<l.length;++c)u.push(r(u[c-1],l[c]));return u}function s(l,u){var c=er(l);if(u<0||u>=c.length)throw new zs(u,c.length);try{return o(l,u)}catch(f){throw Yi(f,xm)}}function o(l,u){var c,f,h;if(u<=0){var p=l[0][0];if(Array.isArray(p)){for(h=_I(l),f=[],c=0;c<h.length;c++)f[c]=o(h[c],u-1);return f}else return a(l)}else{for(f=[],c=0;c<l.length;c++)f[c]=o(l[c],u-1);return f}}}),cT="mean",yue=["typed","add","divide"],zF=ee(cT,yue,t=>{var{typed:e,add:r,divide:n}=t;return e(cT,{"Array | Matrix":a,"Array | Matrix, number | BigNumber":i,"...":function(o){if(_h(o))throw new TypeError("Scalar values expected in function mean");return a(o)}});function i(s,o){try{var l=lg(s,o,r),u=Array.isArray(s)?er(s):s.size();return n(l,u[o])}catch(c){throw Yi(c,"mean")}}function a(s){var o,l=0;if(ml(s,function(u){try{o=o===void 0?u:r(o,u),l++}catch(c){throw Yi(c,"mean",u)}}),l===0)throw new Error("Cannot calculate the mean of an empty array");return n(o,l)}}),fT="median",bue=["typed","add","divide","compare","partitionSelect"],xue=ee(fT,bue,t=>{var{typed:e,add:r,divide:n,compare:i,partitionSelect:a}=t;function s(u){try{u=Lr(u.valueOf());var c=u.length;if(c===0)throw new Error("Cannot calculate median of an empty array");if(c%2===0){for(var f=c/2-1,h=a(u,f+1),p=u[f],m=0;m<f;++m)i(u[m],p)>0&&(p=u[m]);return l(p,h)}else{var v=a(u,(c-1)/2);return o(v)}}catch(y){throw Yi(y,"median")}}var o=e({"number | BigNumber | Complex | Unit":function(c){return c}}),l=e({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(c,f){return n(r(c,f),2)}});return e(fT,{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(c,f){throw new Error("median(A, dim) is not yet supported")},"...":function(c){if(_h(c))throw new TypeError("Scalar values expected in function median");return s(c)}})}),hT="mad",wue=["typed","abs","map","median","subtract"],_ue=ee(hT,wue,t=>{var{typed:e,abs:r,map:n,median:i,subtract:a}=t;return e(hT,{"Array | Matrix":s,"...":function(l){return s(l)}});function s(o){if(o=Lr(o.valueOf()),o.length===0)throw new Error("Cannot calculate median absolute deviation (mad) of an empty array");try{var l=i(o);return i(n(o,function(u){return r(a(u,l))}))}catch(u){throw u instanceof TypeError&&u.message.includes("median")?new TypeError(u.message.replace("median","mad")):Yi(u,"mad")}}}),fy="unbiased",dT="variance",Aue=["typed","add","subtract","multiply","divide","mapSlices","isNaN"],GF=ee(dT,Aue,t=>{var{typed:e,add:r,subtract:n,multiply:i,divide:a,mapSlices:s,isNaN:o}=t;return e(dT,{"Array | Matrix":function(f){return l(f,fy)},"Array | Matrix, string":l,"Array | Matrix, number | BigNumber":function(f,h){return u(f,h,fy)},"Array | Matrix, number | BigNumber, string":u,"...":function(f){return l(f,fy)}});function l(c,f){var h,p=0;if(c.length===0)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");if(ml(c,function(y){try{h=h===void 0?y:r(h,y),p++}catch(x){throw Yi(x,"variance",y)}}),p===0)throw new Error("Cannot calculate variance of an empty array");var m=a(h,p);if(h=void 0,ml(c,function(y){var x=n(y,m);h=h===void 0?i(x,x):r(h,i(x,x))}),o(h))return h;switch(f){case"uncorrected":return a(h,p);case"biased":return a(h,p+1);case"unbiased":{var v=or(h)?h.mul(0):0;return p===1?v:a(h,p-1)}default:throw new Error('Unknown normalization "'+f+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function u(c,f,h){try{if(c.length===0)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");return s(c,f,p=>l(p,h))}catch(p){throw Yi(p,"variance")}}}),pT="quantileSeq",Eue=["typed","?bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger","mapSlices"],qF=ee(pT,Eue,t=>{var{typed:e,bignumber:r,add:n,subtract:i,divide:a,multiply:s,partitionSelect:o,compare:l,isInteger:u,smaller:c,smallerEq:f,larger:h,mapSlices:p}=t;return e(pT,{"Array | Matrix, number | BigNumber":(S,b)=>v(S,b,!1),"Array | Matrix, number | BigNumber, number":(S,b,A)=>m(S,b,!1,A,v),"Array | Matrix, number | BigNumber, boolean":v,"Array | Matrix, number | BigNumber, boolean, number":(S,b,A,E)=>m(S,b,A,E,v),"Array | Matrix, Array | Matrix":(S,b)=>y(S,b,!1),"Array | Matrix, Array | Matrix, number":(S,b,A)=>m(S,b,!1,A,y),"Array | Matrix, Array | Matrix, boolean":y,"Array | Matrix, Array | Matrix, boolean, number":(S,b,A,E)=>m(S,b,A,E,y)});function m(S,b,A,E,_){return p(S,E,T=>_(T,b,A))}function v(S,b,A){var E,_=S.valueOf();if(c(b,0))throw new Error("N/prob must be non-negative");if(f(b,1))return sr(b)?x(_,b,A):r(x(_,b,A));if(h(b,1)){if(!u(b))throw new Error("N must be a positive integer");if(h(b,4294967295))throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var T=n(b,1);E=[];for(var M=0;c(M,b);M++){var N=a(M+1,T);E.push(x(_,N,A))}return sr(b)?E:r(E)}}function y(S,b,A){for(var E=S.valueOf(),_=b.valueOf(),T=[],M=0;M<_.length;++M)T.push(x(E,_[M],A));return T}function x(S,b,A){var E=Lr(S),_=E.length;if(_===0)throw new Error("Cannot calculate quantile of an empty sequence");var T=sr(b)?b*(_-1):b.times(_-1),M=sr(b)?Math.floor(T):T.floor().toNumber(),N=sr(b)?T%1:T.minus(M);if(u(T))return A?E[T]:o(E,sr(b)?T:T.valueOf());var I,F;if(A)I=E[M],F=E[M+1];else{F=o(E,M+1),I=E[M];for(var P=0;P<M;++P)l(E[P],I)>0&&(I=E[P])}return n(s(I,i(1,N)),s(F,N))}}),mT="std",Sue=["typed","map","sqrt","variance"],HF=ee(mT,Sue,t=>{var{typed:e,map:r,sqrt:n,variance:i}=t;return e(mT,{"Array | Matrix":a,"Array | Matrix, string":a,"Array | Matrix, number | BigNumber":a,"Array | Matrix, number | BigNumber, string":a,"...":function(o){return a(o)}});function a(s,o){if(s.length===0)throw new SyntaxError("Function std requires one or more parameters (0 provided)");try{var l=i.apply(null,arguments);return is(l)?r(l,n):n(l)}catch(u){throw u instanceof TypeError&&u.message.includes(" variance")?new TypeError(u.message.replace(" variance"," std")):u}}}),vT="corr",Due=["typed","matrix","mean","sqrt","sum","add","subtract","multiply","pow","divide"],Cue=ee(vT,Due,t=>{var{typed:e,matrix:r,sqrt:n,sum:i,add:a,subtract:s,multiply:o,pow:l,divide:u}=t;return e(vT,{"Array, Array":function(p,m){return c(p,m)},"Matrix, Matrix":function(p,m){var v=c(p.toArray(),m.toArray());return Array.isArray(v)?r(v):v}});function c(h,p){var m=[];if(Array.isArray(h[0])&&Array.isArray(p[0])){if(h.length!==p.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same length.");for(var v=0;v<h.length;v++){if(h[v].length!==p[v].length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");m.push(f(h[v],p[v]))}return m}else{if(h.length!==p.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");return f(h,p)}}function f(h,p){var m=h.length,v=i(h),y=i(p),x=h.reduce((_,T,M)=>a(_,o(T,p[M])),0),S=i(h.map(_=>l(_,2))),b=i(p.map(_=>l(_,2))),A=s(o(m,x),o(v,y)),E=n(o(s(o(m,S),l(v,2)),s(o(m,b),l(y,2))));return u(A,E)}}),gT="combinations",Tue=["typed"],Nue=ee(gT,Tue,t=>{var{typed:e}=t;return e(gT,{"number, number":qI,"BigNumber, BigNumber":function(n,i){var a=n.constructor,s,o,l=n.minus(i),u=new a(1);if(!yT(n)||!yT(i))throw new TypeError("Positive integer value expected in function combinations");if(i.gt(n))throw new TypeError("k must be less than n in function combinations");if(s=u,i.lt(l))for(o=u;o.lte(l);o=o.plus(u))s=s.times(i.plus(o)).dividedBy(o);else for(o=u;o.lte(i);o=o.plus(u))s=s.times(l.plus(o)).dividedBy(o);return s}})});function yT(t){return t.isInteger()&&t.gte(0)}var bT="combinationsWithRep",Mue=["typed"],Iue=ee(bT,Mue,t=>{var{typed:e}=t;return e(bT,{"number, number":function(n,i){if(!Bt(n)||n<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(!Bt(i)||i<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(n<1)throw new TypeError("k must be less than or equal to n + k - 1");if(i<n-1){var a=cu(n,n+i-1);return a/cu(1,i)}var s=cu(i+1,n+i-1);return s/cu(1,n-1)},"BigNumber, BigNumber":function(n,i){var a=n.constructor,s,o,l=new a(1),u=n.minus(l);if(!xT(n)||!xT(i))throw new TypeError("Positive integer value expected in function combinationsWithRep");if(n.lt(l))throw new TypeError("k must be less than or equal to n + k - 1 in function combinationsWithRep");if(s=l,i.lt(u))for(o=l;o.lte(u);o=o.plus(l))s=s.times(i.plus(o)).dividedBy(o);else for(o=l;o.lte(i);o=o.plus(l))s=s.times(u.plus(o)).dividedBy(o);return s}})});function xT(t){return t.isInteger()&&t.gte(0)}var wT="gamma",Fue=["typed","config","multiplyScalar","pow","BigNumber","Complex"],Oue=ee(wT,Fue,t=>{var{typed:e,config:r,multiplyScalar:n,pow:i,BigNumber:a,Complex:s}=t;function o(u){if(u.im===0)return wv(u.re);if(u.re<.5){var c=new s(1-u.re,-u.im),f=new s(Math.PI*u.re,Math.PI*u.im);return new s(Math.PI).div(f.sin()).div(o(c))}u=new s(u.re-1,u.im);for(var h=new s(Hf[0],0),p=1;p<Hf.length;++p){var m=new s(Hf[p],0);h=h.add(m.div(u.add(p)))}var v=new s(u.re+WI+.5,u.im),y=Math.sqrt(2*Math.PI),x=v.pow(u.add(.5)),S=v.neg().exp();return h.mul(y).mul(x).mul(S)}return e(wT,{number:wv,Complex:o,BigNumber:function(c){if(c.isInteger())return c.isNegative()||c.isZero()?new a(1/0):l(c.minus(1));if(!c.isFinite())return new a(c.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")}});function l(u){if(u<8)return new a([1,1,2,6,24,120,720,5040][u]);var c=r.precision+(Math.log(u.toNumber())|0),f=a.clone({precision:c});if(u%2===1)return u.times(l(new a(u-1)));for(var h=u,p=new f(u),m=u.toNumber();h>2;)h-=2,m+=h,p=p.times(m);return new a(p.toPrecision(a.precision))}}),_T="lgamma",Bue=["Complex","typed"],Rue=ee(_T,Bue,t=>{var{Complex:e,typed:r}=t,n=7,i=7,a=[-.029550653594771242,.00641025641025641,-.0019175269175269176,.0008417508417508417,-.0005952380952380953,.0007936507936507937,-.002777777777777778,.08333333333333333];return r(_T,{number:_v,Complex:s,BigNumber:function(){throw new Error("mathjs doesn't yet provide an implementation of the algorithm lgamma for BigNumber")}});function s(u){var c=6.283185307179586,f=1.1447298858494002,h=.1;if(u.isNaN())return new e(NaN,NaN);if(u.im===0)return new e(_v(u.re),0);if(u.re>=n||Math.abs(u.im)>=i)return o(u);if(u.re<=h){var p=_W(c,u.im)*Math.floor(.5*u.re+.25),m=u.mul(Math.PI).sin().log(),v=s(new e(1-u.re,-u.im));return new e(f,p).sub(m).sub(v)}else return u.im>=0?l(u):l(u.conjugate()).conjugate()}function o(u){for(var c=u.sub(.5).mul(u.log()).sub(u).add(VI),f=new e(1,0).div(u),h=f.div(u),p=a[0],m=a[1],v=2*h.re,y=h.re*h.re+h.im*h.im,x=2;x<8;x++){var S=m;m=-y*p+a[x],p=v*p+S}var b=f.mul(h.mul(p).add(m));return c.add(b)}function l(u){var c=0,f=0,h=u;for(u=u.add(1);u.re<=n;){h=h.mul(u);var p=h.im<0?1:0;p!==0&&f===0&&c++,f=p,u=u.add(1)}return o(u).sub(h.log()).sub(new e(0,c*2*Math.PI*1))}}),AT="factorial",Pue=["typed","gamma"],$ue=ee(AT,Pue,t=>{var{typed:e,gamma:r}=t;return e(AT,{number:function(i){if(i<0)throw new Error("Value must be non-negative");return r(i+1)},BigNumber:function(i){if(i.isNegative())throw new Error("Value must be non-negative");return r(i.plus(1))},"Array | Matrix":e.referToSelf(n=>i=>ur(i,n))})}),ET="kldivergence",kue=["typed","matrix","divide","sum","multiply","map","dotDivide","log","isNumeric"],Lue=ee(ET,kue,t=>{var{typed:e,matrix:r,divide:n,sum:i,multiply:a,map:s,dotDivide:o,log:l,isNumeric:u}=t;return e(ET,{"Array, Array":function(h,p){return c(r(h),r(p))},"Matrix, Array":function(h,p){return c(h,r(p))},"Array, Matrix":function(h,p){return c(r(h),p)},"Matrix, Matrix":function(h,p){return c(h,p)}});function c(f,h){var p=h.size().length,m=f.size().length;if(p>1)throw new Error("first object must be one dimensional");if(m>1)throw new Error("second object must be one dimensional");if(p!==m)throw new Error("Length of two vectors must be equal");var v=i(f);if(v===0)throw new Error("Sum of elements in first object must be non zero");var y=i(h);if(y===0)throw new Error("Sum of elements in second object must be non zero");var x=n(f,i(f)),S=n(h,i(h)),b=i(a(x,s(o(x,S),A=>l(A))));return u(b)?b:Number.NaN}}),ST="multinomial",Uue=["typed","add","divide","multiply","factorial","isInteger","isPositive"],zue=ee(ST,Uue,t=>{var{typed:e,add:r,divide:n,multiply:i,factorial:a,isInteger:s,isPositive:o}=t;return e(ST,{"Array | Matrix":function(u){var c=0,f=1;return ml(u,function(h){if(!s(h)||!o(h))throw new TypeError("Positive integer value expected in function multinomial");c=r(c,h),f=i(f,a(h))}),n(a(c),f)}})}),DT="permutations",Gue=["typed","factorial"],que=ee(DT,Gue,t=>{var{typed:e,factorial:r}=t;return e(DT,{"number | BigNumber":r,"number, number":function(i,a){if(!Bt(i)||i<0)throw new TypeError("Positive integer value expected in function permutations");if(!Bt(a)||a<0)throw new TypeError("Positive integer value expected in function permutations");if(a>i)throw new TypeError("second argument k must be less than or equal to first argument n");return cu(i-a+1,i)},"BigNumber, BigNumber":function(i,a){var s,o;if(!CT(i)||!CT(a))throw new TypeError("Positive integer value expected in function permutations");if(a.gt(i))throw new TypeError("second argument k must be less than or equal to first argument n");var l=i.mul(0).add(1);for(s=l,o=i.minus(a).plus(1);o.lte(i);o=o.plus(1))s=s.times(o);return s}})});function CT(t){return t.isInteger()&&t.gte(0)}var ix={exports:{}};ix.exports;(function(t){(function(e,r,n){function i(l){var u=this,c=o();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function a(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function s(l,u){var c=new i(l),f=u&&u.state,h=c.next;return h.int32=function(){return c.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,f&&(typeof f=="object"&&a(f,c),h.state=function(){return a(c,{})}),h}function o(){var l=4022871197,u=function(c){c=String(c);for(var f=0;f<c.length;f++){l+=c.charCodeAt(f);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return u}r&&r.exports?r.exports=s:this.alea=s})(Qn,t)})(ix);var Hue=ix.exports,ax={exports:{}};ax.exports;(function(t){(function(e,r,n){function i(o){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var f=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^f^f>>>8},o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function s(o,l){var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,m=(h+p)/(1<<21);while(m===0);return m},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&a(c,u),f.state=function(){return a(u,{})}),f}r&&r.exports?r.exports=s:this.xor128=s})(Qn,t)})(ax);var Wue=ax.exports,sx={exports:{}};sx.exports;(function(t){(function(e,r,n){function i(o){var l=this,u="";l.next=function(){var f=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(f^f<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function s(o,l){var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,m=(h+p)/(1<<21);while(m===0);return m},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&a(c,u),f.state=function(){return a(u,{})}),f}r&&r.exports?r.exports=s:this.xorwow=s})(Qn,t)})(sx);var Vue=sx.exports,ox={exports:{}};ox.exports;(function(t){(function(e,r,n){function i(o){var l=this;l.next=function(){var c=l.x,f=l.i,h,p;return h=c[f],h^=h>>>7,p=h^h<<24,h=c[f+1&7],p^=h^h>>>10,h=c[f+3&7],p^=h^h>>>3,h=c[f+4&7],p^=h^h<<7,h=c[f+7&7],h=h^h<<13,p^=h^h<<9,c[f]=p,l.i=f+1&7,p};function u(c,f){var h,p=[];if(f===(f|0))p[0]=f;else for(f=""+f,h=0;h<f.length;++h)p[h&7]=p[h&7]<<15^f.charCodeAt(h)+p[h+1&7]<<13;for(;p.length<8;)p.push(0);for(h=0;h<8&&p[h]===0;++h);for(h==8?p[7]=-1:p[h],c.x=p,c.i=0,h=256;h>0;--h)c.next()}u(l,o)}function a(o,l){return l.x=o.x.slice(),l.i=o.i,l}function s(o,l){o==null&&(o=+new Date);var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,m=(h+p)/(1<<21);while(m===0);return m},f.int32=u.next,f.quick=f,c&&(c.x&&a(c,u),f.state=function(){return a(u,{})}),f}r&&r.exports?r.exports=s:this.xorshift7=s})(Qn,t)})(ox);var Xue=ox.exports,ux={exports:{}};ux.exports;(function(t){(function(e,r,n){function i(o){var l=this;l.next=function(){var c=l.w,f=l.X,h=l.i,p,m;return l.w=c=c+1640531527|0,m=f[h+34&127],p=f[h=h+1&127],m^=m<<13,p^=p<<17,m^=m>>>15,p^=p>>>12,m=f[h]=m^p,l.i=h,m+(c^c>>>16)|0};function u(c,f){var h,p,m,v,y,x=[],S=128;for(f===(f|0)?(p=f,f=null):(f=f+"\0",p=0,S=Math.max(S,f.length)),m=0,v=-32;v<S;++v)f&&(p^=f.charCodeAt((v+32)%f.length)),v===0&&(y=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,v>=0&&(y=y+1640531527|0,h=x[v&127]^=p+y,m=h==0?m+1:0);for(m>=128&&(x[(f&&f.length||0)&127]=-1),m=127,v=4*128;v>0;--v)p=x[m+34&127],h=x[m=m+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,x[m]=p^h;c.w=y,c.X=x,c.i=m}u(l,o)}function a(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function s(o,l){o==null&&(o=+new Date);var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,m=(h+p)/(1<<21);while(m===0);return m},f.int32=u.next,f.quick=f,c&&(c.X&&a(c,u),f.state=function(){return a(u,{})}),f}r&&r.exports?r.exports=s:this.xor4096=s})(Qn,t)})(ux);var jue=ux.exports,lx={exports:{}};lx.exports;(function(t){(function(e,r,n){function i(o){var l=this,u="";l.next=function(){var f=l.b,h=l.c,p=l.d,m=l.a;return f=f<<25^f>>>7^h,h=h-p|0,p=p<<24^p>>>8^m,m=m-f|0,l.b=f=f<<20^f>>>12^h,l.c=h=h-p|0,l.d=p<<16^h>>>16^m,l.a=m-f|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):u+=o;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function a(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function s(o,l){var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,m=(h+p)/(1<<21);while(m===0);return m},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&a(c,u),f.state=function(){return a(u,{})}),f}r&&r.exports?r.exports=s:this.tychei=s})(Qn,t)})(lx);var Yue=lx.exports,WF={exports:{}};(function(t){(function(e,r,n){var i=256,a=6,s=52,o="random",l=n.pow(i,a),u=n.pow(2,s),c=u*2,f=i-1,h;function p(A,E,_){var T=[];E=E==!0?{entropy:!0}:E||{};var M=x(y(E.entropy?[A,b(r)]:A??S(),3),T),N=new m(T),I=function(){for(var F=N.g(a),P=l,U=0;F<u;)F=(F+U)*i,P*=i,U=N.g(1);for(;F>=c;)F/=2,P/=2,U>>>=1;return(F+U)/P};return I.int32=function(){return N.g(4)|0},I.quick=function(){return N.g(4)/4294967296},I.double=I,x(b(N.S),r),(E.pass||_||function(F,P,U,G){return G&&(G.S&&v(G,N),F.state=function(){return v(N,{})}),U?(n[o]=F,P):F})(I,M,"global"in E?E.global:this==n,E.state)}function m(A){var E,_=A.length,T=this,M=0,N=T.i=T.j=0,I=T.S=[];for(_||(A=[_++]);M<i;)I[M]=M++;for(M=0;M<i;M++)I[M]=I[N=f&N+A[M%_]+(E=I[M])],I[N]=E;(T.g=function(F){for(var P,U=0,G=T.i,V=T.j,$=T.S;F--;)P=$[G=f&G+1],U=U*i+$[f&($[G]=$[V=f&V+P])+($[V]=P)];return T.i=G,T.j=V,U})(i)}function v(A,E){return E.i=A.i,E.j=A.j,E.S=A.S.slice(),E}function y(A,E){var _=[],T=typeof A,M;if(E&&T=="object")for(M in A)try{_.push(y(A[M],E-1))}catch{}return _.length?_:T=="string"?A:A+"\0"}function x(A,E){for(var _=A+"",T,M=0;M<_.length;)E[f&M]=f&(T^=E[f&M]*19)+_.charCodeAt(M++);return b(E)}function S(){try{var A;return h&&(A=h.randomBytes)?A=A(i):(A=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(A)),b(A)}catch{var E=e.navigator,_=E&&E.plugins;return[+new Date,e,_,e.screen,b(r)]}}function b(A){return String.fromCharCode.apply(0,A)}if(x(n.random(),r),t.exports){t.exports=p;try{h=K2}catch{}}else n["seed"+o]=p})(typeof self<"u"?self:Qn,[],Math)})(WF);var Kue=WF.exports,Zue=Hue,Que=Wue,Jue=Vue,ele=Xue,tle=jue,rle=Yue,Tc=Kue;Tc.alea=Zue;Tc.xor128=Que;Tc.xorwow=Jue;Tc.xorshift7=ele;Tc.xor4096=tle;Tc.tychei=rle;var nle=Tc;const VF=gl(nle);var ile=VF(Date.now());function sh(t){var e;function r(i){e=i===null?ile:VF(String(i))}r(t);function n(){return e()}return n}var TT="pickRandom",ale=["typed","config","?on"],sle=ee(TT,ale,t=>{var{typed:e,config:r,on:n}=t,i=sh(r.randomSeed);return n&&n("config",function(s,o){s.randomSeed!==o.randomSeed&&(i=sh(s.randomSeed))}),e(TT,{"Array | Matrix":function(o){return a(o,{})},"Array | Matrix, Object":function(o,l){return a(o,l)},"Array | Matrix, number":function(o,l){return a(o,{number:l})},"Array | Matrix, Array | Matrix":function(o,l){return a(o,{weights:l})},"Array | Matrix, Array | Matrix, number":function(o,l,u){return a(o,{number:u,weights:l})},"Array | Matrix, number, Array | Matrix":function(o,l,u){return a(o,{number:l,weights:u})}});function a(s,o){var{number:l,weights:u,elementWise:c=!0}=o,f=typeof l>"u";f&&(l=1);var h=Gt(s)?s.create:Gt(u)?u.create:null;s=s.valueOf(),u&&(u=u.valueOf()),c===!0&&(s=Lr(s),u=Lr(u));var p=0;if(typeof u<"u"){if(u.length!==s.length)throw new Error("Weights must have the same length as possibles");for(var m=0,v=u.length;m<v;m++){if(!sr(u[m])||u[m]<0)throw new Error("Weights must be an array of positive numbers");p+=u[m]}}for(var y=s.length,x=[],S;x.length<l;){if(typeof u>"u")S=s[Math.floor(i()*y)];else for(var b=i()*p,A=0,E=s.length;A<E;A++)if(b-=u[A],b<0){S=s[A];break}x.push(S)}return f?x[0]:h?h(x):x}});function cx(t,e){var r=[];if(t=t.slice(0),t.length>1)for(var n=0,i=t.shift();n<i;n++)r.push(cx(t,e));else for(var a=0,s=t.shift();a<s;a++)r.push(e());return r}var NT="random",ole=["typed","config","?on"],ule=ee(NT,ole,t=>{var{typed:e,config:r,on:n}=t,i=sh(r.randomSeed);return n&&n("config",function(o,l){o.randomSeed!==l.randomSeed&&(i=sh(o.randomSeed))}),e(NT,{"":()=>s(0,1),number:o=>s(0,o),"number, number":(o,l)=>s(o,l),"Array | Matrix":o=>a(o,0,1),"Array | Matrix, number":(o,l)=>a(o,0,l),"Array | Matrix, number, number":(o,l,u)=>a(o,l,u)});function a(o,l,u){var c=cx(o.valueOf(),()=>s(l,u));return Gt(o)?o.create(c,"number"):c}function s(o,l){return o+i()*(l-o)}}),MT="randomInt",lle=["typed","config","log2","?on"],cle=ee(MT,lle,t=>{var{typed:e,config:r,log2:n,on:i}=t,a=sh(r.randomSeed);return i&&i("config",function(u,c){u.randomSeed!==c.randomSeed&&(a=sh(u.randomSeed))}),e(MT,{"":()=>o(0,2),number:u=>o(0,u),"number, number":(u,c)=>o(u,c),bigint:u=>l(0n,u),"bigint, bigint":l,"Array | Matrix":u=>s(u,0,1),"Array | Matrix, number":(u,c)=>s(u,0,c),"Array | Matrix, number, number":(u,c,f)=>s(u,c,f)});function s(u,c,f){var h=cx(u.valueOf(),()=>o(c,f));return Gt(u)?u.create(h,"number"):h}function o(u,c){return Math.floor(u+a()*(c-u))}function l(u,c){var f=2n**30n,h=c-u;if(h<=f)return u+BigInt(o(0,Number(h)));for(var p=n(h),m=h;m>=h;){m=0n;for(var v=0;v<p;++v)m=2n*m+(a()<.5?0n:1n)}return u+m}}),IT="stirlingS2",fle=["typed","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","factorial","combinations","isNegative","isInteger","number","?bignumber","larger"],hle=ee(IT,fle,t=>{var{typed:e,addScalar:r,subtractScalar:n,multiplyScalar:i,divideScalar:a,pow:s,factorial:o,combinations:l,isNegative:u,isInteger:c,number:f,bignumber:h,larger:p}=t,m=[],v=[];return e(IT,{"number | BigNumber, number | BigNumber":function(x,S){if(!c(x)||u(x)||!c(S)||u(S))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(p(S,x))throw new TypeError("k must be less than or equal to n in function stirlingS2");var b=!(sr(x)&&sr(S)),A=b?v:m,E=b?h:f,_=f(x),T=f(S);if(A[_]&&A[_].length>T)return A[_][T];for(var M=0;M<=_;++M)if(A[M]||(A[M]=[E(M===0?1:0)]),M!==0)for(var N=A[M],I=A[M-1],F=N.length;F<=M&&F<=T;++F)F===M?N[F]=1:N[F]=r(i(E(F),I[F]),I[F-1]);return A[_][T]}})}),FT="bellNumbers",dle=["typed","addScalar","isNegative","isInteger","stirlingS2"],ple=ee(FT,dle,t=>{var{typed:e,addScalar:r,isNegative:n,isInteger:i,stirlingS2:a}=t;return e(FT,{"number | BigNumber":function(o){if(!i(o)||n(o))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var l=0,u=0;u<=o;u++)l=r(l,a(o,u));return l}})}),OT="catalan",mle=["typed","addScalar","divideScalar","multiplyScalar","combinations","isNegative","isInteger"],vle=ee(OT,mle,t=>{var{typed:e,addScalar:r,divideScalar:n,multiplyScalar:i,combinations:a,isNegative:s,isInteger:o}=t;return e(OT,{"number | BigNumber":function(u){if(!o(u)||s(u))throw new TypeError("Non-negative integer value expected in function catalan");return n(a(i(u,2),u),r(u,1))}})}),BT="composition",gle=["typed","addScalar","combinations","isNegative","isPositive","isInteger","larger"],yle=ee(BT,gle,t=>{var{typed:e,addScalar:r,combinations:n,isPositive:i,isNegative:a,isInteger:s,larger:o}=t;return e(BT,{"number | BigNumber, number | BigNumber":function(u,c){if(!s(u)||!i(u)||!s(c)||!i(c))throw new TypeError("Positive integer value expected in function composition");if(o(c,u))throw new TypeError("k must be less than or equal to n in function composition");return n(r(u,-1),r(c,-1))}})}),RT="leafCount",ble=["parse","typed"],xle=ee(RT,ble,t=>{var{parse:e,typed:r}=t;function n(i){var a=0;return i.forEach(s=>{a+=n(s)}),a||1}return r(RT,{Node:function(a){return n(a)}})});function PT(t){return Mr(t)||Rn(t)&&t.isUnary()&&Mr(t.args[0])}function Fv(t){return!!(Mr(t)||(hl(t)||Rn(t))&&t.args.every(Fv)||gu(t)&&Fv(t.content))}function $T(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function hy(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$T(Object(r),!0).forEach(function(n){Gn(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$T(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var wle="simplifyUtil",_le=["FunctionNode","OperatorNode","SymbolNode"],fx=ee(wle,_le,t=>{var{FunctionNode:e,OperatorNode:r,SymbolNode:n}=t,i=!0,a=!1,s="defaultF",o={add:{trivial:i,total:i,commutative:i,associative:i},unaryPlus:{trivial:i,total:i,commutative:i,associative:i},subtract:{trivial:a,total:i,commutative:a,associative:a},multiply:{trivial:i,total:i,commutative:i,associative:i},divide:{trivial:a,total:i,commutative:a,associative:a},paren:{trivial:i,total:i,commutative:i,associative:a},defaultF:{trivial:a,total:i,commutative:a,associative:a}},l={divide:{total:a},log:{total:a}},u={subtract:{total:a},abs:{trivial:i},log:{total:i}};function c(b,A){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,_=s;if(typeof b=="string"?_=b:Rn(b)?_=b.fn.toString():hl(b)?_=b.name:gu(b)&&(_="paren"),Ft(E,_)){var T=E[_];if(Ft(T,A))return T[A];if(Ft(o,_))return o[_][A]}if(Ft(E,s)){var M=E[s];return Ft(M,A)?M[A]:o[s][A]}if(Ft(o,_)){var N=o[_];if(Ft(N,A))return N[A]}return o[s][A]}function f(b){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;return c(b,"commutative",A)}function h(b){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;return c(b,"associative",A)}function p(b,A){var E=hy({},b);for(var _ in A)Ft(b,_)?E[_]=hy(hy({},A[_]),b[_]):E[_]=A[_];return E}function m(b,A){if(!b.args||b.args.length===0)return b;b.args=v(b,A);for(var E=0;E<b.args.length;E++)m(b.args[E],A)}function v(b,A){var E,_=[],T=function(N){for(var I=0;I<N.args.length;I++){var F=N.args[I];Rn(F)&&E===F.op?T(F):_.push(F)}};return h(b,A)?(E=b.op,T(b),_):b.args}function y(b,A){if(!(!b.args||b.args.length===0)){for(var E=S(b),_=b.args.length,T=0;T<_;T++)y(b.args[T],A);if(_>2&&h(b,A)){for(var M=b.args.pop();b.args.length>0;)M=E([b.args.pop(),M]);b.args=M.args}}}function x(b,A){if(!(!b.args||b.args.length===0)){for(var E=S(b),_=b.args.length,T=0;T<_;T++)x(b.args[T],A);if(_>2&&h(b,A)){for(var M=b.args.shift();b.args.length>0;)M=E([M,b.args.shift()]);b.args=M.args}}}function S(b){return Rn(b)?function(A){try{return new r(b.op,b.fn,A,b.implicit)}catch(E){return console.error(E),[]}}:function(A){return new e(new n(b.name),A)}}return{createMakeNodeFunction:S,hasProperty:c,isCommutative:f,isAssociative:h,mergeContext:p,flatten:m,allChildren:v,unflattenr:y,unflattenl:x,defaultContext:o,realContext:l,positiveContext:u}}),Ale="simplify",Ele=["typed","parse","equal","resolve","simplifyConstant","simplifyCore","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode","replacer"],Sle=ee(Ale,Ele,t=>{var{typed:e,parse:r,equal:n,resolve:i,simplifyConstant:a,simplifyCore:s,AccessorNode:o,ArrayNode:l,ConstantNode:u,FunctionNode:c,IndexNode:f,ObjectNode:h,OperatorNode:p,ParenthesisNode:m,SymbolNode:v,replacer:y}=t,{hasProperty:x,isCommutative:S,isAssociative:b,mergeContext:A,flatten:E,unflattenr:_,unflattenl:T,createMakeNodeFunction:M,defaultContext:N,realContext:I,positiveContext:F}=fx({FunctionNode:c,OperatorNode:p,SymbolNode:v});e.addConversion({from:"Object",to:"Map",convert:Gf});var P=e("simplify",{Node:Z,"Node, Map":(oe,K)=>Z(oe,!1,K),"Node, Map, Object":(oe,K,de)=>Z(oe,!1,K,de),"Node, Array":Z,"Node, Array, Map":Z,"Node, Array, Map, Object":Z});e.removeConversion({from:"Object",to:"Map",convert:Gf}),P.defaultContext=N,P.realContext=I,P.positiveContext=F;function U(oe){return oe.transform(function(K){return gu(K)?U(K.content):K})}var G={true:!0,false:!0,e:!0,i:!0,Infinity:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,NaN:!0,phi:!0,pi:!0,SQRT1_2:!0,SQRT2:!0,tau:!0};P.rules=[s,{l:"log(e)",r:"1"},{s:"n-n1 -> n+-n1",assuming:{subtract:{total:!0}}},{s:"n-n -> 0",assuming:{subtract:{total:!1}}},{s:"-(cl*v) -> v * (-cl)",assuming:{multiply:{commutative:!0},subtract:{total:!0}}},{s:"-(cl*v) -> (-cl) * v",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{s:"-(v*cl) -> v * (-cl)",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{l:"-(n1/n2)",r:"-n1/n2"},{l:"-v",r:"v * (-1)"},{l:"(n1 + n2)*(-1)",r:"n1*(-1) + n2*(-1)",repeat:!0},{l:"n/n1^n2",r:"n*n1^-n2"},{l:"n/n1",r:"n*n1^-1"},{s:"(n1*n2)^n3 -> n1^n3 * n2^n3",assuming:{multiply:{commutative:!0}}},{s:"(n1*n2)^(-1) -> n2^(-1) * n1^(-1)",assuming:{multiply:{commutative:!1}}},{s:"(n ^ n1) ^ n2 -> n ^ (n1 * n2)",assuming:{divide:{total:!0}}},{l:" vd   * ( vd   * n1 + n2)",r:"vd^2       * n1 +  vd   * n2"},{s:" vd   * (vd^n4 * n1 + n2)   ->  vd^(1+n4)  * n1 +  vd   * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * ( vd   * n1 + n2)   ->  vd^(n3+1)  * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * (vd^n4 * n1 + n2)   ->  vd^(n3+n4) * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{l:"n*n",r:"n^2"},{s:"n * n^n1 -> n^(n1+1)",assuming:{divide:{total:!0}}},{s:"n^n1 * n^n2 -> n^(n1+n2)",assuming:{divide:{total:!0}}},a,{s:"n+n -> 2*n",assuming:{add:{total:!0}}},{l:"n+-n",r:"0"},{l:"vd*n + vd",r:"vd*(n+1)"},{l:"n3*n1 + n3*n2",r:"n3*(n1+n2)"},{l:"n3^(-n4)*n1 +   n3  * n2",r:"n3^(-n4)*(n1 + n3^(n4+1) *n2)"},{l:"n3^(-n4)*n1 + n3^n5 * n2",r:"n3^(-n4)*(n1 + n3^(n4+n5)*n2)"},{s:"n*vd + vd -> (n+1)*vd",assuming:{multiply:{commutative:!1}}},{s:"vd + n*vd -> (1+n)*vd",assuming:{multiply:{commutative:!1}}},{s:"n1*n3 + n2*n3 -> (n1+n2)*n3",assuming:{multiply:{commutative:!1}}},{s:"n^n1 * n -> n^(n1+1)",assuming:{divide:{total:!0},multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3    -> (n1 + n2*n3^(n4 +  1))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3^n5 -> (n1 + n2*n3^(n4 + n5))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{l:"n*cd + cd",r:"(n+1)*cd"},{s:"cd*n + cd -> cd*(n+1)",assuming:{multiply:{commutative:!1}}},{s:"cd + cd*n -> cd*(1+n)",assuming:{multiply:{commutative:!1}}},a,{s:"(-n)*n1 -> -(n*n1)",assuming:{subtract:{total:!0}}},{s:"n1*(-n) -> -(n1*n)",assuming:{subtract:{total:!0},multiply:{commutative:!1}}},{s:"ce+ve -> ve+ce",assuming:{add:{commutative:!0}},imposeContext:{add:{commutative:!1}}},{s:"vd*cd -> cd*vd",assuming:{multiply:{commutative:!0}},imposeContext:{multiply:{commutative:!1}}},{l:"n+-n1",r:"n-n1"},{l:"n+-(n1)",r:"n-(n1)"},{s:"n*(n1^-1) -> n/n1",assuming:{multiply:{commutative:!0}}},{s:"n*n1^-n2 -> n/n1^n2",assuming:{multiply:{commutative:!0}}},{s:"n^-1 -> 1/n",assuming:{multiply:{commutative:!0}}},{l:"n^1",r:"n"},{s:"n*(n1/n2) -> (n*n1)/n2",assuming:{multiply:{associative:!0}}},{s:"n-(n1+n2) -> n-n1-n2",assuming:{addition:{associative:!0,commutative:!0}}},{l:"1*n",r:"n",imposeContext:{multiply:{commutative:!0}}},{s:"n1/(n2/n3) -> (n1*n3)/n2",assuming:{multiply:{associative:!0}}},{l:"n1/(-n2)",r:"-n1/n2"}];function V(oe,K){var de={};if(oe.s){var _e=oe.s.split("->");if(_e.length===2)de.l=_e[0],de.r=_e[1];else throw SyntaxError("Could not parse rule: "+oe.s)}else de.l=oe.l,de.r=oe.r;de.l=U(r(de.l)),de.r=U(r(de.r));for(var be of["imposeContext","repeat","assuming"])be in oe&&(de[be]=oe[be]);if(oe.evaluate&&(de.evaluate=r(oe.evaluate)),b(de.l,K)){var $e=!S(de.l,K),Oe;$e&&(Oe=k());var Qe=M(de.l),ae=k();de.expanded={},de.expanded.l=Qe([de.l,ae]),E(de.expanded.l,K),_(de.expanded.l,K),de.expanded.r=Qe([de.r,ae]),$e&&(de.expandedNC1={},de.expandedNC1.l=Qe([Oe,de.l]),de.expandedNC1.r=Qe([Oe,de.r]),de.expandedNC2={},de.expandedNC2.l=Qe([Oe,de.expanded.l]),de.expandedNC2.r=Qe([Oe,de.expanded.r]))}return de}function $(oe,K){for(var de=[],_e=0;_e<oe.length;_e++){var be=oe[_e],$e=void 0,Oe=typeof be;switch(Oe){case"string":be={s:be};case"object":$e=V(be,K);break;case"function":$e=be;break;default:throw TypeError("Unsupported type of rule: "+Oe)}de.push($e)}return de}var j=0;function k(){return new v("_p"+j++)}function Z(oe,K){var de=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Nd(),_e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},be=_e.consoleDebug;K=$(K||P.rules,_e.context);var $e=i(oe,de);$e=U($e);for(var Oe={},Qe=$e.toString({parenthesis:"all"});!Oe[Qe];){Oe[Qe]=!0,j=0;var ae=Qe;be&&console.log("Working on: ",Qe);for(var ce=0;ce<K.length;ce++){var Ce="";if(typeof K[ce]=="function"?($e=K[ce]($e,_e),be&&(Ce=K[ce].name)):(E($e,_e.context),$e=me($e,K[ce],_e.context),be&&(Ce="".concat(K[ce].l.toString()," -> ").concat(K[ce].r.toString()))),be){var Ue=$e.toString({parenthesis:"all"});Ue!==ae&&(console.log("Applying",Ce,"produced",Ue),ae=Ue)}T($e,_e.context)}Qe=$e.toString({parenthesis:"all"})}return $e}function z(oe,K,de){var _e=oe;if(oe)for(var be=0;be<oe.length;++be){var $e=me(oe[be],K,de);$e!==oe[be]&&(_e===oe&&(_e=oe.slice()),_e[be]=$e)}return _e}function me(oe,K,de){if(K.assuming){for(var _e in K.assuming)for(var be in K.assuming[_e])if(x(_e,be,de)!==K.assuming[_e][be])return oe}var $e=A(K.imposeContext,de),Oe=oe;if(Oe instanceof p||Oe instanceof c){var Qe=z(Oe.args,K,de);Qe!==Oe.args&&(Oe=Oe.clone(),Oe.args=Qe)}else if(Oe instanceof m){if(Oe.content){var ae=me(Oe.content,K,de);ae!==Oe.content&&(Oe=new m(ae))}}else if(Oe instanceof l){var ce=z(Oe.items,K,de);ce!==Oe.items&&(Oe=new l(ce))}else if(Oe instanceof o){var Ce=Oe.object;Oe.object&&(Ce=me(Oe.object,K,de));var Ue=Oe.index;Oe.index&&(Ue=me(Oe.index,K,de)),(Ce!==Oe.object||Ue!==Oe.index)&&(Oe=new o(Ce,Ue))}else if(Oe instanceof f){var Ve=z(Oe.dimensions,K,de);Ve!==Oe.dimensions&&(Oe=new f(Ve))}else if(Oe instanceof h){var je=!1,ht={};for(var re in Oe.properties)ht[re]=me(Oe.properties[re],K,de),ht[re]!==Oe.properties[re]&&(je=!0);je&&(Oe=new h(ht))}var we=K.r,Ne=Me(K.l,Oe,$e)[0];if(!Ne&&K.expanded&&(we=K.expanded.r,Ne=Me(K.expanded.l,Oe,$e)[0]),!Ne&&K.expandedNC1&&(we=K.expandedNC1.r,Ne=Me(K.expandedNC1.l,Oe,$e)[0],Ne||(we=K.expandedNC2.r,Ne=Me(K.expandedNC2.l,Oe,$e)[0])),Ne){var Ge=Oe.implicit;Oe=we.clone(),Ge&&"implicit"in we&&(Oe.implicit=!0),Oe=Oe.transform(function(He){return He.isSymbolNode&&Ft(Ne.placeholders,He.name)?Ne.placeholders[He.name].clone():He})}return K.repeat&&Oe!==oe&&(Oe=me(Oe,K,de)),Oe}function fe(oe,K){var de=[],_e,be,$e=M(oe);if(S(oe,K))for(var Oe=0;Oe<oe.args.length;Oe++)be=oe.args.slice(0),be.splice(Oe,1),_e=be.length===1?be[0]:$e(be),de.push($e([oe.args[Oe],_e]));else for(var Qe=1;Qe<oe.args.length;Qe++){var ae=oe.args[0];Qe>1&&(ae=$e(oe.args.slice(0,Qe))),be=oe.args.slice(Qe),_e=be.length===1?be[0]:$e(be),de.push($e([ae,_e]))}return de}function ue(oe,K){var de={placeholders:{}};if(!oe.placeholders&&!K.placeholders)return de;if(oe.placeholders){if(!K.placeholders)return oe}else return K;for(var _e in oe.placeholders)if(Ft(oe.placeholders,_e)&&(de.placeholders[_e]=oe.placeholders[_e],Ft(K.placeholders,_e)&&!Se(oe.placeholders[_e],K.placeholders[_e])))return null;for(var be in K.placeholders)Ft(K.placeholders,be)&&(de.placeholders[be]=K.placeholders[be]);return de}function le(oe,K){var de=[];if(oe.length===0||K.length===0)return de;for(var _e,be=0;be<oe.length;be++)for(var $e=0;$e<K.length;$e++)_e=ue(oe[be],K[$e]),_e&&de.push(_e);return de}function ke(oe){if(oe.length===0)return oe;for(var K=oe.reduce(le),de=[],_e={},be=0;be<K.length;be++){var $e=JSON.stringify(K[be],y);_e[$e]||(_e[$e]=!0,de.push(K[be]))}return de}function Me(oe,K,de,_e){var be=[{placeholders:{}}];if(oe instanceof p&&K instanceof p||oe instanceof c&&K instanceof c){if(oe instanceof p){if(oe.op!==K.op||oe.fn!==K.fn)return[]}else if(oe instanceof c&&oe.name!==K.name)return[];if(K.args.length===1&&oe.args.length===1||!b(K,de)&&K.args.length===oe.args.length||_e){for(var $e=[],Oe=0;Oe<oe.args.length;Oe++){var Qe=Me(oe.args[Oe],K.args[Oe],de);if(Qe.length===0)break;$e.push(Qe)}if($e.length!==oe.args.length){if(!S(K,de)||oe.args.length===1)return[];if(oe.args.length>2)throw new Error("permuting >2 commutative non-associative rule arguments not yet implemented");var ae=Me(oe.args[0],K.args[1],de);if(ae.length===0)return[];var ce=Me(oe.args[1],K.args[0],de);if(ce.length===0)return[];$e=[ae,ce]}be=ke($e)}else if(K.args.length>=2&&oe.args.length===2){for(var Ce=fe(K,de),Ue=[],Ve=0;Ve<Ce.length;Ve++){var je=Me(oe,Ce[Ve],de,!0);Ue=Ue.concat(je)}return Ue}else{if(oe.args.length>2)throw Error("Unexpected non-binary associative function: "+oe.toString());return[]}}else if(oe instanceof v){if(oe.name.length===0)throw new Error("Symbol in rule has 0 length...!?");if(G[oe.name]){if(oe.name!==K.name)return[]}else switch(oe.name[1]>="a"&&oe.name[1]<="z"?oe.name.substring(0,2):oe.name[0]){case"n":case"_p":be[0].placeholders[oe.name]=K;break;case"c":case"cl":if(Mr(K))be[0].placeholders[oe.name]=K;else return[];break;case"v":if(!Mr(K))be[0].placeholders[oe.name]=K;else return[];break;case"vl":if(fi(K))be[0].placeholders[oe.name]=K;else return[];break;case"cd":if(PT(K))be[0].placeholders[oe.name]=K;else return[];break;case"vd":if(!PT(K))be[0].placeholders[oe.name]=K;else return[];break;case"ce":if(Fv(K))be[0].placeholders[oe.name]=K;else return[];break;case"ve":if(!Fv(K))be[0].placeholders[oe.name]=K;else return[];break;default:throw new Error("Invalid symbol in rule: "+oe.name)}}else if(oe instanceof u){if(!n(oe.value,K.value))return[]}else return[];return be}function Se(oe,K){if(oe instanceof u&&K instanceof u){if(!n(oe.value,K.value))return!1}else if(oe instanceof v&&K instanceof v){if(oe.name!==K.name)return!1}else if(oe instanceof p&&K instanceof p||oe instanceof c&&K instanceof c){if(oe instanceof p){if(oe.op!==K.op||oe.fn!==K.fn)return!1}else if(oe instanceof c&&oe.name!==K.name)return!1;if(oe.args.length!==K.args.length)return!1;for(var de=0;de<oe.args.length;de++)if(!Se(oe.args[de],K.args[de]))return!1}else return!1;return!0}return P}),Dle="simplifyConstant",Cle=["typed","config","mathWithTransform","matrix","?fraction","?bignumber","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode"],Tle=ee(Dle,Cle,t=>{var{typed:e,config:r,mathWithTransform:n,matrix:i,fraction:a,bignumber:s,AccessorNode:o,ArrayNode:l,ConstantNode:u,FunctionNode:c,IndexNode:f,ObjectNode:h,OperatorNode:p,SymbolNode:m}=t,{isCommutative:v,isAssociative:y,allChildren:x,createMakeNodeFunction:S}=fx({FunctionNode:c,OperatorNode:p,SymbolNode:m}),b=e("simplifyConstant",{Node:V=>T(G(V,{})),"Node, Object":function($,j){return T(G($,j))}});function A(V){return zd(V)?V.valueOf():V instanceof Array?V.map(A):Gt(V)?i(A(V.valueOf())):V}function E(V,$,j){try{return n[V].apply(null,$)}catch{return $=$.map(A),N(n[V].apply(null,$),j)}}var _=e({Fraction:F,number:function($){return $<0?I(new u(-$)):new u($)},BigNumber:function($){return $<0?I(new u(-$)):new u($)},bigint:function($){return $<0n?I(new u(-$)):new u($)},Complex:function($){throw new Error("Cannot convert Complex number to Node")},string:function($){return new u($)},Matrix:function($){return new l($.valueOf().map(j=>_(j)))}});function T(V){return Zr(V)?V:_(V)}function M(V,$){var j=$&&$.exactFractions!==!1;if(j&&isFinite(V)&&a){var k=a(V),Z=$&&typeof $.fractionsLimit=="number"?$.fractionsLimit:1/0;if(k.valueOf()===V&&k.n<Z&&k.d<Z)return k}return V}var N=e({"string, Object":function($,j){var k=bl($,r);if(k==="BigNumber")return s===void 0&&ex(),s($);if(k==="bigint")return BigInt($);if(k==="Fraction")return a===void 0&&EF(),a($);var Z=parseFloat($);return M(Z,j)},"Fraction, Object":function($,j){return $},"BigNumber, Object":function($,j){return $},"number, Object":function($,j){return M($,j)},"bigint, Object":function($,j){return $},"Complex, Object":function($,j){return $.im!==0?$:M($.re,j)},"Matrix, Object":function($,j){return i(M($.valueOf()))},"Array, Object":function($,j){return $.map(M)}});function I(V){return new p("-","unaryMinus",[V])}function F(V){var $=Z=>r.number==="BigNumber"&&s?s(Z):Number(Z),j=V.s*V.n,k=j<0n?new p("-","unaryMinus",[new u(-$(j))]):new u($(j));return V.d===1n?k:new p("/","divide",[k,new u($(V.d))])}function P(V,$,j){if(!wh($))return new o(T(V),T($));if(Ja(V)||Gt(V)){for(var k=Array.from($.dimensions);k.length>0;)if(Mr(k[0])&&typeof k[0].value!="string"){var Z=N(k.shift().value,j);Ja(V)?V=V.items[Z-1]:(V=V.valueOf()[Z-1],V instanceof Array&&(V=i(V)))}else if(k.length>1&&Mr(k[1])&&typeof k[1].value!="string"){var z=N(k[1].value,j),me=[],fe=Ja(V)?V.items:V.valueOf();for(var ue of fe)if(Ja(ue))me.push(ue.items[z-1]);else if(Gt(V))me.push(ue[z-1]);else break;if(me.length===fe.length)Ja(V)?V=new l(me):V=i(me),k.splice(1,1);else break}else break;return k.length===$.dimensions.length?new o(T(V),$):k.length>0?($=new f(k),new o(T(V),$)):V}if(ng(V)&&$.dimensions.length===1&&Mr($.dimensions[0])){var le=$.dimensions[0].value;return le in V.properties?V.properties[le]:new u}return new o(T(V),$)}function U(V,$,j,k){var Z=$.shift(),z=$.reduce((me,fe)=>{if(!Zr(fe)){var ue=me.pop();if(Zr(ue))return[ue,fe];try{return me.push(E(V,[ue,fe],k)),me}catch{me.push(ue)}}me.push(T(me.pop()));var le=me.length===1?me[0]:j(me);return[j([le,T(fe)])]},[Z]);return z.length===1?z[0]:j([z[0],_(z[1])])}function G(V,$){switch(V.type){case"SymbolNode":return V;case"ConstantNode":switch(typeof V.value){case"number":return N(V.value,$);case"bigint":return N(V.value,$);case"string":return V.value;default:if(!isNaN(V.value))return N(V.value,$)}return V;case"FunctionNode":if(n[V.name]&&n[V.name].rawArgs)return V;{var j=["add","multiply"];if(!j.includes(V.name)){var k=V.args.map(_e=>G(_e,$));if(!k.some(Zr))try{return E(V.name,k,$)}catch{}if(V.name==="size"&&k.length===1&&Ja(k[0])){for(var Z=[],z=k[0];Ja(z);)Z.push(z.items.length),z=z.items[0];return i(Z)}return new c(V.name,k.map(T))}}case"OperatorNode":{var me=V.fn.toString(),fe,ue,le=S(V);if(Rn(V)&&V.isUnary())fe=[G(V.args[0],$)],Zr(fe[0])?ue=le(fe):ue=E(me,fe,$);else if(y(V,$.context))if(fe=x(V,$.context),fe=fe.map(_e=>G(_e,$)),v(me,$.context)){for(var ke=[],Me=[],Se=0;Se<fe.length;Se++)Zr(fe[Se])?Me.push(fe[Se]):ke.push(fe[Se]);ke.length>1?(ue=U(me,ke,le,$),Me.unshift(ue),ue=U(me,Me,le,$)):ue=U(me,fe,le,$)}else ue=U(me,fe,le,$);else fe=V.args.map(_e=>G(_e,$)),ue=U(me,fe,le,$);return ue}case"ParenthesisNode":return G(V.content,$);case"AccessorNode":return P(G(V.object,$),G(V.index,$),$);case"ArrayNode":{var oe=V.items.map(_e=>G(_e,$));return oe.some(Zr)?new l(oe.map(T)):i(oe)}case"IndexNode":return new f(V.dimensions.map(_e=>b(_e,$)));case"ObjectNode":{var K={};for(var de in V.properties)K[de]=b(V.properties[de],$);return new h(K)}case"AssignmentNode":case"BlockNode":case"FunctionAssignmentNode":case"RangeNode":case"ConditionalNode":default:throw new Error("Unimplemented node type in simplifyConstant: ".concat(V.type))}}return b}),kT="simplifyCore",Nle=["typed","parse","equal","isZero","add","subtract","multiply","divide","pow","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode"],Mle=ee(kT,Nle,t=>{var{typed:e,parse:r,equal:n,isZero:i,add:a,subtract:s,multiply:o,divide:l,pow:u,AccessorNode:c,ArrayNode:f,ConstantNode:h,FunctionNode:p,IndexNode:m,ObjectNode:v,OperatorNode:y,ParenthesisNode:x,SymbolNode:S}=t,b=new h(0),A=new h(1),E=new h(!0),_=new h(!1);function T(F){return Rn(F)&&["and","not","or"].includes(F.op)}var{hasProperty:M,isCommutative:N}=fx({FunctionNode:p,OperatorNode:y,SymbolNode:S});function I(F){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},U=P?P.context:void 0;if(M(F,"trivial",U)){if(hl(F)&&F.args.length===1)return I(F.args[0],P);var G=!1,V=0;if(F.forEach(Me=>{++V,V===1&&(G=I(Me,P))}),V===1)return G}var $=F;if(hl($)){var j=Ite($.name);if(j){if($.args.length>2&&M($,"associative",U))for(;$.args.length>2;){var k=$.args.pop(),Z=$.args.pop();$.args.push(new y(j,$.name,[k,Z]))}$=new y(j,$.name,$.args)}else return new p(I($.fn),$.args.map(Me=>I(Me,P)))}if(Rn($)&&$.isUnary()){var z=I($.args[0],P);if($.op==="~"&&Rn(z)&&z.isUnary()&&z.op==="~"||$.op==="not"&&Rn(z)&&z.isUnary()&&z.op==="not"&&T(z.args[0]))return z.args[0];var me=!0;if($.op==="-"&&Rn(z)&&(z.isBinary()&&z.fn==="subtract"&&($=new y("-","subtract",[z.args[1],z.args[0]]),me=!1),z.isUnary()&&z.op==="-"))return z.args[0];if(me)return new y($.op,$.fn,[z])}if(Rn($)&&$.isBinary()){var fe=I($.args[0],P),ue=I($.args[1],P);if($.op==="+"){if(Mr(fe)&&i(fe.value))return ue;if(Mr(ue)&&i(ue.value))return fe;Rn(ue)&&ue.isUnary()&&ue.op==="-"&&(ue=ue.args[0],$=new y("-","subtract",[fe,ue]))}if($.op==="-")return Rn(ue)&&ue.isUnary()&&ue.op==="-"?I(new y("+","add",[fe,ue.args[0]]),P):Mr(fe)&&i(fe.value)?I(new y("-","unaryMinus",[ue])):Mr(ue)&&i(ue.value)?fe:new y($.op,$.fn,[fe,ue]);if($.op==="*"){if(Mr(fe)){if(i(fe.value))return b;if(n(fe.value,1))return ue}if(Mr(ue)){if(i(ue.value))return b;if(n(ue.value,1))return fe;if(N($,U))return new y($.op,$.fn,[ue,fe],$.implicit)}return new y($.op,$.fn,[fe,ue],$.implicit)}if($.op==="/")return Mr(fe)&&i(fe.value)?b:Mr(ue)&&n(ue.value,1)?fe:new y($.op,$.fn,[fe,ue]);if($.op==="^"&&Mr(ue)){if(i(ue.value))return A;if(n(ue.value,1))return fe}if($.op==="and"){if(Mr(fe))if(fe.value){if(T(ue))return ue;if(Mr(ue))return ue.value?E:_}else return _;if(Mr(ue))if(ue.value){if(T(fe))return fe}else return _}if($.op==="or"){if(Mr(fe)){if(fe.value)return E;if(T(ue))return ue}if(Mr(ue)){if(ue.value)return E;if(T(fe))return fe}}return new y($.op,$.fn,[fe,ue])}if(Rn($))return new y($.op,$.fn,$.args.map(Me=>I(Me,P)));if(Ja($))return new f($.items.map(Me=>I(Me,P)));if(wc($))return new c(I($.object,P),I($.index,P));if(wh($))return new m($.dimensions.map(Me=>I(Me,P)));if(ng($)){var le={};for(var ke in $.properties)le[ke]=I($.properties[ke],P);return new v(le)}return $}return e(kT,{Node:I,"Node,Object":I})}),Ile="resolve",Fle=["typed","parse","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode"],Ole=ee(Ile,Fle,t=>{var{typed:e,parse:r,ConstantNode:n,FunctionNode:i,OperatorNode:a,ParenthesisNode:s}=t;function o(l,u){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Set;if(!u)return l;if(fi(l)){if(c.has(l.name)){var f=Array.from(c).join(", ");throw new ReferenceError("recursive loop of variable definitions among {".concat(f,"}"))}var h=u.get(l.name);if(Zr(h)){var p=new Set(c);return p.add(l.name),o(h,u,p)}else return typeof h=="number"?r(String(h)):h!==void 0?new n(h):l}else if(Rn(l)){var m=l.args.map(function(y){return o(y,u,c)});return new a(l.op,l.fn,m,l.implicit)}else{if(gu(l))return new s(o(l.content,u,c));if(hl(l)){var v=l.args.map(function(y){return o(y,u,c)});return new i(l.name,v)}}return l.map(y=>o(y,u,c))}return e("resolve",{Node:o,"Node, Map | null | undefined":o,"Node, Object":(l,u)=>o(l,Gf(u)),"Array | Matrix":e.referToSelf(l=>u=>u.map(c=>l(c))),"Array | Matrix, null | undefined":e.referToSelf(l=>u=>u.map(c=>l(c))),"Array, Object":e.referTo("Array,Map",l=>(u,c)=>l(u,Gf(c))),"Matrix, Object":e.referTo("Matrix,Map",l=>(u,c)=>l(u,Gf(c))),"Array | Matrix, Map":e.referToSelf(l=>(u,c)=>u.map(f=>l(f,c)))})}),LT="symbolicEqual",Ble=["parse","simplify","typed","OperatorNode"],Rle=ee(LT,Ble,t=>{var{parse:e,simplify:r,typed:n,OperatorNode:i}=t;function a(s,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=new i("-","subtract",[s,o]),c=r(u,{},l);return Mr(c)&&!c.value}return n(LT,{"Node, Node":a,"Node, Node, Object":a})}),UT="derivative",Ple=["typed","config","parse","simplify","equal","isZero","numeric","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode","SymbolNode"],$le=ee(UT,Ple,t=>{var{typed:e,config:r,parse:n,simplify:i,equal:a,isZero:s,numeric:o,ConstantNode:l,FunctionNode:u,OperatorNode:c,ParenthesisNode:f,SymbolNode:h}=t;function p(A,E){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{simplify:!0},T=new Map,M=E.name;function N(F){var P=T.get(F);if(P!==void 0)return P;var U=x(N,F,M);return T.set(F,U),U}var I=S(A,N);return _.simplify?i(I):I}function m(A){var E=n(A);if(!E.isSymbolNode)throw new TypeError("Invalid variable. "+"Cannot parse ".concat(JSON.stringify(A)," into a variable in function derivative"));return E}var v=e(UT,{"Node, SymbolNode":p,"Node, SymbolNode, Object":p,"Node, string":(A,E)=>p(A,m(E)),"Node, string, Object":(A,E,_)=>p(A,m(E),_)});v._simplify=!0,v.toTex=function(A){return y.apply(null,A.args)};var y=e("_derivTex",{"Node, SymbolNode":function(E,_){return Mr(E)&&tn(E.value)==="string"?y(n(E.value).toString(),_.toString(),1):y(E.toTex(),_.toString(),1)},"Node, ConstantNode":function(E,_){if(tn(_.value)==="string")return y(E,n(_.value));throw new Error("The second parameter to 'derivative' is a non-string constant")},"Node, SymbolNode, ConstantNode":function(E,_,T){return y(E.toString(),_.name,T.value)},"string, string, number":function(E,_,T){var M;return T===1?M="{d\\over d"+_+"}":M="{d^{"+T+"}\\over d"+_+"^{"+T+"}}",M+"\\left[".concat(E,"\\right]")}}),x=e("_isConst",{"function, ConstantNode, string":function(){return!0},"function, SymbolNode, string":function(E,_,T){return _.name!==T},"function, ParenthesisNode, string":function(E,_,T){return E(_.content,T)},"function, FunctionAssignmentNode, string":function(E,_,T){return _.params.includes(T)?E(_.expr,T):!0},"function, FunctionNode | OperatorNode, string":function(E,_,T){return _.args.every(M=>E(M,T))}}),S=e("_derivative",{"ConstantNode, function":function(){return b(0)},"SymbolNode, function":function(E,_){return _(E)?b(0):b(1)},"ParenthesisNode, function":function(E,_){return new f(S(E.content,_))},"FunctionAssignmentNode, function":function(E,_){return _(E)?b(0):S(E.expr,_)},"FunctionNode, function":function(E,_){if(_(E))return b(0);var T=E.args[0],M,N=!1,I=!1,F;switch(E.name){case"cbrt":N=!0,F=new c("*","multiply",[b(3),new c("^","pow",[T,new c("/","divide",[b(2),b(3)])])]);break;case"sqrt":case"nthRoot":if(E.args.length===1)N=!0,F=new c("*","multiply",[b(2),new u("sqrt",[T])]);else if(E.args.length===2)return M=new c("/","divide",[b(1),E.args[1]]),S(new c("^","pow",[T,M]),_);break;case"log10":M=b(10);case"log":if(!M&&E.args.length===1)F=T.clone(),N=!0;else if(E.args.length===1&&M||E.args.length===2&&_(E.args[1]))F=new c("*","multiply",[T.clone(),new u("log",[M||E.args[1]])]),N=!0;else if(E.args.length===2)return S(new c("/","divide",[new u("log",[T]),new u("log",[E.args[1]])]),_);break;case"pow":if(E.args.length===2)return S(new c("^","pow",[T,E.args[1]]),_);break;case"exp":F=new u("exp",[T.clone()]);break;case"sin":F=new u("cos",[T.clone()]);break;case"cos":F=new c("-","unaryMinus",[new u("sin",[T.clone()])]);break;case"tan":F=new c("^","pow",[new u("sec",[T.clone()]),b(2)]);break;case"sec":F=new c("*","multiply",[E,new u("tan",[T.clone()])]);break;case"csc":I=!0,F=new c("*","multiply",[E,new u("cot",[T.clone()])]);break;case"cot":I=!0,F=new c("^","pow",[new u("csc",[T.clone()]),b(2)]);break;case"asin":N=!0,F=new u("sqrt",[new c("-","subtract",[b(1),new c("^","pow",[T.clone(),b(2)])])]);break;case"acos":N=!0,I=!0,F=new u("sqrt",[new c("-","subtract",[b(1),new c("^","pow",[T.clone(),b(2)])])]);break;case"atan":N=!0,F=new c("+","add",[new c("^","pow",[T.clone(),b(2)]),b(1)]);break;case"asec":N=!0,F=new c("*","multiply",[new u("abs",[T.clone()]),new u("sqrt",[new c("-","subtract",[new c("^","pow",[T.clone(),b(2)]),b(1)])])]);break;case"acsc":N=!0,I=!0,F=new c("*","multiply",[new u("abs",[T.clone()]),new u("sqrt",[new c("-","subtract",[new c("^","pow",[T.clone(),b(2)]),b(1)])])]);break;case"acot":N=!0,I=!0,F=new c("+","add",[new c("^","pow",[T.clone(),b(2)]),b(1)]);break;case"sinh":F=new u("cosh",[T.clone()]);break;case"cosh":F=new u("sinh",[T.clone()]);break;case"tanh":F=new c("^","pow",[new u("sech",[T.clone()]),b(2)]);break;case"sech":I=!0,F=new c("*","multiply",[E,new u("tanh",[T.clone()])]);break;case"csch":I=!0,F=new c("*","multiply",[E,new u("coth",[T.clone()])]);break;case"coth":I=!0,F=new c("^","pow",[new u("csch",[T.clone()]),b(2)]);break;case"asinh":N=!0,F=new u("sqrt",[new c("+","add",[new c("^","pow",[T.clone(),b(2)]),b(1)])]);break;case"acosh":N=!0,F=new u("sqrt",[new c("-","subtract",[new c("^","pow",[T.clone(),b(2)]),b(1)])]);break;case"atanh":N=!0,F=new c("-","subtract",[b(1),new c("^","pow",[T.clone(),b(2)])]);break;case"asech":N=!0,I=!0,F=new c("*","multiply",[T.clone(),new u("sqrt",[new c("-","subtract",[b(1),new c("^","pow",[T.clone(),b(2)])])])]);break;case"acsch":N=!0,I=!0,F=new c("*","multiply",[new u("abs",[T.clone()]),new u("sqrt",[new c("+","add",[new c("^","pow",[T.clone(),b(2)]),b(1)])])]);break;case"acoth":N=!0,I=!0,F=new c("-","subtract",[b(1),new c("^","pow",[T.clone(),b(2)])]);break;case"abs":F=new c("/","divide",[new u(new h("abs"),[T.clone()]),T.clone()]);break;case"gamma":default:throw new Error('Cannot process function "'+E.name+'" in derivative: the function is not supported, undefined, or the number of arguments passed to it are not supported')}var P,U;N?(P="/",U="divide"):(P="*",U="multiply");var G=S(T,_);return I&&(G=new c("-","unaryMinus",[G])),new c(P,U,[G,F])},"OperatorNode, function":function(E,_){if(_(E))return b(0);if(E.op==="+")return new c(E.op,E.fn,E.args.map(function($){return S($,_)}));if(E.op==="-"){if(E.isUnary())return new c(E.op,E.fn,[S(E.args[0],_)]);if(E.isBinary())return new c(E.op,E.fn,[S(E.args[0],_),S(E.args[1],_)])}if(E.op==="*"){var T=E.args.filter(function($){return _($)});if(T.length>0){var M=E.args.filter(function($){return!_($)}),N=M.length===1?M[0]:new c("*","multiply",M),I=T.concat(S(N,_));return new c("*","multiply",I)}return new c("+","add",E.args.map(function($){return new c("*","multiply",E.args.map(function(j){return j===$?S(j,_):j.clone()}))}))}if(E.op==="/"&&E.isBinary()){var F=E.args[0],P=E.args[1];return _(P)?new c("/","divide",[S(F,_),P]):_(F)?new c("*","multiply",[new c("-","unaryMinus",[F]),new c("/","divide",[S(P,_),new c("^","pow",[P.clone(),b(2)])])]):new c("/","divide",[new c("-","subtract",[new c("*","multiply",[S(F,_),P.clone()]),new c("*","multiply",[F.clone(),S(P,_)])]),new c("^","pow",[P.clone(),b(2)])])}if(E.op==="^"&&E.isBinary()){var U=E.args[0],G=E.args[1];if(_(U))return Mr(U)&&(s(U.value)||a(U.value,1))?b(0):new c("*","multiply",[E,new c("*","multiply",[new u("log",[U.clone()]),S(G.clone(),_)])]);if(_(G)){if(Mr(G)){if(s(G.value))return b(0);if(a(G.value,1))return S(U,_)}var V=new c("^","pow",[U.clone(),new c("-","subtract",[G,b(1)])]);return new c("*","multiply",[G.clone(),new c("*","multiply",[S(U,_),V])])}return new c("*","multiply",[new c("^","pow",[U.clone(),G.clone()]),new c("+","add",[new c("*","multiply",[S(U,_),new c("/","divide",[G.clone(),U.clone()])]),new c("*","multiply",[S(G,_),new u("log",[U.clone()])])])])}throw new Error('Cannot process operator "'+E.op+'" in derivative: the operator is not supported, undefined, or the number of arguments passed to it are not supported')}});function b(A,E){return new l(o(A,bl(String(A),r)))}return v}),zT="rationalize",kle=["config","typed","equal","isZero","add","subtract","multiply","divide","pow","parse","simplifyConstant","simplifyCore","simplify","?bignumber","?fraction","mathWithTransform","matrix","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode","ParenthesisNode"],Lle=ee(zT,kle,t=>{var{config:e,typed:r,equal:n,isZero:i,add:a,subtract:s,multiply:o,divide:l,pow:u,parse:c,simplifyConstant:f,simplifyCore:h,simplify:p,fraction:m,bignumber:v,mathWithTransform:y,matrix:x,AccessorNode:S,ArrayNode:b,ConstantNode:A,FunctionNode:E,IndexNode:_,ObjectNode:T,OperatorNode:M,SymbolNode:N,ParenthesisNode:I}=t;function F($){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,Z=U(),z=P($,j,!0,Z.firstRules),me=z.variables.length,fe={exactFractions:!1},ue={exactFractions:!0};if($=z.expression,me>=1){$=G($);var le,ke,Me=!0,Se=!1;$=p($,Z.firstRules,{},fe);for(var oe;ke=Me?Z.distrDivRules:Z.sucDivRules,$=p($,ke,{},ue),Me=!Me,oe=$.toString(),oe!==le;)Se=!0,le=oe;Se&&($=p($,Z.firstRulesAgain,{},fe)),$=p($,Z.finalRules,{},fe)}var K=[],de={};return $.type==="OperatorNode"&&$.isBinary()&&$.op==="/"?(me===1&&($.args[0]=V($.args[0],K),$.args[1]=V($.args[1])),k&&(de.numerator=$.args[0],de.denominator=$.args[1])):(me===1&&($=V($,K)),k&&(de.numerator=$,de.denominator=null)),k?(de.coefficients=K,de.variables=z.variables,de.expression=$,de):$}return r(zT,{Node:F,"Node, boolean":($,j)=>F($,{},j),"Node, Object":F,"Node, Object, boolean":F});function P($,j,k,Z){var z=[],me=p($,Z,j,{exactFractions:!1});k=!!k;var fe="+-*"+(k?"/":"");le(me);var ue={};return ue.expression=me,ue.variables=z,ue;function le(ke){var Me=ke.type;if(Me==="FunctionNode")throw new Error("There is an unsolved function call");if(Me==="OperatorNode")if(ke.op==="^"){if(ke.args[1].type!=="ConstantNode"||!Bt(parseFloat(ke.args[1].value)))throw new Error("There is a non-integer exponent");le(ke.args[0])}else{if(!fe.includes(ke.op))throw new Error("Operator "+ke.op+" invalid in polynomial expression");for(var Se=0;Se<ke.args.length;Se++)le(ke.args[Se])}else if(Me==="SymbolNode"){var oe=ke.name,K=z.indexOf(oe);K===-1&&z.push(oe)}else if(Me==="ParenthesisNode")le(ke.content);else if(Me!=="ConstantNode")throw new Error("type "+Me+" is not allowed in polynomial expression")}}function U(){var $=[h,{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},f,{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"1*n",r:"n"}],j=[{l:"(-n1)/(-n2)",r:"n1/n2"},{l:"(-n1)*(-n2)",r:"n1*n2"},{l:"n1--n2",r:"n1+n2"},{l:"n1-n2",r:"n1+(-n2)"},{l:"(n1+n2)*n3",r:"(n1*n3 + n2*n3)"},{l:"n1*(n2+n3)",r:"(n1*n2+n1*n3)"},{l:"c1*n + c2*n",r:"(c1+c2)*n"},{l:"c1*n + n",r:"(c1+1)*n"},{l:"c1*n - c2*n",r:"(c1-c2)*n"},{l:"c1*n - n",r:"(c1-1)*n"},{l:"v/c",r:"(1/c)*v"},{l:"v/-c",r:"-(1/c)*v"},{l:"-v*-c",r:"c*v"},{l:"-v*c",r:"-c*v"},{l:"v*-c",r:"-c*v"},{l:"v*c",r:"c*v"},{l:"-(-n1*n2)",r:"(n1*n2)"},{l:"-(n1*n2)",r:"(-n1*n2)"},{l:"-(-n1+n2)",r:"(n1-n2)"},{l:"-(n1+n2)",r:"(-n1-n2)"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"},{l:"-(-n1/n2)",r:"(n1/n2)"},{l:"-(n1/n2)",r:"(-n1/n2)"}],k=[{l:"(n1/n2 + n3/n4)",r:"((n1*n4 + n3*n2)/(n2*n4))"},{l:"(n1/n2 + n3)",r:"((n1 + n3*n2)/n2)"},{l:"(n1 + n2/n3)",r:"((n1*n3 + n2)/n3)"}],Z=[{l:"(n1/(n2/n3))",r:"((n1*n3)/n2)"},{l:"(n1/n2/n3)",r:"(n1/(n2*n3))"}],z={};return z.firstRules=$.concat(j,Z),z.distrDivRules=k,z.sucDivRules=Z,z.firstRulesAgain=$.concat(j),z.finalRules=[h,{l:"n*-n",r:"-n^2"},{l:"n*n",r:"n^2"},f,{l:"n*-n^n1",r:"-n^(n1+1)"},{l:"n*n^n1",r:"n^(n1+1)"},{l:"n^n1*-n^n2",r:"-n^(n1+n2)"},{l:"n^n1*n^n2",r:"n^(n1+n2)"},{l:"n^n1*-n",r:"-n^(n1+1)"},{l:"n^n1*n",r:"n^(n1+1)"},{l:"n^n1/-n",r:"-n^(n1-1)"},{l:"n^n1/n",r:"n^(n1-1)"},{l:"n/-n^n1",r:"-n^(1-n1)"},{l:"n/n^n1",r:"n^(1-n1)"},{l:"n^n1/-n^n2",r:"n^(n1-n2)"},{l:"n^n1/n^n2",r:"n^(n1-n2)"},{l:"n1+(-n2*n3)",r:"n1-n2*n3"},{l:"v*(-c)",r:"-c*v"},{l:"n1+-n2",r:"n1-n2"},{l:"v*c",r:"c*v"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"}],z}function G($,j,k){var Z=$.type,z=arguments.length>1;if(Z==="OperatorNode"&&$.isBinary()){var me=!1,fe;if($.op==="^"&&($.args[0].type==="ParenthesisNode"||$.args[0].type==="OperatorNode")&&$.args[1].type==="ConstantNode"&&(fe=parseFloat($.args[1].value),me=fe>=2&&Bt(fe)),me){if(fe>2){var ue=$.args[0],le=new M("^","pow",[$.args[0].cloneDeep(),new A(fe-1)]);$=new M("*","multiply",[ue,le])}else $=new M("*","multiply",[$.args[0],$.args[0].cloneDeep()]);z&&(k==="content"?j.content=$:j.args[k]=$)}}if(Z==="ParenthesisNode")G($.content,$,"content");else if(Z!=="ConstantNode"&&Z!=="SymbolNode")for(var ke=0;ke<$.args.length;ke++)G($.args[ke],$,ke);if(!z)return $}function V($,j){j===void 0&&(j=[]),j[0]=0;var k={};k.cte=1,k.oper="+",k.fire="";var Z=0,z="";oe($,null,k),Z=j.length-1;for(var me=!0,fe,ue=Z;ue>=0;ue--)if(j[ue]!==0){var le=new A(me?j[ue]:Math.abs(j[ue])),ke=j[ue]<0?"-":"+";if(ue>0){var Me=new N(z);if(ue>1){var Se=new A(ue);Me=new M("^","pow",[Me,Se])}j[ue]===-1&&me?le=new M("-","unaryMinus",[Me]):Math.abs(j[ue])===1?le=Me:le=new M("*","multiply",[le,Me])}me?fe=le:ke==="+"?fe=new M("+","add",[fe,le]):fe=new M("-","subtract",[fe,le]),me=!1}if(me)return new A(0);return fe;function oe(K,de,_e){var be=K.type;if(be==="FunctionNode")throw new Error("There is an unsolved function call");if(be==="OperatorNode"){if(!"+-*^".includes(K.op))throw new Error("Operator "+K.op+" invalid");if(de!==null){if((K.fn==="unaryMinus"||K.fn==="pow")&&de.fn!=="add"&&de.fn!=="subtract"&&de.fn!=="multiply")throw new Error("Invalid "+K.op+" placing");if((K.fn==="subtract"||K.fn==="add"||K.fn==="multiply")&&de.fn!=="add"&&de.fn!=="subtract")throw new Error("Invalid "+K.op+" placing");if((K.fn==="subtract"||K.fn==="add"||K.fn==="unaryMinus")&&_e.noFil!==0)throw new Error("Invalid "+K.op+" placing")}(K.op==="^"||K.op==="*")&&(_e.fire=K.op);for(var $e=0;$e<K.args.length;$e++)K.fn==="unaryMinus"&&(_e.oper="-"),(K.op==="+"||K.fn==="subtract")&&(_e.fire="",_e.cte=1,_e.oper=$e===0?"+":K.op),_e.noFil=$e,oe(K.args[$e],K,_e)}else if(be==="SymbolNode"){if(K.name!==z&&z!=="")throw new Error("There is more than one variable");if(z=K.name,de===null){j[1]=1;return}if(de.op==="^"&&_e.noFil!==0)throw new Error("In power the variable should be the first parameter");if(de.op==="*"&&_e.noFil!==1)throw new Error("In multiply the variable should be the second parameter");(_e.fire===""||_e.fire==="*")&&(Z<1&&(j[1]=0),j[1]+=_e.cte*(_e.oper==="+"?1:-1),Z=Math.max(1,Z))}else if(be==="ConstantNode"){var Oe=parseFloat(K.value);if(de===null){j[0]=Oe;return}if(de.op==="^"){if(_e.noFil!==1)throw new Error("Constant cannot be powered");if(!Bt(Oe)||Oe<=0)throw new Error("Non-integer exponent is not allowed");for(var Qe=Z+1;Qe<Oe;Qe++)j[Qe]=0;Oe>Z&&(j[Oe]=0),j[Oe]+=_e.cte*(_e.oper==="+"?1:-1),Z=Math.max(Oe,Z);return}_e.cte=Oe,_e.fire===""&&(j[0]+=_e.cte*(_e.oper==="+"?1:-1))}else throw new Error("Type "+be+" is not allowed")}}}),GT="zpk2tf",Ule=["typed","add","multiply","Complex","number"],zle=ee(GT,Ule,t=>{var{typed:e,add:r,multiply:n,Complex:i,number:a}=t;return e(GT,{"Array,Array,number":function(u,c,f){return s(u,c,f)},"Array,Array":function(u,c){return s(u,c,1)},"Matrix,Matrix,number":function(u,c,f){return s(u.valueOf(),c.valueOf(),f)},"Matrix,Matrix":function(u,c){return s(u.valueOf(),c.valueOf(),1)}});function s(l,u,c){l.some(S=>S.type==="BigNumber")&&(l=l.map(S=>a(S))),u.some(S=>S.type==="BigNumber")&&(u=u.map(S=>a(S)));for(var f=[i(1,0)],h=[i(1,0)],p=0;p<l.length;p++){var m=l[p];typeof m=="number"&&(m=i(m,0)),f=o(f,[i(1,0),i(-m.re,-m.im)])}for(var v=0;v<u.length;v++){var y=u[v];typeof y=="number"&&(y=i(y,0)),h=o(h,[i(1,0),i(-y.re,-y.im)])}for(var x=0;x<f.length;x++)f[x]=n(f[x],c);return[f,h]}function o(l,u){for(var c=[],f=0;f<l.length+u.length-1;f++){c[f]=i(0,0);for(var h=0;h<l.length;h++)f-h>=0&&f-h<u.length&&(c[f]=r(c[f],n(l[h],u[f-h])))}return c}}),qT="freqz",Gle=["typed","add","multiply","Complex","divide","matrix"],qle=ee(qT,Gle,t=>{var{typed:e,add:r,multiply:n,Complex:i,divide:a,matrix:s}=t;return e(qT,{"Array, Array":function(c,f){var h=l(512);return o(c,f,h)},"Array, Array, Array":function(c,f,h){return o(c,f,h)},"Array, Array, number":function(c,f,h){if(h<0)throw new Error("w must be a positive number");var p=l(h);return o(c,f,p)},"Matrix, Matrix":function(c,f){var h=l(512),{w:p,h:m}=o(c.valueOf(),f.valueOf(),h);return{w:s(p),h:s(m)}},"Matrix, Matrix, Matrix":function(c,f,h){var{h:p}=o(c.valueOf(),f.valueOf(),h.valueOf());return{h:s(p),w:s(h)}},"Matrix, Matrix, number":function(c,f,h){if(h<0)throw new Error("w must be a positive number");var p=l(h),{h:m}=o(c.valueOf(),f.valueOf(),p);return{h:s(m),w:s(p)}}});function o(u,c,f){for(var h=[],p=[],m=0;m<f.length;m++){for(var v=i(0,0),y=i(0,0),x=0;x<u.length;x++)v=r(v,n(u[x],i(Math.cos(-x*f[m]),Math.sin(-x*f[m]))));for(var S=0;S<c.length;S++)y=r(y,n(c[S],i(Math.cos(-S*f[m]),Math.sin(-S*f[m]))));h.push(v),p.push(y)}for(var b=[],A=0;A<h.length;A++)b.push(a(h[A],p[A]));return{h:b,w:f}}function l(u){for(var c=[],f=0;f<u;f++)c.push(f/u*Math.PI);return c}}),Hle="reviver",Wle=["classes"],Vle=ee(Hle,Wle,t=>{var{classes:e}=t;return function(n,i){var a=e[i&&i.mathjs];return a&&typeof a.fromJSON=="function"?a.fromJSON(i):i}}),Xle="replacer",jle=[],Yle=ee(Xle,jle,()=>function(e,r){return typeof r=="number"&&(!isFinite(r)||isNaN(r))?{mathjs:"number",value:String(r)}:typeof r=="bigint"?{mathjs:"bigint",value:String(r)}:r}),Kle="14.5.2",Zle=ee("true",[],()=>!0),Qle=ee("false",[],()=>!1),Jle=ee("null",[],()=>null),ece=Ta("Infinity",["config","?BigNumber"],t=>{var{config:e,BigNumber:r}=t;return e.number==="BigNumber"?new r(1/0):1/0}),tce=Ta("NaN",["config","?BigNumber"],t=>{var{config:e,BigNumber:r}=t;return e.number==="BigNumber"?new r(NaN):NaN}),rce=Ta("pi",["config","?BigNumber"],t=>{var{config:e,BigNumber:r}=t;return e.number==="BigNumber"?nx(r):cX}),nce=Ta("tau",["config","?BigNumber"],t=>{var{config:e,BigNumber:r}=t;return e.number==="BigNumber"?RJ(r):fX}),ice=Ta("e",["config","?BigNumber"],t=>{var{config:e,BigNumber:r}=t;return e.number==="BigNumber"?OJ(r):hX}),ace=Ta("phi",["config","?BigNumber"],t=>{var{config:e,BigNumber:r}=t;return e.number==="BigNumber"?BJ(r):dX}),sce=Ta("LN2",["config","?BigNumber"],t=>{var{config:e,BigNumber:r}=t;return e.number==="BigNumber"?new r(2).ln():Math.LN2}),oce=Ta("LN10",["config","?BigNumber"],t=>{var{config:e,BigNumber:r}=t;return e.number==="BigNumber"?new r(10).ln():Math.LN10}),uce=Ta("LOG2E",["config","?BigNumber"],t=>{var{config:e,BigNumber:r}=t;return e.number==="BigNumber"?new r(1).div(new r(2).ln()):Math.LOG2E}),lce=Ta("LOG10E",["config","?BigNumber"],t=>{var{config:e,BigNumber:r}=t;return e.number==="BigNumber"?new r(1).div(new r(10).ln()):Math.LOG10E}),cce=Ta("SQRT1_2",["config","?BigNumber"],t=>{var{config:e,BigNumber:r}=t;return e.number==="BigNumber"?new r("0.5").sqrt():Math.SQRT1_2}),fce=Ta("SQRT2",["config","?BigNumber"],t=>{var{config:e,BigNumber:r}=t;return e.number==="BigNumber"?new r(2).sqrt():Math.SQRT2}),hce=Ta("i",["Complex"],t=>{var{Complex:e}=t;return e.I}),dce=ee("version",[],()=>Kle);function Ta(t,e,r){return ee(t,e,r,{recreateOnConfigChange:!0})}var pce=nr("speedOfLight","299792458","m s^-1"),mce=nr("gravitationConstant","6.67430e-11","m^3 kg^-1 s^-2"),vce=nr("planckConstant","6.62607015e-34","J s"),gce=nr("reducedPlanckConstant","1.0545718176461565e-34","J s"),yce=nr("magneticConstant","1.25663706212e-6","N A^-2"),bce=nr("electricConstant","8.8541878128e-12","F m^-1"),xce=nr("vacuumImpedance","376.730313667","ohm"),wce=nr("coulomb","8.987551792261171e9","N m^2 C^-2"),_ce=nr("coulombConstant","8.987551792261171e9","N m^2 C^-2"),Ace=nr("elementaryCharge","1.602176634e-19","C"),Ece=nr("bohrMagneton","9.2740100783e-24","J T^-1"),Sce=nr("conductanceQuantum","7.748091729863649e-5","S"),Dce=nr("inverseConductanceQuantum","12906.403729652257","ohm"),Cce=nr("magneticFluxQuantum","2.0678338484619295e-15","Wb"),Tce=nr("nuclearMagneton","5.0507837461e-27","J T^-1"),Nce=nr("klitzing","25812.807459304513","ohm"),Mce=nr("bohrRadius","5.29177210903e-11","m"),Ice=nr("classicalElectronRadius","2.8179403262e-15","m"),Fce=nr("electronMass","9.1093837015e-31","kg"),Oce=nr("fermiCoupling","1.1663787e-5","GeV^-2"),Bce=dg("fineStructure",.0072973525693),Rce=nr("hartreeEnergy","4.3597447222071e-18","J"),Pce=nr("protonMass","1.67262192369e-27","kg"),$ce=nr("deuteronMass","3.3435830926e-27","kg"),kce=nr("neutronMass","1.6749271613e-27","kg"),Lce=nr("quantumOfCirculation","3.6369475516e-4","m^2 s^-1"),Uce=nr("rydberg","10973731.568160","m^-1"),zce=nr("thomsonCrossSection","6.6524587321e-29","m^2"),Gce=dg("weakMixingAngle",.2229),qce=dg("efimovFactor",22.7),Hce=nr("atomicMass","1.66053906660e-27","kg"),Wce=nr("avogadro","6.02214076e23","mol^-1"),Vce=nr("boltzmann","1.380649e-23","J K^-1"),Xce=nr("faraday","96485.33212331001","C mol^-1"),jce=nr("firstRadiation","3.7417718521927573e-16","W m^2"),Yce=nr("loschmidt","2.686780111798444e25","m^-3"),Kce=nr("gasConstant","8.31446261815324","J K^-1 mol^-1"),Zce=nr("molarPlanckConstant","3.990312712893431e-10","J s mol^-1"),Qce=nr("molarVolume","0.022413969545014137","m^3 mol^-1"),Jce=dg("sackurTetrode",-1.16487052358),efe=nr("secondRadiation","0.014387768775039337","m K"),tfe=nr("stefanBoltzmann","5.67037441918443e-8","W m^-2 K^-4"),rfe=nr("wienDisplacement","2.897771955e-3","m K"),nfe=nr("molarMass","0.99999999965e-3","kg mol^-1"),ife=nr("molarMassC12","11.9999999958e-3","kg mol^-1"),afe=nr("gravity","9.80665","m s^-2"),sfe=nr("planckLength","1.616255e-35","m"),ofe=nr("planckMass","2.176435e-8","kg"),ufe=nr("planckTime","5.391245e-44","s"),lfe=nr("planckCharge","1.87554603778e-18","C"),cfe=nr("planckTemperature","1.416785e+32","K");function nr(t,e,r){var n=["config","Unit","BigNumber"];return ee(t,n,i=>{var{config:a,Unit:s,BigNumber:o}=i,l=a.number==="BigNumber"?new o(e):parseFloat(e),u=new s(l,r);return u.fixPrefix=!0,u})}function dg(t,e){var r=["config","BigNumber"];return ee(t,r,n=>{var{config:i,BigNumber:a}=n;return i.number==="BigNumber"?new a(e):e})}function HT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ffe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?HT(Object(r),!0).forEach(function(n){Gn(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):HT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var hfe="mapSlices",dfe=["typed","isInteger"],pfe=ee(hfe,dfe,t=>{var{typed:e,isInteger:r}=t,n=j1({typed:e,isInteger:r});return e("mapSlices",{"...any":function(a){var s=a[1];sr(s)?a[1]=s-1:or(s)&&(a[1]=s.minus(1));try{return n.apply(null,a)}catch(o){throw Qi(o)}}})},ffe({isTransformFunction:!0},j1.meta)),mfe="column",vfe=["typed","Index","matrix","range"],gfe=ee(mfe,vfe,t=>{var{typed:e,Index:r,matrix:n,range:i}=t,a=bF({typed:e,Index:r,matrix:n,range:i});return e("column",{"...any":function(o){var l=o.length-1,u=o[l];sr(u)&&(o[l]=u-1);try{return a.apply(null,o)}catch(c){throw Qi(c)}}})},{isTransformFunction:!0});function hx(t,e,r){var n=t.filter(function(l){return fi(l)&&!(l.name in e)&&!r.has(l.name)})[0];if(!n)throw new Error('No undefined variable found in inline expression "'+t+'"');var i=n.name,a=new Map,s=new qM(r,a,new Set([i])),o=t.compile();return function(u){return a.set(i,u),o.evaluate(s)}}var yfe="transformCallback",bfe=["typed"],dx=ee(yfe,bfe,t=>{var{typed:e}=t;return function(n,i){return e.isTypedFunction(n)?r(n,i):WT(n,n.length,i)};function r(n,i){var a=Object.fromEntries(Object.entries(n.signatures).map(s=>{var[o,l]=s,u=o.split(",").length;return e.isTypedFunction(l)?[o,r(l,i)]:[o,WT(l,u,i)]}));return typeof n.name=="string"?e(n.name,a):e(a)}});function WT(t,e,r){return e===r?t:e===r+1?function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=i.slice(0,r),o=VT(i[r]);return t(...s,o)}:e>r+1?function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=i.slice(0,r),o=VT(i[r]),l=i.slice(r+1);return t(...s,o,...l)}:t}function VT(t){return t.map(e=>e+1)}var xfe="filter",wfe=["typed"],_fe=ee(xfe,wfe,t=>{var{typed:e}=t;function r(i,a,s){var o=xF({typed:e}),l=dx({typed:e});if(i.length===0)return o();var u=i[0];if(i.length===1)return o(u);var c=i.length-1,f=i[c];return u&&(u=n(u,s)),f&&(fi(f)||Gd(f)?f=n(f,s):f=hx(f,a,s)),o(u,l(f,c))}r.rawArgs=!0;function n(i,a){return i.compile().evaluate(a)}return r},{isTransformFunction:!0}),Afe="forEach",Efe=["typed"],Sfe=ee(Afe,Efe,t=>{var{typed:e}=t,r=wF({typed:e}),n=dx({typed:e});function i(s,o,l){if(s.length===0)return r();var u=s[0];if(s.length===1)return r(u);var c=s.length-1,f=s[c];return u&&(u=a(u,l)),f&&(fi(f)||Gd(f)?f=a(f,l):f=hx(f,o,l)),r(u,n(f,c))}i.rawArgs=!0;function a(s,o){return s.compile().evaluate(o)}return i},{isTransformFunction:!0}),Dfe="index",Cfe=["Index","getMatrixDataType"],Tfe=ee(Dfe,Cfe,t=>{var{Index:e,getMatrixDataType:r}=t;return function(){for(var i=[],a=0,s=arguments.length;a<s;a++){var o=arguments[a];if(Gb(o))o.start--,o.end-=o.step>0?0:2;else if(o&&o.isSet===!0)o=o.map(function(u){return u-1});else if(Jr(o)||Gt(o))r(o)!=="boolean"&&(o=o.map(function(u){return u-1}));else if(sr(o)||xd(o))o--;else if(or(o))o=o.toNumber()-1;else if(typeof o!="string")throw new TypeError("Dimension must be an Array, Matrix, number, bigint, string, or Range");i[a]=o}var l=new e;return e.apply(l,i),l}},{isTransformFunction:!0}),Nfe="map",Mfe=["typed"],Ife=ee(Nfe,Mfe,t=>{var{typed:e}=t,r=_F({typed:e}),n=dx({typed:e});function i(a,s,o){if(a.length===0)return r();if(a.length===1)return r(a[0]);var l=a.length-1,u=a.slice(0,l),c=a[l];return u=u.map(h=>f(h,o)),c&&(fi(c)||Gd(c)?c=f(c,o):c=hx(c,s,o)),r(...u,n(c,l));function f(h,p){return h.compile().evaluate(p)}}return i.rawArgs=!0,i},{isTransformFunction:!0});function Ffe(t){return sr(t)?t-1:or(t)?t.minus(1):t}function Ofe(t){return sr(t)||or(t)}function _l(t){if(t.length===2&&is(t[0])){t=t.slice();var e=t[1];Ofe(e)&&(t[1]=Ffe(e))}return t}var Bfe="max",Rfe=["typed","config","numeric","larger","isNaN"],Pfe=ee(Bfe,Rfe,t=>{var{typed:e,config:r,numeric:n,larger:i,isNaN:a}=t,s=FF({typed:e,config:r,numeric:n,larger:i,isNaN:a});return e("max",{"...any":function(l){l=_l(l);try{return s.apply(null,l)}catch(u){throw Qi(u)}}})},{isTransformFunction:!0}),$fe="mean",kfe=["typed","add","divide"],Lfe=ee($fe,kfe,t=>{var{typed:e,add:r,divide:n}=t,i=zF({typed:e,add:r,divide:n});return e("mean",{"...any":function(s){s=_l(s);try{return i.apply(null,s)}catch(o){throw Qi(o)}}})},{isTransformFunction:!0}),Ufe="min",zfe=["typed","config","numeric","smaller","isNaN"],Gfe=ee(Ufe,zfe,t=>{var{typed:e,config:r,numeric:n,smaller:i,isNaN:a}=t,s=OF({typed:e,config:r,numeric:n,smaller:i,isNaN:a});return e("min",{"...any":function(l){l=_l(l);try{return s.apply(null,l)}catch(u){throw Qi(u)}}})},{isTransformFunction:!0}),qfe="range",Hfe=["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],Wfe=ee(qfe,Hfe,t=>{var{typed:e,config:r,matrix:n,bignumber:i,smaller:a,smallerEq:s,larger:o,largerEq:l,add:u,isPositive:c}=t,f=DF({typed:e,config:r,matrix:n,bignumber:i,smaller:a,smallerEq:s,larger:o,largerEq:l,add:u,isPositive:c});return e("range",{"...any":function(p){var m=p.length-1,v=p[m];return typeof v!="boolean"&&p.push(!0),f.apply(null,p)}})},{isTransformFunction:!0}),Vfe="row",Xfe=["typed","Index","matrix","range"],jfe=ee(Vfe,Xfe,t=>{var{typed:e,Index:r,matrix:n,range:i}=t,a=CF({typed:e,Index:r,matrix:n,range:i});return e("row",{"...any":function(o){var l=o.length-1,u=o[l];sr(u)&&(o[l]=u-1);try{return a.apply(null,o)}catch(c){throw Qi(c)}}})},{isTransformFunction:!0}),Yfe="subset",Kfe=["typed","matrix","zeros","add"],Zfe=ee(Yfe,Kfe,t=>{var{typed:e,matrix:r,zeros:n,add:i}=t,a=TF({typed:e,matrix:r,zeros:n,add:i});return e("subset",{"...any":function(o){try{return a.apply(null,o)}catch(l){throw Qi(l)}}})},{isTransformFunction:!0}),Qfe="concat",Jfe=["typed","matrix","isInteger"],ehe=ee(Qfe,Jfe,t=>{var{typed:e,matrix:r,isInteger:n}=t,i=yF({typed:e,matrix:r,isInteger:n});return e("concat",{"...any":function(s){var o=s.length-1,l=s[o];sr(l)?s[o]=l-1:or(l)&&(s[o]=l.minus(1));try{return i.apply(null,s)}catch(u){throw Qi(u)}}})},{isTransformFunction:!0}),XT="diff",the=["typed","matrix","subtract","number","bignumber"],rhe=ee(XT,the,t=>{var{typed:e,matrix:r,subtract:n,number:i,bignumber:a}=t,s=AF({typed:e,matrix:r,subtract:n,number:i,bignumber:a});return e(XT,{"...any":function(l){l=_l(l);try{return s.apply(null,l)}catch(u){throw Qi(u)}}})},{isTransformFunction:!0}),nhe="std",ihe=["typed","map","sqrt","variance"],ahe=ee(nhe,ihe,t=>{var{typed:e,map:r,sqrt:n,variance:i}=t,a=HF({typed:e,map:r,sqrt:n,variance:i});return e("std",{"...any":function(o){o=_l(o);try{return a.apply(null,o)}catch(l){throw Qi(l)}}})},{isTransformFunction:!0}),jT="sum",she=["typed","config","add","numeric"],ohe=ee(jT,she,t=>{var{typed:e,config:r,add:n,numeric:i}=t,a=LF({typed:e,config:r,add:n,numeric:i});return e(jT,{"...any":function(o){o=_l(o);try{return a.apply(null,o)}catch(l){throw Qi(l)}}})},{isTransformFunction:!0}),uhe="quantileSeq",lhe=["typed","bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger","mapSlices"],che=ee(uhe,lhe,t=>{var{typed:e,bignumber:r,add:n,subtract:i,divide:a,multiply:s,partitionSelect:o,compare:l,isInteger:u,smaller:c,smallerEq:f,larger:h,mapSlices:p}=t,m=qF({typed:e,bignumber:r,add:n,subtract:i,divide:a,multiply:s,partitionSelect:o,compare:l,isInteger:u,smaller:c,smallerEq:f,larger:h,mapSlices:p});return e("quantileSeq",{"Array | Matrix, number | BigNumber":m,"Array | Matrix, number | BigNumber, number":(y,x,S)=>m(y,x,v(S)),"Array | Matrix, number | BigNumber, boolean":m,"Array | Matrix, number | BigNumber, boolean, number":(y,x,S,b)=>m(y,x,S,v(b)),"Array | Matrix, Array | Matrix":m,"Array | Matrix, Array | Matrix, number":(y,x,S)=>m(y,x,v(S)),"Array | Matrix, Array | Matrix, boolean":m,"Array | Matrix, Array | Matrix, boolean, number":(y,x,S,b)=>m(y,x,S,v(b))});function v(y){return _l([[],y])[1]}},{isTransformFunction:!0}),YT="cumsum",fhe=["typed","add","unaryPlus"],hhe=ee(YT,fhe,t=>{var{typed:e,add:r,unaryPlus:n}=t,i=UF({typed:e,add:r,unaryPlus:n});return e(YT,{"...any":function(s){if(s.length===2&&is(s[0])){var o=s[1];sr(o)?s[1]=o-1:or(o)&&(s[1]=o.minus(1))}try{return i.apply(null,s)}catch(l){throw Qi(l)}}})},{isTransformFunction:!0}),KT="variance",dhe=["typed","add","subtract","multiply","divide","mapSlices","isNaN"],phe=ee(KT,dhe,t=>{var{typed:e,add:r,subtract:n,multiply:i,divide:a,mapSlices:s,isNaN:o}=t,l=GF({typed:e,add:r,subtract:n,multiply:i,divide:a,mapSlices:s,isNaN:o});return e(KT,{"...any":function(c){c=_l(c);try{return l.apply(null,c)}catch(f){throw Qi(f)}}})},{isTransformFunction:!0}),ZT="print",mhe=["typed","matrix","zeros","add"],vhe=ee(ZT,mhe,t=>{var{typed:e,matrix:r,zeros:n,add:i}=t,a=MF({typed:e,matrix:r,zeros:n,add:i});return e(ZT,{"string, Object | Array":function(l,u){return a(s(l),u)},"string, Object | Array, number | Object":function(l,u,c){return a(s(l),u,c)}});function s(o){return o.replace(NF,l=>{var u=l.slice(1).split("."),c=u.map(function(f){return!isNaN(f)&&f.length>0?parseInt(f)-1:f});return"$"+c.join(".")})}},{isTransformFunction:!0}),ghe="and",yhe=["typed","matrix","zeros","add","equalScalar","not","concat"],bhe=ee(ghe,yhe,t=>{var{typed:e,matrix:r,equalScalar:n,zeros:i,not:a,concat:s}=t,o=IF({typed:e,matrix:r,equalScalar:n,zeros:i,not:a,concat:s});function l(u,c,f){var h=u[0].compile().evaluate(f);if(!is(h)&&!o(h,!0))return!1;var p=u[1].compile().evaluate(f);return o(h,p)}return l.rawArgs=!0,l},{isTransformFunction:!0}),xhe="or",whe=["typed","matrix","equalScalar","DenseMatrix","concat"],_he=ee(xhe,whe,t=>{var{typed:e,matrix:r,equalScalar:n,DenseMatrix:i,concat:a}=t,s=gF({typed:e,matrix:r,equalScalar:n,DenseMatrix:i,concat:a});function o(l,u,c){var f=l[0].compile().evaluate(c);if(!is(f)&&s(f,!1))return!0;var h=l[1].compile().evaluate(c);return s(f,h)}return o.rawArgs=!0,o},{isTransformFunction:!0}),Ahe="bitAnd",Ehe=["typed","matrix","zeros","add","equalScalar","not","concat"],She=ee(Ahe,Ehe,t=>{var{typed:e,matrix:r,equalScalar:n,zeros:i,not:a,concat:s}=t,o=mF({typed:e,matrix:r,equalScalar:n,zeros:i,not:a,concat:s});function l(u,c,f){var h=u[0].compile().evaluate(f);if(!is(h)){if(isNaN(h))return NaN;if(h===0||h===!1)return 0}var p=u[1].compile().evaluate(f);return o(h,p)}return l.rawArgs=!0,l},{isTransformFunction:!0}),Dhe="bitOr",Che=["typed","matrix","equalScalar","DenseMatrix","concat"],The=ee(Dhe,Che,t=>{var{typed:e,matrix:r,equalScalar:n,DenseMatrix:i,concat:a}=t,s=vF({typed:e,matrix:r,equalScalar:n,DenseMatrix:i,concat:a});function o(l,u,c){var f=l[0].compile().evaluate(c);if(!is(f)){if(isNaN(f))return NaN;if(f===-1)return-1;if(f===!0)return 1}var h=l[1].compile().evaluate(c);return s(f,h)}return o.rawArgs=!0,o},{isTransformFunction:!0}),mt=EV({config:Ze}),nn=NV({}),QT=ice({BigNumber:mt,config:Ze}),Nhe=Qle({}),Mhe=Bce({BigNumber:mt,config:Ze}),Nc=PV({}),XF=hce({Complex:nn}),Ihe=ece({BigNumber:mt,config:Ze}),Fhe=oce({BigNumber:mt,config:Ze}),Ohe=lce({BigNumber:mt,config:Ze}),pg=GV({}),Bhe=tce({BigNumber:mt,config:Ze}),Rhe=Jle({}),Phe=ace({BigNumber:mt,config:Ze}),$he=LV({}),jF=TW({}),khe=cce({BigNumber:mt,config:Ze}),Lhe=Jce({BigNumber:mt,config:Ze}),YF=nce({BigNumber:mt,config:Ze}),Uhe=Zle({}),zhe=dce({}),cr=iX({Matrix:pg}),Ghe=qce({BigNumber:mt,config:Ze}),qhe=sce({BigNumber:mt,config:Ze}),nb=rce({BigNumber:mt,config:Ze}),KF=Yle({}),Hhe=fce({BigNumber:mt,config:Ze}),pe=EW({BigNumber:mt,Complex:nn,DenseMatrix:cr,Fraction:Nc}),Whe=Gce({BigNumber:mt,config:Ze}),Ji=bj({typed:pe}),Vhe=VJ({Complex:nn,config:Ze,typed:pe}),Xhe=KJ({BigNumber:mt,typed:pe}),jhe=eee({BigNumber:mt,Complex:nn,config:Ze,typed:pe}),ei=Aj({typed:pe}),Yhe=fK({typed:pe}),Khe=see({BigNumber:mt,Complex:nn,config:Ze,typed:pe}),Zhe=fee({typed:pe}),ZF=pee({typed:pe}),Qhe=yee({Complex:nn,config:Ze,typed:pe}),Jhe=HX({typed:pe}),ede=iK({typed:pe}),tde=jX({typed:pe}),rde=sX({typed:pe}),mg=Nue({typed:pe}),vg=ej({Complex:nn,typed:pe}),Mc=dK({typed:pe}),px=xee({typed:pe}),nde=Eee({BigNumber:mt,typed:pe}),ide=Tee({BigNumber:mt,typed:pe}),ade=Lj({typed:pe}),xr=OX({config:Ze,typed:pe}),sde=IZ({typed:pe}),QF=zj({typed:pe}),ode=qj({Complex:nn,typed:pe}),ude=xF({typed:pe}),Vd=BK({typed:pe}),lde=wF({typed:pe}),Xd=GZ({typed:pe}),mx=kK({typed:pe}),cde=jZ({format:Xd,typed:pe}),vx=mK({typed:pe}),pa=uX({typed:pe}),Al=yX({config:Ze,typed:pe}),Ic=EX({config:Ze,typed:pe}),Eo=DX({equalScalar:xr,typed:pe}),fde=uce({BigNumber:mt,config:Ze}),hde=Rue({Complex:nn,typed:pe}),dde=EY({Complex:nn,config:Ze,typed:pe}),gx=DY({Complex:nn,config:Ze,typed:pe}),Fc=_F({typed:pe}),Cn=NY({typed:pe}),Ov=bK({typed:pe}),wu=zX({typed:pe}),pde=VZ({format:Xd,typed:pe}),mde=sle({config:Ze,typed:pe}),vde=MF({typed:pe}),gde=ule({config:Ze,typed:pe}),yx=gK({typed:pe}),yde=Fee({BigNumber:mt,typed:pe}),JF=RY({BigNumber:mt,Fraction:Nc,complex:vg,typed:pe}),gg=Pee({typed:pe}),ti=PX({Matrix:pg,equalScalar:xr,typed:pe}),bde=dj({typed:pe}),xde=UY({typed:pe}),wde=VX({typed:pe}),os=Sj({typed:pe}),_de=Uee({typed:pe}),bx=MX({typed:pe}),Ade=jJ({Complex:nn,config:Ze,typed:pe}),Ede=ree({BigNumber:mt,typed:pe}),Sde=iee({BigNumber:mt,Complex:nn,config:Ze,typed:pe}),ma=ZX({BigNumber:mt,typed:pe}),Dde=Iue({typed:pe}),Cde=_ee({typed:pe}),Tde=Mee({BigNumber:mt,typed:pe}),mu=TX({typed:pe}),Nde=JZ({typed:pe}),Bd=j1({isInteger:pa,typed:pe}),pt=aj({DenseMatrix:cr,Matrix:pg,SparseMatrix:ti,typed:pe}),Mde=oj({isZero:Eo,matrix:pt,typed:pe}),Ide=XK({BigNumber:mt,config:Ze,matrix:pt,typed:pe}),Fde=cle({config:Ze,log2:gx,typed:pe}),e3=KK({isInteger:pa,matrix:pt,typed:pe}),Ode=Bee({BigNumber:mt,typed:pe}),Bde=kee({typed:pe}),Rde=GJ({SparseMatrix:ti,typed:pe}),Ws=kY({Complex:nn,config:Ze,typed:pe}),Pde=uZ({typed:pe}),$de=qee({typed:pe}),jd=pZ({matrix:pt,typed:pe}),t3=HY({BigNumber:mt,config:Ze,matrix:pt,typed:pe}),bi=yZ({BigNumber:mt,config:Ze,matrix:pt,typed:pe}),kde=QJ({BigNumber:mt,Complex:nn,config:Ze,typed:pe}),Lde=uee({Complex:nn,config:Ze,typed:pe}),Ude=HZ({format:Xd,typed:pe}),Rr=yF({isInteger:pa,matrix:pt,typed:pe}),zde=Dee({BigNumber:mt,typed:pe}),xx=vZ({conj:Mc,transpose:jd,typed:pe}),r3=MK({DenseMatrix:cr,SparseMatrix:ti,matrix:pt,typed:pe}),Gde=KY({concat:Rr,equalScalar:xr,matrix:pt,multiplyScalar:Cn,typed:pe}),us=XQ({DenseMatrix:cr,SparseMatrix:ti,concat:Rr,equalScalar:xr,matrix:pt,typed:pe}),Yd=nj({Fraction:Nc,typed:pe}),El=UK({BigNumber:mt,DenseMatrix:cr,SparseMatrix:ti,config:Ze,matrix:pt,typed:pe}),Oc=xX({typed:pe}),qde=GK({matrix:pt,multiplyScalar:Cn,typed:pe}),yg=oJ({DenseMatrix:cr,SparseMatrix:ti,concat:Rr,config:Ze,matrix:pt,typed:pe}),Hde=IQ({DenseMatrix:cr,concat:Rr,equalScalar:xr,matrix:pt,typed:pe,zeros:bi}),Wde=kZ({isNaN:mu,isNumeric:Oc,typed:pe}),Vde=OY({BigNumber:mt,concat:Rr,equalScalar:xr,matrix:pt,typed:pe}),ns=rQ({bignumber:ma,fraction:Yd,number:wu}),n3=UZ({config:Ze,multiplyScalar:Cn,numeric:ns,typed:pe}),Xde=JK({config:Ze,matrix:pt}),jde=OQ({DenseMatrix:cr,concat:Rr,equalScalar:xr,matrix:pt,typed:pe,zeros:bi}),Ch=uQ({BigNumber:mt,DenseMatrix:cr,config:Ze,equalScalar:xr,matrix:pt,typed:pe,zeros:bi}),Si=sZ({matrix:pt,config:Ze,typed:pe}),Xi=QQ({DenseMatrix:cr,SparseMatrix:ti,bignumber:ma,concat:Rr,config:Ze,matrix:pt,typed:pe}),Yde=ZZ({concat:Rr,matrix:pt,typed:pe}),So=mj({typed:pe}),Kde=hJ({DenseMatrix:cr,SparseMatrix:ti,concat:Rr,config:Ze,equalScalar:xr,matrix:pt,typed:pe}),Zde=_K({DenseMatrix:cr,SparseMatrix:ti,concat:Rr,matrix:pt,typed:pe}),Cr=fte({DenseMatrix:cr,SparseMatrix:ti,addScalar:ei,concat:Rr,equalScalar:xr,matrix:pt,typed:pe}),Qde=vee({BigNumber:mt,DenseMatrix:cr,concat:Rr,equalScalar:xr,matrix:pt,typed:pe}),Jde=mF({concat:Rr,equalScalar:xr,matrix:pt,typed:pe}),epe=vF({DenseMatrix:cr,concat:Rr,equalScalar:xr,matrix:pt,typed:pe}),tpe=lK({DenseMatrix:cr,SparseMatrix:ti,concat:Rr,matrix:pt,typed:pe}),i3=Cj({BigNumber:mt,Complex:nn,Fraction:Nc,config:Ze,isNegative:Al,matrix:pt,typed:pe,unaryMinus:So}),Bc=kQ({BigNumber:mt,DenseMatrix:cr,Fraction:Nc,concat:Rr,config:Ze,equalScalar:xr,matrix:pt,typed:pe}),a3=WQ({concat:Rr,matrix:pt,typed:pe}),rpe=DK({prod:n3,size:Si,typed:pe}),wx=cJ({equal:us,typed:pe}),vn=iQ({numeric:ns,typed:pe}),Kd=bQ({DenseMatrix:cr,SparseMatrix:ti,concat:Rr,divideScalar:vn,equalScalar:xr,matrix:pt,typed:pe}),npe=KQ({compareText:a3,isZero:Eo,typed:pe}),s3=hF({DenseMatrix:cr,config:Ze,equalScalar:xr,matrix:pt,round:Ch,typed:pe,zeros:bi}),ipe=gY({BigNumber:mt,DenseMatrix:cr,concat:Rr,config:Ze,equalScalar:xr,matrix:pt,round:Ch,typed:pe,zeros:bi}),ape=_X({isNumeric:Oc,typed:pe}),spe=dte({abs:Ji,addScalar:ei,divideScalar:vn,isPositive:Ic,multiplyScalar:Cn,smaller:Xi,sqrt:Ws,typed:pe}),o3=_J({DenseMatrix:cr,smaller:Xi}),Oi=SJ({ImmutableDenseMatrix:o3,getMatrixDataType:mx}),ji=iJ({DenseMatrix:cr,SparseMatrix:ti,bignumber:ma,concat:Rr,config:Ze,matrix:pt,typed:pe}),_x=fQ({Complex:nn,config:Ze,divideScalar:vn,typeOf:bx,typed:pe}),u3=wQ({DenseMatrix:cr,divideScalar:vn,equalScalar:xr,matrix:pt,multiplyScalar:Cn,subtractScalar:os,typed:pe}),Ax=fj({flatten:Vd,matrix:pt,size:Si,typed:pe}),Ex=FF({config:Ze,isNaN:mu,larger:ji,numeric:ns,typed:pe}),ope=OF({config:Ze,isNaN:mu,numeric:ns,smaller:Xi,typed:pe}),l3=dF({DenseMatrix:cr,concat:Rr,config:Ze,equalScalar:xr,matrix:pt,round:Ch,typed:pe,zeros:bi}),upe=mQ({Complex:nn,config:Ze,divideScalar:vn,typed:pe}),lpe=gF({DenseMatrix:cr,concat:Rr,equalScalar:xr,matrix:pt,typed:pe}),bg=mJ({compare:Bc,isNaN:mu,isNumeric:Oc,typed:pe}),Sx=Sre({addScalar:ei,complex:vg,conj:Mc,divideScalar:vn,equal:us,identity:El,isZero:Eo,matrix:pt,multiplyScalar:Cn,sign:JF,sqrt:Ws,subtractScalar:os,typed:pe,unaryMinus:So,zeros:bi}),cpe=RQ({DenseMatrix:cr,concat:Rr,equalScalar:xr,matrix:pt,typed:pe,zeros:bi}),oh=tJ({DenseMatrix:cr,SparseMatrix:ti,concat:Rr,config:Ze,matrix:pt,typed:pe}),Na=TF({add:Cr,matrix:pt,typed:pe,zeros:bi}),Ln=GY({DenseMatrix:cr,concat:Rr,equalScalar:xr,matrix:pt,subtractScalar:os,typed:pe,unaryMinus:So}),fpe=xte({add:Cr,matrix:pt,typed:pe}),Dx=AQ({DenseMatrix:cr,divideScalar:vn,equalScalar:xr,matrix:pt,multiplyScalar:Cn,subtractScalar:os,typed:pe}),hpe=vle({addScalar:ei,combinations:mg,divideScalar:vn,isInteger:pa,isNegative:Al,multiplyScalar:Cn,typed:pe}),Do=GQ({compare:Bc,typed:pe}),dpe=yle({addScalar:ei,combinations:mg,isInteger:pa,isNegative:Al,isPositive:Ic,larger:ji,typed:pe}),ppe=AF({matrix:pt,number:wu,subtract:Ln,typed:pe}),mpe=hue({abs:Ji,addScalar:ei,deepEqual:wx,divideScalar:vn,multiplyScalar:Cn,sqrt:Ws,subtractScalar:os,typed:pe}),xg=gte({addScalar:ei,conj:Mc,multiplyScalar:Cn,size:Si,typed:pe}),c3=TJ({larger:ji,smaller:Xi}),f3=_te({Index:Oi,typed:pe}),vpe=VY({BigNumber:mt,add:Cr,config:Ze,equal:us,isInteger:pa,mod:l3,smaller:Xi,typed:pe,xgcd:t3}),gpe=wY({concat:Rr,equalScalar:xr,matrix:pt,typed:pe}),ype=dQ({Complex:nn,config:Ze,divideScalar:vn,log:_x,typed:pe}),bpe=SQ({DenseMatrix:cr,divideScalar:vn,equalScalar:xr,matrix:pt,multiplyScalar:Cn,subtractScalar:os,typed:pe}),xpe=lj({flatten:Vd,matrix:pt,size:Si,typed:pe}),Vr=IY({addScalar:ei,dot:xg,equalScalar:xr,matrix:pt,multiplyScalar:Cn,typed:pe}),uh=DF({bignumber:ma,matrix:pt,add:Cr,config:Ze,isPositive:Ic,larger:ji,largerEq:yg,smaller:Xi,smallerEq:oh,typed:pe}),wpe=CF({Index:Oi,matrix:pt,range:uh,typed:pe}),_pe=Wee({DenseMatrix:cr,Index:Oi,compareNatural:Do,size:Si,subset:Na,typed:pe}),Ape=Yee({DenseMatrix:cr,Index:Oi,compareNatural:Do,size:Si,subset:Na,typed:pe}),Epe=Jee({Index:Oi,compareNatural:Do,size:Si,subset:Na,typed:pe}),Spe=nte({Index:Oi,compareNatural:Do,size:Si,subset:Na,typed:pe}),h3=Yre({SparseMatrix:ti,abs:Ji,add:Cr,divideScalar:vn,larger:ji,largerEq:yg,multiply:Vr,subtract:Ln,transpose:jd,typed:pe}),Dpe=gJ({compare:Bc,compareNatural:Do,matrix:pt,typed:pe}),Cx=gj({config:Ze,numeric:ns,typed:pe}),d3=CQ({DenseMatrix:cr,divideScalar:vn,equalScalar:xr,matrix:pt,multiplyScalar:Cn,subtractScalar:os,typed:pe}),Cpe=zle({Complex:nn,add:Cr,multiply:Vr,number:wu,typed:pe}),Tpe=IF({concat:Rr,equalScalar:xr,matrix:pt,not:Ov,typed:pe,zeros:bi}),Tx=$j({DenseMatrix:cr,config:Ze,equalScalar:xr,matrix:pt,round:Ch,typed:pe,zeros:bi}),p3=bF({Index:Oi,matrix:pt,range:uh,typed:pe}),Npe=TK({matrix:pt,multiply:Vr,subtract:Ln,typed:pe}),m3=Goe({divideScalar:vn,isZero:Eo,matrix:pt,multiply:Vr,subtractScalar:os,typed:pe,unaryMinus:So}),v3=Vj({Complex:nn,DenseMatrix:cr,ceil:Tx,equalScalar:xr,floor:s3,matrix:pt,typed:pe,zeros:bi}),Rc=Hoe({abs:Ji,addScalar:ei,det:m3,divideScalar:vn,identity:El,matrix:pt,multiply:Vr,typed:pe,unaryMinus:So}),Mpe=Voe({Complex:nn,add:Cr,ctranspose:xx,deepEqual:wx,divideScalar:vn,dot:xg,dotDivide:Kd,equal:us,inv:Rc,matrix:pt,multiply:Vr,typed:pe}),Vs=sQ({Complex:nn,config:Ze,fraction:Yd,identity:El,inv:Rc,matrix:pt,multiply:Vr,number:wu,typed:pe}),g3=Xee({DenseMatrix:cr,Index:Oi,compareNatural:Do,size:Si,subset:Na,typed:pe}),Ipe=tte({Index:Oi,compareNatural:Do,size:Si,subset:Na,typed:pe}),y3=ote({Index:Oi,concat:Rr,setDifference:g3,size:Si,subset:Na,typed:pe}),b3=IJ({FibonacciHeap:c3,addScalar:ei,equalScalar:xr}),Fpe=tue({abs:Ji,add:Cr,identity:El,inv:Rc,map:Fc,max:Ex,multiply:Vr,size:Si,sqrt:Ws,subtract:Ln,typed:pe}),Nx=LF({add:Cr,config:Ze,numeric:ns,typed:pe}),jt=kJ({BigNumber:mt,Complex:nn,Fraction:Nc,abs:Ji,addScalar:ei,config:Ze,divideScalar:vn,equal:us,fix:v3,format:Xd,isNumeric:Oc,multiplyScalar:Cn,number:wu,pow:Vs,round:Ch,subtractScalar:os}),Ope=xce({BigNumber:mt,Unit:jt,config:Ze}),Bpe=rfe({BigNumber:mt,Unit:jt,config:Ze}),Rpe=Hce({BigNumber:mt,Unit:jt,config:Ze}),Ppe=Ece({BigNumber:mt,Unit:jt,config:Ze}),$pe=Vce({BigNumber:mt,Unit:jt,config:Ze}),kpe=Sce({BigNumber:mt,Unit:jt,config:Ze}),Lpe=wce({BigNumber:mt,Unit:jt,config:Ze}),Upe=HJ({Unit:jt,typed:pe}),zpe=$ce({BigNumber:mt,Unit:jt,config:Ze}),Gpe=gQ({DenseMatrix:cr,SparseMatrix:ti,concat:Rr,equalScalar:xr,matrix:pt,pow:Vs,typed:pe}),qpe=bce({BigNumber:mt,Unit:jt,config:Ze}),Hpe=Ace({BigNumber:mt,Unit:jt,config:Ze}),Wpe=Joe({abs:Ji,add:Cr,identity:El,inv:Rc,multiply:Vr,typed:pe}),Vpe=Xce({BigNumber:mt,Unit:jt,config:Ze}),x3=xZ({addScalar:ei,ceil:Tx,conj:Mc,divideScalar:vn,dotDivide:Kd,exp:QF,i:XF,log2:gx,matrix:pt,multiplyScalar:Cn,pow:Vs,tau:YF,typed:pe}),Mx=Oue({BigNumber:mt,Complex:nn,config:Ze,multiplyScalar:Cn,pow:Vs,typed:pe}),Xpe=mce({BigNumber:mt,Unit:jt,config:Ze}),jpe=Rce({BigNumber:mt,Unit:jt,config:Ze}),Ype=_Z({conj:Mc,dotDivide:Kd,fft:x3,typed:pe}),Kpe=Dce({BigNumber:mt,Unit:jt,config:Ze}),Zpe=Nce({BigNumber:mt,Unit:jt,config:Ze}),Qpe=Yce({BigNumber:mt,Unit:jt,config:Ze}),Jpe=yce({BigNumber:mt,Unit:jt,config:Ze}),eme=nfe({BigNumber:mt,Unit:jt,config:Ze}),tme=Zce({BigNumber:mt,Unit:jt,config:Ze}),rme=kce({BigNumber:mt,Unit:jt,config:Ze}),nme=Tce({BigNumber:mt,Unit:jt,config:Ze}),ime=lfe({BigNumber:mt,Unit:jt,config:Ze}),ame=sfe({BigNumber:mt,Unit:jt,config:Ze}),sme=cfe({BigNumber:mt,Unit:jt,config:Ze}),ome=Pce({BigNumber:mt,Unit:jt,config:Ze}),ume=Lce({BigNumber:mt,Unit:jt,config:Ze}),lme=gce({BigNumber:mt,Unit:jt,config:Ze}),cme=Uce({BigNumber:mt,Unit:jt,config:Ze}),fme=efe({BigNumber:mt,Unit:jt,config:Ze}),hme=ate({compareNatural:Do,typed:pe}),dme=pce({BigNumber:mt,Unit:jt,config:Ze}),pme=tfe({BigNumber:mt,Unit:jt,config:Ze}),mme=zce({BigNumber:mt,Unit:jt,config:Ze}),vme=Wce({BigNumber:mt,Unit:jt,config:Ze}),gme=Mce({BigNumber:mt,Unit:jt,config:Ze}),yme=_ce({BigNumber:mt,Unit:jt,config:Ze}),wi=cue({divideScalar:vn,equalScalar:xr,inv:Rc,matrix:pt,multiply:Vr,typed:pe}),bme=Fce({BigNumber:mt,Unit:jt,config:Ze}),Zd=$ue({gamma:Mx,typed:pe}),xme=jce({BigNumber:mt,Unit:jt,config:Ze}),wme=afe({BigNumber:mt,Unit:jt,config:Ze}),_me=mue({abs:Ji,add:Cr,addScalar:ei,config:Ze,divideScalar:vn,equalScalar:xr,flatten:Vd,isNumeric:Oc,isZero:Eo,matrix:pt,multiply:Vr,multiplyScalar:Cn,smaller:Xi,subtract:Ln,typed:pe}),w3=Are({DenseMatrix:cr,Spa:b3,SparseMatrix:ti,abs:Ji,addScalar:ei,divideScalar:vn,equalScalar:xr,larger:ji,matrix:pt,multiplyScalar:Cn,subtractScalar:os,typed:pe,unaryMinus:So}),Ame=Cce({BigNumber:mt,Unit:jt,config:Ze}),Eme=ife({BigNumber:mt,Unit:jt,config:Ze}),Sme=zue({add:Cr,divide:wi,factorial:Zd,isInteger:pa,isPositive:Ic,multiply:Vr,typed:pe}),Dme=que({factorial:Zd,typed:pe}),Cme=ofe({BigNumber:mt,Unit:jt,config:Ze}),Tme=Jre({add:Cr,cbrt:i3,divide:wi,equalScalar:xr,im:vx,isZero:Eo,multiply:Vr,re:yx,sqrt:Ws,subtract:Ln,typeOf:bx,typed:pe,unaryMinus:So}),_3=Zee({DenseMatrix:cr,Index:Oi,compareNatural:Do,size:Si,subset:Na,typed:pe}),Nme=TZ({abs:Ji,add:Cr,bignumber:ma,divide:wi,isNegative:Al,isPositive:Ic,larger:ji,map:Fc,matrix:pt,max:Ex,multiply:Vr,smaller:Xi,subtract:Ln,typed:pe,unaryMinus:So}),A3=hle({bignumber:ma,addScalar:ei,combinations:mg,divideScalar:vn,factorial:Zd,isInteger:pa,isNegative:Al,larger:ji,multiplyScalar:Cn,number:wu,pow:Vs,subtractScalar:os,typed:pe}),Mme=UJ({Unit:jt,typed:pe}),Ime=ple({addScalar:ei,isInteger:pa,isNegative:Al,stirlingS2:A3,typed:pe}),Fme=UF({add:Cr,typed:pe,unaryPlus:Cx}),E3=Zoe({abs:Ji,add:Cr,addScalar:ei,atan:ZF,bignumber:ma,column:p3,complex:vg,config:Ze,cos:px,diag:r3,divideScalar:vn,dot:xg,equal:us,flatten:Vd,im:vx,inv:Rc,larger:ji,matrix:pt,matrixFromColumns:Ax,multiply:Vr,multiplyScalar:Cn,number:wu,qr:Sx,re:yx,reshape:e3,sin:gg,size:Si,smaller:Xi,sqrt:Ws,subtract:Ln,typed:pe,usolve:Dx,usolveAll:d3}),Ome=Oce({BigNumber:mt,Unit:jt,config:Ze}),Bme=Kce({BigNumber:mt,Unit:jt,config:Ze}),Rme=Lue({divide:wi,dotDivide:Kd,isNumeric:Oc,log:_x,map:Fc,matrix:pt,multiply:Vr,sum:Nx,typed:pe}),S3=Zre({DenseMatrix:cr,lsolve:u3,lup:w3,matrix:pt,slu:h3,typed:pe,usolve:Dx}),D3=zF({add:Cr,divide:wi,typed:pe}),Pme=Qce({BigNumber:mt,Unit:jt,config:Ze}),$me=vce({BigNumber:mt,Unit:jt,config:Ze}),kme=qF({bignumber:ma,add:Cr,compare:Bc,divide:wi,isInteger:pa,larger:ji,mapSlices:Bd,multiply:Vr,partitionSelect:bg,smaller:Xi,smallerEq:oh,subtract:Ln,typed:pe}),Lme=lte({Index:Oi,concat:Rr,setIntersect:_3,setSymDifference:y3,size:Si,subset:Na,typed:pe}),Ix=GF({add:Cr,divide:wi,isNaN:mu,mapSlices:Bd,multiply:Vr,subtract:Ln,typed:pe}),Ume=Ice({BigNumber:mt,Unit:jt,config:Ze}),C3=xue({add:Cr,compare:Bc,divide:wi,partitionSelect:bg,typed:pe}),zme=Cue({add:Cr,divide:wi,matrix:pt,mean:D3,multiply:Vr,pow:Vs,sqrt:Ws,subtract:Ln,sum:Nx,typed:pe}),Gme=qle({Complex:nn,add:Cr,divide:wi,matrix:pt,multiply:Vr,typed:pe}),qme=_ue({abs:Ji,map:Fc,median:C3,subtract:Ln,typed:pe}),Hme=HF({map:Fc,sqrt:Ws,typed:pe,variance:Ix}),Wme=PZ({BigNumber:mt,Complex:nn,add:Cr,config:Ze,divide:wi,equal:us,factorial:Zd,gamma:Mx,isNegative:Al,multiply:Vr,pi:nb,pow:Vs,sin:gg,smallerEq:oh,subtract:Ln,typed:pe}),Fx=mte({abs:Ji,add:Cr,conj:Mc,ctranspose:xx,eigs:E3,equalScalar:xr,larger:ji,matrix:pt,multiply:Vr,pow:Vs,smaller:Xi,sqrt:Ws,typed:pe}),T3=nZ({BigNumber:mt,DenseMatrix:cr,SparseMatrix:ti,addScalar:ei,config:Ze,cos:px,matrix:pt,multiplyScalar:Cn,norm:Fx,sin:gg,typed:pe,unaryMinus:So}),Vme=ufe({BigNumber:mt,Unit:jt,config:Ze}),N3=aue({identity:El,matrix:pt,multiply:Vr,norm:Fx,qr:Sx,subtract:Ln,typed:pe}),Xme=tZ({multiply:Vr,rotationMatrix:T3,typed:pe}),M3=nue({abs:Ji,add:Cr,concat:Rr,identity:El,index:f3,lusolve:S3,matrix:pt,matrixFromColumns:Ax,multiply:Vr,range:uh,schur:N3,subset:Na,subtract:Ln,transpose:jd,typed:pe}),jme=oue({matrix:pt,multiply:Vr,sylvester:M3,transpose:jd,typed:pe}),Th={},Qd={},I3={},$i=Ste({mathWithTransform:Qd}),Nh=Zte({Node:$i}),_u=Jte({Node:$i}),Pc=tre({Node:$i}),F3=are({Node:$i}),Mh=Nte({Node:$i}),O3=Rte({Node:$i,ResultSet:jF}),B3=$te({Node:$i}),Sl=Wte({Node:$i}),R3=nre({Node:$i}),Yme=Vle({classes:I3}),Ox=ane({math:Th,typed:pe}),P3=Xte({Node:$i,typed:pe}),Kme=Uoe({Chain:Ox,typed:pe}),Ih=Cte({Node:$i,subset:Na}),$3=Ote({matrix:pt,Node:$i,subset:Na}),Fh=Yte({Node:$i,size:Si}),Dl=ure({Unit:jt,Node:$i,math:Th}),Cl=cre({Node:$i,SymbolNode:Dl,math:Th}),Xs=hre({AccessorNode:Ih,ArrayNode:Mh,AssignmentNode:$3,BlockNode:O3,ConditionalNode:B3,ConstantNode:Sl,FunctionAssignmentNode:P3,FunctionNode:Cl,IndexNode:Fh,ObjectNode:Nh,OperatorNode:_u,ParenthesisNode:Pc,RangeNode:R3,RelationalNode:F3,SymbolNode:Dl,config:Ze,numeric:ns,typed:pe}),k3=Ole({ConstantNode:Sl,FunctionNode:Cl,OperatorNode:_u,ParenthesisNode:Pc,parse:Xs,typed:pe}),Bx=Tle({bignumber:ma,fraction:Yd,AccessorNode:Ih,ArrayNode:Mh,ConstantNode:Sl,FunctionNode:Cl,IndexNode:Fh,ObjectNode:Nh,OperatorNode:_u,SymbolNode:Dl,config:Ze,mathWithTransform:Qd,matrix:pt,typed:pe}),Zme=pre({parse:Xs,typed:pe}),Rx=Mle({AccessorNode:Ih,ArrayNode:Mh,ConstantNode:Sl,FunctionNode:Cl,IndexNode:Fh,ObjectNode:Nh,OperatorNode:_u,ParenthesisNode:Pc,SymbolNode:Dl,add:Cr,divide:wi,equal:us,isZero:Eo,multiply:Vr,parse:Xs,pow:Vs,subtract:Ln,typed:pe}),wg=vre({parse:Xs,typed:pe}),L3=rne({evaluate:wg}),U3=bre({evaluate:wg,parse:Xs}),_g=Sle({AccessorNode:Ih,ArrayNode:Mh,ConstantNode:Sl,FunctionNode:Cl,IndexNode:Fh,ObjectNode:Nh,OperatorNode:_u,ParenthesisNode:Pc,SymbolNode:Dl,equal:us,parse:Xs,replacer:KF,resolve:k3,simplifyConstant:Bx,simplifyCore:Rx,typed:pe}),Qme=Rle({OperatorNode:_u,parse:Xs,simplify:_g,typed:pe}),Jme=xle({parse:Xs,typed:pe}),eve=wre({Parser:U3,typed:pe}),tve=Lle({bignumber:ma,fraction:Yd,AccessorNode:Ih,ArrayNode:Mh,ConstantNode:Sl,FunctionNode:Cl,IndexNode:Fh,ObjectNode:Nh,OperatorNode:_u,ParenthesisNode:Pc,SymbolNode:Dl,add:Cr,config:Ze,divide:wi,equal:us,isZero:Eo,mathWithTransform:Qd,matrix:pt,multiply:Vr,parse:Xs,pow:Vs,simplify:_g,simplifyConstant:Bx,simplifyCore:Rx,subtract:Ln,typed:pe}),rve=$le({ConstantNode:Sl,FunctionNode:Cl,OperatorNode:_u,ParenthesisNode:Pc,SymbolNode:Dl,config:Ze,equal:us,isZero:Eo,numeric:ns,parse:Xs,simplify:_g,typed:pe}),nve=koe({Help:L3,mathWithTransform:Qd,typed:pe});Zn(Th,{e:QT,false:Nhe,fineStructure:Mhe,i:XF,Infinity:Ihe,LN10:Fhe,LOG10E:Ohe,NaN:Bhe,null:Rhe,phi:Phe,SQRT1_2:khe,sackurTetrode:Lhe,tau:YF,true:Uhe,E:QT,version:zhe,efimovFactor:Ghe,LN2:qhe,pi:nb,replacer:KF,reviver:Yme,SQRT2:Hhe,typed:pe,PI:nb,weakMixingAngle:Whe,abs:Ji,acos:Vhe,acot:Xhe,acsc:jhe,addScalar:ei,arg:Yhe,asech:Khe,asinh:Zhe,atan:ZF,atanh:Qhe,bigint:Jhe,bitNot:ede,boolean:tde,clone:rde,combinations:mg,complex:vg,conj:Mc,cos:px,cot:nde,csc:ide,cube:ade,equalScalar:xr,erf:sde,exp:QF,expm1:ode,filter:ude,flatten:Vd,forEach:lde,format:Xd,getMatrixDataType:mx,hex:cde,im:vx,isInteger:pa,isNegative:Al,isPositive:Ic,isZero:Eo,LOG2E:fde,lgamma:hde,log10:dde,log2:gx,map:Fc,multiplyScalar:Cn,not:Ov,number:wu,oct:pde,pickRandom:mde,print:vde,random:gde,re:yx,sec:yde,sign:JF,sin:gg,splitUnit:bde,square:xde,string:wde,subtractScalar:os,tan:_de,typeOf:bx,acosh:Ade,acsch:Ede,asec:Sde,bignumber:ma,chain:Kme,combinationsWithRep:Dde,cosh:Cde,csch:Tde,isNaN:mu,isPrime:Nde,mapSlices:Bd,matrix:pt,matrixFromFunction:Mde,ones:Ide,randomInt:Fde,reshape:e3,sech:Ode,sinh:Bde,sparse:Rde,sqrt:Ws,squeeze:Pde,tanh:$de,transpose:jd,xgcd:t3,zeros:bi,acoth:kde,asin:Lde,bin:Ude,concat:Rr,coth:zde,ctranspose:xx,diag:r3,dotMultiply:Gde,equal:us,fraction:Yd,identity:El,isNumeric:Oc,kron:qde,largerEq:yg,leftShift:Hde,mode:Wde,nthRoot:Vde,numeric:ns,prod:n3,resize:Xde,rightArithShift:jde,round:Ch,size:Si,smaller:Xi,to:Yde,unaryMinus:So,unequal:Kde,xor:Zde,add:Cr,atan2:Qde,bitAnd:Jde,bitOr:epe,bitXor:tpe,cbrt:i3,compare:Bc,compareText:a3,count:rpe,deepEqual:wx,divideScalar:vn,dotDivide:Kd,equalText:npe,floor:s3,gcd:ipe,hasNumericValue:ape,hypot:spe,larger:ji,log:_x,lsolve:u3,matrixFromColumns:Ax,max:Ex,min:ope,mod:l3,nthRoots:upe,or:lpe,partitionSelect:bg,qr:Sx,rightLogShift:cpe,smallerEq:oh,subset:Na,subtract:Ln,trace:fpe,usolve:Dx,catalan:hpe,compareNatural:Do,composition:dpe,diff:ppe,distance:mpe,dot:xg,index:f3,invmod:vpe,lcm:gpe,log1p:ype,lsolveAll:bpe,matrixFromRows:xpe,multiply:Vr,range:uh,row:wpe,setCartesian:_pe,setDistinct:Ape,setIsSubset:Epe,setPowerset:Spe,slu:h3,sort:Dpe,unaryPlus:Cx,usolveAll:d3,zpk2tf:Cpe,and:Tpe,ceil:Tx,column:p3,cross:Npe,det:m3,fix:v3,inv:Rc,pinv:Mpe,pow:Vs,setDifference:g3,setMultiplicity:Ipe,setSymDifference:y3,sqrtm:Fpe,sum:Nx,vacuumImpedance:Ope,wienDisplacement:Bpe,atomicMass:Rpe,bohrMagneton:Ppe,boltzmann:$pe,conductanceQuantum:kpe,coulomb:Lpe,createUnit:Upe,deuteronMass:zpe,dotPow:Gpe,electricConstant:qpe,elementaryCharge:Hpe,expm:Wpe,faraday:Vpe,fft:x3,gamma:Mx,gravitationConstant:Xpe,hartreeEnergy:jpe,ifft:Ype,inverseConductanceQuantum:Kpe,klitzing:Zpe,loschmidt:Qpe,magneticConstant:Jpe,molarMass:eme,molarPlanckConstant:tme,neutronMass:rme,nuclearMagneton:nme,planckCharge:ime,planckLength:ame,planckTemperature:sme,protonMass:ome,quantumOfCirculation:ume,reducedPlanckConstant:lme,rydberg:cme,secondRadiation:fme,setSize:hme,speedOfLight:dme,stefanBoltzmann:pme,thomsonCrossSection:mme,avogadro:vme,bohrRadius:gme,coulombConstant:yme,divide:wi,electronMass:bme,factorial:Zd,firstRadiation:xme,gravity:wme,intersect:_me,lup:w3,magneticFluxQuantum:Ame,molarMassC12:Eme,multinomial:Sme,parse:Xs,permutations:Dme,planckMass:Cme,polynomialRoot:Tme,resolve:k3,setIntersect:_3,simplifyConstant:Bx,solveODE:Nme,stirlingS2:A3,unit:Mme,bellNumbers:Ime,compile:Zme,cumsum:Fme,eigs:E3,fermiCoupling:Ome,gasConstant:Bme,kldivergence:Rme,lusolve:S3,mean:D3,molarVolume:Pme,planckConstant:$me,quantileSeq:kme,setUnion:Lme,simplifyCore:Rx,variance:Ix,classicalElectronRadius:Ume,evaluate:wg,median:C3,simplify:_g,symbolicEqual:Qme,corr:zme,freqz:Gme,leafCount:Jme,mad:qme,parser:eve,rationalize:tve,std:Hme,zeta:Wme,derivative:rve,norm:Fx,rotationMatrix:T3,help:nve,planckTime:Vme,schur:N3,rotate:Xme,sylvester:M3,lyap:jme,config:Ze});Zn(Qd,Th,{mapSlices:pfe({isInteger:pa,typed:pe}),filter:_fe({typed:pe}),forEach:Sfe({typed:pe}),map:Ife({typed:pe}),or:_he({DenseMatrix:cr,concat:Rr,equalScalar:xr,matrix:pt,typed:pe}),and:bhe({add:Cr,concat:Rr,equalScalar:xr,matrix:pt,not:Ov,typed:pe,zeros:bi}),concat:ehe({isInteger:pa,matrix:pt,typed:pe}),index:Tfe({Index:Oi,getMatrixDataType:mx}),print:vhe({add:Cr,matrix:pt,typed:pe,zeros:bi}),sum:ohe({add:Cr,config:Ze,numeric:ns,typed:pe}),bitAnd:She({add:Cr,concat:Rr,equalScalar:xr,matrix:pt,not:Ov,typed:pe,zeros:bi}),min:Gfe({config:Ze,isNaN:mu,numeric:ns,smaller:Xi,typed:pe}),subset:Zfe({add:Cr,matrix:pt,typed:pe,zeros:bi}),bitOr:The({DenseMatrix:cr,concat:Rr,equalScalar:xr,matrix:pt,typed:pe}),cumsum:hhe({add:Cr,typed:pe,unaryPlus:Cx}),diff:rhe({bignumber:ma,matrix:pt,number:wu,subtract:Ln,typed:pe}),max:Pfe({config:Ze,isNaN:mu,larger:ji,numeric:ns,typed:pe}),range:Wfe({bignumber:ma,matrix:pt,add:Cr,config:Ze,isPositive:Ic,larger:ji,largerEq:yg,smaller:Xi,smallerEq:oh,typed:pe}),row:jfe({Index:Oi,matrix:pt,range:uh,typed:pe}),column:gfe({Index:Oi,matrix:pt,range:uh,typed:pe}),mean:Lfe({add:Cr,divide:wi,typed:pe}),quantileSeq:che({add:Cr,bignumber:ma,compare:Bc,divide:wi,isInteger:pa,larger:ji,mapSlices:Bd,multiply:Vr,partitionSelect:bg,smaller:Xi,smallerEq:oh,subtract:Ln,typed:pe}),variance:phe({add:Cr,divide:wi,isNaN:mu,mapSlices:Bd,multiply:Vr,subtract:Ln,typed:pe}),std:ahe({map:Fc,sqrt:Ws,typed:pe,variance:Ix})});Zn(I3,{BigNumber:mt,Complex:nn,Fraction:Nc,Matrix:pg,Node:$i,ObjectNode:Nh,OperatorNode:_u,ParenthesisNode:Pc,Range:$he,RelationalNode:F3,ResultSet:jF,ArrayNode:Mh,BlockNode:O3,ConditionalNode:B3,ConstantNode:Sl,DenseMatrix:cr,RangeNode:R3,Chain:Ox,FunctionAssignmentNode:P3,SparseMatrix:ti,ImmutableDenseMatrix:o3,Index:Oi,AccessorNode:Ih,AssignmentNode:$3,FibonacciHeap:c3,IndexNode:Fh,Spa:b3,Unit:jt,SymbolNode:Dl,FunctionNode:Cl,Help:L3,Parser:U3});Ox.createProxy(Th);/**
 * @dice-roller/rpg-dice-roller - An advanced JS based dice roller that can roll various types of dice and modifiers, along with mathematical equations.
 * 
 * @version 5.5.1
 * @license MIT
 * @author GreenImp Media <info@greenimp.co.uk> (https://greenimp.co.uk)
 * @link https://dice-roller.github.io/documentation
 */class Px extends TypeError{constructor(e){super(`Operator "${e}" is invalid`),TypeError.captureStackTrace&&TypeError.captureStackTrace(this,Px),this.name="CompareOperatorError",this.operator=e}}class $x extends Error{constructor(e){super(`Invalid data format: ${e}`),Error.captureStackTrace&&Error.captureStackTrace(this,$x),this.name="ImportError",this.data=e}}class Jd extends Error{constructor(e,r=null){super(`Die "${e}" must have more than 1 possible value to ${r||"do this action"}`),Error.captureStackTrace&&Error.captureStackTrace(this,Jd),this.name="DieActionValueError",this.action=r,this.die=e}}class Bv extends Error{constructor(e){super(`Notation "${e}" is invalid`),Error.captureStackTrace&&Error.captureStackTrace(this,Bv),this.name="NotationError",this.notation=e}}class yo extends Error{constructor(e=null){super(`Missing argument${e?` "${e}"`:""}`),Error.captureStackTrace&&Error.captureStackTrace(this,yo),this.argumentName=e}}const ive=(t,e,r)=>{const n=Number(t),i=Number(e);let a;if(Number.isNaN(n)||Number.isNaN(i))return!1;switch(r){case"=":case"==":a=n===i;break;case"<":a=n<i;break;case">":a=n>i;break;case"<=":a=n<=i;break;case">=":a=n>=i;break;case"!":case"!=":case"<>":a=n!==i;break;default:a=!1;break}return a},z3=t=>wg(t),Sn=t=>typeof t!="number"&&typeof t!="string"?!1:!Number.isNaN(t)&&Number.isFinite(Number(t)),dy=t=>{if(!Sn(t))return!1;const e=Number(t);return e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER},ave=t=>Array.isArray(t)?t.reduce((e,r)=>e+(Sn(r)?parseFloat(`${r}`):0),0):0,sve=(t,e=0)=>parseFloat(parseFloat(`${t}`).toFixed(e||0)),Yn=9007199254740992,sd=Yn-1,Rv=-1>>>0,ls=Rv+1,vu=ls/2,py=vu-1,ep=1<<21,Ac=ep-1;function kx(t){return t.next()|0}function Xu(t,e){return e===0?t:r=>t(r)+e}function ib(t){const e=t.next()|0,r=t.next()>>>0;return(e&Ac)*ls+r+(e&ep?-Yn:0)}function G3(t){for(;;){const e=t.next()|0;if(e&4194304){if((e&8388607)===4194304&&!(t.next()|0))return Yn}else{const r=t.next()>>>0;return(e&Ac)*ls+r+(e&ep?-Yn:0)}}}function q3(t){return t.next()>>>0}function Ag(t){const e=t.next()&Ac,r=t.next()>>>0;return e*ls+r}function Lx(t){for(;;){const e=t.next()|0;if(e&ep){if(!(e&Ac)&&!(t.next()|0))return Yn}else{const r=t.next()>>>0;return(e&Ac)*ls+r}}}function H3(t){return(t+1&t)===0}function ove(t){return e=>e.next()&t}function uve(t){const e=t+1,r=e*Math.floor(ls/e);return n=>{let i=0;do i=n.next()>>>0;while(i>=r);return i%e}}function lve(t){return H3(t)?ove(t):uve(t)}function cve(t){return(t|0)===0}function fve(t){return e=>{const r=e.next()&t,n=e.next()>>>0;return r*ls+n}}function hve(t){const e=t*Math.floor(Yn/t);return r=>{let n=0;do{const i=r.next()&Ac,a=r.next()>>>0;n=i*ls+a}while(n>=e);return n%t}}function dve(t){const e=t+1;if(cve(e)){const r=(e/ls|0)-1;if(H3(r))return fve(r)}return hve(e)}function JT(t,e){return r=>{let n=0;do{const i=r.next()|0,a=r.next()>>>0;n=(i&Ac)*ls+a+(i&ep?-Yn:0)}while(n<t||n>e);return n}}function $c(t,e){if(t=Math.floor(t),e=Math.floor(e),t<-Yn||!isFinite(t))throw new RangeError(`Expected min to be at least ${-Yn}`);if(e>Yn||!isFinite(e))throw new RangeError(`Expected max to be at most ${Yn}`);const r=e-t;return r<=0||!isFinite(r)?()=>t:r===Rv?t===0?q3:Xu(kx,t+vu):r<Rv?Xu(lve(r),t):r===sd?Xu(Ag,t):r<sd?Xu(dve(r),t):e-1-t===sd?Xu(Lx,t):t===-Yn&&e===Yn?G3:t===-Yn&&e===sd?ib:t===-sd&&e===Yn?Xu(ib,1):e===Yn?Xu(JT(t-1,e-1),1):JT(t,e)}function pve(t){return(t.next()&1)===1}function ab(t,e){return r=>t(r)<e}function mve(t){if(t<=0)return()=>!1;if(t>=1)return()=>!0;{const e=t*ls;return e%1===0?ab(kx,e-vu|0):ab(Ag,Math.round(t*Yn))}}function vve(t,e){return e==null?t==null?pve:mve(t):t<=0?()=>!1:t>=e?()=>!0:ab($c(0,e-1),t)}function gve(t,e){const r=$c(+t,+e);return n=>new Date(r(n))}function W3(t){return $c(1,t)}function yve(t,e){const r=W3(t);return n=>{const i=[];for(let a=0;a<e;++a)i.push(r(n));return i}}const bve="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-";function Ux(t=bve){const e=t.length;if(!e)throw new Error("Expected pool not to be an empty string");const r=$c(0,e-1);return(n,i)=>{let a="";for(let s=0;s<i;++s){const o=r(n);a+=t.charAt(o)}return a}}const V3="0123456789abcdef",xve=Ux(V3),wve=Ux(V3.toUpperCase());function _ve(t){return t?wve:xve}function e2(t,e){return t<0?Math.max(t+e,0):Math.min(t,e)}function t2(t){const e=+t;return e<0?Math.ceil(e):Math.floor(e)}function Ave(t,e,r,n){const i=e.length;if(i===0)throw new RangeError("Cannot pick from an empty array");const a=r==null?0:e2(t2(r),i),s=n===void 0?i:e2(t2(n),i);if(a>=s)throw new RangeError(`Cannot pick between bounds ${a} and ${s}`);const o=$c(a,s-1);return e[o(t)]}function Eve(t,e){return e===1?t:e===0?()=>0:r=>t(r)*e}function X3(t){return Ag(t)/Yn}function j3(t){return Lx(t)/Yn}function Sve(t,e,r=!1){if(isFinite(t)){if(!isFinite(e))throw new RangeError("Expected max to be a finite number")}else throw new RangeError("Expected min to be a finite number");return Xu(Eve(r?j3:X3,e-t),t)}const Dve=Array.prototype.slice;function sb(t,e,r=0){const n=e.length;if(n)for(let i=n-1>>>0;i>r;--i){const s=$c(0,i)(t);if(i!==s){const o=e[i];e[i]=e[s],e[s]=o}}return e}function Cve(t,e,r){if(r<0||r>e.length||!isFinite(r))throw new RangeError("Expected sampleSize to be within 0 and the length of the population");if(r===0)return[];const n=Dve.call(e),i=n.length;if(i===r)return sb(t,n,0);const a=i-r;return sb(t,n,a-1).slice(a)}const Tve=(()=>{try{if("x".repeat(3)==="xxx")return(t,e)=>t.repeat(e)}catch{}return(t,e)=>{let r="";for(;e>0;)e&1&&(r+=t),e>>=1,t+=t;return r}})();function yf(t,e){return Tve("0",e-t.length)+t}function Nve(t){const e=t.next()>>>0,r=t.next()|0,n=t.next()|0,i=t.next()>>>0;return yf(e.toString(16),8)+"-"+yf((r&65535).toString(16),4)+"-"+yf((r>>4&4095|16384).toString(16),4)+"-"+yf((n&16383|32768).toString(16),4)+"-"+yf((n>>4&65535).toString(16),4)+yf(i.toString(16),8)}const Wf={next(){return Math.random()*ls|0}};class Mve{constructor(e=Wf){this.engine=e}int32(){return kx(this.engine)}uint32(){return q3(this.engine)}uint53(){return Ag(this.engine)}uint53Full(){return Lx(this.engine)}int53(){return ib(this.engine)}int53Full(){return G3(this.engine)}integer(e,r){return $c(e,r)(this.engine)}realZeroToOneInclusive(){return j3(this.engine)}realZeroToOneExclusive(){return X3(this.engine)}real(e,r,n=!1){return Sve(e,r,n)(this.engine)}bool(e,r){return vve(e,r)(this.engine)}pick(e,r,n){return Ave(this.engine,e,r,n)}shuffle(e){return sb(this.engine,e)}sample(e,r){return Cve(this.engine,e,r)}die(e){return W3(e)(this.engine)}dice(e,r){return yve(e,r)(this.engine)}uuid4(){return Nve(this.engine)}string(e,r){return Ux(r)(this.engine,e)}hex(e,r){return _ve(r)(this.engine,e)}date(e,r){return gve(e,r)(this.engine)}}const Y3=(()=>{try{const t=new ArrayBuffer(4),e=new Int32Array(t);if(e[0]=vu,e[0]===-vu)return Int32Array}catch{}return Array})();let wm=null;const ob=128;let my=ob;const Ive={next(){return my>=ob&&(wm===null&&(wm=new Y3(ob)),crypto.getRandomValues(wm),my=0),wm[my++]|0}};function Fve(t=Wf,e=16){const r=[];r.push(new Date().getTime()|0);for(let n=1;n<e;++n)r[n]=t.next()|0;return r}const ub=(()=>{try{if(Math.imul(Rv,5)===-5)return Math.imul}catch{}const t=65535;return(e,r)=>{const n=e>>>16&t,i=e&t,a=r>>>16&t,s=r&t;return i*s+(n*s+i*a<<16>>>0)|0}})(),co=624,Ju=co-1,lb=397,r2=co-lb,vy=2567483615;class wd{constructor(){this.data=new Y3(co),this.index=0,this.uses=0}static seed(e){return new wd().seed(e)}static seedWithArray(e){return new wd().seedWithArray(e)}static autoSeed(){return wd.seedWithArray(Fve())}next(){(this.index|0)>=co&&(gy(this.data),this.index=0);const e=this.data[this.index];return this.index=this.index+1|0,this.uses+=1,Ove(e)|0}getUseCount(){return this.uses}discard(e){if(e<=0)return this;for(this.uses+=e,(this.index|0)>=co&&(gy(this.data),this.index=0);e+this.index>co;)e-=co-this.index,gy(this.data),this.index=0;return this.index=this.index+e|0,this}seed(e){let r=0;this.data[0]=r=e|0;for(let n=1;n<co;n=n+1|0)this.data[n]=r=ub(r^r>>>30,1812433253)+n|0;return this.index=co,this.uses=0,this}seedWithArray(e){return this.seed(19650218),Bve(this.data,e),this}}function gy(t){let e=0,r=0;for(;(e|0)<r2;e=e+1|0)r=t[e]&vu|t[e+1|0]&py,t[e]=t[e+lb|0]^r>>>1^(r&1?vy:0);for(;(e|0)<Ju;e=e+1|0)r=t[e]&vu|t[e+1|0]&py,t[e]=t[e-r2|0]^r>>>1^(r&1?vy:0);r=t[Ju]&vu|t[0]&py,t[Ju]=t[lb-1]^r>>>1^(r&1?vy:0)}function Ove(t){return t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,t^t>>>18}function Bve(t,e){let r=1,n=0;const i=e.length;let a=Math.max(i,co)|0,s=t[0]|0;for(;(a|0)>0;--a)t[r]=s=(t[r]^ub(s^s>>>30,1664525))+(e[n]|0)+(n|0)|0,r=r+1|0,++n,(r|0)>Ju&&(t[0]=t[Ju],r=1),n>=i&&(n=0);for(a=Ju;(a|0)>0;--a)t[r]=s=(t[r]^ub(s^s>>>30,1566083941))-r|0,r=r+1|0,(r|0)>Ju&&(t[0]=t[Ju],r=1);t[0]=vu}let n2=null;const cb=128;let yy=cb;const Rve={next(){return yy>=cb&&(n2=new Int32Array(new Int8Array(require("crypto").randomBytes(4*cb)).buffer),yy=0),n2[yy++]|0}},od=Symbol("engine"),by=Symbol("random"),Pve={range:[],next(){return this.range[1]-this.range[0]}},$ve={next(){return 0}},i2={browserCrypto:Ive,nodeCrypto:Rve,MersenneTwister19937:wd,nativeMath:Wf,min:$ve,max:Pve};class kve{constructor(e=Wf){this.engine=e||Wf}get engine(){return this[od]}set engine(e){if(e&&typeof e.next!="function")throw new TypeError("engine must have function `next()`");this[od]=e||Wf,this[by]=new Mve(this[od])}integer(e,r){return this[od].range=[e,r],this[by].integer(e,r)}real(e,r,n=!1){return this[od].range=[e,r],this[by].real(e,r,n)}}const Vf=new kve,a2=Symbol("text"),s2=Symbol("type");class Is{constructor(e,r=this.constructor.types.INLINE){this.text=e,this.type=r}get text(){return this[a2]}set text(e){if(typeof e=="object")throw new TypeError("Description text is invalid");if(!e&&e!==0||`${e}`.trim()==="")throw new TypeError("Description text cannot be empty");this[a2]=`${e}`.trim()}get type(){return this[s2]}set type(e){const r=Object.values(this.constructor.types);if(typeof e!="string")throw new TypeError("Description type must be a string");if(!r.includes(e))throw new RangeError(`Description type must be one of; ${r.join(", ")}`);this[s2]=e}toJSON(){const{text:e,type:r}=this;return{text:e,type:r}}toString(){return this.type===this.constructor.types.INLINE?`# ${this.text}`:`[${this.text}]`}}_r(Is,"types",{MULTILINE:"multiline",INLINE:"inline"});const _m=Symbol("description");class K3{constructor(e=null){this.description=e}get description(){return this[_m]||null}set description(e){if(!e&&e!==0)this[_m]=null;else if(e instanceof Is)this[_m]=e;else if(typeof e=="string")this[_m]=new Is(e);else throw new TypeError(`description must be of type Description, string or null. Received ${typeof e}`)}toJSON(){const{description:e}=this;return{description:e}}toString(){return this.description?`${this.description}`:""}}class Au{constructor(){this.order=this.constructor.order}get name(){return"modifier"}get notation(){return""}get maxIterations(){return 1e3}defaults(e){return{}}useDefaultsIfNeeded(e){Object.entries(this.defaults(e)).forEach(([r,n])=>{typeof this[r]>"u"&&(this[r]=n)})}run(e,r){return this.useDefaultsIfNeeded(r),e}toJSON(){const{notation:e,name:r}=this;return{name:r,notation:e,type:"modifier"}}toString(){return this.notation}}_r(Au,"order",999);const Lve={compound:"!",explode:"!","critical-failure":"__","critical-success":"**",drop:"d",max:"v",min:"^",penetrate:"p","re-roll":"r","re-roll-once":"ro","target-failure":"_","target-success":"*",unique:"u","unique-once":"uo"},Z3=(...t)=>[...t].reduce((e,r)=>{let n;return r instanceof Au?n=r.name:n=r,e+(Lve[n]||n)},""),xy=Symbol("calculation-value"),wy=Symbol("modifiers"),ud=Symbol("initial-value"),o2=Symbol("use-in-total"),_y=Symbol("value");class Pv{constructor(e,r=[],n=!0){if(Sn(e))this[ud]=Number(e),this.modifiers=r||[],this.useInTotal=n;else if(e&&typeof e=="object"&&!Array.isArray(e)){const i=Sn(e.initialValue)?e.initialValue:e.value;if(!Sn(i))throw new TypeError(`Result value is invalid: ${i}`);this[ud]=Number(i),Sn(e.value)&&Number(e.value)!==this[ud]&&(this.value=e.value),Sn(e.calculationValue)&&parseFloat(`${e.calculationValue}`)!==this.value&&(this.calculationValue=e.calculationValue),this.modifiers=e.modifiers||r||[],this.useInTotal=typeof e.useInTotal=="boolean"?e.useInTotal:n||!1}else throw e===1/0?new RangeError("Result value must be a finite number"):new TypeError(`Result value is invalid: ${e}`)}get calculationValue(){return Sn(this[xy])?parseFloat(this[xy]):this.value}set calculationValue(e){const r=Sn(e);if(e===1/0)throw new RangeError("Result calculation value must be a finite number");if(e&&!r)throw new TypeError(`Result calculation value is invalid: ${e}`);this[xy]=r?parseFloat(`${e}`):null}get initialValue(){return this[ud]}get modifierFlags(){return Z3(...this.modifiers)}get modifiers(){return this[wy]}set modifiers(e){if((Array.isArray(e)||e instanceof Set)&&[...e].every(r=>typeof r=="string")){this[wy]=new Set([...e]);return}if(!e&&e!==0){this[wy]=new Set;return}throw new TypeError(`modifiers must be a Set or array of modifier names: ${e}`)}get useInTotal(){return!!this[o2]}set useInTotal(e){this[o2]=!!e}get value(){return Sn(this[_y])?this[_y]:this[ud]}set value(e){if(e===1/0)throw new RangeError("Result value must be a finite number");if(!Sn(e))throw new TypeError(`Result value is invalid: ${e}`);this[_y]=Number(e)}toJSON(){const{calculationValue:e,initialValue:r,modifierFlags:n,modifiers:i,useInTotal:a,value:s}=this;return{calculationValue:e,initialValue:r,modifierFlags:n,modifiers:[...i],type:"result",useInTotal:a,value:s}}toString(){return this.value+this.modifierFlags}}const Ay=Symbol("rolls");class fu{constructor(e=[]){this.rolls=e}get length(){return this.rolls.length||0}get rolls(){return[...this[Ay]]}set rolls(e){if(!e||!Array.isArray(e))throw new TypeError(`rolls must be an array: ${e}`);this[Ay]=[],e.forEach(r=>{this.addRoll(r)})}get value(){return this.rolls.reduce((e,r)=>e+(r.useInTotal?r.calculationValue:0),0)}addRoll(e){const r=e instanceof Pv?e:new Pv(e);this[Ay].push(r)}toJSON(){const{rolls:e,value:r}=this;return{rolls:e,type:"roll-results",value:r}}toString(){return`[${this.rolls.join(", ")}]`}}const Ey=Symbol("modifiers"),u2=Symbol("qty"),l2=Symbol("sides"),c2=Symbol("min-value"),f2=Symbol("max-value");class lh extends K3{constructor(e,r=1,n=null,i=1,a=null,s=null){if(super(s),!e&&e!==0)throw new yo("sides");if(e===1/0)throw new RangeError("numerical sides must be finite number");if(Sn(e)){if(e<1||!dy(e))throw new RangeError("numerical sides must be a positive finite number")}else if(typeof e!="string")throw new TypeError("non-numerical sides must be a string");if(Sn(r)){if(r<1||r>999)throw new RangeError("qty must be between 1 and 999")}else throw new TypeError("qty must be a positive finite integer");let o=i;if(o==null)o=1;else if(Sn(o)){if(!dy(o))throw new RangeError("min must a finite number")}else throw new TypeError("min must a finite number");if(a&&!Sn(a))throw new TypeError("max must a finite number");if(a&&!dy(a))throw new RangeError("max must a finite number");this[u2]=parseInt(`${r}`,10),this[l2]=e,n&&(this.modifiers=n),this[c2]=parseInt(o,10),this[f2]=a?parseInt(`${a}`,10):e}get average(){return(this.min+this.max)/2}get modifiers(){return this[Ey]?new Map([...this[Ey]].sort((e,r)=>e[1].order-r[1].order)):null}set modifiers(e){let r;if(e instanceof Map)r=e;else if(Array.isArray(e))r=new Map(e.map(n=>[n.name,n]));else if(typeof e=="object")r=new Map(Object.entries(e));else throw new TypeError("modifiers should be a Map, array, or an Object containing Modifiers");if(r.size&&[...r.entries()].some(n=>!(n[1]instanceof Au)))throw new TypeError("modifiers must only contain Modifier instances");this[Ey]=r}get max(){return this[f2]}get min(){return this[c2]}get name(){return"standard"}get notation(){let e=`${this.qty}d${this.sides}`;return this.modifiers&&this.modifiers.size&&(e+=[...this.modifiers.values()].reduce((r,n)=>r+n.notation,"")),e}get qty(){return this[u2]}get sides(){return this[l2]}roll(){const e=new fu;for(let r=0;r<this.qty;r++)e.addRoll(this.rollOnce());return(this.modifiers||[]).forEach(r=>{r.run(e,this)}),e}rollOnce(){return new Pv(Vf.integer(this.min,this.max))}toJSON(){const{average:e,max:r,min:n,modifiers:i,name:a,notation:s,qty:o,sides:l}=this;return Object.assign(super.toJSON(),{average:e,max:r,min:n,modifiers:i,name:a,notation:s,qty:o,sides:l,type:"die"})}toString(){return`${this.notation}${this.description?` ${this.description}`:""}`}}class Uve extends lh{constructor(e=2,r=1,n=null,i=null){let a=e;if(!a&&a!==0)a=2;else if(a!==1&&a!==2)throw new RangeError("nonBlanks must be 1 or 2");super(a,r,n,-1,1,i)}get name(){return"fudge"}get nonBlanks(){return super.sides}get sides(){return`F.${this.nonBlanks}`}rollOnce(){let e=0;if(this.nonBlanks===2)e=Vf.integer(1,3)-2;else if(this.nonBlanks===1){const r=Vf.integer(1,6);r===1?e=-1:r===6&&(e=1)}return new Pv(e)}}class zve extends lh{constructor(e=1,r=null,n=!1,i=null){super(100,e,r,null,null,i),this.sidesAsNumber=!!n}get name(){return"percentile"}get sides(){return this.sidesAsNumber?super.sides:"%"}}const h2=Symbol("operator"),d2=Symbol("value");class $v{constructor(e,r){if(e){if(!r&&r!==0)throw new yo("value")}else throw new yo("operator");this.operator=e,this.value=r}static isValidOperator(e){return typeof e=="string"&&/^(?:[<>!]?=|[<>]|<>)$/.test(e)}set operator(e){if(!this.constructor.isValidOperator(e))throw new Px(e);this[h2]=e}get operator(){return this[h2]}set value(e){if(!Sn(e))throw new TypeError("value must be a finite number");this[d2]=Number(e)}get value(){return this[d2]}isMatch(e){return ive(e,this.value,this.operator)}toJSON(){const{operator:e,value:r}=this;return{operator:e,type:"compare-point",value:r}}toString(){return`${this.operator}${this.value}`}}const p2=Symbol("compare-point");class Oh extends Au{constructor(e){super(),e&&(this.comparePoint=e)}get comparePoint(){return this[p2]}set comparePoint(e){if(!(e instanceof $v))throw new TypeError("comparePoint must be instance of ComparePoint");this[p2]=e}get name(){return"comparison"}get notation(){return`${this.comparePoint||""}`}defaultComparePoint(e){return{}}defaults(e){const r=this.defaultComparePoint(e);return typeof r=="object"&&r.length===2?{comparePoint:new $v(...r)}:{}}isComparePoint(e){return this.comparePoint?this.comparePoint.isMatch(e):!1}toJSON(){const{comparePoint:e}=this;return Object.assign(super.toJSON(),{comparePoint:e})}}class Q3 extends Oh{constructor(e){super(e)}get name(){return"critical-failure"}get notation(){return`cf${super.notation}`}defaultComparePoint(e){return["=",e.min]}run(e,r){return super.run(e,r),e.rolls.forEach(n=>(this.isComparePoint(n.value)&&n.modifiers.add("critical-failure"),n)),e}}_r(Q3,"order",10);class J3 extends Oh{constructor(e){super(e)}get name(){return"critical-success"}get notation(){return`cs${super.notation}`}defaultComparePoint(e){return["=",e.max]}run(e,r){return super.run(e,r),e.rolls.forEach(n=>(this.isComparePoint(n.value)&&n.modifiers.add("critical-success"),n)),e}}_r(J3,"order",9);const Sy=Symbol("calculation-value"),m2=Symbol("is-roll-group"),Dy=Symbol("modifiers"),Cy=Symbol("results"),v2=Symbol("use-in-total");class vi{constructor(e=[],r=[],n=!1,i=!0){this.isRollGroup=n,this.modifiers=r,this.results=e,this.useInTotal=i}get calculationValue(){return Sn(this[Sy])?parseFloat(this[Sy]):this.value}set calculationValue(e){const r=Sn(e);if(e===1/0)throw new RangeError("Results calculation value must be a finite number");if(e&&!r)throw new TypeError(`Results calculation value is invalid: ${e}`);this[Sy]=r?parseFloat(`${e}`):null}get isRollGroup(){return this[m2]}set isRollGroup(e){this[m2]=!!e}get length(){return this.results.length||0}get modifierFlags(){return Z3(...this.modifiers)}get modifiers(){return this[Dy]}set modifiers(e){if((Array.isArray(e)||e instanceof Set)&&[...e].every(r=>typeof r=="string"))this[Dy]=new Set([...e]);else if(!e&&e!==0)this[Dy]=new Set;else throw new TypeError(`modifiers must be a Set or array of modifier names: ${e}`)}get results(){return[...this[Cy]]}set results(e){if(!e||!Array.isArray(e))throw new TypeError(`results must be an array: ${e}`);this[Cy]=[],e.forEach(r=>{this.addResult(r)})}get useInTotal(){return!!this[v2]}set useInTotal(e){this[v2]=!!e}get value(){if(!this.results.length)return 0;const e=this.results.reduce((r,n)=>{let i=n;return n instanceof vi?i=n.useInTotal?n.calculationValue:0:n instanceof fu&&(i=n.value),r+i},typeof this.results[0]=="string"?"":0);return typeof e=="string"?z3(e):e}addResult(e){let r;if(e instanceof vi||e instanceof fu)r=e;else if(typeof e=="string"||Sn(e))r=e;else throw new TypeError("value must be one of ResultGroup, RollResults, string, or number");this[Cy].push(r)}toJSON(){const{calculationValue:e,isRollGroup:r,modifierFlags:n,modifiers:i,results:a,useInTotal:s,value:o}=this;return{calculationValue:e,isRollGroup:r,modifierFlags:n,modifiers:[...i],results:a,type:"result-group",useInTotal:s,value:o}}toString(){let e;return this.isRollGroup?e=`{${this.results.join(", ")}}`:e=this.results.join(""),this.modifierFlags&&(e=`(${e})${this.modifierFlags}`),e}}const g2=Symbol("end"),y2=Symbol("qty");class zx extends Au{constructor(e="h",r=1){super(),this.end=e,this.qty=r}get end(){return this[g2]}set end(e){if(e!=="h"&&e!=="l")throw new RangeError('End must be "h" or "l"');this[g2]=e}get name(){return`keep-${this.end}`}get notation(){return`k${this.end}${this.qty}`}get qty(){return this[y2]}set qty(e){if(e===1/0)throw new RangeError("qty must be a finite number");if(!Sn(e)||e<1)throw new TypeError("qty must be a positive finite integer");this[y2]=Math.floor(e)}rangeToDrop(e){return this.end==="h"?[0,e.length-this.qty]:[this.qty,e.length]}run(e,r){let n,i;return e instanceof vi?(n=e.results,n.length===1&&n[0]instanceof vi?i=n[0].results.map((a,s)=>a instanceof fu?a.rolls.map((o,l)=>({value:o.value,index:[s,l]})):null).flat().filter(Boolean):i=[...n].map((a,s)=>({value:a.value,index:s}))):(n=e.rolls,i=[...n].map((a,s)=>({value:a.value,index:s}))),i=i.sort((a,s)=>a.value-s.value).map(a=>a.index).slice(...this.rangeToDrop(i)),i.forEach(a=>{let s;Array.isArray(a)?s=n[0].results[a[0]].rolls[a[1]]:s=n[a],s.modifiers.add("drop"),s.useInTotal=!1}),e}toJSON(){const{end:e,qty:r}=this;return Object.assign(super.toJSON(),{end:e,qty:r})}}_r(zx,"order",6);class eO extends zx{constructor(e="l",r=1){super(e,r)}get name(){return`drop-${this.end}`}get notation(){return`d${this.end}${this.qty}`}rangeToDrop(e){return this.end==="h"?[e.length-this.qty,e.length]:[0,this.qty]}}_r(eO,"order",7);const b2=Symbol("compound"),x2=Symbol("penetrate");class tO extends Oh{constructor(e=null,r=!1,n=!1){super(e),this[b2]=!!r,this[x2]=!!n}get compound(){return this[b2]}get name(){return"explode"}get notation(){return`!${this.compound?"!":""}${this.penetrate?"p":""}${super.notation}`}get penetrate(){return this[x2]}defaultComparePoint(e){return["=",e.max]}run(e,r){if(super.run(e,r),r.min===r.max)throw new Jd(r,"explode");const n=e;return n.rolls=e.rolls.map(i=>{const a=[i];let s=i.value;for(let o=0;o<this.maxIterations&&this.isComparePoint(s);o++){const l=a[a.length-1],u=r.rollOnce();s=u.value,l.modifiers.add("explode"),this.penetrate&&(l.modifiers.add("penetrate"),u.value-=1),a.push(u)}return this.compound&&a.length>1?(i.value=ave(a.map(o=>o.value)),i.modifiers=["explode","compound"],this.penetrate&&i.modifiers.add("penetrate"),i):a}).flat(),n}toJSON(){const{compound:e,penetrate:r}=this;return Object.assign(super.toJSON(),{compound:e,penetrate:r})}}_r(tO,"order",3);const w2=Symbol("max");class rO extends Au{constructor(e){super(),this.max=e}get max(){return this[w2]}set max(e){if(!Sn(e))throw new TypeError("max must be a number");this[w2]=parseFloat(`${e}`)}get name(){return"max"}get notation(){return`max${this.max}`}run(e,r){const n=e;return n.rolls=e.rolls.map(i=>{const a=i;return i.value>this.max&&(a.value=this.max,a.modifiers.add("max")),a}),n}toJSON(){const{max:e}=this;return Object.assign(super.toJSON(),{max:e})}}_r(rO,"order",2);const _2=Symbol("min");class nO extends Au{constructor(e){super(),this.min=e}get min(){return this[_2]}set min(e){if(!Sn(e))throw new TypeError("min must be a number");this[_2]=parseFloat(`${e}`)}get name(){return"min"}get notation(){return`min${this.min}`}run(e,r){const n=e;return n.rolls=e.rolls.map(i=>{const a=i;return i.value<this.min&&(a.value=this.min,a.modifiers.add("min")),a}),n}toJSON(){const{min:e}=this;return Object.assign(super.toJSON(),{min:e})}}_r(nO,"order",1);const A2=Symbol("once");class iO extends Oh{constructor(e=!1,r=null){super(r),this.once=!!e}get name(){return"re-roll"}get notation(){return`r${this.once?"o":""}${super.notation}`}get once(){return!!this[A2]}set once(e){this[A2]=!!e}defaultComparePoint(e){return["=",e.min]}run(e,r){if(super.run(e,r),r.min===r.max)throw new Jd(r,"re-roll");return e.rolls.map(n=>{for(let i=0;i<this.maxIterations&&this.isComparePoint(n.value);i++){const a=r.rollOnce();if(n.value=a.value,n.modifiers.add(`re-roll${this.once?"-once":""}`),this.once)break}return n}),e}toJSON(){const{once:e}=this;return Object.assign(super.toJSON(),{once:e})}}_r(iO,"order",4);const E2=Symbol("direction");class aO extends Au{constructor(e="a"){super(),this.direction=e}get direction(){return this[E2]}set direction(e){if(e!=="a"&&e!=="d")throw new RangeError('Direction must be "a" (Ascending) or "d" (Descending)');this[E2]=e}get name(){return"sorting"}get notation(){return`s${this.direction}`}run(e,r){let n;return e instanceof vi?n="results":n="rolls",e[n]=e[n].sort((i,a)=>this.direction==="d"?a.value-i.value:i.value-a.value),e instanceof vi&&(e[n]=e[n].map(i=>i instanceof vi||i instanceof fu?this.run(i,r):i)),e}toJSON(){const{direction:e}=this;return Object.assign(super.toJSON(),{direction:e})}}_r(aO,"order",11);const S2=Symbol("failure-cp");class sO extends Oh{constructor(e,r=null){super(e),this.failureComparePoint=r}get failureComparePoint(){return this[S2]}set failureComparePoint(e){if(e&&!(e instanceof $v))throw new TypeError("failure comparePoint must be instance of ComparePoint or null");this[S2]=e||null}get name(){return"target"}get notation(){return`${super.notation}${this.failureComparePoint?`f${this.failureComparePoint}`:""}`}get successComparePoint(){return this.comparePoint}set successComparePoint(e){super.comparePoint=e}getStateValue(e){return this.isSuccess(e)?1:this.isFailure(e)?-1:0}isFailure(e){return this.failureComparePoint?this.failureComparePoint.isMatch(e):!1}isNeutral(e){return!this.isSuccess(e)&&!this.isFailure(e)}isSuccess(e){return this.isComparePoint(e)}run(e,r){let n;return e instanceof vi?n=e.results:n=e.rolls,n.forEach(i=>{this.isSuccess(i.value)?i.modifiers.add("target-success"):this.isFailure(i.value)&&i.modifiers.add("target-failure"),i.calculationValue=this.getStateValue(i.value)}),e}toJSON(){const{failureComparePoint:e,successComparePoint:r}=this,n=super.toJSON();return delete n.comparePoint,Object.assign(n,{failureComparePoint:e,successComparePoint:r})}}_r(sO,"order",8);const D2=Symbol("once"),Gve=(t,e,r,n=!1)=>{const i=r.map(a=>a.value).indexOf(t.value);return n?i<e:i!==e};class oO extends Oh{constructor(e=!1,r=null){super(r),this.once=!!e}get name(){return"unique"}get notation(){return`u${this.once?"o":""}${super.notation}`}get once(){return!!this[D2]}set once(e){this[D2]=!!e}run(e,r){if(r.min===r.max)throw new Jd(r,"re-roll");return e.rolls.forEach((n,i,a)=>{if(i!==0)for(let s=0;s<this.maxIterations&&(!this.comparePoint||this.isComparePoint(n.value))&&Gve(n,i,a,!0);s++){const o=r.rollOnce();if(n.value=o.value,n.modifiers.add(`unique${this.once?"-once":""}`),this.once)break}}),e}toJSON(){const{once:e}=this;return Object.assign(super.toJSON(),{once:e})}}_r(oO,"order",5);const qve=t=>{try{return!!(t&&btoa(atob(t))===t)}catch{return!1}},Hve=t=>{try{const e=t?JSON.parse(t):!1;return!!(e&&typeof e=="object")}catch{return!1}},Ty=Symbol("expressions"),Ny=Symbol("modifiers");class uO extends K3{constructor(e=[],r=[],n=null){super(n),this.expressions=e,this.modifiers=r}get expressions(){return[...this[Ty]||[]]}set expressions(e){if(!e)throw new yo("expressions");if(!Array.isArray(e))throw new TypeError(`expressions must be an array: ${e}`);this[Ty]=[],e.forEach(r=>{if(!r||!Array.isArray(r))throw new TypeError(`Expressions must be an array of arrays: ${e}`);if(r.length===0)throw new TypeError(`Sub expressions cannot be empty: ${e}`);if(!r.every(n=>n instanceof lh||typeof n=="string"||typeof n=="number"))throw new TypeError("Sub expression items must be Dice, numbers, or strings");this[Ty].push(r)})}get modifiers(){return this[Ny]?new Map([...this[Ny]].sort((e,r)=>e[1].order-r[1].order)):null}set modifiers(e){let r;if(e instanceof Map)r=e;else if(Array.isArray(e))r=new Map(e.map(n=>[n.name,n]));else if(typeof e=="object")r=new Map(Object.entries(e));else throw new TypeError("modifiers should be a Map, array, or an Object containing Modifiers");if(r.size&&[...r.entries()].some(n=>!(n[1]instanceof Au)))throw new TypeError("modifiers must only contain Modifier instances");this[Ny]=r}get notation(){let e=this.expressions.map(r=>r.reduce((n,i)=>n+i,"")).join(", ");return e=`{${e}}`,this.modifiers&&this.modifiers.size&&(e+=[...this.modifiers.values()].reduce((r,n)=>r+n.notation,"")),e}roll(){const e=new vi(this.expressions.map(r=>{const n=r.map(i=>i instanceof lh?i.roll():i);return new vi(n)}));return e.isRollGroup=!0,(this.modifiers||[]).forEach(r=>{r.run(e,this)}),e}toJSON(){const{modifiers:e,notation:r,expressions:n}=this;return Object.assign(super.toJSON(),{expressions:n,modifiers:e,notation:r,type:"group"})}toString(){return`${this.notation}${this.description?` ${this.description}`:""}`}}function Wve(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r}function ch(t,e,r,n){var i=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(i,ch.prototype),i.expected=e,i.found=r,i.location=n,i.name="SyntaxError",i}Wve(ch,Error);function My(t,e,r){return r=r||" ",t.length>e?t:(e-=t.length,r+=r.repeat(e),t+r.slice(0,e))}ch.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var r=null,n;for(n=0;n<t.length;n++)if(t[n].source===this.location.source){r=t[n].text.split(/\r\n|\n|\r/g);break}var i=this.location.start,a=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(i):i,s=this.location.source+":"+a.line+":"+a.column;if(r){var o=this.location.end,l=My("",a.line.toString().length," "),u=r[i.line-1],c=i.line===o.line?o.column:u.length+1,f=c-i.column||1;e+=`
 --> `+s+`
`+l+` |
`+a.line+" | "+u+`
`+l+" | "+My("",i.column-1," ")+My("",f,"^")}else e+=`
 at `+s}return e};ch.buildMessage=function(t,e){var r={literal:function(u){return'"'+i(u.text)+'"'},class:function(u){var c=u.parts.map(function(f){return Array.isArray(f)?a(f[0])+"-"+a(f[1]):a(f)});return"["+(u.inverted?"^":"")+c.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(u){return u.description}};function n(u){return u.charCodeAt(0).toString(16).toUpperCase()}function i(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(c){return"\\x0"+n(c)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(c){return"\\x"+n(c)})}function a(u){return u.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(c){return"\\x0"+n(c)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(c){return"\\x"+n(c)})}function s(u){return r[u.type](u)}function o(u){var c=u.map(s),f,h;if(c.sort(),c.length>0){for(f=1,h=1;f<c.length;f++)c[f-1]!==c[f]&&(c[h]=c[f],h++);c.length=h}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}function l(u){return u?'"'+i(u)+'"':"end of input"}return"Expected "+o(t)+" but "+l(e)+" found."};function Vve(t,e){e=e!==void 0?e:{};var r={},n=e.grammarSource,i={Main:Nu},a=Nu,s="{",o=",",l="}",u="d",c="d%",f="dF",h=".",p="!",m="p",v="k",y="max",x="min",S="r",b="o",A="u",E="cs",_="cf",T="s",M="a",N="f",I="!=",F="<=",P=">=",U="=",G="<>",V=">",$="<",j="(",k=")",Z="abs",z="ceil",me="cos",fe="exp",ue="floor",le="log",ke="round",Me="sign",Se="sin",oe="sqrt",K="tan",de="pow",_e="-",be="**",$e="*",Oe="^",Qe="%",ae="/",ce="+",Ce="/*",Ue="*/",Ve="[",je="]",ht="//",re="#",we=/^[12]/,Ne=/^[lh]/,Ge=/^[.]/,He=/^[1-9]/,We=/^[0-9]/,ft=/^[^\]]/,st=/^[\n\r\u2028\u2029]/,dt=/^[ \t\n\r]/,at=Rt("{",!1),tr=Rt(",",!1),Ot=Rt("}",!1),fr=Rt("d",!1),R=Rt("d%",!1),ge=Rt("dF",!1),Le=Rt(".",!1),rt=Ci(["1","2"],!1,!1),Xe=Rt("!",!1),qt=Rt("p",!1),pn=Ci(["l","h"],!1,!1),fs=Rt("k",!1),Co=Rt("max",!1),js=Rt("min",!1),Tl=Rt("r",!1),To=Rt("o",!1),Ia=Rt("u",!1),Fa=Rt("cs",!1),No=Rt("cf",!1),Oa=Rt("s",!1),Xr=Rt("a",!1),fn=Rt("f",!1),Nl=Rt("!=",!1),Ys=Rt("<=",!1),Ks=Rt(">=",!1),Zs=Rt("=",!1),Ml=Rt("<>",!1),ea=Rt(">",!1),Ba=Rt("<",!1),hi=Rt("(",!1),ta=Rt(")",!1),Il=Rt("abs",!1),ra=Rt("ceil",!1),Eu=Rt("cos",!1),ga=Rt("exp",!1),Su=Rt("floor",!1),Mo=Rt("log",!1),jr=Rt("round",!1),di=Rt("sign",!1),ir=Rt("sin",!1),Tn=Rt("sqrt",!1),Ra=Rt("tan",!1),ya=Rt("pow",!1),ki=Rt("-",!1),Qs=Ci(["."],!1,!1),Pa=Ci([["1","9"]],!1,!1),Io=Ci([["0","9"]],!1,!1),Du=Rt("**",!1),kc=Rt("*",!1),Er=Rt("^",!1),Fl=Rt("%",!1),Ol=Rt("/",!1),Fo=Rt("+",!1),hs=Go("comment"),Lc=Rt("/*",!1),Oo=Rt("*/",!1),$a=Uo(),Hr=Rt("[",!1),Js=Ci(["]"],!0,!1),eo=Rt("]",!1),ds=Rt("//",!1),Bo=Rt("#",!1),Bl=Ci([`
`,"\r","\u2028","\u2029"],!1,!1),Ro=Go("whitespace"),Cu=Ci([" ","	",`
`,"\r"],!1,!1),to=Go("whitespace or comment"),ps=function(H,ve,Ie,ze){return new uO([H,...ve.map(tt=>tt[3])],Object.assign({},...Ie.map(tt=>({[tt.name]:tt}))),ze.find(tt=>tt instanceof Is))},Uc=function(H,ve,Ie){return H.modifiers=Object.assign({},...ve.map(ze=>({[ze.name]:ze}))),H.description=Ie.find(ze=>ze instanceof Is),H},Tr=function(H,ve){return new lh(ve,H||1)},zc=function(H){return new zve(H||1)},Gc=function(H,ve){return new Uve(ve?parseInt(ve[1],10):2,H||1)},qc=function(H,ve,Ie){return new tO(Ie,!!H,!!ve)},ri=function(H,ve){return new sO(H,ve)},ms=function(H,ve){return new eO(H||"l",ve)},Tu=function(H,ve){return new zx(H||"h",ve)},ka=function(H){return new rO(H)},Hc=function(H){return new nO(H)},Rl=function(H,ve){return new iO(!!H,ve)},_n=function(H,ve){return new oO(!!H,ve)},na=function(H){return new J3(H)},Po=function(H){return new Q3(H)},$o=function(H){return new aO(H||"a")},ko=function(H){return H},La=function(H,ve){return new $v(H,ve)},Bh=function(H,ve,Ie){return z3(Nn())},ia=function(H,ve){return H=Array.isArray(H)?H:[H],[...H,...ve.map(([,Ie,,ze])=>[Ie,ze]).flat(2)]},Pl=function(H,ve,Ie){return[H,...ve,Ie]},Wc=function(H,ve){return[`${H}(`,...ve,")"]},Wr=function(H,ve,Ie){return[`${H}(`,...ve,",",...Ie,")"]},Ur=function(){return parseFloat(Nn())},$l=function(){return parseInt(Nn(),10)},Vc=function(){return parseInt(Nn(),10)},Rh=function(){return"^"},Lo=function(H){return new Is(H.flat().join(""),Is.types.MULTILINE)},Ph=function(H){return new Is(H.flat().join(""),Is.types.MULTILINE)},$h=function(H){return new Is(H.flat().join(""),Is.types.INLINE)},te=0,Dr=0,hn=[{line:1,column:1}],Di=0,ba=[],ot=0,Ua;if("startRule"in e){if(!(e.startRule in i))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');a=i[e.startRule]}function Nn(){return t.substring(Dr,te)}function Rt(H,ve){return{type:"literal",text:H,ignoreCase:ve}}function Ci(H,ve,Ie){return{type:"class",parts:H,inverted:ve,ignoreCase:Ie}}function Uo(){return{type:"any"}}function zo(){return{type:"end"}}function Go(H){return{type:"other",description:H}}function kl(H){var ve=hn[H],Ie;if(ve)return ve;for(Ie=H-1;!hn[Ie];)Ie--;for(ve=hn[Ie],ve={line:ve.line,column:ve.column};Ie<H;)t.charCodeAt(Ie)===10?(ve.line++,ve.column=1):ve.column++,Ie++;return hn[H]=ve,ve}function gn(H,ve,Ie){var ze=kl(H),tt=kl(ve),Et={source:n,start:{offset:H,line:ze.line,column:ze.column},end:{offset:ve,line:tt.line,column:tt.column}};return Et}function ct(H){te<Di||(te>Di&&(Di=te,ba=[]),ba.push(H))}function ni(H,ve,Ie){return new ch(ch.buildMessage(H,ve),H,ve,Ie)}function Nu(){var H;return H=aa(),H}function Mu(){var H,ve,Ie,ze,tt,Et,mr,Gr,Mn;if(H=te,t.charCodeAt(te)===123?(ve=s,te++):(ve=r,ot===0&&ct(at)),ve!==r)if(an(),Ie=aa(),Ie!==r){for(ze=[],tt=te,Et=an(),t.charCodeAt(te)===44?(mr=o,te++):(mr=r,ot===0&&ct(tr)),mr!==r?(Gr=an(),Mn=aa(),Mn!==r?(Et=[Et,mr,Gr,Mn],tt=Et):(te=tt,tt=r)):(te=tt,tt=r);tt!==r;)ze.push(tt),tt=te,Et=an(),t.charCodeAt(te)===44?(mr=o,te++):(mr=r,ot===0&&ct(tr)),mr!==r?(Gr=an(),Mn=aa(),Mn!==r?(Et=[Et,mr,Gr,Mn],tt=Et):(te=tt,tt=r)):(te=tt,tt=r);if(tt=an(),t.charCodeAt(te)===125?(Et=l,te++):(Et=r,ot===0&&ct(Ot)),Et!==r){for(mr=[],Gr=ii();Gr!==r;)mr.push(Gr),Gr=ii();Gr=Kc(),Dr=H,H=ps(Ie,ze,mr,Gr)}else te=H,H=r}else te=H,H=r;else te=H,H=r;return H}function un(){var H,ve,Ie,ze;if(H=te,ve=za(),ve===r&&(ve=vs(),ve===r&&(ve=Qr())),ve!==r){for(Ie=[],ze=ii();ze!==r;)Ie.push(ze),ze=ii();ze=Kc(),Dr=H,H=Uc(ve,Ie,ze)}else te=H,H=r;return H}function za(){var H,ve,Ie,ze;return H=te,ve=bs(),ve===r&&(ve=null),t.charCodeAt(te)===100?(Ie=u,te++):(Ie=r,ot===0&&ct(fr)),Ie!==r?(ze=bs(),ze!==r?(Dr=H,H=Tr(ve,ze)):(te=H,H=r)):(te=H,H=r),H}function vs(){var H,ve,Ie;return H=te,ve=bs(),ve===r&&(ve=null),t.substr(te,2)===c?(Ie=c,te+=2):(Ie=r,ot===0&&ct(R)),Ie!==r?(Dr=H,H=zc(ve)):(te=H,H=r),H}function Qr(){var H,ve,Ie,ze,tt,Et;return H=te,ve=bs(),ve===r&&(ve=null),t.substr(te,2)===f?(Ie=f,te+=2):(Ie=r,ot===0&&ct(ge)),Ie!==r?(ze=te,t.charCodeAt(te)===46?(tt=h,te++):(tt=r,ot===0&&ct(Le)),tt!==r?(we.test(t.charAt(te))?(Et=t.charAt(te),te++):(Et=r,ot===0&&ct(rt)),Et!==r?(tt=[tt,Et],ze=tt):(te=ze,ze=r)):(te=ze,ze=r),ze===r&&(ze=null),Dr=H,H=Gc(ve,ze)):(te=H,H=r),H}function ii(){var H;return H=Iu(),H===r&&(H=Xc(),H===r&&(H=ro(),H===r&&(H=Ll(),H===r&&(H=Fu(),H===r&&(H=ys(),H===r&&(H=Ga(),H===r&&(H=jc(),H===r&&(H=Yc(),H===r&&(H=gs(),H===r&&(H=Ul())))))))))),H}function Iu(){var H,ve,Ie,ze,tt;return H=te,t.charCodeAt(te)===33?(ve=p,te++):(ve=r,ot===0&&ct(Xe)),ve!==r?(t.charCodeAt(te)===33?(Ie=p,te++):(Ie=r,ot===0&&ct(Xe)),Ie===r&&(Ie=null),t.charCodeAt(te)===112?(ze=m,te++):(ze=r,ot===0&&ct(qt)),ze===r&&(ze=null),tt=Ti(),tt===r&&(tt=null),Dr=H,H=qc(Ie,ze,tt)):(te=H,H=r),H}function Xc(){var H,ve,Ie;return H=te,ve=Ti(),ve!==r?(Ie=Ou(),Ie===r&&(Ie=null),Dr=H,H=ri(ve,Ie)):(te=H,H=r),H}function ro(){var H,ve,Ie,ze;return H=te,t.charCodeAt(te)===100?(ve=u,te++):(ve=r,ot===0&&ct(fr)),ve!==r?(Ne.test(t.charAt(te))?(Ie=t.charAt(te),te++):(Ie=r,ot===0&&ct(pn)),Ie===r&&(Ie=null),ze=Ho(),ze!==r?(Dr=H,H=ms(Ie,ze)):(te=H,H=r)):(te=H,H=r),H}function Ll(){var H,ve,Ie,ze;return H=te,t.charCodeAt(te)===107?(ve=v,te++):(ve=r,ot===0&&ct(fs)),ve!==r?(Ne.test(t.charAt(te))?(Ie=t.charAt(te),te++):(Ie=r,ot===0&&ct(pn)),Ie===r&&(Ie=null),ze=Ho(),ze!==r?(Dr=H,H=Tu(Ie,ze)):(te=H,H=r)):(te=H,H=r),H}function gs(){var H,ve,Ie;return H=te,t.substr(te,3)===y?(ve=y,te+=3):(ve=r,ot===0&&ct(Co)),ve!==r?(Ie=xs(),Ie!==r?(Dr=H,H=ka(Ie)):(te=H,H=r)):(te=H,H=r),H}function Ul(){var H,ve,Ie;return H=te,t.substr(te,3)===x?(ve=x,te+=3):(ve=r,ot===0&&ct(js)),ve!==r?(Ie=xs(),Ie!==r?(Dr=H,H=Hc(Ie)):(te=H,H=r)):(te=H,H=r),H}function Fu(){var H,ve,Ie,ze;return H=te,t.charCodeAt(te)===114?(ve=S,te++):(ve=r,ot===0&&ct(Tl)),ve!==r?(t.charCodeAt(te)===111?(Ie=b,te++):(Ie=r,ot===0&&ct(To)),Ie===r&&(Ie=null),ze=Ti(),ze===r&&(ze=null),Dr=H,H=Rl(Ie,ze)):(te=H,H=r),H}function ys(){var H,ve,Ie,ze;return H=te,t.charCodeAt(te)===117?(ve=A,te++):(ve=r,ot===0&&ct(Ia)),ve!==r?(t.charCodeAt(te)===111?(Ie=b,te++):(Ie=r,ot===0&&ct(To)),Ie===r&&(Ie=null),ze=Ti(),ze===r&&(ze=null),Dr=H,H=_n(Ie,ze)):(te=H,H=r),H}function Ga(){var H,ve,Ie;return H=te,t.substr(te,2)===E?(ve=E,te+=2):(ve=r,ot===0&&ct(Fa)),ve!==r?(Ie=Ti(),Ie===r&&(Ie=null),Dr=H,H=na(Ie)):(te=H,H=r),H}function jc(){var H,ve,Ie;return H=te,t.substr(te,2)===_?(ve=_,te+=2):(ve=r,ot===0&&ct(No)),ve!==r?(Ie=Ti(),Ie===r&&(Ie=null),Dr=H,H=Po(Ie)):(te=H,H=r),H}function Yc(){var H,ve,Ie;return H=te,t.charCodeAt(te)===115?(ve=T,te++):(ve=r,ot===0&&ct(Oa)),ve!==r?(t.charCodeAt(te)===97?(Ie=M,te++):(Ie=r,ot===0&&ct(Xr)),Ie===r&&(t.charCodeAt(te)===100?(Ie=u,te++):(Ie=r,ot===0&&ct(fr))),Ie===r&&(Ie=null),Dr=H,H=$o(Ie)):(te=H,H=r),H}function Ou(){var H,ve,Ie;return H=te,t.charCodeAt(te)===102?(ve=N,te++):(ve=r,ot===0&&ct(fn)),ve!==r?(Ie=Ti(),Ie!==r?(Dr=H,H=ko(Ie)):(te=H,H=r)):(te=H,H=r),H}function Ti(){var H,ve,Ie;return H=te,ve=zl(),ve!==r?(Ie=xs(),Ie!==r?(Dr=H,H=La(ve,Ie)):(te=H,H=r)):(te=H,H=r),H}function zl(){var H;return t.substr(te,2)===I?(H=I,te+=2):(H=r,ot===0&&ct(Nl)),H===r&&(t.substr(te,2)===F?(H=F,te+=2):(H=r,ot===0&&ct(Ys)),H===r&&(t.substr(te,2)===P?(H=P,te+=2):(H=r,ot===0&&ct(Ks)),H===r&&(t.charCodeAt(te)===61?(H=U,te++):(H=r,ot===0&&ct(Zs)),H===r&&(t.substr(te,2)===G?(H=G,te+=2):(H=r,ot===0&&ct(Ml)),H===r&&(t.charCodeAt(te)===62?(H=V,te++):(H=r,ot===0&&ct(ea)),H===r&&(t.charCodeAt(te)===60?(H=$,te++):(H=r,ot===0&&ct(Ba)))))))),H}function bs(){var H,ve,Ie,ze,tt,Et,mr,Gr,Mn,qa;if(H=Ho(),H===r)if(H=te,t.charCodeAt(te)===40?(ve=j,te++):(ve=r,ot===0&&ct(hi)),ve!==r){if(an(),Ie=te,ze=xs(),ze!==r){if(tt=[],Et=te,mr=an(),Gr=no(),Gr!==r?(Mn=an(),qa=xs(),qa!==r?(mr=[mr,Gr,Mn,qa],Et=mr):(te=Et,Et=r)):(te=Et,Et=r),Et!==r)for(;Et!==r;)tt.push(Et),Et=te,mr=an(),Gr=no(),Gr!==r?(Mn=an(),qa=xs(),qa!==r?(mr=[mr,Gr,Mn,qa],Et=mr):(te=Et,Et=r)):(te=Et,Et=r);else tt=r;tt!==r?(ze=[ze,tt],Ie=ze):(te=Ie,Ie=r)}else te=Ie,Ie=r;Ie!==r?(ze=an(),t.charCodeAt(te)===41?(tt=k,te++):(tt=r,ot===0&&ct(ta)),tt!==r?(Dr=H,H=Bh()):(te=H,H=r)):(te=H,H=r)}else te=H,H=r;return H}function aa(){var H,ve,Ie,ze,tt,Et,mr,Gr;if(H=te,ve=qo(),ve!==r){for(Ie=[],ze=te,tt=an(),Et=no(),Et!==r?(mr=an(),Gr=qo(),Gr!==r?(tt=[tt,Et,mr,Gr],ze=tt):(te=ze,ze=r)):(te=ze,ze=r);ze!==r;)Ie.push(ze),ze=te,tt=an(),Et=no(),Et!==r?(mr=an(),Gr=qo(),Gr!==r?(tt=[tt,Et,mr,Gr],ze=tt):(te=ze,ze=r)):(te=ze,ze=r);Dr=H,H=ia(ve,Ie)}else te=H,H=r;return H}function qo(){var H,ve,Ie,ze;return H=Bu(),H===r&&(H=un(),H===r&&(H=xs(),H===r&&(H=te,t.charCodeAt(te)===40?(ve=j,te++):(ve=r,ot===0&&ct(hi)),ve!==r?(an(),Ie=aa(),Ie!==r?(an(),t.charCodeAt(te)===41?(ze=k,te++):(ze=r,ot===0&&ct(ta)),ze!==r?(Dr=H,H=Pl(ve,Ie,ze)):(te=H,H=r)):(te=H,H=r)):(te=H,H=r),H===r&&(H=Mu())))),H}function Bu(){var H,ve,Ie,ze,tt,Et,mr;return H=te,t.substr(te,3)===Z?(ve=Z,te+=3):(ve=r,ot===0&&ct(Il)),ve===r&&(t.substr(te,4)===z?(ve=z,te+=4):(ve=r,ot===0&&ct(ra)),ve===r&&(t.substr(te,3)===me?(ve=me,te+=3):(ve=r,ot===0&&ct(Eu)),ve===r&&(t.substr(te,3)===fe?(ve=fe,te+=3):(ve=r,ot===0&&ct(ga)),ve===r&&(t.substr(te,5)===ue?(ve=ue,te+=5):(ve=r,ot===0&&ct(Su)),ve===r&&(t.substr(te,3)===le?(ve=le,te+=3):(ve=r,ot===0&&ct(Mo)),ve===r&&(t.substr(te,5)===ke?(ve=ke,te+=5):(ve=r,ot===0&&ct(jr)),ve===r&&(t.substr(te,4)===Me?(ve=Me,te+=4):(ve=r,ot===0&&ct(di)),ve===r&&(t.substr(te,3)===Se?(ve=Se,te+=3):(ve=r,ot===0&&ct(ir)),ve===r&&(t.substr(te,4)===oe?(ve=oe,te+=4):(ve=r,ot===0&&ct(Tn)),ve===r&&(t.substr(te,3)===K?(ve=K,te+=3):(ve=r,ot===0&&ct(Ra)))))))))))),ve!==r?(t.charCodeAt(te)===40?(Ie=j,te++):(Ie=r,ot===0&&ct(hi)),Ie!==r?(an(),ze=aa(),ze!==r?(an(),t.charCodeAt(te)===41?(tt=k,te++):(tt=r,ot===0&&ct(ta)),tt!==r?(Dr=H,H=Wc(ve,ze)):(te=H,H=r)):(te=H,H=r)):(te=H,H=r)):(te=H,H=r),H===r&&(H=te,t.substr(te,3)===de?(ve=de,te+=3):(ve=r,ot===0&&ct(ya)),ve===r&&(t.substr(te,3)===y?(ve=y,te+=3):(ve=r,ot===0&&ct(Co)),ve===r&&(t.substr(te,3)===x?(ve=x,te+=3):(ve=r,ot===0&&ct(js)))),ve!==r?(t.charCodeAt(te)===40?(Ie=j,te++):(Ie=r,ot===0&&ct(hi)),Ie!==r?(an(),ze=aa(),ze!==r?(an(),t.charCodeAt(te)===44?(tt=o,te++):(tt=r,ot===0&&ct(tr)),tt!==r?(an(),Et=aa(),Et!==r?(an(),t.charCodeAt(te)===41?(mr=k,te++):(mr=r,ot===0&&ct(ta)),mr!==r?(Dr=H,H=Wr(ve,ze,Et)):(te=H,H=r)):(te=H,H=r)):(te=H,H=r)):(te=H,H=r)):(te=H,H=r)):(te=H,H=r)),H}function xs(){var H,ve,Ie,ze,tt;return H=te,t.charCodeAt(te)===45?te++:ot===0&&ct(ki),ve=Hn(),ve!==r?(Ie=te,Ge.test(t.charAt(te))?(ze=t.charAt(te),te++):(ze=r,ot===0&&ct(Qs)),ze!==r?(tt=Hn(),tt!==r?(ze=[ze,tt],Ie=ze):(te=Ie,Ie=r)):(te=Ie,Ie=r),Ie===r&&(Ie=null),Dr=H,H=Ur()):(te=H,H=r),H}function Ho(){var H,ve,Ie,ze;if(H=te,He.test(t.charAt(te))?(ve=t.charAt(te),te++):(ve=r,ot===0&&ct(Pa)),ve!==r){for(Ie=[],We.test(t.charAt(te))?(ze=t.charAt(te),te++):(ze=r,ot===0&&ct(Io));ze!==r;)Ie.push(ze),We.test(t.charAt(te))?(ze=t.charAt(te),te++):(ze=r,ot===0&&ct(Io));Dr=H,H=$l()}else te=H,H=r;return H}function Hn(){var H,ve,Ie;if(H=te,ve=[],We.test(t.charAt(te))?(Ie=t.charAt(te),te++):(Ie=r,ot===0&&ct(Io)),Ie!==r)for(;Ie!==r;)ve.push(Ie),We.test(t.charAt(te))?(Ie=t.charAt(te),te++):(Ie=r,ot===0&&ct(Io));else ve=r;return ve!==r&&(Dr=H,ve=Vc()),H=ve,H}function no(){var H,ve;return H=te,t.substr(te,2)===be?(ve=be,te+=2):(ve=r,ot===0&&ct(Du)),ve!==r&&(Dr=H,ve=Rh()),H=ve,H===r&&(t.charCodeAt(te)===42?(H=$e,te++):(H=r,ot===0&&ct(kc)),H===r&&(t.charCodeAt(te)===94?(H=Oe,te++):(H=r,ot===0&&ct(Er)),H===r&&(t.charCodeAt(te)===37?(H=Qe,te++):(H=r,ot===0&&ct(Fl)),H===r&&(t.charCodeAt(te)===47?(H=ae,te++):(H=r,ot===0&&ct(Ol)),H===r&&(t.charCodeAt(te)===43?(H=ce,te++):(H=r,ot===0&&ct(Fo)),H===r&&(t.charCodeAt(te)===45?(H=_e,te++):(H=r,ot===0&&ct(ki)))))))),H}function ws(){var H;return ot++,H=Ru(),H===r&&(H=Gl()),ot--,H===r&&ot===0&&ct(hs),H}function Ru(){var H,ve,Ie,ze,tt,Et;if(H=te,t.substr(te,2)===Ce?(ve=Ce,te+=2):(ve=r,ot===0&&ct(Lc)),ve!==r){for(Ie=[],ze=te,tt=te,ot++,t.substr(te,2)===Ue?(Et=Ue,te+=2):(Et=r,ot===0&&ct(Oo)),ot--,Et===r?tt=void 0:(te=tt,tt=r),tt!==r?(t.length>te?(Et=t.charAt(te),te++):(Et=r,ot===0&&ct($a)),Et!==r?(tt=[tt,Et],ze=tt):(te=ze,ze=r)):(te=ze,ze=r);ze!==r;)Ie.push(ze),ze=te,tt=te,ot++,t.substr(te,2)===Ue?(Et=Ue,te+=2):(Et=r,ot===0&&ct(Oo)),ot--,Et===r?tt=void 0:(te=tt,tt=r),tt!==r?(t.length>te?(Et=t.charAt(te),te++):(Et=r,ot===0&&ct($a)),Et!==r?(tt=[tt,Et],ze=tt):(te=ze,ze=r)):(te=ze,ze=r);t.substr(te,2)===Ue?(ze=Ue,te+=2):(ze=r,ot===0&&ct(Oo)),ze!==r?(Dr=H,H=Lo(Ie)):(te=H,H=r)}else te=H,H=r;if(H===r)if(H=te,t.charCodeAt(te)===91?(ve=Ve,te++):(ve=r,ot===0&&ct(Hr)),ve!==r){for(Ie=[],ft.test(t.charAt(te))?(ze=t.charAt(te),te++):(ze=r,ot===0&&ct(Js));ze!==r;)Ie.push(ze),ft.test(t.charAt(te))?(ze=t.charAt(te),te++):(ze=r,ot===0&&ct(Js));t.charCodeAt(te)===93?(ze=je,te++):(ze=r,ot===0&&ct(eo)),ze!==r?(Dr=H,H=Ph(Ie)):(te=H,H=r)}else te=H,H=r;return H}function Gl(){var H,ve,Ie,ze,tt,Et;if(H=te,t.substr(te,2)===ht?(ve=ht,te+=2):(ve=r,ot===0&&ct(ds)),ve===r&&(t.charCodeAt(te)===35?(ve=re,te++):(ve=r,ot===0&&ct(Bo))),ve!==r){for(Ie=[],ze=te,tt=te,ot++,Et=ql(),ot--,Et===r?tt=void 0:(te=tt,tt=r),tt!==r?(t.length>te?(Et=t.charAt(te),te++):(Et=r,ot===0&&ct($a)),Et!==r?(tt=[tt,Et],ze=tt):(te=ze,ze=r)):(te=ze,ze=r);ze!==r;)Ie.push(ze),ze=te,tt=te,ot++,Et=ql(),ot--,Et===r?tt=void 0:(te=tt,tt=r),tt!==r?(t.length>te?(Et=t.charAt(te),te++):(Et=r,ot===0&&ct($a)),Et!==r?(tt=[tt,Et],ze=tt):(te=ze,ze=r)):(te=ze,ze=r);Dr=H,H=$h(Ie)}else te=H,H=r;return H}function ql(){var H;return st.test(t.charAt(te))?(H=t.charAt(te),te++):(H=r,ot===0&&ct(Bl)),H}function Pu(){var H;return ot++,dt.test(t.charAt(te))?(H=t.charAt(te),te++):(H=r,ot===0&&ct(Cu)),ot--,H===r&&ot===0&&ct(Ro),H}function an(){var H,ve;for(H=[],ve=Pu();ve!==r;)H.push(ve),ve=Pu();return H}function Kc(){var H,ve;for(ot++,H=[],ve=Pu(),ve===r&&(ve=ws());ve!==r;)H.push(ve),ve=Pu(),ve===r&&(ve=ws());return ot--,ve=r,ot===0&&ct(to),H}if(Ua=a(),Ua!==r&&te===t.length)return Ua;throw Ua!==r&&te<t.length&&ct(zo()),ni(ba,Di<t.length?t.charAt(Di):null,Di<t.length?gn(Di,Di+1):gn(Di,Di))}class C2{static parse(e){if(!e)throw new yo("notation");if(typeof e!="string")throw new TypeError("Notation must be a string");return Vve(e)}}const bf=Object.freeze({BASE_64:1,JSON:0,OBJECT:2}),Iy=Symbol("notation"),Fy=Symbol("maxTotal"),Oy=Symbol("minTotal"),xf=Symbol("expressions"),Am=Symbol("roll-method"),Hu=Symbol("rolls"),T2=Symbol("set-rolls"),Em=Symbol("total"),By=t=>sve(t.calculationValue,2);class bo{constructor(e){if(!e)throw new yo("notation");if(this[xf]=[],e instanceof Object&&!Array.isArray(e)){if(e.notation){if(typeof e.notation!="string")throw new Bv(e.notation);e.rolls&&this[T2](e.rolls)}else throw new yo("notation");this[Iy]=e.notation,this[xf]=C2.parse(this.notation),this.hasRolls()||this.roll()}else if(typeof e=="string")this[Iy]=e,this[xf]=C2.parse(this.notation),this.roll();else throw new Bv(e)}get averageTotal(){return(this.maxTotal+this.minTotal)/2}get maxTotal(){if(!this.hasExpressions())return 0;if(!this[Fy]){const e=this[Am](i2.max);this[Fy]=By(e)}return this[Fy]}get minTotal(){if(!this.hasExpressions())return 0;if(!this[Oy]){const e=this[Am](i2.min);this[Oy]=By(e)}return this[Oy]}get notation(){return this[Iy]}get output(){let e=`${this.notation}: `;return this.hasRolls()?e+=`${this[Hu]} = ${this.total}`:e+="No dice rolled",e}get rolls(){return this[Hu]?this[Hu].results:[]}get total(){return!this[Em]&&this.hasRolls()&&(this[Em]=By(this[Hu])),this[Em]||0}export(e=bf.JSON){switch(e){case bf.BASE_64:return btoa(this.export(bf.JSON));case bf.JSON:return JSON.stringify(this);case bf.OBJECT:return JSON.parse(this.export(bf.JSON));default:throw new TypeError(`Invalid export format "${e}"`)}}hasExpressions(){return this[xf]&&this[xf].length>0}hasRolls(){return this.hasExpressions()&&this.rolls.length>0}roll(){return this[Em]=0,this[Hu]=this[Am](),this.rolls}toJSON(){const{averageTotal:e,maxTotal:r,minTotal:n,notation:i,output:a,rolls:s,total:o}=this;return{averageTotal:e,maxTotal:r,minTotal:n,notation:i,output:a,rolls:s,total:o,type:"dice-roll"}}toString(){return this.output}static import(e){if(e){if(Hve(e))return bo.import(JSON.parse(e));if(qve(e))return bo.import(atob(e));if(typeof e=="object")return new bo(e);throw new $x(e)}else throw new yo("data")}[Am](e){let r;e&&(r=Vf.engine,Vf.engine=e);const n=new vi(this[xf].map(i=>i instanceof lh||i instanceof uO?i.roll():i).filter(i=>!!i||i===0));return e&&(Vf.engine=r),n}[T2](e){if(e instanceof vi)this[Hu]=e;else if(e instanceof fu)this[Hu]=new vi([e]);else if(Array.isArray(e))this[Hu]=new vi(e.map(r=>{if(r instanceof vi||r instanceof fu)return r;if(Array.isArray(r))return new fu(r);if(typeof r=="object"){if(Array.isArray(r.results))return new vi(r.results,r.modifiers||[],r.isRollGroup||!1,typeof r.useInTotal=="boolean"?r.useInTotal:!0);if(Array.isArray(r.rolls))return new fu(r.rolls)}return r}));else throw new TypeError("Rolls must be a valid result object, or an array")}}function Xve(t){const r=Array(500).fill(t).join(","),n=new bo(`{${r}}`);return Math.round(n.averageTotal/500)}function fb(t){const{baseArmorClass:e=10,dexterity:r}=t;let n=r?kv(r):0;if(vO(t)){const i=Sg(t);if(i){const a=i.armorClass||10;return i.armorClassMod==="dexterity"?a+n:a}}else return e+n}function lO(t,e,r){let n=!1;(t.pc||e.pc)&&(n=!0);const i=new bo("d20").total,a=i===20,s=fb(e)||0;if(e.health)if(i>=s){let o=jve(t);if(a&&(o*=2),e.health.current-=o,n){let l=`${t.name} hits ${e.name} with ${r.name} for ${o} hp!`;a&&(l=`Critical! ${l}`),Dn(l)}}else n&&Dn(`${t.name} misses ${e.name}!`)}function cO(t){var r;const e=(r=t.weaponSlot)==null?void 0:r.contents[0];return e?Xt.registry.get(e):!1}function jve(t,e){let r=0;const n=cO(t);if(n){const i=n.damageRoll||"1d4",a=new bo(i).total;if(r+=a,t.dexterity){const s=kv(t.dexterity);r+=s}}return n||t.dexterity&&(r+=kv(t.dexterity)),Math.max(0,r)}function fh(t,e){const r=e||cO(t);if(!t.strength)return 0;const n=kv(t.strength);if(!r)return n+1;if(r){const a=`${r.damageRoll||"1d4"}+${n}`;return Xve(a)}}const fO=t=>{const e=Un("rat",{position:t});return e.averageDamage=fh(e),e},Yve=t=>{const e=Un("lavaGolem",{position:t});return e.averageDamage=fh(e),e},hO=t=>{const e=Un("skeleton",{position:t}),r=["shortsword","club","dagger"],n=Un(Qt.sample(r)),i=Un("leatherArmor");return Qt.times(1,()=>Un("healthPotion",{position:t,tryPickUp:{pickerId:e.id}})),qx(e,n),Wx(e,i),e};var hu=(t=>(t[t.dungeonWidth=74]="dungeonWidth",t[t.dungeonHeight=39]="dungeonHeight",t))(hu||{});function Kve(t,e){const r={},n=Math.min(t.x,e.x),i=Math.max(t.x,e.x)+1;let a=n;for(;a<i;){const s={...e,x:a};r[Ir(s)]={...s,sprite:"FLOOR"},a++}return r}function Zve(t,e){const r={},n=Math.min(t.y,e.y),i=Math.max(t.y,e.y)+1;let a=n;for(;a<i;){const s={...t,y:a};r[Ir(s)]={...s,sprite:"FLOOR"},a++}return r}const Qve=t=>{const{pos:e,width:r,height:n,minRoomSize:i=6,maxRoomSize:a=12,maxRoomCount:s=30}=t,{x:o,y:l}=e,u={...yE({x:o,y:l,width:r,height:n,hasWalls:!1},{}),rooms:[]},c=new Map(Object.entries(u.tiles)),f=({x:m,y:v},y)=>{const x=Ir({x:m,y:v}),S=c.get(x);S&&(S.tags||(S.tags=new Set),y.forEach(b=>S.tags.add(b))),c.set(x,S)};for(const[m,v]of c)f(v,[qi.Dirt]);Qt.times(s,()=>{let m=Qt.random(i,a),v=Qt.random(i,a),y=Qt.random(o,r+o-m-1),x=Qt.random(l,n+l-v-1);const S=yE({x:y,y:x,width:m,height:v,hasWalls:!0},{});if(!u.rooms.some(b=>Lq(b,S))){u.rooms.push(S);for(const b of Object.entries(S.tiles))f(b[1],[qi.Room,qi.Floor])}});let h=null,p={};for(let m of u.rooms){h&&(p={...Kve(m.center,h.center),...Zve(m.center,h.center)});for(const v of Object.entries(p))f(v[1],[qi.Passage,qi.Floor]);h=m}for(let m of u.rooms){const v={x:m.x1,y:m.y2-1},y={x:m.x2-1,y:m.y2-1},x={x:m.x1,y:m.y1},S={x:m.x2-1,y:m.y1};[...Mf(x,S),...Mf(S,y),...Mf(y,v),...Mf(v,x)].forEach(A=>f(A,[qi.Perimeter,qi.Wall]))}return{dungeon:u,tilesMap:c}},dO=()=>{const{dungeon:e,tilesMap:r}=Qve({pos:{x:0,y:0},width:hu.dungeonWidth,height:hu.dungeonHeight,minRoomSize:8,maxRoomSize:18,maxRoomCount:100}),n=new Map;for(const[s,o]of r){const{x:l,y:u}=o;if(o.tags.has(qi.Dirt)&&!o.tags.has(qi.Floor)){const c=Un("wall",{position:{x:l,y:u}});n.set(Ir({x:l,y:u}),c)}if(o.tags.has(qi.Floor)||o.tags.has(qi.Passage)){const c=Un("floor",{position:{x:l,y:u}});n.set(Ir({x:l,y:u}),c);const f=Un("fluidContainer",{position:{x:l,y:u}}),h=["lava","oil","blood","water"];if(Math.random()<.005&&f.fluidContainer){const p=Qt.random(5,20);f.fluidContainer.fluids[Qt.sample(h)||"water"].volume=p}}}for(const[s,o]of r){const{x:l,y:u}=o;if(o.tags.has(qi.Perimeter)){const c=Jf({x:l,y:u},"cardinal",{width:e.width,height:e.height},!0);let f=0;for(const h of c)n.get(h).name==="wall"&&(f+=1);o.tags.has(qi.Floor)&&f===2&&Un("door",{position:{x:l,y:u}})}}const i=[...r.values()].filter(s=>{var o;return(o=s.tags)==null?void 0:o.has(qi.Floor)});Qt.times(10,()=>{const s=Qt.sample(i);if(!s)return;const o={x:s.x,y:s.y},l=new bo("d100").total;l<=5&&Yve(o),l>5&&l<=30&&hO(o),l>30&&fO(o)}),e.rooms.forEach((s,o)=>{const l=new bo("d100").total;if(o&&(l>=50?Un("rock",{position:s.center}):Un("healthPotion",{position:s.center})),o===1){const{x:u,y:c}=Qt.sample(s.tiles)||{x:0,y:0};Un("stairsUp",{position:{x:u,y:c}})}if(o===2){const{x:u,y:c}=Qt.sample(s.tiles)||{x:0,y:0};Un("stairsDown",{position:{x:u,y:c}})}});const a={};e.rooms.forEach(s=>{var c;const{x:o,y:l}=Qt.sample((c=Qt.sample(e.rooms))==null?void 0:c.tiles)||{x:0,y:0},u=Un("grass",{position:{x:o,y:l}});u.position&&(a[Ir(u.position)]=u)});for(let s=0;s<10;s++)Object.keys(a).forEach(o=>{const l=fl(o),u=Jf({x:l.x,y:l.y},"all",{width:hu.dungeonWidth,height:hu.dungeonHeight},!0);for(const c of u)if(!a[c]&&!e.tiles[c].tags.has("wall")){const f=fl(c);if(Math.random()<.2){const h=Un("grass",{position:f});h.position&&(a[Ir(h.position)]=h)}}});return e};var pO={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(Qn,function(){var r=function(w,C){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,L){O.__proto__=L}||function(O,L){for(var q in L)Object.prototype.hasOwnProperty.call(L,q)&&(O[q]=L[q])})(w,C)},n=function(){return(n=Object.assign||function(w){for(var C,O=1,L=arguments.length;O<L;O++)for(var q in C=arguments[O])Object.prototype.hasOwnProperty.call(C,q)&&(w[q]=C[q]);return w}).apply(this,arguments)};function i(w,C,O){for(var L,q=0,Y=C.length;q<Y;q++)!L&&q in C||((L=L||Array.prototype.slice.call(C,0,q))[q]=C[q]);return w.concat(L||Array.prototype.slice.call(C))}var a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Qn,s=Object.keys,o=Array.isArray;function l(w,C){return typeof C!="object"||s(C).forEach(function(O){w[O]=C[O]}),w}typeof Promise>"u"||a.Promise||(a.Promise=Promise);var u=Object.getPrototypeOf,c={}.hasOwnProperty;function f(w,C){return c.call(w,C)}function h(w,C){typeof C=="function"&&(C=C(u(w))),(typeof Reflect>"u"?s:Reflect.ownKeys)(C).forEach(function(O){m(w,O,C[O])})}var p=Object.defineProperty;function m(w,C,O,L){p(w,C,l(O&&f(O,"get")&&typeof O.get=="function"?{get:O.get,set:O.set,configurable:!0}:{value:O,configurable:!0,writable:!0},L))}function v(w){return{from:function(C){return w.prototype=Object.create(C.prototype),m(w.prototype,"constructor",w),{extend:h.bind(null,w.prototype)}}}}var y=Object.getOwnPropertyDescriptor,x=[].slice;function S(w,C,O){return x.call(w,C,O)}function b(w,C){return C(w)}function A(w){if(!w)throw new Error("Assertion Failed")}function E(w){a.setImmediate?setImmediate(w):setTimeout(w,0)}function _(w,C){if(typeof C=="string"&&f(w,C))return w[C];if(!C)return w;if(typeof C!="string"){for(var O=[],L=0,q=C.length;L<q;++L){var Y=_(w,C[L]);O.push(Y)}return O}var se=C.indexOf(".");if(se!==-1){var W=w[C.substr(0,se)];return W==null?void 0:_(W,C.substr(se+1))}}function T(w,C,O){if(w&&C!==void 0&&!("isFrozen"in Object&&Object.isFrozen(w)))if(typeof C!="string"&&"length"in C){A(typeof O!="string"&&"length"in O);for(var L=0,q=C.length;L<q;++L)T(w,C[L],O[L])}else{var Y,se,W=C.indexOf(".");W!==-1?(Y=C.substr(0,W),(se=C.substr(W+1))===""?O===void 0?o(w)&&!isNaN(parseInt(Y))?w.splice(Y,1):delete w[Y]:w[Y]=O:T(W=!(W=w[Y])||!f(w,Y)?w[Y]={}:W,se,O)):O===void 0?o(w)&&!isNaN(parseInt(C))?w.splice(C,1):delete w[C]:w[C]=O}}function M(w){var C,O={};for(C in w)f(w,C)&&(O[C]=w[C]);return O}var N=[].concat;function I(w){return N.apply([],w)}var Ge="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(I([8,16,32,64].map(function(w){return["Int","Uint","Float"].map(function(C){return C+w+"Array"})}))).filter(function(w){return a[w]}),F=new Set(Ge.map(function(w){return a[w]})),P=null;function U(w){return P=new WeakMap,w=function C(O){if(!O||typeof O!="object")return O;var L=P.get(O);if(L)return L;if(o(O)){L=[],P.set(O,L);for(var q=0,Y=O.length;q<Y;++q)L.push(C(O[q]))}else if(F.has(O.constructor))L=O;else{var se,W=u(O);for(se in L=W===Object.prototype?{}:Object.create(W),P.set(O,L),O)f(O,se)&&(L[se]=C(O[se]))}return L}(w),P=null,w}var G={}.toString;function V(w){return G.call(w).slice(8,-1)}var $=typeof Symbol<"u"?Symbol.iterator:"@@iterator",j=typeof $=="symbol"?function(w){var C;return w!=null&&(C=w[$])&&C.apply(w)}:function(){return null};function k(w,C){return C=w.indexOf(C),0<=C&&w.splice(C,1),0<=C}var Z={};function z(w){var C,O,L,q;if(arguments.length===1){if(o(w))return w.slice();if(this===Z&&typeof w=="string")return[w];if(q=j(w)){for(O=[];!(L=q.next()).done;)O.push(L.value);return O}if(w==null)return[w];if(typeof(C=w.length)!="number")return[w];for(O=new Array(C);C--;)O[C]=w[C];return O}for(C=arguments.length,O=new Array(C);C--;)O[C]=arguments[C];return O}var me=typeof Symbol<"u"?function(w){return w[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ne=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],tt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ne),fe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ue(w,C){this.name=w,this.message=C}function le(w,C){return w+". Errors: "+Object.keys(C).map(function(O){return C[O].toString()}).filter(function(O,L,q){return q.indexOf(O)===L}).join(`
`)}function ke(w,C,O,L){this.failures=C,this.failedKeys=L,this.successCount=O,this.message=le(w,C)}function Me(w,C){this.name="BulkError",this.failures=Object.keys(C).map(function(O){return C[O]}),this.failuresByPos=C,this.message=le(w,this.failures)}v(ue).from(Error).extend({toString:function(){return this.name+": "+this.message}}),v(ke).from(ue),v(Me).from(ue);var Se=tt.reduce(function(w,C){return w[C]=C+"Error",w},{}),oe=ue,K=tt.reduce(function(w,C){var O=C+"Error";function L(q,Y){this.name=O,q?typeof q=="string"?(this.message="".concat(q).concat(Y?`
 `+Y:""),this.inner=Y||null):typeof q=="object"&&(this.message="".concat(q.name," ").concat(q.message),this.inner=q):(this.message=fe[C]||O,this.inner=null)}return v(L).from(oe),w[C]=L,w},{});K.Syntax=SyntaxError,K.Type=TypeError,K.Range=RangeError;var de=Ne.reduce(function(w,C){return w[C+"Error"]=K[C],w},{}),_e=tt.reduce(function(w,C){return["Syntax","Type","Range"].indexOf(C)===-1&&(w[C+"Error"]=K[C]),w},{});function be(){}function $e(w){return w}function Oe(w,C){return w==null||w===$e?C:function(O){return C(w(O))}}function Qe(w,C){return function(){w.apply(this,arguments),C.apply(this,arguments)}}function ae(w,C){return w===be?C:function(){var O=w.apply(this,arguments);O!==void 0&&(arguments[0]=O);var L=this.onsuccess,q=this.onerror;this.onsuccess=null,this.onerror=null;var Y=C.apply(this,arguments);return L&&(this.onsuccess=this.onsuccess?Qe(L,this.onsuccess):L),q&&(this.onerror=this.onerror?Qe(q,this.onerror):q),Y!==void 0?Y:O}}function ce(w,C){return w===be?C:function(){w.apply(this,arguments);var O=this.onsuccess,L=this.onerror;this.onsuccess=this.onerror=null,C.apply(this,arguments),O&&(this.onsuccess=this.onsuccess?Qe(O,this.onsuccess):O),L&&(this.onerror=this.onerror?Qe(L,this.onerror):L)}}function Ce(w,C){return w===be?C:function(O){var L=w.apply(this,arguments);l(O,L);var q=this.onsuccess,Y=this.onerror;return this.onsuccess=null,this.onerror=null,O=C.apply(this,arguments),q&&(this.onsuccess=this.onsuccess?Qe(q,this.onsuccess):q),Y&&(this.onerror=this.onerror?Qe(Y,this.onerror):Y),L===void 0?O===void 0?void 0:O:l(L,O)}}function Ue(w,C){return w===be?C:function(){return C.apply(this,arguments)!==!1&&w.apply(this,arguments)}}function Ve(w,C){return w===be?C:function(){var O=w.apply(this,arguments);if(O&&typeof O.then=="function"){for(var L=this,q=arguments.length,Y=new Array(q);q--;)Y[q]=arguments[q];return O.then(function(){return C.apply(L,Y)})}return C.apply(this,arguments)}}_e.ModifyError=ke,_e.DexieError=ue,_e.BulkError=Me;var je=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ht(w){je=w}var re={},we=100,Ge=typeof Promise>"u"?[]:function(){var w=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[w,u(w),w];var C=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[C,u(C),w]}(),Ne=Ge[0],tt=Ge[1],Ge=Ge[2],tt=tt&&tt.then,He=Ne&&Ne.constructor,We=!!Ge,ft=function(w,C){ge.push([w,C]),dt&&(queueMicrotask(To),dt=!1)},st=!0,dt=!0,at=[],tr=[],Ot=$e,fr={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:be,pgp:!1,env:{},finalize:be},R=fr,ge=[],Le=0,rt=[];function Xe(w){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var C=this._PSD=R;if(typeof w!="function"){if(w!==re)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&fs(this,this._value))}this._state=null,this._value=null,++C.ref,function O(L,q){try{q(function(Y){if(L._state===null){if(Y===L)throw new TypeError("A promise cannot be resolved with itself.");var se=L._lib&&Ia();Y&&typeof Y.then=="function"?O(L,function(W,ne){Y instanceof Xe?Y._then(W,ne):Y.then(W,ne)}):(L._state=!0,L._value=Y,Co(L)),se&&Fa()}},fs.bind(null,L))}catch(Y){fs(L,Y)}}(this,w)}var qt={get:function(){var w=R,C=Zs;function O(L,q){var Y=this,se=!w.global&&(w!==R||C!==Zs),W=se&&!hi(),ne=new Xe(function(J,ye){js(Y,new pn(Su(L,w,se,W),Su(q,w,se,W),J,ye,w))});return this._consoleTask&&(ne._consoleTask=this._consoleTask),ne}return O.prototype=re,O},set:function(w){m(this,"then",w&&w.prototype===re?qt:{get:function(){return w},set:qt.set})}};function pn(w,C,O,L,q){this.onFulfilled=typeof w=="function"?w:null,this.onRejected=typeof C=="function"?C:null,this.resolve=O,this.reject=L,this.psd=q}function fs(w,C){var O,L;tr.push(C),w._state===null&&(O=w._lib&&Ia(),C=Ot(C),w._state=!1,w._value=C,L=w,at.some(function(q){return q._value===L._value})||at.push(L),Co(w),O&&Fa())}function Co(w){var C=w._listeners;w._listeners=[];for(var O=0,L=C.length;O<L;++O)js(w,C[O]);var q=w._PSD;--q.ref||q.finalize(),Le===0&&(++Le,ft(function(){--Le==0&&No()},[]))}function js(w,C){if(w._state!==null){var O=w._state?C.onFulfilled:C.onRejected;if(O===null)return(w._state?C.resolve:C.reject)(w._value);++C.psd.ref,++Le,ft(Tl,[O,w,C])}else w._listeners.push(C)}function Tl(w,C,O){try{var L,q=C._value;!C._state&&tr.length&&(tr=[]),L=je&&C._consoleTask?C._consoleTask.run(function(){return w(q)}):w(q),C._state||tr.indexOf(q)!==-1||function(Y){for(var se=at.length;se;)if(at[--se]._value===Y._value)return at.splice(se,1)}(C),O.resolve(L)}catch(Y){O.reject(Y)}finally{--Le==0&&No(),--O.psd.ref||O.psd.finalize()}}function To(){ga(fr,function(){Ia()&&Fa()})}function Ia(){var w=st;return dt=st=!1,w}function Fa(){var w,C,O;do for(;0<ge.length;)for(w=ge,ge=[],O=w.length,C=0;C<O;++C){var L=w[C];L[0].apply(null,L[1])}while(0<ge.length);dt=st=!0}function No(){var w=at;at=[],w.forEach(function(L){L._PSD.onunhandled.call(null,L._value,L)});for(var C=rt.slice(0),O=C.length;O;)C[--O]()}function Oa(w){return new Xe(re,!1,w)}function Xr(w,C){var O=R;return function(){var L=Ia(),q=R;try{return ra(O,!0),w.apply(this,arguments)}catch(Y){C&&C(Y)}finally{ra(q,!1),L&&Fa()}}}h(Xe.prototype,{then:qt,_then:function(w,C){js(this,new pn(null,null,w,C,R))},catch:function(w){if(arguments.length===1)return this.then(null,w);var C=w,O=arguments[1];return typeof C=="function"?this.then(null,function(L){return(L instanceof C?O:Oa)(L)}):this.then(null,function(L){return(L&&L.name===C?O:Oa)(L)})},finally:function(w){return this.then(function(C){return Xe.resolve(w()).then(function(){return C})},function(C){return Xe.resolve(w()).then(function(){return Oa(C)})})},timeout:function(w,C){var O=this;return w<1/0?new Xe(function(L,q){var Y=setTimeout(function(){return q(new K.Timeout(C))},w);O.then(L,q).finally(clearTimeout.bind(null,Y))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&m(Xe.prototype,Symbol.toStringTag,"Dexie.Promise"),fr.env=Eu(),h(Xe,{all:function(){var w=z.apply(null,arguments).map(ta);return new Xe(function(C,O){w.length===0&&C([]);var L=w.length;w.forEach(function(q,Y){return Xe.resolve(q).then(function(se){w[Y]=se,--L||C(w)},O)})})},resolve:function(w){return w instanceof Xe?w:w&&typeof w.then=="function"?new Xe(function(C,O){w.then(C,O)}):new Xe(re,!0,w)},reject:Oa,race:function(){var w=z.apply(null,arguments).map(ta);return new Xe(function(C,O){w.map(function(L){return Xe.resolve(L).then(C,O)})})},PSD:{get:function(){return R},set:function(w){return R=w}},totalEchoes:{get:function(){return Zs}},newPSD:ea,usePSD:ga,scheduler:{get:function(){return ft},set:function(w){ft=w}},rejectionMapper:{get:function(){return Ot},set:function(w){Ot=w}},follow:function(w,C){return new Xe(function(O,L){return ea(function(q,Y){var se=R;se.unhandleds=[],se.onunhandled=Y,se.finalize=Qe(function(){var W,ne=this;W=function(){ne.unhandleds.length===0?q():Y(ne.unhandleds[0])},rt.push(function J(){W(),rt.splice(rt.indexOf(J),1)}),++Le,ft(function(){--Le==0&&No()},[])},se.finalize),w()},C,O,L)})}}),He&&(He.allSettled&&m(Xe,"allSettled",function(){var w=z.apply(null,arguments).map(ta);return new Xe(function(C){w.length===0&&C([]);var O=w.length,L=new Array(O);w.forEach(function(q,Y){return Xe.resolve(q).then(function(se){return L[Y]={status:"fulfilled",value:se}},function(se){return L[Y]={status:"rejected",reason:se}}).then(function(){return--O||C(L)})})})}),He.any&&typeof AggregateError<"u"&&m(Xe,"any",function(){var w=z.apply(null,arguments).map(ta);return new Xe(function(C,O){w.length===0&&O(new AggregateError([]));var L=w.length,q=new Array(L);w.forEach(function(Y,se){return Xe.resolve(Y).then(function(W){return C(W)},function(W){q[se]=W,--L||O(new AggregateError(q))})})})}),He.withResolvers&&(Xe.withResolvers=He.withResolvers));var fn={awaits:0,echoes:0,id:0},Nl=0,Ys=[],Ks=0,Zs=0,Ml=0;function ea(w,C,O,L){var q=R,Y=Object.create(q);return Y.parent=q,Y.ref=0,Y.global=!1,Y.id=++Ml,fr.env,Y.env=We?{Promise:Xe,PromiseProp:{value:Xe,configurable:!0,writable:!0},all:Xe.all,race:Xe.race,allSettled:Xe.allSettled,any:Xe.any,resolve:Xe.resolve,reject:Xe.reject}:{},C&&l(Y,C),++q.ref,Y.finalize=function(){--this.parent.ref||this.parent.finalize()},L=ga(Y,w,O,L),Y.ref===0&&Y.finalize(),L}function Ba(){return fn.id||(fn.id=++Nl),++fn.awaits,fn.echoes+=we,fn.id}function hi(){return!!fn.awaits&&(--fn.awaits==0&&(fn.id=0),fn.echoes=fn.awaits*we,!0)}function ta(w){return fn.echoes&&w&&w.constructor===He?(Ba(),w.then(function(C){return hi(),C},function(C){return hi(),jr(C)})):w}function Il(){var w=Ys[Ys.length-1];Ys.pop(),ra(w,!1)}function ra(w,C){var O,L=R;(C?!fn.echoes||Ks++&&w===R:!Ks||--Ks&&w===R)||queueMicrotask(C?(function(q){++Zs,fn.echoes&&--fn.echoes!=0||(fn.echoes=fn.awaits=fn.id=0),Ys.push(R),ra(q,!0)}).bind(null,w):Il),w!==R&&(R=w,L===fr&&(fr.env=Eu()),We&&(O=fr.env.Promise,C=w.env,(L.global||w.global)&&(Object.defineProperty(a,"Promise",C.PromiseProp),O.all=C.all,O.race=C.race,O.resolve=C.resolve,O.reject=C.reject,C.allSettled&&(O.allSettled=C.allSettled),C.any&&(O.any=C.any))))}function Eu(){var w=a.Promise;return We?{Promise:w,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:w.all,race:w.race,allSettled:w.allSettled,any:w.any,resolve:w.resolve,reject:w.reject}:{}}function ga(w,C,O,L,q){var Y=R;try{return ra(w,!0),C(O,L,q)}finally{ra(Y,!1)}}function Su(w,C,O,L){return typeof w!="function"?w:function(){var q=R;O&&Ba(),ra(C,!0);try{return w.apply(this,arguments)}finally{ra(q,!1),L&&queueMicrotask(hi)}}}function Mo(w){Promise===He&&fn.echoes===0?Ks===0?w():enqueueNativeMicroTask(w):setTimeout(w,0)}(""+tt).indexOf("[native code]")===-1&&(Ba=hi=be);var jr=Xe.reject,di="￿",ir="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Tn="String expected.",Ra=[],ya="__dbnames",ki="readonly",Qs="readwrite";function Pa(w,C){return w?C?function(){return w.apply(this,arguments)&&C.apply(this,arguments)}:w:C}var Io={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Du(w){return typeof w!="string"||/\./.test(w)?function(C){return C}:function(C){return C[w]===void 0&&w in C&&delete(C=U(C))[w],C}}function kc(){throw K.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Er(w,C){try{var O=Fl(w),L=Fl(C);if(O!==L)return O==="Array"?1:L==="Array"?-1:O==="binary"?1:L==="binary"?-1:O==="string"?1:L==="string"?-1:O==="Date"?1:L!=="Date"?NaN:-1;switch(O){case"number":case"Date":case"string":return C<w?1:w<C?-1:0;case"binary":return function(q,Y){for(var se=q.length,W=Y.length,ne=se<W?se:W,J=0;J<ne;++J)if(q[J]!==Y[J])return q[J]<Y[J]?-1:1;return se===W?0:se<W?-1:1}(Ol(w),Ol(C));case"Array":return function(q,Y){for(var se=q.length,W=Y.length,ne=se<W?se:W,J=0;J<ne;++J){var ye=Er(q[J],Y[J]);if(ye!==0)return ye}return se===W?0:se<W?-1:1}(w,C)}}catch{}return NaN}function Fl(w){var C=typeof w;return C!="object"?C:ArrayBuffer.isView(w)?"binary":(w=V(w),w==="ArrayBuffer"?"binary":w)}function Ol(w){return w instanceof Uint8Array?w:ArrayBuffer.isView(w)?new Uint8Array(w.buffer,w.byteOffset,w.byteLength):new Uint8Array(w)}function Fo(w,C,O){var L=w.schema.yProps;return L?(C&&0<O.numFailures&&(C=C.filter(function(q,Y){return!O.failures[Y]})),Promise.all(L.map(function(q){return q=q.updatesTable,C?w.db.table(q).where("k").anyOf(C).delete():w.db.table(q).clear()})).then(function(){return O})):O}var hs=(Lc.prototype.execute=function(w){var C=this["@@propmod"];if(C.add!==void 0){var O=C.add;if(o(O))return i(i([],o(w)?w:[],!0),O).sort();if(typeof O=="number")return(Number(w)||0)+O;if(typeof O=="bigint")try{return BigInt(w)+O}catch{return BigInt(0)+O}throw new TypeError("Invalid term ".concat(O))}if(C.remove!==void 0){var L=C.remove;if(o(L))return o(w)?w.filter(function(q){return!L.includes(q)}).sort():[];if(typeof L=="number")return Number(w)-L;if(typeof L=="bigint")try{return BigInt(w)-L}catch{return BigInt(0)-L}throw new TypeError("Invalid subtrahend ".concat(L))}return O=(O=C.replacePrefix)===null||O===void 0?void 0:O[0],O&&typeof w=="string"&&w.startsWith(O)?C.replacePrefix[1]+w.substring(O.length):w},Lc);function Lc(w){this["@@propmod"]=w}function Oo(w,C){for(var O=s(C),L=O.length,q=!1,Y=0;Y<L;++Y){var se=O[Y],W=C[se],ne=_(w,se);W instanceof hs?(T(w,se,W.execute(ne)),q=!0):ne!==W&&(T(w,se,W),q=!0)}return q}var $a=(Hr.prototype._trans=function(w,C,O){var L=this._tx||R.trans,q=this.name,Y=je&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(w==="readonly"?"read":"write"," ").concat(this.name));function se(J,ye,he){if(!he.schema[q])throw new K.NotFound("Table "+q+" not part of transaction");return C(he.idbtrans,he)}var W=Ia();try{var ne=L&&L.db._novip===this.db._novip?L===R.trans?L._promise(w,se,O):ea(function(){return L._promise(w,se,O)},{trans:L,transless:R.transless||R}):function J(ye,he,Te,Ae){if(ye.idbdb&&(ye._state.openComplete||R.letThrough||ye._vip)){var Ee=ye._createTransaction(he,Te,ye._dbSchema);try{Ee.create(),ye._state.PR1398_maxLoop=3}catch(Fe){return Fe.name===Se.InvalidState&&ye.isOpen()&&0<--ye._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),ye.close({disableAutoOpen:!1}),ye.open().then(function(){return J(ye,he,Te,Ae)})):jr(Fe)}return Ee._promise(he,function(Fe,Be){return ea(function(){return R.trans=Ee,Ae(Fe,Be,Ee)})}).then(function(Fe){if(he==="readwrite")try{Ee.idbtrans.commit()}catch{}return he==="readonly"?Fe:Ee._completion.then(function(){return Fe})})}if(ye._state.openComplete)return jr(new K.DatabaseClosed(ye._state.dbOpenError));if(!ye._state.isBeingOpened){if(!ye._state.autoOpen)return jr(new K.DatabaseClosed);ye.open().catch(be)}return ye._state.dbReadyPromise.then(function(){return J(ye,he,Te,Ae)})}(this.db,w,[this.name],se);return Y&&(ne._consoleTask=Y,ne=ne.catch(function(J){return console.trace(J),jr(J)})),ne}finally{W&&Fa()}},Hr.prototype.get=function(w,C){var O=this;return w&&w.constructor===Object?this.where(w).first(C):w==null?jr(new K.Type("Invalid argument to Table.get()")):this._trans("readonly",function(L){return O.core.get({trans:L,key:w}).then(function(q){return O.hook.reading.fire(q)})}).then(C)},Hr.prototype.where=function(w){if(typeof w=="string")return new this.db.WhereClause(this,w);if(o(w))return new this.db.WhereClause(this,"[".concat(w.join("+"),"]"));var C=s(w);if(C.length===1)return this.where(C[0]).equals(w[C[0]]);var O=this.schema.indexes.concat(this.schema.primKey).filter(function(W){if(W.compound&&C.every(function(J){return 0<=W.keyPath.indexOf(J)})){for(var ne=0;ne<C.length;++ne)if(C.indexOf(W.keyPath[ne])===-1)return!1;return!0}return!1}).sort(function(W,ne){return W.keyPath.length-ne.keyPath.length})[0];if(O&&this.db._maxKey!==di){var Y=O.keyPath.slice(0,C.length);return this.where(Y).equals(Y.map(function(ne){return w[ne]}))}!O&&je&&console.warn("The query ".concat(JSON.stringify(w)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(C.join("+"),"]"));var L=this.schema.idxByName;function q(W,ne){return Er(W,ne)===0}var se=C.reduce(function(he,ne){var J=he[0],ye=he[1],he=L[ne],Te=w[ne];return[J||he,J||!he?Pa(ye,he&&he.multi?function(Ae){return Ae=_(Ae,ne),o(Ae)&&Ae.some(function(Ee){return q(Te,Ee)})}:function(Ae){return q(Te,_(Ae,ne))}):ye]},[null,null]),Y=se[0],se=se[1];return Y?this.where(Y.name).equals(w[Y.keyPath]).filter(se):O?this.filter(se):this.where(C).equals("")},Hr.prototype.filter=function(w){return this.toCollection().and(w)},Hr.prototype.count=function(w){return this.toCollection().count(w)},Hr.prototype.offset=function(w){return this.toCollection().offset(w)},Hr.prototype.limit=function(w){return this.toCollection().limit(w)},Hr.prototype.each=function(w){return this.toCollection().each(w)},Hr.prototype.toArray=function(w){return this.toCollection().toArray(w)},Hr.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Hr.prototype.orderBy=function(w){return new this.db.Collection(new this.db.WhereClause(this,o(w)?"[".concat(w.join("+"),"]"):w))},Hr.prototype.reverse=function(){return this.toCollection().reverse()},Hr.prototype.mapToClass=function(w){var C,O=this.db,L=this.name;function q(){return C!==null&&C.apply(this,arguments)||this}(this.schema.mappedClass=w).prototype instanceof kc&&(function(ne,J){if(typeof J!="function"&&J!==null)throw new TypeError("Class extends value "+String(J)+" is not a constructor or null");function ye(){this.constructor=ne}r(ne,J),ne.prototype=J===null?Object.create(J):(ye.prototype=J.prototype,new ye)}(q,C=w),Object.defineProperty(q.prototype,"db",{get:function(){return O},enumerable:!1,configurable:!0}),q.prototype.table=function(){return L},w=q);for(var Y=new Set,se=w.prototype;se;se=u(se))Object.getOwnPropertyNames(se).forEach(function(ne){return Y.add(ne)});function W(ne){if(!ne)return ne;var J,ye=Object.create(w.prototype);for(J in ne)if(!Y.has(J))try{ye[J]=ne[J]}catch{}return ye}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=W,this.hook("reading",W),w},Hr.prototype.defineClass=function(){return this.mapToClass(function(w){l(this,w)})},Hr.prototype.add=function(w,C){var O=this,L=this.schema.primKey,q=L.auto,Y=L.keyPath,se=w;return Y&&q&&(se=Du(Y)(w)),this._trans("readwrite",function(W){return O.core.mutate({trans:W,type:"add",keys:C!=null?[C]:null,values:[se]})}).then(function(W){return W.numFailures?Xe.reject(W.failures[0]):W.lastResult}).then(function(W){if(Y)try{T(w,Y,W)}catch{}return W})},Hr.prototype.upsert=function(w,C){var O=this,L=this.schema.primKey.keyPath;return this._trans("readwrite",function(q){return O.core.get({trans:q,key:w}).then(function(Y){var se=Y??{};return Oo(se,C),L&&T(se,L,w),O.core.mutate({trans:q,type:"put",values:[se],keys:[w],upsert:!0,updates:{keys:[w],changeSpecs:[C]}}).then(function(W){return W.numFailures?Xe.reject(W.failures[0]):!!Y})})})},Hr.prototype.update=function(w,C){return typeof w!="object"||o(w)?this.where(":id").equals(w).modify(C):(w=_(w,this.schema.primKey.keyPath),w===void 0?jr(new K.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(w).modify(C))},Hr.prototype.put=function(w,C){var O=this,L=this.schema.primKey,q=L.auto,Y=L.keyPath,se=w;return Y&&q&&(se=Du(Y)(w)),this._trans("readwrite",function(W){return O.core.mutate({trans:W,type:"put",values:[se],keys:C!=null?[C]:null})}).then(function(W){return W.numFailures?Xe.reject(W.failures[0]):W.lastResult}).then(function(W){if(Y)try{T(w,Y,W)}catch{}return W})},Hr.prototype.delete=function(w){var C=this;return this._trans("readwrite",function(O){return C.core.mutate({trans:O,type:"delete",keys:[w]}).then(function(L){return Fo(C,[w],L)}).then(function(L){return L.numFailures?Xe.reject(L.failures[0]):void 0})})},Hr.prototype.clear=function(){var w=this;return this._trans("readwrite",function(C){return w.core.mutate({trans:C,type:"deleteRange",range:Io}).then(function(O){return Fo(w,null,O)})}).then(function(C){return C.numFailures?Xe.reject(C.failures[0]):void 0})},Hr.prototype.bulkGet=function(w){var C=this;return this._trans("readonly",function(O){return C.core.getMany({keys:w,trans:O}).then(function(L){return L.map(function(q){return C.hook.reading.fire(q)})})})},Hr.prototype.bulkAdd=function(w,C,O){var L=this,q=Array.isArray(C)?C:void 0,Y=(O=O||(q?void 0:C))?O.allKeys:void 0;return this._trans("readwrite",function(se){var J=L.schema.primKey,W=J.auto,J=J.keyPath;if(J&&q)throw new K.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(q&&q.length!==w.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var ne=w.length,J=J&&W?w.map(Du(J)):w;return L.core.mutate({trans:se,type:"add",keys:q,values:J,wantResults:Y}).then(function(Ee){var he=Ee.numFailures,Te=Ee.results,Ae=Ee.lastResult,Ee=Ee.failures;if(he===0)return Y?Te:Ae;throw new Me("".concat(L.name,".bulkAdd(): ").concat(he," of ").concat(ne," operations failed"),Ee)})})},Hr.prototype.bulkPut=function(w,C,O){var L=this,q=Array.isArray(C)?C:void 0,Y=(O=O||(q?void 0:C))?O.allKeys:void 0;return this._trans("readwrite",function(se){var J=L.schema.primKey,W=J.auto,J=J.keyPath;if(J&&q)throw new K.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(q&&q.length!==w.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var ne=w.length,J=J&&W?w.map(Du(J)):w;return L.core.mutate({trans:se,type:"put",keys:q,values:J,wantResults:Y}).then(function(Ee){var he=Ee.numFailures,Te=Ee.results,Ae=Ee.lastResult,Ee=Ee.failures;if(he===0)return Y?Te:Ae;throw new Me("".concat(L.name,".bulkPut(): ").concat(he," of ").concat(ne," operations failed"),Ee)})})},Hr.prototype.bulkUpdate=function(w){var C=this,O=this.core,L=w.map(function(se){return se.key}),q=w.map(function(se){return se.changes}),Y=[];return this._trans("readwrite",function(se){return O.getMany({trans:se,keys:L,cache:"clone"}).then(function(W){var ne=[],J=[];w.forEach(function(he,Te){var Ae=he.key,Ee=he.changes,Fe=W[Te];if(Fe){for(var Be=0,Pe=Object.keys(Ee);Be<Pe.length;Be++){var qe=Pe[Be],Ye=Ee[qe];if(qe===C.schema.primKey.keyPath){if(Er(Ye,Ae)!==0)throw new K.Constraint("Cannot update primary key in bulkUpdate()")}else T(Fe,qe,Ye)}Y.push(Te),ne.push(Ae),J.push(Fe)}});var ye=ne.length;return O.mutate({trans:se,type:"put",keys:ne,values:J,updates:{keys:L,changeSpecs:q}}).then(function(he){var Te=he.numFailures,Ae=he.failures;if(Te===0)return ye;for(var Ee=0,Fe=Object.keys(Ae);Ee<Fe.length;Ee++){var Be,Pe=Fe[Ee],qe=Y[Number(Pe)];qe!=null&&(Be=Ae[Pe],delete Ae[Pe],Ae[qe]=Be)}throw new Me("".concat(C.name,".bulkUpdate(): ").concat(Te," of ").concat(ye," operations failed"),Ae)})})})},Hr.prototype.bulkDelete=function(w){var C=this,O=w.length;return this._trans("readwrite",function(L){return C.core.mutate({trans:L,type:"delete",keys:w}).then(function(q){return Fo(C,w,q)})}).then(function(se){var q=se.numFailures,Y=se.lastResult,se=se.failures;if(q===0)return Y;throw new Me("".concat(C.name,".bulkDelete(): ").concat(q," of ").concat(O," operations failed"),se)})},Hr);function Hr(){}function Js(w){function C(se,W){if(W){for(var ne=arguments.length,J=new Array(ne-1);--ne;)J[ne-1]=arguments[ne];return O[se].subscribe.apply(null,J),w}if(typeof se=="string")return O[se]}var O={};C.addEventType=Y;for(var L=1,q=arguments.length;L<q;++L)Y(arguments[L]);return C;function Y(se,W,ne){if(typeof se!="object"){var J;W=W||Ue;var ye={subscribers:[],fire:ne=ne||be,subscribe:function(he){ye.subscribers.indexOf(he)===-1&&(ye.subscribers.push(he),ye.fire=W(ye.fire,he))},unsubscribe:function(he){ye.subscribers=ye.subscribers.filter(function(Te){return Te!==he}),ye.fire=ye.subscribers.reduce(W,ne)}};return O[se]=C[se]=ye}s(J=se).forEach(function(he){var Te=J[he];if(o(Te))Y(he,J[he][0],J[he][1]);else{if(Te!=="asap")throw new K.InvalidArgument("Invalid event config");var Ae=Y(he,$e,function(){for(var Ee=arguments.length,Fe=new Array(Ee);Ee--;)Fe[Ee]=arguments[Ee];Ae.subscribers.forEach(function(Be){E(function(){Be.apply(null,Fe)})})})}})}}function eo(w,C){return v(C).from({prototype:w}),C}function ds(w,C){return!(w.filter||w.algorithm||w.or)&&(C?w.justLimit:!w.replayFilter)}function Bo(w,C){w.filter=Pa(w.filter,C)}function Bl(w,C,O){var L=w.replayFilter;w.replayFilter=L?function(){return Pa(L(),C())}:C,w.justLimit=O&&!L}function Ro(w,C){if(w.isPrimKey)return C.primaryKey;var O=C.getIndexByKeyPath(w.index);if(!O)throw new K.Schema("KeyPath "+w.index+" on object store "+C.name+" is not indexed");return O}function Cu(w,C,O){var L=Ro(w,C.schema);return C.openCursor({trans:O,values:!w.keysOnly,reverse:w.dir==="prev",unique:!!w.unique,query:{index:L,range:w.range}})}function to(w,C,O,L){var q=w.replayFilter?Pa(w.filter,w.replayFilter()):w.filter;if(w.or){var Y={},se=function(W,ne,J){var ye,he;q&&!q(ne,J,function(Te){return ne.stop(Te)},function(Te){return ne.fail(Te)})||((he=""+(ye=ne.primaryKey))=="[object ArrayBuffer]"&&(he=""+new Uint8Array(ye)),f(Y,he)||(Y[he]=!0,C(W,ne,J)))};return Promise.all([w.or._iterate(se,O),ps(Cu(w,L,O),w.algorithm,se,!w.keysOnly&&w.valueMapper)])}return ps(Cu(w,L,O),Pa(w.algorithm,q),C,!w.keysOnly&&w.valueMapper)}function ps(w,C,O,L){var q=Xr(L?function(Y,se,W){return O(L(Y),se,W)}:O);return w.then(function(Y){if(Y)return Y.start(function(){var se=function(){return Y.continue()};C&&!C(Y,function(W){return se=W},function(W){Y.stop(W),se=be},function(W){Y.fail(W),se=be})||q(Y.value,Y,function(W){return se=W}),se()})})}var Uc=(Tr.prototype._read=function(w,C){var O=this._ctx;return O.error?O.table._trans(null,jr.bind(null,O.error)):O.table._trans("readonly",w).then(C)},Tr.prototype._write=function(w){var C=this._ctx;return C.error?C.table._trans(null,jr.bind(null,C.error)):C.table._trans("readwrite",w,"locked")},Tr.prototype._addAlgorithm=function(w){var C=this._ctx;C.algorithm=Pa(C.algorithm,w)},Tr.prototype._iterate=function(w,C){return to(this._ctx,w,C,this._ctx.table.core)},Tr.prototype.clone=function(w){var C=Object.create(this.constructor.prototype),O=Object.create(this._ctx);return w&&l(O,w),C._ctx=O,C},Tr.prototype.raw=function(){return this._ctx.valueMapper=null,this},Tr.prototype.each=function(w){var C=this._ctx;return this._read(function(O){return to(C,w,O,C.table.core)})},Tr.prototype.count=function(w){var C=this;return this._read(function(O){var L=C._ctx,q=L.table.core;if(ds(L,!0))return q.count({trans:O,query:{index:Ro(L,q.schema),range:L.range}}).then(function(se){return Math.min(se,L.limit)});var Y=0;return to(L,function(){return++Y,!1},O,q).then(function(){return Y})}).then(w)},Tr.prototype.sortBy=function(w,C){var O=w.split(".").reverse(),L=O[0],q=O.length-1;function Y(ne,J){return J?Y(ne[O[J]],J-1):ne[L]}var se=this._ctx.dir==="next"?1:-1;function W(ne,J){return Er(Y(ne,q),Y(J,q))*se}return this.toArray(function(ne){return ne.sort(W)}).then(C)},Tr.prototype.toArray=function(w){var C=this;return this._read(function(O){var L=C._ctx;if(L.dir==="next"&&ds(L,!0)&&0<L.limit){var q=L.valueMapper,Y=Ro(L,L.table.core.schema);return L.table.core.query({trans:O,limit:L.limit,values:!0,query:{index:Y,range:L.range}}).then(function(W){return W=W.result,q?W.map(q):W})}var se=[];return to(L,function(W){return se.push(W)},O,L.table.core).then(function(){return se})},w)},Tr.prototype.offset=function(w){var C=this._ctx;return w<=0||(C.offset+=w,ds(C)?Bl(C,function(){var O=w;return function(L,q){return O===0||(O===1?--O:q(function(){L.advance(O),O=0}),!1)}}):Bl(C,function(){var O=w;return function(){return--O<0}})),this},Tr.prototype.limit=function(w){return this._ctx.limit=Math.min(this._ctx.limit,w),Bl(this._ctx,function(){var C=w;return function(O,L,q){return--C<=0&&L(q),0<=C}},!0),this},Tr.prototype.until=function(w,C){return Bo(this._ctx,function(O,L,q){return!w(O.value)||(L(q),C)}),this},Tr.prototype.first=function(w){return this.limit(1).toArray(function(C){return C[0]}).then(w)},Tr.prototype.last=function(w){return this.reverse().first(w)},Tr.prototype.filter=function(w){var C;return Bo(this._ctx,function(O){return w(O.value)}),(C=this._ctx).isMatch=Pa(C.isMatch,w),this},Tr.prototype.and=function(w){return this.filter(w)},Tr.prototype.or=function(w){return new this.db.WhereClause(this._ctx.table,w,this)},Tr.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Tr.prototype.desc=function(){return this.reverse()},Tr.prototype.eachKey=function(w){var C=this._ctx;return C.keysOnly=!C.isMatch,this.each(function(O,L){w(L.key,L)})},Tr.prototype.eachUniqueKey=function(w){return this._ctx.unique="unique",this.eachKey(w)},Tr.prototype.eachPrimaryKey=function(w){var C=this._ctx;return C.keysOnly=!C.isMatch,this.each(function(O,L){w(L.primaryKey,L)})},Tr.prototype.keys=function(w){var C=this._ctx;C.keysOnly=!C.isMatch;var O=[];return this.each(function(L,q){O.push(q.key)}).then(function(){return O}).then(w)},Tr.prototype.primaryKeys=function(w){var C=this._ctx;if(C.dir==="next"&&ds(C,!0)&&0<C.limit)return this._read(function(L){var q=Ro(C,C.table.core.schema);return C.table.core.query({trans:L,values:!1,limit:C.limit,query:{index:q,range:C.range}})}).then(function(L){return L.result}).then(w);C.keysOnly=!C.isMatch;var O=[];return this.each(function(L,q){O.push(q.primaryKey)}).then(function(){return O}).then(w)},Tr.prototype.uniqueKeys=function(w){return this._ctx.unique="unique",this.keys(w)},Tr.prototype.firstKey=function(w){return this.limit(1).keys(function(C){return C[0]}).then(w)},Tr.prototype.lastKey=function(w){return this.reverse().firstKey(w)},Tr.prototype.distinct=function(){var w=this._ctx,w=w.index&&w.table.schema.idxByName[w.index];if(!w||!w.multi)return this;var C={};return Bo(this._ctx,function(q){var L=q.primaryKey.toString(),q=f(C,L);return C[L]=!0,!q}),this},Tr.prototype.modify=function(w){var C=this,O=this._ctx;return this._write(function(L){var q=typeof w=="function"?w:function(Fe){return Oo(Fe,w)},Y=O.table.core,J=Y.schema.primaryKey,se=J.outbound,W=J.extractKey,ne=200,J=C.db._options.modifyChunkSize;J&&(ne=typeof J=="object"?J[Y.name]||J["*"]||200:J);function ye(Fe,qe){var Pe=qe.failures,qe=qe.numFailures;Te+=Fe-qe;for(var Ye=0,et=s(Pe);Ye<et.length;Ye++){var vt=et[Ye];he.push(Pe[vt])}}var he=[],Te=0,Ae=[],Ee=w===zc;return C.clone().primaryKeys().then(function(Fe){function Be(qe){var Ye=Math.min(ne,Fe.length-qe),et=Fe.slice(qe,qe+Ye);return(Ee?Promise.resolve([]):Y.getMany({trans:L,keys:et,cache:"immutable"})).then(function(vt){var xt=[],Je=[],bt=se?[]:null,_t=Ee?et:[];if(!Ee)for(var yt=0;yt<Ye;++yt){var Mt=vt[yt],lr={value:U(Mt),primKey:Fe[qe+yt]};q.call(lr,lr.value,lr)!==!1&&(lr.value==null?_t.push(Fe[qe+yt]):se||Er(W(Mt),W(lr.value))===0?(Je.push(lr.value),se&&bt.push(Fe[qe+yt])):(_t.push(Fe[qe+yt]),xt.push(lr.value)))}return Promise.resolve(0<xt.length&&Y.mutate({trans:L,type:"add",values:xt}).then(function(vr){for(var hr in vr.failures)_t.splice(parseInt(hr),1);ye(xt.length,vr)})).then(function(){return(0<Je.length||Pe&&typeof w=="object")&&Y.mutate({trans:L,type:"put",keys:bt,values:Je,criteria:Pe,changeSpec:typeof w!="function"&&w,isAdditionalChunk:0<qe}).then(function(vr){return ye(Je.length,vr)})}).then(function(){return(0<_t.length||Pe&&Ee)&&Y.mutate({trans:L,type:"delete",keys:_t,criteria:Pe,isAdditionalChunk:0<qe}).then(function(vr){return Fo(O.table,_t,vr)}).then(function(vr){return ye(_t.length,vr)})}).then(function(){return Fe.length>qe+Ye&&Be(qe+ne)})})}var Pe=ds(O)&&O.limit===1/0&&(typeof w!="function"||Ee)&&{index:O.index,range:O.range};return Be(0).then(function(){if(0<he.length)throw new ke("Error modifying one or more objects",he,Te,Ae);return Fe.length})})})},Tr.prototype.delete=function(){var w=this._ctx,C=w.range;return!ds(w)||w.table.schema.yProps||!w.isPrimKey&&C.type!==3?this.modify(zc):this._write(function(O){var L=w.table.core.schema.primaryKey,q=C;return w.table.core.count({trans:O,query:{index:L,range:q}}).then(function(Y){return w.table.core.mutate({trans:O,type:"deleteRange",range:q}).then(function(ne){var W=ne.failures,ne=ne.numFailures;if(ne)throw new ke("Could not delete some values",Object.keys(W).map(function(J){return W[J]}),Y-ne);return Y-ne})})})},Tr);function Tr(){}var zc=function(w,C){return C.value=null};function Gc(w,C){return w<C?-1:w===C?0:1}function qc(w,C){return C<w?-1:w===C?0:1}function ri(w,C,O){return w=w instanceof Rl?new w.Collection(w):w,w._ctx.error=new(O||TypeError)(C),w}function ms(w){return new w.Collection(w,function(){return Hc("")}).limit(0)}function Tu(w,C,O,L){var q,Y,se,W,ne,J,ye,he=O.length;if(!O.every(function(Ee){return typeof Ee=="string"}))return ri(w,Tn);function Te(Ee){q=Ee==="next"?function(Be){return Be.toUpperCase()}:function(Be){return Be.toLowerCase()},Y=Ee==="next"?function(Be){return Be.toLowerCase()}:function(Be){return Be.toUpperCase()},se=Ee==="next"?Gc:qc;var Fe=O.map(function(Be){return{lower:Y(Be),upper:q(Be)}}).sort(function(Be,Pe){return se(Be.lower,Pe.lower)});W=Fe.map(function(Be){return Be.upper}),ne=Fe.map(function(Be){return Be.lower}),ye=(J=Ee)==="next"?"":L}Te("next"),w=new w.Collection(w,function(){return ka(W[0],ne[he-1]+L)}),w._ondirectionchange=function(Ee){Te(Ee)};var Ae=0;return w._addAlgorithm(function(Ee,Fe,Be){var Pe=Ee.key;if(typeof Pe!="string")return!1;var qe=Y(Pe);if(C(qe,ne,Ae))return!0;for(var Ye=null,et=Ae;et<he;++et){var vt=function(xt,Je,bt,_t,yt,Mt){for(var lr=Math.min(xt.length,_t.length),vr=-1,hr=0;hr<lr;++hr){var An=Je[hr];if(An!==_t[hr])return yt(xt[hr],bt[hr])<0?xt.substr(0,hr)+bt[hr]+bt.substr(hr+1):yt(xt[hr],_t[hr])<0?xt.substr(0,hr)+_t[hr]+bt.substr(hr+1):0<=vr?xt.substr(0,vr)+Je[vr]+bt.substr(vr+1):null;yt(xt[hr],An)<0&&(vr=hr)}return lr<_t.length&&Mt==="next"?xt+bt.substr(xt.length):lr<xt.length&&Mt==="prev"?xt.substr(0,bt.length):vr<0?null:xt.substr(0,vr)+_t[vr]+bt.substr(vr+1)}(Pe,qe,W[et],ne[et],se,J);vt===null&&Ye===null?Ae=et+1:(Ye===null||0<se(Ye,vt))&&(Ye=vt)}return Fe(Ye!==null?function(){Ee.continue(Ye+ye)}:Be),!1}),w}function ka(w,C,O,L){return{type:2,lower:w,upper:C,lowerOpen:O,upperOpen:L}}function Hc(w){return{type:1,lower:w,upper:w}}var Rl=(Object.defineProperty(_n.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),_n.prototype.between=function(w,C,O,L){O=O!==!1,L=L===!0;try{return 0<this._cmp(w,C)||this._cmp(w,C)===0&&(O||L)&&(!O||!L)?ms(this):new this.Collection(this,function(){return ka(w,C,!O,!L)})}catch{return ri(this,ir)}},_n.prototype.equals=function(w){return w==null?ri(this,ir):new this.Collection(this,function(){return Hc(w)})},_n.prototype.above=function(w){return w==null?ri(this,ir):new this.Collection(this,function(){return ka(w,void 0,!0)})},_n.prototype.aboveOrEqual=function(w){return w==null?ri(this,ir):new this.Collection(this,function(){return ka(w,void 0,!1)})},_n.prototype.below=function(w){return w==null?ri(this,ir):new this.Collection(this,function(){return ka(void 0,w,!1,!0)})},_n.prototype.belowOrEqual=function(w){return w==null?ri(this,ir):new this.Collection(this,function(){return ka(void 0,w)})},_n.prototype.startsWith=function(w){return typeof w!="string"?ri(this,Tn):this.between(w,w+di,!0,!0)},_n.prototype.startsWithIgnoreCase=function(w){return w===""?this.startsWith(w):Tu(this,function(C,O){return C.indexOf(O[0])===0},[w],di)},_n.prototype.equalsIgnoreCase=function(w){return Tu(this,function(C,O){return C===O[0]},[w],"")},_n.prototype.anyOfIgnoreCase=function(){var w=z.apply(Z,arguments);return w.length===0?ms(this):Tu(this,function(C,O){return O.indexOf(C)!==-1},w,"")},_n.prototype.startsWithAnyOfIgnoreCase=function(){var w=z.apply(Z,arguments);return w.length===0?ms(this):Tu(this,function(C,O){return O.some(function(L){return C.indexOf(L)===0})},w,di)},_n.prototype.anyOf=function(){var w=this,C=z.apply(Z,arguments),O=this._cmp;try{C.sort(O)}catch{return ri(this,ir)}if(C.length===0)return ms(this);var L=new this.Collection(this,function(){return ka(C[0],C[C.length-1])});L._ondirectionchange=function(Y){O=Y==="next"?w._ascending:w._descending,C.sort(O)};var q=0;return L._addAlgorithm(function(Y,se,W){for(var ne=Y.key;0<O(ne,C[q]);)if(++q===C.length)return se(W),!1;return O(ne,C[q])===0||(se(function(){Y.continue(C[q])}),!1)}),L},_n.prototype.notEqual=function(w){return this.inAnyRange([[-1/0,w],[w,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},_n.prototype.noneOf=function(){var w=z.apply(Z,arguments);if(w.length===0)return new this.Collection(this);try{w.sort(this._ascending)}catch{return ri(this,ir)}var C=w.reduce(function(O,L){return O?O.concat([[O[O.length-1][1],L]]):[[-1/0,L]]},null);return C.push([w[w.length-1],this.db._maxKey]),this.inAnyRange(C,{includeLowers:!1,includeUppers:!1})},_n.prototype.inAnyRange=function(Pe,C){var O=this,L=this._cmp,q=this._ascending,Y=this._descending,se=this._min,W=this._max;if(Pe.length===0)return ms(this);if(!Pe.every(function(qe){return qe[0]!==void 0&&qe[1]!==void 0&&q(qe[0],qe[1])<=0}))return ri(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",K.InvalidArgument);var ne=!C||C.includeLowers!==!1,J=C&&C.includeUppers===!0,ye,he=q;function Te(qe,Ye){return he(qe[0],Ye[0])}try{(ye=Pe.reduce(function(qe,Ye){for(var et=0,vt=qe.length;et<vt;++et){var xt=qe[et];if(L(Ye[0],xt[1])<0&&0<L(Ye[1],xt[0])){xt[0]=se(xt[0],Ye[0]),xt[1]=W(xt[1],Ye[1]);break}}return et===vt&&qe.push(Ye),qe},[])).sort(Te)}catch{return ri(this,ir)}var Ae=0,Ee=J?function(qe){return 0<q(qe,ye[Ae][1])}:function(qe){return 0<=q(qe,ye[Ae][1])},Fe=ne?function(qe){return 0<Y(qe,ye[Ae][0])}:function(qe){return 0<=Y(qe,ye[Ae][0])},Be=Ee,Pe=new this.Collection(this,function(){return ka(ye[0][0],ye[ye.length-1][1],!ne,!J)});return Pe._ondirectionchange=function(qe){he=qe==="next"?(Be=Ee,q):(Be=Fe,Y),ye.sort(Te)},Pe._addAlgorithm(function(qe,Ye,et){for(var vt,xt=qe.key;Be(xt);)if(++Ae===ye.length)return Ye(et),!1;return!Ee(vt=xt)&&!Fe(vt)||(O._cmp(xt,ye[Ae][1])===0||O._cmp(xt,ye[Ae][0])===0||Ye(function(){he===q?qe.continue(ye[Ae][0]):qe.continue(ye[Ae][1])}),!1)}),Pe},_n.prototype.startsWithAnyOf=function(){var w=z.apply(Z,arguments);return w.every(function(C){return typeof C=="string"})?w.length===0?ms(this):this.inAnyRange(w.map(function(C){return[C,C+di]})):ri(this,"startsWithAnyOf() only works with strings")},_n);function _n(){}function na(w){return Xr(function(C){return Po(C),w(C.target.error),!1})}function Po(w){w.stopPropagation&&w.stopPropagation(),w.preventDefault&&w.preventDefault()}var $o="storagemutated",ko="x-storagemutated-1",La=Js(null,$o),Bh=(ia.prototype._lock=function(){return A(!R.global),++this._reculock,this._reculock!==1||R.global||(R.lockOwnerFor=this),this},ia.prototype._unlock=function(){if(A(!R.global),--this._reculock==0)for(R.global||(R.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var w=this._blockedFuncs.shift();try{ga(w[1],w[0])}catch{}}return this},ia.prototype._locked=function(){return this._reculock&&R.lockOwnerFor!==this},ia.prototype.create=function(w){var C=this;if(!this.mode)return this;var O=this.db.idbdb,L=this.db._state.dbOpenError;if(A(!this.idbtrans),!w&&!O)switch(L&&L.name){case"DatabaseClosedError":throw new K.DatabaseClosed(L);case"MissingAPIError":throw new K.MissingAPI(L.message,L);default:throw new K.OpenFailed(L)}if(!this.active)throw new K.TransactionInactive;return A(this._completion._state===null),(w=this.idbtrans=w||(this.db.core||O).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Xr(function(q){Po(q),C._reject(w.error)}),w.onabort=Xr(function(q){Po(q),C.active&&C._reject(new K.Abort(w.error)),C.active=!1,C.on("abort").fire(q)}),w.oncomplete=Xr(function(){C.active=!1,C._resolve(),"mutatedParts"in w&&La.storagemutated.fire(w.mutatedParts)}),this},ia.prototype._promise=function(w,C,O){var L=this;if(w==="readwrite"&&this.mode!=="readwrite")return jr(new K.ReadOnly("Transaction is readonly"));if(!this.active)return jr(new K.TransactionInactive);if(this._locked())return new Xe(function(Y,se){L._blockedFuncs.push([function(){L._promise(w,C,O).then(Y,se)},R])});if(O)return ea(function(){var Y=new Xe(function(se,W){L._lock();var ne=C(se,W,L);ne&&ne.then&&ne.then(se,W)});return Y.finally(function(){return L._unlock()}),Y._lib=!0,Y});var q=new Xe(function(Y,se){var W=C(Y,se,L);W&&W.then&&W.then(Y,se)});return q._lib=!0,q},ia.prototype._root=function(){return this.parent?this.parent._root():this},ia.prototype.waitFor=function(w){var C,O=this._root(),L=Xe.resolve(w);O._waitingFor?O._waitingFor=O._waitingFor.then(function(){return L}):(O._waitingFor=L,O._waitingQueue=[],C=O.idbtrans.objectStore(O.storeNames[0]),function Y(){for(++O._spinCount;O._waitingQueue.length;)O._waitingQueue.shift()();O._waitingFor&&(C.get(-1/0).onsuccess=Y)}());var q=O._waitingFor;return new Xe(function(Y,se){L.then(function(W){return O._waitingQueue.push(Xr(Y.bind(null,W)))},function(W){return O._waitingQueue.push(Xr(se.bind(null,W)))}).finally(function(){O._waitingFor===q&&(O._waitingFor=null)})})},ia.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new K.Abort))},ia.prototype.table=function(w){var C=this._memoizedTables||(this._memoizedTables={});if(f(C,w))return C[w];var O=this.schema[w];if(!O)throw new K.NotFound("Table "+w+" not part of transaction");return O=new this.db.Table(w,O,this),O.core=this.db.core.table(w),C[w]=O},ia);function ia(){}function Pl(w,C,O,L,q,Y,se,W){return{name:w,keyPath:C,unique:O,multi:L,auto:q,compound:Y,src:(O&&!se?"&":"")+(L?"*":"")+(q?"++":"")+Wc(C),type:W}}function Wc(w){return typeof w=="string"?w:w?"["+[].join.call(w,"+")+"]":""}function Wr(w,C,O){return{name:w,primKey:C,indexes:O,mappedClass:null,idxByName:(L=function(q){return[q.name,q]},O.reduce(function(q,Y,se){return se=L(Y,se),se&&(q[se[0]]=se[1]),q},{}))};var L}var Ur=function(w){try{return w.only([[]]),Ur=function(){return[[]]},[[]]}catch{return Ur=function(){return di},di}};function $l(w){return w==null?function(){}:typeof w=="string"?(C=w).split(".").length===1?function(O){return O[C]}:function(O){return _(O,C)}:function(O){return _(O,w)};var C}function Vc(w){return[].slice.call(w)}var Rh=0;function Lo(w){return w==null?":id":typeof w=="string"?w:"[".concat(w.join("+"),"]")}function Ph(w,C,ne){function L(Be){if(Be.type===3)return null;if(Be.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Ae=Be.lower,Ee=Be.upper,Fe=Be.lowerOpen,Be=Be.upperOpen;return Ae===void 0?Ee===void 0?null:C.upperBound(Ee,!!Be):Ee===void 0?C.lowerBound(Ae,!!Fe):C.bound(Ae,Ee,!!Fe,!!Be)}function q(Te){var Ae,Ee=Te.name;return{name:Ee,schema:Te,mutate:function(Fe){var Be=Fe.trans,Pe=Fe.type,qe=Fe.keys,Ye=Fe.values,et=Fe.range;return new Promise(function(vt,xt){vt=Xr(vt);var Je=Be.objectStore(Ee),bt=Je.keyPath==null,_t=Pe==="put"||Pe==="add";if(!_t&&Pe!=="delete"&&Pe!=="deleteRange")throw new Error("Invalid operation type: "+Pe);var yt,Mt=(qe||Ye||{length:1}).length;if(qe&&Ye&&qe.length!==Ye.length)throw new Error("Given keys array must have same length as given values array.");if(Mt===0)return vt({numFailures:0,failures:{},results:[],lastResult:void 0});function lr(ai){++An,Po(ai)}var vr=[],hr=[],An=0;if(Pe==="deleteRange"){if(et.type===4)return vt({numFailures:An,failures:hr,results:[],lastResult:void 0});et.type===3?vr.push(yt=Je.clear()):vr.push(yt=Je.delete(L(et)))}else{var bt=_t?bt?[Ye,qe]:[Ye,null]:[qe,null],Jt=bt[0],Wn=bt[1];if(_t)for(var In=0;In<Mt;++In)vr.push(yt=Wn&&Wn[In]!==void 0?Je[Pe](Jt[In],Wn[In]):Je[Pe](Jt[In])),yt.onerror=lr;else for(In=0;In<Mt;++In)vr.push(yt=Je[Pe](Jt[In])),yt.onerror=lr}function Hl(ai){ai=ai.target.result,vr.forEach(function(Ha,Zc){return Ha.error!=null&&(hr[Zc]=Ha.error)}),vt({numFailures:An,failures:hr,results:Pe==="delete"?qe:vr.map(function(Ha){return Ha.result}),lastResult:ai})}yt.onerror=function(ai){lr(ai),Hl(ai)},yt.onsuccess=Hl})},getMany:function(Fe){var Be=Fe.trans,Pe=Fe.keys;return new Promise(function(qe,Ye){qe=Xr(qe);for(var et,vt=Be.objectStore(Ee),xt=Pe.length,Je=new Array(xt),bt=0,_t=0,yt=function(vr){vr=vr.target,Je[vr._pos]=vr.result,++_t===bt&&qe(Je)},Mt=na(Ye),lr=0;lr<xt;++lr)Pe[lr]!=null&&((et=vt.get(Pe[lr]))._pos=lr,et.onsuccess=yt,et.onerror=Mt,++bt);bt===0&&qe(Je)})},get:function(Fe){var Be=Fe.trans,Pe=Fe.key;return new Promise(function(qe,Ye){qe=Xr(qe);var et=Be.objectStore(Ee).get(Pe);et.onsuccess=function(vt){return qe(vt.target.result)},et.onerror=na(Ye)})},query:(Ae=J,function(Fe){return new Promise(function(Be,Pe){Be=Xr(Be);var qe,Ye,et,bt=Fe.trans,vt=Fe.values,xt=Fe.limit,yt=Fe.query,Je=xt===1/0?void 0:xt,_t=yt.index,yt=yt.range,bt=bt.objectStore(Ee),_t=_t.isPrimaryKey?bt:bt.index(_t.name),yt=L(yt);if(xt===0)return Be({result:[]});Ae?((Je=vt?_t.getAll(yt,Je):_t.getAllKeys(yt,Je)).onsuccess=function(Mt){return Be({result:Mt.target.result})},Je.onerror=na(Pe)):(qe=0,Ye=!vt&&"openKeyCursor"in _t?_t.openKeyCursor(yt):_t.openCursor(yt),et=[],Ye.onsuccess=function(Mt){var lr=Ye.result;return lr?(et.push(vt?lr.value:lr.primaryKey),++qe===xt?Be({result:et}):void lr.continue()):Be({result:et})},Ye.onerror=na(Pe))})}),openCursor:function(Fe){var Be=Fe.trans,Pe=Fe.values,qe=Fe.query,Ye=Fe.reverse,et=Fe.unique;return new Promise(function(vt,xt){vt=Xr(vt);var _t=qe.index,Je=qe.range,bt=Be.objectStore(Ee),bt=_t.isPrimaryKey?bt:bt.index(_t.name),_t=Ye?et?"prevunique":"prev":et?"nextunique":"next",yt=!Pe&&"openKeyCursor"in bt?bt.openKeyCursor(L(Je),_t):bt.openCursor(L(Je),_t);yt.onerror=na(xt),yt.onsuccess=Xr(function(Mt){var lr,vr,hr,An,Jt=yt.result;Jt?(Jt.___id=++Rh,Jt.done=!1,lr=Jt.continue.bind(Jt),vr=(vr=Jt.continuePrimaryKey)&&vr.bind(Jt),hr=Jt.advance.bind(Jt),An=function(){throw new Error("Cursor not stopped")},Jt.trans=Be,Jt.stop=Jt.continue=Jt.continuePrimaryKey=Jt.advance=function(){throw new Error("Cursor not started")},Jt.fail=Xr(xt),Jt.next=function(){var Wn=this,In=1;return this.start(function(){return In--?Wn.continue():Wn.stop()}).then(function(){return Wn})},Jt.start=function(Wn){function In(){if(yt.result)try{Wn()}catch(ai){Jt.fail(ai)}else Jt.done=!0,Jt.start=function(){throw new Error("Cursor behind last entry")},Jt.stop()}var Hl=new Promise(function(ai,Ha){ai=Xr(ai),yt.onerror=na(Ha),Jt.fail=Ha,Jt.stop=function(Zc){Jt.stop=Jt.continue=Jt.continuePrimaryKey=Jt.advance=An,ai(Zc)}});return yt.onsuccess=Xr(function(ai){yt.onsuccess=In,In()}),Jt.continue=lr,Jt.continuePrimaryKey=vr,Jt.advance=hr,In(),Hl},vt(Jt)):vt(null)},xt)})},count:function(Fe){var Be=Fe.query,Pe=Fe.trans,qe=Be.index,Ye=Be.range;return new Promise(function(et,vt){var xt=Pe.objectStore(Ee),Je=qe.isPrimaryKey?xt:xt.index(qe.name),xt=L(Ye),Je=xt?Je.count(xt):Je.count();Je.onsuccess=Xr(function(bt){return et(bt.target.result)}),Je.onerror=na(vt)})}}}var Y,se,W,ye=(se=ne,W=Vc((Y=w).objectStoreNames),{schema:{name:Y.name,tables:W.map(function(Te){return se.objectStore(Te)}).map(function(Te){var Ae=Te.keyPath,Be=Te.autoIncrement,Ee=o(Ae),Fe={},Be={name:Te.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Ae==null,compound:Ee,keyPath:Ae,autoIncrement:Be,unique:!0,extractKey:$l(Ae)},indexes:Vc(Te.indexNames).map(function(Pe){return Te.index(Pe)}).map(function(et){var qe=et.name,Ye=et.unique,vt=et.multiEntry,et=et.keyPath,vt={name:qe,compound:o(et),keyPath:et,unique:Ye,multiEntry:vt,extractKey:$l(et)};return Fe[Lo(et)]=vt}),getIndexByKeyPath:function(Pe){return Fe[Lo(Pe)]}};return Fe[":id"]=Be.primaryKey,Ae!=null&&(Fe[Lo(Ae)]=Be.primaryKey),Be})},hasGetAll:0<W.length&&"getAll"in se.objectStore(W[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),ne=ye.schema,J=ye.hasGetAll,ye=ne.tables.map(q),he={};return ye.forEach(function(Te){return he[Te.name]=Te}),{stack:"dbcore",transaction:w.transaction.bind(w),table:function(Te){if(!he[Te])throw new Error("Table '".concat(Te,"' not found"));return he[Te]},MIN_KEY:-1/0,MAX_KEY:Ur(C),schema:ne}}function $h(w,C,O,L){var q=O.IDBKeyRange;return O.indexedDB,{dbcore:(L=Ph(C,q,L),w.dbcore.reduce(function(Y,se){return se=se.create,n(n({},Y),se(Y))},L))}}function te(w,L){var O=L.db,L=$h(w._middlewares,O,w._deps,L);w.core=L.dbcore,w.tables.forEach(function(q){var Y=q.name;w.core.schema.tables.some(function(se){return se.name===Y})&&(q.core=w.core.table(Y),w[Y]instanceof w.Table&&(w[Y].core=q.core))})}function Dr(w,C,O,L){O.forEach(function(q){var Y=L[q];C.forEach(function(se){var W=function ne(J,ye){return y(J,ye)||(J=u(J))&&ne(J,ye)}(se,q);(!W||"value"in W&&W.value===void 0)&&(se===w.Transaction.prototype||se instanceof w.Transaction?m(se,q,{get:function(){return this.table(q)},set:function(ne){p(this,q,{value:ne,writable:!0,configurable:!0,enumerable:!0})}}):se[q]=new w.Table(q,Y))})})}function hn(w,C){C.forEach(function(O){for(var L in O)O[L]instanceof w.Table&&delete O[L]})}function Di(w,C){return w._cfg.version-C._cfg.version}function ba(w,C,O,L){var q=w._dbSchema;O.objectStoreNames.contains("$meta")&&!q.$meta&&(q.$meta=Wr("$meta",Go("")[0],[]),w._storeNames.push("$meta"));var Y=w._createTransaction("readwrite",w._storeNames,q);Y.create(O),Y._completion.catch(L);var se=Y._reject.bind(Y),W=R.transless||R;ea(function(){return R.trans=Y,R.transless=W,C!==0?(te(w,O),J=C,((ne=Y).storeNames.includes("$meta")?ne.table("$meta").get("version").then(function(ye){return ye??J}):Xe.resolve(J)).then(function(ye){return Te=ye,Ae=Y,Ee=O,Fe=[],ye=(he=w)._versions,Be=he._dbSchema=Uo(0,he.idbdb,Ee),(ye=ye.filter(function(Pe){return Pe._cfg.version>=Te})).length!==0?(ye.forEach(function(Pe){Fe.push(function(){var qe=Be,Ye=Pe._cfg.dbschema;zo(he,qe,Ee),zo(he,Ye,Ee),Be=he._dbSchema=Ye;var et=Ua(qe,Ye);et.add.forEach(function(_t){Nn(Ee,_t[0],_t[1].primKey,_t[1].indexes)}),et.change.forEach(function(_t){if(_t.recreate)throw new K.Upgrade("Not yet support for changing primary key");var yt=Ee.objectStore(_t.name);_t.add.forEach(function(Mt){return Ci(yt,Mt)}),_t.change.forEach(function(Mt){yt.deleteIndex(Mt.name),Ci(yt,Mt)}),_t.del.forEach(function(Mt){return yt.deleteIndex(Mt)})});var vt=Pe._cfg.contentUpgrade;if(vt&&Pe._cfg.version>Te){te(he,Ee),Ae._memoizedTables={};var xt=M(Ye);et.del.forEach(function(_t){xt[_t]=qe[_t]}),hn(he,[he.Transaction.prototype]),Dr(he,[he.Transaction.prototype],s(xt),xt),Ae.schema=xt;var Je,bt=me(vt);return bt&&Ba(),et=Xe.follow(function(){var _t;(Je=vt(Ae))&&bt&&(_t=hi.bind(null,null),Je.then(_t,_t))}),Je&&typeof Je.then=="function"?Xe.resolve(Je):et.then(function(){return Je})}}),Fe.push(function(qe){var Ye,et,vt=Pe._cfg.dbschema;Ye=vt,et=qe,[].slice.call(et.db.objectStoreNames).forEach(function(xt){return Ye[xt]==null&&et.db.deleteObjectStore(xt)}),hn(he,[he.Transaction.prototype]),Dr(he,[he.Transaction.prototype],he._storeNames,he._dbSchema),Ae.schema=he._dbSchema}),Fe.push(function(qe){he.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(he.idbdb.version/10)===Pe._cfg.version?(he.idbdb.deleteObjectStore("$meta"),delete he._dbSchema.$meta,he._storeNames=he._storeNames.filter(function(Ye){return Ye!=="$meta"})):qe.objectStore("$meta").put(Pe._cfg.version,"version"))})}),function Pe(){return Fe.length?Xe.resolve(Fe.shift()(Ae.idbtrans)).then(Pe):Xe.resolve()}().then(function(){Rt(Be,Ee)})):Xe.resolve();var he,Te,Ae,Ee,Fe,Be}).catch(se)):(s(q).forEach(function(ye){Nn(O,ye,q[ye].primKey,q[ye].indexes)}),te(w,O),void Xe.follow(function(){return w.on.populate.fire(Y)}).catch(se));var ne,J})}function ot(w,C){Rt(w._dbSchema,C),C.db.version%10!=0||C.objectStoreNames.contains("$meta")||C.db.createObjectStore("$meta").add(Math.ceil(C.db.version/10-1),"version");var O=Uo(0,w.idbdb,C);zo(w,w._dbSchema,C);for(var L=0,q=Ua(O,w._dbSchema).change;L<q.length;L++){var Y=function(se){if(se.change.length||se.recreate)return console.warn("Unable to patch indexes of table ".concat(se.name," because it has changes on the type of index or primary key.")),{value:void 0};var W=C.objectStore(se.name);se.add.forEach(function(ne){je&&console.debug("Dexie upgrade patch: Creating missing index ".concat(se.name,".").concat(ne.src)),Ci(W,ne)})}(q[L]);if(typeof Y=="object")return Y.value}}function Ua(w,C){var O,L={del:[],add:[],change:[]};for(O in w)C[O]||L.del.push(O);for(O in C){var q=w[O],Y=C[O];if(q){var se={name:O,def:Y,recreate:!1,del:[],add:[],change:[]};if(""+(q.primKey.keyPath||"")!=""+(Y.primKey.keyPath||"")||q.primKey.auto!==Y.primKey.auto)se.recreate=!0,L.change.push(se);else{var W=q.idxByName,ne=Y.idxByName,J=void 0;for(J in W)ne[J]||se.del.push(J);for(J in ne){var ye=W[J],he=ne[J];ye?ye.src!==he.src&&se.change.push(he):se.add.push(he)}(0<se.del.length||0<se.add.length||0<se.change.length)&&L.change.push(se)}}else L.add.push([O,Y])}return L}function Nn(w,C,O,L){var q=w.db.createObjectStore(C,O.keyPath?{keyPath:O.keyPath,autoIncrement:O.auto}:{autoIncrement:O.auto});return L.forEach(function(Y){return Ci(q,Y)}),q}function Rt(w,C){s(w).forEach(function(O){C.db.objectStoreNames.contains(O)||(je&&console.debug("Dexie: Creating missing table",O),Nn(C,O,w[O].primKey,w[O].indexes))})}function Ci(w,C){w.createIndex(C.name,C.keyPath,{unique:C.unique,multiEntry:C.multi})}function Uo(w,C,O){var L={};return S(C.objectStoreNames,0).forEach(function(q){for(var Y=O.objectStore(q),se=Pl(Wc(J=Y.keyPath),J||"",!0,!1,!!Y.autoIncrement,J&&typeof J!="string",!0),W=[],ne=0;ne<Y.indexNames.length;++ne){var ye=Y.index(Y.indexNames[ne]),J=ye.keyPath,ye=Pl(ye.name,J,!!ye.unique,!!ye.multiEntry,!1,J&&typeof J!="string",!1);W.push(ye)}L[q]=Wr(q,se,W)}),L}function zo(w,C,O){for(var L=O.db.objectStoreNames,q=0;q<L.length;++q){var Y=L[q],se=O.objectStore(Y);w._hasGetAll="getAll"in se;for(var W=0;W<se.indexNames.length;++W){var ne=se.indexNames[W],J=se.index(ne).keyPath,ye=typeof J=="string"?J:"["+S(J).join("+")+"]";!C[Y]||(J=C[Y].idxByName[ye])&&(J.name=ne,delete C[Y].idxByName[ye],C[Y].idxByName[ne]=J)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(w._hasGetAll=!1)}function Go(w){return w.split(",").map(function(C,O){var Y=C.split(":"),L=(q=Y[1])===null||q===void 0?void 0:q.trim(),q=(C=Y[0].trim()).replace(/([&*]|\+\+)/g,""),Y=/^\[/.test(q)?q.match(/^\[(.*)\]$/)[1].split("+"):q;return Pl(q,Y||null,/\&/.test(C),/\*/.test(C),/\+\+/.test(C),o(Y),O===0,L)})}var kl=(gn.prototype._createTableSchema=Wr,gn.prototype._parseIndexSyntax=Go,gn.prototype._parseStoresSpec=function(w,C){var O=this;s(w).forEach(function(L){if(w[L]!==null){var q=O._parseIndexSyntax(w[L]),Y=q.shift();if(!Y)throw new K.Schema("Invalid schema for table "+L+": "+w[L]);if(Y.unique=!0,Y.multi)throw new K.Schema("Primary key cannot be multiEntry*");q.forEach(function(se){if(se.auto)throw new K.Schema("Only primary key can be marked as autoIncrement (++)");if(!se.keyPath)throw new K.Schema("Index must have a name and cannot be an empty string")}),q=O._createTableSchema(L,Y,q),C[L]=q}})},gn.prototype.stores=function(O){var C=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,O):O;var O=C._versions,L={},q={};return O.forEach(function(Y){l(L,Y._cfg.storesSource),q=Y._cfg.dbschema={},Y._parseStoresSpec(L,q)}),C._dbSchema=q,hn(C,[C._allTables,C,C.Transaction.prototype]),Dr(C,[C._allTables,C,C.Transaction.prototype,this._cfg.tables],s(q),q),C._storeNames=s(q),this},gn.prototype.upgrade=function(w){return this._cfg.contentUpgrade=Ve(this._cfg.contentUpgrade||be,w),this},gn);function gn(){}function ct(w,C){var O=w._dbNamesDB;return O||(O=w._dbNamesDB=new ve(ya,{addons:[],indexedDB:w,IDBKeyRange:C})).version(1).stores({dbnames:"name"}),O.table("dbnames")}function ni(w){return w&&typeof w.databases=="function"}function Nu(w){return ea(function(){return R.letThrough=!0,w()})}function Mu(w){return!("from"in w)}var un=function(w,C){if(!this){var O=new un;return w&&"d"in w&&l(O,w),O}l(this,arguments.length?{d:1,from:w,to:1<arguments.length?C:w}:{d:0})};function za(w,C,O){var L=Er(C,O);if(!isNaN(L)){if(0<L)throw RangeError();if(Mu(w))return l(w,{from:C,to:O,d:1});var q=w.l,L=w.r;if(Er(O,w.from)<0)return q?za(q,C,O):w.l={from:C,to:O,d:1,l:null,r:null},Iu(w);if(0<Er(C,w.to))return L?za(L,C,O):w.r={from:C,to:O,d:1,l:null,r:null},Iu(w);Er(C,w.from)<0&&(w.from=C,w.l=null,w.d=L?L.d+1:1),0<Er(O,w.to)&&(w.to=O,w.r=null,w.d=w.l?w.l.d+1:1),O=!w.r,q&&!w.l&&vs(w,q),L&&O&&vs(w,L)}}function vs(w,C){Mu(C)||function O(L,ne){var Y=ne.from,se=ne.to,W=ne.l,ne=ne.r;za(L,Y,se),W&&O(L,W),ne&&O(L,ne)}(w,C)}function Qr(w,C){var O=ii(C),L=O.next();if(L.done)return!1;for(var q=L.value,Y=ii(w),se=Y.next(q.from),W=se.value;!L.done&&!se.done;){if(Er(W.from,q.to)<=0&&0<=Er(W.to,q.from))return!0;Er(q.from,W.from)<0?q=(L=O.next(W.from)).value:W=(se=Y.next(q.from)).value}return!1}function ii(w){var C=Mu(w)?null:{s:0,n:w};return{next:function(O){for(var L=0<arguments.length;C;)switch(C.s){case 0:if(C.s=1,L)for(;C.n.l&&Er(O,C.n.from)<0;)C={up:C,n:C.n.l,s:1};else for(;C.n.l;)C={up:C,n:C.n.l,s:1};case 1:if(C.s=2,!L||Er(O,C.n.to)<=0)return{value:C.n,done:!1};case 2:if(C.n.r){C.s=3,C={up:C,n:C.n.r,s:0};continue}case 3:C=C.up}return{done:!0}}}}function Iu(w){var C,O,L=(((C=w.r)===null||C===void 0?void 0:C.d)||0)-(((O=w.l)===null||O===void 0?void 0:O.d)||0),q=1<L?"r":L<-1?"l":"";q&&(C=q=="r"?"l":"r",O=n({},w),L=w[q],w.from=L.from,w.to=L.to,w[q]=L[q],O[q]=L[C],(w[C]=O).d=Xc(O)),w.d=Xc(w)}function Xc(O){var C=O.r,O=O.l;return(C?O?Math.max(C.d,O.d):C.d:O?O.d:0)+1}function ro(w,C){return s(C).forEach(function(O){w[O]?vs(w[O],C[O]):w[O]=function L(q){var Y,se,W={};for(Y in q)f(q,Y)&&(se=q[Y],W[Y]=!se||typeof se!="object"||F.has(se.constructor)?se:L(se));return W}(C[O])}),w}function Ll(w,C){return w.all||C.all||Object.keys(w).some(function(O){return C[O]&&Qr(C[O],w[O])})}h(un.prototype,((tt={add:function(w){return vs(this,w),this},addKey:function(w){return za(this,w,w),this},addKeys:function(w){var C=this;return w.forEach(function(O){return za(C,O,O)}),this},hasKey:function(w){var C=ii(this).next(w).value;return C&&Er(C.from,w)<=0&&0<=Er(C.to,w)}})[$]=function(){return ii(this)},tt));var gs={},Ul={},Fu=!1;function ys(w){ro(Ul,w),Fu||(Fu=!0,setTimeout(function(){Fu=!1,Ga(Ul,!(Ul={}))},0))}function Ga(w,C){C===void 0&&(C=!1);var O=new Set;if(w.all)for(var L=0,q=Object.values(gs);L<q.length;L++)jc(se=q[L],w,O,C);else for(var Y in w){var se,W=/^idb\:\/\/(.*)\/(.*)\//.exec(Y);W&&(Y=W[1],W=W[2],(se=gs["idb://".concat(Y,"/").concat(W)])&&jc(se,w,O,C))}O.forEach(function(ne){return ne()})}function jc(w,C,O,L){for(var q=[],Y=0,se=Object.entries(w.queries.query);Y<se.length;Y++){for(var W=se[Y],ne=W[0],J=[],ye=0,he=W[1];ye<he.length;ye++){var Te=he[ye];Ll(C,Te.obsSet)?Te.subscribers.forEach(function(Be){return O.add(Be)}):L&&J.push(Te)}L&&q.push([ne,J])}if(L)for(var Ae=0,Ee=q;Ae<Ee.length;Ae++){var Fe=Ee[Ae],ne=Fe[0],J=Fe[1];w.queries.query[ne]=J}}function Yc(w){var C=w._state,O=w._deps.indexedDB;if(C.isBeingOpened||w.idbdb)return C.dbReadyPromise.then(function(){return C.dbOpenError?jr(C.dbOpenError):w});C.isBeingOpened=!0,C.dbOpenError=null,C.openComplete=!1;var L=C.openCanceller,q=Math.round(10*w.verno),Y=!1;function se(){if(C.openCanceller!==L)throw new K.DatabaseClosed("db.open() was cancelled")}function W(){return new Xe(function(Te,Ae){if(se(),!O)throw new K.MissingAPI;var Ee=w.name,Fe=C.autoSchema||!q?O.open(Ee):O.open(Ee,q);if(!Fe)throw new K.MissingAPI;Fe.onerror=na(Ae),Fe.onblocked=Xr(w._fireOnBlocked),Fe.onupgradeneeded=Xr(function(Be){var Pe;ye=Fe.transaction,C.autoSchema&&!w._options.allowEmptyDB?(Fe.onerror=Po,ye.abort(),Fe.result.close(),(Pe=O.deleteDatabase(Ee)).onsuccess=Pe.onerror=Xr(function(){Ae(new K.NoSuchDatabase("Database ".concat(Ee," doesnt exist")))})):(ye.onerror=na(Ae),Be=Be.oldVersion>Math.pow(2,62)?0:Be.oldVersion,he=Be<1,w.idbdb=Fe.result,Y&&ot(w,ye),ba(w,Be/10,ye,Ae))},Ae),Fe.onsuccess=Xr(function(){ye=null;var Be,Pe,qe,Ye,et,vt=w.idbdb=Fe.result,xt=S(vt.objectStoreNames);if(0<xt.length)try{var Je=vt.transaction((Ye=xt).length===1?Ye[0]:Ye,"readonly");if(C.autoSchema)Pe=vt,qe=Je,(Be=w).verno=Pe.version/10,qe=Be._dbSchema=Uo(0,Pe,qe),Be._storeNames=S(Pe.objectStoreNames,0),Dr(Be,[Be._allTables],s(qe),qe);else if(zo(w,w._dbSchema,Je),((et=Ua(Uo(0,(et=w).idbdb,Je),et._dbSchema)).add.length||et.change.some(function(bt){return bt.add.length||bt.change.length}))&&!Y)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),vt.close(),q=vt.version+1,Y=!0,Te(W());te(w,Je)}catch{}Ra.push(w),vt.onversionchange=Xr(function(bt){C.vcFired=!0,w.on("versionchange").fire(bt)}),vt.onclose=Xr(function(){w.close({disableAutoOpen:!1})}),he&&(et=w._deps,Je=Ee,vt=et.indexedDB,et=et.IDBKeyRange,ni(vt)||Je===ya||ct(vt,et).put({name:Je}).catch(be)),Te()},Ae)}).catch(function(Te){switch(Te==null?void 0:Te.name){case"UnknownError":if(0<C.PR1398_maxLoop)return C.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),W();break;case"VersionError":if(0<q)return q=0,W()}return Xe.reject(Te)})}var ne,J=C.dbReadyResolve,ye=null,he=!1;return Xe.race([L,(typeof navigator>"u"?Xe.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Te){function Ae(){return indexedDB.databases().finally(Te)}ne=setInterval(Ae,100),Ae()}).finally(function(){return clearInterval(ne)}):Promise.resolve()).then(W)]).then(function(){return se(),C.onReadyBeingFired=[],Xe.resolve(Nu(function(){return w.on.ready.fire(w.vip)})).then(function Te(){if(0<C.onReadyBeingFired.length){var Ae=C.onReadyBeingFired.reduce(Ve,be);return C.onReadyBeingFired=[],Xe.resolve(Nu(function(){return Ae(w.vip)})).then(Te)}})}).finally(function(){C.openCanceller===L&&(C.onReadyBeingFired=null,C.isBeingOpened=!1)}).catch(function(Te){C.dbOpenError=Te;try{ye&&ye.abort()}catch{}return L===C.openCanceller&&w._close(),jr(Te)}).finally(function(){C.openComplete=!0,J()}).then(function(){var Te;return he&&(Te={},w.tables.forEach(function(Ae){Ae.schema.indexes.forEach(function(Ee){Ee.name&&(Te["idb://".concat(w.name,"/").concat(Ae.name,"/").concat(Ee.name)]=new un(-1/0,[[[]]]))}),Te["idb://".concat(w.name,"/").concat(Ae.name,"/")]=Te["idb://".concat(w.name,"/").concat(Ae.name,"/:dels")]=new un(-1/0,[[[]]])}),La($o).fire(Te),Ga(Te,!0)),w})}function Ou(w){function C(Y){return w.next(Y)}var O=q(C),L=q(function(Y){return w.throw(Y)});function q(Y){return function(ne){var W=Y(ne),ne=W.value;return W.done?ne:ne&&typeof ne.then=="function"?ne.then(O,L):o(ne)?Promise.all(ne).then(O,L):O(ne)}}return q(C)()}function Ti(w,C,O){for(var L=o(w)?w.slice():[w],q=0;q<O;++q)L.push(C);return L}var zl={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(w){return n(n({},w),{table:function(C){var O=w.table(C),L=O.schema,q={},Y=[];function se(he,Te,Ae){var Ee=Lo(he),Fe=q[Ee]=q[Ee]||[],Be=he==null?0:typeof he=="string"?1:he.length,Pe=0<Te,Pe=n(n({},Ae),{name:Pe?"".concat(Ee,"(virtual-from:").concat(Ae.name,")"):Ae.name,lowLevelIndex:Ae,isVirtual:Pe,keyTail:Te,keyLength:Be,extractKey:$l(he),unique:!Pe&&Ae.unique});return Fe.push(Pe),Pe.isPrimaryKey||Y.push(Pe),1<Be&&se(Be===2?he[0]:he.slice(0,Be-1),Te+1,Ae),Fe.sort(function(qe,Ye){return qe.keyTail-Ye.keyTail}),Pe}C=se(L.primaryKey.keyPath,0,L.primaryKey),q[":id"]=[C];for(var W=0,ne=L.indexes;W<ne.length;W++){var J=ne[W];se(J.keyPath,0,J)}function ye(he){var Te,Ae=he.query.index;return Ae.isVirtual?n(n({},he),{query:{index:Ae.lowLevelIndex,range:(Te=he.query.range,Ae=Ae.keyTail,{type:Te.type===1?2:Te.type,lower:Ti(Te.lower,Te.lowerOpen?w.MAX_KEY:w.MIN_KEY,Ae),lowerOpen:!0,upper:Ti(Te.upper,Te.upperOpen?w.MIN_KEY:w.MAX_KEY,Ae),upperOpen:!0})}}):he}return n(n({},O),{schema:n(n({},L),{primaryKey:C,indexes:Y,getIndexByKeyPath:function(he){return(he=q[Lo(he)])&&he[0]}}),count:function(he){return O.count(ye(he))},query:function(he){return O.query(ye(he))},openCursor:function(he){var Te=he.query.index,Ae=Te.keyTail,Ee=Te.isVirtual,Fe=Te.keyLength;return Ee?O.openCursor(ye(he)).then(function(Pe){return Pe&&Be(Pe)}):O.openCursor(he);function Be(Pe){return Object.create(Pe,{continue:{value:function(qe){qe!=null?Pe.continue(Ti(qe,he.reverse?w.MAX_KEY:w.MIN_KEY,Ae)):he.unique?Pe.continue(Pe.key.slice(0,Fe).concat(he.reverse?w.MIN_KEY:w.MAX_KEY,Ae)):Pe.continue()}},continuePrimaryKey:{value:function(qe,Ye){Pe.continuePrimaryKey(Ti(qe,w.MAX_KEY,Ae),Ye)}},primaryKey:{get:function(){return Pe.primaryKey}},key:{get:function(){var qe=Pe.key;return Fe===1?qe[0]:qe.slice(0,Fe)}},value:{get:function(){return Pe.value}}})}}})}})}};function bs(w,C,O,L){return O=O||{},L=L||"",s(w).forEach(function(q){var Y,se,W;f(C,q)?(Y=w[q],se=C[q],typeof Y=="object"&&typeof se=="object"&&Y&&se?(W=V(Y))!==V(se)?O[L+q]=C[q]:W==="Object"?bs(Y,se,O,L+q+"."):Y!==se&&(O[L+q]=C[q]):Y!==se&&(O[L+q]=C[q])):O[L+q]=void 0}),s(C).forEach(function(q){f(w,q)||(O[L+q]=C[q])}),O}function aa(w,C){return C.type==="delete"?C.keys:C.keys||C.values.map(w.extractKey)}var qo={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(w){return n(n({},w),{table:function(C){var O=w.table(C),L=O.schema.primaryKey;return n(n({},O),{mutate:function(q){var Y=R.trans,se=Y.table(C).hook,W=se.deleting,ne=se.creating,J=se.updating;switch(q.type){case"add":if(ne.fire===be)break;return Y._promise("readwrite",function(){return ye(q)},!0);case"put":if(ne.fire===be&&J.fire===be)break;return Y._promise("readwrite",function(){return ye(q)},!0);case"delete":if(W.fire===be)break;return Y._promise("readwrite",function(){return ye(q)},!0);case"deleteRange":if(W.fire===be)break;return Y._promise("readwrite",function(){return function he(Te,Ae,Ee){return O.query({trans:Te,values:!1,query:{index:L,range:Ae},limit:Ee}).then(function(Fe){var Be=Fe.result;return ye({type:"delete",keys:Be,trans:Te}).then(function(Pe){return 0<Pe.numFailures?Promise.reject(Pe.failures[0]):Be.length<Ee?{failures:[],numFailures:0,lastResult:void 0}:he(Te,n(n({},Ae),{lower:Be[Be.length-1],lowerOpen:!0}),Ee)})})}(q.trans,q.range,1e4)},!0)}return O.mutate(q);function ye(he){var Te,Ae,Ee,Fe=R.trans,Be=he.keys||aa(L,he);if(!Be)throw new Error("Keys missing");return(he=he.type==="add"||he.type==="put"?n(n({},he),{keys:Be}):n({},he)).type!=="delete"&&(he.values=i([],he.values)),he.keys&&(he.keys=i([],he.keys)),Te=O,Ee=Be,((Ae=he).type==="add"?Promise.resolve([]):Te.getMany({trans:Ae.trans,keys:Ee,cache:"immutable"})).then(function(Pe){var qe=Be.map(function(Ye,et){var vt,xt,Je,bt=Pe[et],_t={onerror:null,onsuccess:null};return he.type==="delete"?W.fire.call(_t,Ye,bt,Fe):he.type==="add"||bt===void 0?(vt=ne.fire.call(_t,Ye,he.values[et],Fe),Ye==null&&vt!=null&&(he.keys[et]=Ye=vt,L.outbound||T(he.values[et],L.keyPath,Ye))):(vt=bs(bt,he.values[et]),(xt=J.fire.call(_t,vt,Ye,bt,Fe))&&(Je=he.values[et],Object.keys(xt).forEach(function(yt){f(Je,yt)?Je[yt]=xt[yt]:T(Je,yt,xt[yt])}))),_t});return O.mutate(he).then(function(Ye){for(var et=Ye.failures,vt=Ye.results,xt=Ye.numFailures,Ye=Ye.lastResult,Je=0;Je<Be.length;++Je){var bt=(vt||Be)[Je],_t=qe[Je];bt==null?_t.onerror&&_t.onerror(et[Je]):_t.onsuccess&&_t.onsuccess(he.type==="put"&&Pe[Je]?he.values[Je]:bt)}return{failures:et,results:vt,numFailures:xt,lastResult:Ye}}).catch(function(Ye){return qe.forEach(function(et){return et.onerror&&et.onerror(Ye)}),Promise.reject(Ye)})})}}})}})}};function Bu(w,C,O){try{if(!C||C.keys.length<w.length)return null;for(var L=[],q=0,Y=0;q<C.keys.length&&Y<w.length;++q)Er(C.keys[q],w[Y])===0&&(L.push(O?U(C.values[q]):C.values[q]),++Y);return L.length===w.length?L:null}catch{return null}}var xs={stack:"dbcore",level:-1,create:function(w){return{table:function(C){var O=w.table(C);return n(n({},O),{getMany:function(L){if(!L.cache)return O.getMany(L);var q=Bu(L.keys,L.trans._cache,L.cache==="clone");return q?Xe.resolve(q):O.getMany(L).then(function(Y){return L.trans._cache={keys:L.keys,values:L.cache==="clone"?U(Y):Y},Y})},mutate:function(L){return L.type!=="add"&&(L.trans._cache=null),O.mutate(L)}})}}}};function Ho(w,C){return w.trans.mode==="readonly"&&!!w.subscr&&!w.trans.explicit&&w.trans.db._options.cache!=="disabled"&&!C.schema.primaryKey.outbound}function Hn(w,C){switch(w){case"query":return C.values&&!C.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var no={stack:"dbcore",level:0,name:"Observability",create:function(w){var C=w.schema.name,O=new un(w.MIN_KEY,w.MAX_KEY);return n(n({},w),{transaction:function(L,q,Y){if(R.subscr&&q!=="readonly")throw new K.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(R.querier));return w.transaction(L,q,Y)},table:function(L){var q=w.table(L),Y=q.schema,se=Y.primaryKey,he=Y.indexes,W=se.extractKey,ne=se.outbound,J=se.autoIncrement&&he.filter(function(Ae){return Ae.compound&&Ae.keyPath.includes(se.keyPath)}),ye=n(n({},q),{mutate:function(Ae){function Ee(yt){return yt="idb://".concat(C,"/").concat(L,"/").concat(yt),Ye[yt]||(Ye[yt]=new un)}var Fe,Be,Pe,qe=Ae.trans,Ye=Ae.mutatedParts||(Ae.mutatedParts={}),et=Ee(""),vt=Ee(":dels"),xt=Ae.type,_t=Ae.type==="deleteRange"?[Ae.range]:Ae.type==="delete"?[Ae.keys]:Ae.values.length<50?[aa(se,Ae).filter(function(yt){return yt}),Ae.values]:[],Je=_t[0],bt=_t[1],_t=Ae.trans._cache;return o(Je)?(et.addKeys(Je),(_t=xt==="delete"||Je.length===bt.length?Bu(Je,_t):null)||vt.addKeys(Je),(_t||bt)&&(Fe=Ee,Be=_t,Pe=bt,Y.indexes.forEach(function(yt){var Mt=Fe(yt.name||"");function lr(hr){return hr!=null?yt.extractKey(hr):null}function vr(hr){return yt.multiEntry&&o(hr)?hr.forEach(function(An){return Mt.addKey(An)}):Mt.addKey(hr)}(Be||Pe).forEach(function(hr,Wn){var Jt=Be&&lr(Be[Wn]),Wn=Pe&&lr(Pe[Wn]);Er(Jt,Wn)!==0&&(Jt!=null&&vr(Jt),Wn!=null&&vr(Wn))})}))):Je?(bt={from:(bt=Je.lower)!==null&&bt!==void 0?bt:w.MIN_KEY,to:(bt=Je.upper)!==null&&bt!==void 0?bt:w.MAX_KEY},vt.add(bt),et.add(bt)):(et.add(O),vt.add(O),Y.indexes.forEach(function(yt){return Ee(yt.name).add(O)})),q.mutate(Ae).then(function(yt){return!Je||Ae.type!=="add"&&Ae.type!=="put"||(et.addKeys(yt.results),J&&J.forEach(function(Mt){for(var lr=Ae.values.map(function(Jt){return Mt.extractKey(Jt)}),vr=Mt.keyPath.findIndex(function(Jt){return Jt===se.keyPath}),hr=0,An=yt.results.length;hr<An;++hr)lr[hr][vr]=yt.results[hr];Ee(Mt.name).addKeys(lr)})),qe.mutatedParts=ro(qe.mutatedParts||{},Ye),yt})}}),he=function(Ee){var Fe=Ee.query,Ee=Fe.index,Fe=Fe.range;return[Ee,new un((Ee=Fe.lower)!==null&&Ee!==void 0?Ee:w.MIN_KEY,(Fe=Fe.upper)!==null&&Fe!==void 0?Fe:w.MAX_KEY)]},Te={get:function(Ae){return[se,new un(Ae.key)]},getMany:function(Ae){return[se,new un().addKeys(Ae.keys)]},count:he,query:he,openCursor:he};return s(Te).forEach(function(Ae){ye[Ae]=function(Ee){var Fe=R.subscr,Be=!!Fe,Pe=Ho(R,q)&&Hn(Ae,Ee)?Ee.obsSet={}:Fe;if(Be){var qe=function(bt){return bt="idb://".concat(C,"/").concat(L,"/").concat(bt),Pe[bt]||(Pe[bt]=new un)},Ye=qe(""),et=qe(":dels"),Fe=Te[Ae](Ee),Be=Fe[0],Fe=Fe[1];if((Ae==="query"&&Be.isPrimaryKey&&!Ee.values?et:qe(Be.name||"")).add(Fe),!Be.isPrimaryKey){if(Ae!=="count"){var vt=Ae==="query"&&ne&&Ee.values&&q.query(n(n({},Ee),{values:!1}));return q[Ae].apply(this,arguments).then(function(bt){if(Ae==="query"){if(ne&&Ee.values)return vt.then(function(lr){return lr=lr.result,Ye.addKeys(lr),bt});var _t=Ee.values?bt.result.map(W):bt.result;(Ee.values?Ye:et).addKeys(_t)}else if(Ae==="openCursor"){var yt=bt,Mt=Ee.values;return yt&&Object.create(yt,{key:{get:function(){return et.addKey(yt.primaryKey),yt.key}},primaryKey:{get:function(){var lr=yt.primaryKey;return et.addKey(lr),lr}},value:{get:function(){return Mt&&Ye.addKey(yt.primaryKey),yt.value}}})}return bt})}et.add(O)}}return q[Ae].apply(this,arguments)}}),ye}})}};function ws(w,C,O){if(O.numFailures===0)return C;if(C.type==="deleteRange")return null;var L=C.keys?C.keys.length:"values"in C&&C.values?C.values.length:1;return O.numFailures===L?null:(C=n({},C),o(C.keys)&&(C.keys=C.keys.filter(function(q,Y){return!(Y in O.failures)})),"values"in C&&o(C.values)&&(C.values=C.values.filter(function(q,Y){return!(Y in O.failures)})),C)}function Ru(w,C){return O=w,((L=C).lower===void 0||(L.lowerOpen?0<Er(O,L.lower):0<=Er(O,L.lower)))&&(w=w,(C=C).upper===void 0||(C.upperOpen?Er(w,C.upper)<0:Er(w,C.upper)<=0));var O,L}function Gl(w,C,Te,L,q,Y){if(!Te||Te.length===0)return w;var se=C.query.index,W=se.multiEntry,ne=C.query.range,J=L.schema.primaryKey.extractKey,ye=se.extractKey,he=(se.lowLevelIndex||se).extractKey,Te=Te.reduce(function(Ae,Ee){var Fe=Ae,Be=[];if(Ee.type==="add"||Ee.type==="put")for(var Pe=new un,qe=Ee.values.length-1;0<=qe;--qe){var Ye,et=Ee.values[qe],vt=J(et);Pe.hasKey(vt)||(Ye=ye(et),(W&&o(Ye)?Ye.some(function(yt){return Ru(yt,ne)}):Ru(Ye,ne))&&(Pe.addKey(vt),Be.push(et)))}switch(Ee.type){case"add":var xt=new un().addKeys(C.values?Ae.map(function(Mt){return J(Mt)}):Ae),Fe=Ae.concat(C.values?Be.filter(function(Mt){return Mt=J(Mt),!xt.hasKey(Mt)&&(xt.addKey(Mt),!0)}):Be.map(function(Mt){return J(Mt)}).filter(function(Mt){return!xt.hasKey(Mt)&&(xt.addKey(Mt),!0)}));break;case"put":var Je=new un().addKeys(Ee.values.map(function(Mt){return J(Mt)}));Fe=Ae.filter(function(Mt){return!Je.hasKey(C.values?J(Mt):Mt)}).concat(C.values?Be:Be.map(function(Mt){return J(Mt)}));break;case"delete":var bt=new un().addKeys(Ee.keys);Fe=Ae.filter(function(Mt){return!bt.hasKey(C.values?J(Mt):Mt)});break;case"deleteRange":var _t=Ee.range;Fe=Ae.filter(function(Mt){return!Ru(J(Mt),_t)})}return Fe},w);return Te===w?w:(Te.sort(function(Ae,Ee){return Er(he(Ae),he(Ee))||Er(J(Ae),J(Ee))}),C.limit&&C.limit<1/0&&(Te.length>C.limit?Te.length=C.limit:w.length===C.limit&&Te.length<C.limit&&(q.dirty=!0)),Y?Object.freeze(Te):Te)}function ql(w,C){return Er(w.lower,C.lower)===0&&Er(w.upper,C.upper)===0&&!!w.lowerOpen==!!C.lowerOpen&&!!w.upperOpen==!!C.upperOpen}function Pu(w,C){return function(O,L,q,Y){if(O===void 0)return L!==void 0?-1:0;if(L===void 0)return 1;if((L=Er(O,L))===0){if(q&&Y)return 0;if(q)return 1;if(Y)return-1}return L}(w.lower,C.lower,w.lowerOpen,C.lowerOpen)<=0&&0<=function(O,L,q,Y){if(O===void 0)return L!==void 0?1:0;if(L===void 0)return-1;if((L=Er(O,L))===0){if(q&&Y)return 0;if(q)return-1;if(Y)return 1}return L}(w.upper,C.upper,w.upperOpen,C.upperOpen)}function an(w,C,O,L){w.subscribers.add(O),L.addEventListener("abort",function(){var q,Y;w.subscribers.delete(O),w.subscribers.size===0&&(q=w,Y=C,setTimeout(function(){q.subscribers.size===0&&k(Y,q)},3e3))})}var Kc={stack:"dbcore",level:0,name:"Cache",create:function(w){var C=w.schema.name;return n(n({},w),{transaction:function(O,L,q){var Y,se,W=w.transaction(O,L,q);return L==="readwrite"&&(se=(Y=new AbortController).signal,q=function(ne){return function(){if(Y.abort(),L==="readwrite"){for(var J=new Set,ye=0,he=O;ye<he.length;ye++){var Te=he[ye],Ae=gs["idb://".concat(C,"/").concat(Te)];if(Ae){var Ee=w.table(Te),Fe=Ae.optimisticOps.filter(function(Mt){return Mt.trans===W});if(W._explicit&&ne&&W.mutatedParts)for(var Be=0,Pe=Object.values(Ae.queries.query);Be<Pe.length;Be++)for(var qe=0,Ye=(xt=Pe[Be]).slice();qe<Ye.length;qe++)Ll((Je=Ye[qe]).obsSet,W.mutatedParts)&&(k(xt,Je),Je.subscribers.forEach(function(Mt){return J.add(Mt)}));else if(0<Fe.length){Ae.optimisticOps=Ae.optimisticOps.filter(function(Mt){return Mt.trans!==W});for(var et=0,vt=Object.values(Ae.queries.query);et<vt.length;et++)for(var xt,Je,bt,_t=0,yt=(xt=vt[et]).slice();_t<yt.length;_t++)(Je=yt[_t]).res!=null&&W.mutatedParts&&(ne&&!Je.dirty?(bt=Object.isFrozen(Je.res),bt=Gl(Je.res,Je.req,Fe,Ee,Je,bt),Je.dirty?(k(xt,Je),Je.subscribers.forEach(function(Mt){return J.add(Mt)})):bt!==Je.res&&(Je.res=bt,Je.promise=Xe.resolve({result:bt}))):(Je.dirty&&k(xt,Je),Je.subscribers.forEach(function(Mt){return J.add(Mt)})))}}}J.forEach(function(Mt){return Mt()})}}},W.addEventListener("abort",q(!1),{signal:se}),W.addEventListener("error",q(!1),{signal:se}),W.addEventListener("complete",q(!0),{signal:se})),W},table:function(O){var L=w.table(O),q=L.schema.primaryKey;return n(n({},L),{mutate:function(Y){var se=R.trans;if(q.outbound||se.db._options.cache==="disabled"||se.explicit||se.idbtrans.mode!=="readwrite")return L.mutate(Y);var W=gs["idb://".concat(C,"/").concat(O)];return W?(se=L.mutate(Y),Y.type!=="add"&&Y.type!=="put"||!(50<=Y.values.length||aa(q,Y).some(function(ne){return ne==null}))?(W.optimisticOps.push(Y),Y.mutatedParts&&ys(Y.mutatedParts),se.then(function(ne){0<ne.numFailures&&(k(W.optimisticOps,Y),(ne=ws(0,Y,ne))&&W.optimisticOps.push(ne),Y.mutatedParts&&ys(Y.mutatedParts))}),se.catch(function(){k(W.optimisticOps,Y),Y.mutatedParts&&ys(Y.mutatedParts)})):se.then(function(ne){var J=ws(0,n(n({},Y),{values:Y.values.map(function(ye,he){var Te;return ne.failures[he]?ye:(ye=(Te=q.keyPath)!==null&&Te!==void 0&&Te.includes(".")?U(ye):n({},ye),T(ye,q.keyPath,ne.results[he]),ye)})}),ne);W.optimisticOps.push(J),queueMicrotask(function(){return Y.mutatedParts&&ys(Y.mutatedParts)})}),se):L.mutate(Y)},query:function(Y){if(!Ho(R,L)||!Hn("query",Y))return L.query(Y);var se=((J=R.trans)===null||J===void 0?void 0:J.db._options.cache)==="immutable",he=R,W=he.requery,ne=he.signal,J=function(Ee,Fe,Be,Pe){var qe=gs["idb://".concat(Ee,"/").concat(Fe)];if(!qe)return[];if(!(Fe=qe.queries[Be]))return[null,!1,qe,null];var Ye=Fe[(Pe.query?Pe.query.index.name:null)||""];if(!Ye)return[null,!1,qe,null];switch(Be){case"query":var et=Ye.find(function(vt){return vt.req.limit===Pe.limit&&vt.req.values===Pe.values&&ql(vt.req.query.range,Pe.query.range)});return et?[et,!0,qe,Ye]:[Ye.find(function(vt){return("limit"in vt.req?vt.req.limit:1/0)>=Pe.limit&&(!Pe.values||vt.req.values)&&Pu(vt.req.query.range,Pe.query.range)}),!1,qe,Ye];case"count":return et=Ye.find(function(vt){return ql(vt.req.query.range,Pe.query.range)}),[et,!!et,qe,Ye]}}(C,O,"query",Y),ye=J[0],he=J[1],Te=J[2],Ae=J[3];return ye&&he?ye.obsSet=Y.obsSet:(he=L.query(Y).then(function(Ee){var Fe=Ee.result;if(ye&&(ye.res=Fe),se){for(var Be=0,Pe=Fe.length;Be<Pe;++Be)Object.freeze(Fe[Be]);Object.freeze(Fe)}else Ee.result=U(Fe);return Ee}).catch(function(Ee){return Ae&&ye&&k(Ae,ye),Promise.reject(Ee)}),ye={obsSet:Y.obsSet,promise:he,subscribers:new Set,type:"query",req:Y,dirty:!1},Ae?Ae.push(ye):(Ae=[ye],(Te=Te||(gs["idb://".concat(C,"/").concat(O)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[Y.query.index.name||""]=Ae)),an(ye,Ae,W,ne),ye.promise.then(function(Ee){return{result:Gl(Ee.result,Y,Te==null?void 0:Te.optimisticOps,L,ye,se)}})}})}})}};function H(w,C){return new Proxy(w,{get:function(O,L,q){return L==="db"?C:Reflect.get(O,L,q)}})}var ve=(Ie.prototype.version=function(w){if(isNaN(w)||w<.1)throw new K.Type("Given version is not a positive number");if(w=Math.round(10*w)/10,this.idbdb||this._state.isBeingOpened)throw new K.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,w);var C=this._versions,O=C.filter(function(L){return L._cfg.version===w})[0];return O||(O=new this.Version(w),C.push(O),C.sort(Di),O.stores({}),this._state.autoSchema=!1,O)},Ie.prototype._whenReady=function(w){var C=this;return this.idbdb&&(this._state.openComplete||R.letThrough||this._vip)?w():new Xe(function(O,L){if(C._state.openComplete)return L(new K.DatabaseClosed(C._state.dbOpenError));if(!C._state.isBeingOpened){if(!C._state.autoOpen)return void L(new K.DatabaseClosed);C.open().catch(be)}C._state.dbReadyPromise.then(O,L)}).then(w)},Ie.prototype.use=function(w){var C=w.stack,O=w.create,L=w.level,q=w.name;return q&&this.unuse({stack:C,name:q}),w=this._middlewares[C]||(this._middlewares[C]=[]),w.push({stack:C,create:O,level:L??10,name:q}),w.sort(function(Y,se){return Y.level-se.level}),this},Ie.prototype.unuse=function(w){var C=w.stack,O=w.name,L=w.create;return C&&this._middlewares[C]&&(this._middlewares[C]=this._middlewares[C].filter(function(q){return L?q.create!==L:!!O&&q.name!==O})),this},Ie.prototype.open=function(){var w=this;return ga(fr,function(){return Yc(w)})},Ie.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var w=this._state,C=Ra.indexOf(this);if(0<=C&&Ra.splice(C,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}w.isBeingOpened||(w.dbReadyPromise=new Xe(function(O){w.dbReadyResolve=O}),w.openCanceller=new Xe(function(O,L){w.cancelOpen=L}))},Ie.prototype.close=function(O){var C=(O===void 0?{disableAutoOpen:!0}:O).disableAutoOpen,O=this._state;C?(O.isBeingOpened&&O.cancelOpen(new K.DatabaseClosed),this._close(),O.autoOpen=!1,O.dbOpenError=new K.DatabaseClosed):(this._close(),O.autoOpen=this._options.autoOpen||O.isBeingOpened,O.openComplete=!1,O.dbOpenError=null)},Ie.prototype.delete=function(w){var C=this;w===void 0&&(w={disableAutoOpen:!0});var O=0<arguments.length&&typeof arguments[0]!="object",L=this._state;return new Xe(function(q,Y){function se(){C.close(w);var W=C._deps.indexedDB.deleteDatabase(C.name);W.onsuccess=Xr(function(){var ne,J,ye;ne=C._deps,J=C.name,ye=ne.indexedDB,ne=ne.IDBKeyRange,ni(ye)||J===ya||ct(ye,ne).delete(J).catch(be),q()}),W.onerror=na(Y),W.onblocked=C._fireOnBlocked}if(O)throw new K.InvalidArgument("Invalid closeOptions argument to db.delete()");L.isBeingOpened?L.dbReadyPromise.then(se):se()})},Ie.prototype.backendDB=function(){return this.idbdb},Ie.prototype.isOpen=function(){return this.idbdb!==null},Ie.prototype.hasBeenClosed=function(){var w=this._state.dbOpenError;return w&&w.name==="DatabaseClosed"},Ie.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Ie.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Ie.prototype,"tables",{get:function(){var w=this;return s(this._allTables).map(function(C){return w._allTables[C]})},enumerable:!1,configurable:!0}),Ie.prototype.transaction=function(){var w=(function(C,O,L){var q=arguments.length;if(q<2)throw new K.InvalidArgument("Too few arguments");for(var Y=new Array(q-1);--q;)Y[q-1]=arguments[q];return L=Y.pop(),[C,I(Y),L]}).apply(this,arguments);return this._transaction.apply(this,w)},Ie.prototype._transaction=function(w,C,O){var L=this,q=R.trans;q&&q.db===this&&w.indexOf("!")===-1||(q=null);var Y,se,W=w.indexOf("?")!==-1;w=w.replace("!","").replace("?","");try{if(se=C.map(function(J){if(J=J instanceof L.Table?J.name:J,typeof J!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return J}),w=="r"||w===ki)Y=ki;else{if(w!="rw"&&w!=Qs)throw new K.InvalidArgument("Invalid transaction mode: "+w);Y=Qs}if(q){if(q.mode===ki&&Y===Qs){if(!W)throw new K.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");q=null}q&&se.forEach(function(J){if(q&&q.storeNames.indexOf(J)===-1){if(!W)throw new K.SubTransaction("Table "+J+" not included in parent transaction.");q=null}}),W&&q&&!q.active&&(q=null)}}catch(J){return q?q._promise(null,function(ye,he){he(J)}):jr(J)}var ne=(function J(ye,he,Te,Ae,Ee){return Xe.resolve().then(function(){var Fe=R.transless||R,Be=ye._createTransaction(he,Te,ye._dbSchema,Ae);if(Be.explicit=!0,Fe={trans:Be,transless:Fe},Ae)Be.idbtrans=Ae.idbtrans;else try{Be.create(),Be.idbtrans._explicit=!0,ye._state.PR1398_maxLoop=3}catch(Ye){return Ye.name===Se.InvalidState&&ye.isOpen()&&0<--ye._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),ye.close({disableAutoOpen:!1}),ye.open().then(function(){return J(ye,he,Te,null,Ee)})):jr(Ye)}var Pe,qe=me(Ee);return qe&&Ba(),Fe=Xe.follow(function(){var Ye;(Pe=Ee.call(Be,Be))&&(qe?(Ye=hi.bind(null,null),Pe.then(Ye,Ye)):typeof Pe.next=="function"&&typeof Pe.throw=="function"&&(Pe=Ou(Pe)))},Fe),(Pe&&typeof Pe.then=="function"?Xe.resolve(Pe).then(function(Ye){return Be.active?Ye:jr(new K.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):Fe.then(function(){return Pe})).then(function(Ye){return Ae&&Be._resolve(),Be._completion.then(function(){return Ye})}).catch(function(Ye){return Be._reject(Ye),jr(Ye)})})}).bind(null,this,Y,se,q,O);return q?q._promise(Y,ne,"lock"):R.trans?ga(R.transless,function(){return L._whenReady(ne)}):this._whenReady(ne)},Ie.prototype.table=function(w){if(!f(this._allTables,w))throw new K.InvalidTable("Table ".concat(w," does not exist"));return this._allTables[w]},Ie);function Ie(w,C){var O=this;this._middlewares={},this.verno=0;var L=Ie.dependencies;this._options=C=n({addons:Ie.addons,autoOpen:!0,indexedDB:L.indexedDB,IDBKeyRange:L.IDBKeyRange,cache:"cloned"},C),this._deps={indexedDB:C.indexedDB,IDBKeyRange:C.IDBKeyRange},L=C.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var q,Y,se,W,ne,J={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:be,dbReadyPromise:null,cancelOpen:be,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:C.autoOpen};J.dbReadyPromise=new Xe(function(he){J.dbReadyResolve=he}),J.openCanceller=new Xe(function(he,Te){J.cancelOpen=Te}),this._state=J,this.name=w,this.on=Js(this,"populate","blocked","versionchange","close",{ready:[Ve,be]}),this.once=function(he,Te){var Ae=function(){for(var Ee=[],Fe=0;Fe<arguments.length;Fe++)Ee[Fe]=arguments[Fe];O.on(he).unsubscribe(Ae),Te.apply(O,Ee)};return O.on(he,Ae)},this.on.ready.subscribe=b(this.on.ready.subscribe,function(he){return function(Te,Ae){Ie.vip(function(){var Ee,Fe=O._state;Fe.openComplete?(Fe.dbOpenError||Xe.resolve().then(Te),Ae&&he(Te)):Fe.onReadyBeingFired?(Fe.onReadyBeingFired.push(Te),Ae&&he(Te)):(he(Te),Ee=O,Ae||he(function Be(){Ee.on.ready.unsubscribe(Te),Ee.on.ready.unsubscribe(Be)}))})}}),this.Collection=(q=this,eo(Uc.prototype,function(Pe,Be){this.db=q;var Ae=Io,Ee=null;if(Be)try{Ae=Be()}catch(qe){Ee=qe}var Fe=Pe._ctx,Be=Fe.table,Pe=Be.hook.reading.fire;this._ctx={table:Be,index:Fe.index,isPrimKey:!Fe.index||Be.schema.primKey.keyPath&&Fe.index===Be.schema.primKey.name,range:Ae,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:Ee,or:Fe.or,valueMapper:Pe!==$e?Pe:null}})),this.Table=(Y=this,eo($a.prototype,function(he,Te,Ae){this.db=Y,this._tx=Ae,this.name=he,this.schema=Te,this.hook=Y._allTables[he]?Y._allTables[he].hook:Js(null,{creating:[ae,be],reading:[Oe,$e],updating:[Ce,be],deleting:[ce,be]})})),this.Transaction=(se=this,eo(Bh.prototype,function(he,Te,Ae,Ee,Fe){var Be=this;he!=="readonly"&&Te.forEach(function(Pe){Pe=(Pe=Ae[Pe])===null||Pe===void 0?void 0:Pe.yProps,Pe&&(Te=Te.concat(Pe.map(function(qe){return qe.updatesTable})))}),this.db=se,this.mode=he,this.storeNames=Te,this.schema=Ae,this.chromeTransactionDurability=Ee,this.idbtrans=null,this.on=Js(this,"complete","error","abort"),this.parent=Fe||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Xe(function(Pe,qe){Be._resolve=Pe,Be._reject=qe}),this._completion.then(function(){Be.active=!1,Be.on.complete.fire()},function(Pe){var qe=Be.active;return Be.active=!1,Be.on.error.fire(Pe),Be.parent?Be.parent._reject(Pe):qe&&Be.idbtrans&&Be.idbtrans.abort(),jr(Pe)})})),this.Version=(W=this,eo(kl.prototype,function(he){this.db=W,this._cfg={version:he,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(ne=this,eo(Rl.prototype,function(he,Te,Ae){if(this.db=ne,this._ctx={table:he,index:Te===":id"?null:Te,or:Ae},this._cmp=this._ascending=Er,this._descending=function(Ee,Fe){return Er(Fe,Ee)},this._max=function(Ee,Fe){return 0<Er(Ee,Fe)?Ee:Fe},this._min=function(Ee,Fe){return Er(Ee,Fe)<0?Ee:Fe},this._IDBKeyRange=ne._deps.IDBKeyRange,!this._IDBKeyRange)throw new K.MissingAPI})),this.on("versionchange",function(he){0<he.newVersion?console.warn("Another connection wants to upgrade database '".concat(O.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(O.name,"'. Closing db now to resume the delete request.")),O.close({disableAutoOpen:!1})}),this.on("blocked",function(he){!he.newVersion||he.newVersion<he.oldVersion?console.warn("Dexie.delete('".concat(O.name,"') was blocked")):console.warn("Upgrade '".concat(O.name,"' blocked by other connection holding version ").concat(he.oldVersion/10))}),this._maxKey=Ur(C.IDBKeyRange),this._createTransaction=function(he,Te,Ae,Ee){return new O.Transaction(he,Te,Ae,O._options.chromeTransactionDurability,Ee)},this._fireOnBlocked=function(he){O.on("blocked").fire(he),Ra.filter(function(Te){return Te.name===O.name&&Te!==O&&!Te._state.vcFired}).map(function(Te){return Te.on("versionchange").fire(he)})},this.use(xs),this.use(Kc),this.use(no),this.use(zl),this.use(qo);var ye=new Proxy(this,{get:function(he,Te,Ae){if(Te==="_vip")return!0;if(Te==="table")return function(Fe){return H(O.table(Fe),ye)};var Ee=Reflect.get(he,Te,Ae);return Ee instanceof $a?H(Ee,ye):Te==="tables"?Ee.map(function(Fe){return H(Fe,ye)}):Te==="_createTransaction"?function(){return H(Ee.apply(this,arguments),ye)}:Ee}});this.vip=ye,L.forEach(function(he){return he(O)})}var ze,tt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Et=(mr.prototype.subscribe=function(w,C,O){return this._subscribe(w&&typeof w!="function"?w:{next:w,error:C,complete:O})},mr.prototype[tt]=function(){return this},mr);function mr(w){this._subscribe=w}try{ze={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch{ze={indexedDB:null,IDBKeyRange:null}}function Gr(w){var C,O=!1,L=new Et(function(q){var Y=me(w),se,W=!1,ne={},J={},ye={get closed(){return W},unsubscribe:function(){W||(W=!0,se&&se.abort(),he&&La.storagemutated.unsubscribe(Ae))}};q.start&&q.start(ye);var he=!1,Te=function(){return Mo(Ee)},Ae=function(Fe){ro(ne,Fe),Ll(J,ne)&&Te()},Ee=function(){var Fe,Be,Pe;!W&&ze.indexedDB&&(ne={},Fe={},se&&se.abort(),se=new AbortController,Pe=function(qe){var Ye=Ia();try{Y&&Ba();var et=ea(w,qe);return et=Y?et.finally(hi):et}finally{Ye&&Fa()}}(Be={subscr:Fe,signal:se.signal,requery:Te,querier:w,trans:null}),Promise.resolve(Pe).then(function(qe){O=!0,C=qe,W||Be.signal.aborted||(ne={},function(Ye){for(var et in Ye)if(f(Ye,et))return;return 1}(J=Fe)||he||(La($o,Ae),he=!0),Mo(function(){return!W&&q.next&&q.next(qe)}))},function(qe){O=!1,["DatabaseClosedError","AbortError"].includes(qe==null?void 0:qe.name)||W||Mo(function(){W||q.error&&q.error(qe)})}))};return setTimeout(Te,0),ye});return L.hasValue=function(){return O},L.getValue=function(){return C},L}var Mn=ve;function qa(w){var C=Li;try{Li=!0,La.storagemutated.fire(w),Ga(w,!0)}finally{Li=C}}h(Mn,n(n({},_e),{delete:function(w){return new Mn(w,{addons:[]}).delete()},exists:function(w){return new Mn(w,{addons:[]}).open().then(function(C){return C.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(w){try{return C=Mn.dependencies,O=C.indexedDB,C=C.IDBKeyRange,(ni(O)?Promise.resolve(O.databases()).then(function(L){return L.map(function(q){return q.name}).filter(function(q){return q!==ya})}):ct(O,C).toCollection().primaryKeys()).then(w)}catch{return jr(new K.MissingAPI)}var C,O},defineClass:function(){return function(w){l(this,w)}},ignoreTransaction:function(w){return R.trans?ga(R.transless,w):w()},vip:Nu,async:function(w){return function(){try{var C=Ou(w.apply(this,arguments));return C&&typeof C.then=="function"?C:Xe.resolve(C)}catch(O){return jr(O)}}},spawn:function(w,C,O){try{var L=Ou(w.apply(O,C||[]));return L&&typeof L.then=="function"?L:Xe.resolve(L)}catch(q){return jr(q)}},currentTransaction:{get:function(){return R.trans||null}},waitFor:function(w,C){return C=Xe.resolve(typeof w=="function"?Mn.ignoreTransaction(w):w).timeout(C||6e4),R.trans?R.trans.waitFor(C):C},Promise:Xe,debug:{get:function(){return je},set:function(w){ht(w)}},derive:v,extend:l,props:h,override:b,Events:Js,on:La,liveQuery:Gr,extendObservabilitySet:ro,getByKeyPath:_,setByKeyPath:T,delByKeyPath:function(w,C){typeof C=="string"?T(w,C,void 0):"length"in C&&[].map.call(C,function(O){T(w,O,void 0)})},shallowClone:M,deepClone:U,getObjectDiff:bs,cmp:Er,asap:E,minKey:-1/0,addons:[],connections:Ra,errnames:Se,dependencies:ze,cache:gs,semVer:"4.2.1",version:"4.2.1".split(".").map(function(w){return parseInt(w)}).reduce(function(w,C,O){return w+C/Math.pow(10,2*O)})})),Mn.maxKey=Ur(Mn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(La($o,function(w){Li||(w=new CustomEvent(ko,{detail:w}),Li=!0,dispatchEvent(w),Li=!1)}),addEventListener(ko,function(w){w=w.detail,Li||qa(w)}));var $u,Li=!1,sa=function(){};return typeof BroadcastChannel<"u"&&((sa=function(){($u=new BroadcastChannel(ko)).onmessage=function(w){return w.data&&qa(w.data)}})(),typeof $u.unref=="function"&&$u.unref(),La($o,function(w){Li||$u.postMessage(w)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(w){if(!ve.disableBfCache&&w.persisted){je&&console.debug("Dexie: handling persisted pagehide"),$u!=null&&$u.close();for(var C=0,O=Ra;C<O.length;C++)O[C].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(w){!ve.disableBfCache&&w.persisted&&(je&&console.debug("Dexie: handling persisted pageshow"),sa(),qa({all:new un(-1/0,[[]])}))})),Xe.rejectionMapper=function(w,C){return!w||w instanceof ue||w instanceof TypeError||w instanceof SyntaxError||!w.name||!de[w.name]?w:(C=new de[w.name](C||w.message,w),"stack"in w&&m(C,"stack",{get:function(){return this.inner.stack}}),C)},ht(je),n(ve,Object.freeze({__proto__:null,Dexie:ve,liveQuery:Gr,Entity:kc,cmp:Er,PropModification:hs,replacePrefix:function(w,C){return new hs({replacePrefix:[w,C]})},add:function(w){return new hs({add:w})},remove:function(w){return new hs({remove:w})},default:ve,RangeSet:un,mergeRanges:vs,rangesOverlap:Qr}),{default:ve}),ve})})(pO);var Jve=pO.exports;const hb=gl(Jve),N2=Symbol.for("Dexie"),db=globalThis[N2]||(globalThis[N2]=hb);if(hb.semVer!==db.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${hb.semVer} and ${db.semVer}`);class ege extends db{constructor(){super("GameSaveDB");_r(this,"saves");this.version(1).stores({saves:"id"})}}const mO=new ege;async function tge(t){const e={id:"main",data:t,timestamp:Date.now()};await mO.saves.put(e)}async function rge(){const t=await mO.saves.get("main");return(t==null?void 0:t.data)??null}const nge=["Shift","Meta","Control","Alt"],It={MOVE_LEFT:["ArrowLeft","h"],MOVE_DOWN:["ArrowDown","j"],MOVE_UP:["ArrowUp","k"],MOVE_RIGHT:["ArrowRight","l"],SCROLL_UP:["ArrowUp","k"],SCROLL_DOWN:["ArrowDown","j"],ATTACK:"a",KICK:"k",OPEN:"o",PICK_UP:"g",INTERACT:"e",INSPECT:"L",INVENTORY:"i",TARGET:"t",CONSUME:"c",DROP:"d",WIELD:"w",WEAR:"W",REMOVE:"r",STAIRS_DOWN:">",STAIRS_UP:"<",SHOW_LOG:"H",CONFIRM:"Enter",CANCEL:"Escape",SAVE:"1",LOAD:"2",TOGGLE_MAKER_MODE:"M",TOGGLE_MAKER_MODE_PREFAB_SELECT:"e",TOGGLE_DEBUG:"F1",TOGGLE_SEE_ALL:"F2",TOGGLE_SEE_ODOR_MAP:"F3",TOGGLE_SEE_VISION_MAP:"F4",TOGGLE_SEE_SOUND_MAP:"F5"},tp=t=>It.MOVE_LEFT.includes(t)||It.MOVE_DOWN.includes(t)||It.MOVE_UP.includes(t)||It.MOVE_RIGHT.includes(t),rp=t=>It.MOVE_LEFT.includes(t)?{dx:-1,dy:0}:It.MOVE_DOWN.includes(t)?{dx:0,dy:1}:It.MOVE_UP.includes(t)?{dx:0,dy:-1}:It.MOVE_RIGHT.includes(t)?{dx:1,dy:0}:null,pb=t=>{const e=t instanceof KeyboardEvent?t.key:t;nge.includes(e)||ln(r=>{r.userInput=t instanceof KeyboardEvent?t:new KeyboardEvent("keydown",{key:e})})};var mb=(t=>(t.up="up",t.down="down",t))(mb||{});class ige{constructor(){_r(this,"_world",new vH);_r(this,"_entityById",new Map);_r(this,"_zones",new Map);this.saveGameData=this.saveGameData.bind(this),this.loadGameData=this.loadGameData.bind(this),this.saveZone=this.saveZone.bind(this),this.changeZone=this.changeZone.bind(this)}get world(){return this._world}get registry(){return this._entityById}get zones(){return this._zones}clearEntities(e=[]){for(const r of[...this.world.entities])e.includes(r.id)||this.world.remove(r)}saveZone(e){var r,n;this.zones.has(e)||this.zones.set(e,new Set),(r=this.zones.get(e))==null||r.clear();for(const i of Xt.world.entities)(n=this.zones.get(e))==null||n.add(i.id)}async saveGameData(){Dn("saving game...");const{log:e,zoneId:r,playerId:n,version:i,turnNumber:a}=gt();this.saveZone(r);const s={registry:age(this.registry),zones:sge(this.zones),state:{log:e,zoneId:r,playerId:n,version:i,turnNumber:a}};await tge(s),pb("exitSaveMode"),Dn("game saved successfully?")}changeZone(e,r){var o;const{playerId:n}=gt(),i=this.registry.get(n),a=((o=i==null?void 0:i.container)==null?void 0:o.contents)||[],s=[n,...a];if(Ry(r),this.clearEntities(s),ln(l=>l.eapMap=new Map),this.zones.has(e)){const l=Xt.world.with("position").without("blocking"),u=this.zones.get(e);if(!u)return;for(const c of u){const f=this.registry.get(c);if(!f)return;this.world.add(f)}for(const c of l)if(c){if(!i)return;const f=Ry(r);if(!f)return;for(const h of f)i.position={...h.position};break}}else{dO();const l=Xt.registry.get(n);if(l){const u=Ry(r);if(!u)return;for(const c of u)l.position={...c.position}}}ln(l=>l.zoneId=e),this.saveZone(e)}async loadGameData(){Dn("loading game...");const e=await rge();if(!e)return;const{registry:r,state:n,zones:i}=e;this.registry.clear(),this.zones.clear(),this.clearEntities();for(const f of Object.values(r))this.world.add(f);for(const[f,h]of i)this.zones.set(f,new Set(h));this.clearEntities();const a=this.zones.get(n.zoneId);if(a)for(const f of a){const h=this.registry.get(f);h&&this.world.add(h)}const{log:s,zoneId:o,playerId:l,version:u,turnNumber:c}=n;ln(f=>{f.log=s,f.zoneId=o,f.playerId=l,f.version=u,f.turnNumber=c}),pb("exitLoadMode"),Dn("game loaded successfully")}}const Xt=new ige;Xt.world.onEntityAdded.subscribe(t=>{let e=self.crypto.randomUUID();t.id||(t.id=e),t.id&&Xt.registry.set(t.id,t)});const age=t=>{const e={};for(let[r,n]of t)e[r]=n;return e},sge=t=>Array.from(t.entries()).map(([e,r])=>[e,Array.from(r)]),Ry=t=>{const e=Xt.world.with("stairsUp","position"),r=Xt.world.with("stairsDown","position");if(t==="up")return r;if(t==="down")return e},ss=t=>`§#${t.toString(16).padStart(6,"0")}§`,wf=(t,e="name")=>{var i;const r=(i=t.appearance)==null?void 0:i.tint,n=Qt.get(t,e);if(r&&n)return`${ss(r)}${n}`},su=t=>{var n;const e=t.name,r=(n=t.appearance)==null?void 0:n.tint;if(r&&e)return`${ss(r)}${e}§reset§`},Hm=t=>{var i,a;if(!t)return console.log("no entity");const e=((i=t==null?void 0:t.appearance)==null?void 0:i.tint)||65280,r=(t==null?void 0:t.name)||"noname",n=((a=t==null?void 0:t.appearance)==null?void 0:a.char)||"?";return`${ss(e)}${n} ${r}§reset§`},kr=t=>`§purple§${t}§reset§`,Wm=t=>{const e={...t,memory:t.memory?{...t.memory,memories:Object.fromEntries(t.memory.memories||[])}:void 0};return JSON.parse(JSON.stringify(e))},Hi=t=>console.log(Wm(t)),Dn=t=>{const e=gt().log;if(e.length===0){ln(i=>i.log.push(t));return}const r=e[e.length-1],n=r.match(/^(.*)\s\(x(\d+)\)$/);if(n){const[i,a,s]=n;if(a===t){const o=parseInt(s)+1;ln(l=>l.log[e.length-1]=`${a} (x${o})`);return}}ln(r===t?i=>i.log[e.length-1]=`${t} (x2)`:i=>i.log.push(t))},$n=(t,e)=>{ln(r=>r.senses[e]=t)},Eg=t=>{const{x:e,y:r}=t,{width:n,height:i}=gt().views.map;return e<0||r<0||e>=n||r>=i},Gx=(t,e)=>t.x===e.x&&t.y===e.y,kv=t=>Math.floor((t-10)/2),oge=t=>{var e;return!!((e=t==null?void 0:t.weaponSlot)!=null&&e.contents[0])},uge=t=>{var e;if((e=t.weaponSlot)!=null&&e.contents){const r=t.weaponSlot.contents[0];if(r){const n=Xt.registry.get(r);if(n)return n}}return!1},qx=(t,e)=>{var r,n,i;oge(t)&&Hx(t),(r=t.weaponSlot)!=null&&r.contents&&(t.weaponSlot.contents[0]=e.id,Xx(Xt.world,e),(n=t.container)!=null&&n.contents&&Qt.pull((i=t.container)==null?void 0:i.contents,e.id)),t.averageDamage=fh(t)},Hx=t=>{var e,r;if((e=t.weaponSlot)!=null&&e.contents){const n=t.weaponSlot.contents[0];if(n)if(t.container&&t.container.contents.length<t.container.slots)t.container.contents.includes(n)||t.container.contents.push(n);else{const i=Xt.registry.get(n);i&&t.position&&vl(Xt.world,i,t.position)}return(r=t.weaponSlot)!=null&&r.contents&&(t.weaponSlot.contents=[]),t.averageDamage=fh(t),!0}return!1},vO=t=>{var e;return!!((e=t==null?void 0:t.armorSlot)!=null&&e.contents[0])},Sg=t=>{var e;if((e=t.armorSlot)!=null&&e.contents){const r=t.armorSlot.contents[0];if(r){const n=Xt.registry.get(r);if(n)return n}}},Wx=(t,e)=>{var r,n,i;vO(t)&&Vx(t),(r=t.armorSlot)!=null&&r.contents&&(t.armorSlot.contents[0]=e.id,Xx(Xt.world,e),(n=t.container)!=null&&n.contents&&Qt.pull((i=t.container)==null?void 0:i.contents,e.id))},Vx=t=>{var e,r;if((e=t.armorSlot)!=null&&e.contents){const n=t.armorSlot.contents[0];if(n)if(t.container&&t.container.contents.length<t.container.slots)t.container.contents.includes(n)||t.container.contents.push(n);else{const i=Xt.registry.get(n);i&&t.position&&vl(Xt.world,i,t.position)}return(r=t.armorSlot)!=null&&r.contents&&(t.armorSlot.contents=[]),!0}return!1},gO=(t,e)=>{const r={beast:{beast:ui.Neutral,humanoid:ui.Neutral,undead:ui.Hostile,player:ui.Hostile},humanoid:{beast:ui.Neutral,humanoid:ui.Neutral,undead:ui.Hostile,player:ui.Hostile},undead:{beast:ui.Hostile,humanoid:ui.Hostile,undead:ui.Friendly,player:ui.Hostile},player:{beast:ui.Neutral,humanoid:ui.Neutral,undead:ui.Neutral,player:ui.Neutral}};return t.entityKind&&e.entityKind?r[t.entityKind][e.entityKind]:(console.log("default neutral disposition",{actor:t,target:e}),ui.Neutral)},Xx=(t,e)=>{e.position&&(yO(Ir(e.position),e.id),t.removeComponent(e,"position"))},vl=(t,e,r)=>{if(e.position||t.addComponent(e,"position",r),e.position){const n=Ir(e.position),i=Ir(r);e.position.x=r.x,e.position.y=r.y,yO(n,e.id),lge(i,e.id)}};function lge(t,e){let r=gt().eapMap.get(t);r||(r=new Set,gt().eapMap.set(t,r)),r.add(e)}function yO(t,e){const r=gt().eapMap.get(t);r&&(r.delete(e),r.size===0&&gt().eapMap.delete(t))}function jx(t){return gt().eapMap.get(t)}const bO=t=>{const e=Un("player",{position:t}),r=Un("shortsword"),n=Un("leatherArmor");return qx(e,r),Wx(e,n),fh(e,r),fh(e,n),e},Ec={legend:{width:25,height:44,x:0,y:0,layers:1,tileSets:["text"],tints:[16711799],alphas:[1],visible:!0,name:"legend"},log:{width:74,height:5,x:26,y:0,layers:1,tileSets:["text"],tints:[15658734],alphas:[1],visible:!0,name:"log"},senses:{width:74,height:5,x:100,y:0,layers:1,tileSets:["text"],tints:[15658734],alphas:[1],visible:!0,name:"senses"},mapFluid:{width:74,height:39,x:13,y:5,layers:4,tileSets:["kenny"],tints:[0,0,0,0],alphas:[0,0,0,0],visible:!0,name:"mapFluid"},map:{width:74,height:39,x:13,y:5,layers:3,tileSets:["tile","ascii","tile"],tints:[0,0,0],alphas:[1,1,0],visible:!0,name:"map"},mapFire:{width:74,height:39,x:13,y:5,layers:3,tileSets:["kenny"],tints:[0],alphas:[1],visible:!0,name:"mapFire"},odorMap:{width:74,height:39,x:13,y:5,layers:1,tileSets:["tile"],tints:[0],alphas:[1],visible:!0,name:"odorMap"},soundMap:{width:74,height:39,x:13,y:5,layers:1,tileSets:["tile"],tints:[0],alphas:[1],visible:!0,name:"odorMap"},visionMap:{width:74,height:39,x:13,y:5,layers:1,tileSets:["tile"],tints:[0],alphas:[1],visible:!0,name:"visionMap"},fps:{width:12,height:1,x:0,y:44,layers:1,tileSets:["text"],tints:[3355443],alphas:[1],visible:!0,name:"fps"},gitHash:{width:12,height:1,x:0,y:45,layers:1,tileSets:["text"],tints:[3355443],alphas:[1],visible:!0,name:"gitHash"},hud:{width:26,height:46,x:174,y:0,layers:1,tileSets:["text"],tints:[14540253],alphas:[1],visible:!0,name:"hud"},controls:{width:148,height:2,x:26,y:44,layers:1,tileSets:["text"],tints:[10066329],alphas:[1],visible:!0,name:"controls"},menuUnderlay:{width:100,height:44,x:0,y:0,layers:1,tileSets:["tile"],tints:[1118481],alphas:[.75],visible:!1,name:"menuUnderlay"},inventory:{width:148,height:39,x:26,y:5,layers:2,tileSets:["text","text"],tints:[1118481,16777215],alphas:[1],visible:!1,name:"inventory"},logHistory:{width:148,height:44,x:26,y:0,layers:1,tileSets:["text"],tints:[16777215],alphas:[1],visible:!1,name:"logHistory"},makerModeRight:{width:26,height:46,x:174,y:0,layers:2,tileSets:["tile","text"],tints:[0,14540253],alphas:[1,1],visible:!1,name:"makerModeRight"},makerModeLeft:{width:25,height:44,x:0,y:0,layers:2,tileSets:["tile","text"],tints:[0,14540253],alphas:[1,1],visible:!1,name:"makerModeLeft"},makerModeTop:{width:148,height:5,x:26,y:0,layers:2,tileSets:["tile","text"],tints:[0,15658734],alphas:[1,1],visible:!1,name:"makerModeTop"},saving:{width:148,height:39,x:26,y:5,layers:2,tileSets:["text","text"],tints:[1118481,16777215],alphas:[1],visible:!1,name:"saving"},loading:{width:148,height:39,x:26,y:5,layers:1,tileSets:["text"],tints:[16777215],alphas:[1],visible:!1,name:"saving"}};function cge(){const t={};for(const[e,r]of Object.entries(Ec)){const n=new Oq(r);e==="fps"&&n.updateRows([[{string:"FPS: calc..."}]]),e==="gitHash"&&n.updateRows([[{string:"TAG: c59fa72"}]]),t[e]=n}return t}const fge=({world:t})=>{const e=t.with("activeEffects");return function(){for(const n of e){const{activeEffects:i}=n;i.forEach(a=>{const s=n[a.component];s&&(s.current+a.delta>s.max?s.current=s.max:s.current+=a.delta)}),i.splice(0,i.length)}}};var Yx={exports:{}};Yx.exports;(function(t){(function(){var e,r,n,i,a,s,o,l,u,c,f,h,p,m,v;n=Math.floor,c=Math.min,r=function(y,x){return y<x?-1:y>x?1:0},u=function(y,x,S,b,A){var E;if(S==null&&(S=0),A==null&&(A=r),S<0)throw new Error("lo must be non-negative");for(b==null&&(b=y.length);S<b;)E=n((S+b)/2),A(x,y[E])<0?b=E:S=E+1;return[].splice.apply(y,[S,S-S].concat(x)),x},s=function(y,x,S){return S==null&&(S=r),y.push(x),m(y,0,y.length-1,S)},a=function(y,x){var S,b;return x==null&&(x=r),S=y.pop(),y.length?(b=y[0],y[0]=S,v(y,0,x)):b=S,b},l=function(y,x,S){var b;return S==null&&(S=r),b=y[0],y[0]=x,v(y,0,S),b},o=function(y,x,S){var b;return S==null&&(S=r),y.length&&S(y[0],x)<0&&(b=[y[0],x],x=b[0],y[0]=b[1],v(y,0,S)),x},i=function(y,x){var S,b,A,E,_,T;for(x==null&&(x=r),E=(function(){T=[];for(var M=0,N=n(y.length/2);0<=N?M<N:M>N;0<=N?M++:M--)T.push(M);return T}).apply(this).reverse(),_=[],b=0,A=E.length;b<A;b++)S=E[b],_.push(v(y,S,x));return _},p=function(y,x,S){var b;if(S==null&&(S=r),b=y.indexOf(x),b!==-1)return m(y,0,b,S),v(y,b,S)},f=function(y,x,S){var b,A,E,_,T;if(S==null&&(S=r),A=y.slice(0,x),!A.length)return A;for(i(A,S),T=y.slice(x),E=0,_=T.length;E<_;E++)b=T[E],o(A,b,S);return A.sort(S).reverse()},h=function(y,x,S){var b,A,E,_,T,M,N,I,F;if(S==null&&(S=r),x*10<=y.length){if(E=y.slice(0,x).sort(S),!E.length)return E;for(A=E[E.length-1],N=y.slice(x),_=0,M=N.length;_<M;_++)b=N[_],S(b,A)<0&&(u(E,b,0,null,S),E.pop(),A=E[E.length-1]);return E}for(i(y,S),F=[],T=0,I=c(x,y.length);0<=I?T<I:T>I;0<=I?++T:--T)F.push(a(y,S));return F},m=function(y,x,S,b){var A,E,_;for(b==null&&(b=r),A=y[S];S>x;){if(_=S-1>>1,E=y[_],b(A,E)<0){y[S]=E,S=_;continue}break}return y[S]=A},v=function(y,x,S){var b,A,E,_,T;for(S==null&&(S=r),A=y.length,T=x,E=y[x],b=2*x+1;b<A;)_=b+1,_<A&&!(S(y[b],y[_])<0)&&(b=_),y[x]=y[b],x=b,b=2*x+1;return y[x]=E,m(y,T,x,S)},e=function(){y.push=s,y.pop=a,y.replace=l,y.pushpop=o,y.heapify=i,y.updateItem=p,y.nlargest=f,y.nsmallest=h;function y(x){this.cmp=x??r,this.nodes=[]}return y.prototype.push=function(x){return s(this.nodes,x,this.cmp)},y.prototype.pop=function(){return a(this.nodes,this.cmp)},y.prototype.peek=function(){return this.nodes[0]},y.prototype.contains=function(x){return this.nodes.indexOf(x)!==-1},y.prototype.replace=function(x){return l(this.nodes,x,this.cmp)},y.prototype.pushpop=function(x){return o(this.nodes,x,this.cmp)},y.prototype.heapify=function(){return i(this.nodes,this.cmp)},y.prototype.updateItem=function(x){return p(this.nodes,x,this.cmp)},y.prototype.clear=function(){return this.nodes=[]},y.prototype.empty=function(){return this.nodes.length===0},y.prototype.size=function(){return this.nodes.length},y.prototype.clone=function(){var x;return x=new y,x.nodes=this.nodes.slice(0),x},y.prototype.toArray=function(){return this.nodes.slice(0)},y.prototype.insert=y.prototype.push,y.prototype.top=y.prototype.peek,y.prototype.front=y.prototype.peek,y.prototype.has=y.prototype.contains,y.prototype.copy=y.prototype.clone,y}(),t!==null&&t.exports?t.exports=e:window.Heap=e}).call(Qn)})(Yx);var hge=Yx.exports,Dg=hge;function dge(t,e,r){this.x=t,this.y=e,this.walkable=r===void 0?!0:r}var Kx=dge,pge={Always:1,Never:2,IfAtMostOneObstacle:3,OnlyWhenNoObstacles:4},cs=pge,xO=Kx,Sm=cs;function bu(t,e,r){var n;typeof t!="object"?n=t:(e=t.length,n=t[0].length,r=t),this.width=n,this.height=e,this.nodes=this._buildNodes(n,e,r)}bu.prototype._buildNodes=function(t,e,r){var n,i,a=new Array(e);for(n=0;n<e;++n)for(a[n]=new Array(t),i=0;i<t;++i)a[n][i]=new xO(i,n);if(r===void 0)return a;if(r.length!==e||r[0].length!==t)throw new Error("Matrix size does not fit");for(n=0;n<e;++n)for(i=0;i<t;++i)r[n][i]&&(a[n][i].walkable=!1);return a};bu.prototype.getNodeAt=function(t,e){return this.nodes[e][t]};bu.prototype.isWalkableAt=function(t,e){return this.isInside(t,e)&&this.nodes[e][t].walkable};bu.prototype.isInside=function(t,e){return t>=0&&t<this.width&&e>=0&&e<this.height};bu.prototype.setWalkableAt=function(t,e,r){this.nodes[e][t].walkable=r};bu.prototype.getNeighbors=function(t,e){var r=t.x,n=t.y,i=[],a=!1,s=!1,o=!1,l=!1,u=!1,c=!1,f=!1,h=!1,p=this.nodes;if(this.isWalkableAt(r,n-1)&&(i.push(p[n-1][r]),a=!0),this.isWalkableAt(r+1,n)&&(i.push(p[n][r+1]),o=!0),this.isWalkableAt(r,n+1)&&(i.push(p[n+1][r]),u=!0),this.isWalkableAt(r-1,n)&&(i.push(p[n][r-1]),f=!0),e===Sm.Never)return i;if(e===Sm.OnlyWhenNoObstacles)s=f&&a,l=a&&o,c=o&&u,h=u&&f;else if(e===Sm.IfAtMostOneObstacle)s=f||a,l=a||o,c=o||u,h=u||f;else if(e===Sm.Always)s=!0,l=!0,c=!0,h=!0;else throw new Error("Incorrect value of diagonalMovement");return s&&this.isWalkableAt(r-1,n-1)&&i.push(p[n-1][r-1]),l&&this.isWalkableAt(r+1,n-1)&&i.push(p[n-1][r+1]),c&&this.isWalkableAt(r+1,n+1)&&i.push(p[n+1][r+1]),h&&this.isWalkableAt(r-1,n+1)&&i.push(p[n+1][r-1]),i};bu.prototype.clone=function(){var t,e,r=this.width,n=this.height,i=this.nodes,a=new bu(r,n),s=new Array(n);for(t=0;t<n;++t)for(s[t]=new Array(r),e=0;e<r;++e)s[t][e]=new xO(e,t,i[t][e].walkable);return a.nodes=s,a};var mge=bu,Ma={};function vb(t){for(var e=[[t.x,t.y]];t.parent;)t=t.parent,e.push([t.x,t.y]);return e.reverse()}Ma.backtrace=vb;function vge(t,e){var r=vb(t),n=vb(e);return r.concat(n.reverse())}Ma.biBacktrace=vge;function gge(t){var e,r=0,n,i,a,s;for(e=1;e<t.length;++e)n=t[e-1],i=t[e],a=n[0]-i[0],s=n[1]-i[1],r+=Math.sqrt(a*a+s*s);return r}Ma.pathLength=gge;function Zx(t,e,r,n){var i=Math.abs,a=[],s,o,l,u,c,f;for(l=i(r-t),u=i(n-e),s=t<r?1:-1,o=e<n?1:-1,c=l-u;a.push([t,e]),!(t===r&&e===n);)f=2*c,f>-u&&(c=c-u,t=t+s),f<l&&(c=c+l,e=e+o);return a}Ma.interpolate=Zx;function yge(t){var e=[],r=t.length,n,i,a,s,o,l;if(r<2)return e;for(o=0;o<r-1;++o)for(n=t[o],i=t[o+1],a=Zx(n[0],n[1],i[0],i[1]),s=a.length,l=0;l<s-1;++l)e.push(a[l]);return e.push(t[r-1]),e}Ma.expandPath=yge;function bge(t,e){var r=e.length,n=e[0][0],i=e[0][1],a=e[r-1][0],s=e[r-1][1],o,l,u,c,f,h,p,m,v,y,x;for(o=n,l=i,f=[[o,l]],h=2;h<r;++h){for(m=e[h],u=m[0],c=m[1],v=Zx(o,l,u,c),x=!1,p=1;p<v.length;++p)if(y=v[p],!t.isWalkableAt(y[0],y[1])){x=!0;break}x&&(lastValidCoord=e[h-1],f.push(lastValidCoord),o=lastValidCoord[0],l=lastValidCoord[1])}return f.push([a,s]),f}Ma.smoothenPath=bge;function xge(t){if(t.length<3)return t;var e=[],r=t[0][0],n=t[0][1],i=t[1][0],a=t[1][1],s=i-r,o=a-n,l,u,c,f,h,p;for(h=Math.sqrt(s*s+o*o),s/=h,o/=h,e.push([r,n]),p=2;p<t.length;p++)l=i,u=a,c=s,f=o,i=t[p][0],a=t[p][1],s=i-l,o=a-u,h=Math.sqrt(s*s+o*o),s/=h,o/=h,(s!==c||o!==f)&&e.push([l,u]);return e.push([i,a]),e}Ma.compressPath=xge;var np={manhattan:function(t,e){return t+e},euclidean:function(t,e){return Math.sqrt(t*t+e*e)},octile:function(t,e){var r=Math.SQRT2-1;return t<e?r*t+e:r*e+t},chebyshev:function(t,e){return Math.max(t,e)}},wge=Dg,_ge=Ma,Py=np,Dm=cs;function wO(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.heuristic=t.heuristic||Py.manhattan,this.weight=t.weight||1,this.diagonalMovement=t.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=Dm.OnlyWhenNoObstacles:this.diagonalMovement=Dm.IfAtMostOneObstacle:this.diagonalMovement=Dm.Never),this.diagonalMovement===Dm.Never?this.heuristic=t.heuristic||Py.manhattan:this.heuristic=t.heuristic||Py.octile}wO.prototype.findPath=function(t,e,r,n,i){var a=new wge(function(E,_){return E.f-_.f}),s=i.getNodeAt(t,e),o=i.getNodeAt(r,n),l=this.heuristic,u=this.diagonalMovement,c=this.weight,f=Math.abs,h=Math.SQRT2,p,m,v,y,x,S,b,A;for(s.g=0,s.f=0,a.push(s),s.opened=!0;!a.empty();){if(p=a.pop(),p.closed=!0,p===o)return _ge.backtrace(o);for(m=i.getNeighbors(p,u),y=0,x=m.length;y<x;++y)v=m[y],!v.closed&&(S=v.x,b=v.y,A=p.g+(S-p.x===0||b-p.y===0?1:h),(!v.opened||A<v.g)&&(v.g=A,v.h=v.h||c*l(f(S-r),f(b-n)),v.f=v.g+v.h,v.parent=p,v.opened?a.updateItem(v):(a.push(v),v.opened=!0)))}return[]};var Qx=wO,_O=Qx;function Lv(t){_O.call(this,t);var e=this.heuristic;this.heuristic=function(r,n){return e(r,n)*1e6}}Lv.prototype=new _O;Lv.prototype.constructor=Lv;var Age=Lv,Ege=Ma,$y=cs;function AO(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.diagonalMovement=t.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=$y.OnlyWhenNoObstacles:this.diagonalMovement=$y.IfAtMostOneObstacle:this.diagonalMovement=$y.Never)}AO.prototype.findPath=function(t,e,r,n,i){var a=[],s=this.diagonalMovement,o=i.getNodeAt(t,e),l=i.getNodeAt(r,n),u,c,f,h,p;for(a.push(o),o.opened=!0;a.length;){if(f=a.shift(),f.closed=!0,f===l)return Ege.backtrace(l);for(u=i.getNeighbors(f,s),h=0,p=u.length;h<p;++h)c=u[h],!(c.closed||c.opened)&&(a.push(c),c.opened=!0,c.parent=f)}return[]};var Sge=AO,EO=Qx;function Uv(t){EO.call(this,t),this.heuristic=function(e,r){return 0}}Uv.prototype=new EO;Uv.prototype.constructor=Uv;var Dge=Uv,M2=Dg,I2=Ma,ky=np,Cm=cs;function SO(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.diagonalMovement=t.diagonalMovement,this.heuristic=t.heuristic||ky.manhattan,this.weight=t.weight||1,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=Cm.OnlyWhenNoObstacles:this.diagonalMovement=Cm.IfAtMostOneObstacle:this.diagonalMovement=Cm.Never),this.diagonalMovement===Cm.Never?this.heuristic=t.heuristic||ky.manhattan:this.heuristic=t.heuristic||ky.octile}SO.prototype.findPath=function(t,e,r,n,i){var a=function(N,I){return N.f-I.f},s=new M2(a),o=new M2(a),l=i.getNodeAt(t,e),u=i.getNodeAt(r,n),c=this.heuristic,f=this.diagonalMovement,h=this.weight,p=Math.abs,m=Math.SQRT2,v,y,x,S,b,A,E,_,T=1,M=2;for(l.g=0,l.f=0,s.push(l),l.opened=T,u.g=0,u.f=0,o.push(u),u.opened=M;!s.empty()&&!o.empty();){for(v=s.pop(),v.closed=!0,y=i.getNeighbors(v,f),S=0,b=y.length;S<b;++S)if(x=y[S],!x.closed){if(x.opened===M)return I2.biBacktrace(v,x);A=x.x,E=x.y,_=v.g+(A-v.x===0||E-v.y===0?1:m),(!x.opened||_<x.g)&&(x.g=_,x.h=x.h||h*c(p(A-r),p(E-n)),x.f=x.g+x.h,x.parent=v,x.opened?s.updateItem(x):(s.push(x),x.opened=T))}for(v=o.pop(),v.closed=!0,y=i.getNeighbors(v,f),S=0,b=y.length;S<b;++S)if(x=y[S],!x.closed){if(x.opened===T)return I2.biBacktrace(x,v);A=x.x,E=x.y,_=v.g+(A-v.x===0||E-v.y===0?1:m),(!x.opened||_<x.g)&&(x.g=_,x.h=x.h||h*c(p(A-t),p(E-e)),x.f=x.g+x.h,x.parent=v,x.opened?o.updateItem(x):(o.push(x),x.opened=M))}}return[]};var Jx=SO,DO=Jx;function zv(t){DO.call(this,t);var e=this.heuristic;this.heuristic=function(r,n){return e(r,n)*1e6}}zv.prototype=new DO;zv.prototype.constructor=zv;var Cge=zv,F2=Ma,Ly=cs;function CO(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.diagonalMovement=t.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=Ly.OnlyWhenNoObstacles:this.diagonalMovement=Ly.IfAtMostOneObstacle:this.diagonalMovement=Ly.Never)}CO.prototype.findPath=function(t,e,r,n,i){var a=i.getNodeAt(t,e),s=i.getNodeAt(r,n),o=[],l=[],u,c,f,h=this.diagonalMovement,p=0,m=1,v,y;for(o.push(a),a.opened=!0,a.by=p,l.push(s),s.opened=!0,s.by=m;o.length&&l.length;){for(f=o.shift(),f.closed=!0,u=i.getNeighbors(f,h),v=0,y=u.length;v<y;++v)if(c=u[v],!c.closed){if(c.opened){if(c.by===m)return F2.biBacktrace(f,c);continue}o.push(c),c.parent=f,c.opened=!0,c.by=p}for(f=l.shift(),f.closed=!0,u=i.getNeighbors(f,h),v=0,y=u.length;v<y;++v)if(c=u[v],!c.closed){if(c.opened){if(c.by===p)return F2.biBacktrace(c,f);continue}l.push(c),c.parent=f,c.opened=!0,c.by=m}}return[]};var Tge=CO,TO=Jx;function Gv(t){TO.call(this,t),this.heuristic=function(e,r){return 0}}Gv.prototype=new TO;Gv.prototype.constructor=Gv;var Nge=Gv,Uy=np,O2=Kx,Tm=cs;function NO(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.diagonalMovement=t.diagonalMovement,this.heuristic=t.heuristic||Uy.manhattan,this.weight=t.weight||1,this.trackRecursion=t.trackRecursion||!1,this.timeLimit=t.timeLimit||1/0,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=Tm.OnlyWhenNoObstacles:this.diagonalMovement=Tm.IfAtMostOneObstacle:this.diagonalMovement=Tm.Never),this.diagonalMovement===Tm.Never?this.heuristic=t.heuristic||Uy.manhattan:this.heuristic=t.heuristic||Uy.octile}NO.prototype.findPath=function(t,e,r,n,i){var a=new Date().getTime(),s=(function(v,y){return this.heuristic(Math.abs(y.x-v.x),Math.abs(y.y-v.y))}).bind(this),o=function(v,y){return v.x===y.x||v.y===y.y?1:Math.SQRT2},l=(function(v,y,x,S,b){if(this.timeLimit>0&&new Date().getTime()-a>this.timeLimit*1e3)return 1/0;var A=y+s(v,c)*this.weight;if(A>x)return A;if(v==c)return S[b]=[v.x,v.y],v;var E,_,T,M,N=i.getNeighbors(v,this.diagonalMovement);for(T=0,E=1/0;M=N[T];++T){if(this.trackRecursion&&(M.retainCount=M.retainCount+1||1,M.tested!==!0&&(M.tested=!0)),_=l(M,y+o(v,M),x,S,b+1),_ instanceof O2)return S[b]=[v.x,v.y],_;this.trackRecursion&&--M.retainCount===0&&(M.tested=!1),_<E&&(E=_)}return E}).bind(this),u=i.getNodeAt(t,e),c=i.getNodeAt(r,n),f=s(u,c),h,p,m;for(h=0;;++h){if(p=[],m=l(u,0,f,p,0),m===1/0)return[];if(m instanceof O2)return p;f=m}return[]};var Mge=NO,Ige=Dg,B2=Ma,MO=np;function ew(t){t=t||{},this.heuristic=t.heuristic||MO.manhattan,this.trackJumpRecursion=t.trackJumpRecursion||!1}ew.prototype.findPath=function(t,e,r,n,i){var a=this.openList=new Ige(function(u,c){return u.f-c.f}),s=this.startNode=i.getNodeAt(t,e),o=this.endNode=i.getNodeAt(r,n),l;for(this.grid=i,s.g=0,s.f=0,a.push(s),s.opened=!0;!a.empty();){if(l=a.pop(),l.closed=!0,l===o)return B2.expandPath(B2.backtrace(o));this._identifySuccessors(l)}return[]};ew.prototype._identifySuccessors=function(t){var e=this.grid,r=this.heuristic,n=this.openList,i=this.endNode.x,a=this.endNode.y,s,o,l,u,c,f=t.x,h=t.y,p,m,v,y,x,S=Math.abs;for(s=this._findNeighbors(t),u=0,c=s.length;u<c;++u)if(o=s[u],l=this._jump(o[0],o[1],f,h),l){if(p=l[0],m=l[1],x=e.getNodeAt(p,m),x.closed)continue;v=MO.octile(S(p-f),S(m-h)),y=t.g+v,(!x.opened||y<x.g)&&(x.g=y,x.h=x.h||r(S(p-i),S(m-a)),x.f=x.g+x.h,x.parent=t,x.opened?n.updateItem(x):(n.push(x),x.opened=!0))}};var Cg=ew,IO=Cg,Fge=cs;function hh(t){IO.call(this,t)}hh.prototype=new IO;hh.prototype.constructor=hh;hh.prototype._jump=function(t,e,r,n){var i=this.grid,a=t-r,s=e-n;if(!i.isWalkableAt(t,e))return null;if(this.trackJumpRecursion===!0&&(i.getNodeAt(t,e).tested=!0),i.getNodeAt(t,e)===this.endNode)return[t,e];if(a!==0){if(i.isWalkableAt(t,e-1)&&!i.isWalkableAt(t-a,e-1)||i.isWalkableAt(t,e+1)&&!i.isWalkableAt(t-a,e+1))return[t,e]}else if(s!==0){if(i.isWalkableAt(t-1,e)&&!i.isWalkableAt(t-1,e-s)||i.isWalkableAt(t+1,e)&&!i.isWalkableAt(t+1,e-s))return[t,e];if(this._jump(t+1,e,t,e)||this._jump(t-1,e,t,e))return[t,e]}else throw new Error("Only horizontal and vertical movements are allowed");return this._jump(t+a,e+s,t,e)};hh.prototype._findNeighbors=function(t){var e=t.parent,r=t.x,n=t.y,i=this.grid,a,s,o,l,u=[],c,f,h,p;if(e)a=e.x,s=e.y,o=(r-a)/Math.max(Math.abs(r-a),1),l=(n-s)/Math.max(Math.abs(n-s),1),o!==0?(i.isWalkableAt(r,n-1)&&u.push([r,n-1]),i.isWalkableAt(r,n+1)&&u.push([r,n+1]),i.isWalkableAt(r+o,n)&&u.push([r+o,n])):l!==0&&(i.isWalkableAt(r-1,n)&&u.push([r-1,n]),i.isWalkableAt(r+1,n)&&u.push([r+1,n]),i.isWalkableAt(r,n+l)&&u.push([r,n+l]));else for(c=i.getNeighbors(t,Fge.Never),h=0,p=c.length;h<p;++h)f=c[h],u.push([f.x,f.y]);return u};var Oge=hh,FO=Cg,Bge=cs;function dh(t){FO.call(this,t)}dh.prototype=new FO;dh.prototype.constructor=dh;dh.prototype._jump=function(t,e,r,n){var i=this.grid,a=t-r,s=e-n;if(!i.isWalkableAt(t,e))return null;if(this.trackJumpRecursion===!0&&(i.getNodeAt(t,e).tested=!0),i.getNodeAt(t,e)===this.endNode)return[t,e];if(a!==0&&s!==0){if(i.isWalkableAt(t-a,e+s)&&!i.isWalkableAt(t-a,e)||i.isWalkableAt(t+a,e-s)&&!i.isWalkableAt(t,e-s))return[t,e];if(this._jump(t+a,e,t,e)||this._jump(t,e+s,t,e))return[t,e]}else if(a!==0){if(i.isWalkableAt(t+a,e+1)&&!i.isWalkableAt(t,e+1)||i.isWalkableAt(t+a,e-1)&&!i.isWalkableAt(t,e-1))return[t,e]}else if(i.isWalkableAt(t+1,e+s)&&!i.isWalkableAt(t+1,e)||i.isWalkableAt(t-1,e+s)&&!i.isWalkableAt(t-1,e))return[t,e];return this._jump(t+a,e+s,t,e)};dh.prototype._findNeighbors=function(t){var e=t.parent,r=t.x,n=t.y,i=this.grid,a,s,o,l,u=[],c,f,h,p;if(e)a=e.x,s=e.y,o=(r-a)/Math.max(Math.abs(r-a),1),l=(n-s)/Math.max(Math.abs(n-s),1),o!==0&&l!==0?(i.isWalkableAt(r,n+l)&&u.push([r,n+l]),i.isWalkableAt(r+o,n)&&u.push([r+o,n]),i.isWalkableAt(r+o,n+l)&&u.push([r+o,n+l]),i.isWalkableAt(r-o,n)||u.push([r-o,n+l]),i.isWalkableAt(r,n-l)||u.push([r+o,n-l])):o===0?(i.isWalkableAt(r,n+l)&&u.push([r,n+l]),i.isWalkableAt(r+1,n)||u.push([r+1,n+l]),i.isWalkableAt(r-1,n)||u.push([r-1,n+l])):(i.isWalkableAt(r+o,n)&&u.push([r+o,n]),i.isWalkableAt(r,n+1)||u.push([r+o,n+1]),i.isWalkableAt(r,n-1)||u.push([r+o,n-1]));else for(c=i.getNeighbors(t,Bge.Always),h=0,p=c.length;h<p;++h)f=c[h],u.push([f.x,f.y]);return u};var Rge=dh,OO=Cg,Pge=cs;function ph(t){OO.call(this,t)}ph.prototype=new OO;ph.prototype.constructor=ph;ph.prototype._jump=function(t,e,r,n){var i=this.grid,a=t-r,s=e-n;if(!i.isWalkableAt(t,e))return null;if(this.trackJumpRecursion===!0&&(i.getNodeAt(t,e).tested=!0),i.getNodeAt(t,e)===this.endNode)return[t,e];if(a!==0&&s!==0){if(this._jump(t+a,e,t,e)||this._jump(t,e+s,t,e))return[t,e]}else if(a!==0){if(i.isWalkableAt(t,e-1)&&!i.isWalkableAt(t-a,e-1)||i.isWalkableAt(t,e+1)&&!i.isWalkableAt(t-a,e+1))return[t,e]}else if(s!==0&&(i.isWalkableAt(t-1,e)&&!i.isWalkableAt(t-1,e-s)||i.isWalkableAt(t+1,e)&&!i.isWalkableAt(t+1,e-s)))return[t,e];return i.isWalkableAt(t+a,e)&&i.isWalkableAt(t,e+s)?this._jump(t+a,e+s,t,e):null};ph.prototype._findNeighbors=function(t){var e=t.parent,r=t.x,n=t.y,i=this.grid,a,s,o,l,u=[],c,f,h,p;if(e)if(a=e.x,s=e.y,o=(r-a)/Math.max(Math.abs(r-a),1),l=(n-s)/Math.max(Math.abs(n-s),1),o!==0&&l!==0)i.isWalkableAt(r,n+l)&&u.push([r,n+l]),i.isWalkableAt(r+o,n)&&u.push([r+o,n]),i.isWalkableAt(r,n+l)&&i.isWalkableAt(r+o,n)&&u.push([r+o,n+l]);else{var m;if(o!==0){m=i.isWalkableAt(r+o,n);var v=i.isWalkableAt(r,n+1),y=i.isWalkableAt(r,n-1);m&&(u.push([r+o,n]),v&&u.push([r+o,n+1]),y&&u.push([r+o,n-1])),v&&u.push([r,n+1]),y&&u.push([r,n-1])}else if(l!==0){m=i.isWalkableAt(r,n+l);var x=i.isWalkableAt(r+1,n),S=i.isWalkableAt(r-1,n);m&&(u.push([r,n+l]),x&&u.push([r+1,n+l]),S&&u.push([r-1,n+l])),x&&u.push([r+1,n]),S&&u.push([r-1,n])}}else for(c=i.getNeighbors(t,Pge.OnlyWhenNoObstacles),h=0,p=c.length;h<p;++h)f=c[h],u.push([f.x,f.y]);return u};var $ge=ph,BO=Cg,kge=cs;function mh(t){BO.call(this,t)}mh.prototype=new BO;mh.prototype.constructor=mh;mh.prototype._jump=function(t,e,r,n){var i=this.grid,a=t-r,s=e-n;if(!i.isWalkableAt(t,e))return null;if(this.trackJumpRecursion===!0&&(i.getNodeAt(t,e).tested=!0),i.getNodeAt(t,e)===this.endNode)return[t,e];if(a!==0&&s!==0){if(i.isWalkableAt(t-a,e+s)&&!i.isWalkableAt(t-a,e)||i.isWalkableAt(t+a,e-s)&&!i.isWalkableAt(t,e-s))return[t,e];if(this._jump(t+a,e,t,e)||this._jump(t,e+s,t,e))return[t,e]}else if(a!==0){if(i.isWalkableAt(t+a,e+1)&&!i.isWalkableAt(t,e+1)||i.isWalkableAt(t+a,e-1)&&!i.isWalkableAt(t,e-1))return[t,e]}else if(i.isWalkableAt(t+1,e+s)&&!i.isWalkableAt(t+1,e)||i.isWalkableAt(t-1,e+s)&&!i.isWalkableAt(t-1,e))return[t,e];return i.isWalkableAt(t+a,e)||i.isWalkableAt(t,e+s)?this._jump(t+a,e+s,t,e):null};mh.prototype._findNeighbors=function(t){var e=t.parent,r=t.x,n=t.y,i=this.grid,a,s,o,l,u=[],c,f,h,p;if(e)a=e.x,s=e.y,o=(r-a)/Math.max(Math.abs(r-a),1),l=(n-s)/Math.max(Math.abs(n-s),1),o!==0&&l!==0?(i.isWalkableAt(r,n+l)&&u.push([r,n+l]),i.isWalkableAt(r+o,n)&&u.push([r+o,n]),(i.isWalkableAt(r,n+l)||i.isWalkableAt(r+o,n))&&u.push([r+o,n+l]),!i.isWalkableAt(r-o,n)&&i.isWalkableAt(r,n+l)&&u.push([r-o,n+l]),!i.isWalkableAt(r,n-l)&&i.isWalkableAt(r+o,n)&&u.push([r+o,n-l])):o===0?i.isWalkableAt(r,n+l)&&(u.push([r,n+l]),i.isWalkableAt(r+1,n)||u.push([r+1,n+l]),i.isWalkableAt(r-1,n)||u.push([r-1,n+l])):i.isWalkableAt(r+o,n)&&(u.push([r+o,n]),i.isWalkableAt(r,n+1)||u.push([r+o,n+1]),i.isWalkableAt(r,n-1)||u.push([r+o,n-1]));else for(c=i.getNeighbors(t,kge.IfAtMostOneObstacle),h=0,p=c.length;h<p;++h)f=c[h],u.push([f.x,f.y]);return u};var Lge=mh,zy=cs,Uge=Oge,zge=Rge,Gge=$ge,qge=Lge;function Hge(t){return t=t||{},t.diagonalMovement===zy.Never?new Uge(t):t.diagonalMovement===zy.Always?new zge(t):t.diagonalMovement===zy.OnlyWhenNoObstacles?new Gge(t):new qge(t)}var Wge=Hge,Vge={Heap:Dg,Node:Kx,Grid:mge,Util:Ma,DiagonalMovement:cs,Heuristic:np,AStarFinder:Qx,BestFirstFinder:Age,BreadthFirstFinder:Sge,DijkstraFinder:Dge,BiAStarFinder:Jx,BiBestFirstFinder:Cge,BiBreadthFirstFinder:Tge,BiDijkstraFinder:Nge,IDAStarFinder:Mge,JumpPointFinder:Wge},Xge=Vge;const R2=gl(Xge);function jge(t,e){let r=!1;for(const n of e){if(!n.position)return!1;au(t,n.position)&&n.blocking&&!n.pathThrough&&(r=!0)}return r}const Yge=(t,e,r)=>{const{width:n,height:i}=gt().views.map,a=new R2.Grid(n,i);for(const l of r)if(l.blocking&&!l.pathThrough&&l.position){const{x:u,y:c}=l.position;a.setWalkableAt(u,c,!1)}return a.setWalkableAt(t.x,t.y,!0),a.setWalkableAt(e.x,e.y,!0),new R2.AStarFinder({}).findPath(t.x,t.y,e.x,e.y,a)};function Kge({currentPos:t,targetPos:e,biasDir:r,entities:n,wiggleChance:i=.5,maxTries:a=10}){const s=Zge(r,i);for(let o=0;o<Math.min(a,s.length);o++){const l=s[o],u={x:t.x+l.x,y:t.y+l.y};if(e&&au(u,e)||!jge(u,n))return u}return t}function Zge(t,e){const n=Qf.map(i=>({dir:i,score:Qge(i,t)+(Math.random()-.5)*e}));return n.sort((i,a)=>a.score-i.score),n.map(i=>i.dir)}function Qge(t,e){return t.x*e.x+t.y*e.y}function RO(t,e,r,n,i=!1){const a=new Map,s=[{pos:t,strength:e}];for(;s.length;){const{pos:o,strength:l}=s.shift(),u=Ir(o);if(!(a.has(u)||l<=0)){a.set(u,l);for(const c of Qf){const f={x:o.x+c.x,y:o.y+c.y};Eg(f)||(n(f)&&s.push({pos:f,strength:l/1.5}),r(f)||s.push({pos:f,strength:l-1}))}}}if(i){const o=new Map;for(const[l,u]of a.entries())o.set(l,{strength:u});return o}return a}const Jge=({world:t,registry:e})=>{const r=t.with("ai","position","memory"),n=t.with("position");return function(){var a;for(const s of r){if(s.onFire&&!((a=s.immunities)!=null&&a.includes(Kr.Fire))){const c=zq(s.position);t.addComponent(s,"tryMove",c);continue}let o,l=!1;const u={sentients:[],items:[],dead:[],unknown:[]};for(const[c,f]of s.memory.memories){const h=e.get(f.id);if(h){if(h.pc||h.ai){u.sentients.push(f);continue}if(h.pickUp){u.items.push(f);continue}u.unknown.push(f)}}if(u.sentients.length&&!l){const c=[];u.sentients.forEach(h=>{const p=e.get(h.id);p&&s.entityKind&&p.entityKind&&c.push({id:p.id,disposition:gO(s,p)})});const f=Qt.sortBy(c,"disposition");if(f.length){const h=f[0].id,p=u.sentients.find(m=>m.id===h);p&&(o={...p},l=!0)}}if(u.unknown.length&&!l){const[c]=u.unknown;o={...c},l=!0}if(l&&o)if(o.perceivedVia==="hearing"){const c=Yge(s.position,o.position,n.entities);if(c[1]){const f={x:c[1][0],y:c[1][1]};t.addComponent(s,"tryMove",f)}}else{const c=Kge({currentPos:s.position,biasDir:DM(o.position,s.position),targetPos:o.position,entities:n.entities,wiggleChance:2});t.addComponent(s,"tryMove",c)}}}},e0e=({world:t,registry:e})=>{const r=t.with("tryAttack"),n=i=>{t.removeComponent(i,"tryAttack")};return function(){for(const a of r){const s=e.get(a.tryAttack.targetId),o=a.tryAttack.attack||t0e(a,e),l=o&&o.natural?void 0:PO(a,e);if(!s)return console.log(`${a.name} has no target`),n(a);if(!o)return console.log(`${a.name} has no means of attack`),n(a);const u=Math.random()<.05;let c=r0e(a,o,s,u,l);s.damages&&s.damages.push(...c),o.knockbackDistance&&t.addComponent(s,"knockback",{actorId:a.id,targetId:s.id,distance:o.knockbackDistance}),t.addComponent(a,"sound",{strength:50}),n(a)}}};function PO(t,e){var n;const r=(n=t.weaponSlot)==null?void 0:n.contents[0];if(r)return e.get(r)}function t0e(t,e){const r=PO(t,e);let n;return r?n=Qt.sample(r.attacks):n=Qt.sample(t.attacks),n||!1}function r0e(t,e,r,n,i){let a=new bo(e.damageRoll).total,s=0;return e.attackType==="melee"?e.useModifier&&t.strength&&(s=n0e(t.strength)):console.log("not a melee attack",t,e),[{attacker:t.id,instigator:t.id,responder:r.id,attack:e,target:r.id,critical:n,weapon:i==null?void 0:i.id,damageAmounts:[{type:e.damageType,amount:Math.max(0,a),mod:s}]}]}const n0e=t=>Math.floor((t-10)/2),i0e=({world:t})=>{const e=t.with("calculateFlammability");return function(){for(const n of e){const{material:i,mass:a}=n;if(i&&a){const s=Of(i,a);s&&(n.flammable?n.flammable={...n.flammable,...s}:t.addComponent(n,"flammable",s))}else t.removeComponent(n,"flammable");t.removeComponent(n,"calculateFlammability")}}},a0e=({world:t})=>{const e=t.with("tryClose");return function(){var i;for(const a of e){const s=a.tryClose;((i=s.openable)==null?void 0:i.state)===Da.Open?(r(s),Dn(`${su(a)} closes the ${su(s)}`)):Dn(`${su(s)} cannot be closed.`),t.removeComponent(a,"tryClose")}};function r(n){t.addComponent(n,"opaque",!0),t.addComponent(n,"blocking",!0),n.appearance&&(n.appearance.char=dn.doorClosed),n.openable&&(n.openable.state=Da.Closed)}},s0e=({world:t})=>{const e=t.with("revealed","position");return function(){const n=Ir(gt().cursor[1]),i=[],a=[],s=[];for(const o of e)n===Ir(o.position)&&(o.layer100&&i.push(o),o.layer200&&a.push(o),o.layer300&&s.push(o));if(i.length){let o="";const l=[];if(i.forEach(u=>l.push(u.name)),i[0].inFov?o+="You see ":o+="You recall seeing ",s.length||a.length){const u=[];s.forEach(c=>u.push(c.name)),a.forEach(c=>u.push(c.name)),u.length&&(u.forEach((c,f)=>{u.length>1&&f===u.length-1?o+=`and a ${c} `:o+=`a ${c} `}),o+=`on the ${l[0]}`)}else o+=`the ${l[0]}`;$n(o,"sight")}else $n("","sight")}},o0e=({world:t,registry:e})=>{const r=t.with("damages");return function(){for(const i of r){for(const a of i.damages){const s=a.attacker?e.get(a.attacker):null,o=a.instigator?e.get(a.instigator):null,l=a.responder?e.get(a.responder):null,u=a.attack,c=a.weapon?e.get(a.weapon):null;let f=0,h=!1,p=!1,m=!1;for(const y of a.damageAmounts){let x=y.amount;const S=new Set,b=new Set,A=new Set,E=Sg(i);E!=null&&E.vulnerabilities&&E.vulnerabilities.forEach(T=>S.add(T)),i.vulnerabilities&&i.vulnerabilities.forEach(T=>S.add(T)),E!=null&&E.resistances&&E.resistances.forEach(T=>b.add(T)),i.resistances&&i.resistances.forEach(T=>b.add(T)),E!=null&&E.immunities&&E.immunities.forEach(T=>A.add(T)),i.immunities&&i.immunities.forEach(T=>A.add(T)),S.has(y.type)&&(h=!0,x*=2),b.has(y.type)&&(p=!0,x=Math.floor(x/2)),A.has(y.type)&&(m=!0,x=0),a.critical&&(x*=2);const _=u0e(E);x+=y.mod,f+=x,f-=_}if(f<0&&(f=0),i.health&&(i.health.current-=f),(s==null?void 0:s.pc)||(o==null?void 0:o.pc)||i.pc){let y=[];if(!s&&o===i)y.push("§red§You hurt yourself"),l&&y.push(`on the ${wf(l)}§red§`),a.reason&&y.push(`(${a.reason})`);else if(!s&&o&&l)y.push(`${wf(o)}§red§ was hurt by ${wf(l)}§red§`),a.reason&&y.push(`(${a.reason})`);else if(s&&u){let x=s.pc?"§purple§":"§red§";y.push(`${wf(s)}${x} ${u.verb} ${wf(i)}${x}`),c&&y.push(`with ${wf(c)}${x}`)}i.dead?y.push("but it's already dead."):(y.push(`for ${f}hp!`),h&&y.unshift("Vulnerable!"),p&&y.unshift("Resistant!"),m&&y.unshift("Immune!"),a.critical&&y.unshift("Critical!")),Dn(y.join(" "))}}i.damages=[]}}};function u0e(t){if(!t||!t.damageReduction)return 0;const{min:e,max:r}=t.damageReduction;return Qt.random(e,r)}const l0e=({world:t,registry:e})=>{const r=t.with("tryDrop"),n=t.with("position","pickUp"),i=t.with("position","blocking");return function(){var s,o,l;for(const u of r){const c=u.tryDrop.dropperId,f=e.get(c);if(!f){console.log(`dropperId: ${c} does not exist`),Hi(u),t.removeComponent(u,"tryDrop");break}const h=u.id;if(!h){console.log("Entity does not have an id."),Hi(u),t.removeComponent(u,"tryDrop");break}if(!((s=f==null?void 0:f.container)!=null&&s.contents.includes(h))){console.log(`${f.name} is not holding ${u.name}`),Hi(f),Hi(u),t.removeComponent(u,"tryDrop");break}const{position:p}=f;if(!p){console.log(`${f.name} has no position and cannot drop ${u.name}`),Hi(f),Hi(u),t.removeComponent(u,"tryDrop");break}const m=new Set(Rq(p,2).posIds);for(const x of n)m.delete(Ir(x.position));for(const x of i)m.delete(Ir(x.position));if(m.size){const x=Qt.sample([...m]);if(!x)return;vl(t,u,{...fl(x)})}else vl(t,u,p);Qt.remove(f.container.contents,x=>h===x),t.removeComponent(u,"tryDrop");const v=((o=f.appearance)==null?void 0:o.tint)||65280,y=((l=u.appearance)==null?void 0:l.tint)||65280;Dn(`${ss(v)}${f.name}§purple§ drops ${ss(y)}${u.name}`)}}},c0e=[{xx:1,xy:0,yx:0,yy:1},{xx:1,xy:0,yx:0,yy:-1},{xx:-1,xy:0,yx:0,yy:1},{xx:-1,xy:0,yx:0,yy:-1},{xx:0,xy:1,yx:1,yy:0},{xx:0,xy:1,yx:-1,yy:0},{xx:0,xy:-1,yx:1,yy:0},{xx:0,xy:-1,yx:-1,yy:0}];function tw(t,e,r,n,i){const{x:a,y:s}=n,o=new Set,l=new Set;for(const h of t)l.add(Ir(h.position));const u=(h,p)=>{const m=`${h},${p}`;return!!l.has(m)},c=(h,p)=>o.add(`${h},${p}`);function f(h,p,m,v,y,x,S){let b=0;if(v<y)return;let A=!1;for(let E=m;E<S&&!A;E++){const _=-E;for(let T=-E;T<=0;T++){const M=h+T*x.xx+_*x.xy,N=p+T*x.yx+_*x.yy,I=(T-.5)/(_+.5),F=(T+.5)/(_-.5);if(!(!(M>=0&&N>=0&&M<e&&N<r)||v<F)){if(y>I)break;if(Math.sqrt(T*T+_*_)<=S&&c(M,N),A)if(u(M,N)){b=F;continue}else A=!1,v=b;else u(M,N)&&E<S&&(A=!0,f(h,p,E+1,v,I,x,S),b=F)}}}}c(a,s);for(const h of c0e)f(a,s,1,1,0,h,i);return{fov:o}}const f0e=({world:t})=>{const e=t.with("inFov","position"),r=t.with("opaque","position"),n=t.with("pc","position"),i=t.with("appearance","position"),a=t.with("ai","inFov").without("pc"),s=t.with("pickUp","inFov","position").without("pc");return function(){let l;for(const c of n)l=c;if(!l)return;const u=tw(r,74,39,l.position,100);for(const c of e)t.removeComponent(c,"inFov");for(const c of i)u.fov.has(Ir(c.position))&&(t.addComponent(c,"inFov",!0),t.addComponent(c,"revealed",!0));return a.size?a.size===1?$n("You see a threat","sight"):$n("You see threats","sight"):s.size?s.size===1?$n("You see something on the floor","sight"):$n("You see things on the floor","sight"):$n("","sight")}},h0e={width:Ec.map.width,height:Ec.map.height},d0e=({world:t,registry:e})=>{const r=t.with("onFire","flammable","position"),n=t.with("opaque","position");return function(){for(const a of r){if(!a.position)continue;a.onFire&&a.appearance&&(a.appearance.tint=16540672);let s=[];if(a.flammable.explosive){const o=tw(n,Ec.map.width,Ec.map.height,a.position,3);s=Array.from(o.fov).map(fl)}else s=Jf(a.position,"cardinal",h0e,!1);for(const o of s){const l=jx(Ir(o));if(l){let u=!0;for(const c of l){const f=e.get(c);if(f!=null&&f.fluidContainer){const{lava:h,oil:p,blood:m,water:v}=f.fluidContainer.fluids;if(h.volume>0||p.volume>0)continue;(m.volume>0||v.volume>0)&&(u=!1)}}if(!u)continue;for(const c of l){const f=e.get(c);f&&f.flammable&&!f.onFire&&Math.random()<f.flammable.ignitionChance&&t.addComponent(f,"onFire",{intensity:1,age:0})}}}if(a.flammable.fuel.current>0&&(a.flammable.fuel.current-=a.onFire.intensity,a.fluidContainer&&(a.fluidContainer.fluids.oil.volume-=a.onFire.intensity)),!!a.onFire){if(a.health){const o={attacker:null,instigator:a.id,responder:null,target:a.id,reason:`burned ${a.name}`,critical:!1,damageAmounts:[{type:Kr.Fire,amount:a.health.max/5,mod:0}]};a.damages||(a.damages=[]),a.damages.push(o)}a.onFire.source||a.flammable.fuel.current<=0&&a.onFire&&(t.removeComponent(a,"onFire"),t.removeComponent(a,"flammable"),a.mutable?t.addComponent(a,"mutateTo",{name:"burnt"}):a.appearance&&(a.appearance.tint=rn.ash))}}}},p0e={width:Ec.map.width,height:Ec.map.height},m0e=({world:t,registry:e})=>{const r=t.with("fluidContainer","position");return function(){const i={};for(const s of r){const o=s.fluidContainer;if(!o.fluids||Object.keys(o.fluids).length<=0)continue;const l=Jf(s.position,"cardinal",p0e,!1);for(const u of l){const c=jx(Ir(u));if(!(!c||!c.size))for(const f of c){const h=e.get(f);if(!h||!h.fluidContainer||h.id===s.id)continue;const p=h.fluidContainer;for(const m in o.fluids){const v=o.fluids[m];if(v.volume<v.minFlow)continue;let y;if(p.fluids[m]){y=p.fluids[m];const x=v.volume-y.volume;if(Math.abs(x)<.001)continue;let S=x*(v.viscosity||1);const b=y.maxVolume-y.volume;if(b<=0||(S=Math.min(S,b),S<=0))continue;i[s.id]||(i[s.id]={}),i[s.id][m]=(i[s.id][m]||0)-S,i[h.id]||(i[h.id]={}),i[h.id][m]=(i[h.id][m]||0)+S}}}}}for(const s in i){const o=e.get(s);if(!(o!=null&&o.fluidContainer))continue;const l=o.fluidContainer;if(l.fluids)for(const u in i[s]){const c=i[s][u];l.fluids[u].volume+=c,l.fluids[u].volume<1e-4&&(l.fluids[u].volume=0),l.fluids[u].volume>l.fluids[u].maxVolume&&(l.fluids[u].volume=l.fluids[u].maxVolume),u==="lava"&&(l.fluids.water.volume=0,l.fluids.blood.volume=0)}}const a=["lava","water","blood","oil"];for(const s of r){const o=s.fluidContainer;for(const l of a)l==="water"&&o.fluids[l].volume>0&&(s.flammable=Of(kn.Water,o.fluids[l].volume)),l==="blood"&&o.fluids[l].volume>0&&(s.flammable=Of(kn.Blood,o.fluids[l].volume)),l==="oil"&&o.fluids[l].volume>0&&(s.flammable=Of(kn.Oil,o.fluids[l].volume)),l==="lava"&&o.fluids[l].volume>0&&(s.flammable=Of(kn.Lava,o.fluids[l].volume),t.addComponent(s,"onFire",{intensity:1,age:0,source:!0}))}}},v0e=({world:t})=>{const e=t.with("mutable"),r=t.with("mutateTo");return function(){for(const i of e){const a=i.mutable.mutations.find(s=>s.name===i.mutable.current);if(a&&a.next&&Math.random()<a.chanceToMutate){const s=i.mutable.mutations.find(o=>o.name===a.next);s&&(P2(t,i,s),i.mutable.current=s.name)}}for(const i of r){if(i.mutable){const a=i.mutable.mutations.find(s=>s.name===i.mutateTo.name);a&&(P2(t,i,a),i.mutable.current=a.name)}t.removeComponent(i,"mutateTo")}}};function P2(t,e,r){if(!e.mutable)return;const n=r.addComponents;if(n){const a=["boolean","number","string"];for(const[s,o]of Object.entries(n))if(t.removeComponent(e,s),a.includes(typeof o))t.addComponent(e,s,o);else{const l=Qt.cloneDeep(o);t.addComponent(e,s,l)}}const i=r.removeComponents;if(i)for(const a of i)t.removeComponent(e,a)}const g0e=({world:t,registry:e})=>{const r=t.with("position","appearance","layer100"),n=t.with("position","appearance","layer200"),i=t.with("position","appearance","layer250"),a=t.with("position","appearance","layer300"),s=t.with("position","appearance","layer400");return function(){const u=gt().playerId,c=e.get(u);if(!c)return;const{interactDirection:f}=c;if(!f)return;const h=[];for(const p of s)au(p.position,f)&&h.push(p);if(!h.length)for(const p of a)au(p.position,f)&&h.push(p);if(!h.length)for(const p of i)au(p.position,f)&&h.push(p);if(!h.length)for(const p of n)au(p.position,f)&&h.push(p);if(!h.length)for(const p of r)au(p.position,f)&&h.push(p);if(h.length){const p=o(h[0]);ln(m=>{m.interactTargets=h,m.interactActions=p})}else Dn("There is nothing there.");t.removeComponent(c,"interactDirection")};function o(l){let u="";return l.pickUp&&(u+=`(${kr("g")})get `),l.health&&l.health.current>0&&(u+=`(${kr("a")})attack `),l.kickable&&(u+=`(${kr("k")})kick `),l.openable&&(l.openable.state===Da.Open&&(u+=`(${kr("c")})close `),l.openable.state===Da.Closed&&(u+=`(${kr("o")})open `)),u}},y0e=({world:t,registry:e})=>{const r=t.with("tryKick");return function(){var i;for(const a of r){const{targetId:s}=a.tryKick,o=e.get(s);if(!o)return;if(o.kickable){const l=a.position,u=o.position;if(!l||!u)return;if(o.kickable.breakable){const c=(i=a.attacks)==null?void 0:i.find(f=>f.name==="Kick");c&&t.addComponent(a,"tryAttack",{targetId:o.id,attack:c,immovableTarget:o.kickable.immovable})}if(o.kickable.harmfulToKicker,o.kickable.immovable&&o.kickable.maxDamageOnKick){const c=Qt.random(1,o.kickable.maxDamageOnKick),f={attacker:null,instigator:a.id,responder:o.id,target:a.id,reason:`kicked ${o.name}`,critical:!1,damageAmounts:[{type:Kr.Bludgeoning,amount:c,mod:0}]};a.damages||(a.damages=[]),a.damages.push(f)}o.kickable.isTrapped,o.kickable.noiseLevel&&t.addComponent(o,"sound",{strength:o.kickable.noiseLevel})}else console.log("unkickable",o);t.removeComponent(a,"tryKick")}}},b0e=({world:t,registry:e})=>{const r=t.with("knockback"),n=t.with("blocking","position");return function(){var a;for(const s of r){const{actorId:o,distance:l}=s.knockback,u=e.get(o);if(!u||(a=s.effectImmunities)!=null&&a.includes(Lb.Knockback))return;if(l&&u.position&&s.position){const c=DM(s.position,u.position),f=Gq(s.position,c,l);let h,p,m=!1;const v=Mf(s.position,f);for(let y=0;y<Qt.tail(v).length;y++){const x=Qt.tail(v)[y];for(const S of n)if(Gx(S.position,x)){m=!0,h=S,p=v[y];break}if(m)break}if(m){const y=p;y&&(s.position={...y}),h!=null&&h.health&&lO(u,h,s)}else s.position={...f}}t.removeComponent(s,"knockback")}}},x0e=t=>{const{world:e,registry:r}=t,n=e.with("vision","memory").without("dead"),i=e.with("nose","memory").without("dead"),a=e.with("ears","memory").without("dead"),s=e.with("memory").without("dead");return function(){for(const l of a){const u=new Map;l.ears.detected.forEach(c=>{u.has(c.eId)?u.get(c.eId).strength<c.strength&&u.set(c.eId,c):u.set(c.eId,c)}),u.forEach(c=>{const f=r.get(c.eId);if(!f||!f.position)return;const h={actor:l,target:f,position:{...f.position},perceivedVia:zm.Hearing};Gy(h)})}for(const l of i){const u=new Map;l.nose.detected.forEach(c=>{u.has(c.eId)?u.get(c.eId).strength<c.strength&&u.set(c.eId,c):u.set(c.eId,c)}),u.forEach(c=>{const f=r.get(c.eId);if(!f)return;const h={actor:l,target:f,position:{...fl(c.posId)},perceivedVia:zm.Smell};Gy(h)})}for(const l of n)for(const u of l.vision.visible){const c=r.get(u);c&&c.id!==l.id&&c.position&&_0e(c)&&Gy({actor:l,target:c,position:{...c.position},perceivedVia:zm.Sight})}for(const l of s)w0e(l)}};function Gy({actor:t,target:e,position:r,perceivedVia:n,strength:i}){if(!t.memory)return;t.memory.memories||(t.memory.memories=new Map);const a={id:e.id,position:r,turn:gt().turnNumber,perceivedVia:n,strength:i};t.memory.memories.set(a.id,a)}function w0e(t){if(!t.memory)return;if(!t.memory.memories)return console.log(t);const{turnNumber:e}=gt(),r=((t==null?void 0:t.intelligence)||0)*2;for(const[n,i]of t.memory.memories)e-i.turn>=r&&t.memory.memories.delete(i.id)}function _0e(t){return!!(t.ai||t.pc||t.pickUp)}const A0e=({world:t,registry:e})=>{const r=t.with("health").without("dead");return function(){var i,a;for(const s of r)if(s.health.current<=0){if(s.appearance&&(s.appearance.char="corpse"),Hx(s),Vx(s),(i=s.container)!=null&&i.contents)for(const l of s.container.contents){const u=e.get(l);u&&t.addComponent(u,"tryDrop",{dropperId:s.id})}const o=((a=s.appearance)==null?void 0:a.tint)||65280;s.ai?Dn(`${ss(o)}${s.name}§purple§ has died!`):Dn(`${ss(o)}${s.name}§purple§ has been destroyed!`),t.removeComponent(s,"ai"),t.removeComponent(s,"blocking"),t.removeComponent(s,"opaque"),t.removeComponent(s,"layer300"),t.addComponent(s,"dead",!0),t.addComponent(s,"pickUp",!0),t.addComponent(s,"layer200",!0),s.pc&&(ln(l=>l.gameState=At.GAME_OVER),console.log("Game Over!"))}}},E0e=({world:t})=>{const e=t.with("position","tryMove"),r=t.with("blocking","position");return function(){for(const i of e){const{tryMove:a}=i;let s=!1;for(const o of r)if(o.position.x===a.x&&o.position.y===a.y){t.removeComponent(i,"tryMove"),o.openable?t.addComponent(i,"tryOpen",{id:o.id}):o.health?(i.pc||gO(i,o)===-2)&&t.addComponent(i,"tryAttack",{targetId:o.id}):i.pc&&Dn(`${i.name} blocked by ${o.name}`),s=!0;break}s||(vl(t,i,a),t.addComponent(i,"sound",{strength:10}),t.removeComponent(i,"tryMove"))}}},S0e=t=>{const{world:e,registry:r}=t,n=e.with("odor","position"),i=e.with("blocking","position"),a=e.with("blocking","position","pathThrough");return function(){const o=new Map,l=new Set,u=new Set;for(const[c,f]of gt().odorMap.entries()){for(const[h,p]of Object.entries(f)){const m=p.strength-.25;m<=0?delete f[h]:f[h]={strength:m}}Object.keys(f).length===0&&ln(h=>{h.odorMap.delete(c)})}for(const c of i)l.add(Ir(c.position));for(const c of a)u.add(Ir(c.position));for(const c of n){const f=jx(Ir(c.position));if(!f)continue;let h=!0;for(const m of f){const v=r.get(m);v!=null&&v.fluidContainer&&Qt.some(v.fluidContainer.fluids,y=>y.volume>0)&&(h=!1)}if(!h)continue;const p=RO(c.position,c.odor.strength,m=>l.has(Ir(m)),m=>u.has(Ir(m)),!0);for(const[m,v]of p){const{odorMap:y}=gt();y.has(m)||ln(x=>{x.odorMap.set(m,{[c.id]:{strength:0}})}),y.get(m)[c.id]||ln(x=>{x.odorMap.get(m)[c.id]={strength:0}}),y.get(m)[c.id].strength=Math.max(v.strength,y.get(m)[c.id].strength??0)}o.set(c.id,p)}}},D0e=({world:t,registry:e})=>{const r=t.with("tryOpen");return function(){var s,o,l,u,c,f,h,p,m,v,y,x,S;for(const b of r){const A=e.get(b.tryOpen.id);if(!A)return;((s=A.openable)==null?void 0:s.state)===Da.Open&&Dn(`${su(A)} is open.`),((o=A.openable)==null?void 0:o.state)===Da.Closed&&(n(b)?(i(A),b.pc&&Dn(`${su(b)} opens the ${su(A)}`)):b.pc&&Dn(`${su(b)} is not intelligent enough to open the ${su(A)}`),t.removeComponent(b,"tryOpen")),(l=A.openable)==null||l.state,Da.Ajar,(u=A.openable)==null||u.state,Da.Jammed,(c=A.openable)==null||c.state,Da.Broken,(f=A.openable)==null||f.state,Da.Sealed,(h=A.openable)!=null&&h.isLocked,(p=A.openable)!=null&&p.isTrapped,(m=A.openable)!=null&&m.requiresTool,(v=A.openable)!=null&&v.isOneWay,(y=A.openable)!=null&&y.isAutoClosing,(x=A.openable)!=null&&x.isSilent,(S=A.openable)!=null&&S.hasBeenOpened}};function n(a){return!!(a.intelligence&&a.intelligence>3)}function i(a){t.removeComponent(a,"opaque"),t.removeComponent(a,"blocking"),a.openable&&(a.openable.hasBeenOpened=!0,a.openable.state=Da.Open),a.appearance&&(a.appearance.char=dn.doorOpen)}},C0e=t=>{const{world:e,registry:r}=t,n=e.with("ai"),i=e.with("opaque","position"),a=e.with("appearance","position"),s=e.with("nose","position","ai"),o=e.with("ears","position","ai");return function(){var h;ln(p=>p.visionMap=[]);const u=r.get(gt().playerId);for(const p of n)if(p.vision&&p.position){p.vision.visible=[];const m=tw(i,74,39,p.position,p.vision.range);ln(v=>v.visionMap.push({fov:m.fov,canSeePc:!1}));for(const v of a)m.fov.has(Ir(v.position))&&((h=p.vision)==null||h.visible.push(v.id))}const c=gt().odorMap;if(u&&u.position){const p=Ir(u.position),m=c.get(p);if(!m)return $n("","smell");const v=N0e(m,gt().playerId);v&&M0e(v,t)}for(const p of s){const{position:m}=p,v=Jf(m,"cardinal",{width:hu.dungeonWidth,height:hu.dungeonHeight},!0),{odorMap:y}=gt(),x=F0e(v,y,p);p.nose.detected=Qt.flatMap(x)}const f=gt().soundMap;if(u&&u.position){const p=Ir(u.position),m=f.get(p);if(!m)return $n("","hearing");const v=T0e(m,gt().playerId);v&&I0e(v,t)}for(const p of o){const{position:m}=p,v=Jf(m,"cardinal",{width:hu.dungeonWidth,height:hu.dungeonHeight},!0),{soundMap:y}=gt(),x=O0e(v,y,p);p.ears.detected=Qt.flatMap(x)}}};function T0e(t,e){return Object.entries(t).filter(([r])=>r!==e).sort((r,n)=>n[1].strength-r[1].strength)[0]}function N0e(t,e){return Object.entries(t).filter(([r])=>r!==e).sort((r,n)=>n[1].strength-r[1].strength)[0]}function M0e(t,e){const r=t[0],n=t[1].strength,i=e.registry.get(r);if(i){if(n>=8)return $n(`Intense smell of ${i.name}`,"smell");if(n>=6)return $n(`Strong smell of ${i.name}`,"smell");if(n>=4)return $n(`Noticable smell of ${i.name}`,"smell");if(n>=2)return $n(`Mild smell of ${i.name}`,"smell");if(n>=1)return $n(`Faint smell of ${i.name}`,"smell");if(n>0)return $n(`Trace smell of ${i.name}`,"smell")}}function I0e(t,e){const r=t[0],n=t[1].strength,i=e.registry.get(r);if(i){if(n>=8)return $n(`Deafening sound of ${i.name}`,"hearing");if(n>=6)return $n(`Loud sound of ${i.name}`,"hearing");if(n>=4)return $n(`Clear sound of ${i.name}`,"hearing");if(n>=2)return $n(`Muffled sound of ${i.name}`,"hearing");if(n>=1)return $n(`Faint sound of ${i.name}`,"hearing");if(n>0)return $n(`Whispered sound of ${i.name}`,"hearing")}}function F0e(t,e,r){return Qt.compact(t.map(n=>{const i=e.get(n);if(i){const a=Object.entries(i).map(([s,o])=>{if(s!==r.id)return{eId:s,strength:o.strength,posId:n}});return Qt.compact(a)}}))}function O0e(t,e,r){return Qt.compact(t.map(n=>{const i=e.get(n);if(i){const a=Object.entries(i).map(([s,o])=>{if(s!==r.id)return{eId:s,strength:o.strength,posId:n}});return Qt.compact(a)}}))}const B0e=({world:t,registry:e})=>{const r=t.with("pc"),n=t.with("tryPickUp");return function(){var s,o,l,u;const[a]=r;for(const c of n){if(!c.pickUp){console.log("Entity is not a pickup"),Hi(c);break}const{pickerId:f}=c.tryPickUp,h=e.get(f);if(!h){console.log(`pickerId ${f} does not exist`);break}const{container:p}=h;if(!p){console.log("Picker has no container"),Hi(h),h===a&&Dn("You have nowhere to put that."),t.removeComponent(c,"tryPickUp");break}if(p.contents.length>=p.slots){console.log("Picker has no room in container"),Hi(h),h===a&&Dn(`You have no room in your ${(s=a==null?void 0:a.container)==null?void 0:s.name}.`),t.removeComponent(c,"tryPickUp");break}const m=c.id;if(Qt.isUndefined(m)){console.log(`pickupId ${m} does not exist`),t.removeComponent(c,"tryPickUp");break}p.contents.push(m),t.removeComponent(c,"tryPickUp"),Xx(t,c);const v=((o=h.appearance)==null?void 0:o.tint)||65280,y=((l=c.appearance)==null?void 0:l.tint)||65280;Dn(`${ss(v)}${h.name}§purple§ puts ${ss(y)}${c.name}§purple§ in ${(u=h==null?void 0:h.container)==null?void 0:u.name}`)}}},R0e=({views:t,queries:e})=>{const r=t.legend;if(r){const n=[],[i]=e.pcQuery;for(const s of e.inFovQuery)n.push(s);n.sort(s=>Uq(i.position,s.position)),r.clearView();const a=[];n.forEach(s=>{const o=s.appearance.char,l=s.appearance.tint,u=s.name,c=`${ss(l)}${o} ${u}`;a.push([{string:c}])}),r==null||r.updateRows(a,!0)}},P0e=({views:t,queries:e})=>{const r=t.map;if(r){r.clearView();const n=[e.renderable100Query,e.renderable125Query,e.renderable200Query,e.renderable225Query,e.renderable250Query,e.renderable300Query,e.renderable325Query,e.renderable350Query,e.renderable400Query];for(const i of n)for(const a of i)a.inFov&&qy(r,a,1,0);for(const i of n)for(const a of i)!a.inFov&&a.revealed&&!a.ai&&qy(r,a,.35,1265039);if(gt().gameState.startsWith(At.MAKER_MODE)||gt().cheats.seeAll)for(const i of n)for(const a of i)qy(r,a,1,0)}},$0e=({views:t,world:e})=>{const r=t.mapFire;if(r){r.clearView();const n=e.with("onFire","position");for(const i of n){if(i.inFov){const{x:a,y:s}=i.position;r==null||r.updateCell({0:{char:dn.fire,tint:rn.fire,tileSet:"kenny",x:a,y:s,alpha:.75}})}if(gt().gameState.startsWith(At.MAKER_MODE)||gt().cheats.seeAll){const{x:a,y:s}=i.position;r==null||r.updateCell({0:{char:dn.fire,tint:rn.fire,tileSet:"kenny",x:a,y:s,alpha:.75}})}}}},k0e=({views:t,world:e})=>{const r=t.mapFluid;if(r){r.clearView();const n=e.with("fluidContainer","position");for(const i of n){const{x:a,y:s}=i.position;if(i.inFov&&$2(r,i),!i.inFov&&i.revealed){const{alpha:o}=$O(i);r==null||r.updateCell({0:{char:"",tint:1265039,tileSet:"tile",x:a,y:s,alpha:Math.min(.15,o)}})}(gt().gameState.startsWith(At.MAKER_MODE)||gt().cheats.seeAll)&&$2(r,i)}}};function $O(t){const e={lavaAlpha:0,oilAlpha:0,bloodAlpha:0,waterAlpha:0,alpha:0};if(!t.fluidContainer)return e;const{lava:r,oil:n,blood:i,water:a}=t.fluidContainer.fluids;return e.lavaAlpha=r.volume/r.maxVolume*10,e.oilAlpha=n.volume/n.maxVolume*10,e.bloodAlpha=i.volume/i.maxVolume*10,e.waterAlpha=a.volume/a.maxVolume*10,e.alpha=e.lavaAlpha+e.oilAlpha+e.bloodAlpha+e.waterAlpha,e}function $2(t,e){if(!e.position||!e.fluidContainer)return;const{x:r,y:n}=e.position,{lava:i,oil:a,blood:s,water:o}=e.fluidContainer.fluids,{lavaAlpha:l,oilAlpha:u,waterAlpha:c,bloodAlpha:f}=$O(e);t==null||t.updateCell({0:{char:"",tint:i.tint||16777215,tileSet:"tile",x:r,y:n,alpha:l},1:{char:"",tint:a.tint||16777215,tileSet:"tile",x:r,y:n,alpha:u},2:{char:"",tint:s.tint||16777215,tileSet:"tile",x:r,y:n,alpha:f},3:{char:"",tint:o.tint||16777215,tileSet:"tile",x:r,y:n,alpha:c}})}const L0e=({views:t})=>{const e=t.odorMap;if(e)if(gt().cheats.seeOdorMap){if(e.show(),e.clearView(),gt().odorMap)for(const[r,n]of gt().odorMap.entries()){let i=0;for(const[o,{strength:l}]of Object.entries(n))i+=l;const a=i/30*.3,s=Math.min(1,a);e==null||e.updateCell({0:{char:"",tint:16776960,alpha:s,tileSet:"tile",...fl(r)}})}}else e.hide()},U0e=({views:t})=>{const e=t.visionMap;e&&(gt().cheats.seeVisionMap?(e.show(),e.clearView(),gt().visionMap.forEach(r=>{for(const n of r.fov)e==null||e.updateCell({0:{char:"",tint:1044720,alpha:.25,tileSet:"tile",...fl(n)}})})):e.hide())},z0e=({views:t})=>{const e=t.senses;if(e){const r=gt().senses,n=e.width-1,i=`VI: ${r.sight||""}`,a=`AU: ${r.hearing||""}`,s=`SM: ${r.smell||""}`,o=`TS: ${r.taste||""}`,l=`TO: ${r.touch||""}`;e==null||e.updateRows([[{string:Df(i,n)}],[{string:Df(a,n)}],[{string:Df(s,n)}],[{string:Df(o,n)}],[{string:Df(l,n)}]])}},G0e=({views:t})=>{const e=t.menuUnderlay;if(e){const r=[At.LOG_HISTORY,At.INVENTORY,At.SAVING,At.LOADING],{gameState:n}=gt();r.includes(n)?e.show():e.hide()}},q0e=({views:t})=>{const e=t.logHistory;if(e){const r=gt().logActiveIndex,n=r+39,i=()=>r===0?[{string:"---"}]:[{string:"..."}],a=()=>n===gt().log.length?[{string:"---"}]:[{string:"..."}];if(gt().gameState===At.LOG_HISTORY){const s=[[{string:"History"}],[],i(),...gt().log.slice(r,n).map(o=>[{string:o}]),a(),[]];e==null||e.clearView(),e==null||e.updateRows(s,!0),e==null||e.show()}else e==null||e.hide()}},H0e=({views:t,queries:e,registry:r})=>{var a,s,o,l,u,c,f,h,p;const n=t.inventory,[i]=e.pcQuery;if(n&&i)if(gt().gameState===At.INVENTORY){const v=(((a=i.container)==null?void 0:a.contents)||[]).map(E=>r.get(E)),y=gt().inventoryActiveIndex,x=((s=i.weaponSlot)==null?void 0:s.contents[0])||"",S=r.get(x),b=Sg(i),A=[[{},{string:"Inventory"}],[],[{},{string:`${(o=i.container)==null?void 0:o.name} [${(l=i.container)==null?void 0:l.contents.length}/${(u=i.container)==null?void 0:u.slots}]`}],...v.map((E,_)=>[{},{string:`${y===_?"*":" "} ${Hm(E)} ${E==null?void 0:E.description}`}]),[],[{},{string:`Wielding [${(c=i.weaponSlot)==null?void 0:c.contents.length}/${(f=i.weaponSlot)==null?void 0:f.slots}]`}],[{},{string:`  ${Hm(S)} ${S==null?void 0:S.description}`}],[],[{},{string:`Wearing [${(h=i.armorSlot)==null?void 0:h.contents.length}/${(p=i.armorSlot)==null?void 0:p.slots}]`}],[{},{string:`  ${b&&Hm(b)} ${b&&(b==null?void 0:b.description)}`}]];n==null||n.clearView(),n==null||n.updateRows(A,!0),n==null||n.show()}else n==null||n.hide()},W0e=({views:t})=>{const e=t.log;if(e){e.clearView();const r=gt().log,n=r.slice(Math.max(r.length-5,0)),i=e.width-1;e==null||e.updateRows(n.map((a,s)=>[{string:Df(a,i),alpha:eye(s)}]),!0)}},V0e=({views:t})=>{const e=t.map;if(e){const[r,n]=gt().cursor,i={char:"",tint:65399,tileSet:"tile",alpha:0,x:r.x,y:r.y};gt().gameState===At.INSPECT||gt().gameState===At.TARGET||gt().gameState.startsWith(At.MAKER_MODE)?(e.updateCell({2:{...i,alpha:0,x:r.x,y:r.y}}),e.updateCell({2:{...i,alpha:.25,x:n.x,y:n.y}})):e.updateCell({2:{...i,alpha:0,x:n.x,y:n.y}})}},X0e=({views:t,queries:e})=>{var i,a,s,o;const r=t.hud,[n]=e.pcQuery;if(r&&n){let l="unarmed";const u=uge(n);let c;if(u){l=u.name;const m=((i=u.appearance)==null?void 0:i.tint)||65280;c=`${ss(m)}): ${l}`}else c=`): ${l}`;let f="unarmored";const h=Sg(n);let p;if(h){f=h.name;const m=((a=h.appearance)==null?void 0:a.tint)||65280;p=`${ss(m)}]: ${f}`}else p=`]: ${f}`;if(r){const m=[[{string:"Forcecrusher"}],[],[{string:`Zone: ${gt().zoneId}`}],[{string:`Turn: ${gt().turnNumber}`}],[{string:`Mode: ${gt().gameState}`}],[],[{string:"LV: 1"}],[{string:`HP: ${(s=n==null?void 0:n.health)==null?void 0:s.current}/${(o=n==null?void 0:n.health)==null?void 0:o.max}`}],[],[{string:`${c}§reset§ (${n.averageDamage})`}],[{string:`${p}§reset§ [${fb(n)}]`}],[],[{string:`AC: ${fb(n)}`}],[{string:`DM: ${n.averageDamage}`}],[],[{string:`ST: ${n==null?void 0:n.strength}`}],[{string:`DX: ${n==null?void 0:n.dexterity}`}],[{string:`CN: ${n==null?void 0:n.constitution}`}],[{string:`IN: ${n==null?void 0:n.intelligence}`}],[{string:`WI: ${n==null?void 0:n.wisdom}`}],[{string:`CH: ${n==null?void 0:n.charisma}`}]];r==null||r.clearView(),r==null||r.updateRows(m,!0)}}},j0e=({views:t,queries:e})=>{const r=t.controls,[n]=e.pcQuery;if(r&&n){let i="",a="";if(gt().gameState===At.GAME&&(i=`(${kr("arrows/hjkl")})Move (${kr("e")})Interact (${kr("g")})Get (${kr("H")})History (${kr("i")})Inventory (${kr("L")})Look (${kr("M")})MakerMode`),gt().gameState===At.INSPECT&&(i=`(${kr("L/escape")})Return to Game (${kr("arrows/hjkl")})Move cursor`),gt().gameState===At.TARGET&&(i=`(${kr("t/escape")})Return to Inventory (${kr("arrows/hjkl")})Move cursor (${kr("enter")})Throw item`),gt().gameState===At.INVENTORY&&(i=`(${kr("i/escape")})Return to Game (${kr("c")})Consume (${kr("d")})Drop (${kr("t")})Throw (${kr("W")})Wear (${kr("w")})Wield (${kr("r")})Remove`),gt().gameState===At.LOG_HISTORY&&(i=`(${kr("H/escape")})Return to Game (${kr("arrows/jk")})Scroll history`),gt().gameState===At.INTERACT&&(a="Which direction?",i=`(${kr("escape")})Cancel (${kr("arrows/hjkl")})Direction`),gt().gameState===At.INTERACT_ACTION){const{interactTargets:s,interactActions:o}=gt(),l=s[0];if(!l)return;a=`There is a ${su(l)} there:`,i=`(${kr("escape")})Cancel ${o}`}gt().gameState===At.MAKER_MODE&&(i=`(${kr("M/escape")})Return to Game (${kr("arrows/hjkl")})Move cursor (${kr(It.TOGGLE_MAKER_MODE_PREFAB_SELECT)})Select Prefab (${kr(It.CONFIRM)})Place Selected Prefab`),gt().gameState===At.MAKER_MODE_PREFAB_SELECT&&(i=`(${kr("e/escape")})Exit  (${kr("arrows/jk")})Select Prefab`),r==null||r.updateRows([[{string:a}],[{string:i}]],!0)}},Y0e=({views:t})=>{const e=t.makerModeRight,r=t.makerModeLeft,n=t.makerModeTop;if(n)if(gt().gameState.startsWith(At.MAKER_MODE)){let i=[];gt().gameState===At.MAKER_MODE?i.push([{},{string:"*PLACE*",tint:7825151}],[{},{}]):i.push([{},{string:" PLACE ",tint:14540253}],[{},{}]),n==null||n.clearView(),n==null||n.updateRows(i,!0),n==null||n.show()}else n==null||n.hide();if(e)if(gt().gameState.startsWith(At.MAKER_MODE)){const i=[[{},{string:"MAKER MODE"}]];e==null||e.clearView(),e==null||e.updateRows(i,!0),e==null||e.show()}else e==null||e.hide();if(r)if(gt().gameState.startsWith(At.MAKER_MODE)){let i=[];gt().gameState===At.MAKER_MODE_PREFAB_SELECT?i.push([{},{string:"   *SELECT*   ",tint:7825151}],[{},{}]):i.push([{},{string:"    SELECT    ",tint:14540253}],[{},{}]);const{makerModePrefabSelectIndex:a}=gt();Object.values(eh).forEach((s,o)=>{var l;o===a&&gt().gameState===At.MAKER_MODE_PREFAB_SELECT?i.push([{},{string:`${o===a?"*":" "} ${Hm(s)}`}]):i.push([{},{string:`${o===a?"*":" "} ${(l=s.appearance)==null?void 0:l.char} ${s.name}`}])}),r==null||r.clearView(),r==null||r.updateRows(i,!0),r==null||r.show()}else r==null||r.hide()},K0e=({views:t})=>{const e=t.soundMap;if(e)if(gt().cheats.seeSoundMap){if(e.show(),e.clearView(),gt().soundMap)for(const[r,n]of gt().soundMap.entries()){let i=0;for(const[o,{strength:l}]of Object.entries(n))i+=l;const a=i/30*.3,s=Math.min(1,a);e==null||e.updateCell({0:{char:"",tint:16711799,alpha:s,tileSet:"tile",...fl(r)}})}}else e.hide()},Z0e=({views:t})=>{const e=t.saving;e&&gt().gameState===At.SAVING?(e==null||e.clearView(),e.updateRow({string:"SAVING...",layer:0,x:0,y:0,tint:16711731}),e==null||e.show()):e==null||e.hide()},Q0e=({views:t})=>{const e=t.loading;e&&gt().gameState===At.LOADING?(e==null||e.clearView(),e.updateRow({string:"LOADING...",layer:0,x:0,y:0,tint:16711731}),e==null||e.show()):e==null||e.hide()},J0e=({world:t,registry:e})=>{const r=t.with("position","appearance","layer100"),n=t.with("position","appearance","layer125"),i=t.with("position","appearance","layer150"),a=t.with("position","appearance","layer200"),s=t.with("position","appearance","layer225"),o=t.with("position","appearance","layer250"),l=t.with("position","appearance","layer300"),u=t.with("position","appearance","layer325"),c=t.with("position","appearance","layer350"),f=t.with("position","appearance","layer400"),h=t.with("inFov","legendable","position","appearance","name"),p=t.with("pc","position"),m={world:t,views:gt().views,queries:{renderable100Query:r,renderable125Query:n,renderable150Query:i,renderable200Query:a,renderable225Query:s,renderable250Query:o,renderable300Query:l,renderable325Query:u,renderable350Query:c,renderable400Query:f,inFovQuery:h,pcQuery:p},registry:e};return function(){P0e(m),$0e(m),k0e(m),L0e(m),K0e(m),U0e(m),z0e(m),R0e(m),G0e(m),q0e(m),H0e(m),W0e(m),V0e(m),X0e(m),j0e(m),Y0e(m),Z0e(m),Q0e(m)}},Df=(t,e)=>{let r=t;if(r.length>e){const n=r.length-(e-3);r=r.substring(0,r.length-n).trim().concat("...")}return t},eye=t=>t<4?(100-(5-t)*7)/100:1,qy=(t,e,r,n)=>{const{appearance:i,position:a}=e;if(!i||!a)return;const{char:s,tint:o,tileSet:l}=i,{x:u,y:c}=a;t==null||t.updateCell({0:{char:s,tint:0,alpha:0,tileSet:"tile",x:u,y:c},1:{char:s,tint:n||o,alpha:r,tileSet:l,x:u,y:c}})},tye=t=>{const{world:e}=t,r=e.with("sound","position"),n=e.with("blocking","position"),i=e.with("blocking","position","pathThrough");return function(){const s=new Map,o=new Set,l=new Set;for(const[u,c]of gt().soundMap.entries()){for(const[f,{strength:h}]of Object.entries(c)){const p=h-50;p<=0?delete c[f]:c[f].strength=p}Object.keys(c).length===0&&ln(f=>{f.soundMap.delete(u)})}for(const u of n)o.add(Ir(u.position));for(const u of i)l.add(Ir(u.position));for(const u of r){const c=RO(u.position,u.sound.strength,f=>o.has(Ir(f)),f=>l.has(Ir(f)),!0);for(const[f,h]of c){const{soundMap:p}=gt();p.has(f)||ln(m=>{m.soundMap.set(f,{[u.id]:{strength:0}})}),p.get(f)[u.id]||ln(m=>{m.soundMap.get(f)[u.id]={strength:0}}),p.get(f)[u.id].strength=Math.max(h.strength,p.get(f)[u.id].strength??0)}s.set(u.id,c),e.removeComponent(u,"sound")}}},rye=({world:t,registry:e})=>{const r=t.with("tryThrow"),n=t.with("blocking","position");return function(){for(const a of r){const{throwerId:s}=a.tryThrow,o=a.id,l=e.get(s),u=a;if(!l){console.log(`dropperId: ${s} does not exist`),Hi(u),t.removeComponent(u,"tryThrow");break}if(!l.container){console.log(`thrower: ${s} has no container`),Hi(u),Hi(l),t.removeComponent(u,"tryThrow");break}let c,f,h=!1;if(l.position){const p=l.position,m=gt().cursor[1],v=Mf(p,m);for(let y=0;y<Qt.tail(v).length;y++){const x=Qt.tail(v)[y];for(const S of n)if(Gx(S.position,x)){h=!0,c=S,f=v[y];break}if(h)break}}if(h){const p=f;p&&vl(t,u,p),c!=null&&c.health&&lO(l,c,u),t.addComponent(u,"sound",{strength:25})}else{const p=gt().cursor[1];vl(t,u,p),Hi(u),Dn(`${l.name} throws ${u.name}`),t.addComponent(u,"sound",{strength:25})}Qt.remove(l.container.contents,p=>o===p),t.removeComponent(u,"tryThrow")}}},nye=async({key:t,world:e,player:r,state:n,gameState:i,setState:a,saveGameData:s,loadGameData:o,changeZone:l,addLog:u})=>{const c=e.with("pickUp"),f=e.with("stairsUp","position"),h=e.with("stairsDown","position");if(i===At.GAME){if(t===It.SAVE)return a(p=>p.gameState=At.SAVING),await s(),!1;if(t===It.LOAD)return a(p=>p.gameState=At.LOADING),await o(),!1;if(t===It.TOGGLE_DEBUG)return window.skulltooth.debug=!window.skulltooth.debug,!0;if(t===It.TOGGLE_SEE_ALL)return a(p=>p.cheats.seeAll=!p.cheats.seeAll),!0;if(t===It.TOGGLE_SEE_ODOR_MAP)return a(p=>p.cheats.seeOdorMap=!p.cheats.seeOdorMap),!0;if(t===It.TOGGLE_SEE_SOUND_MAP)return a(p=>p.cheats.seeSoundMap=!p.cheats.seeSoundMap),!0;if(t===It.TOGGLE_SEE_VISION_MAP)return a(p=>p.cheats.seeVisionMap=!p.cheats.seeVisionMap),!0;if(t===It.STAIRS_DOWN){if(!r.position)return;const[p]=h;if(au(r.position,p.position)){const{zoneId:m}=n,v=vE(m),y={...v,z:v.z-1},x=mE(y);l(x,mb.down)}return!0}if(t===It.STAIRS_UP){if(!r.position)return;const[p]=f;if(au(r.position,p.position)){const{zoneId:m}=n,v=vE(m),y={...v,z:v.z+1},x=mE(y);l(x,mb.up)}return!0}if(t===It.INVENTORY)return a(p=>p.gameState=At.INVENTORY),a(p=>p.inventoryActiveIndex=0),!0;if(t===It.INSPECT){a(m=>m.gameState=At.INSPECT);const p=r.position;return p&&a(m=>m.cursor=[p,p]),!0}if(t===It.TOGGLE_MAKER_MODE)return a(p=>p.gameState=At.MAKER_MODE),!0;if(t===It.SHOW_LOG){a(m=>m.gameState=At.LOG_HISTORY);let p=n.log.length-39;return p<=0&&(p=0),a(m=>m.logActiveIndex=p),!0}if(t===It.INTERACT)return a(p=>{p.gameState=At.INTERACT}),!0;if(tp(t)){const p=rp(t);if(p&&(r!=null&&r.position)){const m={x:r.position.x+p.dx,y:r.position.y+p.dy};e.addComponent(r,"tryMove",m)}return!0}if(t===It.PICK_UP){let p=!0;for(const m of c)if(r.position&&m.position&&Ir(r.position)===Ir(m.position)){const{id:v}=r;Qt.isUndefined(v)||(e.addComponent(m,"tryPickUp",{pickerId:v}),p=!1)}p&&u("There is nothing to pickup")}return!0}},iye=({key:t,state:e,player:r,setState:n})=>{if((t===It.INSPECT||t===It.CANCEL)&&n(i=>i.gameState=At.GAME),tp(t)){const i=rp(t);if(i&&(r!=null&&r.position)){const a=e.cursor[1],s={x:a.x+i.dx,y:a.y+i.dy};Eg(s)||n(o=>{o.cursor=[a,s]})}return!0}},aye=({key:t,world:e,state:r,player:n,setState:i})=>{(t===It.INTERACT||t===It.CANCEL)&&i(c=>{c.gameState=At.GAME});const{interactActions:a,interactTargets:s}=r,[o]=s,l=n,u=()=>{i(c=>{c.interactActions="",c.interactTargets=[],c.gameState=At.GAME,c.turn=cc.WORLD})};if(a.includes(`§${It.ATTACK}§`)&&t===It.ATTACK)return e.addComponent(l,"tryAttack",{targetId:o.id}),u(),!0;if(a.includes(`§${It.CONSUME}§`)&&t===It.CONSUME)return e.addComponent(l,"tryClose",o),u(),!0;if(a.includes(`§${It.PICK_UP}§`)&&t===It.PICK_UP)return e.addComponent(o,"tryPickUp",{pickerId:l.id}),u(),!0;if(a.includes(`§${It.KICK}§`)&&t===It.KICK)return e.addComponent(l,"tryKick",{targetId:o.id}),u(),!0;if(a.includes(`§${It.OPEN}§`)&&t===It.OPEN)return e.addComponent(l,"tryOpen",{id:o.id}),u(),!0},sye=({key:t,world:e,player:r,setState:n})=>{if(t===It.INTERACT||t===It.CANCEL)return n(i=>{i.gameState=At.GAME}),!0;if(tp(t)){const i=rp(t);if(i&&(r!=null&&r.position)){const a=r.position,s={x:a.x+i.dx,y:a.y+i.dy};return e.addComponent(r,"interactDirection",s),n(o=>o.gameState=At.INTERACT_ACTION),!0}}},oye=({key:t,world:e,registry:r,player:n,state:i,setState:a,addLog:s})=>{var f,h,p,m,v;(t===It.INVENTORY||t===It.CANCEL)&&a(y=>y.gameState=At.GAME);const o=((f=n.container)==null?void 0:f.contents[i.inventoryActiveIndex])||"",l=r.get(o),u=((h=n.container)==null?void 0:h.contents.length)||0,c=i.inventoryActiveIndex;if(It.SCROLL_DOWN.includes(t))return c<u-1?a(y=>y.inventoryActiveIndex=c+1):a(y=>y.inventoryActiveIndex=0),!0;if(It.SCROLL_UP.includes(t))return c>0?a(y=>y.inventoryActiveIndex=c-1):a(y=>y.inventoryActiveIndex=u-1),!0;if(t===It.CONSUME){do{if(!n.container){s("You have no container to hold consumables");break}if(!o){s("You have nothing to consume");break}const y=r.get(o);if(!y){console.log(`id: ${o} does not exist.`),Hi(n);break}if(!y.consumable){s(`${n.name} cannot consume ${y.name}`);break}y.effects&&n.activeEffects.push(...y.effects),Qt.remove(n.container.contents,x=>o===x),s(`${n.name} consumes ${y.name}`),e.remove(y);break}while(!0);return c===u-1&&a(y=>y.inventoryActiveIndex-=1),!0}if(t===It.DROP){do{if(!n.container){s("You can't drop without a container to hold.");break}if(!o){s("You have nothing to drop");break}const y=r.get(o);if(!y){console.log(`id: ${o} does not exist.`),Hi(n);break}const x=n.id;if(Qt.isUndefined(x))break;e.addComponent(y,"tryDrop",{dropperId:x});break}while(!0);return c===u-1&&a(y=>y.inventoryActiveIndex-=1),!0}if(t===It.WIELD)return l&&qx(n,l),!0;if(t===It.WEAR)return l&&Wx(n,l),!0;if(t===It.REMOVE)return o&&(((p=n.armorSlot)==null?void 0:p.contents[0])===o&&Vx(n),((m=n.weaponSlot)==null?void 0:m.contents[0])===o&&Hx(n)),!0;if(t===It.TARGET)return(v=n.container)!=null&&v.contents.length&&a(y=>{y.gameState=At.TARGET;const x=n.position;x&&(y.cursor=[x,x])}),!0},uye=({key:t,state:e,setState:r})=>{if(t===It.SHOW_LOG||t===It.CANCEL)return r(n=>n.gameState=At.GAME),!0;if(It.SCROLL_DOWN.includes(t)){const{logActiveIndex:n,log:i}=e,a=n===i.length-39?i.length-39:n+1;return r(s=>s.logActiveIndex=a),!0}if(It.SCROLL_UP.includes(t)){const{logActiveIndex:n}=e,i=n===0?0:n-1;return r(a=>a.logActiveIndex=i),!0}},lye=({key:t,setState:e,state:r,player:n,layer100Query:i,layer200Query:a,layer300Query:s,layer400Query:o})=>{if(t===It.TOGGLE_MAKER_MODE||t===It.CANCEL)return e(l=>l.gameState=At.GAME),!0;if(t===It.TOGGLE_MAKER_MODE_PREFAB_SELECT)return e(l=>l.gameState=At.MAKER_MODE_PREFAB_SELECT),!0;if(tp(t)){const l=rp(t);if(l&&(n!=null&&n.position)){const u=r.cursor[1],c={x:u.x+l.dx,y:u.y+l.dy};Eg(c)||e(f=>{f.cursor=[u,c]})}return!0}if(t===It.CONFIRM){const l=gt().makerModePrefabSelectIndex,u=Object.values(eh)[l],{layer100:c,layer200:f,layer300:h,layer400:p}=u;return c&&Nm(i,u),f&&Nm(a,u),h&&Nm(s,u),p&&Nm(o,u),!0}};function cye(t,e){const r=["id","position"],n={};for(const i of r)i in t&&(n[i]=t[i]);for(const i in t)r.includes(i)||delete t[i];Object.assign(t,Qt.cloneDeep(e),n)}function Nm(t,e){const r=gt().cursor[1];let n;for(const i of t)Gx(r,i.position)&&(n=i);if(n)cye(n,e);else{const{name:i}=Object.values(eh)[gt().makerModePrefabSelectIndex];if(i==="skeleton")hO(r);else if(i==="rat")fO(r);else if(i==="player")bO(r);else{const a=Qt.camelCase(i);Un(a,{position:r})}}}const fye=({key:t,world:e,registry:r,state:n,player:i,setState:a})=>{var s;if(t===It.TARGET||t===It.CANCEL)return a(o=>o.gameState=At.INVENTORY),!0;if(t===It.CONFIRM){const o=(s=i.container)==null?void 0:s.contents[n.inventoryActiveIndex];if(o){const l=r.get(o);if(l){const u=i.id;Qt.isUndefined(u)||e.addComponent(l,"tryThrow",{throwerId:u})}}return a(l=>{l.turn=cc.WORLD,l.gameState=At.GAME}),!0}if(tp(t)){const o=rp(t);if(o&&(i!=null&&i.position)){const l=n.cursor[1],u={x:l.x+o.dx,y:l.y+o.dy};Eg(u)||a(c=>{c.cursor=[l,u]})}return!0}},hye=({key:t,state:e,setState:r})=>{if(t===It.TOGGLE_MAKER_MODE)return r(n=>n.gameState=At.GAME),!0;if(t===It.CANCEL||t===It.CONFIRM||t===It.TOGGLE_MAKER_MODE_PREFAB_SELECT)return r(n=>n.gameState=At.MAKER_MODE),!0;if(It.SCROLL_DOWN.includes(t)){let i=e.makerModePrefabSelectIndex+1;return i>=Object.values(eh).length&&(i=0),e.makerModePrefabSelectIndex=i,!0}if(It.SCROLL_UP.includes(t)){let i=e.makerModePrefabSelectIndex-1;return i<0&&(i=Object.values(eh).length-1),e.makerModePrefabSelectIndex=i,!0}},dye=({key:t,setState:e})=>(t==="exitSaveMode"&&e(r=>r.gameState=At.GAME),!0),pye=({key:t,setState:e})=>(t==="exitLoadMode"&&e(r=>r.gameState=At.GAME),!0),mye=({world:t,registry:e,saveGameData:r,loadGameData:n,changeZone:i})=>{const a=t.with("pc","position"),s=t.with("layer100","position"),o=t.with("layer200","position"),l=t.with("layer300","position"),u=t.with("layer400","position");return async function(){const{userInput:f,gameState:h}=gt(),p=gt();if(!f)return;const{key:m}=f,[v]=a,y={key:m,world:t,registry:e,player:v,state:p,gameState:h,setState:ln,saveGameData:r,loadGameData:n,changeZone:i,addLog:b=>Dn(b),layer100Query:s,layer200Query:o,layer300Query:l,layer400Query:u},S={[At.GAME]:nye,[At.GAME_OVER]:()=>!0,[At.INSPECT]:iye,[At.INTERACT]:sye,[At.INTERACT_ACTION]:aye,[At.INVENTORY]:oye,[At.LOG_HISTORY]:uye,[At.MAKER_MODE]:lye,[At.MAKER_MODE_PREFAB_SELECT]:hye,[At.TARGET]:fye,[At.SAVING]:dye,[At.LOADING]:pye}[h];S&&await S(y)&&ln(A=>{A.userInput=null})}},vye={warning:1.5,danger:3},gye={FRAME:{warning:24,danger:32},renderSystem:{warning:6,danger:10},fovSystem:{warning:4,danger:6},aiSystem:{warning:4,danger:6}};function k2(t,e){const{warning:r,danger:n}=gye[e]??vye;return t>=n?{color:"color: #ef4444; font-weight: bold",emoji:"❌"}:t>=r?{color:"color: #facc15; font-weight: bold",emoji:"⚠️"}:{color:"color: #22c55e",emoji:"✅"}}const yye=fge(Xt),bye=Jge(Xt),xye=e0e(Xt),wye=i0e(Xt),_ye=a0e(Xt),Aye=s0e(Xt),Eye=o0e(Xt),Sye=l0e(Xt),Dye=f0e(Xt),Cye=d0e(Xt),Tye=m0e(Xt),Nye=v0e(Xt),Mye=g0e(Xt),Iye=y0e(Xt),Fye=b0e(Xt),Oye=x0e(Xt),Bye=A0e(Xt),Rye=E0e(Xt),Pye=S0e(Xt),$ye=D0e(Xt),kye=C0e(Xt),Lye=B0e(Xt),Uye=J0e(Xt),zye=tye(Xt),Gye=rye(Xt),qye=mye(Xt),Dt={activeEffects:yye,ai:bye,attack:xye,calculateFlammability:wye,close:_ye,cursor:Aye,damage:Eye,drop:Sye,fire:Cye,fluid:Tye,fov:Dye,mutable:Nye,interact:Mye,kick:Iye,knockback:Fye,memory:Oye,morgue:Bye,movement:Rye,odor:Pye,open:$ye,perception:kye,pickUp:Lye,render:Uye,sound:zye,throw:Gye,userInput:qye},Vm=(t,e="")=>{const r=["preInput","input","main","postMain","render"];if(window.skulltooth.debug){const n=performance.now();for(const l of r)for(const u of t[l]??[]){const c=performance.now();u();const h=performance.now()-c,{color:p,emoji:m}=k2(h,u.name);console.log(`%c[${e}] ▶ %c ${l.padEnd(9)} %c ⚙ ${u.name.padEnd(18)} %c ${m} ${h.toFixed(2)}ms`,"color: gray; font-weight: bold","color: #5e9cff; font-weight: bold","color: #22c55e; font-weight: bold",p)}const a=performance.now()-n,{color:s,emoji:o}=k2(a,"FRAME");console.log(`%c${o} Frame Time: ${a.toFixed(2)}ms`,s)}else for(const n of r)for(const i of t[n]??[])i()},Hye={preInput:[Dt.activeEffects],input:[Dt.userInput],main:[Dt.pickUp,Dt.movement,Dt.open,Dt.attack,Dt.knockback,Dt.damage,Dt.morgue,Dt.drop],postMain:[Dt.fov],render:[Dt.render]},Wye={preInput:[Dt.mutable,Dt.fluid,Dt.fire,Dt.activeEffects,Dt.morgue,Dt.odor,Dt.sound],input:[Dt.perception,Dt.memory],main:[Dt.ai,Dt.movement,Dt.open,Dt.attack,Dt.knockback,Dt.damage,Dt.morgue,Dt.drop],postMain:[Dt.fov,Dt.calculateFlammability],render:[Dt.render]},Vye={[At.INSPECT]:{preInput:[],input:[Dt.userInput],main:[Dt.cursor],postMain:[],render:[Dt.render]},[At.TARGET]:{preInput:[],input:[Dt.userInput],main:[Dt.cursor,Dt.throw],postMain:[],render:[Dt.render]},[At.INVENTORY]:{preInput:[],input:[Dt.userInput],main:[Dt.activeEffects,Dt.drop],postMain:[Dt.fov],render:[Dt.render]},[At.INTERACT]:{preInput:[],input:[Dt.userInput],main:[Dt.interact],postMain:[Dt.fov],render:[Dt.render]},[At.INTERACT_ACTION]:{preInput:[],input:[Dt.userInput],main:[Dt.interact,Dt.activeEffects,Dt.pickUp,Dt.movement,Dt.close,Dt.open,Dt.kick,Dt.attack,Dt.knockback,Dt.damage,Dt.morgue,Dt.drop],postMain:[Dt.fov],render:[Dt.render]},[At.LOG_HISTORY]:{preInput:[],input:[Dt.userInput],main:[],postMain:[],render:[Dt.render]},[At.MAKER_MODE]:{preInput:[],input:[Dt.userInput],main:[],postMain:[Dt.fov],render:[Dt.render]},[At.MAKER_MODE_PREFAB_SELECT]:{preInput:[],input:[Dt.userInput],main:[],postMain:[],render:[Dt.render]},[At.SAVING]:{preInput:[],input:[Dt.userInput],main:[],postMain:[],render:[Dt.render]},[At.LOADING]:{preInput:[],input:[Dt.userInput],main:[],postMain:[],render:[Dt.render]}};window.skulltooth=window.skulltooth||{};window.skulltooth.debug=!1;window.skulltooth.state=gt();window.skulltooth.gameWorld=Xt;const Xye=async()=>{await Dq(document.querySelector("#canvas"));const t=cge();ln(i=>{for(const a of Object.keys(t))i.views[a]=t[a]});const e=dO();if(!e)return;const r=e.rooms[0].center,n=bO(r);ln(i=>{i.playerId=n.id}),Xt.saveZone(gt().zoneId),Vm({preInput:[],input:[],main:[],postMain:[Dt.fov],render:[Dt.render]}),kO(),document.addEventListener("keydown",i=>{[At.LOADING,At.SAVING].includes(gt().gameState)||pb(i)}),document.addEventListener("mousedown",i=>{const a=i.x-gt().views.map.layers[0].x,s=i.layerY-gt().views.map.layers[0].y,o=Sq(a,s),l=Xt.world.with("position"),u={posId:o};for(const h of l)o===Ir(h.position)&&(u[h.id]=Wm(h));const c=gt().odorMap.get(o),f=gt().soundMap.get(o);u.odors={map:c,entities:Object.keys(c??{}).map(h=>{const p=Xt.registry.get(h);return p?Wm(p):void 0})},u.sounds={map:f,entities:Object.keys(f??{}).map(h=>{const p=Xt.registry.get(h);return p?Wm(p):void 0})},console.log(u)})};function kO(){requestAnimationFrame(kO),jye();const t=gt(),e=t.turn===cc.PLAYER&&t.userInput!==null;if(t.gameState!==At.GAME){e&&Vm(Vye[t.gameState],t.gameState);return}if(e){Vm(Hye,"PlayerTurn"),gt().gameState===At.GAME&&ln(r=>{r.turn=cc.WORLD});return}t.turn===cc.WORLD&&(Vm(Wye,"WorldTurn"),ln(r=>r.turnNumber+=1),ln(r=>{r.turn=cc.PLAYER}))}let Hy=0,Mm=Date.now(),Im=[];function jye(){var t;if(Mm||(Mm=Date.now()),Date.now()-Mm>1e3){Im.unshift(Hy),Im.length>3&&Im.pop();const e=Math.round(Qt.mean(Im));ln(r=>r.fps=e),isNaN(e)||(t=gt().views.fps)==null||t.updateRow({string:`FPS: ${e}     `,layer:0,x:0,y:0,tileSet:"text"}),Mm=Date.now(),Hy=0}Hy++}Xye();
